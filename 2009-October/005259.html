<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] Timestamp Accuracy Patch
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2009-October/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Timestamp%20Accuracy%20Patch&In-Reply-To=%3C833B0B09C5041D42A9924A3BA6A12B9A028FB22085%40CALMAIL-CMS.smarttech.inc%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005264.html">
   <LINK REL="Next"  HREF="005260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] Timestamp Accuracy Patch</H1>
    <B>Jacob Fehr</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Timestamp%20Accuracy%20Patch&In-Reply-To=%3C833B0B09C5041D42A9924A3BA6A12B9A028FB22085%40CALMAIL-CMS.smarttech.inc%3E"
       TITLE="[Linux-uvc-devel] Timestamp Accuracy Patch">JacobFehr at smarttech.com
       </A><BR>
    <I>Sat Oct 31 00:07:51 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005264.html">[Linux-uvc-devel] eb1a:2571 &quot;eMPIA Technology, Inc.&quot;  supported
</A></li>
        <LI>Next message: <A HREF="005260.html">[Linux-uvc-devel] Asus k50in - upside down camera CNF7129
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5259">[ date ]</a>
              <a href="thread.html#5259">[ thread ]</a>
              <a href="subject.html#5259">[ subject ]</a>
              <a href="author.html#5259">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Laurent,

Attached is a changeset that will sync the computer's clock to the camera clock. The final result is that uvc_buffer.buf.timestamp is adjusted to compensate for the latency that happens on the camera and the latency that happens in the USB stack. It seems to work quite nicely. With the patch, I get very even timestamp intervals. In fact it's so accurate that I see a 9 microsecond/frame drift between my camera clock and my computer clock.

There is still +-105 microseconds of latency that could be tweaked out. But for now this is should be accurate enough for even the most demanding application... such as watching TV, DVDs, etc. :-) I suspect the remaining latency is coming from the interrupt handler and USB stack. Getting that out would require that I get down into the HCD code.

Have a look and let me know what you think.

Jacob Fehr
SMART Technologies ULC
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091030/5d18540d/attachment.html">https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091030/5d18540d/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 13110-4617ec8de827.gz
Type: application/x-gzip
Size: 2092 bytes
Desc: 13110-4617ec8de827.gz
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091030/5d18540d/attachment.bin">https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091030/5d18540d/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005264.html">[Linux-uvc-devel] eb1a:2571 &quot;eMPIA Technology, Inc.&quot;  supported
</A></li>
	<LI>Next message: <A HREF="005260.html">[Linux-uvc-devel] Asus k50in - upside down camera CNF7129
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5259">[ date ]</a>
              <a href="thread.html#5259">[ thread ]</a>
              <a href="subject.html#5259">[ subject ]</a>
              <a href="author.html#5259">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
