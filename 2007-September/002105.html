<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] Problems with QuickCam Pro 5000
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Problems%20with%20QuickCam%20Pro%205000&In-Reply-To=%3C200709160035.58444.laurent.pinchart%40skynet.be%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002101.html">
   <LINK REL="Next"  HREF="002109.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] Problems with QuickCam Pro 5000</H1>
    <B>Laurent Pinchart</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Problems%20with%20QuickCam%20Pro%205000&In-Reply-To=%3C200709160035.58444.laurent.pinchart%40skynet.be%3E"
       TITLE="[Linux-uvc-devel] Problems with QuickCam Pro 5000">laurent.pinchart at skynet.be
       </A><BR>
    <I>Sun Sep 16 00:35:58 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002101.html">[Linux-uvc-devel] Problems with QuickCam Pro 5000
</A></li>
        <LI>Next message: <A HREF="002109.html">[Linux-uvc-devel] Problems with QuickCam Pro 5000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2105">[ date ]</a>
              <a href="thread.html#2105">[ thread ]</a>
              <a href="subject.html#2105">[ subject ]</a>
              <a href="author.html#2105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Guillaume,

On Thursday 13 September 2007, Guillaume Desmottes wrote:
&gt;<i> Le mercredi 12 septembre 2007 &#224; 23:48 +0200, Laurent Pinchart a &#233;crit :
</I>&gt;<i> &gt; Hi Guillaume,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; your post was too big for the list so I removed to
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Wednesday 05 September 2007, Guillaume Desmottes wrote:
</I>&gt;<i> &gt; &gt; Le mercredi 25 avril 2007 &#224; 00:05 +0200, Guillaume Desmottes a &#233;crit :
</I>&gt;<i> &gt; &gt; &gt; Le mardi 24 avril 2007 &#224; 20:37 +0200, Laurent Pinchart a &#233;crit :
</I>&gt;<i> &gt; &gt; &gt; &gt; You might be suffering from a Logitech hardware bug. Search the
</I>&gt;<i> &gt; &gt; &gt; &gt; list archive for a so-called &quot;reset patch&quot;. It is known to help
</I>&gt;<i> &gt; &gt; &gt; &gt; some people in the past.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Laurent you are my hero. I patched using the diff posted by Stephan
</I>&gt;<i> &gt; &gt; &gt; and it seems to work perfectly now. :)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Some update.
</I>&gt;<i> &gt; &gt; I reinstalled my box to switch to Gutsy (2.6.22-10) and so re-install
</I>&gt;<i> &gt; &gt; the driver using HEAD version.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; # modprobe uvcvideo trace=0xffff
</I>&gt;<i> &gt; &gt; # dmesg -c
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [57843.336000] uvcvideo: Found UVC 1.00 device &lt;unnamed&gt; (046d:08ce)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [57843.424000] uvcvideo: UVC device initialized.
</I>&gt;<i> &gt; &gt; [57843.424000] usbcore: registered new interface driver uvcvideo
</I>&gt;<i> &gt; &gt; [57843.424000] USB Video Class driver (v0.1.0)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; And when I try to use the webcam, gst-properties says:
</I>&gt;<i> &gt; &gt; gstreamer-properties-Message: Error running pipeline 'Video for Linux 2
</I>&gt;<i> &gt; &gt; (v4l2)': Could not get buffers from device '/dev/video0'.
</I>&gt;<i> &gt; &gt; [v4l2src_calls.c(1025): gst_v4l2src_capture_init
</I>&gt;<i> &gt; &gt; (): /pipeline0/v4l2src3:
</I>&gt;<i> &gt; &gt; error requesting 0 buffers: Cannot allocate memory]
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; # dmesg -c
</I>&gt;<i> &gt; &gt; [57901.428000] uvcvideo: uvc_v4l2_open
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [57904.996000] uvcvideo: uvc_v4l2_read: not implemented.
</I>&gt;<i> &gt; &gt; [57908.616000] uvcvideo: uvc_v4l2_release
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; So I retried using the reset patch.
</I>&gt;<i> &gt; &gt; I used
</I>&gt;<i> &gt; &gt; <A HREF="http://www.mail-archive.com/linux-uvc-devel@lists.berlios.de/msg00830.h">http://www.mail-archive.com/linux-uvc-devel@lists.berlios.de/msg00830.h</A>
</I>&gt;<i> &gt; &gt;tml as said on the wiki and updated it to apply on HEAD (see
</I>&gt;<i> &gt; &gt; attachement).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; # modprobe uvcvideo trace=0xffff
</I>&gt;<i> &gt; &gt; # dmesg -c
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [58280.416000] uvcvideo: Found UVC 1.00 device &lt;unnamed&gt; (046d:08ce)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [58280.464000] uvcvideo: UVC device initialized.
</I>&gt;<i> &gt; &gt; [58280.464000] usbcore: registered new interface driver uvcvideo
</I>&gt;<i> &gt; &gt; [58280.464000] USB Video Class driver (v0.1.0)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Let's retry.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; streamer-properties-Message: Error running pipeline 'Video for Linux 2
</I>&gt;<i> &gt; &gt; (v4l2)': Could not get buffers from device '/dev/video0'.
</I>&gt;<i> &gt; &gt; [v4l2src_calls.c(1025): gst_v4l2src_capture_init
</I>&gt;<i> &gt; &gt; (): /pipeline0/v4l2src3:
</I>&gt;<i> &gt; &gt; error requesting 0 buffers: Cannot allocate memory]
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; same error so
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; # dmesg -c
</I>&gt;<i> &gt; &gt; [58339.504000] uvcvideo: uvc_v4l2_open
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [58342.992000] uvcvideo: uvc_v4l2_read: not implemented.
</I>&gt;<i> &gt; &gt; [58344.320000] uvcvideo: uvc_v4l2_release
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; So I tried the other link from the wiki
</I>&gt;<i> &gt; &gt; (<A HREF="http://www.mail-archive.com/linux-uvc-devel@lists.berlios.de/msg00386.">http://www.mail-archive.com/linux-uvc-devel@lists.berlios.de/msg00386.</A>
</I>&gt;<i> &gt; &gt;html ) Here again I updated it to fit HEAD (attachement) but didn't get
</I>&gt;<i> &gt; &gt; better results.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; # modprobe uvcvideo trace=0xffff
</I>&gt;<i> &gt; &gt; # dmesg -c
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [59582.988000] uvcvideo: Found UVC 1.00 device &lt;unnamed&gt; (046d:08ce)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; [59583.036000] uvcvideo: UVC device initialized.
</I>&gt;<i> &gt; &gt; [59583.036000] usbcore: registered new interface driver uvcvideo
</I>&gt;<i> &gt; &gt; [59583.036000] USB Video Class driver (v0.1.0)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Here again, the same error...
</I>&gt;<i> &gt; &gt; gstreamer-properties-Message: Error running pipeline 'Video for Linux 2
</I>&gt;<i> &gt; &gt; (v4l2)': Could not get buffers from device '/dev/video0'.
</I>&gt;<i> &gt; &gt; [v4l2src_calls.c(1025): gst_v4l2src_capture_init
</I>&gt;<i> &gt; &gt; (): /pipeline0/v4l2src3:
</I>&gt;<i> &gt; &gt; error requesting 0 buffers: Cannot allocate memory]
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; So, I'm not able anymore to use my webcam. :(
</I>&gt;<i> &gt; &gt; Is it still due to this damned hardware bug? If so, do you have any
</I>&gt;<i> &gt; &gt; other fix/workaround that could help me?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Good news, the &quot;damned hardware bug&quot; is not at fault here :-) For some
</I>&gt;<i> &gt; reason, your gstreamer pipeline uses read() instead of mmap(). Did it
</I>&gt;<i> &gt; work before the upgrade ?
</I>&gt;<i>
</I>&gt;<i> Yes, it was working with Feisty. Is that a gst bug? I mean, is it
</I>&gt;<i> supposed to use the read method here? Any specific reason why this
</I>&gt;<i> method is not implemented or it's just not done yet?
</I>
V4L2 specifies several video streaming methods. A driver must implement at 
least one of them, but none are mandatory. The read() method is suboptimal 
but sometimes easier to use (especially when using programming languages that 
don't support ioctl and mmap). mmap() usually provides better performances.

The Linux UVC driver supports mmap() only for historical reasons. I 
implemented mmap() first, as it was in my opinion the most useful method 
performance-wise. Unfortunately, some softwares use read() exclusively. There 
might be a way to tell gstreamer to switch from read() to mmap().

read() support is planned, and Christopher Horler posted a patch on the 
mailing list some time ago. I unfortunately haven't had time to fix it yet.

Best regards,

Laurent Pinchart

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002101.html">[Linux-uvc-devel] Problems with QuickCam Pro 5000
</A></li>
	<LI>Next message: <A HREF="002109.html">[Linux-uvc-devel] Problems with QuickCam Pro 5000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2105">[ date ]</a>
              <a href="thread.html#2105">[ thread ]</a>
              <a href="subject.html#2105">[ subject ]</a>
              <a href="author.html#2105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
