<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] Problems setting manual exposure on Creative	Live! Cam Optia
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2008-July/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Problems%20setting%20manual%20exposure%20on%20Creative%0A%09Live%21%20Cam%20Optia&In-Reply-To=%3C200807171339.51589.laurent.pinchart%40skynet.be%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003816.html">
   <LINK REL="Next"  HREF="003822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] Problems setting manual exposure on Creative	Live! Cam Optia</H1>
    <B>Laurent Pinchart</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Problems%20setting%20manual%20exposure%20on%20Creative%0A%09Live%21%20Cam%20Optia&In-Reply-To=%3C200807171339.51589.laurent.pinchart%40skynet.be%3E"
       TITLE="[Linux-uvc-devel] Problems setting manual exposure on Creative	Live! Cam Optia">laurent.pinchart at skynet.be
       </A><BR>
    <I>Thu Jul 17 13:39:51 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003816.html">[Linux-uvc-devel] Problems setting manual exposure on Creative	Live! Cam Optia
</A></li>
        <LI>Next message: <A HREF="003822.html">[Linux-uvc-devel] Skype not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3849">[ date ]</a>
              <a href="thread.html#3849">[ thread ]</a>
              <a href="subject.html#3849">[ subject ]</a>
              <a href="author.html#3849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Moreno,

On Sunday 13 July 2008, Moreno Marzolla wrote:
&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I'm trying to play around with the manual exposure settings of my
</I>&gt;<i> Creative Live! Cam Optia (the non-AF version), in order to address the
</I>&gt;<i> everexposure issues I described in another post
</I>&gt;<i> (<A HREF="https://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003658.html">https://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003658.html</A>).
</I>&gt;<i> Unfortunately, there seems to be problems with manual exposure on this
</I>&gt;<i> camera: I am experiencing the exact same problem described here:
</I>&gt;<i> <A HREF="http://www.mail-archive.com/linux-uvc-devel@lists.berlios.de/msg02799.html,">http://www.mail-archive.com/linux-uvc-devel@lists.berlios.de/msg02799.html,</A>
</I>&gt;<i> that is, manual exposure can be set, but every value results in an
</I>&gt;<i> overexposed image no matter what value I use (lower ones or higher ones
</I>&gt;<i> do not matter).
</I>&gt;<i>
</I>&gt;<i> I'm working on a debian 4.0 machine (debian kernel 2.6.18-6-686) with
</I>&gt;<i> the latest (as far as I know) version of the uvcvideo module:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ /sbin/modinfo uvcvideo
</I>&gt;<i> filename:       /lib/modules/2.6.18-6-686/usb/media/uvcvideo.ko
</I>&gt;<i> version:        SVN r228
</I>&gt;<i>
</I>&gt;<i> I'm also using the latest svn version of uvcdynctrl
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl --version
</I>&gt;<i> uvcdynctrl 0.2
</I>&gt;<i>
</I>&gt;<i> This is the output of uvcdynctrl -c -v:
</I>&gt;<i>
</I>&gt;<i> ----------
</I>&gt;<i>
</I>&gt;<i> Listing available controls for device video0:
</I>&gt;<i>    Exposure, Auto Priority
</I>&gt;<i>      ID      : 0x00000010,
</I>&gt;<i>      Type    : Boolean,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 20 .. 5000, step size: 1 ],
</I>&gt;<i>      Default : 79
</I>&gt;<i>    Exposure (Absolute)
</I>&gt;<i>      ID      : 0x00000011,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 20 .. 5000, step size: 1 ],
</I>&gt;<i>      Default : 79
</I>&gt;<i>    Exposure, Auto
</I>&gt;<i>      ID      : 0x0000000f,
</I>&gt;<i>      Type    : Choice,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : { 'Manual Mode'[0], 'Auto Mode'[1], 'Shutter Priority
</I>&gt;<i> Mode'[2], 'Aperture Priority Mode'[3] },
</I>&gt;<i>      Default : 1
</I>&gt;<i>    Sharpness
</I>&gt;<i>      ID      : 0x00000007,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 0 .. 96, step size: 1 ],
</I>&gt;<i>      Default : 40
</I>&gt;<i>    Power Line Frequency
</I>&gt;<i>      ID      : 0x0000000d,
</I>&gt;<i>      Type    : Choice,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : { 'Disabled'[0], '50 Hz'[1], '60 Hz'[2] },
</I>&gt;<i>      Default : 0
</I>&gt;<i>    Gamma
</I>&gt;<i>      ID      : 0x00000006,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 0 .. 7, step size: 1 ],
</I>&gt;<i>      Default : 3
</I>&gt;<i>    Hue
</I>&gt;<i>      ID      : 0x00000005,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ -4 .. 4, step size: 1 ],
</I>&gt;<i>      Default : 0
</I>&gt;<i>    Saturation
</I>&gt;<i>      ID      : 0x00000004,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 0 .. 8, step size: 1 ],
</I>&gt;<i>      Default : 3
</I>&gt;<i>    Contrast
</I>&gt;<i>      ID      : 0x00000002,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 0 .. 6, step size: 1 ],
</I>&gt;<i>      Default : 2
</I>&gt;<i>    Brightness
</I>&gt;<i>      ID      : 0x00000001,
</I>&gt;<i>      Type    : Dword,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 0 .. 100, step size: 1 ],
</I>&gt;<i>      Default : 30
</I>&gt;<i>
</I>&gt;<i> ----------
</I>&gt;<i>
</I>&gt;<i> There is something I don't understand: the Exposure (Auto Priority)
</I>&gt;<i> control:
</I>&gt;<i>
</I>&gt;<i>    Exposure, Auto Priority
</I>&gt;<i>      ID      : 0x00000010,
</I>&gt;<i>      Type    : Boolean,
</I>&gt;<i>      Flags   : { CAN_READ, CAN_WRITE },
</I>&gt;<i>      Values  : [ 20 .. 5000, step size: 1 ],
</I>&gt;<i>      Default : 79
</I>&gt;<i>
</I>&gt;<i> is reported of being of type Boolean, but the allowable values are
</I>&gt;<i> described as integers;
</I>
The V4L2 spec states, about the minimum and maximum values,

&quot;This &#64257;eld gives a lower (upper) bound for V4L2_CTRL_TYPE_INTEGER controls.
It may not be valid for any other type of control [...].&quot;

The driver didn't clear unused fields in the v4l2_queryctrl structure, so 
boolean controls would report lower and upper bounds from the previously 
queried control.

Although not exactly required by the spec, I've fixed the driver in SVN to 
return 0 and 1 as the lower and upper bounds for boolean controls.

&gt;<i> nevertheless, I'm unable to change its value in 
</I>&gt;<i> any way, and also getting its current value returns an error:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -g &quot;Exposure, Auto Priority&quot;
</I>&gt;<i> ERROR: Unable to retrieve control value: A Video4Linux2 API call
</I>&gt;<i> returned an unexpected error 5. (Code: 12)
</I>&gt;<i>
</I>&gt;<i> dmesg says:
</I>&gt;<i>
</I>&gt;<i> uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -32 (exp. 1).
</I>&gt;<i>
</I>&gt;<i> However, this is likely a problem with uvcdynctrl rather than with the
</I>&gt;<i> uvcvideo module.
</I>
This seems to be a webcam problem. The camera claims to support the &quot;Exposure, 
Auto Priority&quot; control but any attempt to get or set the control value 
returns an error. You can probably ignore that control.

&gt;<i> Now, as far as manual exposure is concerned, I'm doing this:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -s &quot;Exposure, Auto&quot; 0
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -g &quot;Exposure, Auto&quot;
</I>&gt;<i> 0
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -s &quot;Exposure (Absolute)&quot; 20
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -g &quot;Exposure (Absolute)&quot;
</I>&gt;<i> 20
</I>&gt;<i>
</I>&gt;<i> After that, the image shown by luvcview is completely overexposed; the
</I>&gt;<i> same happens if I set the Exposure (Absolute) control with a high value:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -s &quot;Exposure (Absolute)&quot; 4000
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">moreno at colossus</A>:~$ uvcdynctrl -g &quot;Exposure (Absolute)&quot;
</I>&gt;<i> 4000
</I>&gt;<i>
</I>&gt;<i> I also tried to play around with the &quot;Shutter Priority&quot; and &quot;Aperture
</I>&gt;<i> Priority&quot; values for the &quot;Exposure, Auto&quot; control, but without any
</I>&gt;<i> apparent effect.
</I>&gt;<i>
</I>&gt;<i> If I set &quot;Exposure, Auto&quot; to 1 (Auto mode) and run luvcview, I can see
</I>&gt;<i> that setting any value to the &quot;Exposure (Absolute)&quot; control results in
</I>&gt;<i> the image becoming immediately overexposed, and then quickly coming back
</I>&gt;<i> to normal as the camera automatically adjusts the exposure.
</I>&gt;<i>
</I>&gt;<i> Has any body been able to manually set the exposure on the Creative
</I>&gt;<i> Live! Cam Optia (non-AF)?
</I>
My Live! Cam Optia suffers from the same problem. My guess would be a hardware 
issue. I don't think there's much I can do :-/ You could try to contact 
Creative Labs, they might have more information. I don't know if Windows 
supports manual exposure, but if you have access to a Windows box it might be 
interesting to see if it works there.

Best regards,

Laurent Pinchart

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003816.html">[Linux-uvc-devel] Problems setting manual exposure on Creative	Live! Cam Optia
</A></li>
	<LI>Next message: <A HREF="003822.html">[Linux-uvc-devel] Skype not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3849">[ date ]</a>
              <a href="thread.html#3849">[ thread ]</a>
              <a href="subject.html#3849">[ subject ]</a>
              <a href="author.html#3849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
