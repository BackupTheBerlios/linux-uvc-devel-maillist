<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] Issue with recent uvcvideo
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Issue%20with%20recent%20uvcvideo&In-Reply-To=%3C200811121512.30959.laurent.pinchart%40skynet.be%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004210.html">
   <LINK REL="Next"  HREF="004215.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] Issue with recent uvcvideo</H1>
    <B>Laurent Pinchart</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20Issue%20with%20recent%20uvcvideo&In-Reply-To=%3C200811121512.30959.laurent.pinchart%40skynet.be%3E"
       TITLE="[Linux-uvc-devel] Issue with recent uvcvideo">laurent.pinchart at skynet.be
       </A><BR>
    <I>Wed Nov 12 15:12:30 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="004210.html">[Linux-uvc-devel] Issue with recent uvcvideo
</A></li>
        <LI>Next message: <A HREF="004215.html">[Linux-uvc-devel] Issue with recent uvcvideo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4213">[ date ]</a>
              <a href="thread.html#4213">[ thread ]</a>
              <a href="subject.html#4213">[ subject ]</a>
              <a href="author.html#4213">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Filippo,

On Wednesday 12 November 2008, Filippo Argiolas wrote:
&gt;<i> On mer, 2008-11-12 at 11:38 +0100, Laurent Pinchart wrote:
</I>&gt;<i> &gt; Then, and this might be the real issue here, the application calls
</I>&gt;<i> &gt; VIDIOC_S_FMT but libv4l doesn't relay that to the driver. I suppose
</I>&gt;<i> &gt; there's a check in the library that compares the requested format with
</I>&gt;<i> &gt; the current format and returns immediately if they are identical. This
</I>&gt;<i> &gt; means the camera doesn't receive any set format request between the two
</I>&gt;<i> &gt; runs. I wouldn't be surprised if camera developers never expected that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As a quick workaround, could you please try the attached patch ? It
</I>&gt;<i> &gt; modifies device initialisation to make sure a set format request is send
</I>&gt;<i> &gt; right before starting the video stream.
</I>&gt;<i>
</I>&gt;<i> It seems you are right, with this patch applied I can run the gst-launch
</I>&gt;<i> pipeline plenty of times without any lock. Cheese seems fixed too
</I>&gt;<i> (webcam startup is a bit slow when the maximum resolution is set but itd
</I>&gt;<i> did always behave this way).
</I>&gt;<i> So where is the right place to fix this?
</I>
Probably in the driver, as what libv4l does is valid according the the V4L2 
specification. I'll commit the patch (to the uvcvideo hg repository on 
linuxtv.org, the switch from SVN is not complete) and hope it won't disturb 
other cameras.

I suppose the change should be pushed to Ubuntu 8.10 as well. Do you have 
contacts with the Ubuntu kernel maintainers ?

&gt;<i> &gt; I'm moving from the SVN repository on Berlios to Mercurial on
</I>&gt;<i> &gt; linuxtv.org. It was easier for me yesterday to generate the patch against
</I>&gt;<i> &gt; SVN.
</I>&gt;<i>
</I>&gt;<i> Thanks for making it clear.
</I>
You're welcome.

Best regards,

Laurent Pinchart

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004210.html">[Linux-uvc-devel] Issue with recent uvcvideo
</A></li>
	<LI>Next message: <A HREF="004215.html">[Linux-uvc-devel] Issue with recent uvcvideo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4213">[ date ]</a>
              <a href="thread.html#4213">[ thread ]</a>
              <a href="subject.html#4213">[ subject ]</a>
              <a href="author.html#4213">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
