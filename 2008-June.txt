From juhovh at iki.fi  Sun Jun  1 04:20:19 2008
From: juhovh at iki.fi (Juho =?ISO-8859-1?Q?V=E4h=E4-Herttua?=)
Date: Sun, 01 Jun 2008 10:20:19 +0800
Subject: [Linux-uvc-devel] About SiGma Micro USB Web Camera support
Message-ID: <1212286819.7322.11.camel@prudent>

Hi,

I revently bought a SiGma Micro camera and am pretty happy with it,
since as it's UVC compliant it works out-of-the-box on windows and mac.
On Linux it does work with uvcvideo, but the only application I have
been able to make it work is luvcview, which means that the camera
itself doesn't have a problem. However I haven't been able to get it to
work with any other application, which is a pity.

Now if I check the luvcview -L it shows the following:

luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
/dev/video0 does not support read i/o
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 320, height = 240 }
	Time interval between frame: {min { 1/30 } .. max { 1/15 } / stepsize
{ 1/30 } }, 
{ discrete: width = 640, height = 480 }
	Time interval between frame: {min { 1/30 } .. max { 1/15 } / stepsize
{ 1/30 } }, 
{ discrete: width = 160, height = 120 }
	Time interval between frame: {min { 1/30 } .. max { 1/15 } / stepsize
{ 1/30 } }, 


It looks like my camera only supports MJPEG modes and this is supported
by the fact that if I start to run luvcview in yuv mode, it fails to
run:

luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
Unable to set format: 22.
 Init v4L2 failed !! exit fatal 

Now my question is, if uvcvideo driver would do some MJPEG->YUV
conversion, would it be possible to make my camera work in other or at
least applications? I could try to experiment with this stuff myself too
if someone would point me to the correct direction.

I also assume that SiGma Micro is even actively developed since r211
patch is SiGma specific and r212 frameintervals fix also fixed the thing
on SiGma, thanks for that. :) If there's anything I can do, let me know.


Regards,

Juho V?h?-Herttua




From sparks.m at gmail.com  Wed Jun  4 15:51:36 2008
From: sparks.m at gmail.com (Michael Sparks)
Date: Wed, 4 Jun 2008 14:51:36 +0100
Subject: [Linux-uvc-devel] PATCH: Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.)
Message-ID: <20e5c9660806040651k2a76c98bsfeaef17fbe7b1abc@mail.gmail.com>

Hi,


I've got an Acer laptop with a Crystal Eye WebCam which identifies as follows:

Bus 003 Device 002: ID 064e:a101 Suyin Corp.

This is listed as a supported device here:
http://linux-uvc.berlios.de/#devices

But in practice using the current subversion checkout:

URL: svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
Repository Root: svn://svn.berlios.de/linux-uvc
Repository UUID: 790547d8-3c09-0410-a358-857946b093de
Revision: 212
Node Kind: directory
Schedule: normal
Last Changed Author: pinchartl
Last Changed Rev: 212
Last Changed Date: 2008-05-29 15:56:11 +0100 (Thu, 29 May 2008)

When compiled and running (say), luvcview, I get this error:
~/Incoming> luvcview
luvcview 0.2.4

[snip]
Unable to start capture: Protocol error
Error grabbing
Cleanup done. Exiting ...

I get similar errors from other software (eg opencv, python v4l2 bindings, etc):
~/Incoming> ./WebCam.py
Traceback (most recent call last):
  File "./WebCam.py", line 238, in <module>
    VideoCaptureSource(fps=32),
  File "./WebCam.py", line 139, in __init__
    self.camera.start()
EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 71, Protocol error

It turns out that, for whatever reason, when the above error occurs,
it switches on the webcam. (a little green light comes on). Rerunning
results in the program then normally working (but green light goes out
on exit, etc). Then failing when rerun again (leaving light on), etc.

Anyway, I hunted down the problem - the "Protocol Error" is actually
caused by this line:
uvc_video.c

               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
                       return ret;

So it's *something* to do with the device presumably not always being
switched "on" I guess. How that is supposed to be done, I don't know.

HOWEVER, I have made a patch to uvc_video.c that works:

~/linux-uvc> svn diff
Index: uvc_video.c
===================================================================
--- uvc_video.c (revision 212)
+++ uvc_video.c (working copy)
@@ -750,8 +750,13 @@
                if (i >= intf->num_altsetting)
                        return -EIO;

-               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
-                       return ret;
+               if ((ret = usb_set_interface(video->dev->udev,
intfnum, i)) < 0) {
+                       if (ret == -71) { // If we get this error,
give it another go & retry
+                               if ((ret =
usb_set_interface(video->dev->udev, intfnum, i)) < 0)
+                                       return ret;
+                       } else
+                               return ret;
+               }

                ret = uvc_init_video_isoc(video, ep);
        } else {

You'll note that I just blindly give the same call another go. The
first one manages to
switch the green light on, the second causes it to be useful/usable.

This rather surprisingly worked, and so this has fixed this issue with
this webcam as used by the following software:
   * pygame.camera
   * opencv
   * luvcview
   * Skype

If this isn't the "correct" way of doing this,please let me know what
to test and I'll try a
different patch :-)

BTW, many thanks for writing this module - it's great/really useful :-)

Regards,


Michael.


From brandon at ifup.org  Wed Jun  4 20:43:18 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 4 Jun 2008 11:43:18 -0700
Subject: [Linux-uvc-devel] [PATCH] uvc: release streaming interface
	to	fix suspend to RAM
In-Reply-To: <200805311840.03003.laurent.pinchart@skynet.be>
References: <20080529234147.GA2353@plankton.ifup.org>
	<200805311840.03003.laurent.pinchart@skynet.be>
Message-ID: <20080604184318.GA4839@plankton.ifup.org>

On 18:40 Sat 31 May 2008, Laurent Pinchart wrote:
> > Index: uvc/uvc_driver.c
> > ===================================================================
> > --- uvc.orig/uvc_driver.c
> > +++ uvc/uvc_driver.c
> > @@ -865,6 +865,8 @@ static int uvc_parse_standard_control(st
> >
> >  			if (uvc_parse_streaming(dev, streaming) < 0) {
> >  				usb_put_intf(intf);
> > +				usb_driver_release_interface(&uvc_driver.driver,
> > +					intf);
> >  				kfree(streaming->format);
> >  				kfree(streaming->header.bmaControls);
> >  				kfree(streaming);
> > @@ -1524,6 +1526,8 @@ void uvc_delete(struct kref *kref)
> >  		struct uvc_streaming *streaming;
> >  		streaming = list_entry(p, struct uvc_streaming, list);
> >  		usb_put_intf(streaming->intf);
> > +		usb_driver_release_interface(&uvc_driver.driver,
> > +			streaming->intf);
> >  		kfree(streaming->format);
> >  		kfree(streaming->header.bmaControls);
> >  		kfree(streaming);
>
> Shouldn't usb_driver_release_interface be called before usb_put_intf ? It 
> looks like the interface can be freed by usb_put_intf otherwise.

Yes that is correct; I should have seen that 8-)

> You are also missing an error path (kzalloc returning NULL right after
> claiming the interface).

Good point.

> Here is a modified version of your patch that cleans up the driver
> code a little as well. It works fine here, could you please test it ? 

The patch looks good, works for me and doesn't claim the interface with
my test.  Thanks.  I will try and get the user from the original bug to
test it too.

Signed-off-by: Brandon Philips <bphilips at suse.de>


From brandon at ifup.org  Wed Jun  4 21:10:48 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 4 Jun 2008 12:10:48 -0700
Subject: [Linux-uvc-devel] [PATCH] uvc: release streaming interface
	to	fix suspend to RAM
In-Reply-To: <200805311840.03003.laurent.pinchart@skynet.be>
References: <20080529234147.GA2353@plankton.ifup.org>
	<200805311840.03003.laurent.pinchart@skynet.be>
Message-ID: <20080604191048.GA5365@plankton.ifup.org>

Hey Laurent-

I think the patch is incomplete.  Maybe I am missing something obvious?

Thanks,

	Brandon

On 18:40 Sat 31 May 2008, Laurent Pinchart wrote:
> @@ -561,7 +586,7 @@
>  	if (buflen <= 2) {
>  		uvc_trace(UVC_TRACE_DESCR, "no class-specific streaming "
>  			"interface descriptors found.\n");
> -		return -EINVAL;

		ret = -EINVAL

> +		goto error;
>  	}
>  
>  	/* Parse the header descriptor. */
> @@ -569,7 +594,7 @@
>  		uvc_trace(UVC_TRACE_DESCR, "device %d videostreaming interface "
>  			"%d OUTPUT HEADER descriptor is not supported.\n",
>  			dev->udev->devnum, alts->desc.bInterfaceNumber);
> -		return -EINVAL;

		ret = -EINVAL

> +		goto error;
>  	} else if (buffer[2] == VS_INPUT_HEADER) {
>  		p = buflen >= 5 ? buffer[3] : 0;
>  		n = buflen >= 12 ? buffer[12] : 0;
> @@ -579,7 +604,7 @@
>  				"interface %d INPUT HEADER descriptor is "
>  				"invalid.\n", dev->udev->devnum,
>  				alts->desc.bInterfaceNumber);
> -			return -EINVAL;

		ret = -EINVAL

> +			goto error;
>  		}
>  
>  		streaming->header.bNumFormats = p;
> @@ -592,15 +617,17 @@
>  		streaming->header.bControlSize = n;
>  
>  		streaming->header.bmaControls = kmalloc(p*n, GFP_KERNEL);
> -		if (streaming->header.bmaControls == NULL)
> -			return -ENOMEM;
> +		if (streaming->header.bmaControls == NULL) {
> +			ret = -ENOMEM;
> +			goto error;
> +		}
>  
>  		memcpy(streaming->header.bmaControls, &buffer[13], p*n);
>  	} else {
>  		uvc_trace(UVC_TRACE_DESCR, "device %d videostreaming interface "
>  			"%d HEADER descriptor not found.\n", dev->udev->devnum,
>  			alts->desc.bInterfaceNumber);
> -		return -EINVAL;

		ret = -EINVAL

> +		goto error;
>  	}
>  
>  	buflen -= buffer[0];
> @@ -657,14 +684,16 @@
>  		uvc_trace(UVC_TRACE_DESCR, "device %d videostreaming interface "
>  			"%d has no supported formats defined.\n",
>  			dev->udev->devnum, alts->desc.bInterfaceNumber);
> -		return -EINVAL;

		ret = -EINVAL

> +		goto error;
>  	}


From Nephyrin at doublezen.net  Wed Jun  4 21:18:44 2008
From: Nephyrin at doublezen.net (John Schoenick)
Date: Wed, 4 Jun 2008 12:18:44 -0700
Subject: [Linux-uvc-devel] (046d:09a1) QuickCam Communicate MP
Message-ID: <4e2d7e1e0806041218w6021efc4g19266889c14158dd@mail.gmail.com>

I just picked up a "QuickCam Communicate MP":
http://www.logitech.com/index.cfm/webcam_communications/webcams/devices/4224&cl=us,en

From chris at bareflix.com  Wed Jun  4 21:23:15 2008
From: chris at bareflix.com (Chris Bare)
Date: Wed, 4 Jun 2008 15:23:15 -0400 (EDT)
Subject: [Linux-uvc-devel] is the svn server down?
Message-ID: <20080604192315.D47A64D284E@bareflix.com>

I am trying the svn command listed on the home page and I get:

% svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
svn: Can't connect to host 'svn.berlios.de': Connection refused

-- 
Chris Bare
chris at bareflix.com


From juhovh at iki.fi  Thu Jun  5 08:14:07 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Thu, 5 Jun 2008 14:14:07 +0800
Subject: [Linux-uvc-devel] About SiGma Micro USB Web Camera support
In-Reply-To: <1212286819.7322.11.camel@prudent>
References: <1212286819.7322.11.camel@prudent>
Message-ID: <63BB291C-CA91-4620-B5D0-FCD8DB385BA9@iki.fi>

On 1.6.2008, at 10.20, Juho V?h?-Herttua wrote:
> Now my question is, if uvcvideo driver would do some MJPEG->YUV
> conversion, would it be possible to make my camera work in other or at
> least applications? I could try to experiment with this stuff  
> myself too
> if someone would point me to the correct direction.

It appears there is http://www.linuxtv.org/v4lwiki/index.php/ 
V4L2UserspaceLibrary project that would do MJPEG->YUV conversion in  
userspace if any, I do admit that doing it in the driver would be  
stupid. However it looks like there is also the gstfakevideo that can  
do the conversion using gstreamer since V4L2 solution is not quite  
ready yet. However in the case of SiGma Micro it fails as well.

> I also assume that SiGma Micro is even actively developed since r211
> patch is SiGma specific and r212 frameintervals fix also fixed the  
> thing
> on SiGma, thanks for that. :) If there's anything I can do, let me  
> know.

I just realized after reading mailing lists that before that patch it  
wasn't on the supported list at all. And I am not sure if it should  
be there quite yet. As mentioned the camera works with luvcview, but  
that is the only application it works with. I can't use gstfakevideo,  
because gstreamer gives the error message Lorenzo Battistini already  
mentioned:

Failed querying control 9963788 on device '/dev/video0'. (5 - Input/ 
output error)

Ekiga, mplayer, etc. all fail as well. On both Windows and Mac OS X  
the camera works like a charm. If anyone has any ideas where the  
problem is, I would be happy to hear them. Meanwhile I will try to  
research myself and will keep posting possible updates here. Getting  
the gstfakevideo would already be enough, because I believe it will  
fix all the applications with its YUV conversion...


Juho
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080605/aa4c5b5a/attachment.pgp>

From barsnick at gmx.net  Thu Jun  5 11:27:53 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Thu, 5 Jun 2008 11:27:53 +0200
Subject: [Linux-uvc-devel] is the svn server down?
In-Reply-To: <20080604192315.D47A64D284E@bareflix.com>
References: <20080604192315.D47A64D284E@bareflix.com>
Message-ID: <20080605092753.GC13620@sunshine.barsnick.net>

Hi Chris,

On Wed, Jun 04, 2008 at 15:23:15 -0400, Chris Bare wrote:
> % svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
> svn: Can't connect to host 'svn.berlios.de': Connection refused

Hmm, works for me. Have you tried again since? Perhaps you hit a "bad
moment".

Moritz


From vindex+lists-linux-uvc-devel at apartia.org  Thu Jun  5 11:38:43 2008
From: vindex+lists-linux-uvc-devel at apartia.org (Louis-David Mitterrand)
Date: Thu, 5 Jun 2008 11:38:43 +0200
Subject: [Linux-uvc-devel] "uvcvideo: Failed to resubmit video URB (-45)"
In-Reply-To: <20080605093620.GA14921@apartia.fr>
References: <20080605093620.GA14921@apartia.fr>
Message-ID: <20080605093843.GA14968@apartia.fr>

On Thu, Jun 05, 2008 at 11:36:20AM +0200, Louis-David Mitterrand wrote:
> Hi,
> 
> Using kernel 2.6.25.4 and uvcvideo's latest SVN (r212), I get this error
> after a few minutes of running motion:
> 
> uvcvideo: Failed to resubmit video URB (-45)
> 
> After that message the video transmission hangs.

Sorry I forgot to add the camera model:

	Jun  5 11:36:34 caere motion: [1] cap.card: "Philips SPC 1300NC Webcam"
	Jun  5 11:36:34 caere motion: [1] cap.bus_info: "0000:05:08.2"
	Jun  5 11:36:34 caere motion: [1] cap.capabilities=0x04000001
	Jun  5 11:36:34 caere motion: [1] - VIDEO_CAPTURE
	Jun  5 11:36:34 caere motion: [1] - STREAMING
	Jun  5 11:36:34 caere motion: [1] Supported palettes:
	Jun  5 11:36:34 caere motion: [1] 0: YUYV (YUV 4:2:2 (YUYV))
	Jun  5 11:36:34 caere motion: [1] 1: MJPG (MJPEG)
	Jun  5 11:36:34 caere motion: [1] Test palette YUYV (640x480)
	Jun  5 11:36:34 caere motion: [1] Using palette YUYV (640x480) bytesperlines 128

And the USB controller is an add-in PCI card (old PC with no on-board USB2):

05:08.2 USB Controller: NEC Corporation USB 2.0 (rev 02)


From vindex+lists-linux-uvc-devel at apartia.org  Thu Jun  5 11:36:20 2008
From: vindex+lists-linux-uvc-devel at apartia.org (Louis-David Mitterrand)
Date: Thu, 5 Jun 2008 11:36:20 +0200
Subject: [Linux-uvc-devel] "uvcvideo: Failed to resubmit video URB (-45)"
Message-ID: <20080605093620.GA14921@apartia.fr>

Hi,

Using kernel 2.6.25.4 and uvcvideo's latest SVN (r212), I get this error
after a few minutes of running motion:

uvcvideo: Failed to resubmit video URB (-45)

After that message the video transmission hangs.

thanks


From tpreitzel at hotmail.com  Thu Jun  5 13:09:23 2008
From: tpreitzel at hotmail.com (TP Reitzel)
Date: Thu, 5 Jun 2008 11:09:23 +0000
Subject: [Linux-uvc-devel] VF0410 Creative Live! Cam IM Pro Flicker Filter
Message-ID: <BAY143-W134BC493A28C4A0075A41EB2B40@phx.gbl>


When using the latest revision, 212, I receive the following error when trying to change the frequency filter with luvcview:

luvcview -d /dev/video0
luvcview 0.2.4

SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
Stream settings:
  Frame format: MJPG
  Frame size:   640x480
  Frame rate:   30 fps
ioctl querycontrol error: Invalid argument
Get value of light frequency filter error
Current light frequency filter: 50Hz
ioctl querycontrol error: Invalid argument
Switch light frequency filter error




_________________________________________________________________
Now you can invite friends from Facebook and other groups to join you on Windows Live? Messenger. Add now.
https://www.invite2messenger.net/im/?source=TXT_EML_WLH_AddNow_Now
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080605/e98501ee/attachment.html>

From welshman at welshweb.net  Thu Jun  5 17:18:08 2008
From: welshman at welshweb.net (David)
Date: Thu, 05 Jun 2008 17:18:08 +0200
Subject: [Linux-uvc-devel] Hercules dualpix chat and show webcam.
Message-ID: <1212679088.8225.10.camel@david-desktop>

I noticed on http://linux-uvc.berlios.de/#devices that the 06f8:3005
Hercules Dualpix Exchange Guillemot Corp works with the uvc driver.

Do you think there is a chance to get my webcam to work in Ubuntu 8.04?

The lsusb output reads like this...
 Bus 006 Device 002: ID 06f8:3007 Guillemot Corp. 

Obviously I do not give a hoot about the chat and show software, I just
would like to get the cam to work in Linux.

Any help would be appreciated.

David



From laurent.pinchart at skynet.be  Thu Jun  5 23:09:27 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jun 2008 23:09:27 +0200
Subject: [Linux-uvc-devel] About SiGma Micro USB Web Camera support
In-Reply-To: <63BB291C-CA91-4620-B5D0-FCD8DB385BA9@iki.fi>
References: <1212286819.7322.11.camel@prudent>
	<63BB291C-CA91-4620-B5D0-FCD8DB385BA9@iki.fi>
Message-ID: <200806052309.27488.laurent.pinchart@skynet.be>

Hi Juho,

On Thursday 05 June 2008, Juho V?h?-Herttua wrote:
> On 1.6.2008, at 10.20, Juho V?h?-Herttua wrote:
> > Now my question is, if uvcvideo driver would do some MJPEG->YUV
> > conversion, would it be possible to make my camera work in other or at
> > least applications? I could try to experiment with this stuff
> > myself too if someone would point me to the correct direction.
>
> It appears there is http://www.linuxtv.org/v4lwiki/index.php/
> V4L2UserspaceLibrary project that would do MJPEG->YUV conversion in
> userspace if any, I do admit that doing it in the driver would be
> stupid. However it looks like there is also the gstfakevideo that can
> do the conversion using gstreamer since V4L2 solution is not quite
> ready yet. However in the case of SiGma Micro it fails as well.

Format conversion doesn't belong in the kernel. Linus Torvald has been quite 
clear on that.

There is currently no universal userspace solution. The gstreamer framework is 
interesting but not as stable as it should be with v4l2 devices. Other 
projects such as the one you mentioned have been started but are usually 
nowhere near completion.

> > I also assume that SiGma Micro is even actively developed since r211
> > patch is SiGma specific and r212 frameintervals fix also fixed the
> > thing on SiGma, thanks for that. :) If there's anything I can do, let me
> > know.
>
> I just realized after reading mailing lists that before that patch it
> wasn't on the supported list at all. And I am not sure if it should
> be there quite yet. As mentioned the camera works with luvcview, but
> that is the only application it works with. I can't use gstfakevideo,
> because gstreamer gives the error message Lorenzo Battistini already
> mentioned:
>
> Failed querying control 9963788 on device '/dev/video0'. (5 - Input/
> output error)

I had a closer look at the USB descriptors. The camera reports a selector unit 
and two input terminals, one for the camera sensor and one for a composite 
input.

Does your webcam really have multiple inputs ?

> Ekiga, mplayer, etc. all fail as well. On both Windows and Mac OS X
> the camera works like a charm. If anyone has any ideas where the
> problem is, I would be happy to hear them. Meanwhile I will try to
> research myself and will keep posting possible updates here. Getting
> the gstfakevideo would already be enough, because I believe it will
> fix all the applications with its YUV conversion...

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jun  5 23:13:00 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jun 2008 23:13:00 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <3d7891440805300512o43d97bdcp2f104726aeda819a@mail.gmail.com>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805292117.30490.laurent.pinchart@skynet.be>
	<3d7891440805300512o43d97bdcp2f104726aeda819a@mail.gmail.com>
Message-ID: <200806052313.00384.laurent.pinchart@skynet.be>

Hi Lorenzo,

On Friday 30 May 2008, Lorenzo Battistini wrote:
> Hi Laurent,
>
> 2008/5/29 Laurent Pinchart <laurent.pinchart at skynet.be>:
> > Hi Lorenzo,
> >
> > On Monday 26 May 2008, Lorenzo Battistini wrote:
> >> Hi Laurent
> >>
> >> 2008/5/23 Laurent Pinchart <laurent.pinchart at skynet.be>:
> >> > Hi Lorenzo,
> >> >
> >> > On Wednesday 21 May 2008, Lorenzo Battistini wrote:
> >> >> Thanks Laurent,
> >> >> tha patch permits to view video stream through luvcview.
> >> >
> >> > Thanks for the report.
> >> >
> >> >> But, for now, it's the only software that I was able to use.
> >> >> For example, gqcam gives "Error reading image..." and a green screen;
> >> >
> >> > gqcam is old an unmaintained. It doesn't support V4L2.
> >> >
> >> >> skype gives
> >> >>
> >> >> Skype V4L2: Could not find a suitable capture format
> >> >> Skype V4L2: Could not find a suitable capture format
> >> >> Skype V4L2: Could not find a suitable capture format
> >> >> Skype V4L2: Could not find a suitable capture format
> >> >> Starting the process...
> >> >> Skype Xv: Xv ports available: 1
> >> >> Skype XShm: XShm support enabled
> >> >> Skype Xv: Using Xv port 73
> >> >> Skype Xv: No suitable overlay format found
> >> >
> >> > Your camera supports MJPEG only. Maybe Skype doesn't implement MJPEG
> >> > decoding ?
> >> >
> >> >> and a black screen.
> >> >>
> >> >> Loading the patched driver, kernel says:
> >> >>
> >> >> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
> >> >> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp.
> >> >> 26). input: USB Web Camera as
> >> >> /devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
> >> >> usbcore: registered new interface driver uvcvideo
> >> >> USB Video Class driver (SVN r209)
> >> >
> >> > If you're looking for a video conferencing application try Ekiga. It
> >> > should work with the Linux UVC driver.
> >>
> >> But ekiga gives "Error while opening video device USB Web" (I didn't
> >> find details).
> >
> > Could you please check the kernel log after Ekiga's failure and report
> > any message printed by the driver ?
>
> Sure. I didn't think of it.
>
> uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).

The error logged by the driver is a VIDIOC_S_INPUT failure.

I had a closer look at the USB descriptors. The reports has a selector unit 
and two input terminals, one for the sensor and one for a composite input. 
Does your camera really have a composite input ?

Best regards,

Laurent Pinchart


From roger.pierce at gmail.com  Thu Jun  5 23:39:18 2008
From: roger.pierce at gmail.com (Roger Pierce)
Date: Thu, 05 Jun 2008 16:39:18 -0500
Subject: [Linux-uvc-devel] UVC-compliant webcam not working
Message-ID: <20080605163918.3d129d96@mailhost.frost-electric.com>

Laurent, 

No, it does not. That would be cool though :)

Thanks. 

----- Original Message -----
From: Laurent Pinchart [mailto:laurent.pinchart at skynet.be]
To: roger.pierce at gmail.com
Subject: Re: [Linux-uvc-devel] UVC-compliant webcam not working


> Hi Roger,
> 
> On Friday 30 May 2008, Roger Pierce wrote:
> > Laurent,
> >
> > Sorry, I've tried a few times and the only program that seems to work with
> > the camera is luvcveiw. The error about failing to query is the only one
> > that seems to be logged as far as I can tell.
> 
> The error logged by the driver is a VIDIOC_S_INPUT failure.
> 
> I had a closer look at the USB descriptors. The reports has a selector unit 
> and two input terminals, one for the sensor and one for a composite input. 
> Does your camera really have a composite input ?
> 
> Best regards,
> 
> Laurent Pinchart
> 


From laurent.pinchart at skynet.be  Thu Jun  5 23:52:40 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jun 2008 23:52:40 +0200
Subject: [Linux-uvc-devel]
	=?iso-8859-1?q?=5BPATCH=5D_uvc=3A_release_strea?=
	=?iso-8859-1?q?ming_interface_to=09fix_suspend_to_RAM?=
In-Reply-To: <20080604191048.GA5365@plankton.ifup.org>
References: <20080529234147.GA2353@plankton.ifup.org>
	<200805311840.03003.laurent.pinchart@skynet.be>
	<20080604191048.GA5365@plankton.ifup.org>
Message-ID: <200806052352.40926.laurent.pinchart@skynet.be>

On Wednesday 04 June 2008, Brandon Philips wrote:
> Hey Laurent-
>
> I think the patch is incomplete.  Maybe I am missing something obvious?

You're right, my bad. Thanks for catching this.

I've applied the patch to SVN.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jun  5 23:53:32 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jun 2008 23:53:32 +0200
Subject: [Linux-uvc-devel] (046d:09a1) QuickCam Communicate MP
In-Reply-To: <4e2d7e1e0806041218w6021efc4g19266889c14158dd@mail.gmail.com>
References: <4e2d7e1e0806041218w6021efc4g19266889c14158dd@mail.gmail.com>
Message-ID: <200806052353.32299.laurent.pinchart@skynet.be>

Hi John,

On Wednesday 04 June 2008, John Schoenick wrote:
> I just picked up a "QuickCam Communicate MP":
> http://www.logitech.com/index.cfm/webcam_communications/webcams/devices/422
>4&cl=us,en From best buy, which appears to be replacing the Communicate STX.
> It's not currently listed on your devices list, but, using the
> Gentoo/Portage linux-uvc-0.1.0_pre173 package, this Camera works perfectly
> (luvcview + skype)
>
> Below is an ungodly amount of information from lsusb. Let me know if
> there's anything else I can do to be of assistance.

Thanks for the report. I've added the model to the supported devices list on 
the website.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jun  6 00:43:59 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jun 2008 00:43:59 +0200
Subject: [Linux-uvc-devel] Hercules dualpix chat and show webcam.
In-Reply-To: <1212679088.8225.10.camel@david-desktop>
References: <1212679088.8225.10.camel@david-desktop>
Message-ID: <200806060043.59611.laurent.pinchart@skynet.be>

Hi David,

On Thursday 05 June 2008, David wrote:
> I noticed on http://linux-uvc.berlios.de/#devices that the 06f8:3005
> Hercules Dualpix Exchange Guillemot Corp works with the uvc driver.
>
> Do you think there is a chance to get my webcam to work in Ubuntu 8.04?
>
> The lsusb output reads like this...
>  Bus 006 Device 002: ID 06f8:3007 Guillemot Corp.
>
> Obviously I do not give a hoot about the chat and show software, I just
> would like to get the cam to work in Linux.

I'll need the output of

lsusb -v -d 06f8:3007

to answer the question.

Best regards,

Laurent Pinchart


From sparks.m at gmail.com  Fri Jun  6 01:26:01 2008
From: sparks.m at gmail.com (MIchael Sparks)
Date: Fri, 6 Jun 2008 00:26:01 +0100
Subject: [Linux-uvc-devel] PATCH: Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.)
Message-ID: <200806060026.02177.sparks.m@gmail.com>

Hi,


[ I tried sending this yesterday, but it doesn't seem to have hit the
  archives, and I did't receive a copy, so I'm resending it. Apologies
  if its seen twice! ]

I've got an Acer laptop with a built in Crystal Eye WebCam which identifies
as follows:

    Bus 003 Device 002: ID 064e:a101 Suyin Corp.

This is listed as a supported device here:
http://linux-uvc.berlios.de/#devices

But in practice using the current subversion checkout:

    Repository Root: svn://svn.berlios.de/linux-uvc
    Repository UUID: 790547d8-3c09-0410-a358-857946b093de
    Revision: 212
    Node Kind: directory
    Schedule: normal
    Last Changed Author: pinchartl
    Last Changed Rev: 212
    Last Changed Date: 2008-05-29 15:56:11 +0100 (Thu, 29 May 2008)

When compiled and running (say), luvcview, I get this error:
    ~/Incoming> luvcview
    luvcview 0.2.4
    [... snip ...]
    Unable to start capture: Protocol error
    Error grabbing
    Cleanup done. Exiting ...

I get similar errors from other software (eg opencv, python v4l2
bindings, etc):

    ~/Incoming> ./WebCam.py
    Traceback (most recent call last):
     File "./WebCam.py", line 238, in <module>
       VideoCaptureSource(fps=32),
     File "./WebCam.py", line 139, in __init__
       self.camera.start()
    EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 71, Protocol error

It turns out that, for whatever reason, when the above error occurs,
it switches on the webcam. (a little green light comes on). Rerunning
results in the program then normally working (but green light goes out
on exit, etc). Then failing when rerun again (leaving light on), etc.

Anyway, I hunted down the problem - the "Protocol Error" is actually
caused by this line...

    uvc_video.c
              if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
                      return ret;

... switching it "on" I guess. How that is supposed to be done, I don't
know, but it does switch it on. So, I fiddled...

And based on that, I have made a patch to uvc_video.c that works:

~/linux-uvc> svn diff
Index: uvc_video.c
===================================================================
--- uvc_video.c (revision 212)
+++ uvc_video.c (working copy)
@@ -750,8 +750,13 @@
               if (i >= intf->num_altsetting)
                       return -EIO;

-               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
-                       return ret;
+               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0) {
+                       if (ret == -71) { // If we get this error, give it another go & retry
+                               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
+                                       return ret;
+                       } else
+                               return ret;
+               }

               ret = uvc_init_video_isoc(video, ep);
       } else {




You'll note that I just blindly give the same call another go - I realise
this is probably wrong, but I don't know what the right thing would be.
It does have the merit of working. It seems that this is because the
first call manages to switch the green light on, and the second causes
it to be useful/usable.

This has rather surprisingly worked, and so this has fixed this issue with
this webcam as used by the following software:
  * pygame.camera
  * opencv
  * luvcview
  * Skype

As a result, hopefully the patch above is useful.

If this isn't the "correct" way of doing this,please let me know what
to test and I'll try a different patch :-)

BTW, many thanks for writing this module - it's great/really useful :-)

Best Regards,


Michael.



From juhovh at iki.fi  Fri Jun  6 07:14:35 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Fri, 6 Jun 2008 13:14:35 +0800
Subject: [Linux-uvc-devel] About SiGma Micro USB Web Camera support
In-Reply-To: <200806052309.27488.laurent.pinchart@skynet.be>
References: <1212286819.7322.11.camel@prudent>
	<63BB291C-CA91-4620-B5D0-FCD8DB385BA9@iki.fi>
	<200806052309.27488.laurent.pinchart@skynet.be>
Message-ID: <E1C1C047-DA10-42BA-BB37-FDCF8C18FD96@iki.fi>

On 6.6.2008, at 5.09, Laurent Pinchart wrote:
> Format conversion doesn't belong in the kernel. Linus Torvald has  
> been quite
> clear on that.

I agree with that.

> There is currently no universal userspace solution. The gstreamer  
> framework is
> interesting but not as stable as it should be with v4l2 devices. Other
> projects such as the one you mentioned have been started but are  
> usually
> nowhere near completion.

So have to just wait...but until that need to get the driver issues  
fixed.

> I had a closer look at the USB descriptors. The camera reports a  
> selector unit
> and two input terminals, one for the camera sensor and one for a  
> composite
> input.
>
> Does your webcam really have multiple inputs ?

No, and I have no idea what the composite input is doing there  
actually... If you think it might disturb something I can test it.  
However yesterday I had some time to dig into it and what I've found  
out so far:

Failed querying control 9963788 on device '/dev/video0'. (5 - Input/ 
output error)

The mentioned query control in hex is 0x98090C which in turn is White  
Balance Temperature, Auto. If I make an exclusion in for example  
uvc_find_control where I add the exclusion:

if (v4l2_id == 0x0098090c) return;

then the camera will work just fine. If I do an lsusb -v it will print:

         bmControls     0x0000163f
           Brightness
           Contrast
           Hue
           Saturation
           Sharpness
           Gamma
           Gain
           Power Line Frequency
           White Balance Temperature, Auto

So the camera is reporting to support the white balance temperature  
auto setting, no problem with the driver there. Then if I check the  
kernel logs while running the driver I can find:

[ 1599.394979] uvcvideo: Failed to query (135) UVC control 11 (unit  
5) : -32 (exp. 1).

This is the part where the device actually fails. The gstreamer  
program does a GET_DEF request (135) to the "White Balance  
Temperature, Auto" (11) which then returns the error code -32, which  
seems to be a general error code because I also get it for  
nonexistant controls. By the spec  
PU_WHITE_BALANCE_COMPONENT_AUTO_CONTROL should also support the  
commands SET_CUR, GET_CUR, GET_INFO, GET_DEF so I tried to do  
GET_INFO and GET_CUR for it instead of GET_DEF. But all fail exactly  
the same way. I haven't tried SET_CUR because it requires a bit more  
modifications, but will test it if I have time.

Now how do you think, is the camera faulty with reporting the White  
Balance Temperature, Auto or is there still something that could be  
done? If it's considered to be faulty I can add a hack to ignore the  
white balance thing for this camera type and test it...

Oh and could add luvcview output also for reference to show it really  
fails with it:

juhovh at prudent:~/Source/linux-uvc$ luvcview -l
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean  
3=Menu 4=Button)
V4L2_CID_BASE         (predefined controls):
  index:9963776    name:Brightness                       type:1  
min:-16   max:16    step:1     def:0     now:0
  index:9963777    name:Contrast                         type:1 min: 
0     max:15    step:1     def:0     now:0
  index:9963778    name:Saturation                       type:1 min: 
0     max:50    step:1     def:25    now:25
  index:9963779    name:Hue                              type:1  
min:-18   max:18    step:1     def:0     now:0
error getting base controls

After patching it to ignore the white balance I get:

juhovh at prudent:~/Source/linux-uvc$ luvcview -l
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean  
3=Menu 4=Button)
V4L2_CID_BASE         (predefined controls):
  index:9963776    name:Brightness                       type:1  
min:-16   max:16    step:1     def:0     now:0
  index:9963777    name:Contrast                         type:1 min: 
0     max:15    step:1     def:0     now:0
  index:9963778    name:Saturation                       type:1 min: 
0     max:50    step:1     def:25    now:25
  index:9963779    name:Hue                              type:1  
min:-18   max:18    step:1     def:0     now:0
  index:9963792    name:Gamma                            type:1 min: 
0     max:40    step:1     def:40    now:40
  index:9963795    name:Gain                             type:1 min: 
0     max:255   step:1     def:64    now:64
V4L2_CID_PRIVATE_BASE (driver specific controls):

This looks much better to me. Please give some comments on the issue  
since you have more experience about these things. :)


Regards,

Juho
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080606/347c34f2/attachment.pgp>

From juhovh at iki.fi  Fri Jun  6 10:49:25 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Fri, 6 Jun 2008 16:49:25 +0800
Subject: [Linux-uvc-devel] About SiGma Micro USB Web Camera support PATCH
In-Reply-To: <E1C1C047-DA10-42BA-BB37-FDCF8C18FD96@iki.fi>
References: <1212286819.7322.11.camel@prudent>
	<63BB291C-CA91-4620-B5D0-FCD8DB385BA9@iki.fi>
	<200806052309.27488.laurent.pinchart@skynet.be>
	<E1C1C047-DA10-42BA-BB37-FDCF8C18FD96@iki.fi>
Message-ID: <73CA12AA-E27B-4068-B03D-6398E619B160@iki.fi>

On 6.6.2008, at 13.14, Juho V?h?-Herttua wrote:
> because I also get it for nonexistant controls. By the spec  
> PU_WHITE_BALANCE_COMPONENT_AUTO_CONTROL should also support the  
> commands SET_CUR, GET_CUR, GET_INFO, GET_DEF so I tried to do  
> GET_INFO and

I meant PU_WHITE_BALANCE_TEMPERATURE_AUTO_CONTROL but the definitions  
are the same in both anyway...

> Now how do you think, is the camera faulty with reporting the White  
> Balance Temperature, Auto or is there still something that could be  
> done? If it's considered to be faulty I can add a hack to ignore  
> the white balance thing for this camera type and test it...

I made a patch that adds UVC_QUIRK_IGNORE_WBTA definition and ignores  
the mentionied control in as early stage as possible so that it makes  
sense. In this case that means ignoring it at uvc_ctrl_add_ctrl when  
the device supported controls are added to the internal list updated  
by the driver. Works for me and doesn't affect any other devices, but  
if there's some evidence that this uglyish hack can be avoided, that  
would be naturally great.

I hope Lorenzo could also check that this fixes his gstreamer  
problem, I am still having problems with Ekiga but they are unlikely  
to be related to this problem.


Regards,

Juho


-------------- next part --------------
A non-text attachment was scrubbed...
Name: sigma_quirk.diff
Type: application/octet-stream
Size: 1569 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080606/0fc48af8/attachment.obj>
-------------- next part --------------



-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080606/0fc48af8/attachment.pgp>

From welshman at welshweb.net  Fri Jun  6 13:15:09 2008
From: welshman at welshweb.net (David)
Date: Fri, 06 Jun 2008 13:15:09 +0200
Subject: [Linux-uvc-devel] Hercules dualpix chat and show webcam.
In-Reply-To: <200806060043.59611.laurent.pinchart@skynet.be>
References: <1212679088.8225.10.camel@david-desktop>
	<200806060043.59611.laurent.pinchart@skynet.be>
Message-ID: <1212750909.10781.4.camel@david-desktop>

Not sure if the post went missing or just to you Laurent, so I will send
again to the mail list as well.
---------------------------------

?I have used pastebin for the output of ?lsusb -v -d 06f8:3007.

http://pastebin.com/m3d157be2

Thanks.

David

On Fri, 2008-06-06 at 00:43 +0200, Laurent Pinchart wrote:
> Hi David,
> 
> On Thursday 05 June 2008, David wrote:
> > I noticed on http://linux-uvc.berlios.de/#devices that the 06f8:3005
> > Hercules Dualpix Exchange Guillemot Corp works with the uvc driver.
> >
> > Do you think there is a chance to get my webcam to work in Ubuntu 8.04?
> >
> > The lsusb output reads like this...
> >  Bus 006 Device 002: ID 06f8:3007 Guillemot Corp.
> >
> > Obviously I do not give a hoot about the chat and show software, I just
> > would like to get the cam to work in Linux.
> 
> I'll need the output of
> 
> lsusb -v -d 06f8:3007
> 
> to answer the question.
> 
> Best regards,
> 
> Laurent Pinchart



From juhovh at iki.fi  Fri Jun  6 15:14:18 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Fri, 6 Jun 2008 21:14:18 +0800
Subject: [Linux-uvc-devel] About SiGma Micro USB Web Camera support PATCH
In-Reply-To: <73CA12AA-E27B-4068-B03D-6398E619B160@iki.fi>
References: <1212286819.7322.11.camel@prudent>
	<63BB291C-CA91-4620-B5D0-FCD8DB385BA9@iki.fi>
	<200806052309.27488.laurent.pinchart@skynet.be>
	<E1C1C047-DA10-42BA-BB37-FDCF8C18FD96@iki.fi>
	<73CA12AA-E27B-4068-B03D-6398E619B160@iki.fi>
Message-ID: <01836557-72B6-40CC-B9A5-08B2A4CC21D1@iki.fi>

On 6.6.2008, at 16.49, Juho V?h?-Herttua wrote:
> I made a patch that adds UVC_QUIRK_IGNORE_WBTA definition and  
> ignores the mentionied control in as early stage as possible so  
> that it makes sense. In this case that means ignoring it at  
> uvc_ctrl_add_ctrl when the device supported

I am terribly sorry for spamming, but the earlier patch didn't match  
the GUID to be processing unit and therefore had a theoretical chance  
of ignoring valid controls from other units. Attaching an updated  
version.


Regards,

Juho


-------------- next part --------------
A non-text attachment was scrubbed...
Name: sigma_quirk.diff
Type: application/octet-stream
Size: 1628 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080606/cd372fe9/attachment.obj>
-------------- next part --------------



-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080606/cd372fe9/attachment.pgp>

From elbaddy at gmail.com  Fri Jun  6 16:22:07 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Fri, 6 Jun 2008 16:22:07 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <200806052313.00384.laurent.pinchart@skynet.be>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805292117.30490.laurent.pinchart@skynet.be>
	<3d7891440805300512o43d97bdcp2f104726aeda819a@mail.gmail.com>
	<200806052313.00384.laurent.pinchart@skynet.be>
Message-ID: <3d7891440806060722v79fbd7a7r884427897ad69339@mail.gmail.com>

2008/6/5 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi Lorenzo,
>
> On Friday 30 May 2008, Lorenzo Battistini wrote:
>> Hi Laurent,
>>
>> 2008/5/29 Laurent Pinchart <laurent.pinchart at skynet.be>:
>> > Hi Lorenzo,
>> >
>> > On Monday 26 May 2008, Lorenzo Battistini wrote:
>> >> Hi Laurent
>> >>
>> >> 2008/5/23 Laurent Pinchart <laurent.pinchart at skynet.be>:
>> >> > Hi Lorenzo,
>> >> >
>> >> > On Wednesday 21 May 2008, Lorenzo Battistini wrote:
>> >> >> Thanks Laurent,
>> >> >> tha patch permits to view video stream through luvcview.
>> >> >
>> >> > Thanks for the report.
>> >> >
>> >> >> But, for now, it's the only software that I was able to use.
>> >> >> For example, gqcam gives "Error reading image..." and a green screen;
>> >> >
>> >> > gqcam is old an unmaintained. It doesn't support V4L2.
>> >> >
>> >> >> skype gives
>> >> >>
>> >> >> Skype V4L2: Could not find a suitable capture format
>> >> >> Skype V4L2: Could not find a suitable capture format
>> >> >> Skype V4L2: Could not find a suitable capture format
>> >> >> Skype V4L2: Could not find a suitable capture format
>> >> >> Starting the process...
>> >> >> Skype Xv: Xv ports available: 1
>> >> >> Skype XShm: XShm support enabled
>> >> >> Skype Xv: Using Xv port 73
>> >> >> Skype Xv: No suitable overlay format found
>> >> >
>> >> > Your camera supports MJPEG only. Maybe Skype doesn't implement MJPEG
>> >> > decoding ?
>> >> >
>> >> >> and a black screen.
>> >> >>
>> >> >> Loading the patched driver, kernel says:
>> >> >>
>> >> >> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
>> >> >> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp.
>> >> >> 26). input: USB Web Camera as
>> >> >> /devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
>> >> >> usbcore: registered new interface driver uvcvideo
>> >> >> USB Video Class driver (SVN r209)
>> >> >
>> >> > If you're looking for a video conferencing application try Ekiga. It
>> >> > should work with the Linux UVC driver.
>> >>
>> >> But ekiga gives "Error while opening video device USB Web" (I didn't
>> >> find details).
>> >
>> > Could you please check the kernel log after Ekiga's failure and report
>> > any message printed by the driver ?
>>
>> Sure. I didn't think of it.
>>
>> uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).
>
> The error logged by the driver is a VIDIOC_S_INPUT failure.
>
> I had a closer look at the USB descriptors. The reports has a selector unit
> and two input terminals, one for the sensor and one for a composite input.
> Does your camera really have a composite input ?
>

It doesn't have any composite input. It has just a microphone, that's
directly connected to audio device and it works.

Regards


From welshman at welshweb.net  Fri Jun  6 21:44:39 2008
From: welshman at welshweb.net (David)
Date: Fri, 06 Jun 2008 21:44:39 +0200
Subject: [Linux-uvc-devel] Hercules Dualpix Webcam chat & show works with
	the uvc driver...
Message-ID: <1212781479.7472.9.camel@david-desktop>

Not sure what I did but I just started luvcview and my cam works.

Great stuff, it can be added to the list of working cams.  

Good frame rate and quality as well.

http://tinyurl.com/4o3z8b

Luvcview crashes a bit and sometimes will not start btw.

I see it's your work Laurent, well done and thanks.

David



From arbuckle911 at gmail.com  Fri Jun  6 18:03:25 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Fri, 06 Jun 2008 12:03:25 -0400
Subject: [Linux-uvc-devel] virtual device?
Message-ID: <48495FCD.6090907@gmail.com>

Hi,
just wondering if there was a driver for a virtual camera device 
associated with uvc cameras. I saw something about vivi.c a while ago. 
I've got an application working with the uvc module, would I be able to 
swap it with vivi (or other) and not have the app know about the switch?

Thanks,
Chris.


From laurent.pinchart at skynet.be  Sat Jun  7 00:09:43 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:09:43 +0200
Subject: [Linux-uvc-devel] ioctl on a disconnected device
In-Reply-To: <200805292309.03581.laurent.pinchart@skynet.be>
References: <1211620982.9791.21.camel@maestro>
	<200805292309.03581.laurent.pinchart@skynet.be>
Message-ID: <200806070009.43904.laurent.pinchart@skynet.be>

Hi Pekka,

On Thursday 29 May 2008, Laurent Pinchart wrote:
> Hi Pekka,
>
> On Saturday 24 May 2008, Pekka Vuorela wrote:
> > Hello,
> >
> > I debugged a bug[1] I was having with Motion and noticed that the UVC
> > driver doesn't return an error when doing an ioctl() on a disconnected
> > device. Wouldn't ENODEV be a sensible value to return in such
> > situations?
> >
> > Anyway, this small patch adds a check in the beginning of
> > uvc_v4l2_do_ioctl(). With the patch Motion works with me as it seems to
> > work with the pwc driver.
> >
> > 1:
> > http://www.lavrsen.dk/twiki/bin/view/Motion/BugReport2008x05x17x175521
>
> Thanks for debugging the problem. I'm still not sure if all ioctls should
> return -ENODEV when the device gets disconnected. It might make sense to
> allow applications to retrieve the last few captured images for instance.
>
> I'll think about this and I'll work on a patch in the next few days.

I gave this some more thought and concluded that blindly disabling all ioctls 
once the device is disconnected is not the best solution. VIDIOC_REQBUFS 
should still be callable to free the buffers to let applications terminate 
gracefully. Several other ioctls can also be useful (VIDIOC_DQBUF for 
instance, to dequeue the remaining buffers).

Beside, there was a race condition in your patch. URBs are cancelled before 
the disconnect callback is invoked. As there is no locking there, an 
application could possibly dequeue and requeue buffers in that small time 
window.

I've attached a patch that should not suffer from he race condition. It makes 
VIDIOC_QBUF return -ENODEV when the device is disconnected. VIDIOC_DQBUF 
still succeeds if there as long as there are queued buffers.

Could you please test the patch ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: disconnect.patch
Type: text/x-diff
Size: 6542 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080607/b9424179/attachment.patch>

From laurent.pinchart at skynet.be  Sat Jun  7 00:12:50 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:12:50 +0200
Subject: [Linux-uvc-devel] PATCH: Acer Crystal Eye WebCam (064e:a101
	Suyin Corp.)
In-Reply-To: <20e5c9660806040651k2a76c98bsfeaef17fbe7b1abc@mail.gmail.com>
References: <20e5c9660806040651k2a76c98bsfeaef17fbe7b1abc@mail.gmail.com>
Message-ID: <200806070012.51078.laurent.pinchart@skynet.be>

Hi Michael,

On Wednesday 04 June 2008, Michael Sparks wrote:
> Hi,
>
> I've got an Acer laptop with a Crystal Eye WebCam which identifies as
> follows:
>
> Bus 003 Device 002: ID 064e:a101 Suyin Corp.
>
> This is listed as a supported device here:
> http://linux-uvc.berlios.de/#devices
>
> But in practice using the current subversion checkout:
>
> URL: svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
> Repository Root: svn://svn.berlios.de/linux-uvc
> Repository UUID: 790547d8-3c09-0410-a358-857946b093de
> Revision: 212
> Node Kind: directory
> Schedule: normal
> Last Changed Author: pinchartl
> Last Changed Rev: 212
> Last Changed Date: 2008-05-29 15:56:11 +0100 (Thu, 29 May 2008)
>
> When compiled and running (say), luvcview, I get this error:
> ~/Incoming> luvcview
> luvcview 0.2.4
>
> [snip]
> Unable to start capture: Protocol error
> Error grabbing
> Cleanup done. Exiting ...

*sigh*. I hate protocol errors. They are most of the time caused by buggy 
devices, and buggy devices mean I have to find a software workaround :-S

> I get similar errors from other software (eg opencv, python v4l2 bindings,
> etc): ~/Incoming> ./WebCam.py
> Traceback (most recent call last):
>   File "./WebCam.py", line 238, in <module>
>     VideoCaptureSource(fps=32),
>   File "./WebCam.py", line 139, in __init__
>     self.camera.start()
> EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 71, Protocol error
>
> It turns out that, for whatever reason, when the above error occurs,
> it switches on the webcam. (a little green light comes on). Rerunning
> results in the program then normally working (but green light goes out
> on exit, etc). Then failing when rerun again (leaving light on), etc.
>
> Anyway, I hunted down the problem - the "Protocol Error" is actually
> caused by this line:
> uvc_video.c
>
>                if ((ret = usb_set_interface(video->dev->udev, intfnum, i))
> < 0) return ret;
>
> So it's *something* to do with the device presumably not always being
> switched "on" I guess. How that is supposed to be done, I don't know.
>
> HOWEVER, I have made a patch to uvc_video.c that works:
>
> ~/linux-uvc> svn diff
> Index: uvc_video.c
> ===================================================================
> --- uvc_video.c (revision 212)
> +++ uvc_video.c (working copy)
> @@ -750,8 +750,13 @@
>                 if (i >= intf->num_altsetting)
>                         return -EIO;
>
> -               if ((ret = usb_set_interface(video->dev->udev, intfnum, i))
> < 0) -                       return ret;
> +               if ((ret = usb_set_interface(video->dev->udev,
> intfnum, i)) < 0) {
> +                       if (ret == -71) { // If we get this error,
> give it another go & retry
> +                               if ((ret =
> usb_set_interface(video->dev->udev, intfnum, i)) < 0)
> +                                       return ret;
> +                       } else
> +                               return ret;
> +               }
>
>                 ret = uvc_init_video_isoc(video, ep);
>         } else {
>
> You'll note that I just blindly give the same call another go. The
> first one manages to
> switch the green light on, the second causes it to be useful/usable.
>
> This rather surprisingly worked, and so this has fixed this issue with
> this webcam as used by the following software:
>    * pygame.camera
>    * opencv
>    * luvcview
>    * Skype
>
> If this isn't the "correct" way of doing this,please let me know what
> to test and I'll try a different patch :-)

Could you please try to blindly ignore the usb_set_interface return value ? 
I'd like to know if the second call is really required.

What kernel version are you running ?

> BTW, many thanks for writing this module - it's great/really useful :-)

You're welcome. Now if we could convince webcam manufacturers to use the Linux 
driver for testing purpose I'd be much happier :-)

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Jun  7 00:21:30 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:21:30 +0200
Subject: [Linux-uvc-devel] "uvcvideo: Failed to resubmit video URB (-45)"
In-Reply-To: <20080605093843.GA14968@apartia.fr>
References: <20080605093620.GA14921@apartia.fr>
	<20080605093843.GA14968@apartia.fr>
Message-ID: <200806070021.31114.laurent.pinchart@skynet.be>

Hi Louis-David,

On Thursday 05 June 2008, Louis-David Mitterrand wrote:
> On Thu, Jun 05, 2008 at 11:36:20AM +0200, Louis-David Mitterrand wrote:
> > Hi,
> >
> > Using kernel 2.6.25.4 and uvcvideo's latest SVN (r212), I get this error
> > after a few minutes of running motion:
> >
> > uvcvideo: Failed to resubmit video URB (-45)
> >
> > After that message the video transmission hangs.
>
> Sorry I forgot to add the camera model:
>
> 	Jun  5 11:36:34 caere motion: [1] cap.card: "Philips SPC 1300NC Webcam"
> 	Jun  5 11:36:34 caere motion: [1] cap.bus_info: "0000:05:08.2"
> 	Jun  5 11:36:34 caere motion: [1] cap.capabilities=0x04000001
> 	Jun  5 11:36:34 caere motion: [1] - VIDEO_CAPTURE
> 	Jun  5 11:36:34 caere motion: [1] - STREAMING
> 	Jun  5 11:36:34 caere motion: [1] Supported palettes:
> 	Jun  5 11:36:34 caere motion: [1] 0: YUYV (YUV 4:2:2 (YUYV))
> 	Jun  5 11:36:34 caere motion: [1] 1: MJPG (MJPEG)
> 	Jun  5 11:36:34 caere motion: [1] Test palette YUYV (640x480)
> 	Jun  5 11:36:34 caere motion: [1] Using palette YUYV (640x480)
> bytesperlines 128
>
> And the USB controller is an add-in PCI card (old PC with no on-board
> USB2):
>
> 05:08.2 USB Controller: NEC Corporation USB 2.0 (rev 02)

Could you please try to upgrade your kernel to 2.6.26-rc5 ? A bug in the EHCI 
isochronous scheduling code has been fixed there, and I'd like to know if it 
solves your issue.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Jun  7 00:23:16 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:23:16 +0200
Subject: [Linux-uvc-devel] VF0410 Creative Live! Cam IM Pro Flicker
	Filter
In-Reply-To: <BAY143-W134BC493A28C4A0075A41EB2B40@phx.gbl>
References: <BAY143-W134BC493A28C4A0075A41EB2B40@phx.gbl>
Message-ID: <200806070023.16927.laurent.pinchart@skynet.be>

Hi,

On Thursday 05 June 2008, TP Reitzel wrote:
> When using the latest revision, 212, I receive the following error when
> trying to change the frequency filter with luvcview:
>
> luvcview -d /dev/video0
> luvcview 0.2.4
>
> SDL information:
>   Video driver: x11
>   A window manager is available
> Device information:
>   Device path:  /dev/video0
> Stream settings:
>   Frame format: MJPG
>   Frame size:   640x480
>   Frame rate:   30 fps
> ioctl querycontrol error: Invalid argument
> Get value of light frequency filter error
> Current light frequency filter: 50Hz
> ioctl querycontrol error: Invalid argument
> Switch light frequency filter error

Do you get an error message in the kernel log ?

Please post the output of lsusb -v in your reply (I'm interested in the webcam 
only, so you can use -d to filter the results).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Jun  7 00:36:45 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:36:45 +0200
Subject: [Linux-uvc-devel] Hercules Dualpix Webcam chat & show works
	with the uvc driver...
In-Reply-To: <1212781479.7472.9.camel@david-desktop>
References: <1212781479.7472.9.camel@david-desktop>
Message-ID: <200806070036.45313.laurent.pinchart@skynet.be>

Hi David,

On Friday 06 June 2008, David wrote:
> Not sure what I did but I just started luvcview and my cam works.

Great :-)

> Great stuff, it can be added to the list of working cams.

Done.

> Good frame rate and quality as well.
>
> http://tinyurl.com/4o3z8b
>
> Luvcview crashes a bit and sometimes will not start btw.

You should report luvcview issues to Michel Xhaard, the luvcview author, and 
uvc driver issues to the mailing list.

> I see it's your work Laurent, well done and thanks.

You're welcome.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Jun  7 00:39:22 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:39:22 +0200
Subject: [Linux-uvc-devel] virtual device?
In-Reply-To: <48495FCD.6090907@gmail.com>
References: <48495FCD.6090907@gmail.com>
Message-ID: <200806070039.22849.laurent.pinchart@skynet.be>

Hi Christopher,

On Friday 06 June 2008, Christopher Harvey wrote:
> Hi,
> just wondering if there was a driver for a virtual camera device
> associated with uvc cameras. I saw something about vivi.c a while ago.
> I've got an application working with the uvc module, would I be able to
> swap it with vivi (or other) and not have the app know about the switch?

I've never used vivi myself. It should be V4L2-compatible, but you will have 
to check if it supports the image formats you currently work with. 
UVC-specific features (such as dynctrl ioctls for instance) will obviously 
not work, and not all V4L2 controls might be supported by the vivi driver.

Best regards,

Laurent Pinchart


From sparks.m at gmail.com  Sat Jun  7 00:47:30 2008
From: sparks.m at gmail.com (MIchael Sparks)
Date: Fri, 6 Jun 2008 23:47:30 +0100
Subject: [Linux-uvc-devel] PATCH: Acer Crystal Eye WebCam (064e:a101
	Suyin Corp.)
In-Reply-To: <200806070012.51078.laurent.pinchart@skynet.be>
References: <20e5c9660806040651k2a76c98bsfeaef17fbe7b1abc@mail.gmail.com>
	<200806070012.51078.laurent.pinchart@skynet.be>
Message-ID: <200806062347.30696.sparks.m@gmail.com>

Hi Laurent,


Many thanks for getting back to me :)

On Friday 06 June 2008 23:12:50 Laurent Pinchart wrote:
..
> *sigh*. I hate protocol errors. They are most of the time caused by buggy
> devices, and buggy devices mean I have to find a software workaround :-S

I guessed that might be the case :-/

> Could you please try to blindly ignore the usb_set_interface return value ?
> I'd like to know if the second call is really required.

I've tried changing it to specifically ignore that error:
Index: uvc_video.c
===================================================================
--- uvc_video.c (revision 213)
+++ uvc_video.c (working copy)
@@ -750,8 +750,10 @@
                if (i >= intf->num_altsetting)
                        return -EIO;

-               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
-                       return ret;
+               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0) {
+                       if (ret != -71)  // Let's try blindly ignoring protocol errors as requested
+                               return ret;
+               }

                ret = uvc_init_video_isoc(video, ep);
        } else {

Any when I now retry, I get the following error:

~/> ./WebCam.py
Traceback (most recent call last):
  File "./WebCam.py", line 214, in <module>
    VideoCapturePlayer().run() # Runs at full speed - basic test case
  File "./WebCam.py", line 27, in __init__
    self.camera.start()
EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 90, Message too long

For good measure I also tried this ...

Index: uvc_video.c
===================================================================
--- uvc_video.c (revision 213)
+++ uvc_video.c (working copy)
@@ -749,10 +749,13 @@

                if (i >= intf->num_altsetting)
                        return -EIO;
+
+                ret = usb_set_interface(video->dev->udev, intfnum, i);
+//             if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0) {
+//                     if (ret != -71)  // Let's try blindly ignoring protocol errors as requested
+//                             return ret;
+//             }

-               if ((ret = usb_set_interface(video->dev->udev, intfnum, i)) < 0)
-                       return ret;
-
                ret = uvc_init_video_isoc(video, ep);
        } else {
                /* Bulk endpoint, proceed to URB initialization. */

... ie completely ignoring the return code, and again I get this error:

~/> ./WebCam.py
Traceback (most rcall last):
  File "./WebCam.py", line 214, in <module>
    VideoCapturePlayer().run() # Runs at full speed - basic test case
  File "./WebCam.py", line 27, in __init__
    self.camera.start()
EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 90, Message too long

Making it simply retry just seems to work. 

> What kernel version are you running ?

This is the output from uname -a & /proc/version

~/> uname -a
Linux kamaelia-NG 2.6.22.17-0.1-default #1 SMP 2008/02/10 20:01:04 UTC i686 i686 i386 GNU/Linux

~/> more /proc/version
Linux version 2.6.22.17-0.1-default (geeko at buildhost) (gcc version 4.2.1 (SUSE Linux)) #1 SMP 2008/02/10 20:01:04 UTC

> > BTW, many thanks for writing this module - it's great/really useful :-)
>
> You're welcome. Now if we could convince webcam manufacturers to use the
> Linux driver for testing purpose I'd be much happier :-)

:-)

Many thanks,


Michael


From laurent.pinchart at skynet.be  Sat Jun  7 00:59:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jun 2008 00:59:11 +0200
Subject: [Linux-uvc-devel] PATCH: Acer Crystal Eye WebCam (064e:a101
	Suyin Corp.)
In-Reply-To: <200806062347.30696.sparks.m@gmail.com>
References: <20e5c9660806040651k2a76c98bsfeaef17fbe7b1abc@mail.gmail.com>
	<200806070012.51078.laurent.pinchart@skynet.be>
	<200806062347.30696.sparks.m@gmail.com>
Message-ID: <200806070059.11395.laurent.pinchart@skynet.be>

Hi Michael,

On Saturday 07 June 2008, MIchael Sparks wrote:
> Hi Laurent,
>
> Many thanks for getting back to me :)

You're welcome.

> On Friday 06 June 2008 23:12:50 Laurent Pinchart wrote:
> ..
>
> > *sigh*. I hate protocol errors. They are most of the time caused by buggy
> > devices, and buggy devices mean I have to find a software workaround :-S
>
> I guessed that might be the case :-/
>
> > Could you please try to blindly ignore the usb_set_interface return value
> > ? I'd like to know if the second call is really required.
>
> I've tried changing it to specifically ignore that error:
> Index: uvc_video.c
> ===================================================================
> --- uvc_video.c (revision 213)
> +++ uvc_video.c (working copy)
> @@ -750,8 +750,10 @@
>                 if (i >= intf->num_altsetting)
>                         return -EIO;
>
> -               if ((ret = usb_set_interface(video->dev->udev, intfnum, i))
> < 0) -                       return ret;
> +               if ((ret = usb_set_interface(video->dev->udev, intfnum, i))
> < 0) { +                       if (ret != -71)  // Let's try blindly
> ignoring protocol errors as requested +                              
> return ret;
> +               }
>
>                 ret = uvc_init_video_isoc(video, ep);
>         } else {
>
> Any when I now retry, I get the following error:
>
> ~/> ./WebCam.py
> Traceback (most recent call last):
>   File "./WebCam.py", line 214, in <module>
>     VideoCapturePlayer().run() # Runs at full speed - basic test case
>   File "./WebCam.py", line 27, in __init__
>     self.camera.start()
> EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 90, Message too long
>
> For good measure I also tried this ...
>
> Index: uvc_video.c
> ===================================================================
> --- uvc_video.c (revision 213)
> +++ uvc_video.c (working copy)
> @@ -749,10 +749,13 @@
>
>                 if (i >= intf->num_altsetting)
>                         return -EIO;
> +
> +                ret = usb_set_interface(video->dev->udev, intfnum, i);
> +//             if ((ret = usb_set_interface(video->dev->udev, intfnum, i))
> < 0) { +//                     if (ret != -71)  // Let's try blindly
> ignoring protocol errors as requested +//                            
> return ret;
> +//             }
>
> -               if ((ret = usb_set_interface(video->dev->udev, intfnum, i))
> < 0) -                       return ret;
> -
>                 ret = uvc_init_video_isoc(video, ep);
>         } else {
>                 /* Bulk endpoint, proceed to URB initialization. */
>
> ... ie completely ignoring the return code, and again I get this error:
>
> ~/> ./WebCam.py
> Traceback (most rcall last):
>   File "./WebCam.py", line 214, in <module>
>     VideoCapturePlayer().run() # Runs at full speed - basic test case
>   File "./WebCam.py", line 27, in __init__
>     self.camera.start()
> EnvironmentError: ioctl(VIDIOC_STREAMON) failure : 90, Message too long
>
> Making it simply retry just seems to work.

Thanks for testing.

> > What kernel version are you running ?
>
> This is the output from uname -a & /proc/version
>
> ~/> uname -a
> Linux kamaelia-NG 2.6.22.17-0.1-default #1 SMP 2008/02/10 20:01:04 UTC i686
> i686 i386 GNU/Linux
>
> ~/> more /proc/version
> Linux version 2.6.22.17-0.1-default (geeko at buildhost) (gcc version 4.2.1
> (SUSE Linux)) #1 SMP 2008/02/10 20:01:04 UTC

Would you be able to try 2.6.26-rc5 ? I'd like to know if the recent patches 
to the EHCI driver solve the issue (or maybe make it worse :-)).

Best regards,

Laurent Pinchart


From deloptes at yahoo.com  Sat Jun  7 01:12:20 2008
From: deloptes at yahoo.com (Emanoil Kotsev)
Date: Fri, 6 Jun 2008 16:12:20 -0700 (PDT)
Subject: [Linux-uvc-devel] virtual device?
In-Reply-To: <200806070039.22849.laurent.pinchart@skynet.be>
Message-ID: <995247.56855.qm@web53211.mail.re2.yahoo.com>

Hello, this was my question too and I've just found a
fake video device

http://mrk.sed.pl/node/22/

so may be it can help to work around some limitations

regards

--- Laurent Pinchart <laurent.pinchart at skynet.be>
wrote:

> Hi Christopher,
> 
> On Friday 06 June 2008, Christopher Harvey wrote:
> > Hi,
> > just wondering if there was a driver for a virtual
> camera device
> > associated with uvc cameras. I saw something about
> vivi.c a while ago.
> > I've got an application working with the uvc
> module, would I be able to
> > swap it with vivi (or other) and not have the app
> know about the switch?
> 
> I've never used vivi myself. It should be
> V4L2-compatible, but you will have 
> to check if it supports the image formats you
> currently work with. 
> UVC-specific features (such as dynctrl ioctls for
> instance) will obviously 
> not work, and not all V4L2 controls might be
> supported by the vivi driver.
> 
> Best regards,
> 
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
>
https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 





      


From tpreitzel at hotmail.com  Sat Jun  7 01:58:06 2008
From: tpreitzel at hotmail.com (TP Reitzel)
Date: Fri, 6 Jun 2008 23:58:06 +0000
Subject: [Linux-uvc-devel] VF0410 Creative Live! Cam IM Pro Flicker Filter
Message-ID: <BAY143-W22068C5DE521BD052255EDB2B70@phx.gbl>


Laurent -

The problem is due to the outdated headers, uvc_compat.h and uvcvideo.h , in the source for luvcview 0.2.4 as hosted on the QuickCamTeam.net's website. Simply copying these two headers from the source for the newest revision of uvcvideo, 212, to the luvcview source directory will fix the problem. I apologize for wasting your time and thanks for your work on uvcvideo. 

TP Reitzel


_________________________________________________________________
Enjoy 5 GB of free, password-protected online storage.
http://www.windowslive.com/skydrive/overview.html?ocid=TXT_TAGLM_WL_Refresh_skydrive_062008
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080606/6fcb1f81/attachment.html>

From juhovh at iki.fi  Sat Jun  7 19:17:17 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Sun, 8 Jun 2008 01:17:17 +0800
Subject: [Linux-uvc-devel] New device
In-Reply-To: <3d7891440806060722v79fbd7a7r884427897ad69339@mail.gmail.com>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805292117.30490.laurent.pinchart@skynet.be>
	<3d7891440805300512o43d97bdcp2f104726aeda819a@mail.gmail.com>
	<200806052313.00384.laurent.pinchart@skynet.be>
	<3d7891440806060722v79fbd7a7r884427897ad69339@mail.gmail.com>
Message-ID: <FD2A343F-2E1B-4B4D-B383-7323379E15FF@iki.fi>


On 6.6.2008, at 22.22, Lorenzo Battistini wrote:
>>> uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp.  
>>> 1).
>>
>> The error logged by the driver is a VIDIOC_S_INPUT failure.
>>
>> I had a closer look at the USB descriptors. The reports has a  
>> selector unit
>> and two input terminals, one for the sensor and one for a  
>> composite input.
>> Does your camera really have a composite input ?
>
> It doesn't have any composite input. It has just a microphone, that's
> directly connected to audio device and it works.

I would like to note that despite the camera not having a composite  
unit, it seems to require the two input terminals. If I try to  
disable one of the input terminals from use, I get the error message  
"No valid video chain found.". If I check the chain created usually,  
it is always (Camera Sensor, Composite Video -> USB Streaming).

Since the gstreamer and mplayer problems are fixed with the earlier  
quirk patch, there's mainly just Ekiga that's not working now. Please  
give some suggestions of the source of the problem or I'll start  
spamming again myself, if I get enough time to debug the issue. :)


Juho

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080608/c4f1f11a/attachment.pgp>

From alex.pigna at inventati.org  Sat Jun  7 23:35:11 2008
From: alex.pigna at inventati.org (Alessandro)
Date: Sat, 7 Jun 2008 23:35:11 +0200
Subject: [Linux-uvc-devel] Linux-uvc works with another Microdia webcam
Message-ID: <200806072335.16604.alex.pigna@inventati.org>

Hi everyone,
I've tested the linux-uvc driver and it works out of the box with the microdia 
webcam integrated in my new dell laptop. The pci id is 0c45:63e0.

Only caveat is the framerate being quite slow (~7 fps), but i don't know if 
the cam can actually do anything better.

Thanks a lot, I'm willing to do more testing if needed
Alessandro Pignotti
-- 
Vi Veri Veniversum Vivus Vici
        -Dr. Faustus - Marlowe
Public GPG Key ID 0x650B3ED9 on subkeys.gpg.net
Key Fingerprint 6243 AAD3 E3EC 52D8 DFAA 2A2F 9FCD 0457 650B 3ED9
Encrypted mails are welcome
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080607/1398fe36/attachment.pgp>

From jaime.perea at gmail.com  Sun Jun  8 01:03:31 2008
From: jaime.perea at gmail.com (Jaime Perea)
Date: Sun, 8 Jun 2008 01:03:31 +0200
Subject: [Linux-uvc-devel] 174f:8a33
Message-ID: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>

Hello,

My new asus u3s has an integrated camera which is reported as

174f:8a33

My kernel version: 2.6.24.5-laptop-1mnb  (mandriva 2008.1)

I'm not able to put it to work even with tha svn version of uvcvideo
at berlios.

Any hint?

Thanks a lot for all the good work

--
Jaime Perea


From laurent.pinchart at skynet.be  Sun Jun  8 11:28:15 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 11:28:15 +0200
Subject: [Linux-uvc-devel] VF0410 Creative Live! Cam IM Pro Flicker
	Filter
In-Reply-To: <BAY143-W22068C5DE521BD052255EDB2B70@phx.gbl>
References: <BAY143-W22068C5DE521BD052255EDB2B70@phx.gbl>
Message-ID: <200806081128.15997.laurent.pinchart@skynet.be>

Hi,

On Saturday 07 June 2008, TP Reitzel wrote:
> Laurent -
>
> The problem is due to the outdated headers, uvc_compat.h and uvcvideo.h ,
> in the source for luvcview 0.2.4 as hosted on the QuickCamTeam.net's
> website. Simply copying these two headers from the source for the newest
> revision of uvcvideo, 212, to the luvcview source directory will fix the
> problem. I apologize for wasting your time and thanks for your work on
> uvcvideo.

No worries. Could you please report the problem on the quickcamteam.net forums 
so that they fix luvcview ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jun  8 11:55:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 11:55:35 +0200
Subject: [Linux-uvc-devel] Linux-uvc works with another Microdia webcam
In-Reply-To: <200806072335.16604.alex.pigna@inventati.org>
References: <200806072335.16604.alex.pigna@inventati.org>
Message-ID: <200806081155.35921.laurent.pinchart@skynet.be>

Hi Alessandro,

On Saturday 07 June 2008, Alessandro wrote:
> Hi everyone,
> I've tested the linux-uvc driver and it works out of the box with the
> microdia webcam integrated in my new dell laptop.

Thanks for the report.

> The pci id is 0c45:63e0. 

I suppose you mean USB ID :-)

Could you please send me the output of

lsusb -v -d 0c45:63e0

using usbutils 0.72 or newer (0.73+ preferred) ?

> Only caveat is the framerate being quite slow (~7 fps), but i don't know if
> the cam can actually do anything better.

That's usually due to low light conditions. You can probably work around it by 
disabling auto-exposure. Search the list archives for related messages. The 
www.quickcamteam.net forums might help too.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jun  8 11:56:29 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 11:56:29 +0200
Subject: [Linux-uvc-devel] 174f:8a33
In-Reply-To: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
References: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
Message-ID: <200806081156.29709.laurent.pinchart@skynet.be>

Hi Jaime,

On Sunday 08 June 2008, Jaime Perea wrote:
> Hello,
>
> My new asus u3s has an integrated camera which is reported as
>
> 174f:8a33
>
> My kernel version: 2.6.24.5-laptop-1mnb  (mandriva 2008.1)
>
> I'm not able to put it to work even with tha svn version of uvcvideo
> at berlios.
>
> Any hint?

Could you please send me the output of

lsusb -v -d 174f:8a33

using usbutils 0.72 or newer (0.73+ preferred) ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jun  8 12:09:09 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 12:09:09 +0200
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
Message-ID: <200806081209.09859.laurent.pinchart@skynet.be>

Hi everybody,

here is a patch that should fix the VIDIOC_[GS]_INPUT error with the SiGma 
Micro USB Web Camera.

The camera advertises a selector unit to select between multiple inputs, but 
has a single input only. The patch adds a new device quirk to ignore the 
selector unit.

The following error should not occur anymore:

uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).

New errors might appear though (I'm thinking about the white balance issue 
that Juho reported). Please let me know if the patch fixes the 
VIDIOC_[GS]_INPUT error. I'll then work on the next error.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sigma.diff
Type: text/x-diff
Size: 1577 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080608/bcc55776/attachment.diff>

From jaime.perea at gmail.com  Sun Jun  8 13:52:20 2008
From: jaime.perea at gmail.com (Jaime Perea)
Date: Sun, 8 Jun 2008 13:52:20 +0200
Subject: [Linux-uvc-devel] 174f:8a33
In-Reply-To: <200806081156.29709.laurent.pinchart@skynet.be>
References: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
	<200806081156.29709.laurent.pinchart@skynet.be>
Message-ID: <200806081352.21018.jaime@iaa.es>

Hi, 

Thanks from your prompt answer, my version of usbutils is
0.73. the output of the lsusb command follows,

Bus 001 Device 003: ID 174f:8a33  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x174f 
  idProduct          0x8a33 
  bcdDevice            8.06
  iManufacturer           2 Syntek
  iProduct                3 USB2.0 UVC PC Camera
  iSerial                 4 0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          519
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           51
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             4
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x00000000
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      341
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       4
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors               10
        guidFormat                            
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 18432000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         500000
        bFrameIntervalType                  1
        dwFrameInterval( 0)            500000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1152000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            416666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1520640
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            416666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  4608000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            416666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  6082560
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            416666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                  8640000
        dwMaxBitRate                  8640000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval        1428571
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1428571
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 14155776
        dwMaxBitRate                 14155776
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval        1428571
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1428571
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           800
        dwMinBitRate                 18432000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize     2048000
        dwDefaultFrameInterval        1428571
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1428571
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         9
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                 22118400
        dwMaxBitRate                 22118400
        dwMaxVideoFrameBufferSize     2457600
        dwDefaultFrameInterval        1428571
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1428571
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                        10
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 23592960
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1428571
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1428571
      VideoStreaming Interface Descriptor:
        bLength                            10
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        bNumCompressionPatterns             1
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


..................

It was a bit long :-)

I hope it can be useful for you.  All the best

--
Jaime Perea

El Domingo, 8 de Junio de 2008, Laurent Pinchart escribi?:
> Hi Jaime,
>
> On Sunday 08 June 2008, Jaime Perea wrote:
> > Hello,
> >
> > My new asus u3s has an integrated camera which is reported as
> >
> > 174f:8a33
> >
> > My kernel version: 2.6.24.5-laptop-1mnb  (mandriva 2008.1)
> >
> > I'm not able to put it to work even with tha svn version of uvcvideo
> > at berlios.
> >
> > Any hint?
>
> Could you please send me the output of
>
> lsusb -v -d 174f:8a33
>
> using usbutils 0.72 or newer (0.73+ preferred) ?
>
> Best regards,
>
> Laurent Pinchart




From alex.pigna at inventati.org  Sun Jun  8 15:15:42 2008
From: alex.pigna at inventati.org (Alessandro)
Date: Sun, 8 Jun 2008 15:15:42 +0200
Subject: [Linux-uvc-devel] Linux-uvc works with another Microdia webcam
In-Reply-To: <200806081155.35921.laurent.pinchart@skynet.be>
References: <200806072335.16604.alex.pigna@inventati.org>
	<200806081155.35921.laurent.pinchart@skynet.be>
Message-ID: <200806081515.47145.alex.pigna@inventati.org>

On Sunday 08 June 2008 11:55:35 you wrote:
> Hi Alessandro,
>
> Could you please send me the output of
>
> lsusb -v -d 0c45:63e0
>
> using usbutils 0.72 or newer (0.73+ preferred) ?
> Best regards,
>Laurent Pinchart

Hi Laurent,
i've attached the lsusb output, because it is quite long.

You were right, in good lighting condition the framerate is around 35 fps, 
setting autoexpose to off seems not to be supported, or at least luvcview 
report an error when trying.

Thanks a lot,
Alessandro

-- 
Vi Veri Veniversum Vivus Vici
        -Dr. Faustus - Marlowe
Public GPG Key ID 0x650B3ED9 on subkeys.gpg.net
Key Fingerprint 6243 AAD3 E3EC 52D8 DFAA 2A2F 9FCD 0457 650B 3ED9
Encrypted mails are welcome
-------------- next part --------------

Bus 006 Device 002: ID 0c45:63e0 Microdia 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0c45 Microdia
  idProduct          0x63e0 
  bcdDevice           83.04
  iManufacturer           2 SONiX Technology Inc
  iProduct                1 Integrated Webcam
  iSerial                 3 M09-001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          627
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    ** UNRECOGNIZED:  28 ff 42 49 53 54 00 01 06 01 10 00 00 00 00 00 d1 10 f4 01 d2 11 f4 01 d3 12 f4 01 d4 13 f4 01 d5 14 f4 01 d6 15 f4 01
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 Integrated Webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 Integrated Webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0x01
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00040000
          Privacy
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000157f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      341
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  3072000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  1013760
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   768000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   253440
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   192000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 13107200
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        352
        wHeight( 2)                       288
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080608/e72df703/attachment.pgp>

From juhovh at iki.fi  Sun Jun  8 17:17:25 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Sun, 8 Jun 2008 23:17:25 +0800
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <200806081209.09859.laurent.pinchart@skynet.be>
References: <200806081209.09859.laurent.pinchart@skynet.be>
Message-ID: <D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>

On 8.6.2008, at 18.09, Laurent Pinchart wrote:
> here is a patch that should fix the VIDIOC_[GS]_INPUT error with  
> the SiGma
> Micro USB Web Camera.
...
>
> The following error should not occur anymore:
>
> uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).

Confirmed to work with Ekiga. No noticed problems there with the  
camera any more.

> New errors might appear though (I'm thinking about the white  
> balance issue
> that Juho reported). Please let me know if the patch fixes the
> VIDIOC_[GS]_INPUT error. I'll then work on the next error.

The white balance issue is still blocking the camera from working  
with either gstreamer or mplayer without the patch I sent earlier. I  
do admit though that 3 quirks for one damn cheap camera is a lot, so  
I hope you can come up with something. :p I couldn't.


Juho

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080608/fb74ffaa/attachment.pgp>

From laurent.pinchart at skynet.be  Sun Jun  8 21:06:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 21:06:35 +0200
Subject: [Linux-uvc-devel] 174f:8a33
In-Reply-To: <200806081352.21018.jaime@iaa.es>
References: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
	<200806081156.29709.laurent.pinchart@skynet.be>
	<200806081352.21018.jaime@iaa.es>
Message-ID: <200806082106.35968.laurent.pinchart@skynet.be>

Hi Jaime,

On Sunday 08 June 2008, Jaime Perea wrote:
> Hi,
>
> Thanks from your prompt answer, my version of usbutils is
> 0.73. the output of the lsusb command follows,
[snip]
>
> It was a bit long :-)
>
> I hope it can be useful for you.  All the best

Thanks for the information. The camera should work with the UVC driver. Could 
you describe in details the problems you encountered ? Make sure you include 
logs and error messages produced by the applications you try, as well as 
message printed by the driver to the kernel log.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jun  8 21:27:29 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 21:27:29 +0200
Subject: [Linux-uvc-devel] Linux-uvc works with another Microdia webcam
In-Reply-To: <200806081515.47145.alex.pigna@inventati.org>
References: <200806072335.16604.alex.pigna@inventati.org>
	<200806081155.35921.laurent.pinchart@skynet.be>
	<200806081515.47145.alex.pigna@inventati.org>
Message-ID: <200806082127.29734.laurent.pinchart@skynet.be>

Hi Alessandro,

On Sunday 08 June 2008, Alessandro wrote:
> On Sunday 08 June 2008 11:55:35 you wrote:
> > Hi Alessandro,
> >
> > Could you please send me the output of
> >
> > lsusb -v -d 0c45:63e0
> >
> > using usbutils 0.72 or newer (0.73+ preferred) ?
> > Best regards,
> >Laurent Pinchart
>
> Hi Laurent,
> i've attached the lsusb output, because it is quite long.

Thanks for the information. I've updated the website.

> You were right, in good lighting condition the framerate is around 35 fps,
> setting autoexpose to off seems not to be supported, or at least luvcview
> report an error when trying.

The USB descriptors show no supported exposure controls, so I'm afraid there 
is no way to disable auto-exposure.

Best regards,

Laurent Pinchart


From jaime.perea at gmail.com  Mon Jun  9 00:58:58 2008
From: jaime.perea at gmail.com (jaime.perea at gmail.com)
Date: Mon, 9 Jun 2008 00:58:58 +0200
Subject: [Linux-uvc-devel] 174f:8a33
In-Reply-To: <200806082106.35968.laurent.pinchart@skynet.be>
References: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
	<200806081352.21018.jaime@iaa.es>
	<200806082106.35968.laurent.pinchart@skynet.be>
Message-ID: <200806090058.59179.jaime.perea@gmail>

Hello again,

The output from dmesg contains:

cristina2: dmesg | grep -i uvc
uvcvideo: Found UVC 1.00 device USB2.0 UVC PC Camera (174f:8a33)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
usbcore: registered new interface driver uvcvideo

the output of luvcview is 

luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 22.
 Init v4L2 failed !! exit fatal

neither ekiga that does not give any info apart that there was an
error nor skype give an error message.

Thanks again

--
Jaime

El Domingo, 8 de Junio de 2008, Laurent Pinchart escribi?:
> Hi Jaime,
>
> On Sunday 08 June 2008, Jaime Perea wrote:
> > Hi,
> >
> > Thanks from your prompt answer, my version of usbutils is
> > 0.73. the output of the lsusb command follows,
>
> [snip]
>
> > It was a bit long :-)
> >
> > I hope it can be useful for you.  All the best
>
> Thanks for the information. The camera should work with the UVC driver.
> Could you describe in details the problems you encountered ? Make sure
> you include logs and error messages produced by the applications you
> try, as well as message printed by the driver to the kernel log.
>
> Best regards,
>
> Laurent Pinchart




From laurent.pinchart at skynet.be  Sun Jun  8 22:59:37 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 22:59:37 +0200
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
Message-ID: <200806082259.37953.laurent.pinchart@skynet.be>

Hi Juho,

On Sunday 08 June 2008, Juho V?h?-Herttua wrote:
> On 8.6.2008, at 18.09, Laurent Pinchart wrote:
> > here is a patch that should fix the VIDIOC_[GS]_INPUT error with
> > the SiGma
> > Micro USB Web Camera.
>
> ...
>
> > The following error should not occur anymore:
> >
> > uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).
>
> Confirmed to work with Ekiga. No noticed problems there with the
> camera any more.

Thanks. I've committed the patch.

> > New errors might appear though (I'm thinking about the white
> > balance issue
> > that Juho reported). Please let me know if the patch fixes the
> > VIDIOC_[GS]_INPUT error. I'll then work on the next error.
>
> The white balance issue is still blocking the camera from working
> with either gstreamer or mplayer without the patch I sent earlier. I
> do admit though that 3 quirks for one damn cheap camera is a lot, so
> I hope you can come up with something. :p I couldn't.

The camera would probably win the most broken webcam contest. I assume it has 
passed the Windows conformance tests, so I'm pretty amazed by the low quality 
level of the test. This doesn't mean we should not make it work in Linux 
though, otherwise we would be as bad as Microsoft :-)

Adding quirks to ignore specific controls is not a good solution. In the long 
term we will probably need a way to blacklist controls on a per-camera basis. 
If we can avoid it for now I'll be happy.

I had yet another look at the descriptors, and I noticed the camera doesn't 
support any manual white balance control. Having an automatic white balance 
control to disable the automatic white balance doesn't make much sense if the 
white balance can't be modified manually as well. A possible fix for the 
problem would be to ignore all auto controls that don't have a corresponding 
manual control. Any opinion on that ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jun  8 23:34:22 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jun 2008 23:34:22 +0200
Subject: [Linux-uvc-devel] 174f:8a33
In-Reply-To: <200806090058.59179.jaime.perea@gmail>
References: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
	<200806082106.35968.laurent.pinchart@skynet.be>
	<200806090058.59179.jaime.perea@gmail>
Message-ID: <200806082334.22728.laurent.pinchart@skynet.be>

Hi Jaime,

On Monday 09 June 2008, jaime.perea at gmail.com wrote:
> Hello again,
>
> The output from dmesg contains:
>
> cristina2: dmesg | grep -i uvc
> uvcvideo: Found UVC 1.00 device USB2.0 UVC PC Camera (174f:8a33)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> usbcore: registered new interface driver uvcvideo
>
> the output of luvcview is
>
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 22.
>  Init v4L2 failed !! exit fatal

luvcview defaults to using MJPEG and your camera supports YUV only. Try 
luvcview -f yuv.

> neither ekiga that does not give any info apart that there was an
> error nor skype give an error message.

Does the driver print more messages to the kernel log when you use Ekiga or 
Skype ?

Best regards,

Laurent Pinchart


From jaime.perea at gmail.com  Mon Jun  9 09:12:42 2008
From: jaime.perea at gmail.com (Jaime Perea)
Date: Mon, 9 Jun 2008 09:12:42 +0200
Subject: [Linux-uvc-devel] 174f:8a33
In-Reply-To: <200806082334.22728.laurent.pinchart@skynet.be>
References: <33ae4a660806071603i52ad2313ga2ca87e674ae70ff@mail.gmail.com>
	<200806090058.59179.jaime.perea@gmail>
	<200806082334.22728.laurent.pinchart@skynet.be>
Message-ID: <200806090912.42837.jaime.perea@gmail.com>

El Domingo, 8 de Junio de 2008, Laurent Pinchart escribi?:
> luvcview -f yuv....
Hello again, doing this I get either a blank screen or a static
picture, no motion.

Sorry for answering so late, domestic problems :-)

All the best and thanks for your kindness

--
Jaime Perea

When modprobing the module a dmesg says

uvcvideo: Found UVC 1.00 device USB2.0 UVC PC Camera (174f:8a33)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r213)
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).

skype fails ans sends this

Skype V4L2: Failed to change capture framerate (15)
Starting the process...
Skype Xv: Xv ports available: 32
Skype XShm: XShm support enabled
Skype Xv: Using Xv port 280

and the last error (Failed to query....) is sent again

a tail -50 of /var/log/kernel/errors.log gives

Jun  6 23:24:07 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  6 23:24:07 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  6 23:27:04 cristina2 kernel: uvcvideo: Failed to query (130) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  6 23:27:08 cristina2 last message repeated 3 times
Jun  6 23:29:58 cristina2 kernel: uvcvideo: Failed to query (129) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  7 00:36:46 cristina2 kernel: uvcvideo: Failed to query (129) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  7 00:38:40 cristina2 kernel: uvcvideo: Failed to query (129) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  7 00:38:42 cristina2 kernel: uvcvideo: Failed to query (130) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  7 22:46:16 cristina2 kernel: PCI: BIOS Bug: MCFG area at c0000000 is 
not E820-reserved
Jun  7 22:46:16 cristina2 kernel: PCI: Not using MMCONFIG.
Jun  7 22:46:17 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  7 22:46:17 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  7 23:03:32 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  7 23:05:13 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  7 23:17:27 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  7 23:18:53 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  7 23:20:52 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  8 00:03:49 cristina2 kernel: PCI: BIOS Bug: MCFG area at c0000000 is 
not E820-reserved
Jun  8 00:03:49 cristina2 kernel: PCI: Not using MMCONFIG.
Jun  8 00:03:49 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  8 00:03:49 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  8 00:04:03 cristina2 kernel: uvcvideo: Failed to query (130) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  8 00:44:56 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  8 00:53:45 cristina2 kernel: uvcvideo: Failed to query (130) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  8 00:56:08 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  8 13:32:11 cristina2 kernel: PCI: BIOS Bug: MCFG area at c0000000 is 
not E820-reserved
Jun  8 13:32:11 cristina2 kernel: PCI: Not using MMCONFIG.
Jun  8 13:32:12 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  8 13:32:12 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  8 13:32:23 cristina2 kernel: uvcvideo: Failed to query (129) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  8 19:23:32 cristina2 kernel: PCI: BIOS Bug: MCFG area at c0000000 is 
not E820-reserved
Jun  8 19:23:32 cristina2 kernel: PCI: Not using MMCONFIG.
Jun  8 19:23:32 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  8 19:23:32 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  9 00:41:09 cristina2 kernel: PCI: BIOS Bug: MCFG area at c0000000 is 
not E820-reserved
Jun  9 00:41:09 cristina2 kernel: PCI: Not using MMCONFIG.
Jun  9 00:41:10 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  9 00:41:10 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  9 00:51:32 cristina2 kernel: uvcvideo: Failed to query (129) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  8 23:43:12 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  8 23:52:07 cristina2 kernel: uvcvideo: Failed to query (130) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  9 08:55:58 cristina2 kernel: PCI: BIOS Bug: MCFG area at c0000000 is 
not E820-reserved
Jun  9 08:55:58 cristina2 kernel: PCI: Not using MMCONFIG.
Jun  9 08:55:59 cristina2 kernel: iTCO_wdt: failed to reset NO_REBOOT flag, 
reboot disabled by hardware
Jun  9 08:55:59 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  9 08:55:59 cristina2 kernel: uvcvideo: Failed to query (1) UVC control 
2 (unit 0) : -110 (exp. 26).
Jun  9 08:55:59 cristina2 kernel: uvcvideo: Failed to initialize the device 
(-5).
Jun  9 09:01:37 cristina2 kernel: uvcvideo: Failed to query (135) UVC 
control 1 (unit 0) : -32 (exp. 26).
Jun  9 09:02:20 cristina2 kernel: uvcvideo: Failed to query (129) UVC 
control 1 (unit 0) : -110 (exp. 26).
Jun  9 09:05:19 cristina2 kernel: uvcvideo: Failed to query (130) UVC 
control 1 (unit 0) : -110 (exp. 26).


From juhovh at iki.fi  Mon Jun  9 15:50:15 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Mon, 9 Jun 2008 21:50:15 +0800
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <200806082259.37953.laurent.pinchart@skynet.be>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
	<200806082259.37953.laurent.pinchart@skynet.be>
Message-ID: <60AF488E-AB3B-450C-AEA5-C549D109DA5C@iki.fi>

On 9.6.2008, at 4.59, Laurent Pinchart wrote:
>
> Thanks. I've committed the patch.

Thank you.

> The camera would probably win the most broken webcam contest. I  
> assume it has
> passed the Windows conformance tests, so I'm pretty amazed by the  
> low quality
> level of the test. This doesn't mean we should not make it work in  
> Linux
> though, otherwise we would be as bad as Microsoft :-)

I guess so, and it also seems to work on Mac with no issues. I wonder  
if those drivers have some "ignore most features if it's a webcam"  
mode to deal with these. However the price I paid for the camera  
converted to euros is something around 4 euros. So I kind of  
understand they've thrown it out immediately after passing minimal  
tests, but it's still annoying.

> Adding quirks to ignore specific controls is not a good solution.  
> In the long
> term we will probably need a way to blacklist controls on a per- 
> camera basis.
> If we can avoid it for now I'll be happy.

I agree with this, the more general the better.

> I had yet another look at the descriptors, and I noticed the camera  
> doesn't
> support any manual white balance control. Having an automatic white  
> balance
> control to disable the automatic white balance doesn't make much  
> sense if the
> white balance can't be modified manually as well. A possible fix  
> for the
> problem would be to ignore all auto controls that don't have a  
> corresponding
> manual control. Any opinion on that ?

I think it is a good idea. I had it on my mind at one moment as well,  
but I thought it might be too radical to implement. So if you think  
it makes sense, I'm all for it. Just let me know if you have a patch  
to test and I will give it a go.


Juho

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080609/06939a0a/attachment.pgp>

From hadezen at gmail.com  Tue Jun 10 22:05:28 2008
From: hadezen at gmail.com (Halil Demirezen)
Date: Tue, 10 Jun 2008 23:05:28 +0300
Subject: [Linux-uvc-devel] uvc linux kernel 2.6.18 luvcview
Message-ID: <da8023da0806101305g5df9918cpae09f5246b5e6bfa@mail.gmail.com>

Hello,

I am using Logitech Quickcam pro For Notebook. I have installed uvc driver
which seems to work properly. I downloaded
luvcview to modify the code and see the effects. But I cannot turn Auto
Exposure Off with the current ioctls.

Some mails relating to the problem of FPS are

http://www.mail-archive.com/linux-uvc-devel at lists.berlios.de/msg01716.html
http://lists.berlios.de/pipermail/linux-uvc-devel/2007-October/002375.html


One mail says the Auto Exposure OFF and set exposure to a certain number is
still possible. But I couldnot find
how to use ioctls to do so.


Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080610/87eea57a/attachment.html>

From richietommy at yahoo.com  Thu Jun 12 05:26:31 2008
From: richietommy at yahoo.com (Rich)
Date: Wed, 11 Jun 2008 20:26:31 -0700 (PDT)
Subject: [Linux-uvc-devel] Framerate varies with lighting conditions
	(Philips SPC 1300NC, UVC driver from SVN checkout tonight)
Message-ID: <54056.29495.qm@web52406.mail.re2.yahoo.com>

So, I got this new webcam today - it is a Philips SPC 1300NC (0471:0331). Unlike other webcam's I've had (I had a logitech QC pro 5000, which worked marvelously with the UVC driver, but it caught fire unfortunately - it would have a slow shutter speed and blur, but the framerate was always 30 when I asked it to be), instead of sending a constant frame rate, no matter the lighting conditions, this camera seems to sync the framerate with the shutter speed - in less-than-daylight conditions, it sends 5 frames per second out, after telling what ever program (luvcview, mplayer, gst-launch, or a simple python video-grabbing script I wrote, available here: http://www.ndeschildre.net/2008/04/29/python-and-webcam-part-2/ ) I try it with to use 30 FPS. luvcview shows FPS at the top, and indeed the camera's output goes from 30FPS if I shove it up to my computer monitor, to 5 FPS if I point it at me. It gives somewhat comical results when I record a video as it
 plays back at 30FPS, so 30 seconds of recording becomes a 6 second clip of me moving very fast. Unfortunately, comical was not why I bought the camera.

I read a post around the 19th of May on this list regarding a similar issue with an SPC 1000NC camera, though I never heard anything further regarding it. Does anyone know if this is a hardware issue that was 'patched' by philips' Windows drivers (90FPS and 6 megapixels my ass!) and I should just return this turd, or is it something that could be fixed with software? The only thing that swayed me from buying another QC5000 was the 1280x1024 capture, but it only goes to 15FPS with this camera, and I have a real camera if I need to take pictures. Let me know if you all need anymore information, or any thoughts on the subject. Thanks,

 -rich



      


From elbaddy at gmail.com  Thu Jun 12 17:58:52 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Thu, 12 Jun 2008 17:58:52 +0200
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
Message-ID: <3d7891440806120858w67694e82y8e51913db7ca0ea8@mail.gmail.com>

Hi all,

2008/6/8 Juho V?h?-Herttua <juhovh at iki.fi>:
> On 8.6.2008, at 18.09, Laurent Pinchart wrote:
>>
>> here is a patch that should fix the VIDIOC_[GS]_INPUT error with the SiGma
>> Micro USB Web Camera.
>
> ...
>>
>> The following error should not occur anymore:
>>
>> uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).
>
> Confirmed to work with Ekiga. No noticed problems there with the camera any
> more.

I can do it too.

But I still have some problems with gstreamer: through
gstreamer-properties when I try testing video input through v4l2
plugin I get

Error running pipeline 'Video for Linux 2 (v4l2)': Failed getting
controls attributes on device '/dev/video0.' [v4l2_calls.c(243):
gst_v4l2_fill_lists (): /pipeline1/v4l2src4:
Failed querying control 9963788 on device '/dev/video0'. (5 -
Input/output error)]

And kernel says

uvcvideo: Failed to query (135) UVC control 11 (unit 5) : -32 (exp. 1).


Best regards,
Lorenzo Battistini


From juhovh at iki.fi  Thu Jun 12 18:41:48 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Fri, 13 Jun 2008 00:41:48 +0800
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <3d7891440806120858w67694e82y8e51913db7ca0ea8@mail.gmail.com>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
	<3d7891440806120858w67694e82y8e51913db7ca0ea8@mail.gmail.com>
Message-ID: <7DB45BAB-4061-46C2-8501-9A1937E3BAA2@iki.fi>

On 12.6.2008, at 23.58, Lorenzo Battistini wrote:
> But I still have some problems with gstreamer: through
> gstreamer-properties when I try testing video input through v4l2
> plugin I get
>
> Error running pipeline 'Video for Linux 2 (v4l2)': Failed getting
> controls attributes on device '/dev/video0.' [v4l2_calls.c(243):
> gst_v4l2_fill_lists (): /pipeline1/v4l2src4:
> Failed querying control 9963788 on device '/dev/video0'. (5 -
> Input/output error)]
>
> And kernel says
>
> uvcvideo: Failed to query (135) UVC control 11 (unit 5) : -32 (exp.  
> 1).

I made a patch that fixes this. I attached an updated version that  
should apply cleanly on top of the current svn version. I think  
Laurent is working on a better fix for the problem, but you can use  
this one until it is finished. Hope it helps.


Best regards,

Juho


-------------- next part --------------
A non-text attachment was scrubbed...
Name: sigma_quirk.diff
Type: application/octet-stream
Size: 1627 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080613/ae76185a/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080613/ae76185a/attachment.pgp>

From elbaddy at gmail.com  Thu Jun 12 19:05:15 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Thu, 12 Jun 2008 19:05:15 +0200
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <7DB45BAB-4061-46C2-8501-9A1937E3BAA2@iki.fi>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
	<3d7891440806120858w67694e82y8e51913db7ca0ea8@mail.gmail.com>
	<7DB45BAB-4061-46C2-8501-9A1937E3BAA2@iki.fi>
Message-ID: <3d7891440806121005k61207609j4b8ba01046636d5b@mail.gmail.com>

2008/6/12 Juho V?h?-Herttua <juhovh at iki.fi>:
> On 12.6.2008, at 23.58, Lorenzo Battistini wrote:
>>
>> But I still have some problems with gstreamer: through
>> gstreamer-properties when I try testing video input through v4l2
>> plugin I get
>>
>> Error running pipeline 'Video for Linux 2 (v4l2)': Failed getting
>> controls attributes on device '/dev/video0.' [v4l2_calls.c(243):
>> gst_v4l2_fill_lists (): /pipeline1/v4l2src4:
>> Failed querying control 9963788 on device '/dev/video0'. (5 -
>> Input/output error)]
>>
>> And kernel says
>>
>> uvcvideo: Failed to query (135) UVC control 11 (unit 5) : -32 (exp. 1).
>
> I made a patch that fixes this. I attached an updated version that should
> apply cleanly on top of the current svn version. I think Laurent is working
> on a better fix for the problem, but you can use this one until it is
> finished. Hope it helps.
>
>

Yes, now kernel does not give error, but gstreamer-properties is still
not working:

Error running pipeline 'Video for Linux 2 (v4l2)': Could not negotiate
format [gstbasesrc.c(2359): gst_base_src_start ():
/pipeline0/v4l2src3:
Check your filtered caps, if any]


From juhovh at iki.fi  Thu Jun 12 19:15:19 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Fri, 13 Jun 2008 01:15:19 +0800
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <3d7891440806121005k61207609j4b8ba01046636d5b@mail.gmail.com>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
	<3d7891440806120858w67694e82y8e51913db7ca0ea8@mail.gmail.com>
	<7DB45BAB-4061-46C2-8501-9A1937E3BAA2@iki.fi>
	<3d7891440806121005k61207609j4b8ba01046636d5b@mail.gmail.com>
Message-ID: <BFDD56B6-7C7B-4A17-B927-F260AAAF0542@iki.fi>


On 13.6.2008, at 1.05, Lorenzo Battistini wrote:
> Yes, now kernel does not give error, but gstreamer-properties is still
> not working:
>
> Error running pipeline 'Video for Linux 2 (v4l2)': Could not negotiate
> format [gstbasesrc.c(2359): gst_base_src_start ():
> /pipeline0/v4l2src3:
> Check your filtered caps, if any]

Does gstreamer play the video if you try to give the command:

gst-launch-0.10 v4l2src ! jpegdec ! xvimagesink

You could try to set the gstreamer-properties with custom video  
settings like:

v4l2src device="/dev/video0" ! jpegdec ! ffmpegcolorspace

I wasn't able to test this, because for some unknown reason (which I  
don't think is related to uvcvideo) my gstreamer-settings application  
is crashing all the time with segfault...


Best regards,

Juho
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080613/c01144a8/attachment.pgp>

From laurent.pinchart at skynet.be  Sat Jun 14 16:04:22 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 14 Jun 2008 16:04:22 +0200
Subject: [Linux-uvc-devel] uvc linux kernel 2.6.18 luvcview
In-Reply-To: <da8023da0806101305g5df9918cpae09f5246b5e6bfa@mail.gmail.com>
References: <da8023da0806101305g5df9918cpae09f5246b5e6bfa@mail.gmail.com>
Message-ID: <200806141604.22686.laurent.pinchart@skynet.be>

Hi Halil,

On Tuesday 10 June 2008, Halil Demirezen wrote:
> Hello,
>
> I am using Logitech Quickcam pro For Notebook. I have installed uvc driver
> which seems to work properly. I downloaded
> luvcview to modify the code and see the effects. But I cannot turn Auto
> Exposure Off with the current ioctls.
>
> Some mails relating to the problem of FPS are
>
> http://www.mail-archive.com/linux-uvc-devel at lists.berlios.de/msg01716.html
> http://lists.berlios.de/pipermail/linux-uvc-devel/2007-October/002375.html
>
>
> One mail says the Auto Exposure OFF and set exposure to a certain number is
> still possible. But I couldnot find how to use ioctls to do so.

What have you tried ? How did it fail ? Have you checked for messages in the 
kernel log ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Jun 14 16:37:42 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 14 Jun 2008 16:37:42 +0200
Subject: [Linux-uvc-devel] Framerate varies with lighting conditions
	(Philips SPC 1300NC, UVC driver from SVN checkout tonight)
In-Reply-To: <54056.29495.qm@web52406.mail.re2.yahoo.com>
References: <54056.29495.qm@web52406.mail.re2.yahoo.com>
Message-ID: <200806141637.42442.laurent.pinchart@skynet.be>

Hi Rich,

On Thursday 12 June 2008, Rich wrote:
> So, I got this new webcam today - it is a Philips SPC 1300NC (0471:0331).
> Unlike other webcam's I've had (I had a logitech QC pro 5000, which worked
> marvelously with the UVC driver, but it caught fire unfortunately - it
> would have a slow shutter speed and blur, but the framerate was always 30
> when I asked it to be), instead of sending a constant frame rate, no matter
> the lighting conditions, this camera seems to sync the framerate with the
> shutter speed - in less-than-daylight conditions, it sends 5 frames per
> second out, after telling what ever program (luvcview, mplayer, gst-launch,
> or a simple python video-grabbing script I wrote, available here:
> http://www.ndeschildre.net/2008/04/29/python-and-webcam-part-2/ ) I try it
> with to use 30 FPS. luvcview shows FPS at the top, and indeed the camera's
> output goes from 30FPS if I shove it up to my computer monitor, to 5 FPS if
> I point it at me. It gives somewhat comical results when I record a video
> as it plays back at 30FPS, so 30 seconds of recording becomes a 6 second
> clip of me moving very fast. Unfortunately, comical was not why I bought
> the camera.
>
> I read a post around the 19th of May on this list regarding a similar issue
> with an SPC 1000NC camera, though I never heard anything further regarding
> it. Does anyone know if this is a hardware issue that was 'patched' by
> philips' Windows drivers (90FPS and 6 megapixels my ass!) and I should just
> return this turd, or is it something that could be fixed with software?

Most webcams have an auto-exposure feature enabled by default that will raise 
the exposure time in low light conditions, making the frame rate drop. 
Auto-exposure can be turned off using the V4L2_CID_EXPOSURE_AUTO control on 
models that export the auto-exposure control. The SPC1300NC seems to support 
that.

You will not be able to get more than 30fps though. The UVC descriptors report 
frame rates up to 30fps only, and I think Philips use software interpolation 
to achieve 90fps (even though they could use private commands to switch to 
higher frame rates, but I really doubt that).

> The only thing that swayed me from buying another QC5000 was the 1280x1024
> capture, but it only goes to 15FPS with this camera, and I have a real
> camera if I need to take pictures.

The QC 5000 is limited to 15fps at 1280x1024 but can probably achieve higher 
frame rates at lower resolutions.

> Let me know if you all need anymore 
> information, or any thoughts on the subject. Thanks,

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Jun 14 18:25:46 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 14 Jun 2008 18:25:46 +0200
Subject: [Linux-uvc-devel] CANYON CNR-WCAM53
In-Reply-To: <4853EA19.2060507@centrum.sk>
References: <4852B63D.1020009@centrum.sk>
	<200806141640.29310.laurent.pinchart@skynet.be>
	<4853EA19.2060507@centrum.sk>
Message-ID: <200806141825.46355.laurent.pinchart@skynet.be>

Hi Peter,

On Saturday 14 June 2008, Peter Veres wrote:
> Laurent Pinchart  wrote / nap?sal(a):
> > Hi Peter,
> >
> > On Friday 13 June 2008, you wrote:
> >> Hello, is there any possible supoprt for CANYON CNR-WCAM53 webcam? I
> >> have just purchased it but can't use it on linux.
> >> lsusb provides: ID 093a:2620 Pixart Imaging, Inc.
> >> Can anyone help me please?
> >
> > Could you please send me the output of
> >
> > lsusb -v -d 093a:2620
> >
> > using usbutils 0.72 or newer (0.73+ preferred) ?
> >
> > Best regards,
> >
> > Laurent Pinchart
>
> Thanks a lot for a response.
> Here is the output provided by that command (i have downloaded 0.73 from
> sourceforge and used it to get this output):

Thanks.

Your webcam is unfortunately not UVC compatible. The Linux UVC driver won't be 
able to support it, sorry.

Best regards,

Laurent Pinchart


From roi at jornadastecnicasdeautomocion.com  Sun Jun 15 12:29:10 2008
From: roi at jornadastecnicasdeautomocion.com (Roi)
Date: Sun, 15 Jun 2008 12:29:10 +0200
Subject: [Linux-uvc-devel] webcam  Chicony Electronics
Message-ID: <200806151029.m5FATAZD030229@hl47.dinaserver.com>

hello

i have a compaq c700 and im trying to install the integrated webcam in
ubuntu 8.

root at compaq:~# lsusb
Bus 004 Device 003: ID 04f2:b057 Chicony Electronics Co., Ltd
Bus 004 Device 001: ID 0000:0000
Bus 003 Device 001: ID 0000:0000
Bus 002 Device 001: ID 0000:0000
Bus 001 Device 003: ID 046d:c050 Logitech, Inc.
Bus 001 Device 001: ID 0000:0000
root at compaq:~# dmesg | grep video
[   17.446148] Boot video device is 0000:00:02.0
[   33.023952] Linux video capture interface: v2.00
[   33.168418] uvcvideo: Found UVC 1.00 device CNF7041 (04f2:b057)
[   33.173010] usbcore: registered new interface driver uvcvideo

if i do lucview, i obtain "init v4l2 failed"

Can you help me??



From elbaddy at gmail.com  Sun Jun 15 19:33:21 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Sun, 15 Jun 2008 19:33:21 +0200
Subject: [Linux-uvc-devel] SiGma Micro USB Web Camera support
In-Reply-To: <BFDD56B6-7C7B-4A17-B927-F260AAAF0542@iki.fi>
References: <200806081209.09859.laurent.pinchart@skynet.be>
	<D3ABF2DF-1B62-449D-8530-A3F93A255C84@iki.fi>
	<3d7891440806120858w67694e82y8e51913db7ca0ea8@mail.gmail.com>
	<7DB45BAB-4061-46C2-8501-9A1937E3BAA2@iki.fi>
	<3d7891440806121005k61207609j4b8ba01046636d5b@mail.gmail.com>
	<BFDD56B6-7C7B-4A17-B927-F260AAAF0542@iki.fi>
Message-ID: <3d7891440806151033x28866f57j2b4ed564b8a449d1@mail.gmail.com>

Hi Juho,

2008/6/12 Juho V?h?-Herttua <juhovh at iki.fi>:
>
> On 13.6.2008, at 1.05, Lorenzo Battistini wrote:
>>
>> Yes, now kernel does not give error, but gstreamer-properties is still
>> not working:
>>
>> Error running pipeline 'Video for Linux 2 (v4l2)': Could not negotiate
>> format [gstbasesrc.c(2359): gst_base_src_start ():
>> /pipeline0/v4l2src3:
>> Check your filtered caps, if any]
>
> Does gstreamer play the video if you try to give the command:
>
> gst-launch-0.10 v4l2src ! jpegdec ! xvimagesink
>
> You could try to set the gstreamer-properties with custom video settings
> like:
>
> v4l2src device="/dev/video0" ! jpegdec ! ffmpegcolorspace
>
> I wasn't able to test this, because for some unknown reason (which I don't
> think is related to uvcvideo) my gstreamer-settings application is crashing
> all the time with segfault...
>
>

Uh, great, both gst-launch-0.10 and gstreamer-properties work.
Just a thing: I tried to use the camera in skype through gstfakevideo
( http://code.google.com/p/gstfakevideo/ ), but launching

gstfakevideo v4l2src device=/dev/video1 ! jpegdec ! ffmpegcolorspace

this program always gives

gst.c bus_callback (105): Error: Internal data flow error.

and kernel is quiet...
hoping in Laurent's patch...


Best regards,
Lorenzo


From arjos85 at gmail.com  Sun Jun 15 16:37:28 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Sun, 15 Jun 2008 16:37:28 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
Message-ID: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>

Hi everybody,
I'm new of this mailing list and I haven't read all the messaged previously
posted.
However I'm just writing to you in order to help all those who have my same
problem.

Just two weeks ago I bought a new laptop: ASUS F3SR (cpu intel duo T500,
2GB ram, .....) with a Sonix webcam.
On preinstalled Win Vista (excuse me for the heresy) everything works fine.
But on Kubuntu 8.04 the webcam just show me upside-down images.

I've try to solve this problem with a pipe and a vloopback module, but
unluckly I could not make it works.
So I decided to mod the uvcvideo driver...and after some damns I got it
works.
I've added very few lines of code and in just one function.
Has attachement you can find the changed file "uvc_video.c".
In the follow I report the changed function:

----------------------------------------------------------------------------------------

static void uvc_video_decode_data(struct uvc_video_device *video,
        struct uvc_buffer *buf, const __u8 *data, int len)
{
    struct uvc_video_queue *queue = &video->queue;
    unsigned int maxlen, nbytes;
    void *mem;
    //// ADDED VARIABLES /////
    __u8 *mem_tmp;
    int i, k, pixel_size;
    unsigned int size_tmp;
    //// ADDED VARIABLES /////

    if (len <= 0)
        return;

    /* Copy the video data to the buffer. */
    maxlen = buf->buf.length - buf->buf.bytesused;
    mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
    nbytes = min((unsigned int)len, maxlen);

    memcpy(mem, data, nbytes);

    buf->buf.bytesused += nbytes;

    /* Complete the current frame if the buffer size was exceeded. */

/////////////////// START ADDED CODE
/////////////////////////////////////////////////////////////////////
    // I've just added the "=" operator in order to set "buf->state =
UVC_BUF_STATE_DONE"        //
    // right now without waiting another "round"
 //
    if (len >= maxlen) {
        // Total size of the pixel frame                            //
        size_tmp = buf->buf.bytesused - (len - maxlen);

        // Area in which to save the original frame before the conversion
         //
        mem_tmp=(__u8 *) kmalloc(size_tmp , GFP_USER);

        // Copy the original frame in a temporary buffer
 //
        memcpy(mem_tmp, queue->mem + buf->buf.m.offset, size_tmp);

        // Size of each pixel, in my case is 4 byte! If you have some
problems with color or    //
        // image coherency just try to change this value in accordance with
your video device    //
        // If you have problem I suggest to try "pixel_size = 2;"
     //
        pixel_size = 4 ;
        // The following cycle just copy pixels from the temporary frame
(originary one)     //
        // in a reverse order: from the last (bottom right in the
upside-down image) to     //
        // the first (top left in the final flipped image)
 //
        for (     i=0, k=size_tmp - pixel_size; i < size_tmp; i+=pixel_size,
k-=pixel_size)
            memcpy( (__u8 *)queue->mem + buf->buf.m.offset + i, mem_tmp + k,
pixel_size );
/////////////////// END ADDED CODE
///////////////////////////////////////////////////////////////////////

        uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
        buf->state = UVC_BUF_STATE_DONE;
    }
}

--------------------------------------------------------------------------------------------------------

You can either:
- copy this function and substitute to the original one in "uvc_video.c"
or
- use the attachement file and delete the original file.

The following steps are intended for those who have already installed
uvcvideo driver and their webcam is recognised but with upside-down images.

Then you should do:
- close all the program that are using the input video device
- with your terminal go inside the folder where there are the uvcvideo
source files and type:
$ sudo modprobe -r uvcvideo
$ KERNEL_VERSION=`uname -r`
$ find /lib/modules/$KERNEL_VERSION -name uvcvideo.ko
// with the previous command you should get a list of just 2 path in which
uvcvideo.ko is already installed
// one of this ends with "usb/media/uvcvideo.ko", just copy the OTHER one,
in the next steps I will call this  "COPIED_PATH"!!
$ make
$ sudo make install
// "make install" command will install uvcvideo.ko  in
/lib/modules/$(KERNEL_VERSION)/usb/media/
// but you also need to copy uvcvideo.ko in an another dir, and in my case
on kubuntu  this folder
// is /lib/modules/2.6.24-18-generic/ubuntu/media/usbvideo/  but you have to
do:
$ sudo cp uvcvideo.ko COPIED_DIR
$ sudo modprobe uvcvideo

Now your webcam is ready and should work in the right way.
If you have  problems with color or image incoherency, please try to mod my
code (refer to my comments inside the changed code).

Let me know if you have some doubts....
i know i am not an expert of linux...so i could have made some error in the
previous shell commands!!

Please let me know!!
However i hope my help could be useful for someone!!

Ciao

Marco Argiolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080615/e0ded8cb/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc_video.c
Type: text/x-csrc
Size: 29109 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080615/e0ded8cb/attachment.c>

From asergiu at yahoo.co.uk  Mon Jun 16 18:01:18 2008
From: asergiu at yahoo.co.uk (Adrian Sergiu Darabant)
Date: Mon, 16 Jun 2008 16:01:18 +0000 (GMT)
Subject: [Linux-uvc-devel] Update --- Camera UVC (chipset Syntec)
Message-ID: <507351.60710.qm@web27706.mail.ukl.yahoo.com>

Hi all,
   I am playing further with my 2.0MP USB cameras. 
With uvcvideo - it gives me each time as already stated 2 months ago : 
Jun 16 18:40:02 core2 kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26) retry=3, timeout=1000
Jun 16 18:40:02 core2 kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26) retry=2, timeout=1500
Jun 16 18:40:02 core2 kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26) retry=1, timeout=2000
Jun 16 18:40:03 core2 kernel: uvcvideo: Failed to query (1) UVC control 2 (unit 0) : -110 (exp. 26) retry=3, timeout=1000

The retry and timeout messages are infos I've added to the uvc_video.c (__uvc_query_ctrl function) in the hope that recalling the same operation (with a increasing timeout for a maximum of 3 times might work - saw a similar issue with somebody else). Things that I've changed are in bold.A few hints: if I unload the uvcvideo module and do an lsusb -v again the lsusb will timeout when getting some info near the end. However if a disconnect and reconnect the camera lsusb will work again without timeouts. It looks like uvcvideo does something to the camera when interogatting it making it unresponsible. 
Any further directions will be appreciated.

static int __uvc_query_ctrl(struct uvc_device *dev, __u8 query, __u8 unit,
            __u8 intfnum, __u8 cs, void *data, __u16 size,
            int timeout)
{
    __u8 type = USB_TYPE_CLASS | USB_RECIP_INTERFACE;
    unsigned int pipe;
   int ret=0, retry=3;

   while( (retry>0) && (ret!=size) ) {
        pipe = (query & 0x80) ? usb_rcvctrlpipe(dev->udev, 0)
                      : usb_sndctrlpipe(dev->udev, 0);
        type |= (query & 0x80) ? USB_DIR_IN : USB_DIR_OUT;

        ret = usb_control_msg(dev->udev, pipe, query, type, cs << 8,
                unit << 8 | intfnum, data, size, timeout);

        if (ret != size) {
            uvc_printk(KERN_ERR, "Failed to query (%u) UVC control %u "
                "(unit %u) : %d (exp. %u) retry=%d, timeout=%d\n", query, cs, unit, ret,
                size, retry, timeout);
        }
       timeout+=500;
        retry--;
    }
   if (ret!=size) return -EIO;
    
    return 0;
}

Here are their lsusb:
kernel : Linux core2 2.6.22.17-0.1-default #1 SMP 2008/02/10 20:01:04 UTC i686 i686 i386 GNU/Linux
core2:~/uvc/trunk # lsusb -v -d 174f:8a51

Bus 002 Device 007: ID 174f:8a51
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x174f
  idProduct          0x8a51
  bcdDevice            7.13
  iManufacturer           2 Syntek
  iProduct                3 USB2.0 UVC PC Camera
  iSerial                 4 0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          489
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              0
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           51
        dwClockFrequency        3.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             4
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000001b
          Brightness
          Contrast
          Saturation
          Sharpness
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormarts                        1
        wTotalLength                    33025
        bEndPointAddress                    0
        bmInfo                              4
        bTerminalLink                       2
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                9
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 18432000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1152000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1520640
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  4608000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  6082560
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                  8640000
        dwMaxBitRate                  8640000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 14155776
        dwMaxBitRate                 14155776
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 23592960
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         9
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                 34560000
        dwMaxBitRate                 34560000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        1000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            10
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        bNumCompressionPatterns             1
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

---------------------------------------------------------------------------------------------------------------------------------
doing an 
rmmod uvcvideo
modprobe uvcvideo
lsusb -v -d 
I get sometimes  these messages in the log. I don't see timeouts on the standard output of the lsusb as before.

Jun 16 18:39:38 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 6 len 255 ret -110
Jun 16 18:39:45 core2 syslog-ng[5595]: last message repeated 2 times
Jun 16 18:39:45 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 6 len 10 ret -110
Jun 16 18:39:50 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 6 len 4 ret -110
Jun 16 18:39:55 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 0 len 2 ret -110

I dispose a few of these cameras - I can work on the code but I don't know really where to start to.

Thx
Adrian


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080616/dca25f0d/attachment.html>

From asergiu at yahoo.co.uk  Mon Jun 16 18:25:50 2008
From: asergiu at yahoo.co.uk (Adrian Sergiu Darabant)
Date: Mon, 16 Jun 2008 16:25:50 +0000 (GMT)
Subject: [Linux-uvc-devel] Update (Syntek) 2.0MP camera  UVC  (174f:8a51)
Message-ID: <398893.82538.qm@web27704.mail.ukl.yahoo.com>

I managed to get a /dev/video0 finally without changing anything else (just loading and unloading the module several times) but when trying to point luvcview I get timeouts in the log and no image. I cannot stop luvcview - have to kill it.
Other times I get a first frame and then it freezes there ....

Adrian



Hi all,
   I am playing further with my 2.0MP USB cameras. 
With uvcvideo - it gives me each time as already stated 2 months ago : 
Jun 16 18:40:02 core2 kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26) retry=3, timeout=1000
Jun 16 18:40:02 core2 kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26) retry=2, timeout=1500
Jun 16 18:40:02 core2 kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26) retry=1, timeout=2000
Jun 16 18:40:03 core2 kernel: uvcvideo: Failed to query (1) UVC control 2 (unit 0) : -110 (exp. 26) retry=3, timeout=1000

The
retry and timeout messages are infos I've added to the uvc_video.c
(__uvc_query_ctrl function) in the hope that recalling the same
operation (with a increasing timeout for a maximum of 3 times might
work - saw a similar issue with somebody else). Things that I've
changed are in bold.A few hints: if I unload the uvcvideo module and do
an lsusb -v again the lsusb will timeout when getting some info near
the end. However if a disconnect and reconnect the camera lsusb will
work again without timeouts. It looks like uvcvideo does something to
the camera when interogatting it making it unresponsible. 
Any further directions will be appreciated.

static int __uvc_query_ctrl(struct uvc_device *dev, __u8 query, __u8 unit,
            __u8 intfnum, __u8 cs, void *data, __u16 size,
            int timeout)
{
    __u8 type = USB_TYPE_CLASS | USB_RECIP_INTERFACE;
    unsigned int pipe;
   int ret=0, retry=3;

   while( (retry>0) && (ret!=size) ) {
        pipe = (query & 0x80) ? usb_rcvctrlpipe(dev->udev, 0)
                      : usb_sndctrlpipe(dev->udev, 0);
        type |= (query & 0x80) ? USB_DIR_IN : USB_DIR_OUT;

        ret = usb_control_msg(dev->udev, pipe, query, type, cs << 8,
                unit << 8 | intfnum, data, size, timeout);

        if (ret != size) {
            uvc_printk(KERN_ERR, "Failed to query (%u) UVC control %u "
                "(unit %u) : %d (exp. %u) retry=%d, timeout=%d\n", query, cs, unit, ret,
                size, retry, timeout);
        }
       timeout+=500;
        retry--;
    }
   if (ret!=size) return -EIO;
    
    return 0;
}

Here are their lsusb:
kernel : Linux core2 2.6.22.17-0.1-default #1 SMP 2008/02/10 20:01:04 UTC i686 i686 i386 GNU/Linux
core2:~/uvc/trunk # lsusb -v -d 174f:8a51

Bus 002 Device 007: ID 174f:8a51
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x174f
  idProduct          0x8a51
  bcdDevice            7.13
  iManufacturer           2 Syntek
  iProduct                3 USB2.0 UVC PC Camera
  iSerial                 4 0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          489
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              0
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           51
        dwClockFrequency        3.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             4
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000001b
          Brightness
          Contrast
          Saturation
          Sharpness
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormarts                        1
        wTotalLength                    33025
        bEndPointAddress                    0
        bmInfo                              4
        bTerminalLink                       2
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                9
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 18432000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1152000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1520640
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  4608000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  6082560
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                  8640000
        dwMaxBitRate                  8640000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 14155776
        dwMaxBitRate                 14155776
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 23592960
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         9
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                 34560000
        dwMaxBitRate                 34560000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        1000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            10
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        bNumCompressionPatterns             1
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

---------------------------------------------------------------------------------------------------------------------------------
doing an 
rmmod uvcvideo
modprobe uvcvideo
lsusb -v -d 
I get sometimes  these messages in the log. I don't see timeouts on the standard output of the lsusb as before.

Jun 16 18:39:38 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 6 len 255 ret -110
Jun 16 18:39:45 core2 syslog-ng[5595]: last message repeated 2 times
Jun 16 18:39:45 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 6 len 10 ret -110
Jun 16 18:39:50 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 6 len 4 ret -110
Jun 16 18:39:55 core2 kernel: usb 2-5: usbfs: USBDEVFS_CONTROL failed cmd lsusb rqt 128 rq 0 len 2 ret -110

I dispose a few of these cameras - I can work on the code but I don't know really where to start to.

Thx
Adrian


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080616/d8889715/attachment.html>

From laurent.pinchart at skynet.be  Tue Jun 17 00:06:36 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 17 Jun 2008 00:06:36 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
References: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
Message-ID: <200806170006.36468.laurent.pinchart@skynet.be>

Hi Marco,

On Sunday 15 June 2008, Marco Argiolas wrote:
> Hi everybody,
> I'm new of this mailing list and I haven't read all the messaged previously
> posted.
> However I'm just writing to you in order to help all those who have my same
> problem.

Thanks a lot for taking the time to help the Linux UVC driver users.

> Just two weeks ago I bought a new laptop: ASUS F3SR (cpu intel duo T500,
> 2GB ram, .....) with a Sonix webcam.
> On preinstalled Win Vista (excuse me for the heresy) everything works fine.
> But on Kubuntu 8.04 the webcam just show me upside-down images.
>
> I've try to solve this problem with a pipe and a vloopback module, but
> unluckly I could not make it works.
> So I decided to mod the uvcvideo driver...and after some damns I got it
> works.
> I've added very few lines of code and in just one function.
> Has attachement you can find the changed file "uvc_video.c".
> In the follow I report the changed function:

[snip]

The usual way of reporting such changes is to send a patch. You can easily 
generate one using

diff -u file.old file.new

> ---------------------------------------------------------------------------
>
> You can either:
> - copy this function and substitute to the original one in "uvc_video.c"
> or
> - use the attachement file and delete the original file.
>
> The following steps are intended for those who have already installed
> uvcvideo driver and their webcam is recognised but with upside-down images.
>
> Then you should do:
> - close all the program that are using the input video device
> - with your terminal go inside the folder where there are the uvcvideo
> source files and type:
> $ sudo modprobe -r uvcvideo
> $ KERNEL_VERSION=`uname -r`
> $ find /lib/modules/$KERNEL_VERSION -name uvcvideo.ko
> // with the previous command you should get a list of just 2 path in which
> uvcvideo.ko is already installed
> // one of this ends with "usb/media/uvcvideo.ko", just copy the OTHER one,
> in the next steps I will call this  "COPIED_PATH"!!
> $ make
> $ sudo make install
> // "make install" command will install uvcvideo.ko  in
> /lib/modules/$(KERNEL_VERSION)/usb/media/
> // but you also need to copy uvcvideo.ko in an another dir, and in my case
> on kubuntu  this folder
> // is /lib/modules/2.6.24-18-generic/ubuntu/media/usbvideo/  but you have
> to do:
> $ sudo cp uvcvideo.ko COPIED_DIR
> $ sudo modprobe uvcvideo
>
> Now your webcam is ready and should work in the right way.
> If you have  problems with color or image incoherency, please try to mod my
> code (refer to my comments inside the changed code).
>
> Let me know if you have some doubts....
> i know i am not an expert of linux...so i could have made some error in the
> previous shell commands!!
>
> Please let me know!!
> However i hope my help could be useful for someone!!

The patch will probably be quite useful for some users, but I'm afraid I can't 
integrate it in the driver. Image processing is userspace's job.

I'm pretty sure people will be grateful if you maintain the patch against the 
new driver versions.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 17 00:34:22 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 17 Jun 2008 00:34:22 +0200
Subject: [Linux-uvc-devel] Update (Syntek) 2.0MP camera UVC (174f:8a51)
In-Reply-To: <398893.82538.qm@web27704.mail.ukl.yahoo.com>
References: <398893.82538.qm@web27704.mail.ukl.yahoo.com>
Message-ID: <200806170034.23034.laurent.pinchart@skynet.be>

Hi Adrian,

On Monday 16 June 2008, Adrian Sergiu Darabant wrote:
> I managed to get a /dev/video0 finally without changing anything else (just
> loading and unloading the module several times) but when trying to point
> luvcview I get timeouts in the log and no image. I cannot stop luvcview -
> have to kill it. Other times I get a first frame and then it freezes there
> ....

Your camera seems really buggy. The firmware crashes for no reason. If I had 
to guess I'd say there are timing issues.

If there are indeed timing issues there's not much I can do about it. It's a 
classic case of broken hardware tested with Windows only (although in your 
case the hardware reaches new levels of brokenness).

Another possibility (less likely, but still) is that the camera crashes 
because it receives an unexpected request from the driver, regardless of the 
timing. You could try to check this by sniffing USB traffic in Windows and 
tweaking the Linux driver to submit identical requests.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 17 00:37:13 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 17 Jun 2008 00:37:13 +0200
Subject: [Linux-uvc-devel] webcam  Chicony Electronics
In-Reply-To: <200806151029.m5FATAZD030229@hl47.dinaserver.com>
References: <200806151029.m5FATAZD030229@hl47.dinaserver.com>
Message-ID: <200806170037.13392.laurent.pinchart@skynet.be>

On Sunday 15 June 2008, Roi wrote:
> hello
>
> i have a compaq c700 and im trying to install the integrated webcam in
> ubuntu 8.
>
> root at compaq:~# lsusb
> Bus 004 Device 003: ID 04f2:b057 Chicony Electronics Co., Ltd
> Bus 004 Device 001: ID 0000:0000
> Bus 003 Device 001: ID 0000:0000
> Bus 002 Device 001: ID 0000:0000
> Bus 001 Device 003: ID 046d:c050 Logitech, Inc.
> Bus 001 Device 001: ID 0000:0000
> root at compaq:~# dmesg | grep video
> [   17.446148] Boot video device is 0000:00:02.0
> [   33.023952] Linux video capture interface: v2.00
> [   33.168418] uvcvideo: Found UVC 1.00 device CNF7041 (04f2:b057)
> [   33.173010] usbcore: registered new interface driver uvcvideo
>
> if i do lucview, i obtain "init v4l2 failed"
>
> Can you help me??

Try

luvcview -f yuv

Best regards,

Laurent Pinchart


From robin.hartley at xtra.co.nz  Wed Jun 18 11:13:19 2008
From: robin.hartley at xtra.co.nz (robin.hartley)
Date: Wed, 18 Jun 2008 21:13:19 +1200
Subject: [Linux-uvc-devel] Update (Syntek) 2.0MP camera UVC (174f:8a51)
In-Reply-To: <200806170034.23034.laurent.pinchart@skynet.be>
References: <398893.82538.qm@web27704.mail.ukl.yahoo.com>
	<200806170034.23034.laurent.pinchart@skynet.be>
Message-ID: <t0kh549rkj2g660bnsv0gf313h5uhk88vp@4ax.com>

Hi Adrian & Laurent,
This sounds very similar to the problems I've been having with my
camera (Subject: [Linux-uvc-devel] New camera not yet supported.
(1871:0306))

In my case once the camera is running it remains stable unless I
unplug it.
I'm convinced the issues I'm having are not with the driver but are at
a more basic USB level.
When it plays up a "lsub -v " hangs at various points for several
seconds and produces errors that various points didn't respond.

I've tried the very latest kernel without success. It occasionally
errors and completely unloads the USB2.0 system

The next thing I'm going to try is to do a forced reset of the device
and see if that helps.

I'll post my results.

Regards,
Robin



On Tue, 17 Jun 2008 00:34:22 +0200, you wrote:

>Hi Adrian,
>
>On Monday 16 June 2008, Adrian Sergiu Darabant wrote:
>> I managed to get a /dev/video0 finally without changing anything else (just
>> loading and unloading the module several times) but when trying to point
>> luvcview I get timeouts in the log and no image. I cannot stop luvcview -
>> have to kill it. Other times I get a first frame and then it freezes there
>> ....
>
>Your camera seems really buggy. The firmware crashes for no reason. If I had 
>to guess I'd say there are timing issues.
>
>If there are indeed timing issues there's not much I can do about it. It's a 
>classic case of broken hardware tested with Windows only (although in your 
>case the hardware reaches new levels of brokenness).
>
>Another possibility (less likely, but still) is that the camera crashes 
>because it receives an unexpected request from the driver, regardless of the 
>timing. You could try to check this by sniffing USB traffic in Windows and 
>tweaking the Linux driver to submit identical requests.
>
>Best regards,
>
>Laurent Pinchart
>_______________________________________________
>Linux-uvc-devel mailing list
>Linux-uvc-devel at lists.berlios.de
>https://lists.berlios.de/mailman/listinfo/linux-uvc-devel


From jaime.perea at gmail.com  Wed Jun 18 13:25:08 2008
From: jaime.perea at gmail.com (Jaime Perea)
Date: Wed, 18 Jun 2008 13:25:08 +0200
Subject: [Linux-uvc-devel] device 174f:8a33
Message-ID: <200806181325.08195.jaime.perea@gmail.com>

Hello

After messing around with the uvcvideo module parameters
I discovered that installing the uvcvide module it with quirks=16,
my integrated camera works fine.

Asus E3S - Mandriva 2008.1 - kernel 2.6.24.5-laptop-2mnb

Thus, inserting in the /etc/modprobe.conf file a line 

options uvcvideo quirks=16

does the trick. At least it works with luvcview, ekiga and skype 

By the way this is to define the UVC_QUIRK_STREAM_NO_FID 
quirk, which is something that goes beyond us mere
mortals :-)

Thanks for the good work and regards.

--
Jaime



From richard at rsk.demon.co.uk  Wed Jun 18 14:10:34 2008
From: richard at rsk.demon.co.uk (Richard Kennedy)
Date: Wed, 18 Jun 2008 13:10:34 +0100
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX
	laptop	embedded webcam
In-Reply-To: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
References: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
Message-ID: <1213791034.3051.9.camel@castor.localdomain>


On Sun, 2008-06-15 at 16:37 +0200, Marco Argiolas wrote:
> Hi everybody,
> I'm new of this mailing list and I haven't read all the messaged
> previously posted.
> However I'm just writing to you in order to help all those who have my
> same problem.
> 
> Just two weeks ago I bought a new laptop: ASUS F3SR (cpu intel duo
> T500,  2GB ram, .....) with a Sonix webcam.
> On preinstalled Win Vista (excuse me for the heresy) everything works
> fine.
> But on Kubuntu 8.04 the webcam just show me upside-down images.
> 
> I've try to solve this problem with a pipe and a vloopback module, but
> unluckly I could not make it works.
> So I decided to mod the uvcvideo driver...and after some damns I got
> it works.
> I've added very few lines of code and in just one function.
> Has attachement you can find the changed file "uvc_video.c".
> In the follow I report the changed function:
> 
> ----------------------------------------------------------------------------------------
> 
> static void uvc_video_decode_data(struct uvc_video_device *video,
>         struct uvc_buffer *buf, const __u8 *data, int len)
> {
>     struct uvc_video_queue *queue = &video->queue;
>     unsigned int maxlen, nbytes;
>     void *mem;
>     //// ADDED VARIABLES /////
>     __u8 *mem_tmp;        
>     int i, k, pixel_size;    
>     unsigned int size_tmp;    
>     //// ADDED VARIABLES /////
> 
>     if (len <= 0)
>         return;
> 
>     /* Copy the video data to the buffer. */
>     maxlen = buf->buf.length - buf->buf.bytesused;
>     mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
>     nbytes = min((unsigned int)len, maxlen);
>     
>     memcpy(mem, data, nbytes);
>         
>     buf->buf.bytesused += nbytes;
> 
>     /* Complete the current frame if the buffer size was exceeded. */
> 
> /////////////////// START ADDED
> CODE /////////////////////////////////////////////////////////////////////
>     // I've just added the "=" operator in order to set "buf->state =
> UVC_BUF_STATE_DONE"        //
>     // right now without waiting another "round"
>          //
>     if (len >= maxlen) {                                        
>         // Total size of the pixel frame                            //
>         size_tmp = buf->buf.bytesused - (len - maxlen);
>          
>         // Area in which to save the original frame before the
> conversion            //
>         mem_tmp=(__u8 *) kmalloc(size_tmp , GFP_USER);
>          
>         // Copy the original frame in a temporary buffer
>          //
>         memcpy(mem_tmp, queue->mem + buf->buf.m.offset, size_tmp);
>              
>         // Size of each pixel, in my case is 4 byte! If you have some
> problems with color or    //
>         // image coherency just try to change this value in accordance
> with your video device    //
>         // If you have problem I suggest to try "pixel_size = 2;"
>              //
>         pixel_size = 4 ;                                    
>         // The following cycle just copy pixels from the temporary
> frame (originary one)     //
>         // in a reverse order: from the last (bottom right in the
> upside-down image) to     //
>         // the first (top left in the final flipped image)
>          //
>         for (     i=0, k=size_tmp - pixel_size; i < size_tmp; i
> +=pixel_size, k-=pixel_size)
>             memcpy( (__u8 *)queue->mem + buf->buf.m.offset + i,
> mem_tmp + k, pixel_size );
> /////////////////// END ADDED
> CODE ///////////////////////////////////////////////////////////////////////
> 
>         uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
>         buf->state = UVC_BUF_STATE_DONE;
>     }
> }
> 
> --------------------------------------------------------------------------------------------------------
> 
> You can either:
> - copy this function and substitute to the original one in
> "uvc_video.c"
> or
> - use the attachement file and delete the original file.
> 
> The following steps are intended for those who have already installed
> uvcvideo driver and their webcam is recognised but with upside-down
> images.
> 
> Then you should do:
> - close all the program that are using the input video device
> - with your terminal go inside the folder where there are the uvcvideo
> source files and type:
> $ sudo modprobe -r uvcvideo
> $ KERNEL_VERSION=`uname -r`
> $ find /lib/modules/$KERNEL_VERSION -name uvcvideo.ko 
> // with the previous command you should get a list of just 2 path in
> which uvcvideo.ko is already installed
> // one of this ends with "usb/media/uvcvideo.ko", just copy the OTHER
> one, in the next steps I will call this  "COPIED_PATH"!!
> $ make
> $ sudo make install
> // "make install" command will install uvcvideo.ko
> in  /lib/modules/$(KERNEL_VERSION)/usb/media/ 
> // but you also need to copy uvcvideo.ko in an another dir, and in my
> case on kubuntu  this folder
> // is /lib/modules/2.6.24-18-generic/ubuntu/media/usbvideo/  but you
> have to do:
> $ sudo cp uvcvideo.ko COPIED_DIR
> $ sudo modprobe uvcvideo
> 
> Now your webcam is ready and should work in the right way.
> If you have  problems with color or image incoherency, please try to
> mod my code (refer to my comments inside the changed code).
> 
> Let me know if you have some doubts....
> i know i am not an expert of linux...so i could have made some error
> in the previous shell commands!!
> 
> Please let me know!!
> However i hope my help could be useful for someone!!
> 
> Ciao 
> 
> Marco Argiolas
Hi Marco,

Nice to see that you've got yourself a fix. But you are leaking your
temp buffer -- you'll need to free it somewhere.

But it does seem expensive to copy the data 3 times. Could you do
something like this instead? 

int *src = (int*) data + len;
int *dst = (int*) buffer;

for ( int i= 0; i < len /sizeof(int); i++) {
	src--;
	*dst++ = *src;
}

that way you only have to copy the data once and you don't need a
temporary buffer.

Cheers
Richard





From asergiu at yahoo.co.uk  Wed Jun 18 14:41:46 2008
From: asergiu at yahoo.co.uk (Adrian Sergiu DARABANT)
Date: Wed, 18 Jun 2008 15:41:46 +0300
Subject: [Linux-uvc-devel] SOLVED: upside-down image from
	SONIXlaptop	embedded webcam
In-Reply-To: <1213791034.3051.9.camel@castor.localdomain>
References: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
	<1213791034.3051.9.camel@castor.localdomain>
Message-ID: <B202DF071955462B9DC44EC468278323@core2>

Yes - what I've been thinking about either. I wonder isn't there a control
on the camera that switches the image vertically. There are cameras that do
that. Otherwise it means that the Windows driver does the same and that is
quite expensive doing memory copies on video flows buffers (what will that
do at 1600x1200 for example on a 2MP camera ??

Adrian Sergiu DARABANT



Nice to see that you've got yourself a fix. But you are leaking your
temp buffer -- you'll need to free it somewhere.

But it does seem expensive to copy the data 3 times. Could you do
something like this instead? 

int *src = (int*) data + len;
int *dst = (int*) buffer;

for ( int i= 0; i < len /sizeof(int); i++) {
	src--;
	*dst++ = *src;
}

that way you only have to copy the data once and you don't need a
temporary buffer.

Cheers
Richard



_______________________________________________
Linux-uvc-devel mailing list
Linux-uvc-devel at lists.berlios.de
https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From kadiravan_a at lintechnokrats.com  Thu Jun 19 12:51:29 2008
From: kadiravan_a at lintechnokrats.com (kadiravan)
Date: Thu, 19 Jun 2008 16:21:29 +0530
Subject: [Linux-uvc-devel] Drivers for Device-ID 5986:0105
Message-ID: <1213872689.14542.4.camel@linux-i68a.site>

Dear all,

             UVC video drivers is able to identify the device but unable
to function.We have referred to supported devices list but we havent
found support for the Device (ID 5986:0105 )
             
             OS: Suse 10.1
             Kernel: 2.6.16.54-0.2.5-smp
             UVC version: 1.0 , we have checked out the latest from the
repository
             Device: Acer Crystal Eye

DMESG:

      Linux video capture interface: v1.00
uvcvideo: module not supported by Novell, setting U taint flag.
uvcvideo: Found UVC 1.00 device Acer Crystal Eye webcam (5986:0105)
usbcore: registered new driver uvcvideo
USB Video Class driver (v0.1.0)

LSUSB

Bus 006 Device 002: ID 5986:0105
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x5986
  idProduct          0x0105
  bcdDevice            0.07
  iManufacturer           2 USB Audio Device
  iProduct                1 Acer Crystal Eye webcam
  iSerial                 0
  bNumConfigurations      1
  

Thanks 

Kadiravan



From kadiravan_a at lintechnokrats.com  Thu Jun 19 12:45:59 2008
From: kadiravan_a at lintechnokrats.com (kadiravan)
Date: Thu, 19 Jun 2008 16:15:59 +0530
Subject: [Linux-uvc-devel] Drivers for Device ID 5986:0105
Message-ID: <1213872359.14542.0.camel@linux-i68a.site>

Dear all,

             UVC video drivers is able to identify the device but unable
to function.We have referred to supported devices list but we havent
found support for the Device (ID 5986:0105 )
             
             OS: Suse 10.1
             Kernel: 2.6.16.54-0.2.5-smp
             UVC version: 1.0 , we have checked out the latest from the
repository
             Device: Acer Crystal Eye



             We have attached out put from DMESG and LSUSB.

Thanks 

Kadiravan
-------------- next part --------------
Linux version 2.6.16.54-0.2.5-smp (geeko at buildhost) (gcc version 4.1.2 20070115 (prerelease) (SUSE Linux)) #1 SMP Mon Jan 21 13:29:51 UTC 2008
BIOS-provided physical RAM map:
 BIOS-e820: 0000000000000000 - 000000000009f800 (usable)
 BIOS-e820: 000000000009f800 - 00000000000a0000 (reserved)
 BIOS-e820: 00000000000d2000 - 00000000000d4000 (reserved)
 BIOS-e820: 00000000000e0000 - 0000000000100000 (reserved)
 BIOS-e820: 0000000000100000 - 000000003f6d0000 (usable)
 BIOS-e820: 000000003f6d0000 - 000000003f6df000 (ACPI NVS)
 BIOS-e820: 000000003f6df000 - 0000000040000000 (reserved)
 BIOS-e820: 00000000e0000000 - 00000000f0000000 (reserved)
 BIOS-e820: 00000000fec00000 - 00000000fec10000 (reserved)
 BIOS-e820: 00000000fed00000 - 00000000fed00400 (reserved)
 BIOS-e820: 00000000fed14000 - 00000000fed1a000 (reserved)
 BIOS-e820: 00000000fed1c000 - 00000000fed90000 (reserved)
 BIOS-e820: 00000000fee00000 - 00000000fee01000 (reserved)
 BIOS-e820: 00000000ff000000 - 0000000100000000 (reserved)
118MB HIGHMEM available.
895MB LOWMEM available.
found SMP MP-table at 000f7d60
On node 0 totalpages: 259792
  DMA zone: 4096 pages, LIFO batch:0
  DMA32 zone: 0 pages, LIFO batch:0
  Normal zone: 225279 pages, LIFO batch:31
  HighMem zone: 30417 pages, LIFO batch:7
DMI present.
Using APIC driver default
ACPI: RSDP (v002 PTLTD                                 ) @ 0x000f7bf0
ACPI: XSDT (v001 ACRSYS ACRPRDCT 0x06040000 INNA 0x00000000) @ 0x3f6d0ab3
ACPI: FADT (v003 INTEL  CRESTLNE 0x06040000 ALAN 0x00000001) @ 0x3f6dbbd7
ACPI: HPET (v001 INTEL  CRESTLNE 0x06040000 LOHR 0x0000005a) @ 0x3f6dbccb
ACPI: MCFG (v001 INTEL  CRESTLNE 0x06040000 LOHR 0x0000005a) @ 0x3f6dbd03
ACPI: TCPA (v001 Intel   CRESTLN 0x06040000  0x00005a52) @ 0x3f6dbd3f
ACPI: TMOR (v001 PTLTD           0x06040000 PTL  0x00000003) @ 0x3f6dbd71
ACPI: SLIC (v001 ACRSYS ACRPRDCT 0x06040000 ANNI 0x00000001) @ 0x3f6dbd97
ACPI: ASF! (v032 OEMID  OEMTBL   0x06040000 PTL  0x00000001) @ 0x3f6dbf0d
ACPI: MADT (v001 PTLTD  	 APIC   0x06040000  LTP 0x00000000) @ 0x3f6dbf70
ACPI: BOOT (v001 PTLTD  $SBFTBL$ 0x06040000  LTP 0x00000001) @ 0x3f6dbfd8
ACPI: SSDT (v001 SataRe  SataPri 0x00001000 INTL 0x20050624) @ 0x3f6d256b
ACPI: SSDT (v001 SataRe  SataSec 0x00001000 INTL 0x20050624) @ 0x3f6d1ed9
ACPI: SSDT (v001 BrtRef  DD01BRT 0x00001000 INTL 0x20050624) @ 0x3f6d1d0e
ACPI: SSDT (v001  PmRef  Cpu0Tst 0x00003000 INTL 0x20050624) @ 0x3f6d110b
ACPI: SSDT (v001  PmRef  Cpu1Tst 0x00003000 INTL 0x20050624) @ 0x3f6d1065
ACPI: SSDT (v001  PmRef    CpuPm 0x00003000 INTL 0x20050624) @ 0x3f6d0b4f
ACPI: DSDT (v002 INTEL  CRESTLNE 0x06040000 MSFT 0x03000000) @ 0x00000000
ACPI: PM-Timer IO Port: 0x1008
ACPI: Local APIC address 0xfee00000
ACPI: LAPIC (acpi_id[0x00] lapic_id[0x00] enabled)
Processor #0 6:15 APIC version 20
ACPI: LAPIC (acpi_id[0x01] lapic_id[0x01] enabled)
Processor #1 6:15 APIC version 20
ACPI: LAPIC_NMI (acpi_id[0x00] high edge lint[0x1])
ACPI: LAPIC_NMI (acpi_id[0x01] high edge lint[0x1])
Overriding APIC driver with bigsmp
ACPI: IOAPIC (id[0x02] address[0xfec00000] gsi_base[0])
IOAPIC[0]: apic_id 2, version 32, address 0xfec00000, GSI 0-23
ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 high edge)
ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 high level)
ACPI: IRQ0 used by override.
ACPI: IRQ2 used by override.
ACPI: IRQ9 used by override.
Enabling APIC mode:  Physflat.  Using 1 I/O APICs
ACPI: HPET id: 0x8086a201 base: 0xfed00000
Using ACPI (MADT) for SMP configuration information
Allocating PCI resources starting at 50000000 (gap: 40000000:a0000000)
Built 1 zonelists
Kernel command line: root=/dev/disk/by-id/scsi-SATA_Hitachi_HTS5416_SB344GGRK5M2MV-part6 vga=0x314 resume=/dev/sda3 splash=silent
bootsplash: silent mode.
Enabling fast FPU save and restore... done.
Enabling unmasked SIMD FPU exception support... done.
Initializing CPU#0
PID hash table entries: 4096 (order: 12, 65536 bytes)
Console: colour dummy device 80x25
Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)
Inode-cache hash table entries: 65536 (order: 6, 262144 bytes)
Memory: 1022704k/1039168k available (1644k kernel code, 15608k reserved, 746k data, 196k init, 121668k highmem)
Checking if this processor honours the WP bit even in supervisor mode... Ok.
hpet0: at MMIO 0xfed00000 (virtual 0xf8800000), IRQs 2, 8, 0
hpet0: 3 64-bit timers, 14318180 Hz
Using HPET for base-timer
Using TSC for gettimeofday
Detected 1795.530 MHz processor.
Using tsc for high-res timesource
Calibrating delay using timer specific routine.. 3595.44 BogoMIPS (lpj=7190898)
Security Framework v1.0.0 initialized
Mount-cache hash table entries: 512
CPU: After generic identify, caps: bfebfbff 20100000 00000000 00000000 0000e39d 00000000 00000001
CPU: After vendor identify, caps: bfebfbff 20100000 00000000 00000000 0000e39d 00000000 00000001
monitor/mwait feature present.
using mwait in idle threads.
CPU: L1 I cache: 32K, L1 D cache: 32K
CPU: L2 cache: 2048K
CPU: Physical Processor ID: 0
CPU: Processor Core ID: 0
CPU: After all inits, caps: bfebfbff 20100000 00000000 00000140 0000e39d 00000000 00000001
Intel machine check architecture supported.
Intel machine check reporting enabled on CPU#0.
Checking 'hlt' instruction... OK.
checking if image is initramfs... it is
Freeing initrd memory: 2597k freed
 not found!
CPU0: Intel(R) Core(TM)2 Duo CPU     T5670  @ 1.80GHz stepping 0d
Leaving ESR disabled.
Enabling SMP...
Booting processor 1/1 eip 3000
Initializing CPU#1
Leaving ESR disabled.
Calibrating delay using timer specific routine.. 3591.09 BogoMIPS (lpj=7182195)
CPU: After generic identify, caps: bfebfbff 20100000 00000000 00000000 0000e39d 00000000 00000001
CPU: After vendor identify, caps: bfebfbff 20100000 00000000 00000000 0000e39d 00000000 00000001
monitor/mwait feature present.
CPU: L1 I cache: 32K, L1 D cache: 32K
CPU: L2 cache: 2048K
CPU: Physical Processor ID: 0
CPU: Processor Core ID: 1
CPU: After all inits, caps: bfebfbff 20100000 00000000 00000140 0000e39d 00000000 00000001
Intel machine check architecture supported.
Intel machine check reporting enabled on CPU#1.
CPU1: Intel(R) Core(TM)2 Duo CPU     T5670  @ 1.80GHz stepping 0d
Total of 2 processors activated (7186.54 BogoMIPS).
ENABLING IO-APIC IRQs
..TIMER: vector=0x31 apic1=0 pin1=2 apic2=-1 pin2=-1
checking TSC synchronization across 2 CPUs: passed.
Enabling SMP...
Brought up 2 CPUs
migration_cost=21
NET: Registered protocol family 16
ACPI: bus type pci registered
PCI: PCI BIOS revision 3.00 entry at 0xfdba1, last bus=16
PCI: Using MMCONFIG
ACPI: Subsystem revision 20060127
ACPI: Interpreter enabled
ACPI: Using IOAPIC for interrupt routing
ACPI: PCI Root Bridge [PCI0] (0000:00)
PCI: Probing PCI hardware (bus 00)
ACPI: Assume root bridge [\_SB_.PCI0] bus is 0
Boot video device is 0000:00:02.0
PCI: Ignoring BAR0-3 of IDE controller 0000:00:1f.1
PCI: Transparent bridge - 0000:00:1e.0
PCI: Bus #10 (-#13) is hidden behind transparent bridge #0f (-#10) (try 'pci=assign-busses')
Please report the result to linux-kernel to fix this permanently
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.RP01._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.RP02._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.RP03._PRT]
ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.PCIB._PRT]
ACPI: PCI Interrupt Link [LNKA] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKB] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKC] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKD] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKE] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKF] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKG] (IRQs 10 *11)
ACPI: PCI Interrupt Link [LNKH] (IRQs 10 *11)
ACPI: Embedded Controller [EC0] (gpe 23) interrupt mode.
Linux Plug and Play Support v0.97 (c) Adam Belay
pnp: PnP ACPI init
pnp: PnP ACPI: found 11 devices
PCI: Using ACPI for IRQ routing
PCI: If a device doesn't work, try "pci=routeirq".  If it helps, post a report
Setting up standard PCI resources
PCI: Ignore bogus resource 6 [0:0] of 0000:00:02.0
PCI: Bridge: 0000:00:1c.0
  IO window: 2000-2fff
  MEM window: f6000000-f7ffffff
  PREFETCH window: f0000000-f1ffffff
PCI: Bridge: 0000:00:1c.1
  IO window: 3000-3fff
  MEM window: f8000000-f9ffffff
  PREFETCH window: f2000000-f3ffffff
PCI: Bridge: 0000:00:1c.2
  IO window: 4000-4fff
  MEM window: fa000000-fbffffff
  PREFETCH window: f4000000-f5ffffff
PCI: Bus 16, cardbus bridge: 0000:0f:06.0
  IO window: 00005000-000050ff
  IO window: 00005400-000054ff
  PREFETCH window: 50000000-51ffffff
  MEM window: 54000000-55ffffff
PCI: Bridge: 0000:00:1e.0
  IO window: 5000-5fff
  MEM window: fc200000-fc2fffff
  PREFETCH window: 50000000-51ffffff
ACPI: PCI Interrupt 0000:00:1c.0[A] -> GSI 16 (level, low) -> IRQ 169
PCI: Setting latency timer of device 0000:00:1c.0 to 64
ACPI: PCI Interrupt 0000:00:1c.1[B] -> GSI 17 (level, low) -> IRQ 177
PCI: Setting latency timer of device 0000:00:1c.1 to 64
ACPI: PCI Interrupt 0000:00:1c.2[C] -> GSI 18 (level, low) -> IRQ 185
PCI: Setting latency timer of device 0000:00:1c.2 to 64
PCI: Setting latency timer of device 0000:00:1e.0 to 64
ACPI: PCI Interrupt 0000:0f:06.0[A] -> GSI 22 (level, low) -> IRQ 193
Simple Boot Flag at 0x36 set to 0x1
apm: BIOS not found.
audit: initializing netlink socket (disabled)
audit(1213866859.396:1): initialized
highmem bounce pool size: 64 pages
Total HugeTLB memory allocated, 0
VFS: Disk quotas dquot_6.5.1
Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
Initializing Cryptographic API
io scheduler noop registered
io scheduler anticipatory registered
io scheduler deadline registered
io scheduler cfq registered (default)
ACPI: PCI Interrupt 0000:00:1c.0[A] -> GSI 16 (level, low) -> IRQ 169
PCI: Setting latency timer of device 0000:00:1c.0 to 64
assign_interrupt_mode Found MSI capability
Allocate Port Service[0000:00:1c.0:pcie00]
Allocate Port Service[0000:00:1c.0:pcie02]
Allocate Port Service[0000:00:1c.0:pcie03]
ACPI: PCI Interrupt 0000:00:1c.1[B] -> GSI 17 (level, low) -> IRQ 177
PCI: Setting latency timer of device 0000:00:1c.1 to 64
assign_interrupt_mode Found MSI capability
Allocate Port Service[0000:00:1c.1:pcie00]
Allocate Port Service[0000:00:1c.1:pcie02]
Allocate Port Service[0000:00:1c.1:pcie03]
ACPI: PCI Interrupt 0000:00:1c.2[C] -> GSI 18 (level, low) -> IRQ 185
PCI: Setting latency timer of device 0000:00:1c.2 to 64
assign_interrupt_mode Found MSI capability
Allocate Port Service[0000:00:1c.2:pcie00]
Allocate Port Service[0000:00:1c.2:pcie02]
Allocate Port Service[0000:00:1c.2:pcie03]
vesafb: framebuffer at 0xd0000000, mapped to 0xf8880000, using 3750k, total 7616k
vesafb: mode is 800x600x16, linelength=1600, pages=6
vesafb: protected mode interface info at 00ff:44f0
vesafb: scrolling: redraw
vesafb: Truecolor: size=0:5:6:5, shift=0:11:5:0
bootsplash 3.1.6-2004/03/31: looking for picture...
bootsplash: silentjpeg size 73608 bytes
bootsplash: ...found (800x600, 42772 bytes, v3).
Console: switching to colour frame buffer device 95x33
fb0: VESA VGA frame buffer device
isapnp: Scanning for PnP cards...
isapnp: No Plug & Play device found
Real Time Clock Driver v1.12ac
PNP: PS/2 Controller [PNP0303:KBD0,PNP0f13:PS2M] at 0x60,0x64 irq 1,12
i8042.c: Detected active multiplexing controller, rev 1.1.
serio: i8042 AUX0 port at 0x60,0x64 irq 12
serio: i8042 AUX1 port at 0x60,0x64 irq 12
serio: i8042 AUX2 port at 0x60,0x64 irq 12
serio: i8042 AUX3 port at 0x60,0x64 irq 12
serio: i8042 KBD port at 0x60,0x64 irq 1
Serial: 8250/16550 driver $Revision: 1.90 $ 4 ports, IRQ sharing enabled
floppy0: no floppy controllers found
RAMDISK driver initialized: 16 RAM disks of 64000K size 1024 blocksize
mice: PS/2 mouse device common for all mice
input: AT Translated Set 2 keyboard as /class/input/input0
input: PC Speaker as /class/input/input1
md: md driver 0.90.3 MAX_MD_DEVS=256, MD_SB_DISKS=27
md: bitmap version 4.39
NET: Registered protocol family 2
IP route cache hash table entries: 32768 (order: 5, 131072 bytes)
TCP established hash table entries: 131072 (order: 8, 1048576 bytes)
TCP bind hash table entries: 65536 (order: 7, 524288 bytes)
TCP: Hash tables configured (established 131072 bind 65536)
TCP reno registered
NET: Registered protocol family 1
Using IPI No-Shortcut mode
ACPI wakeup devices: 
LID0 SLPB HDEF PXSX USB1 USB2 USB3 EHC1 
ACPI: (supports S0 S3 S4 S5)
Freeing unused kernel memory: 196k freed
Uniform Multi-Platform E-IDE driver Revision: 7.00alpha2
ide: Assuming 33MHz system bus speed for PIO modes; override with idebus=xx
SCSI subsystem initialized
ICH8M: IDE controller at PCI slot 0000:00:1f.1
ACPI: PCI Interrupt 0000:00:1f.1[A] -> GSI 19 (level, low) -> IRQ 233
ICH8M: chipset revision 3
ICH8M: not 100% native mode: will probe irqs later
    ide0: BM-DMA at 0x1810-0x1817, BIOS settings: hda:DMA, hdb:pio
    ide1: BM-DMA at 0x1818-0x181f, BIOS settings: hdc:pio, hdd:pio
Probing IDE interface ide0...
hda: HL-DT-ST DVDRAM GSA-T40N, ATAPI CD/DVD-ROM drive
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
Probing IDE interface ide1...
Synaptics Touchpad, model: 1, fw: 6.3, id: 0x12a0b1, caps: 0xa04711/0xa04000
input: SynPS/2 Synaptics TouchPad as /class/input/input2
libata version 2.00 loaded.
ata_piix 0000:00:1f.2: version 2.00ac7
ata_piix 0000:00:1f.2: MAP [ P0 P2 P1 P3 ]
ACPI: PCI Interrupt 0000:00:1f.2[B] -> GSI 19 (level, low) -> IRQ 233
PCI: Setting latency timer of device 0000:00:1f.2 to 64
ata1: SATA max UDMA/133 cmd 0x1C00 ctl 0x18F6 bmdma 0x18E0 irq 233
ata2: SATA max UDMA/133 cmd 0x18F8 ctl 0x18F2 bmdma 0x18E8 irq 233
scsi0 : ata_piix
ata1.00: ATA-7, max UDMA/100, 312581808 sectors: LBA48 NCQ (depth 0/32)
ata1.00: ata1: dev 0 multi count 16
ata1.00: configured for UDMA/100
scsi1 : ata_piix
ATA: abnormal status 0x7F on port 0x18FF
  Vendor: ATA       Model: Hitachi HTS54161  Rev: SB4O
  Type:   Direct-Access                      ANSI SCSI revision: 05
SCSI device sda: 312581808 512-byte hdwr sectors (160042 MB)
sda: Write Protect is off
sda: Mode Sense: 00 3a 00 00
SCSI device sda: drive cache: write back
SCSI device sda: 312581808 512-byte hdwr sectors (160042 MB)
sda: Write Protect is off
sda: Mode Sense: 00 3a 00 00
SCSI device sda: drive cache: write back
 sda: sda1 sda3 sda4 < sda5 sda6 sda7 >
sd 0:0:0:0: Attached scsi disk sda
ACPI: CPU0 (power states: C1[C1] C2[C2] C3[C3])
ACPI: CPU1 (power states: C1[C1] C2[C2] C3[C3])
sd 0:0:0:0: Attached scsi generic sg0 type 0
ACPI: Thermal Zone [TZS0] (47 C)
ACPI: Thermal Zone [TZS1] (46 C)
BIOS EDD facility v0.16 2004-Jun-25, 1 devices found
Attempting manual resume
ReiserFS: sda6: found reiserfs format "3.6" with standard journal
ReiserFS: sda6: using ordered data mode
reiserfs: using flush barriers
ReiserFS: sda6: journal params: device sda6, size 8192, journal first block 18, max trans len 1024, max batch 900, max commit age 30, max trans age 30
ReiserFS: sda6: checking transaction log (sda6)
ReiserFS: sda6: Using r5 hash to sort names
Adding 2104504k swap on /dev/disk/by-id/scsi-SATA_Hitachi_HTS5416_SB344GGRK5M2MV-part3.  Priority:-1 extents:1 across:2104504k
ACPI: PCI Interrupt 0000:0f:06.0[A] -> GSI 22 (level, low) -> IRQ 193
Yenta: CardBus bridge found at 0000:0f:06.0 [1025:011f]
Yenta: Using CSCINT to route CSC interrupts to PCI
Yenta: Routing CardBus interrupts to PCI
Yenta TI: socket 0000:0f:06.0, mfunc 0x01aa1b22, devctl 0x64
usbcore: registered new driver usbfs
usbcore: registered new driver hub
hda: ATAPI 24X DVD-ROM DVD-R-RAM CD-R/RW drive, 2048kB Cache, UDMA(33)
Uniform CD-ROM driver Revision: 3.20
USB Universal Host Controller Interface driver v2.3
ieee1394: Initialized config rom entry `ip1394'
Yenta: ISA IRQ mask 0x0cf8, PCI irq 193
Socket status: 30000006
pcmcia: parent PCI bridge I/O window: 0x5000 - 0x5fff
cs: IO port probe 0x5000-0x5fff: clean.
pcmcia: parent PCI bridge Memory window: 0xfc200000 - 0xfc2fffff
pcmcia: parent PCI bridge Memory window: 0x50000000 - 0x51ffffff
ACPI: PCI Interrupt 0000:00:1a.0[A] -> GSI 20 (level, low) -> IRQ 50
PCI: Setting latency timer of device 0000:00:1a.0 to 64
uhci_hcd 0000:00:1a.0: UHCI Host Controller
uhci_hcd 0000:00:1a.0: new USB bus registered, assigned bus number 1
uhci_hcd 0000:00:1a.0: irq 50, io base 0x00001820
usb usb1: new device found, idVendor=0000, idProduct=0000
usb usb1: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb1: Product: UHCI Host Controller
usb usb1: Manufacturer: Linux 2.6.16.54-0.2.5-smp uhci_hcd
usb usb1: SerialNumber: 0000:00:1a.0
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
Linux agpgart interface v0.101 (c) Dave Jones
ieee80211_crypt: module not supported by Novell, setting U taint flag.
ieee80211_crypt: registered algorithm 'NULL'
ieee80211: module not supported by Novell, setting U taint flag.
ieee80211: 802.11 data/management/control stack, git-1.1.7
ieee80211: Copyright (C) 2004-2005 Intel Corporation <jketreno at linux.intel.com>
ACPI: PCI Interrupt 0000:00:1a.1[B] -> GSI 21 (level, low) -> IRQ 58
PCI: Setting latency timer of device 0000:00:1a.1 to 64
uhci_hcd 0000:00:1a.1: UHCI Host Controller
uhci_hcd 0000:00:1a.1: new USB bus registered, assigned bus number 2
uhci_hcd 0000:00:1a.1: irq 58, io base 0x00001840
usb usb2: new device found, idVendor=0000, idProduct=0000
usb usb2: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb2: Product: UHCI Host Controller
usb usb2: Manufacturer: Linux 2.6.16.54-0.2.5-smp uhci_hcd
usb usb2: SerialNumber: 0000:00:1a.1
usb usb2: configuration #1 chosen from 1 choice
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
ACPI: PCI Interrupt 0000:00:1d.0[A] -> GSI 23 (level, low) -> IRQ 66
PCI: Setting latency timer of device 0000:00:1d.0 to 64
uhci_hcd 0000:00:1d.0: UHCI Host Controller
uhci_hcd 0000:00:1d.0: new USB bus registered, assigned bus number 3
uhci_hcd 0000:00:1d.0: irq 66, io base 0x00001860
usb usb3: new device found, idVendor=0000, idProduct=0000
usb usb3: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb3: Product: UHCI Host Controller
usb usb3: Manufacturer: Linux 2.6.16.54-0.2.5-smp uhci_hcd
usb usb3: SerialNumber: 0000:00:1d.0
usb usb3: configuration #1 chosen from 1 choice
hub 3-0:1.0: USB hub found
hub 3-0:1.0: 2 ports detected
intel_agp: Loading module compiled for kernel version                     into kernel version                    
drm: Loading module compiled for kernel version                     into kernel version                    
[drm] Initialized drm 1.0.1 20051102
ACPI: PCI Interrupt 0000:00:1d.1[B] -> GSI 17 (level, low) -> IRQ 177
PCI: Setting latency timer of device 0000:00:1d.1 to 64
uhci_hcd 0000:00:1d.1: UHCI Host Controller
uhci_hcd 0000:00:1d.1: new USB bus registered, assigned bus number 4
uhci_hcd 0000:00:1d.1: irq 177, io base 0x00001880
usb usb4: new device found, idVendor=0000, idProduct=0000
usb usb4: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb4: Product: UHCI Host Controller
usb usb4: Manufacturer: Linux 2.6.16.54-0.2.5-smp uhci_hcd
usb usb4: SerialNumber: 0000:00:1d.1
usb usb4: configuration #1 chosen from 1 choice
hub 4-0:1.0: USB hub found
hub 4-0:1.0: 2 ports detected
ipw3945: module not supported by Novell, setting U taint flag.
ipw3945: Loading module compiled for kernel version                    into kernel version                    
ipw3945: Intel(R) PRO/Wireless 3945 Network Connection driver for Linux, 1.1.0dmr
ipw3945: Copyright(c) 2003-2006 Intel Corporation
ACPI: PCI Interrupt 0000:00:1d.2[C] -> GSI 18 (level, low) -> IRQ 185
PCI: Setting latency timer of device 0000:00:1d.2 to 64
uhci_hcd 0000:00:1d.2: UHCI Host Controller
uhci_hcd 0000:00:1d.2: new USB bus registered, assigned bus number 5
uhci_hcd 0000:00:1d.2: irq 185, io base 0x000018a0
usb usb5: new device found, idVendor=0000, idProduct=0000
usb usb5: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb5: Product: UHCI Host Controller
usb usb5: Manufacturer: Linux 2.6.16.54-0.2.5-smp uhci_hcd
usb usb5: SerialNumber: 0000:00:1d.2
usb usb5: configuration #1 chosen from 1 choice
hub 5-0:1.0: USB hub found
hub 5-0:1.0: 2 ports detected
ACPI: PCI Interrupt 0000:00:1b.0[A] -> GSI 21 (level, low) -> IRQ 58
PCI: Setting latency timer of device 0000:00:1b.0 to 64
ACPI: PCI Interrupt 0000:00:1a.7[C] -> GSI 20 (level, low) -> IRQ 50
PCI: Setting latency timer of device 0000:00:1a.7 to 64
ehci_hcd 0000:00:1a.7: EHCI Host Controller
ehci_hcd 0000:00:1a.7: debug port 1
PCI: cache line size of 32 is not supported by device 0000:00:1a.7
ehci_hcd 0000:00:1a.7: new USB bus registered, assigned bus number 6
ehci_hcd 0000:00:1a.7: irq 50, io mem 0xfc504000
ehci_hcd 0000:00:1a.7: USB 2.0 started, EHCI 1.00, driver 10 Dec 2004
usb usb6: new device found, idVendor=0000, idProduct=0000
usb usb6: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb6: Product: EHCI Host Controller
usb usb6: Manufacturer: Linux 2.6.16.54-0.2.5-smp ehci_hcd
usb usb6: SerialNumber: 0000:00:1a.7
usb usb6: configuration #1 chosen from 1 choice
hub 6-0:1.0: USB hub found
hub 6-0:1.0: 4 ports detected
ACPI: PCI Interrupt 0000:00:1d.7[A] -> GSI 23 (level, low) -> IRQ 66
PCI: Setting latency timer of device 0000:00:1d.7 to 64
ehci_hcd 0000:00:1d.7: EHCI Host Controller
ehci_hcd 0000:00:1d.7: debug port 1
PCI: cache line size of 32 is not supported by device 0000:00:1d.7
ehci_hcd 0000:00:1d.7: new USB bus registered, assigned bus number 7
ehci_hcd 0000:00:1d.7: irq 66, io mem 0xfc504400
ehci_hcd 0000:00:1d.7: USB 2.0 started, EHCI 1.00, driver 10 Dec 2004
usb usb7: new device found, idVendor=0000, idProduct=0000
usb usb7: new device strings: Mfr=3, Product=2, SerialNumber=1
usb usb7: Product: EHCI Host Controller
usb usb7: Manufacturer: Linux 2.6.16.54-0.2.5-smp ehci_hcd
usb usb7: SerialNumber: 0000:00:1d.7
usb usb7: configuration #1 chosen from 1 choice
hub 7-0:1.0: USB hub found
hub 7-0:1.0: 6 ports detected
ACPI: PCI Interrupt 0000:0f:06.1[A] -> GSI 22 (level, low) -> IRQ 193
agpgart: Detected an Intel 965GM Chipset.
agpgart: Detected 7676K stolen memory.
agpgart: AGP aperture is 256M @ 0xd0000000
ohci1394: fw-host0: OHCI-1394 1.1 (PCI): IRQ=[193]  MMIO=[fc206000-fc2067ff]  Max Packet=[2048]  IR/IT contexts=[4/8]
tg3.c:v3.71b (December 15, 2006)
ACPI: PCI Interrupt 0000:02:00.0[A] -> GSI 16 (level, low) -> IRQ 169
PCI: Setting latency timer of device 0000:02:00.0 to 64
i915: Loading module compiled for kernel version                     into kernel version                    
PCI: Unable to reserve mem region #3:10000000 at d0000000 for device 0000:00:02.0
ACPI: PCI Interrupt 0000:00:02.0[A] -> GSI 16 (level, low) -> IRQ 169
PCI: Setting latency timer of device 0000:00:02.0 to 64
[drm] Initialized i915 1.4.0 20060119 on minor 0: 
[drm] Used old pci detect: framebuffer loaded
eth0: Tigon3 [partno(BCM95787m) rev b002 PHY(5787)] (PCI Express) 10/100/1000Base-T Ethernet 00:1d:72:33:1f:2b
eth0: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[0] Split[0] WireSpeed[1] TSOcap[1] 
eth0: dma_rwctrl[76180000] dma_mask[64-bit]
usb 6-1: new high speed USB device using ehci_hcd and address 2
ACPI: PCI Interrupt 0000:04:00.0[A] -> GSI 17 (level, low) -> IRQ 177
PCI: Setting latency timer of device 0000:04:00.0 to 64
ipw3945: Detected Intel PRO/Wireless 3945ABG Network Connection
hw_random hardware driver 1.0.0 loaded
cs: IO port probe 0x100-0x3af: excluding 0x170-0x177 0x370-0x377
cs: IO port probe 0x3e0-0x4ff: excluding 0x4d0-0x4d7
cs: IO port probe 0x820-0x8ff: clean.
cs: IO port probe 0xc00-0xcf7: clean.
cs: IO port probe 0xa00-0xaff: clean.
usb 6-1: new device found, idVendor=5986, idProduct=0105
usb 6-1: new device strings: Mfr=2, Product=1, SerialNumber=0
usb 6-1: Product: Acer Crystal Eye webcam
usb 6-1: Manufacturer: USB Audio Device
usb 6-1: configuration #1 chosen from 1 choice
device-mapper: 4.7.0-ioctl (2006-06-24) initialised: dm-devel at redhat.com
dm-netlink version 0.0.2 loaded
Linux video capture interface: v1.00
uvcvideo: module not supported by Novell, setting U taint flag.
uvcvideo: Found UVC 1.00 device Acer Crystal Eye webcam (5986:0105)
usbcore: registered new driver uvcvideo
USB Video Class driver (v0.1.0)
ipw3945: Detected geography ABG (11 802.11bg channels, 13 802.11a channels)
md: Autodetecting RAID arrays.
md: autorun ...
md: ... autorun DONE.
ieee1394: Host added: ID:BUS[0-00:1023]  GUID[001d72ffff331f2b]
loop: loaded (max 8 devices)
ReiserFS: sda7: found reiserfs format "3.6" with standard journal
ReiserFS: sda7: using ordered data mode
reiserfs: using flush barriers
ReiserFS: sda7: journal params: device sda7, size 8192, journal first block 18, max trans len 1024, max batch 900, max commit age 30, max trans age 30
ReiserFS: sda7: checking transaction log (sda7)
ReiserFS: sda7: Using r5 hash to sort names
AppArmor: AppArmor (version 2.0-19.43r6320) initialized
audit(1213866881.645:2): AppArmor (version 2.0-19.43r6320) initialized

ACPI: AC Adapter [ADP1] (on-line)
ACPI: Battery Slot [BAT0] (battery present)
ACPI: Power Button (FF) [PWRF]
ACPI: Lid Switch [LID0]
ACPI: Sleep Button (CM) [SLPB]
audit(1213866890.232:3): audit_backlog_limit=256 old=64 by auid=4294967295
audit(1213866890.280:4): audit_pid=2881 old=0 by auid=4294967295
IA-32 Microcode Update Driver: v1.14 <tigran at veritas.com>
IA-32 Microcode Update Driver v1.14 unregistered
tg3: eth0: Link is up at 100 Mbps, full duplex.
tg3: eth0: Flow control is on for TX and on for RX.
NET: Registered protocol family 17
uvcvideo: Failed to query (130) UVC control 1 (unit 0) : 2 (exp. 26).
ISO 9660 Extensions: Microsoft Joliet Level 3
ISO 9660 Extensions: RRIP_1991A
-------------- next part --------------

Bus 007 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         1 Single TT
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp ehci_hcd
  iProduct                2 EHCI Host Controller
  iSerial                 1 0000:00:1d.7
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval              12
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             6
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
    TT think time 8 FS bits
  bPwrOn2PwrGood       10 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
   Port 3: 0000.0100 power
   Port 4: 0000.0100 power
   Port 5: 0000.0100 power
   Port 6: 0000.0100 power
Device Status:     0x0001
  Self Powered

Bus 006 Device 002: ID 5986:0105  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x5986 
  idProduct          0x0105 
  bcdDevice            0.07
  iManufacturer           2 USB Audio Device
  iProduct                1 Acer Crystal Eye webcam
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          436
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               1 Acer Crystal Eye webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              1 Acer Crystal Eye webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           84
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               6
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               1
        baSource( 0)            1
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000043f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Power Line Frequency
        iProcessing             0 
        bmVideoStandards     0x1b
          None
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 6
        guidExtensionCode         {a7974c56-a77e-4b90-8cbf-1c71ec303000}
        bNumControl            16
        bNrPins                 1
        baSourceID( 0)          5
        bControlSize            2
        bmControls( 0)       0xff
        bmControls( 1)       0xff
        iExtension              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              15
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormarts                        1
        wTotalLength                    33025
        bEndPointAddress                    0
        bmInfo                              3
        bTerminalLink                       2
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat                            {32595559-0000-0010-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   912384
        dwMaxBitRate                   912384
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   912384
        dwMaxBitRate                   912384
        dwMaxVideoFrameBufferSize      230400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x01
          Still image supported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   912384
        dwMaxBitRate                   912384
        dwMaxVideoFrameBufferSize       57600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x01
          Still image supported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   912384
        dwMaxBitRate                   912384
        dwMaxVideoFrameBufferSize      304128
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x01
          Still image supported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   912384
        dwMaxBitRate                   912384
        dwMaxVideoFrameBufferSize       76032
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            26
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               5
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        320
        wHeight( 1)                       240
        wWidth( 2)                        160
        wHeight( 2)                       120
        wWidth( 3)                        352
        wHeight( 3)                       288
        wWidth( 4)                        176
        wHeight( 4)                       144
        bNumCompressionPatterns             5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13c0  3x 960 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13c0  3x 960 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

Bus 006 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         1 Single TT
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp ehci_hcd
  iProduct                2 EHCI Host Controller
  iSerial                 1 0000:00:1a.7
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval              12
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             4
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
    TT think time 8 FS bits
  bPwrOn2PwrGood       10 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0503 highspeed power enable connect
   Port 2: 0000.0100 power
   Port 3: 0000.0100 power
   Port 4: 0000.0100 power
Device Status:     0x0001
  Self Powered

Bus 002 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp uhci_hcd
  iProduct                2 UHCI Host Controller
  iSerial                 1 0000:00:1a.1
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
  bPwrOn2PwrGood        1 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
Device Status:     0x0001
  Self Powered

Bus 004 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp uhci_hcd
  iProduct                2 UHCI Host Controller
  iSerial                 1 0000:00:1d.1
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
  bPwrOn2PwrGood        1 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
Device Status:     0x0001
  Self Powered

Bus 001 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp uhci_hcd
  iProduct                2 UHCI Host Controller
  iSerial                 1 0000:00:1a.0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
  bPwrOn2PwrGood        1 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
Device Status:     0x0001
  Self Powered

Bus 005 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp uhci_hcd
  iProduct                2 UHCI Host Controller
  iSerial                 1 0000:00:1d.2
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
  bPwrOn2PwrGood        1 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
Device Status:     0x0001
  Self Powered

Bus 003 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.16.54-0.2.5-smp uhci_hcd
  iProduct                2 UHCI Host Controller
  iSerial                 1 0000:00:1d.0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x000a
    No power switching (usb 1.0)
    Per-port overcurrent protection
  bPwrOn2PwrGood        1 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
Device Status:     0x0001
  Self Powered
-------------- next part --------------
Bus 007 Device 001: ID 0000:0000  
Bus 006 Device 002: ID 5986:0105  
Bus 006 Device 001: ID 0000:0000  
Bus 002 Device 001: ID 0000:0000  
Bus 004 Device 001: ID 0000:0000  
Bus 001 Device 001: ID 0000:0000  
Bus 005 Device 001: ID 0000:0000  
Bus 003 Device 001: ID 0000:0000  

From arjos85 at gmail.com  Tue Jun 17 21:14:37 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Tue, 17 Jun 2008 21:14:37 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
Message-ID: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>

Here I'm again to correct some mistakes and to add some missing data:
- first of all I have a Sonix webcam with device id 174f:5a35 (at the end of
this message I've attached the complete verbose lsusb output);
- with my webcam,  "pixel_size" (# of bytes per pixel) has to be set equal
to "2" (pixel_size=2 ), because bpp=16 (2 byte);
- I've also added a kfree() in order to free the preallocated space;
- in order to speed up the allocation process I've used GFP_ATOMIC flag in
kmalloc() function.

Please let me know if you think something is wrong.
Because just right now my cam is working fine, now images are not
upside-down, but colour are not so perfect.
Also if the colour of my skin seems to be the right one, red and blu colour
are exchanged each other.

Do you think the "=" is appropriate in "if (len >= maxlen)" statement?

Here you can find the patch:

---------------START PATCH--------------

--- /home/arjos/trunk/uvc_video.c       2008-06-17 19:31:06.000000000 +0200
+++ uvc_video_tmp.c     2008-06-17 20:55:58.000000000 +0200
@@ -377,6 +377,9 @@
        struct uvc_video_queue *queue = &video->queue;
        unsigned int maxlen, nbytes;
        void *mem;
+       __u8 *mem_tmp;
+       int i, k, pixel_size;
+       unsigned int size_tmp;

        if (len <= 0)
                return;
@@ -389,7 +392,16 @@
        buf->buf.bytesused += nbytes;

        /* Complete the current frame if the buffer size was exceeded. */
-       if (len > maxlen) {
+       if (len >= maxlen) {
+               size_tmp = buf->buf.bytesused;
+               mem_tmp = (__u8 *) kmalloc(size_tmp , GFP_ATOMIC);
+               if (mem_tmp != NULL ){
+                       memcpy(mem_tmp, queue->mem + buf->buf.m.offset,
size_tmp);
+                       pixel_size = 2;
+                       for ( i=0, k=size_tmp - pixel_size ; i < size_tmp;
i+=pixel_size, k-=pixel_size)
+                               memcpy( (__u8 *)queue->mem +
buf->buf.m.offset + i, mem_tmp + k, pixel_size );
+                       kfree(mem_tmp);
+               }
                uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
                buf->state = UVC_BUF_STATE_DONE;
        }


---------------END PATCH--------------

Has attachement you can also find the complete uvc_video.c file.
In order to test the changes I use the following script:

----- START SCRIPT -------------

make
sudo modprobe -r uvcvideo
sudo make install
sudo cp uvcvideo.ko /lib/modules/`uname -r`/ubuntu/media/usbvideo
sudo modprobe uvcvideo
make clean

----- END SCRIPT -----------------

Let me know if you don't understand something or if there's something wrong
in what i've written.

Thank you

Marco Argiolas

------------- lsusb output ------------------------------------
Bus 006 Device 002: ID 174f:5a35
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x174f
  idProduct          0x5a35
  bcdDevice            4.11
  iManufacturer           2 Sonix Technology Co., Ltd.
  iProduct                1 USB 2.0 Camera
  iSerial                 3 SN0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          627
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               1 USB 2.0 Camera
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              1 USB 2.0 Camera
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           77
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             1
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x01
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000053f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      407
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   614400
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   202752
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   153600
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                    50688
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                    38400
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                  2457600
        dwMaxBitRate                 22118400
        dwMaxVideoFrameBufferSize     2457600
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
        dwFrameInterval( 2)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                  2621440
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
        dwFrameInterval( 2)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               7
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                       1280
        wHeight( 1)                       960
        wWidth( 2)                        640
        wHeight( 2)                       480
        wWidth( 3)                        352
        wHeight( 3)                       288
        wWidth( 4)                        320
        wHeight( 4)                       240
        wWidth( 5)                        176
        wHeight( 5)                       144
        wWidth( 6)                        160
        wHeight( 6)                       120
        bNumCompressionPatterns             7
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13e8  3x 1000 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080617/ec969719/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc_video.c
Type: text/x-csrc
Size: 29548 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080617/ec969719/attachment.c>

From arjos85 at gmail.com  Thu Jun 19 15:10:08 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Thu, 19 Jun 2008 15:10:08 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
Message-ID: <879e1f2b0806190610qb10759fm5efc3b3ebe66b464@mail.gmail.com>

Just to show you what I'm getting from my webcam, I've attached 3 png
pictures:
- original_uvcvideo.jpg (size 50%, quality 15%)
- modded_uvcvideo_1pixel.jpg (size 50%, quality 15%)
- modded_uvcvideo_2pixel.jpg (size 100%, quality 50%)
the first is made with the original uvcvideo driver, the other two with my
modded version.

You are going to see my red tshirt.
These are 3 snapshot of my desktop while running mplayer with this command:
$ mplayer tv:// -tv
driver=v4l2:device=/dev/video0:outfmt=yuy2:width=640:height=480:fps=50 -vo
x11

The differences between the two "modded" is the value of "pixel_size".
In modded_uvcvideo_1pixel.jpg, "pixel_size = 2" , it means each pixel needs
2 bytes (just as in my case, where bpp=16), the problem is that colours are
not so real.
In the second case, "pixel_size=4", it means pixel are moved in blocks of 2.
As you can see now colours are perfect, but there is the problem that
copying 2 pixel each time, the resulting image has pixel exchanged 2 by 2 :
just watch "modded_uvcvideo_2pixel.jpg" on the right under my armpit or the
edges of my tshirt.

The only way to solve this problem is to set "pixel_size=1280", in this way
i got a perfect image, but it is mirrored (and it is also a good news for
me).
The problem is that it just works with 640x480 (maximum accepted by
mplayer), also if lsusb tells that my webcam should also support 1280x960
and 1280x1024 resolutions. This trick obviously doesn't work with all
smaller resolutions supported by my webcam (352x288, 320x240, 176x144,
160x120), because in these cases there are some missing line in the image.
My webcam is nominally a 1.3 Mpx (1280x1024), but in realty it is just a
640x480 one.
And when I use
$ mplayer tv:// -tv
driver=v4l2:device=/dev/video0:outfmt=yuy2:width=MY_WIDTH:height=MY_HEIGHT:fps=50
-vo x11
mplayer just accept resolutions up to 640x480.

This is the output coming from mplayer with : MY_WIDTH=1280, MY_HEIGHT=960,
pixel_size=1280:

MPlayer 1.0rc2-4.2.3 (C) 2000-2007 MPlayer Team
CPU: Intel(R) Core(TM)2 Duo CPU     T7500  @ 2.20GHz (Family: 6, Model: 15,
Stepping: 11)
CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
Compiled with runtime CPU detection.
mplayer: could not connect to socket
mplayer: No such file or directory
Failed to open LIRC support. You will not be able to use your remote
control.

Playing tv://.
TV file format detected.
Selected driver: v4l2
 name: Video 4 Linux 2 input
 author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
 comment: first try, more to come ;-)
v4l2: ioctl get standard failed: Invalid argument
Selected device: USB 2.0 Camera
 Capabilites:  video capture  streaming
 supported norms:
 inputs: 0 = Camera 1;
 Current input: 0
 Current format: YUYV
tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
v4l2: ioctl enum norm failed: Invalid argument
Error: Cannot set norm!
Selected input hasn't got a tuner!
v4l2: ioctl set mute failed: Invalid argument
xscreensaver_disable: Could not find XScreenSaver window.
==========================================================================
Opening video decoder: [raw] RAW Uncompressed Video
VDec: vo config request - 320 x 240 (preferred colorspace: Packed YUY2)
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
VDec: using Packed YUY2 as output csp (no 0)
Movie-Aspect is undefined - no prescaling applied.
SwScaler: reducing / aligning filtersize 1 -> 4
SwScaler: reducing / aligning filtersize 1 -> 4
SwScaler: reducing / aligning filtersize 1 -> 1
SwScaler: reducing / aligning filtersize 1 -> 1
[swscaler @ 0x8934890]SwScaler: BICUBIC scaler, from yuyv422 to rgb32 using
MMX2
[swscaler @ 0x8934890]SwScaler: using 4-tap MMX scaler for horizontal
luminance scaling
[swscaler @ 0x8934890]SwScaler: using 4-tap MMX scaler for horizontal
chrominance scaling
[swscaler @ 0x8934890]SwScaler: using n-tap MMX scaler for vertical scaling
(BGR)
[swscaler @ 0x8934890]SwScaler: using MMX YV12->BGR32 Converter
[swscaler @ 0x8934890]SwScaler: 320x240 -> 320x240
VO: [x11] 320x240 => 320x240 BGRA
Selected video codec: [rawyuy2] vfm: raw (RAW YUY2)
==========================================================================

What do you think is the problem?

Please let me know everything,
I'm so curious!!

Thanks,

2008/6/17 Marco Argiolas <arjos85 at gmail.com>:

> Here I'm again to correct some mistakes and to add some missing data:
> - first of all I have a Sonix webcam with device id 174f:5a35 (at the end
> of this message I've attached the complete verbose lsusb output);
> - with my webcam,  "pixel_size" (# of bytes per pixel) has to be set equal
> to "2" (pixel_size=2 ), because bpp=16 (2 byte);
> - I've also added a kfree() in order to free the preallocated space;
> - in order to speed up the allocation process I've used GFP_ATOMIC flag in
> kmalloc() function.
>
> Please let me know if you think something is wrong.
> Because just right now my cam is working fine, now images are not
> upside-down, but colour are not so perfect.
> Also if the colour of my skin seems to be the right one, red and blu colour
> are exchanged each other.
>
> Do you think the "=" is appropriate in "if (len >= maxlen)" statement?
>
> Here you can find the patch:
>
> ---------------START PATCH--------------
>
> --- /home/arjos/trunk/uvc_video.c       2008-06-17 19:31:06.000000000 +0200
> +++ uvc_video_tmp.c     2008-06-17 20:55:58.000000000 +0200
> @@ -377,6 +377,9 @@
>         struct uvc_video_queue *queue = &video->queue;
>         unsigned int maxlen, nbytes;
>         void *mem;
> +       __u8 *mem_tmp;
> +       int i, k, pixel_size;
> +       unsigned int size_tmp;
>
>         if (len <= 0)
>                 return;
> @@ -389,7 +392,16 @@
>         buf->buf.bytesused += nbytes;
>
>         /* Complete the current frame if the buffer size was exceeded. */
> -       if (len > maxlen) {
> +       if (len >= maxlen) {
> +               size_tmp = buf->buf.bytesused;
> +               mem_tmp = (__u8 *) kmalloc(size_tmp , GFP_ATOMIC);
> +               if (mem_tmp != NULL ){
> +                       memcpy(mem_tmp, queue->mem + buf->buf.m.offset,
> size_tmp);
> +                       pixel_size = 2;
> +                       for ( i=0, k=size_tmp - pixel_size ; i < size_tmp;
> i+=pixel_size, k-=pixel_size)
> +                               memcpy( (__u8 *)queue->mem +
> buf->buf.m.offset + i, mem_tmp + k, pixel_size );
> +                       kfree(mem_tmp);
> +               }
>                 uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
>                 buf->state = UVC_BUF_STATE_DONE;
>         }
>
>
> ---------------END PATCH--------------
>
> Has attachement you can also find the complete uvc_video.c file.
> In order to test the changes I use the following script:
>
> ----- START SCRIPT -------------
>
> make
> sudo modprobe -r uvcvideo
> sudo make install
> sudo cp uvcvideo.ko /lib/modules/`uname -r`/ubuntu/media/usbvideo
> sudo modprobe uvcvideo
> make clean
>
> ----- END SCRIPT -----------------
>
> Let me know if you don't understand something or if there's something wrong
> in what i've written.
>
> Thank you
>
> Marco Argiolas
>
> ------------- lsusb output ------------------------------------
> Bus 006 Device 002: ID 174f:5a35
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   idVendor           0x174f
>   idProduct          0x5a35
>   bcdDevice            4.11
>   iManufacturer           2 Sonix Technology Co., Ltd.
>   iProduct                1 USB 2.0 Camera
>   iSerial                 3 SN0001
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          627
>     bNumInterfaces          2
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0x80
>       (Bus Powered)
>     MaxPower              500mA
>     Interface Association:
>       bLength                 8
>       bDescriptorType        11
>       bFirstInterface         0
>       bInterfaceCount         2
>       bFunctionClass         14 Video
>       bFunctionSubClass       3 Video Interface Collection
>       bFunctionProtocol       0
>       iFunction               1 USB 2.0 Camera
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      1 Video Control
>       bInterfaceProtocol      0
>       iInterface              1 USB 2.0 Camera
>       VideoControl Interface Descriptor:
>         bLength                13
>         bDescriptorType        36
>         bDescriptorSubtype      1 (HEADER)
>         bcdUVC               1.00
>         wTotalLength           77
>         dwClockFrequency        6.000000MHz
>         bInCollection           1
>         baInterfaceNr( 0)       1
>       VideoControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>         bTerminalID             2
>         wTerminalType      0x0101 USB Streaming
>         bAssocTerminal          0
>         bSourceID               4
>         iTerminal               0
>       VideoControl Interface Descriptor:
>         bLength                26
>         bDescriptorType        36
>         bDescriptorSubtype      6 (EXTENSION_UNIT)
>         bUnitID                 4
>         guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
>         bNumControl             1
>         bNrPins                 1
>         baSourceID( 0)          3
>         bControlSize            1
>         bmControls( 0)       0x01
>         iExtension              0
>       VideoControl Interface Descriptor:
>         bLength                18
>         bDescriptorType        36
>         bDescriptorSubtype      2 (INPUT_TERMINAL)
>         bTerminalID             1
>         wTerminalType      0x0201 Camera Sensor
>         bAssocTerminal          0
>         iTerminal               0
>         wObjectiveFocalLengthMin      0
>         wObjectiveFocalLengthMax      0
>         wOcularFocalLength            0
>         bControlSize                  3
>         bmControls           0x00000000
>       VideoControl Interface Descriptor:
>         bLength                11
>         bDescriptorType        36
>         bDescriptorSubtype      5 (PROCESSING_UNIT)
>       Warning: Descriptor too short
>         bUnitID                 3
>         bSourceID               1
>         wMaxMultiplier          0
>         bControlSize            2
>         bmControls     0x0000053f
>           Brightness
>           Contrast
>           Hue
>           Saturation
>           Sharpness
>           Gamma
>           Backlight Compensation
>           Power Line Frequency
>         iProcessing             0
>         bmVideoStandards     0x 0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x83  EP 3 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               6
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       VideoStreaming Interface Descriptor:
>         bLength                            14
>         bDescriptorType                    36
>         bDescriptorSubtype                  1 (INPUT_HEADER)
>         bNumFormats                        1
>         wTotalLength                      407
>         bEndPointAddress                  129
>         bmInfo                              0
>         bTerminalLink                       2
>         bStillCaptureMethod                 2
>         bTriggerSupport                     1
>         bTriggerUsage                       0
>         bControlSize                        1
>         bmaControls( 0)                    27
>       VideoStreaming Interface Descriptor:
>         bLength                            27
>         bDescriptorType                    36
>         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>         bFormatIndex                        1
>         bNumFrameDescriptors                7
>         guidFormat
> {59555932-0000-1000-8000-00aa00389b71}
>         bBitsPerPixel                      16
>         bDefaultFrameIndex                  1
>         bAspectRatioX                       0
>         bAspectRatioY                       0
>         bmInterlaceFlags                 0x00
>           Interlaced stream or variable: No
>           Fields per frame: 1 fields
>           Field 1 first: No
>           Field pattern: Field 1 only
>           bCopyProtect                      0
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         1
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            640
>         wHeight                           480
>         dwMinBitRate                   614400
>         dwMaxBitRate                 18432000
>         dwMaxVideoFrameBufferSize      614400
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         2
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            352
>         wHeight                           288
>         dwMinBitRate                   202752
>         dwMaxBitRate                  6082560
>         dwMaxVideoFrameBufferSize      202752
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         3
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            320
>         wHeight                           240
>         dwMinBitRate                   153600
>         dwMaxBitRate                  4608000
>         dwMaxVideoFrameBufferSize      153600
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         4
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            176
>         wHeight                           144
>         dwMinBitRate                    50688
>         dwMaxBitRate                  1520640
>         dwMaxVideoFrameBufferSize       50688
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         5
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            160
>         wHeight                           120
>         dwMinBitRate                    38400
>         dwMaxBitRate                  1152000
>         dwMaxVideoFrameBufferSize       38400
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            38
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         6
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                           1280
>         wHeight                           960
>         dwMinBitRate                  2457600
>         dwMaxBitRate                 22118400
>         dwMaxVideoFrameBufferSize     2457600
>         dwDefaultFrameInterval        1111111
>         bFrameIntervalType                  3
>         dwFrameInterval( 0)           1111111
>         dwFrameInterval( 1)           2000000
>         dwFrameInterval( 2)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            38
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         7
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                           1280
>         wHeight                          1024
>         dwMinBitRate                  2621440
>         dwMaxBitRate                 23592960
>         dwMaxVideoFrameBufferSize     2621440
>         dwDefaultFrameInterval        1111111
>         bFrameIntervalType                  3
>         dwFrameInterval( 0)           1111111
>         dwFrameInterval( 1)           2000000
>         dwFrameInterval( 2)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            34
>         bDescriptorType                    36
>         bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>         bEndpointAddress                    0
>         bNumImageSizePatterns               7
>         wWidth( 0)                       1280
>         wHeight( 0)                      1024
>         wWidth( 1)                       1280
>         wHeight( 1)                       960
>         wWidth( 2)                        640
>         wHeight( 2)                       480
>         wWidth( 3)                        352
>         wHeight( 3)                       288
>         wWidth( 4)                        320
>         wHeight( 4)                       240
>         wWidth( 5)                        176
>         wHeight( 5)                       144
>         wWidth( 6)                        160
>         wHeight( 6)                       120
>         bNumCompressionPatterns             7
>       VideoStreaming Interface Descriptor:
>         bLength                             6
>         bDescriptorType                    36
>         bDescriptorSubtype                 13 (COLORFORMAT)
>         bColorPrimaries                     1 (BT.709,sRGB)
>         bTransferCharacteristics            1 (BT.709)
>         bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       1
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0080  1x 128 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       2
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0100  1x 256 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       3
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0320  1x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       4
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0b20  2x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       5
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1320  3x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       6
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x13e8  3x 1000 bytes
>         bInterval               1
> Device Qualifier (for other device speed):
>   bLength                10
>   bDescriptorType         6
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   bNumConfigurations      1
> Device Status:     0x0000
>   (Bus Powered)




-- 
Marco Argiolas
marco.argiolas at studenti.polito.it
arjos85 at gmail.com
skype: arjos85
msn: sarace2003 at libero.it
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080619/1172a3c5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: original_uvcvideo.jpg
Type: image/jpeg
Size: 5064 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080619/1172a3c5/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: modded_uvcvideo_1pixel.jpg
Type: image/jpeg
Size: 5203 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080619/1172a3c5/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: modded_uvcvideo_2pixel.jpg
Type: image/jpeg
Size: 27521 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080619/1172a3c5/attachment-0002.jpg>

From arjos85 at gmail.com  Thu Jun 19 17:07:22 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Thu, 19 Jun 2008 17:07:22 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806180608t4a832fdo74479ff8be74ec65@mail.gmail.com>
References: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
	<1213791034.3051.9.camel@castor.localdomain>
	<879e1f2b0806180608t4a832fdo74479ff8be74ec65@mail.gmail.com>
Message-ID: <879e1f2b0806190807x3eda28bag65059cfe20fffb91@mail.gmail.com>

Hi Richard,

Nice to see that you've got yourself a fix. But you are leaking your
> temp buffer -- you'll need to free it somewhere.
>

Thanks,
I've already solved this leakage...
yesterday I've posted a new mail with some corrections, including this one.
I hope it will be published soon on the uvcvideo mailing list.


> But it does seem expensive to copy the data 3 times.


Why "3 time"? In "uvc_video_decode_data" function "memcpy" is called just 2
times. ;)


> Could you do
> something like this instead?
>
> int *src = (int*) data + len;
> int *dst = (int*) buffer;
>
> for ( int i= 0; i < len /sizeof(int); i++) {
>        src--;
>        *dst++ = *src;
> }
>
> that way you only have to copy the data once and you don't need a
> temporary buffer.
>

thank you for the suggestion but the problem is that I've already tried this
solution, and thanks to it I've understood that "data" doesn't contain a
full image, but just one part. So in order to complete an image, the
function "uvc_video_decode_data" has to be called different times.
Each time data is copyed into "mem", where:
  mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
// "queue->mem" and "buf->buf.m.offset" are constant in relation to the same
image
  buf->buf.bytesused += nbytes;
// "nbytes" is just the number of bytes copied in the current call of
"uvc_video_decode_data"

So before to flip the image I have to wait that the frame is fully captured:
"if (len >= maxlen)" statement just helps in solving this need.
I've added the "=" condition, but I'm not sure about it.
I hope someone could give me confirmation of this.

Please Richard let me know if I've misunderstood your suggestions or if you
don't agree with my explanation.

Just for now,
thank you for your interest.

Marco Argiolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080619/019e0c65/attachment.html>

From homoludens1000 at gmail.com  Thu Jun 19 16:44:26 2008
From: homoludens1000 at gmail.com (homoludens)
Date: Thu, 19 Jun 2008 23:44:26 +0900
Subject: [Linux-uvc-devel] Getting Webcams 0ac8:301b and 0ac8:307b to work
	under openSUSE 10.3
Message-ID: <200806192344.26356.homoludens1000@gmail.com>

Dear all,

I'm trying to get two webcams to work under openSUSE 10.3. No luck so far, but 
I was referred to this mailing list at the openSUSE forums. Any help would be 
appreciated!

The webcams in question are:
(1) Elecom
UCAM-N1C30WBK2
ID 0ac8:301b Z-Star Microelectronics Corp. ZC0301 WebCam

(2) Sanwa Supplies
CMS-V23SETSV
ID 0ac8:307b Z-Star Microelectronics Corp

Both cheapies, as probably apparent from the chip they are  ... I should 
probably get myself a decent webcam, but I do like the Sanwa Supplies in 
particular, it's so small.

My work environment:
OS:  Linux 2.6.22.17-0.1-default i686
System:  openSUSE 10.3 (i586)
KDE:  3.5.7 "release 72.9"
Computer: Panasonic Laptop CF-Y2 "Let's Note" (it's a Japanese model, but the 
same as the "Toughbook Light CF-Y2" I think).

Steps I've taken so far:
I've tried using both the gspcav1-kmp-default driver with jasper as 
recommended by http://en.opensuse.org/HCL/Web_Cameras as well as the uvcvideo 
driver, but neither solution seems to work (my system doesn't recognize the 
webcams when plugged in).



From arjos85 at gmail.com  Thu Jun 19 22:51:36 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Thu, 19 Jun 2008 22:51:36 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
Message-ID: <879e1f2b0806191351u6859e04fv85eeb7c92071ac87@mail.gmail.com>

WOW...
I think to have solved all my doubts and problems!!!
In fact just making some experiments with my modded uvcvideo driver, mplayer
and printing messages with printk(), I have found that also if mplayer
requests a 1280x960 or 1280x1024 image, the camera sends back a 640x480 one,
with all the resolutions supported with my camera (Sonix 1.3 Mpx -
174f:5a35) the bpp is constant and equal to 16 (2 bytes). I've also tried to
see the uvcvideo behaviour with skype and kopete video request from my
webcam.
At the end I've just modified again my modded function in "uvc_video.c"file:
static void uvc_video_decode_data(struct uvc_video_device *video,
        struct uvc_buffer *buf, const __u8 *data, int len)

I've simply changed the declaration of "pixel_size" variable:
I don't give any more a constant value:
- pixel_size=2 was perfect with any resolutions, but colours (I don't know
why) were really pour (red and blue were exchanged each other);
- pixel_size=1280 gave back a perfect mirrored images, but with resolutions
lower than 640x480 there where problems in the consistancy of the image;

Now I've solved all my problem just using definig pixel_size in a dynamic
way:

pixel_size=video->streaming->cur_frame->wWidth *
video->streaming->format->bpp / 8;

each time pixel_size depens on the required width of the images, and I can
copy just line by line the whole image: in this way I got a mirrored image
with perfect colours.
The important thing is that this solutions DOES NOT DEPEND on the webcam you
are using or on the program you are running to use your webcam!!!!

So...just have fun with your camera!!!
Please report me any error!!! Thank you!!

Marco Argiolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080619/f3520a6b/attachment.html>

From homoludens1000 at gmail.com  Fri Jun 20 02:59:53 2008
From: homoludens1000 at gmail.com (homoludens)
Date: Fri, 20 Jun 2008 09:59:53 +0900
Subject: [Linux-uvc-devel] Getting Webcams 0ac8:301b and 0ac8:307b to work
	under openSUSE 10.3
Message-ID: <200806200959.53568.homoludens1000@gmail.com>

Oops, sorry for the messy headline last time. I'm re-sending the email; just 
ignore the previous one.

homo ludens




On Friday, 20 June 2008 01:01:24 Marco Argiolas wrote:
> Just give us a "sudo lsusb -vv" information about your webcams!!
> It can be usefull to know if your cams are "uvcvideo ready"! ;)
>


Of course, here you go!

homo ludens



*** Elecom ***
Bus 002 Device 006: ID 0ac8:301b Z-Star Microelectronics Corp. ZC0301 WebCam
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0ac8 Z-Star Microelectronics Corp.
  idProduct          0x301b ZC0301 WebCam
  bcdDevice            1.00
  iManufacturer           1 Z-Star Corp.
  iProduct                2 PC Camera
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          193
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              160mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       4
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       5
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       6
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0300  1x 768 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       7
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03ff  1x 1023 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
Device Status:     0x0000
  (Bus Powered)

*** Sanwa Supplies ***

Bus 002 Device 004: ID 0ac8:307b Z-Star Microelectronics Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0ac8 Z-Star Microelectronics Corp.
  idProduct          0x307b 
  bcdDevice            1.00
  iManufacturer           1 Vimicro Corp.
  iProduct                2 PC Camera
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          193
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              160mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       4
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       5
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       6
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0300  1x 768 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       7
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0380  1x 896 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
Device Status:     0x0000
  (Bus Powered)


From emmanuel at libera.cc  Fri Jun 20 11:42:41 2008
From: emmanuel at libera.cc (Emmanuel Kasper)
Date: Fri, 20 Jun 2008 11:42:41 +0200
Subject: [Linux-uvc-devel] Vendor support in linux-uvc development
Message-ID: <485B7B91.2090608@libera.cc>

Hello
With a couple of other french folks, we are building a kind of webshop
for Linux/FreeBSD compatible hardware. We will reference only devices
which work with a free driver, so no nvidia binary thingie / atheros HAL
/ etc ...

Based on the information found  on  http://linux-uvc.berlios.de we plan
to reference the following webcams all of them using the uvcvideo driver

Microsoft LifeCam NX-6000
Creative Labs Cam Optia
Guillemot Hercules Dualpix Exchange
Logitech Quickcam Communicate Deluxe
Logitech Quickcam Pro for Notebook
Logitec QuickCam Fusion
Logitech Quickcam Pro 9000
Logitech QuickCam Pro 5000


We would be also interested to indicate on each product description, if
the vendor of the product, or the chipset maker for that matters had
been helpful with developers trying to write a free driver. So for the
devices mentionned above, was any of the vendor helpful by providing
programming documentation or hardware ?

If yes we will mention it on the product description with an extra tag
like "programmer friendly".

--
Emmanuel Kasper
System Administrator
www.libera.cc
Find, compare, buy Linux & FreeBSD compatible hardware



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 252 bytes
Desc: OpenPGP digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080620/96c2e929/attachment.pgp>

From laurent.pinchart at skynet.be  Fri Jun 20 12:12:21 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jun 2008 12:12:21 +0200
Subject: [Linux-uvc-devel] device 174f:8a33
In-Reply-To: <200806181325.08195.jaime.perea@gmail.com>
References: <200806181325.08195.jaime.perea@gmail.com>
Message-ID: <200806201212.21182.laurent.pinchart@skynet.be>

Hi Jaime,

On Wednesday 18 June 2008, Jaime Perea wrote:
> Hello
>
> After messing around with the uvcvideo module parameters
> I discovered that installing the uvcvide module it with quirks=16,
> my integrated camera works fine.
>
> Asus E3S - Mandriva 2008.1 - kernel 2.6.24.5-laptop-2mnb
>
> Thus, inserting in the /etc/modprobe.conf file a line
>
> options uvcvideo quirks=16
>
> does the trick. At least it works with luvcview, ekiga and skype

Thanks for the information.

> By the way this is to define the UVC_QUIRK_STREAM_NO_FID quirk, which is
> something that goes beyond us mere mortals :-)

The "no FID" quirk works around a camera bug that causes the Frame ID bit not 
to be toggled. The UVC specification requires that cameras toggle a specific 
bit every time they send a new frame. The UVC driver uses that bit to detect 
frame boundaries. When the "no FID" quirk is enabled, the driver falls back 
to another less robust method.

> Thanks for the good work and regards.

You're welcome. I've committed support for your camera to the SVN repository, 
you shouldn't need to set the quirk manually anymore.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jun 20 13:10:45 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jun 2008 13:10:45 +0200
Subject: [Linux-uvc-devel] Drivers for Device ID 5986:0105
In-Reply-To: <1213872359.14542.0.camel@linux-i68a.site>
References: <1213872359.14542.0.camel@linux-i68a.site>
Message-ID: <200806201310.45438.laurent.pinchart@skynet.be>

Hi Kadiravan,

On Thursday 19 June 2008, kadiravan wrote:
> Dear all,
>
>              UVC video drivers is able to identify the device but unable
> to function.We have referred to supported devices list but we havent
> found support for the Device (ID 5986:0105 )
>
>              OS: Suse 10.1
>              Kernel: 2.6.16.54-0.2.5-smp
>              UVC version: 1.0 , we have checked out the latest from the
> repository
>              Device: Acer Crystal Eye
>
>              We have attached out put from DMESG and LSUSB.

Thank you for the detailed report. Could you please try to load the module 
with

modprobe uvcvideo quirks=2

and report success (or failure) here ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jun 20 13:15:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jun 2008 13:15:35 +0200
Subject: [Linux-uvc-devel] Getting Webcams 0ac8:301b and 0ac8:307b to
	work under openSUSE 10.3
In-Reply-To: <200806192344.26356.homoludens1000@gmail.com>
References: <200806192344.26356.homoludens1000@gmail.com>
Message-ID: <200806201315.35740.laurent.pinchart@skynet.be>

Hi,

On Thursday 19 June 2008, homoludens wrote:
> Dear all,
>
> I'm trying to get two webcams to work under openSUSE 10.3. No luck so far,
> but I was referred to this mailing list at the openSUSE forums. Any help
> would be appreciated!
>
> The webcams in question are:
> (1) Elecom
> UCAM-N1C30WBK2
> ID 0ac8:301b Z-Star Microelectronics Corp. ZC0301 WebCam
>
> (2) Sanwa Supplies
> CMS-V23SETSV
> ID 0ac8:307b Z-Star Microelectronics Corp
>
> Both cheapies, as probably apparent from the chip they are  ... I should
> probably get myself a decent webcam, but I do like the Sanwa Supplies in
> particular, it's so small.
>
> My work environment:
> OS:  Linux 2.6.22.17-0.1-default i686
> System:  openSUSE 10.3 (i586)
> KDE:  3.5.7 "release 72.9"
> Computer: Panasonic Laptop CF-Y2 "Let's Note" (it's a Japanese model, but
> the same as the "Toughbook Light CF-Y2" I think).
>
> Steps I've taken so far:
> I've tried using both the gspcav1-kmp-default driver with jasper as
> recommended by http://en.opensuse.org/HCL/Web_Cameras as well as the
> uvcvideo driver, but neither solution seems to work (my system doesn't
> recognize the webcams when plugged in).

To find out if your cameras are UVC compliant, please check 
http://www.quickcamteam.net/documentation/faq/how-do-i-find-out-whether-my-camera-is-a-uvc-device-or-not

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jun 20 13:18:39 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jun 2008 13:18:39 +0200
Subject: [Linux-uvc-devel]
	=?iso-8859-1?q?SOLVED=3A_upside-down_image_from?=
	=?iso-8859-1?q?_SONIXlaptop=09embedded_webcam?=
In-Reply-To: <B202DF071955462B9DC44EC468278323@core2>
References: <879e1f2b0806150737m9d71ea2sd9d3056624b58053@mail.gmail.com>
	<1213791034.3051.9.camel@castor.localdomain>
	<B202DF071955462B9DC44EC468278323@core2>
Message-ID: <200806201318.39701.laurent.pinchart@skynet.be>

Hi Adrian,

On Wednesday 18 June 2008, Adrian Sergiu DARABANT wrote:
> Yes - what I've been thinking about either. I wonder isn't there a control
> on the camera that switches the image vertically. There are cameras that do
> that.

Most sensors can flip the image vertically and/or horizontally. Unfortunately, 
most camera firmwares don't export that capability. We end up with hardware 
capable of mirroring the image and no way to use that capability.

> Otherwise it means that the Windows driver does the same and that is 
> quite expensive doing memory copies on video flows buffers (what will that
> do at 1600x1200 for example on a 2MP camera ??

I've had confirmation by one Taiwanese chipset vendor that their driver 
performs image mirroring in software.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jun 20 13:32:28 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jun 2008 13:32:28 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
Message-ID: <200806201332.29045.laurent.pinchart@skynet.be>

Hi Marco,

On Tuesday 17 June 2008, Marco Argiolas wrote:
> Here I'm again to correct some mistakes and to add some missing data:
> - first of all I have a Sonix webcam with device id 174f:5a35 (at the end
> of this message I've attached the complete verbose lsusb output);
> - with my webcam,  "pixel_size" (# of bytes per pixel) has to be set equal
> to "2" (pixel_size=2 ), because bpp=16 (2 byte);
> - I've also added a kfree() in order to free the preallocated space;

You shouldn't have allocated extra memory in the first place. Instead of 
modifying the whole frame at once, you should instead replace the call to 
memcpy() in uvc_video_decode_data() and revert the image there. Computation 
of boundaries and memory offsets might be a bit more difficult, but you will 
speed up the process and you'll avoid allocating an extra buffer.

> - in order to speed up the allocation process I've used GFP_ATOMIC flag in
> kmalloc() function.

The purpose of GFP_ATOMIC is not to speed up memory allocation, but to make 
sure that memory allocation will not sleep. This is required here, as 
uvc_video_decode_data() is called in interrupt context where you're not 
allowed to sleep.

> Please let me know if you think something is wrong.
> Because just right now my cam is working fine, now images are not
> upside-down, but colour are not so perfect.
> Also if the colour of my skin seems to be the right one, red and blu colour
> are exchanged each other.
>
> Do you think the "=" is appropriate in "if (len >= maxlen)" statement?

As explained above, you should modify the existing memcpy() instead of adding 
a new one. The statement your mention will then not have to be modified.

Best regards,

Laurent Pinchart


From arjos85 at gmail.com  Fri Jun 20 19:24:25 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Fri, 20 Jun 2008 19:24:25 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <200806201332.29045.laurent.pinchart@skynet.be>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
	<200806201332.29045.laurent.pinchart@skynet.be>
Message-ID: <879e1f2b0806201024w7a4adb04ld54042895614798e@mail.gmail.com>

Hi Richard,

You shouldn't have allocated extra memory in the first place. Instead of
> modifying the whole frame at once, you should instead replace the call to
> memcpy() in uvc_video_decode_data() and revert the image there. Computation
> of boundaries and memory offsets might be a bit more difficult, but you
> will
> speed up the process and you'll avoid allocating an extra buffer.
>

Thank you for this suggestion,
I haven't thought about this solution before.

The purpose of GFP_ATOMIC is not to speed up memory allocation, but to make
> sure that memory allocation will not sleep. This is required here, as
> uvc_video_decode_data() is called in interrupt context where you're not
> allowed to sleep.


So, in this way I'm sure memory allocation won't sleep and I can say it is
the fastest way (and also the only one suggested in this case)  to allocate
memory. Is it right?


> As explained above, you should modify the existing memcpy() instead of
> adding
> a new one. The statement your mention will then not have to be modified.
>

Here it is the new patch of "uvc_video_decode_data()" (I was going crazy
with the computation of all offset) and as attachement you can find the
modded "uvc_video.c" file:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

$ diff -u original modded
--- original    2008-06-20 19:15:28.000000000 +0200
+++ modded      2008-06-20 19:11:31.000000000 +0200
@@ -4,6 +4,11 @@
        struct uvc_video_queue *queue = &video->queue;
        unsigned int maxlen, nbytes;
        void *mem;
+       unsigned int
+               pixel_size,
+               to_be_copied,
+               shift_right,
+               buf_offset;

        if (len <= 0)
                return;
@@ -12,11 +17,29 @@
        maxlen = buf->buf.length - buf->buf.bytesused;
        mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
        nbytes = min((unsigned int)len, maxlen);
-       memcpy(mem, data, nbytes);
-       buf->buf.bytesused += nbytes;

-       if (len > maxlen) {
+       pixel_size = video->streaming->cur_frame->wWidth *
video->streaming->format->bpp / 8;
+       to_be_copied = 0;
+       while( nbytes > 0 ) { // Are there other bytes to be copied?
+               shift_right = buf->buf.bytesused % pixel_size;
+               if ( nbytes > pixel_size - shift_right)
+                       to_be_copied = pixel_size - shift_right ;
+               else    to_be_copied = nbytes;
+
+               if (shift_right > 0 )
+                       buf_offset = to_be_copied - shift_right ;
+               else    buf_offset = pixel_size;
+               memcpy( queue->mem + buf->buf.m.offset + pixel_size *
video->streaming->cur_frame->wHeight - buf->buf.bytesused - buf_offset,
+                       data,
+                       to_be_copied ) ;
+
+               data += to_be_copied;
+               buf->buf.bytesused += to_be_copied ;
+               nbytes -= to_be_copied;
+       }

+       if (len >= maxlen) {
                uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
                buf->state = UVC_BUF_STATE_DONE;
        }

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Unluckly also if now I don't allocate any memory, with bigger resolutions
the final video seems to be a little bit slower than with the allocation
(previous solution).
Please if you can/need try both my solutions and let me know your results!!!
Which one is the fastest?
Please let also me know if you think I made some mistakes that slow down
this last version of uvcvideo without memory allocation.

Thank you a lot for your help!!

Marco Argiolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080620/246d90b7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc_video.c
Type: text/x-csrc
Size: 29160 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080620/246d90b7/attachment.c>

From ml.mildred593 at online.fr  Sat Jun 21 23:28:48 2008
From: ml.mildred593 at online.fr (Mildred)
Date: Sat, 21 Jun 2008 23:28:48 +0200
Subject: [Linux-uvc-devel] iSight problem
Message-ID: <20080621232848.08393af6@kylae>

Hi,

I'm writing here since it seems that now, iSight code seems to be part
of UVC. And I'm having a problem with it (/dev/video0 not created).

So I built the uvcvideo driver (trunk r217) and built iSight Firmware
Tools 1.2 (and restarted HAL). When I load the driver, dmesg only tells
me:

usbcore: registered new interface driver uvcvideo

Nothing else.
if I modprobe uvcvideo race=255, I get:

uvcvideo: Adding mapping Brightness to control 00000000-0000-0000-0000-000000000101/2.
uvcvideo: Adding mapping Contrast to control 00000000-0000-0000-0000-000000000101/3.
uvcvideo: Adding mapping Hue to control 00000000-0000-0000-0000-000000000101/6.
uvcvideo: Adding mapping Saturation to control 00000000-0000-0000-0000-000000000101/7.
uvcvideo: Adding mapping Sharpness to control 00000000-0000-0000-0000-000000000101/8.
uvcvideo: Adding mapping Gamma to control 00000000-0000-0000-0000-000000000101/9.
uvcvideo: Adding mapping Backlight Compensation to control 00000000-0000-0000-0000-000000000101/1.
uvcvideo: Adding mapping Gain to control 00000000-0000-0000-0000-000000000101/4.
uvcvideo: Adding mapping Power Line Frequency to control 00000000-0000-0000-0000-000000000101/5.
uvcvideo: Adding mapping Hue, Auto to control 00000000-0000-0000-0000-000000000101/16.
uvcvideo: Adding mapping Exposure, Auto to control 00000000-0000-0000-0000-000000000001/2.
uvcvideo: Adding mapping Exposure, Auto Priority to control 00000000-0000-0000-0000-000000000001/3.
uvcvideo: Adding mapping Exposure (Absolute) to control 00000000-0000-0000-0000-000000000001/4.
uvcvideo: Adding mapping White Balance Temperature, Auto to control 00000000-0000-0000-0000-000000000101/11.
uvcvideo: Adding mapping White Balance Temperature to control 00000000-0000-0000-0000-000000000101/10.
uvcvideo: Adding mapping White Balance Component, Auto to control 00000000-0000-0000-0000-000000000101/13.
uvcvideo: Adding mapping White Balance Blue Component to control 00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping White Balance Red Component to control 00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping Focus (absolute) to control 00000000-0000-0000-0000-000000000001/6.
uvcvideo: Adding mapping Focus, Auto to control 00000000-0000-0000-0000-000000000001/8.
usbcore: registered new interface driver uvcvideo

The problem is that no device /dev/video0 is created, so gstreamer
fails with a message like

Error running pipeline 'Video for Linux 2 (v4l2)': Cannot identify device '/dev/video0'. [v4l2_calls.c(429): gst_v4l2_open (): /pipeline0/v4l2src3:
system error: No such file or directory]


I don't think that's a problem regarding the firmware loading since I
used an old binary called 'extract' that worked back in time. It tells
me that the iSight firmware is loaded:

Apple iSight with firmware already loaded found
Apple iSight with firmware already loaded found


There is an output of lsusb:

$ sudo lsusb -d 05ac:8501 -v

Bus 002 Device 003: ID 05ac:8501 Apple Computer, Inc. Built-in iSight [Micron]
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass       255 Vendor Specific Subclass
  bDeviceProtocol       255 Vendor Specific Protocol
  bMaxPacketSize0        64
  idVendor           0x05ac Apple Computer, Inc.
  idProduct          0x8501 Built-in iSight [Micron]
  bcdDevice            1.84
  iManufacturer           1 Micron
  iProduct                2 Built-in iSight
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          267
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              100mA
    ** UNRECOGNIZED:  08 24 00 02 ff ff ff 00
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      ** UNRECOGNIZED:  0d 24 01 00 01 31 00 60 fe cd 00 01 01
      ** UNRECOGNIZED:  10 24 02 01 01 02 00 00 00 00 00 00 00 00 01 00
      ** UNRECOGNIZED:  0b 24 05 02 01 00 00 02 39 00 00
      ** UNRECOGNIZED:  09 24 03 03 01 01 00 02 00
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      ** UNRECOGNIZED:  0e 24 01 01 9b 00 82 00 03 00 00 00 01 00
      ** UNRECOGNIZED:  1b 24 04 01 03 55 59 56 59 00 00 10 00 80 00 00 aa 00 38 9b 71 10 01 00 00 00 00
      ** UNRECOGNIZED:  26 24 05 01 00 80 02 e0 01 00 06 e3 16 00 06 e3 16 00 60 09 00 15 16 05 00 00 15 16 05 00 15 16 05 00 00 00 00 00
      ** UNRECOGNIZED:  26 24 05 02 00 60 01 20 01 00 06 e3 16 00 06 e3 16 00 18 03 00 15 16 05 00 00 15 16 05 00 15 16 05 00 00 00 00 00
      ** UNRECOGNIZED:  26 24 05 03 00 40 01 f0 00 00 06 e3 16 00 06 e3 16 00 58 02 00 15 16 05 00 00 15 16 05 00 15 16 05 00 00 00 00 00
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass       255 Vendor Specific Subclass
  bDeviceProtocol       255 Vendor Specific Protocol
  bMaxPacketSize0         8
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)




Do you have any ideas about this problem ?
Some months ago, my webcam worked with a driver derived from uvcvideo.
but that was with the previous kernel. Now it no longer compiles.


Thanks

Mildred
-- 
Mildred Ki'lya
E-Mail:	mildred593(at)online.fr

Site:	<http://mildred632.free.fr/>
XMPP:	<mildred at jabber.fr> (GoogleTalk, Jabber)

GPG:	197C A7E6 645B 4299 6D37 684B 6F9D A8D6 [9A7D 2E2B]


From moreno.marzolla at pd.infn.it  Sun Jun 22 11:50:17 2008
From: moreno.marzolla at pd.infn.it (Moreno Marzolla)
Date: Sun, 22 Jun 2008 11:50:17 +0200
Subject: [Linux-uvc-devel] Over-exposed outdoor images with Creative Live!
	Cam Optia
Message-ID: <485E2059.6080905@pd.infn.it>

Hi all,

I recently bought a Creative Live! Cam Optia (the cheap, non-PRO, non-AF 
version) with USB id 041e:4057. I'm trying to get the camera to work 
with linux to capture outdoor images.
I succesfully compiled the uvcvideo module (r217) both on Ubuntu 6.06LTS 
(AMD64 flavour)  and under debian 4.0 (i686) without any trouble. 
luvcview-20070512 also works great on both platforms. The camera is 
recognized and I'm able to get the video with luvcview.
However, while the quality of indoor pictures is in my opinion very 
good, even in dark environments, outdoor pictures are severely 
overexposed and so far I have been unable to get around that.
I'm currently working on the debian machine (debian kernel 2.6.18-6-686, 
uvcvideo r217). Just to have an idea, this is what I get with the 
default settings of the Live! Cam Optia at 640x480:

http://www.dsi.unive.it/~marzolla/snapshot_optia.jpg

This is the same panorama taken with my digital photo camera:

http://www.dsi.unive.it/~marzolla/snapshot_ok.jpg

Of course I tried to tweak the picture parameters with luvcview, but 
changing contrast and luminosity does not help, and I'm unable to set 
manual exposure (luvcview says "Set Auto Exposure off error"). I'm 
unsure whether exposure can be controlled at all with this webcam, 
because if I do:

moreno at colossus:~/src/linux-uvc$ v4lctl -c /dev/video0 list
ioctl: VIDIOC_G_STD(std=0xb7ce44c0b7c1d9ef 
[PAL_B,PAL_B1,PAL_G,PAL_H,PAL_D,PAL_D1,PAL_K,PAL_M,PAL_60,NTSC_M,?,?,SECAM_B,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null)]): 
Invalid argument
attribute  | type   | current | default | comment
-----------+--------+---------+---------+-------------------------------------
norm       | choice | (null)  | (null)  |
input      | choice | Camera  | Camera  | Camera 1
bright     | int    |      30 |      30 | range is 0 => 100
contrast   | int    |       2 |       2 | range is 0 => 6
color      | int    |       3 |       3 | range is 0 => 8
hue        | int    |       0 |       0 | range is -4 => 4
Gamma      | int    |       3 |       3 | range is 0 => 7
Power Line | choice | 50 Hz   | Disable | Disabled 50 Hz 60 Hz
Sharpness  | int    |      39 |      40 | range is 0 => 96

I see no mention of exposure. The same happens even using luvcview:

moreno at colossus:~/src/luvcview-20070512$ ./luvcview -d /dev/video0 -l
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean 3=Menu 
4=Button)
V4L2_CID_BASE         (predefined controls):
  index:9963776    name:Brightness                       type:1 min:0 
   max:100   step:1     def:30    now:30
  index:9963777    name:Contrast                         type:1 min:0 
   max:6    step:1     def:2     now:2
  index:9963778    name:Saturation                       type:1 min:0 
   max:8    step:1     def:3     now:3
  index:9963779    name:Hue                              type:1 min:-4 
   max:4    step:1     def:0     now:0
  index:9963792    name:Gamma                            type:1 min:0 
   max:7    step:1     def:3     now:3
V4L2_CID_PRIVATE_BASE (driver specific controls):
find DRI
find DRI
find DRI

Before going into deeper details, I would like to ask whether anybody 
has been able to get good outdoor pictures with the Creative Live! Cam 
Optia, and/or whether anybody has been able to manually set the exposure 
with the same camera.

Thanks in advance,

Moreno.
---
Moreno Marzolla
EMail: moreno.marzolla at pd.infn.it
WWW  : http://www.dsi.unive.it/~marzolla



From homoludens1000 at gmail.com  Sun Jun 22 16:31:59 2008
From: homoludens1000 at gmail.com (homoludens)
Date: Sun, 22 Jun 2008 23:31:59 +0900
Subject: [Linux-uvc-devel] Getting Webcams 0ac8:301b and 0ac8:307b to
	work under openSUSE 10.3
Message-ID: <200806222332.00096.homoludens1000@gmail.com>

> To find out if your cameras are UVC compliant, please check
> http://www.quickcamteam.net/documentation/faq/how-do-i-find-out-whether-my-
>camera-is-a-uvc-device-or-not
>
> Best regards,
>
> Laurent Pinchart


No, neither webcam seems to be UVC compliant. The relevant lines in the lsusb 
output have "255 Vendor Specific Class" rather than "14 Video".

So ... this means that these cameras won't work with UVC? :-(

Best,

homoludens


From jasny at vidsoft.de  Mon Jun 23 12:26:10 2008
From: jasny at vidsoft.de (Gregor Jasny)
Date: Mon, 23 Jun 2008 12:26:10 +0200
Subject: [Linux-uvc-devel] Thread safety of ioctls
Message-ID: <485F7A42.8020605@vidsoft.de>

Hi,

in our video conference application the grabbing (QBUF, DQBUF) is done 
in a separate thread. The main thread is responsible for the user 
interface and queries the controls, input and current standard values 
from time to time.

With the latest uvc driver (r217) and vanilla Linux 2.6.25.6 I've 
noticed the strange behavior that the grabbing thread hangs in the DQBUF 
ioctl. If I remove the control queries from the gui thread everything is 
working fine. After the first hang of the driver, even luvcview hangs at 
the buffer operation.

With the bttv driver everything works fine. I'll test vivi and pwc 
driver later.

My systems are a i686 and one amd64 system with one Logitech 9000 and 
one Microsoft NX-6000. I've tried to create a simple testcase, but 
suprinsingly this testcase works fine.

Can I enable more logging than setting the trace parameter to 0xfff?
Have you any idea what went wrong here? Is the V4L2-API designed to be 
thread safe?

Thanks,
Gregor


From laurent.pinchart at skynet.be  Tue Jun 24 00:09:17 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 00:09:17 +0200
Subject: [Linux-uvc-devel] Vendor support in linux-uvc development
In-Reply-To: <485B7B91.2090608@libera.cc>
References: <485B7B91.2090608@libera.cc>
Message-ID: <200806240009.17677.laurent.pinchart@skynet.be>

Hi Emmanuel,

On Friday 20 June 2008, Emmanuel Kasper wrote:
> Hello
> With a couple of other french folks, we are building a kind of webshop
> for Linux/FreeBSD compatible hardware. We will reference only devices
> which work with a free driver, so no nvidia binary thingie / atheros HAL
> / etc ...

Great initiative ! I hope you will succeed in your project and I'm looking 
forward for collaboration on Linux driver development in the future :-)

> Based on the information found  on  http://linux-uvc.berlios.de we plan
> to reference the following webcams all of them using the uvcvideo driver
>
> Microsoft LifeCam NX-6000
> Creative Labs Cam Optia
> Guillemot Hercules Dualpix Exchange
> Logitech Quickcam Communicate Deluxe
> Logitech Quickcam Pro for Notebook
> Logitech QuickCam Fusion
> Logitech Quickcam Pro 9000
> Logitech QuickCam Pro 5000

Among those cameras I've only tested the Creative and Logitech webcams 
personally. You shouldn't list the Logitech QuickCam Fusion, as it has a bad 
firmware bug that makes Linux support unreliable.

Check http://www.quickcamteam.net/hcl/linux/logitech-webcams for more 
information about Logitech webcams.

> We would be also interested to indicate on each product description, if
> the vendor of the product, or the chipset maker for that matters had
> been helpful with developers trying to write a free driver. So for the
> devices mentionned above, was any of the vendor helpful by providing
> programming documentation or hardware ?
>
> If yes we will mention it on the product description with an extra tag
> like "programmer friendly".

I asked Microsoft for hardware samples and they simply ignored my request. 
Nothing surprising there, although I've heard from another developer that it 
largely depends on who you contact in the company.

I haven't had any contact with Hercules.

Creative Labs offered a free Optia webcam. My contact there was very friendly, 
and welcomed the Linux UVC driver project.

Logitech has proved the most supportive so far. I've received hardware samples 
and documentation. They set up a community website at 
http://www.quickcamteam.net/ for Linux, Mac OS X and Windows users and 
developers. You can definitely flag them as programmer friendly and Linux 
friendly, at least for their webcam department.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 00:18:21 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 00:18:21 +0200
Subject: [Linux-uvc-devel] iSight problem
In-Reply-To: <20080621232848.08393af6@kylae>
References: <20080621232848.08393af6@kylae>
Message-ID: <200806240018.21717.laurent.pinchart@skynet.be>

Hi Mildred,

On Saturday 21 June 2008, Mildred wrote:
> Hi,
>
> I'm writing here since it seems that now, iSight code seems to be part
> of UVC. And I'm having a problem with it (/dev/video0 not created).
>
> So I built the uvcvideo driver (trunk r217) and built iSight Firmware
> Tools 1.2 (and restarted HAL). When I load the driver, dmesg only tells
> me:
>
> usbcore: registered new interface driver uvcvideo
>
> Nothing else.
> if I modprobe uvcvideo race=255, I get:
>
[snip]
>
> The problem is that no device /dev/video0 is created, so gstreamer
> fails with a message like
>
> Error running pipeline 'Video for Linux 2 (v4l2)': Cannot identify device
> '/dev/video0'. [v4l2_calls.c(429): gst_v4l2_open (): /pipeline0/v4l2src3:
> system error: No such file or directory]
>
>
> I don't think that's a problem regarding the firmware loading since I
> used an old binary called 'extract' that worked back in time. It tells
> me that the iSight firmware is loaded:
>
> Apple iSight with firmware already loaded found
> Apple iSight with firmware already loaded found
>
>
> There is an output of lsusb:
>
> $ sudo lsusb -d 05ac:8501 -v
>
> Bus 002 Device 003: ID 05ac:8501 Apple Computer, Inc. Built-in iSight
> [Micron] Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          255 Vendor Specific Class
>   bDeviceSubClass       255 Vendor Specific Subclass
>   bDeviceProtocol       255 Vendor Specific Protocol
>   bMaxPacketSize0        64
>   idVendor           0x05ac Apple Computer, Inc.
>   idProduct          0x8501 Built-in iSight [Micron]
>   bcdDevice            1.84
>   iManufacturer           1 Micron
>   iProduct                2 Built-in iSight
>   iSerial                 0
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          267
>     bNumInterfaces          2
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0x80
>       (Bus Powered)
>     MaxPower              100mA
>     ** UNRECOGNIZED:  08 24 00 02 ff ff ff 00
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           1
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
[snip]

bInterfaceClass should be set to '14 Video'. This means your firmware hasn't 
been patched.

> Do you have any ideas about this problem ?
> Some months ago, my webcam worked with a driver derived from uvcvideo.
> but that was with the previous kernel. Now it no longer compiles.

Try to upgrade the firmware extractor/loader. It should patch your firmware to 
make it compatible with the UVC driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 00:25:30 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 00:25:30 +0200
Subject: [Linux-uvc-devel] Over-exposed outdoor images with Creative
	Live! Cam Optia
In-Reply-To: <485E2059.6080905@pd.infn.it>
References: <485E2059.6080905@pd.infn.it>
Message-ID: <200806240025.30503.laurent.pinchart@skynet.be>

Hi Moreno,

On Sunday 22 June 2008, Moreno Marzolla wrote:
> Hi all,
>
> I recently bought a Creative Live! Cam Optia (the cheap, non-PRO, non-AF
> version) with USB id 041e:4057. I'm trying to get the camera to work
> with linux to capture outdoor images.
> I succesfully compiled the uvcvideo module (r217) both on Ubuntu 6.06LTS
> (AMD64 flavour)  and under debian 4.0 (i686) without any trouble.
> luvcview-20070512 also works great on both platforms. The camera is
> recognized and I'm able to get the video with luvcview.
> However, while the quality of indoor pictures is in my opinion very
> good, even in dark environments, outdoor pictures are severely
> overexposed and so far I have been unable to get around that.
> I'm currently working on the debian machine (debian kernel 2.6.18-6-686,
> uvcvideo r217). Just to have an idea, this is what I get with the
> default settings of the Live! Cam Optia at 640x480:
>
> http://www.dsi.unive.it/~marzolla/snapshot_optia.jpg
>
> This is the same panorama taken with my digital photo camera:
>
> http://www.dsi.unive.it/~marzolla/snapshot_ok.jpg
>
> Of course I tried to tweak the picture parameters with luvcview, but
> changing contrast and luminosity does not help, and I'm unable to set
> manual exposure (luvcview says "Set Auto Exposure off error").
> unsure whether exposure can be controlled at all with this webcam,
> because if I do:
>
> moreno at colossus:~/src/linux-uvc$ v4lctl -c /dev/video0 list
> ioctl: VIDIOC_G_STD(std=0xb7ce44c0b7c1d9ef
> [PAL_B,PAL_B1,PAL_G,PAL_H,PAL_D,PAL_D1,PAL_K,PAL_M,PAL_60,NTSC_M,?,?,SECAM_
>B,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null),(null),(null),(null),(null),
>(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null)
>,(null),(null),(null)]): Invalid argument
> attribute  | type   | current | default | comment
> -----------+--------+---------+---------+----------------------------------
>--- norm       | choice | (null)  | (null)  |
> input      | choice | Camera  | Camera  | Camera 1
> bright     | int    |      30 |      30 | range is 0 => 100
> contrast   | int    |       2 |       2 | range is 0 => 6
> color      | int    |       3 |       3 | range is 0 => 8
> hue        | int    |       0 |       0 | range is -4 => 4
> Gamma      | int    |       3 |       3 | range is 0 => 7
> Power Line | choice | 50 Hz   | Disable | Disabled 50 Hz 60 Hz
> Sharpness  | int    |      39 |      40 | range is 0 => 96
>
> I see no mention of exposure. The same happens even using luvcview:
>
> moreno at colossus:~/src/luvcview-20070512$ ./luvcview -d /dev/video0 -l
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean 3=Menu
> 4=Button)
> V4L2_CID_BASE         (predefined controls):
>   index:9963776    name:Brightness                       type:1 min:0
>    max:100   step:1     def:30    now:30
>   index:9963777    name:Contrast                         type:1 min:0
>    max:6    step:1     def:2     now:2
>   index:9963778    name:Saturation                       type:1 min:0
>    max:8    step:1     def:3     now:3
>   index:9963779    name:Hue                              type:1 min:-4
>    max:4    step:1     def:0     now:0
>   index:9963792    name:Gamma                            type:1 min:0
>    max:7    step:1     def:3     now:3
> V4L2_CID_PRIVATE_BASE (driver specific controls):
> find DRI
> find DRI
> find DRI
>
> Before going into deeper details, I would like to ask whether anybody
> has been able to get good outdoor pictures with the Creative Live! Cam
> Optia, and/or whether anybody has been able to manually set the exposure
> with the same camera.

I haven't tried the Creative Live! Cam Optia outdoor, but exposure time is 
definitely the way to go.

In theory any v4l2 application should be able to set the exposure-related 
controls. In practise very few of them can, because the involved API has 
evolved quite a lot lately.

Please install uvcdynctrl (part of the libwebcam package) from 
http://www.quickcamteam.net/software/libwebcam/. Get the SVN version, as the 
latest released package is outdated. You should then be able to use that 
command line tool to set the exposure mode and exposure time controls.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 00:25:57 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 00:25:57 +0200
Subject: [Linux-uvc-devel] Getting Webcams 0ac8:301b and 0ac8:307b to
	work under openSUSE 10.3
In-Reply-To: <200806222332.00096.homoludens1000@gmail.com>
References: <200806222332.00096.homoludens1000@gmail.com>
Message-ID: <200806240025.57966.laurent.pinchart@skynet.be>

Hi,

On Sunday 22 June 2008, homoludens wrote:
> > To find out if your cameras are UVC compliant, please check
> > http://www.quickcamteam.net/documentation/faq/how-do-i-find-out-whether-m
> >y- camera-is-a-uvc-device-or-not
> >
> > Best regards,
> >
> > Laurent Pinchart
>
> No, neither webcam seems to be UVC compliant. The relevant lines in the
> lsusb output have "255 Vendor Specific Class" rather than "14 Video".
>
> So ... this means that these cameras won't work with UVC? :-(

I'm afraid it does, sorry.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 00:33:40 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 00:33:40 +0200
Subject: [Linux-uvc-devel] Thread safety of ioctls
In-Reply-To: <485F7A42.8020605@vidsoft.de>
References: <485F7A42.8020605@vidsoft.de>
Message-ID: <200806240033.41145.laurent.pinchart@skynet.be>

Hi Gregor,

On Monday 23 June 2008, Gregor Jasny wrote:
> Hi,
>
> in our video conference application the grabbing (QBUF, DQBUF) is done
> in a separate thread. The main thread is responsible for the user
> interface and queries the controls, input and current standard values
> from time to time.
>
> With the latest uvc driver (r217) and vanilla Linux 2.6.25.6 I've
> noticed the strange behavior that the grabbing thread hangs in the DQBUF
> ioctl. If I remove the control queries from the gui thread everything is
> working fine. After the first hang of the driver, even luvcview hangs at
> the buffer operation.
>
> With the bttv driver everything works fine. I'll test vivi and pwc
> driver later.
>
> My systems are a i686 and one amd64 system with one Logitech 9000 and
> one Microsoft NX-6000. I've tried to create a simple testcase, but
> suprinsingly this testcase works fine.
>
> Can I enable more logging than setting the trace parameter to 0xfff?

No without adding more printk's to the driver, which I encourage you to do.

> Have you any idea what went wrong here?

Not really. The ioctl handler is protected by the big kernel lock, so ioctls 
are currently not reentrant.

Could you give more information about the hardware you are using (webcam, SMP 
system) ? Please report kernel log message printed by the UVC driver as well.

> Is the V4L2-API designed to be thread safe?

There is no mention of thread safety in the V4L2 spec, so one can always argue 
that thread safety is not required for V4L2 drivers :-)

Most drivers are probably not designed with thread safety in mind, and I'm 
pretty sure lots of race conditions still lie in the depth of V4L(2) drivers. 
In the long term all those bugs should be fixed, and drivers should support 
multi-threaded applications without crashing or misbehaving.

Best regards,

Laurent Pinchart


From moreno.marzolla at pd.infn.it  Tue Jun 24 11:51:12 2008
From: moreno.marzolla at pd.infn.it (Moreno Marzolla)
Date: Tue, 24 Jun 2008 11:51:12 +0200
Subject: [Linux-uvc-devel] Over-exposed outdoor images with Creative
 Live! Cam Optia
In-Reply-To: <200806240025.30503.laurent.pinchart@skynet.be>
References: <485E2059.6080905@pd.infn.it>
	<200806240025.30503.laurent.pinchart@skynet.be>
Message-ID: <4860C390.4060308@pd.infn.it>

Laurent Pinchart wrote:
> Hi Moreno,
[...]
> I haven't tried the Creative Live! Cam Optia outdoor, but exposure time is 
> definitely the way to go.
> 
> In theory any v4l2 application should be able to set the exposure-related 
> controls. In practise very few of them can, because the involved API has 
> evolved quite a lot lately.
> 
> Please install uvcdynctrl (part of the libwebcam package) from 
> http://www.quickcamteam.net/software/libwebcam/. Get the SVN version, as the 
> latest released package is outdated. You should then be able to use that 
> command line tool to set the exposure mode and exposure time controls.

Hi Laurent,

thank you for the info; indeed I tried to compile the released package 
but was unsuccesful. I will try again with the SVN version.
However, today I tried the Optia with a Windows machine, where the 
exposure control is available and can be manually overriden. 
Unfortunately, it seems that images under bright sunlight are 
overexposed also at the minimum exposure value.
So, the camera was actually (automatically) adjusting for the minimum 
exposure when I tried it under linux, but this is not enough. Probably 
the camera sensor is somehow "optimized" for low light conditions. I'll 
try to get a different model, or maybe I will just try to put some 
filter in front of it...

Thanks again,

Moreno.

-- 
Moreno Marzolla
INFN Sezione di Padova,    via Marzolo 8,   35131 PADOVA,  Italy
EMail: moreno.marzolla at pd.infn.it         Phone: +39 049 8277103
WWW  : http://www.dsi.unive.it/~marzolla  Fax  : +39 049 8756233



From ml.mildred593 at online.fr  Tue Jun 24 13:03:56 2008
From: ml.mildred593 at online.fr (Mildred)
Date: Tue, 24 Jun 2008 13:03:56 +0200
Subject: [Linux-uvc-devel] iSight problem
In-Reply-To: <200806240018.21717.laurent.pinchart@skynet.be>
References: <20080621232848.08393af6@kylae>
	<200806240018.21717.laurent.pinchart@skynet.be>
Message-ID: <20080624130356.5221aacd@kylae>

Thanks for your answer :)

Le Tue 24/06/2008 ? 00:18 Laurent Pinchart ? ?crit:
> bInterfaceClass should be set to '14 Video'. This means your firmware
> hasn't been patched.

Well, there are three different interface descriptors, and one of these
have the correct bInterfaceClass:

    Interface Descriptor:
      ...
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      ...
    Interface Descriptor:
      ...
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      ...
    Interface Descriptor:
      ...
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 


> > Do you have any ideas about this problem ?
> > Some months ago, my webcam worked with a driver derived from
> > uvcvideo. but that was with the previous kernel. Now it no longer
> > compiles.  
> 
> Try to upgrade the firmware extractor/loader. It should patch your
> firmware to make it compatible with the UVC driver.


I tried the iSight firmware tools version 1.2 with two different
firmwares. Their MD5 sums are:

	8b78709d02d3584f40cc041db9eecfe8  An old version
	28da1ad8c1e468d8533eca68853f0d40  My current Mac OS X version

And i also booted from Mac OS X, used the webcam and then rebooted
Linux. it should have loaded the firmware corectly, but I didn't have
any more success.

ift-extract -a shows to me:

** Message: Found Mac OS X.4 intel driver
** Message: Firmware extracted successfully in /lib/firmware/isight.fw
** Message: Apply patch 0 : Fix video control interface descriptor
** Message: Apply patch 1 : Fix video streaming interface descriptor
** Message: Apply patch 2 : Fix video streaming device qualifier
** Message: Firmware patched successfully

and

** Message: Found Mac OS X.5.1 driver
** Message: Firmware extracted successfully in /lib/firmware/isight.fw
** Message: Apply patch 0 : Fix video control interface descriptor
** Message: Apply patch 1 : Fix video streaming interface descriptor
** Message: Apply patch 2 : Fix video streaming device qualifier
** Message: Firmware patched successfully

So, do you think the firmware is correctly loaded or not?

In the meantime, I was looking at the driver source code (mainly
ucv_driver.c), and I just discovered that the iSight webcam was referred
as:

	/* Apple Built-In iSight */
	{ .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
				| USB_DEVICE_ID_MATCH_INT_INFO,
	  .idVendor		= 0x05ac,
	  .idProduct		= 0x8501,
	  .bInterfaceClass      = USB_CLASS_VIDEO,
	  .bInterfaceSubClass   = 1,
	  .bInterfaceProtocol   = 0,
	  .driver_info 		= UVC_QUIRK_PROBE_MINMAX
				| UVC_QUIRK_BUILTIN_ISIGHT },

And that my bInterfaceSubClass was 2 instead of 1. Changing that in the
driver doesn't seems to help. When I load the driver (trace=255), I
don't get any probe message.

I think i'll have to find some documentation about the USB interface in
the Linux kernel.

I'd be glad if someone can find a solution to that issue.

Thanks for any help

Mildred

-- 
Mildred Ki'lya
E-Mail:	mildred593(at)online.fr

Site:	<http://mildred632.free.fr/>
XMPP:	<mildred at jabber.fr> (GoogleTalk, Jabber)

GPG:	197C A7E6 645B 4299 6D37 684B 6F9D A8D6 [9A7D 2E2B]


From arjos85 at gmail.com  Tue Jun 24 15:29:53 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Tue, 24 Jun 2008 15:29:53 +0200
Subject: [Linux-uvc-devel] [HOW-TO] Upside-down image from UVC webcam
Message-ID: <879e1f2b0806240629l4556511br4fb2d2cb5bc0b29d@mail.gmail.com>

Hi everybody,
I wrote a very quick HOW-TO in order to solve the problem of those webcams
mounted upside-down on laptop!!!
I've just added few lines in one function of the UVCVIDEO driver!!
But it will work only for those webcams who use YUV image format (in
particular YUY2)!!
Obiously the webcam has to be UVC capable !! ;)

However in this HOW-TO you won't find patches, but just the whole code of
the modded function (however it is a very short function).
I know patches should be more usefull, but I know also the most of the
people have problems just in reading an HOW-TO...
so why make things more difficults? ;)


You can find this HOW-TO here:
http://ubuntuforums.org/showthread.php?p=5244475#post5244475

There are 2 solutions: the first with memory allocation and the second
without allocation.
For both this solutions there are 2 variant: with or without MIRRORED
images!! ;)

So you are free to choose which is the best solution for you!!

Please let me know if you think I made some mistakes or if you have some
suggestions!!

Regards,

Marco Argiolas

ps.
For the Italian guys is also available an Italian HOW-TO, that sincerely is
more detailed and complete!!
Just have a look here:
http://forum.ubuntu-it.org/index.php/topic,199106.msg1326411.html#msg1326411

pps.
Just a question to *Laurent Pinchart:*
in uvc_video.c in function "uvc_video_decode_data()" I think it should be
better to change the condition of the last "if":

if (len > maxlen) {
		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
		buf->state = UVC_BUF_STATE_DONE;
}

into
"if (len >= maxlen)"
What do you think?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080624/50e6a6c5/attachment.html>

From laurent.pinchart at skynet.be  Tue Jun 24 23:08:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 23:08:35 +0200
Subject: [Linux-uvc-devel] iSight problem
In-Reply-To: <20080624130356.5221aacd@kylae>
References: <20080621232848.08393af6@kylae>
	<200806240018.21717.laurent.pinchart@skynet.be>
	<20080624130356.5221aacd@kylae>
Message-ID: <200806242308.35349.laurent.pinchart@skynet.be>

Hi Mildred,

On Tuesday 24 June 2008, Mildred wrote:
> Thanks for your answer :)
>
> Le Tue 24/06/2008 ? 00:18 Laurent Pinchart ? ?crit:
> > bInterfaceClass should be set to '14 Video'. This means your firmware
> > hasn't been patched.
>
> Well, there are three different interface descriptors, and one of these
> have the correct bInterfaceClass:
>
>     Interface Descriptor:
>       ...
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       ...
>     Interface Descriptor:
>       ...
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       ...
>     Interface Descriptor:
>       ...
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0

They should all have bInterfaceClass set to '14 Video'. The first interface 
should have bInterfaceSubClass set to '1 Video Control' and the second to '2 
Video Streaming'.

> > > Do you have any ideas about this problem ?
> > > Some months ago, my webcam worked with a driver derived from
> > > uvcvideo. but that was with the previous kernel. Now it no longer
> > > compiles.
> >
> > Try to upgrade the firmware extractor/loader. It should patch your
> > firmware to make it compatible with the UVC driver.
>
> I tried the iSight firmware tools version 1.2 with two different
> firmwares. Their MD5 sums are:
>
> 	8b78709d02d3584f40cc041db9eecfe8  An old version
> 	28da1ad8c1e468d8533eca68853f0d40  My current Mac OS X version
>
> And i also booted from Mac OS X, used the webcam and then rebooted
> Linux. it should have loaded the firmware corectly, but I didn't have
> any more success.

That won't work. You need to load a modified firmware, patched by ift-extract.

> ift-extract -a shows to me:
>
> ** Message: Found Mac OS X.4 intel driver
> ** Message: Firmware extracted successfully in /lib/firmware/isight.fw
> ** Message: Apply patch 0 : Fix video control interface descriptor
> ** Message: Apply patch 1 : Fix video streaming interface descriptor
> ** Message: Apply patch 2 : Fix video streaming device qualifier
> ** Message: Firmware patched successfully
>
> and
>
> ** Message: Found Mac OS X.5.1 driver
> ** Message: Firmware extracted successfully in /lib/firmware/isight.fw
> ** Message: Apply patch 0 : Fix video control interface descriptor
> ** Message: Apply patch 1 : Fix video streaming interface descriptor
> ** Message: Apply patch 2 : Fix video streaming device qualifier
> ** Message: Firmware patched successfully
>
> So, do you think the firmware is correctly loaded or not?

I don't know. You should contact the ift-extract author for help.

> In the meantime, I was looking at the driver source code (mainly
> ucv_driver.c), and I just discovered that the iSight webcam was referred
> as:
>
> 	/* Apple Built-In iSight */
> 	{ .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
>
> 				| USB_DEVICE_ID_MATCH_INT_INFO,
>
> 	  .idVendor		= 0x05ac,
> 	  .idProduct		= 0x8501,
> 	  .bInterfaceClass      = USB_CLASS_VIDEO,
> 	  .bInterfaceSubClass   = 1,
> 	  .bInterfaceProtocol   = 0,
> 	  .driver_info 		= UVC_QUIRK_PROBE_MINMAX
>
> 				| UVC_QUIRK_BUILTIN_ISIGHT },
>
> And that my bInterfaceSubClass was 2 instead of 1. Changing that in the
> driver doesn't seems to help. When I load the driver (trace=255), I
> don't get any probe message.

bInterfaceSubClass shouldn't be changed. 1 is the right value. As explained 
above, the first two interfaces look wrong.

> I think i'll have to find some documentation about the USB interface in
> the Linux kernel.
>
> I'd be glad if someone can find a solution to that issue.

I don't own any Mac so I can't really help you on this one. You should ocntact 
the ift-extract author.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 23:34:43 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 23:34:43 +0200
Subject: [Linux-uvc-devel] Thread safety of ioctls
In-Reply-To: <20080624133951.GA9910@devserv.devel.redhat.com>
References: <485F7A42.8020605@vidsoft.de>
	<200806240033.41145.laurent.pinchart@skynet.be>
	<20080624133951.GA9910@devserv.devel.redhat.com>
Message-ID: <200806242334.44102.laurent.pinchart@skynet.be>

On Tuesday 24 June 2008, Alan Cox wrote:
> On Tue, Jun 24, 2008 at 12:33:40AM +0200, Laurent Pinchart wrote:
> > Not really. The ioctl handler is protected by the big kernel lock, so
> > ioctls are currently not reentrant.
>
> Not so - the BKL drops on sleeping so any ioctl that sleeps is re-entrant.

Thanks for the information.

> Any code using locks of its own should be dropping their lock before any
> long sleeps.

How long is a long sleep ?

The UVC driver uses five mutexes:

- to guard against the open()/disconnect() race
- to serialize access to the global controls list
- to serialize access to device controls
- to serialize streaming format negotiation
- to serialize access to the video buffers queue

Access to device controls shouldn't take more than 10ms, unless the device is 
buggy in which case the URB will timeout after 300ms. Likewise, streaming 
format negotiation shouldn't sleep for more than a few dozens of 
milliseconds.

The video buffers queue mutex is taken when performing the following 
operations:

- buffer allocation/deallocation
- buffer query (VIDIOC_QUERYBUF)
- buffer enqueuing and dequeuing (VIDIO_QBUF and VIDIOC_DQBUF)
- buffer queue activation and deactivation (VIDIOC_STREAMON and
  VIDIOC_STREAMOFF, release(), system resume)
- poll()
- mmap()
- release()

Buffer dequeuing can sleep for a longer time than most other operations, as it 
waits for a video buffer to be ready. However, no other operation from the 
above list should be performed while a VIDIOC_DQBUF is in progress.

Does this make sense, or is there a place where I should try to drop a lock 
before sleeping ?

> > Most drivers are probably not designed with thread safety in mind, and
> > I'm pretty sure lots of race conditions still lie in the depth of V4L(2)
> > drivers.
>
> From looking at the BKL dropping work that would unfortunately seem to be
> the case for some drivers

Getting locking right is very difficult. I spent a lot of time checking corner 
cases when developing the driver, and I'm pretty sure a few race conditions 
still exist, especially when then ioctl code will not be covered by the BKL 
anymore. I would greatly appreciate anyone reviewing the patch I will post 
soon to get the UVC driver included in the mainline kernel for race 
conditions and locking issues.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 23:42:33 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 23:42:33 +0200
Subject: [Linux-uvc-devel] [HOW-TO] Upside-down image from UVC webcam
In-Reply-To: <879e1f2b0806240629l4556511br4fb2d2cb5bc0b29d@mail.gmail.com>
References: <879e1f2b0806240629l4556511br4fb2d2cb5bc0b29d@mail.gmail.com>
Message-ID: <200806242342.33853.laurent.pinchart@skynet.be>

Hi Marco,

On Tuesday 24 June 2008, Marco Argiolas wrote:
> Hi everybody,
> I wrote a very quick HOW-TO in order to solve the problem of those webcams
> mounted upside-down on laptop!!!
> I've just added few lines in one function of the UVCVIDEO driver!!
> But it will work only for those webcams who use YUV image format (in
> particular YUY2)!!
> Obiously the webcam has to be UVC capable !! ;)
>
> However in this HOW-TO you won't find patches, but just the whole code of
> the modded function (however it is a very short function).
> I know patches should be more usefull, but I know also the most of the
> people have problems just in reading an HOW-TO...
> so why make things more difficults? ;)

Because people will crash their kernel as soon as I release a new driver 
version if you don't provide a patch. If a new driver version includes 
changes in uvc_video.c, users will blindly overwrite them by replacing the 
driver-supplied uvc_video.c with your version. A patch can still suffer from 
the same problem, but it will likely not apply if changes are made to the 
sections you modify.

> You can find this HOW-TO here:
> http://ubuntuforums.org/showthread.php?p=5244475#post5244475
>
> There are 2 solutions: the first with memory allocation and the second
> without allocation.
> For both this solutions there are 2 variant: with or without MIRRORED
> images!! ;)
>
> So you are free to choose which is the best solution for you!!
>
> Please let me know if you think I made some mistakes or if you have some
> suggestions!!
>
> Regards,
>
> Marco Argiolas
>
> ps.
> For the Italian guys is also available an Italian HOW-TO, that sincerely is
> more detailed and complete!!
> Just have a look here:
> http://forum.ubuntu-it.org/index.php/topic,199106.msg1326411.html#msg132641
>1
>
> pps.
> Just a question to *Laurent Pinchart:*
> in uvc_video.c in function "uvc_video_decode_data()" I think it should be
> better to change the condition of the last "if":
>
> if (len > maxlen) {
> 		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
> 		buf->state = UVC_BUF_STATE_DONE;
> }
>
> into
> "if (len >= maxlen)"
> What do you think?

Please don't change that. That test is meant to detect an overflow which 
should not happen. The common case is handled either by 
uvc_video_decode_end() detecting an EOF condition, or 
uvc_video_decode_start() detecting the FID bit being toggled.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jun 24 23:55:36 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 24 Jun 2008 23:55:36 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806201024w7a4adb04ld54042895614798e@mail.gmail.com>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
	<200806201332.29045.laurent.pinchart@skynet.be>
	<879e1f2b0806201024w7a4adb04ld54042895614798e@mail.gmail.com>
Message-ID: <200806242355.37075.laurent.pinchart@skynet.be>

Hi Marco,

On Friday 20 June 2008, Marco Argiolas wrote:
> Hi Richard,
>
> > You shouldn't have allocated extra memory in the first place. Instead of
> > modifying the whole frame at once, you should instead replace the call to
> > memcpy() in uvc_video_decode_data() and revert the image there.
> > Computation of boundaries and memory offsets might be a bit more
> > difficult, but you will
> > speed up the process and you'll avoid allocating an extra buffer.
>
> Thank you for this suggestion,
> I haven't thought about this solution before.
>
> > The purpose of GFP_ATOMIC is not to speed up memory allocation, but to
> > make sure that memory allocation will not sleep. This is required here, as
> > uvc_video_decode_data() is called in interrupt context where you're not
> > allowed to sleep.
>
> So, in this way I'm sure memory allocation won't sleep and I can say it is
> the fastest way (and also the only one suggested in this case)  to allocate
> memory. Is it right?

A call to kmalloc with GFP_ATOMIC will probably faster than with GFP_KERNEL 
(although I'm not sure there are not some corner cases where the second could 
be faster than the first). This is however not the reason why you can't use 
GFP_KERNEL here: code running in interrupt context is not allowed to sleep, 
so must use GFP_ATOMIC. This is not a speed issue.

> > As explained above, you should modify the existing memcpy() instead of
> > adding a new one. The statement your mention will then not have to be
> > modified. 
>
> Here it is the new patch of "uvc_video_decode_data()" (I was going crazy
> with the computation of all offset) and as attachement you can find the
> modded "uvc_video.c" file:
>
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>
> $ diff -u original modded
> --- original    2008-06-20 19:15:28.000000000 +0200
> +++ modded      2008-06-20 19:11:31.000000000 +0200
> @@ -4,6 +4,11 @@
>         struct uvc_video_queue *queue = &video->queue;
>         unsigned int maxlen, nbytes;
>         void *mem;
> +       unsigned int
> +               pixel_size,
> +               to_be_copied,
> +               shift_right,
> +               buf_offset;
>
>         if (len <= 0)
>                 return;
> @@ -12,11 +17,29 @@
>         maxlen = buf->buf.length - buf->buf.bytesused;
>         mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
>         nbytes = min((unsigned int)len, maxlen);
> -       memcpy(mem, data, nbytes);
> -       buf->buf.bytesused += nbytes;
>
> -       if (len > maxlen) {
> +       pixel_size = video->streaming->cur_frame->wWidth *
> video->streaming->format->bpp / 8;

pixel_size is misnamed as it stores the size of a whole length of video data.

> +       to_be_copied = 0;
> +       while( nbytes > 0 ) { // Are there other bytes to be copied?

Please respect the kernel coding style (Documentation/CodingStyle). Don't put 
spaces inside parentheses, add a space between 'while' and the opening 
parenthesis, don't put any statement on the same line as the 'else' keyword 
and keep you code 80 characters wide.

> +               shift_right = buf->buf.bytesused % pixel_size;
> +               if ( nbytes > pixel_size - shift_right)
> +                       to_be_copied = pixel_size - shift_right ;
> +               else    to_be_copied = nbytes;
> +
> +               if (shift_right > 0 )
> +                       buf_offset = to_be_copied - shift_right ;
> +               else    buf_offset = pixel_size;
> +               memcpy( queue->mem + buf->buf.m.offset + pixel_size *
> video->streaming->cur_frame->wHeight - buf->buf.bytesused - buf_offset,
> +                       data,
> +                       to_be_copied ) ;

If I'm not mistaken this will only work when the data packets contain entire 
lines of image data. This is not guaranteed. To reverse the image you 
shouldn't use memcpy but instead roll your own memcpy version that will 
decrement the destination pointer instead of incrementing it. It shouldn't be 
more complex than that. Just fill the video buffer backwards starting at the 
end instead of forward starting at the beginning.

> +
> +               data += to_be_copied;
> +               buf->buf.bytesused += to_be_copied ;

In the end all of nbytes will have been copied, so you can increment 
buf->buf.bytesused in one go outside the loop.

> +               nbytes -= to_be_copied;
> +       }
>
> +       if (len >= maxlen) {

Don't modify this (see my previous e-mail).

>                 uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
>                 buf->state = UVC_BUF_STATE_DONE;
>         }
>
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>
> Unluckly also if now I don't allocate any memory, with bigger resolutions
> the final video seems to be a little bit slower than with the allocation
> (previous solution).

Can you benchmark that ? I haven't 

> Please if you can/need try both my solutions and let me know your
> results!!! Which one is the fastest?
> Please let also me know if you think I made some mistakes that slow down
> this last version of uvcvideo without memory allocation.
>
> Thank you a lot for your help!!
>
> Marco Argiolas




From laurent.pinchart at skynet.be  Wed Jun 25 00:04:48 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Jun 2008 00:04:48 +0200
Subject: [Linux-uvc-devel] Thread safety of ioctls
In-Reply-To: <20080624183601.235ff1d5@gaivota>
References: <485F7A42.8020605@vidsoft.de>
	<200806240033.41145.laurent.pinchart@skynet.be>
	<20080624183601.235ff1d5@gaivota>
Message-ID: <200806250004.48989.laurent.pinchart@skynet.be>

On Tuesday 24 June 2008, Mauro Carvalho Chehab wrote:
> > > Can I enable more logging than setting the trace parameter to 0xfff?
> >
> > No without adding more printk's to the driver, which I encourage you to
> > do.
>
> This would be one advantage of having uvc driver using video_ioctl2. to see
> ioctl's it is just a matter of using debug=1. If you use debug=3, you'll
> also view all arguments of the ioctl.

That won't happen. Anyway, the UVC driver already prints out ioctl trace 
messages to the kernel if you set the trace parameter high enough. Gregor was 
asking for more debugging output than that.

> PS.: I'm still waiting for uvc patches for its kernel addition.

I've received all the feedback and review I'll probably get, so I'll send a 
new patch this week with the latest driver.

I've addressed some of your comments (such as not using enums at userspace 
interface). What is the rationale behind not having userspace and kernelspace 
APIs in a single .h file ? If I'm not mistaken kernel headers are stripped 
from their #ifdef __KERNEL__ sections but distributions anyway. It makes 
sense to have separate headers when they become big enough, but I don't think 
that's the case for a single driver like this one.

Cheers,

Laurent Pinchart


From mchehab at infradead.org  Tue Jun 24 23:36:01 2008
From: mchehab at infradead.org (Mauro Carvalho Chehab)
Date: Tue, 24 Jun 2008 18:36:01 -0300
Subject: [Linux-uvc-devel] Thread safety of ioctls
In-Reply-To: <200806240033.41145.laurent.pinchart@skynet.be>
References: <485F7A42.8020605@vidsoft.de>
	<200806240033.41145.laurent.pinchart@skynet.be>
Message-ID: <20080624183601.235ff1d5@gaivota>

> > Can I enable more logging than setting the trace parameter to 0xfff?
> 
> No without adding more printk's to the driver, which I encourage you to do.

This would be one advantage of having uvc driver using video_ioctl2. to see
ioctl's it is just a matter of using debug=1. If you use debug=3, you'll also
view all arguments of the ioctl.

Cheers,
Mauro

PS.: I'm still waiting for uvc patches for its kernel addition.


From bruno.viaris at free.fr  Wed Jun 25 00:45:21 2008
From: bruno.viaris at free.fr (Bruno Viaris)
Date: Wed, 25 Jun 2008 00:45:21 +0200
Subject: [Linux-uvc-devel] Frame dropping in Logitech raw bayer mode
Message-ID: <48617901.5040203@free.fr>


Hi,

I try to get raw bayer mode working with a Quickcam Pro for Notebooks
(046d:0991).
I activate this function with the following command:

uvcdynctrl -d /dev/video1 -s "Disable video processing" 1

then I can get the raw frames (frame???.raw) on disk with
luvcview -d /dev/video1 -f yuv -s 1600x1200 -C

That worked fine until uvcvideo driver svn revision 207, where a test
was introduced to drop frames if their length is different from the
expected size:

>
> --- linux-uvc-206/uvc_v4l2.c    2008-06-22 22:00:57.000000000 +0200
>
> +               video->queue.drop_incomplete =
> +                       video->streaming->cur_format->flags &
> +                               UVC_FMT_FLAG_COMPRESSED ? 0 : 1;
> +
>
>
> --- linux-uvc-206/uvc_queue.c   2008-06-22 22:00:57.000000000 +0200
> +       if (queue->drop_incomplete && buf->buf.length !=
> buf->buf.bytesused) {
> +               buf->state = UVC_BUF_STATE_QUEUED;
> +               buf->buf.bytesused = 0;
> +               return buf;
> +       }
=> if the video format is not "COMPRESSED", and a frame has not the
expected length, drop it!

The problem is that my webcam is switched to raw mode without the driver
being aware of it, and that the 8bpp bayer frames are half the size of
YUV frames, so they all get dropped.
A partial solution is to ask the driver for MJPG frames -> deactivates
drop_incomplete, but the maximum resolution is then limited to 960x720,
and I'd like to get the full frame.

I am rather new to webcam and kernel-module programming, so I am not
sure of what is the correct approach to this problem:
- should this "drop_incomplete" function be deactivable through an ioctl ?
- should logitech bayer mode be treated like "YUV2" or "MJPG" and be
activated by the VIDIOC_S_FMT ioctl with "BYR8"?
- should the driver recognize the "Disable video processing" dynamic
control and deactivate drop_incomplete ?
- something else ?

Any advice is welcome...

    Bruno

PS:
For anyone interested, as a workaround I have added a quirk to disable
this "drop_incomplete" feature,
activate with "modprobe uvcvideo quirks=0x80000000"
------------------------------------
diff -u linux-uvc-217/uvc_v4l2.c linux-uvc-217b/uvc_v4l2.c
--- linux-uvc-217/uvc_v4l2.c    2008-06-24 23:01:57.000000000 +0200
+++ linux-uvc-217b/uvc_v4l2.c   2008-06-23 00:31:24.000000000 +0200
@@ -846,6 +846,7 @@
                if (ret < 0)
                        return ret;

+               if (!(video->dev->quirks &
UVC_QUIRK_DISABLE_DROP_INCOMPLETE))
                if (!(video->streaming->cur_format->flags &
                    UVC_FMT_FLAG_COMPRESSED))
                        video->queue.flags |= UVC_QUEUE_DROP_INCOMPLETE;
diff -u linux-uvc-217/uvcvideo.h linux-uvc-217b/uvcvideo.h
--- linux-uvc-217/uvcvideo.h    2008-06-24 23:01:57.000000000 +0200
+++ linux-uvc-217b/uvcvideo.h   2008-06-24 01:10:56.000000000 +0200
@@ -309,6 +309,7 @@
 #define UVC_CTRL_STREAMING_TIMEOUT     1000

 /* Devices quirks */
+#define UVC_QUIRK_DISABLE_DROP_INCOMPLETE 0x80000000
 #define UVC_QUIRK_STATUS_INTERVAL      0x00000001
 #define UVC_QUIRK_PROBE_MINMAX         0x00000002
 #define UVC_QUIRK_PROBE_EXTRAFIELDS    0x00000004
--------------------------------------------------------------







From emmanuel at libera.cc  Wed Jun 25 22:15:34 2008
From: emmanuel at libera.cc (Emmanuel Kasper)
Date: Wed, 25 Jun 2008 22:15:34 +0200
Subject: [Linux-uvc-devel] Vendor support in linux-uvc development
In-Reply-To: <200806240009.17677.laurent.pinchart@skynet.be>
References: <485B7B91.2090608@libera.cc>
	<200806240009.17677.laurent.pinchart@skynet.be>
Message-ID: <4862A766.5000500@libera.cc>

Hello Laurent

> Among those cameras I've only tested the Creative and Logitech webcams 
> personally. You shouldn't list the Logitech QuickCam Fusion, as it has a bad 
> firmware bug that makes Linux support unreliable.
> 
> Check http://www.quickcamteam.net/hcl/linux/logitech-webcams for more 
> information about Logitech webcams.

Ok thanks for info, I will remove the QuickCam Fusion. I see also
according to http://www.quickcamteam.net/hcl/linux/logitech-webcams that
this device is not stricly uvc compatible.

>> We would be also interested to indicate on each product description, if
>> the vendor of the product, or the chipset maker for that matters had
>> been helpful with developers trying to write a free driver. So for the
>> devices mentionned above, was any of the vendor helpful by providing
>> programming documentation or hardware ?
>>
>> If yes we will mention it on the product description with an extra tag
>> like "programmer friendly".
> 
> I asked Microsoft for hardware samples and they simply ignored my request. 
> Nothing surprising there, although I've heard from another developer that it 
> largely depends on who you contact in the company.
> 
> I haven't had any contact with Hercules.
> 
> Creative Labs offered a free Optia webcam. My contact there was very friendly, 
> and welcomed the Linux UVC driver project.
> 
> Logitech has proved the most supportive so far. I've received hardware samples 
> and documentation. They set up a community website at 
> http://www.quickcamteam.net/ for Linux, Mac OS X and Windows users and 
> developers. You can definitely flag them as programmer friendly and Linux 
> friendly, at least for their webcam department.

Thank you this is exactly the kind of information I was looking for. I
will then label Logitech and Creative Labs as "programmer friendly" for
the webcams we reference.


-- 
Emmanuel Kasper
System Administrator
www.libera.cc
Find, compare, buy Linux & FreeBSD compatible hardware


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 252 bytes
Desc: OpenPGP digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080625/14dfba83/attachment.pgp>

From arjos85 at gmail.com  Thu Jun 26 16:14:49 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Thu, 26 Jun 2008 16:14:49 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <879e1f2b0806250503g1ad1809ak5332f20ba63074f8@mail.gmail.com>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
	<200806201332.29045.laurent.pinchart@skynet.be>
	<879e1f2b0806201024w7a4adb04ld54042895614798e@mail.gmail.com>
	<200806242355.37075.laurent.pinchart@skynet.be>
	<879e1f2b0806250503g1ad1809ak5332f20ba63074f8@mail.gmail.com>
Message-ID: <879e1f2b0806260714p2bdb4202w992814ec8041e476@mail.gmail.com>

2008/6/24 Laurent Pinchart <laurent.pinchart at skynet.be>:

> A call to kmalloc with GFP_ATOMIC will probably faster than with GFP_KERNEL
> (although I'm not sure there are not some corner cases where the second
> could
> be faster than the first). This is however not the reason why you can't use
> GFP_KERNEL here: code running in interrupt context is not allowed to sleep,
> so must use GFP_ATOMIC. This is not a speed issue.
>

Thank you for the explaination, now it is more clear!! ;)


> pixel_size is misnamed as it stores the size of a whole length of video
> data.
>

You are right...I'm going to change "pixel_size" into "line_size"!!


> > +       to_be_copied = 0;
> > +       while( nbytes > 0 ) { // Are there other bytes to be copied?
>
> Please respect the kernel coding style (Documentation/CodingStyle). Don't
> put
> spaces inside parentheses, add a space between 'while' and the opening
> parenthesis, don't put any statement on the same line as the 'else' keyword
> and keep you code 80 characters wide.
>

Really really thank you for informing me about that!! As you know it is the
first time I work on kernel, modules and driver!! ;)


> > +               shift_right = buf->buf.bytesused % pixel_size;
> > +               if ( nbytes > pixel_size - shift_right)
> > +                       to_be_copied = pixel_size - shift_right ;
> > +               else    to_be_copied = nbytes;
> > +
> > +               if (shift_right > 0 )
> > +                       buf_offset = to_be_copied - shift_right ;
> > +               else    buf_offset = pixel_size;
> > +               memcpy( queue->mem + buf->buf.m.offset + pixel_size *
> > video->streaming->cur_frame->wHeight - buf->buf.bytesused - buf_offset,
> > +                       data,
> > +                       to_be_copied ) ;
>
> If I'm not mistaken this will only work when the data packets contain
> entire
> lines of image data. This is not guaranteed.
>

No you are wrong, I've considered that case. ;) The algorithm works fine
because I've already tested it!!
But also because I've just tested your driver with luvcview and different
solution and I found out that:
- the function above is called about 1040 times for a 1280x1024 resolution;
- each time "len" is not the same and it's not sure len is a multiple of the
size of an entire line of  image;
- "data" stores information about a sequence of pixel, and quite never this
sequence starts from a pixel on the left edge of the image and ends on a
pixel on the right edge.
So, when I was working on the algorithm I had in mind all this stuff!! ;)


> To reverse the image you
> shouldn't use memcpy but instead roll your own memcpy version that will
> decrement the destination pointer instead of incrementing it. It shouldn't
> be
> more complex than that. Just fill the video buffer backwards starting at
> the
> end instead of forward starting at the beginning.
>

Why should I do that? What will change? The algorithm already start to fill
the "mem" buffer starting from the end of the image memory area.
My algorithm just reverse the image, but gives back a mirrored one because
it reverse the order of image lines.
However I also made a new version that gives back not mirrored images (
http://ubuntuforums.org/showthread.php?t=838210)


> > +
> > +               data += to_be_copied;
> > +               buf->buf.bytesused += to_be_copied ;
>
> In the end all of nbytes will have been copied, so you can increment
> buf->buf.bytesused in one go outside the loop.
>

Yes I know, but I increment byteused each loop because this value is used in
the memcpy()


> > +       if (len >= maxlen) {
>
> Don't modify this (see my previous e-mail).
>

Ok, thanks for the suggestion!! ;)


> > Unluckly also if now I don't allocate any memory, with bigger resolutions
> > the final video seems to be a little bit slower than with the allocation
> > (previous solution).
>
> Can you benchmark that ? I haven't
>

Have you any ideas about how I can do a benchmark?

Thank you for your help!!! ;)

Regards

Marco Argiolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080626/88a25503/attachment.html>

From arjos85 at gmail.com  Thu Jun 26 16:26:05 2008
From: arjos85 at gmail.com (Marco Argiolas)
Date: Thu, 26 Jun 2008 16:26:05 +0200
Subject: [Linux-uvc-devel] SOLVED: upside-down image from SONIX laptop
	embedded webcam
In-Reply-To: <200806242355.37075.laurent.pinchart@skynet.be>
References: <879e1f2b0806171214u4b553bf8t6771a356536936ca@mail.gmail.com>
	<200806201332.29045.laurent.pinchart@skynet.be>
	<879e1f2b0806201024w7a4adb04ld54042895614798e@mail.gmail.com>
	<200806242355.37075.laurent.pinchart@skynet.be>
Message-ID: <879e1f2b0806260726i1e097b3ei9d81159bd9ec3fe3@mail.gmail.com>

Hey Laurent,
I've tried to follow all your suggestion, I hope I didn't any mistakes.

However you can find the updated HOW-TO always here:
http://ubuntuforums.org/showthread.php?t=838210

I did the following changes:
- used PATCHES instead of the source of the modded function;
- I've tried to speed up for the solutions with memory allocation, just
allocating half the size of a frame;
- I've rolled back the last "if (len >= maxlen)" to "if (len > maxlen)";
- I've deleted some variable that where not needed;
- in the solutions without allocation, I've modified a little bit the
"filosofy" on counting the offset where to copy data. In this way it should
be more clear to understand;
- added a complete explaination of the code with a lot of comments (I hope
they are clear and meaningful).

I hope all these changes can help the final users and make the code more
clear!!  ;)

If you have any other suggestions...please let me know!!

Thank you,
Regards

Marco Argiolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080626/7e89c875/attachment.html>

From aneeska2k5 at gmail.com  Thu Jun 26 17:20:45 2008
From: aneeska2k5 at gmail.com (aneeskA)
Date: Thu, 26 Jun 2008 20:50:45 +0530
Subject: [Linux-uvc-devel] Omnivision OV7141 -ECX linux driver
Message-ID: <55c794f10806260820y226b4a77nff93f82dc71dfc58@mail.gmail.com>

Hi,

   Can anyone please tell me where can i get *linux* driver for my *Omni
vision camera - OV7141 - ECX* ?

thanks and regards

-- anees
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080626/5cea3322/attachment.html>

From jasny at vidsoft.de  Thu Jun 26 21:48:04 2008
From: jasny at vidsoft.de (Gregor Jasny)
Date: Thu, 26 Jun 2008 21:48:04 +0200
Subject: [Linux-uvc-devel] Driver hangs at DQBUF ioctl
In-Reply-To: <200806240033.41145.laurent.pinchart@skynet.be>
References: <485F7A42.8020605@vidsoft.de>
	<200806240033.41145.laurent.pinchart@skynet.be>
Message-ID: <20080626194804.GB18818@vidsoft.de>


Hi all,

this got a somewhat lengthy bugreport. Some words to my environment:

These traces were produced on a Core2Duo (in amd64 mode) with a ASUS P5B board and
vanilla Linux 2.6.25.8. I observed the same behavior on a 32bit QuadCore with a
Logitech 9000 and Linux 2.6.25.6.

This is the trace from my app. As you can see, the main thread (17460) queues the
buffer, starts the grabbing thread right after the STREAMON and queries
brightness, contrast, hue and saturation.
The grabbing thread tries to dequeue a buffer and hangs:

-> Thread=17460 ioctl=c058560f          QBUF
<- Thread=17460 ioctl=c058560f ret=0    QBUF
-> Thread=17460 ioctl=c058560f          QBUF
<- Thread=17460 ioctl=c058560f ret=0    QBUF
-> Thread=17460 ioctl=40045612          STREAMON
<- Thread=17460 ioctl=40045612 ret=0    STREAMON
-> Thread=17460 ioctl=c0445624          QUERYCTRL
-> Thread=17487 ioctl=c0585611          DQBUF
<- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
-> Thread=17460 ioctl=c008561b          G_CTRL
<- Thread=17460 ioctl=c008561b ret=0    G_CTRL
-> Thread=17460 ioctl=c0445624          QUERYCTRL
<- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
-> Thread=17460 ioctl=c008561b          G_CTRL
<- Thread=17460 ioctl=c008561b ret=0    G_CTRL
-> Thread=17460 ioctl=c0445624          QUERYCTRL
<- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
-> Thread=17460 ioctl=c008561b          G_CTRL
<- Thread=17460 ioctl=c008561b ret=0    G_CTRL
-> Thread=17460 ioctl=c0445624          QUERYCTRL
<- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
-> Thread=17460 ioctl=c008561b          G_CTRL
<- Thread=17460 ioctl=c008561b ret=0    G_CTRL

Trace from UVC driver:

Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: Queuing buffer 0.
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: Queuing buffer 1.
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_STREAMON, dir=-w (0x40045612)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCTRL, dir=rw (0xc0445624)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_G_CTRL, dir=rw (0xc008561b)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCTRL, dir=rw (0xc0445624)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_DQBUF, dir=rw (0xc0585611)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_G_CTRL, dir=rw (0xc008561b)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCTRL, dir=rw (0xc0445624)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_G_CTRL, dir=rw (0xc008561b)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCTRL, dir=rw (0xc0445624)
Jun 26 20:31:20 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:31:20 Rincewind kernel: v4l2 ioctl VIDIOC_G_CTRL, dir=rw (0xc008561b)

A second test after module unloading and replugging of the camera: 
Here the dequeing of the first buffer succeedes, although the MJPEG
decoder complains about garbage. The second dqbuf operation hangs now.

-> Thread=17989 ioctl=15        QBUF
<- Thread=17989 ioctl=15 ret=0  QBUF
-> Thread=17989 ioctl=15        QBUF
<- Thread=17989 ioctl=15 ret=0  QBUF
-> Thread=17989 ioctl=18        STREAMON
<- Thread=17989 ioctl=18 ret=0  STREAMON
-> Thread=18010 ioctl=17        DQBUF
-> Thread=17989 ioctl=36        QUERYCTRL
<- Thread=17989 ioctl=36 ret=0  QUERYCTRL
-> Thread=17989 ioctl=27        G_CTRL
<- Thread=17989 ioctl=27 ret=0  G_CTRL
-> Thread=17989 ioctl=36        QUERYCTRL
<- Thread=17989 ioctl=36 ret=0  QUERYCTRL
-> Thread=17989 ioctl=27        G_CTRL
<- Thread=17989 ioctl=27 ret=0  G_CTRL
-> Thread=17989 ioctl=36        QUERYCTRL
<- Thread=17989 ioctl=36 ret=0  QUERYCTRL
-> Thread=17989 ioctl=27        G_CTRL
<- Thread=17989 ioctl=27 ret=0  G_CTRL
-> Thread=17989 ioctl=36        QUERYCTRL
<- Thread=17989 ioctl=36 ret=0  QUERYCTRL
-> Thread=17989 ioctl=27        G_CTRL
<- Thread=17989 ioctl=27 ret=0  G_CTRL
<- Thread=18010 ioctl=17 ret=0  DQBUF
Calling MJPEG Decoder: 1
MJPEG: target size != image size!
-> Thread=18010 ioctl=15        QBUF
<- Thread=18010 ioctl=15 ret=0  QBUF
-> Thread=18010 ioctl=17        DQBUF

The associated UVC trace:

Jun 26 20:47:23 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCTRL, dir=rw (0xc0445624)
Jun 26 20:47:23 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:47:23 Rincewind kernel: v4l2 ioctl VIDIOC_G_CTRL, dir=rw (0xc008561b)
Jun 26 20:47:23 Rincewind kernel: uvcvideo: Frame complete (EOF found).
Jun 26 20:47:23 Rincewind kernel: uvcvideo: EOF in empty payload.
Jun 26 20:47:23 Rincewind kernel: uvcvideo: Dequeuing buffer 0 (3, 4156 bytes).
Jun 26 20:47:23 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:47:23 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:47:23 Rincewind kernel: uvcvideo: Queuing buffer 0.
Jun 26 20:47:23 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:47:23 Rincewind kernel: v4l2 ioctl VIDIOC_DQBUF, dir=rw (0xc0585611)

The size of the first frame. The first frame is always 4156 bytes long. Even if
the driver does not block.

$ ls -la /tmp/frame-00000 at 352x288.mjpeg
-rw-r--r-- 1 gjasny gjasny 4156 26. Jun 21:01 /tmp/frame-00000 at 352x288.mjpeg

$ hexdump /tmp/frame-00000 at 352x288.mjpeg
0000000 d8ff e0ff 1000 464a 4649 0100 0101 0000
0000010 0000 0000 dbff 4300 0500 0403 0404 0503
0000020 0404 0604 0505 0806 080d 0708 0807 0b0f
0000030 090c 120d 1310 1213 1210 1411 1d17 1418
0000040 1b15 1116 1912 1922 1e1b 201f 2021 1813
0000050 2623 1f23 1d26 2020 ff1f 00db 0143 0605
0000060 0806 0807 080f 0f08 151f 1512 1f1f 1f1f
[...]

One maybe interesting observation: If I reload the module after a
deadlock and let the camera plugged in, the following trace is produced:
A now started luvcview blocks during dqbuf, too (See next trace).
The only way to get a working camera again is to replug the camera.

Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Brightness to control 00000000-0000-0000-0000-000000000101/2.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Contrast to control 00000000-0000-0000-0000-000000000101/3.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Hue to control 00000000-0000-0000-0000-000000000101/6.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Saturation to control 00000000-0000-0000-0000-000000000101/7.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Sharpness to control 00000000-0000-0000-0000-000000000101/8.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Gamma to control 00000000-0000-0000-0000-000000000101/9.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Backlight Compensation to control 00000000-0000-0000-0000-000000000101/1.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Gain to control 00000000-0000-0000-0000-000000000101/4.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Power Line Frequency to control 00000000-0000-0000-0000-000000000101/5.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Hue, Auto to control 00000000-0000-0000-0000-000000000101/16.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Exposure, Auto to control 00000000-0000-0000-0000-000000000001/2.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Exposure, Auto Priority to control 00000000-0000-0000-0000-000000000001/3.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Exposure (Absolute) to control 00000000-0000-0000-0000-000000000001/4.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping White Balance Temperature, Auto to control 00000000-0000-0000-0000-000000000101/11.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping White Balance Temperature to control 00000000-0000-0000-0000-000000000101/10.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping White Balance Component, Auto to control 00000000-0000-0000-0000-000000000101/13.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping White Balance Blue Component to control 00000000-0000-0000-0000-000000000101/12.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping White Balance Red Component to control 00000000-0000-0000-0000-000000000101/12.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Focus (absolute) to control 00000000-0000-0000-0000-000000000001/6.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Adding mapping Focus, Auto to control 00000000-0000-0000-0000-000000000001/8.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Probing known UVC device 1.1 (045e:00f8)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Found format MJPEG.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 352x288 (30.0 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 1600x1200 (7.5 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 1280x1024 (7.5 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 1024x768 (7.5 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 800x600 (30.0 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 640x480 (30.0 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 320x240 (30.0 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 176x144 (30.0 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: - 160x120 (30.0 fps)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Found a Status endpoint (addr 83).
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Found UVC 1.00 device Microsoft? LifeCam NX-6000 (045e:00f8)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Added control 00000000-0000-0000-0000-000000000101/10 to device 1.1 entity 5
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Scanning UVC chain: OT 3 <- PU 5 <- SU 4 <- IT 1
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Found a valid video chain (1 -> 3).
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
Jun 26 20:55:57 Rincewind kernel: input: Microsoft? LifeCam NX-6000 as /devices/pci0000:00/0000:00:1d.7/usb2/2-1/2-1.1/2-1.1:1.0/input/input11
Jun 26 20:55:57 Rincewind kernel: uvcvideo: uvc_v4l2_open
Jun 26 20:55:57 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:55:57 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCAP, dir=r- (0x80685600)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:55:57 Rincewind kernel: v4l1 ioctl VIDIOCGCAP, dir=r- (0x803c7601)
Jun 26 20:55:57 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCAP, dir=r- (0x80685600)
Jun 26 20:55:57 Rincewind kernel: v4l2 ioctl VIDIOC_ENUMINPUT, dir=rw (0xc050561a)
Jun 26 20:55:57 Rincewind kernel: v4l2 ioctl VIDIOC_ENUMINPUT, dir=rw (0xc050561a)
Jun 26 20:55:57 Rincewind kernel: v4l2 ioctl VIDIOC_ENUM_FMT, dir=rw (0xc0405602)
Jun 26 20:55:57 Rincewind kernel: v4l2 ioctl VIDIOC_TRY_FMT, dir=rw (0xc0d05640)
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Trying format 0x47504a4d (MJPG): 10000x10000.
Jun 26 20:55:57 Rincewind kernel: uvcvideo: Using default frame interval 133333.3 us (7.5 fps).
Jun 26 20:55:57 Rincewind kernel: uvcvideo: uvc_v4l2_release
Jun 26 20:55:58 Rincewind kernel: uvcvideo: UVC device initialized.
Jun 26 20:55:58 Rincewind kernel: usbcore: registered new interface driver uvcvideo
Jun 26 20:55:58 Rincewind kernel: USB Video Class driver (SVN r217)

luvcview:
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_open
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYCAP, dir=r- (0x80685600)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_S_FMT, dir=rw (0xc0d05605)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Trying format 0x47504a4d (MJPG): 320x240.
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_S_PARM, dir=rw (0xc0cc5616)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Setting frame interval to 1/15 (666666).
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_REQBUFS, dir=rw (0xc0145608)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYBUF, dir=rw (0xc0585609)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_mmap
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYBUF, dir=rw (0xc0585609)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_mmap
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYBUF, dir=rw (0xc0585609)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_mmap
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QUERYBUF, dir=rw (0xc0585609)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_mmap
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Queuing buffer 0.
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Queuing buffer 1.
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Queuing buffer 2.
Jun 26 20:57:15 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:15 Rincewind kernel: v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc058560f)
Jun 26 20:57:15 Rincewind kernel: uvcvideo: Queuing buffer 3.
Jun 26 20:57:16 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:16 Rincewind kernel: v4l2 ioctl VIDIOC_STREAMON, dir=-w (0x40045612)
Jun 26 20:57:16 Rincewind kernel: uvcvideo: uvc_v4l2_ioctl
Jun 26 20:57:16 Rincewind kernel: v4l2 ioctl VIDIOC_DQBUF, dir=rw (0xc0585611)

You might find the lsusb of the camera helpful:

Bus 002 Device 007: ID 045e:00f8 Microsoft Corp. LifeCam NX-6000.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x045e Microsoft Corp.
  idProduct          0x00f8 LifeCam NX-6000.
  bcdDevice            1.00
  iManufacturer           1 
  iProduct                2 Microsoft? LifeCam NX-6000
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          555
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               2 Microsoft? LifeCam NX-6000
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              2 Microsoft? LifeCam NX-6000
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           57
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000a00
          Zoom (Absolute)
          PanTilt (Absolute)
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               1
        baSource( 0)            1
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000557f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
          Digital Multiplier
        iProcessing             0 
        bmVideoStandards     0x68
          SECAM - 625/50
          PAL - 525/60
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              16
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      295
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                9
        bFlags                              1
          Fixed-size samples: Yes
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                230400000
        dwMaxBitRate                230400000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                157286400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 94371840
        dwMaxBitRate                 94371840
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                230400000
        dwMaxBitRate                230400000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                147456000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 36864000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                 12165120
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         9
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  9216000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13fc  3x 1020 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       1 Control Device
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           41
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 3
        bSourceID               1
        bControlSize            2
        bmaControls( 0)      0x00
        bmaControls( 0)      0x00
        bmaControls( 1)      0x43
        bmaControls( 1)      0x00
          Mute
          Volume
          Automatic Gain
        iFeature                0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           2
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                35
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         24
        bSamFreqType            9 Discrete
        tSamFreq[ 0]        48000
        tSamFreq[ 1]        44100
        tSamFreq[ 2]        32000
        tSamFreq[ 3]        24000
        tSamFreq[ 4]        22050
        tSamFreq[ 5]        16000
        tSamFreq[ 6]        12000
        tSamFreq[ 7]        11025
        tSamFreq[ 8]         8000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0         8
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

Every time the driver is loaded, the driver prints the following line:
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).

Would it be possible to suppress this query by a camera specific quirk?

Where in the driver should I add what traces?

Is it possible to let a dqbuf ioctl have a time out?


Cheers,
Gregor


From aneeska2k5 at gmail.com  Fri Jun 27 07:15:46 2008
From: aneeska2k5 at gmail.com (aneeskA)
Date: Fri, 27 Jun 2008 10:45:46 +0530
Subject: [Linux-uvc-devel] Omnivision OV7141 -ECX linux driver
Message-ID: <55c794f10806262215y6d9f93faxea8c7aeb726c9ab2@mail.gmail.com>

Hi all,


    I am looking for a *linux driver to omnivision OV7141 - ECX* cam. Any
one knows where can i get one ?

Thanks and regards

-- anees
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080627/e940cc20/attachment.html>

From maximlevitsky at gmail.com  Fri Jun 27 22:55:17 2008
From: maximlevitsky at gmail.com (Maxim Levitsky)
Date: Fri, 27 Jun 2008 23:55:17 +0300
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
Message-ID: <486553B5.9070609@gmail.com>

Hello,

Is UVC driver planned for inclusion in 2.6.27?

As a new user of this driver, I confirm that it works almost perfectly.

cheese/xawtv/kdetv/zapping/ekiga work fine.
tvtime complains about 'too short video frames'

zapping crashes when trying to see settings dialog - almost for sure
unrelated bug, this application is not stable.

kdetv hangs on exit, app buggy as well, but maybe it triggers some race
in videobuf, I have already triggered one race with this app once.

The camera used to hang minutes after launch, but after I installed latest svn of
uvcvideo the bug disappeared.

Oh, almost forgot, I have Acer Crystal eye webcam integrated
in my new laptop. aspire 5720.

Best regards,
	Maxim Levitsky



From richietommy at yahoo.com  Sat Jun 28 00:49:52 2008
From: richietommy at yahoo.com (Rich)
Date: Fri, 27 Jun 2008 15:49:52 -0700 (PDT)
Subject: [Linux-uvc-devel] Handy python script for controlling uvcdynctrl
	graphically
Message-ID: <799679.98441.qm@web52411.mail.re2.yahoo.com>

I wrote this a couple of days ago, but I figured it could be handy to people on this list. Have a look if you like:

http://forums.quickcamteam.net/showthread.php?tid=352

Thanks,

-Rich



      


From maximlevitsky at gmail.com  Mon Jun 30 14:16:48 2008
From: maximlevitsky at gmail.com (Maxim Levitsky)
Date: Mon, 30 Jun 2008 15:16:48 +0300
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <486553B5.9070609@gmail.com>
References: <486553B5.9070609@gmail.com>
Message-ID: <4868CEB0.2020901@gmail.com>

Maxim Levitsky wrote:
> Hello,
> 
> Is UVC driver planned for inclusion in 2.6.27?
> 
> As a new user of this driver, I confirm that it works almost perfectly.
> 
> cheese/xawtv/kdetv/zapping/ekiga work fine.
> tvtime complains about 'too short video frames'
> 
> zapping crashes when trying to see settings dialog - almost for sure
> unrelated bug, this application is not stable.
> 
> kdetv hangs on exit, app buggy as well, but maybe it triggers some race
> in videobuf, I have already triggered one race with this app once.
> 
> The camera used to hang minutes after launch, but after I installed 
> latest svn of
> uvcvideo the bug disappeared.
> 
> Oh, almost forgot, I have Acer Crystal eye webcam integrated
> in my new laptop. aspire 5720.
> 
> Best regards,
>     Maxim Levitsky
> 

Any news?


From laurent.pinchart at skynet.be  Mon Jun 30 15:22:26 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 30 Jun 2008 15:22:26 +0200
Subject: [Linux-uvc-devel] Omnivision OV7141 -ECX linux driver
In-Reply-To: <55c794f10806262215y6d9f93faxea8c7aeb726c9ab2@mail.gmail.com>
References: <55c794f10806262215y6d9f93faxea8c7aeb726c9ab2@mail.gmail.com>
Message-ID: <200806301522.27273.laurent.pinchart@skynet.be>

Hi Anees,

On Friday 27 June 2008, aneeskA wrote:
> Hi all,
>
>     I am looking for a *linux driver to omnivision OV7141 - ECX* cam. Any
> one knows where can i get one ?

The Linux UVC driver supports UVC compatible cameras only. To check if your 
camera is UVC compatible, read 
http://www.quickcamteam.net/documentation/faq/how-do-i-find-out-whether-my-camera-is-a-uvc-device-or-not

For non UVC compatible webcams, you might have more luck with the gspca 
(http://mxhaard.free.fr/spca5xx.html) or microdia 
(https://groups.google.com/group/microdia) drivers.

Best regards,

Laurent Pinchart


From aneeska2k5 at gmail.com  Mon Jun 30 15:34:11 2008
From: aneeska2k5 at gmail.com (aneeskA)
Date: Mon, 30 Jun 2008 19:04:11 +0530
Subject: [Linux-uvc-devel] Omnivision OV7141 -ECX linux driver
In-Reply-To: <200806301522.27273.laurent.pinchart@skynet.be>
References: <55c794f10806262215y6d9f93faxea8c7aeb726c9ab2@mail.gmail.com>
	<200806301522.27273.laurent.pinchart@skynet.be>
Message-ID: <55c794f10806300634k41e15e36le1be9872076df875@mail.gmail.com>

Hi Laurent,


    Thank you very much for those links.

-- anees

On Mon, Jun 30, 2008 at 6:52 PM, Laurent Pinchart <
laurent.pinchart at skynet.be> wrote:

> Hi Anees,
>
> On Friday 27 June 2008, aneeskA wrote:
> > Hi all,
> >
> >     I am looking for a *linux driver to omnivision OV7141 - ECX* cam. Any
> > one knows where can i get one ?
>
> The Linux UVC driver supports UVC compatible cameras only. To check if your
> camera is UVC compatible, read
>
> http://www.quickcamteam.net/documentation/faq/how-do-i-find-out-whether-my-camera-is-a-uvc-device-or-not
>
> For non UVC compatible webcams, you might have more luck with the gspca
> (http://mxhaard.free.fr/spca5xx.html) or microdia
> (https://groups.google.com/group/microdia) drivers.
>
> Best regards,
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080630/6e17e59d/attachment.html>

From laurent.pinchart at skynet.be  Mon Jun 30 17:06:28 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 30 Jun 2008 17:06:28 +0200
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <4868CEB0.2020901@gmail.com>
References: <486553B5.9070609@gmail.com> <4868CEB0.2020901@gmail.com>
Message-ID: <200806301706.28703.laurent.pinchart@skynet.be>

Hi Maxim,

On Monday 30 June 2008, Maxim Levitsky wrote:
> Maxim Levitsky wrote:
> > Hello,
> >
> > Is UVC driver planned for inclusion in 2.6.27?
> >
> > As a new user of this driver, I confirm that it works almost perfectly.
> >
> > cheese/xawtv/kdetv/zapping/ekiga work fine.
> > tvtime complains about 'too short video frames'
> >
> > zapping crashes when trying to see settings dialog - almost for sure
> > unrelated bug, this application is not stable.
> >
> > kdetv hangs on exit, app buggy as well, but maybe it triggers some race
> > in videobuf, I have already triggered one race with this app once.
> >
> > The camera used to hang minutes after launch, but after I installed
> > latest svn of
> > uvcvideo the bug disappeared.
> >
> > Oh, almost forgot, I have Acer Crystal eye webcam integrated
> > in my new laptop. aspire 5720.
> >
> > Best regards,
> >     Maxim Levitsky
>
> Any news?

I've just submitted the Linux UVC driver to the video4linux and linux-usb 
mailing lists. Unless people report blocking issues it should get into 
2.6.27.

Best regards,

Laurent Pinchart


From maximlevitsky at gmail.com  Mon Jun 30 17:20:25 2008
From: maximlevitsky at gmail.com (Maxim Levitsky)
Date: Mon, 30 Jun 2008 18:20:25 +0300
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <200806301706.28703.laurent.pinchart@skynet.be>
References: <486553B5.9070609@gmail.com> <4868CEB0.2020901@gmail.com>
	<200806301706.28703.laurent.pinchart@skynet.be>
Message-ID: <4868F9B9.2060300@gmail.com>

Laurent Pinchart wrote:
> Hi Maxim,
> 
> On Monday 30 June 2008, Maxim Levitsky wrote:
>> Maxim Levitsky wrote:
>>> Hello,
>>>
>>> Is UVC driver planned for inclusion in 2.6.27?
>>>
>>> As a new user of this driver, I confirm that it works almost perfectly.
>>>
>>> cheese/xawtv/kdetv/zapping/ekiga work fine.
>>> tvtime complains about 'too short video frames'
>>>
>>> zapping crashes when trying to see settings dialog - almost for sure
>>> unrelated bug, this application is not stable.
>>>
>>> kdetv hangs on exit, app buggy as well, but maybe it triggers some race
>>> in videobuf, I have already triggered one race with this app once.
>>>
>>> The camera used to hang minutes after launch, but after I installed
>>> latest svn of
>>> uvcvideo the bug disappeared.
>>>
>>> Oh, almost forgot, I have Acer Crystal eye webcam integrated
>>> in my new laptop. aspire 5720.
>>>
>>> Best regards,
>>>     Maxim Levitsky
>> Any news?
> 
> I've just submitted the Linux UVC driver to the video4linux and linux-usb 
> mailing lists. Unless people report blocking issues it should get into 
> 2.6.27.
> 
> Best regards,
> 
> Laurent Pinchart

Thanks a lot for writing this driver,
it will surly help a lot with webcams, especially integrated ones.

Best regards,
	Maxim Levitsky


From laurent.pinchart at skynet.be  Mon Jun 30 17:25:46 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 30 Jun 2008 17:25:46 +0200
Subject: [Linux-uvc-devel] Frame dropping in Logitech raw bayer mode
In-Reply-To: <48617901.5040203@free.fr>
References: <48617901.5040203@free.fr>
Message-ID: <200806301725.46227.laurent.pinchart@skynet.be>

Hi Bruno,

On Wednesday 25 June 2008, Bruno Viaris wrote:
> Hi,
>
> I try to get raw bayer mode working with a Quickcam Pro for Notebooks
> (046d:0991).

I knew this would hit me sooner or later :-)

> I activate this function with the following command:
>
> uvcdynctrl -d /dev/video1 -s "Disable video processing" 1
>
> then I can get the raw frames (frame???.raw) on disk with
> luvcview -d /dev/video1 -f yuv -s 1600x1200 -C
>
> That worked fine until uvcvideo driver svn revision 207, where a test
> was introduced to drop frames if their length is different from the
> expected size:
> > --- linux-uvc-206/uvc_v4l2.c    2008-06-22 22:00:57.000000000 +0200
> >
> > +               video->queue.drop_incomplete =
> > +                       video->streaming->cur_format->flags &
> > +                               UVC_FMT_FLAG_COMPRESSED ? 0 : 1;
> > +
> >
> >
> > --- linux-uvc-206/uvc_queue.c   2008-06-22 22:00:57.000000000 +0200
> > +       if (queue->drop_incomplete && buf->buf.length !=
> > buf->buf.bytesused) {
> > +               buf->state = UVC_BUF_STATE_QUEUED;
> > +               buf->buf.bytesused = 0;
> > +               return buf;
> > +       }
>
> => if the video format is not "COMPRESSED", and a frame has not the
> expected length, drop it!

This patch has been included because many userspace applications can't handle 
short frames properly (some of them even crash). The real fix probably 
belongs in userspace.

> The problem is that my webcam is switched to raw mode without the driver
> being aware of it, and that the 8bpp bayer frames are half the size of
> YUV frames, so they all get dropped.
> A partial solution is to ask the driver for MJPG frames -> deactivates
> drop_incomplete, but the maximum resolution is then limited to 960x720,
> and I'd like to get the full frame.
>
> I am rather new to webcam and kernel-module programming, so I am not
> sure of what is the correct approach to this problem:
> - should this "drop_incomplete" function be deactivable through an ioctl ?

It would be possible to add a private control, accessible through 
VIDIOC_S_CTRL, to disable frame drop. I would prefer frame drop to be 
disabled by default, but our goal is to work around userspace bugs without 
touching the applications, so that wouldn't be really useful.

> - should logitech bayer mode be treated like "YUV2" or "MJPG" and be
> activated by the VIDIOC_S_FMT ioctl with "BYR8"?

That would be the best solution, but also the most difficult to implement. 
Logitech didn't implement Bayer mode as an extra format, but added a private 
control. The driver initialises all its internal data from the USB 
descriptors, the code would need a few hacks in various places to emulate the 
proper behaviour.

> - should the driver recognize the "Disable video processing" dynamic
> control and deactivate drop_incomplete ?

That's the option I like the less. Extension units and their controls should 
really be transparent to the driver.

> - something else ?

A quirk to disable (or enable if it's disabled by default) frame drop is an 
easy solution. It couldn't be set per device though.

> Any advice is welcome...
>
>     Bruno
>
> PS:
> For anyone interested, as a workaround I have added a quirk to disable
> this "drop_incomplete" feature,
> activate with "modprobe uvcvideo quirks=0x80000000"
> ------------------------------------
> diff -u linux-uvc-217/uvc_v4l2.c linux-uvc-217b/uvc_v4l2.c
> --- linux-uvc-217/uvc_v4l2.c    2008-06-24 23:01:57.000000000 +0200
> +++ linux-uvc-217b/uvc_v4l2.c   2008-06-23 00:31:24.000000000 +0200
> @@ -846,6 +846,7 @@
>                 if (ret < 0)
>                         return ret;
>
> +               if (!(video->dev->quirks &
> UVC_QUIRK_DISABLE_DROP_INCOMPLETE))
>                 if (!(video->streaming->cur_format->flags &
>                     UVC_FMT_FLAG_COMPRESSED))
>                         video->queue.flags |= UVC_QUEUE_DROP_INCOMPLETE;
> diff -u linux-uvc-217/uvcvideo.h linux-uvc-217b/uvcvideo.h
> --- linux-uvc-217/uvcvideo.h    2008-06-24 23:01:57.000000000 +0200
> +++ linux-uvc-217b/uvcvideo.h   2008-06-24 01:10:56.000000000 +0200
> @@ -309,6 +309,7 @@
>  #define UVC_CTRL_STREAMING_TIMEOUT     1000
>
>  /* Devices quirks */
> +#define UVC_QUIRK_DISABLE_DROP_INCOMPLETE 0x80000000
>  #define UVC_QUIRK_STATUS_INTERVAL      0x00000001
>  #define UVC_QUIRK_PROBE_MINMAX         0x00000002
>  #define UVC_QUIRK_PROBE_EXTRAFIELDS    0x00000004
> --------------------------------------------------------------

Should the driver drop incomplete frames by default ?

Best regards,

Laurent Pinchart


From jan at willies.info  Mon Jun 30 17:09:53 2008
From: jan at willies.info (Jan Willies)
Date: Mon, 30 Jun 2008 17:09:53 +0200
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <200806301706.28703.laurent.pinchart@skynet.be>
References: <486553B5.9070609@gmail.com> <4868CEB0.2020901@gmail.com>
	<200806301706.28703.laurent.pinchart@skynet.be>
Message-ID: <4868F741.5020308@willies.info>

Laurent Pinchart wrote:
> I've just submitted the Linux UVC driver to the video4linux and linux-usb 
> mailing lists. Unless people report blocking issues it should get into 
> 2.6.27.

That's really great news! Thanks for all your efforts and of course thanks to all other contributors too!


- Jan


From laurent.pinchart at skynet.be  Mon Jun 30 17:39:45 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 30 Jun 2008 17:39:45 +0200
Subject: [Linux-uvc-devel] Driver hangs at DQBUF ioctl
In-Reply-To: <20080626194804.GB18818@vidsoft.de>
References: <485F7A42.8020605@vidsoft.de>
	<200806240033.41145.laurent.pinchart@skynet.be>
	<20080626194804.GB18818@vidsoft.de>
Message-ID: <200806301739.45386.laurent.pinchart@skynet.be>

Hi Gregor,

On Thursday 26 June 2008, Gregor Jasny wrote:
> Hi all,
>
> this got a somewhat lengthy bugreport.

Thanks for the report.

> Some words to my environment: 
>
> These traces were produced on a Core2Duo (in amd64 mode) with a ASUS P5B
> board and vanilla Linux 2.6.25.8. I observed the same behavior on a 32bit
> QuadCore with a Logitech 9000 and Linux 2.6.25.6.
>
> This is the trace from my app. As you can see, the main thread (17460)
> queues the buffer, starts the grabbing thread right after the STREAMON and
> queries brightness, contrast, hue and saturation.
> The grabbing thread tries to dequeue a buffer and hangs:
>
> -> Thread=17460 ioctl=c058560f          QBUF
> <- Thread=17460 ioctl=c058560f ret=0    QBUF
> -> Thread=17460 ioctl=c058560f          QBUF
> <- Thread=17460 ioctl=c058560f ret=0    QBUF
> -> Thread=17460 ioctl=40045612          STREAMON
> <- Thread=17460 ioctl=40045612 ret=0    STREAMON
> -> Thread=17460 ioctl=c0445624          QUERYCTRL
> -> Thread=17487 ioctl=c0585611          DQBUF
> <- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
> -> Thread=17460 ioctl=c008561b          G_CTRL
> <- Thread=17460 ioctl=c008561b ret=0    G_CTRL
> -> Thread=17460 ioctl=c0445624          QUERYCTRL
> <- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
> -> Thread=17460 ioctl=c008561b          G_CTRL
> <- Thread=17460 ioctl=c008561b ret=0    G_CTRL
> -> Thread=17460 ioctl=c0445624          QUERYCTRL
> <- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
> -> Thread=17460 ioctl=c008561b          G_CTRL
> <- Thread=17460 ioctl=c008561b ret=0    G_CTRL
> -> Thread=17460 ioctl=c0445624          QUERYCTRL
> <- Thread=17460 ioctl=c0445624 ret=0    QUERYCTRL
> -> Thread=17460 ioctl=c008561b          G_CTRL
> <- Thread=17460 ioctl=c008561b ret=0    G_CTRL

This looks valid to me. I'm not aware of a specific code path that would fail 
on that.

[snip]

> One maybe interesting observation: If I reload the module after a
> deadlock and let the camera plugged in, the following trace is produced:
> A now started luvcview blocks during dqbuf, too (See next trace).
> The only way to get a working camera again is to replug the camera.

This suggests a device issue, but let's not rule out driver issues too fast.

[snip]

> Every time the driver is loaded, the driver prints the following line:
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
>
> Would it be possible to suppress this query by a camera specific quirk?

Probably, although the query shouldn't hurt. The driver issues a GET_DEF query 
on the video control, and falls back to GET_CUR when GET_DEF fails.

> Where in the driver should I add what traces?

uvc_video_complete() and uvc_video_decode_start() are good candidates. Print a 
message for each incoming isochronous packet with its status, its length and 
the first few bytes of the header. I would like to know if the driver 
receives any data at all from the camera.

> Is it possible to let a dqbuf ioctl have a time out?

You could replace wait_event_interruptible() with 
wait_event_interruptible_timeout() in uvc_queue_waiton(). I'm not sure if 
V4L2 allows that behaviour though. You can already turn DQBUF into a 
non-blocking operation by setting the O_NONBLOCK flag when you open the 
device.

Best regards,

Laurent Pinchart


From asergiu at yahoo.co.uk  Mon Jun 30 17:26:29 2008
From: asergiu at yahoo.co.uk (Adrian Sergiu DARABANT)
Date: Mon, 30 Jun 2008 18:26:29 +0300
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <4868F9B9.2060300@gmail.com>
References: <486553B5.9070609@gmail.com>
	<4868CEB0.2020901@gmail.com><200806301706.28703.laurent.pinchart@skynet.be>
	<4868F9B9.2060300@gmail.com>
Message-ID: <FBB58A3A471344B1A2087994FAF8B126@core2>

It will help in fact for almost ALL new cameras as UVC is a must for Vista
hardware compatibiity Certification. Provided we can help Laurent bring it
to perfection we will have ideally full webcam support on Linux. :)
Adrian

-----Original Message-----
From: linux-uvc-devel-bounces at lists.berlios.de
[mailto:linux-uvc-devel-bounces at lists.berlios.de] On Behalf Of Maxim
Levitsky
Sent: Monday, June 30, 2008 6:20 PM
To: Laurent Pinchart
Cc: video4linux-list; linux-uvc-devel at lists.berlios.de
Subject: Re: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?

Laurent Pinchart wrote:
> Hi Maxim,
> 
> On Monday 30 June 2008, Maxim Levitsky wrote:
>> Maxim Levitsky wrote:
>>> Hello,
>>>
>>> Is UVC driver planned for inclusion in 2.6.27?
>>>
>>> As a new user of this driver, I confirm that it works almost perfectly.
>>>
>>> cheese/xawtv/kdetv/zapping/ekiga work fine.
>>> tvtime complains about 'too short video frames'
>>>
>>> zapping crashes when trying to see settings dialog - almost for sure
>>> unrelated bug, this application is not stable.
>>>
>>> kdetv hangs on exit, app buggy as well, but maybe it triggers some race
>>> in videobuf, I have already triggered one race with this app once.
>>>
>>> The camera used to hang minutes after launch, but after I installed
>>> latest svn of
>>> uvcvideo the bug disappeared.
>>>
>>> Oh, almost forgot, I have Acer Crystal eye webcam integrated
>>> in my new laptop. aspire 5720.
>>>
>>> Best regards,
>>>     Maxim Levitsky
>> Any news?
> 
> I've just submitted the Linux UVC driver to the video4linux and linux-usb 
> mailing lists. Unless people report blocking issues it should get into 
> 2.6.27.
> 
> Best regards,
> 
> Laurent Pinchart

Thanks a lot for writing this driver,
it will surly help a lot with webcams, especially integrated ones.

Best regards,
	Maxim Levitsky
_______________________________________________
Linux-uvc-devel mailing list
Linux-uvc-devel at lists.berlios.de
https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From laurent.pinchart at skynet.be  Mon Jun 30 18:17:12 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 30 Jun 2008 18:17:12 +0200
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <FBB58A3A471344B1A2087994FAF8B126@core2>
References: <486553B5.9070609@gmail.com> <4868F9B9.2060300@gmail.com>
	<FBB58A3A471344B1A2087994FAF8B126@core2>
Message-ID: <200806301817.12487.laurent.pinchart@skynet.be>

Hi Adrian,

On Monday 30 June 2008, Adrian Sergiu DARABANT wrote:
> It will help in fact for almost ALL new cameras as UVC is a must for Vista
> hardware compatibiity Certification. Provided we can help Laurent bring it
> to perfection we will have ideally full webcam support on Linux. :)

Don't be over-optimistic. I expect new webcams to be as buggy as the current 
ones. Most of them are tested in Windows only and often suffer from various 
timing issues that can't be worked around by the Linux UVC driver.

However, you're right, most new webcams will have Linux support out of the 
box.

Best regards,

Laurent Pinchart


From maximlevitsky at gmail.com  Mon Jun 30 19:08:05 2008
From: maximlevitsky at gmail.com (Maxim Levitsky)
Date: Mon, 30 Jun 2008 20:08:05 +0300
Subject: [Linux-uvc-devel] UVCVIDEO for 2.6.27 ?
In-Reply-To: <200806301817.12487.laurent.pinchart@skynet.be>
References: <486553B5.9070609@gmail.com> <4868F9B9.2060300@gmail.com>
	<FBB58A3A471344B1A2087994FAF8B126@core2>
	<200806301817.12487.laurent.pinchart@skynet.be>
Message-ID: <486912F5.2050004@gmail.com>

Laurent Pinchart wrote:
> Hi Adrian,
> 
> On Monday 30 June 2008, Adrian Sergiu DARABANT wrote:
>> It will help in fact for almost ALL new cameras as UVC is a must for Vista
>> hardware compatibiity Certification. Provided we can help Laurent bring it
>> to perfection we will have ideally full webcam support on Linux. :)
> 
> Don't be over-optimistic. I expect new webcams to be as buggy as the current 
> ones. Most of them are tested in Windows only and often suffer from various 
> timing issues that can't be worked around by the Linux UVC driver.
> 
> However, you're right, most new webcams will have Linux support out of the 
> box.
> 
> Best regards,
> 
> Laurent Pinchart

Off topic:

It is interesting to see how two opposite forces push for same thing:

Linux wants standard devices to have less drivers and wider support
Microsoft wants standard devices so they can reduce number of drivers to lock down the system hard.

(Imagine having only standard compliant devices, then windows kernel can completely signed and locked)

And Linux wins at the end since you can always unlock the windows by replacing it with Linux.

Best regards,
	Maxim Levitsky


From the.real.monkey.d.luffy at gmail.com  Mon Jun 30 19:27:06 2008
From: the.real.monkey.d.luffy at gmail.com (Monkey D. Luffy)
Date: Mon, 30 Jun 2008 18:27:06 +0100
Subject: [Linux-uvc-devel] Reording sync'ed audio and video with
	uvcvideo + alsa
In-Reply-To: <344b9a2f0806301024y400fb0ebu3eccf12f8e24f142@mail.gmail.com>
References: <344b9a2f0806301024y400fb0ebu3eccf12f8e24f142@mail.gmail.com>
Message-ID: <344b9a2f0806301027w526f8c65h136efa68ba358588@mail.gmail.com>

Is there any work around for this yet?


Maurizio Monge wrote:
> Hi,
>  please excuse me if this question is not exactly about uvcvideo
>  development, but was anyone able to record sync'ed audio and video
>  with some tool?
>  This is really driving me mad...
>  transcode for some reason only records at 1fps, mencoder segfaults,
>  vlc and ffmpeg lose sync, lavrec does not work with v4l2.
>  Any suggestion? thanks a lot!
>  Regards.
>
>
>  --
>  Ciao
>  Maurizio
>  http://stregatto.wordpress.com
>
>  "Well we all shine on
>  Like the moon and the stars and the sun" (John Lennon)
>


