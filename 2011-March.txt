From robert.lukassen at tomtom.com  Wed Mar  2 15:08:49 2011
From: robert.lukassen at tomtom.com (Robert Lukassen)
Date: Wed, 2 Mar 2011 14:08:49 +0000 (UTC)
Subject: [Linux-uvc-devel] Add GUID to UVC
Message-ID: <loom.20110302T150222-830@post.gmane.org>

Hi,

I have a request to add support for a particular pixel-format (RGB565) to the
list of recognized formats in UVC. This format is known in video for linux, but
UVC does not list it.

Here are the (rather minimal) patches with respect to the latest version of the
UVC driver as used in Ubuntu 10.04 (kernel 2.6.32-28):

diff -uN /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvc_driver.c
uvc-new/uvc_driver.c
--- /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvc_driver.c	2009-12-03
04:51:21.000000000 +0100
+++ uvc-new/uvc_driver.c	2011-03-02 14:54:36.000000000 +0100
@@ -92,6 +92,11 @@
 		.guid		= UVC_GUID_FORMAT_BY8,
 		.fcc		= V4L2_PIX_FMT_SBGGR8,
 	},
+	{
+		.name		= "RGB565",
+		.guid		= UVC_GUID_FORMAT_RGBP,
+		.fcc		= V4L2_PIX_FMT_RGB565,
+	},
 };
 
 /* ------------------------------------------------------------------------
diff -uN /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvcvideo.h
uvc-new/uvcvideo.h
--- /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvcvideo.h	2009-12-03
04:51:21.000000000 +0100
+++ uvc-new/uvcvideo.h	2011-03-02 14:55:14.000000000 +0100
@@ -130,7 +130,9 @@
 #define UVC_GUID_FORMAT_BY8 \
 	{ 'B',  'Y',  '8',  ' ', 0x00, 0x00, 0x10, 0x00, \
 	 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
-
+#define UVC_GUID_FORMAT_RGBP \
+	{ 'R',  'G',  'B',  'P', 0x00, 0x00, 0x10, 0x00, \
+	 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
 
 /* ------------------------------------------------------------------------
  * Driver specific constants.

There is a product in the market that uses this pixel format, but as the RGBP
format is not supported out-of-the-box by UVC, we need to patch the kernel
driver each time we go along with a kernel upgrade.

Best regards,

Robert Lukassen




From wikne at cheetah.uio.no  Fri Mar  4 16:02:00 2011
From: wikne at cheetah.uio.no (Jon Wikne)
Date: Fri, 04 Mar 2011 16:02:00 +0100
Subject: [Linux-uvc-devel] Creative VF0700 support?
Message-ID: <4D70FEE8.6040003@cheetah.uio.no>

Hi,

I just got a Creative VF0700 Live! Cam Chat HD camera. It seems
to be detected by uvcvideo:

Mar  4 15:26:57 fiori kernel: uvcvideo: Found UVC 1.00 device VF0700 
Live! Cam Chat HD (041e:4088)
Mar  4 15:26:57 fiori kernel: input: VF0700 Live! Cam Chat HD as 
/devices/pci0000:00/0000:00:13.2/usb1/1-1/1-1:1.0/input/input1

But the green LED on the camera goes off after a few seconds.
And the image that is produced by xawtv (v 3.95) is just black!

Is this camera really supported? Tips, anyone? I will be happy to
test patches.

I am running kernel 2.6.37.1


Cheers,
-- Jon Wikne


From j.frilander at gmail.com  Fri Mar  4 18:07:12 2011
From: j.frilander at gmail.com (Jani Frilander)
Date: Fri, 4 Mar 2011 19:07:12 +0200
Subject: [Linux-uvc-devel] Creative VF0700 support?
In-Reply-To: <4D70FEE8.6040003@cheetah.uio.no>
References: <4D70FEE8.6040003@cheetah.uio.no>
Message-ID: <AANLkTikeOEVN8vr1+muJ2oLPn7HBqW02ZzF-XSnMTv3B@mail.gmail.com>

Hi Jon,

I'm completely beginner with linux webcam world too, I have had
MS LifeCam HD-5000 for just two weeks, but what in my experience
guvcview is much better tool troubleshooting a uvc webcam.

Are you using a laptop with a built in webcam? If yes, the built in
cam is probably the default one. If you can't get decent image out
of your cam, try adjusting exposure. Turn it to manual first.

Hope this helps,
Jani

2011/3/4 Jon Wikne <wikne at cheetah.uio.no>:
> Hi,
>
> I just got a Creative VF0700 Live! Cam Chat HD camera. It seems
> to be detected by uvcvideo:
>
> Mar ?4 15:26:57 fiori kernel: uvcvideo: Found UVC 1.00 device VF0700 Live!
> Cam Chat HD (041e:4088)
> Mar ?4 15:26:57 fiori kernel: input: VF0700 Live! Cam Chat HD as
> /devices/pci0000:00/0000:00:13.2/usb1/1-1/1-1:1.0/input/input1
>
> But the green LED on the camera goes off after a few seconds.
> And the image that is produced by xawtv (v 3.95) is just black!
>
> Is this camera really supported? Tips, anyone? I will be happy to
> test patches.
>
> I am running kernel 2.6.37.1
>
>
> Cheers,
> -- Jon Wikne
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From laurent.pinchart at ideasonboard.com  Sun Mar  6 11:49:40 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 11:49:40 +0100
Subject: [Linux-uvc-devel] genius eface1300
In-Reply-To: <20110219184934.244108bf@gus>
References: <20110219184934.244108bf@gus>
Message-ID: <201103061149.40962.laurent.pinchart@ideasonboard.com>

Hi Gustavo,

On Saturday 19 February 2011 22:49:34 gustavo battiti wrote:
> I want to notice you that I have a genius eface1300 webcam working so
> fine, both cam and micro, under Debian Lenny with custom kernel 2.6.32
> compiled with the UVC modular driver.
> [    5.881421] usbcore: registered new interface driver uvcvideo
> [  399.291173] uvcvideo 1-4:1.0: usb_probe_interface
> [  399.291179] uvcvideo 1-4:1.0: usb_probe_interface - got id
> [  399.291205] uvcvideo: Found UVC 1.00 device eFace 1300 (0458:707c)

Thanks for the report. Could you please send me the output of

lsusb -v -d 0458:707c

(running as root if possible) ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 11:56:14 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 11:56:14 +0100
Subject: [Linux-uvc-devel] HP Pavillion DV3 WebCam
In-Reply-To: <AANLkTinaFWGZbx=0Cse0qP4WjyeY7+C+-f-++ZXyA1bo@mail.gmail.com>
References: <AANLkTimF0ucM69vHaSf7Dxu4-=0Mw1b63KSXnEm69xY1@mail.gmail.com>
	<AANLkTi=4CEyGytG0zZzBAkHB35HEnpwHfwajPcFSPmdp@mail.gmail.com>
	<AANLkTinaFWGZbx=0Cse0qP4WjyeY7+C+-f-++ZXyA1bo@mail.gmail.com>
Message-ID: <201103061156.14985.laurent.pinchart@ideasonboard.com>

Hi Carlos,

On Sunday 20 February 2011 00:50:04 Carlos Silva wrote:
> OK, just tested with no quirks and it works. Want me to send a patch for
> it?

If no quirk is required, you don't need to patch the driver. It will work out 
of the box.

-- 
Regards,

Laurent Pinchart


From bug-track at fisher-privat.net  Sun Mar  6 11:57:13 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun,  6 Mar 2011 11:57:13 +0100
Subject: [Linux-uvc-devel] [PATCH 1/3] Initial patch to use dynamic_debug
	system
Message-ID: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>

it make possible use of fine tunable system.
We can set exact verbosity.

Use case:

this will enablle all message in module uvcvideo:
echo "module uvcvideo +p" > /sys/kernel/debug/dynamic_debug/control

this will disable message of function uvc_v4l2_do_ioctl:
echo "func uvc_v4l2_do_ioctl -p" > /sys/kernel/debug/dynamic_debug/control

Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
---
 drivers/media/video/uvc/uvc_queue.c |    8 ++-
 drivers/media/video/uvc/uvc_v4l2.c  |    2 +
 drivers/media/video/uvc/uvc_video.c |  137 ++++++++++++++++++++++++++++-------
 3 files changed, 120 insertions(+), 27 deletions(-)

diff --git a/drivers/media/video/uvc/uvc_queue.c b/drivers/media/video/uvc/uvc_queue.c
index 36f3c58..19e6cba 100644
--- a/drivers/media/video/uvc/uvc_queue.c
+++ b/drivers/media/video/uvc/uvc_queue.c
@@ -137,6 +137,9 @@ int uvc_alloc_buffers(struct uvc_video_queue *queue, unsigned int nbuffers,
 	void *mem = NULL;
 	int ret;
 
+	pr_debug("%s: nbuffers %u; buflength: %u", __func__,
+		nbuffers, buflength);
+
 	if (nbuffers > UVC_MAX_VIDEO_BUFFERS)
 		nbuffers = UVC_MAX_VIDEO_BUFFERS;
 
@@ -347,8 +350,9 @@ int uvc_dequeue_buffer(struct uvc_video_queue *queue,
 	if ((ret = uvc_queue_waiton(buf, nonblocking)) < 0)
 		goto done;
 
-	uvc_trace(UVC_TRACE_CAPTURE, "Dequeuing buffer %u (%u, %u bytes).\n",
-		buf->buf.index, buf->state, buf->buf.bytesused);
+	pr_debug("%s: Dequeuing buffer %u (%u, %u/%u bytes).", __func__,
+		buf->buf.index, buf->state,
+		buf->buf.length, buf->buf.bytesused);
 
 	switch (buf->state) {
 	case UVC_BUF_STATE_ERROR:
diff --git a/drivers/media/video/uvc/uvc_v4l2.c b/drivers/media/video/uvc/uvc_v4l2.c
index fa89ebf..3ba2563 100644
--- a/drivers/media/video/uvc/uvc_v4l2.c
+++ b/drivers/media/video/uvc/uvc_v4l2.c
@@ -559,6 +559,8 @@ static long uvc_v4l2_do_ioctl(struct file *file, unsigned int cmd, void *arg)
 	struct uvc_streaming *stream = handle->stream;
 	long ret = 0;
 
+	pr_debug("%s: cmd: %u", __func__, cmd);
+
 	switch (cmd) {
 	/* Query capabilities */
 	case VIDIOC_QUERYCAP:
diff --git a/drivers/media/video/uvc/uvc_video.c b/drivers/media/video/uvc/uvc_video.c
index 43f955e..9a95a62 100644
--- a/drivers/media/video/uvc/uvc_video.c
+++ b/drivers/media/video/uvc/uvc_video.c
@@ -73,6 +73,8 @@ int uvc_query_ctrl(struct uvc_device *dev, __u8 query, __u8 unit,
 {
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	ret = __uvc_query_ctrl(dev, query, unit, intfnum, cs, data, size,
 				UVC_CTRL_CONTROL_TIMEOUT);
 	if (ret != size) {
@@ -92,6 +94,8 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 	struct uvc_frame *frame = NULL;
 	unsigned int i;
 
+	pr_debug("%s", __func__);
+
 	if (ctrl->bFormatIndex <= 0 ||
 	    ctrl->bFormatIndex > stream->nformats)
 		return;
@@ -110,9 +114,13 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 
 	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
 	     (ctrl->dwMaxVideoFrameSize == 0 &&
-	      stream->dev->uvc_version < 0x0110))
+	      stream->dev->uvc_version < 0x0110)) {
+		pr_debug("%s: rewrite dwMaxVideoFrameSize=%u to %u.",
+			 __func__, ctrl->dwMaxVideoFrameSize,
+			frame->dwMaxVideoFrameBufferSize);
 		ctrl->dwMaxVideoFrameSize =
 			frame->dwMaxVideoFrameBufferSize;
+	}
 
 	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) &&
 	    stream->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
@@ -146,6 +154,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 		 */
 		bandwidth = max_t(u32, bandwidth, 1024);
 
+		pr_debug("%s: rewrite dwMaxPayloadTransferSize=%u to %u.",
+			__func__, ctrl->dwMaxPayloadTransferSize, bandwidth);
+
 		ctrl->dwMaxPayloadTransferSize = bandwidth;
 	}
 }
@@ -157,6 +168,8 @@ static int uvc_get_video_ctrl(struct uvc_streaming *stream,
 	__u16 size;
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	size = stream->dev->uvc_version >= 0x0110 ? 34 : 26;
 	if ((stream->dev->quirks & UVC_QUIRK_PROBE_DEF) &&
 			query == UVC_GET_DEF)
@@ -233,6 +246,20 @@ static int uvc_get_video_ctrl(struct uvc_streaming *stream,
 	uvc_fixup_video_ctrl(stream, ctrl);
 	ret = 0;
 
+	pr_debug("%s: bmHint: %u; bFormatIndex: %u; bFrameIndex: %u; "
+		 "dwFrameInterval: %u; wKeyFrameRate: %u; "
+		 "wCompQuality: %u; wCompWindowSize: %u; wDelay: %u; "
+		 "dwMaxVideoFrameSize %u; dwMaxPayloadTransferSize: %u",
+		__func__, ctrl->bmHint,
+		ctrl->bFormatIndex,
+		ctrl->bFrameIndex,
+		ctrl->dwFrameInterval,
+		ctrl->wKeyFrameRate,
+		ctrl->wCompQuality,
+		ctrl->wCompWindowSize,
+		ctrl->wDelay,
+		ctrl->dwMaxVideoFrameSize,
+		ctrl->dwMaxPayloadTransferSize);
 out:
 	kfree(data);
 	return ret;
@@ -245,6 +272,21 @@ static int uvc_set_video_ctrl(struct uvc_streaming *stream,
 	__u16 size;
 	int ret;
 
+	pr_debug("%s: bmHint: %u; bFormatIndex: %u; bFrameIndex: %u; "
+		 "dwFrameInterval: %u; wKeyFrameRate: %u; "
+		 "wCompQuality: %u; wCompWindowSize: %u; wDelay: %u; "
+		 "dwMaxVideoFrameSize %u; dwMaxPayloadTransferSize: %u",
+		__func__, ctrl->bmHint,
+		ctrl->bFormatIndex,
+		ctrl->bFrameIndex,
+		ctrl->dwFrameInterval,
+		ctrl->wKeyFrameRate,
+		ctrl->wCompQuality,
+		ctrl->wCompWindowSize,
+		ctrl->wDelay,
+		ctrl->dwMaxVideoFrameSize,
+		ctrl->dwMaxPayloadTransferSize);
+
 	size = stream->dev->uvc_version >= 0x0110 ? 34 : 26;
 	data = kzalloc(size, GFP_KERNEL);
 	if (data == NULL)
@@ -292,6 +334,8 @@ int uvc_probe_video(struct uvc_streaming *stream,
 	unsigned int i;
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	/* Perform probing. The device should adjust the requested values
 	 * according to its capabilities. However, some devices, namely the
 	 * first generation UVC Logitech webcams, don't implement the Video
@@ -349,6 +393,7 @@ done:
 int uvc_commit_video(struct uvc_streaming *stream,
 	struct uvc_streaming_control *probe)
 {
+	pr_debug("%s", __func__);
 	return uvc_set_video_ctrl(stream, probe, 0);
 }
 
@@ -406,6 +451,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
 {
 	__u8 fid;
 
+	pr_debug("%s", __func__);
+
 	/* Sanity checks:
 	 * - packet must be at least 2 bytes long
 	 * - bHeaderLength value must be at least 2 bytes (see above)
@@ -416,8 +463,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
 
 	/* Skip payloads marked with the error bit ("error frames"). */
 	if (data[1] & UVC_STREAM_ERR) {
-		uvc_trace(UVC_TRACE_FRAME, "Dropping payload (error bit "
-			  "set).\n");
+		pr_debug("%s: Dropping payload (error bit "
+			  "set).", __func__);
 		return -ENODATA;
 	}
 
@@ -449,8 +496,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
 		struct timespec ts;
 
 		if (fid == stream->last_fid) {
-			uvc_trace(UVC_TRACE_FRAME, "Dropping payload (out of "
-				"sync).\n");
+			pr_debug("%s: Dropping payload (out of "
+				"sync).", __func__);
 			if ((stream->dev->quirks & UVC_QUIRK_STREAM_NO_FID) &&
 			    (data[1] & UVC_STREAM_EOF))
 				stream->last_fid ^= UVC_STREAM_FID;
@@ -486,8 +533,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
 	 * previous payload had the EOF bit set.
 	 */
 	if (fid != stream->last_fid && buf->buf.bytesused != 0) {
-		uvc_trace(UVC_TRACE_FRAME, "Frame complete (FID bit "
-				"toggled).\n");
+		pr_debug("%s: Frame complete (FID bit "
+				"toggled).", __func__);
 		buf->state = UVC_BUF_STATE_READY;
 		return -EAGAIN;
 	}
@@ -504,6 +551,8 @@ static void uvc_video_decode_data(struct uvc_streaming *stream,
 	unsigned int maxlen, nbytes;
 	void *mem;
 
+	pr_debug("%s", __func__);
+
 	if (len <= 0)
 		return;
 
@@ -516,7 +565,7 @@ static void uvc_video_decode_data(struct uvc_streaming *stream,
 
 	/* Complete the current frame if the buffer size was exceeded. */
 	if (len > maxlen) {
-		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
+		pr_debug("%s: Frame complete (overflow).", __func__);
 		buf->state = UVC_BUF_STATE_READY;
 	}
 }
@@ -524,11 +573,14 @@ static void uvc_video_decode_data(struct uvc_streaming *stream,
 static void uvc_video_decode_end(struct uvc_streaming *stream,
 		struct uvc_buffer *buf, const __u8 *data, int len)
 {
+
+	pr_debug("%s", __func__);
+
 	/* Mark the buffer as done if the EOF marker is set. */
 	if (data[1] & UVC_STREAM_EOF && buf->buf.bytesused != 0) {
-		uvc_trace(UVC_TRACE_FRAME, "Frame complete (EOF found).\n");
+		pr_debug("%s: Frame complete (EOF found).", __func__);
 		if (data[0] == len)
-			uvc_trace(UVC_TRACE_FRAME, "EOF in empty payload.\n");
+			pr_debug("%s: EOF in empty payload.", __func__);
 		buf->state = UVC_BUF_STATE_READY;
 		if (stream->dev->quirks & UVC_QUIRK_STREAM_NO_FID)
 			stream->last_fid ^= UVC_STREAM_FID;
@@ -549,6 +601,8 @@ static void uvc_video_decode_end(struct uvc_streaming *stream,
 static int uvc_video_encode_header(struct uvc_streaming *stream,
 		struct uvc_buffer *buf, __u8 *data, int len)
 {
+	pr_debug("%s", __func__);
+
 	data[0] = 2;	/* Header length */
 	data[1] = UVC_STREAM_EOH | UVC_STREAM_EOF
 		| (stream->last_fid & UVC_STREAM_FID);
@@ -562,6 +616,8 @@ static int uvc_video_encode_data(struct uvc_streaming *stream,
 	unsigned int nbytes;
 	void *mem;
 
+	pr_debug("%s", __func__);
+
 	/* Copy video data to the URB buffer. */
 	mem = queue->mem + buf->buf.m.offset + queue->buf_used;
 	nbytes = min((unsigned int)len, buf->buf.bytesused - queue->buf_used);
@@ -587,10 +643,13 @@ static void uvc_video_decode_isoc(struct urb *urb, struct uvc_streaming *stream,
 	u8 *mem;
 	int ret, i;
 
+	pr_debug("%s", __func__);
+
 	for (i = 0; i < urb->number_of_packets; ++i) {
 		if (urb->iso_frame_desc[i].status < 0) {
-			uvc_trace(UVC_TRACE_FRAME, "USB isochronous frame "
-				"lost (%d).\n", urb->iso_frame_desc[i].status);
+			pr_debug("%s: USB isochronous frame "
+				"lost (%d).", __func__,
+				urb->iso_frame_desc[i].status);
 			/* Mark the buffer as faulty. */
 			if (buf != NULL)
 				buf->error = 1;
@@ -635,6 +694,8 @@ static void uvc_video_decode_bulk(struct urb *urb, struct uvc_streaming *stream,
 	u8 *mem;
 	int len, ret;
 
+	pr_debug("%s", __func__);
+
 	if (urb->actual_length == 0)
 		return;
 
@@ -699,6 +760,8 @@ static void uvc_video_encode_bulk(struct urb *urb, struct uvc_streaming *stream,
 	u8 *mem = urb->transfer_buffer;
 	int len = stream->urb_size, ret;
 
+	pr_debug("%s", __func__);
+
 	if (buf == NULL) {
 		urb->transfer_buffer_length = 0;
 		return;
@@ -744,6 +807,8 @@ static void uvc_video_complete(struct urb *urb)
 	unsigned long flags;
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	switch (urb->status) {
 	case 0:
 		break;
@@ -783,6 +848,8 @@ static void uvc_free_urb_buffers(struct uvc_streaming *stream)
 {
 	unsigned int i;
 
+	pr_debug("%s", __func__);
+
 	for (i = 0; i < UVC_URBS; ++i) {
 		if (stream->urb_buffer[i]) {
 			usb_free_coherent(stream->dev->udev, stream->urb_size,
@@ -811,6 +878,8 @@ static int uvc_alloc_urb_buffers(struct uvc_streaming *stream,
 	unsigned int npackets;
 	unsigned int i;
 
+	pr_debug("%s", __func__);
+
 	/* Buffers are already allocated, bail out. */
 	if (stream->urb_size)
 		return stream->urb_size / psize;
@@ -836,15 +905,15 @@ static int uvc_alloc_urb_buffers(struct uvc_streaming *stream,
 		}
 
 		if (i == UVC_URBS) {
-			uvc_trace(UVC_TRACE_VIDEO, "Allocated %u URB buffers "
-				"of %ux%u bytes each.\n", UVC_URBS, npackets,
-				psize);
+			pr_debug("%s: Allocated %u URB buffers "
+				"of %ux%u bytes each.", __func__,
+				UVC_URBS, npackets, psize);
 			return npackets;
 		}
 	}
 
-	uvc_trace(UVC_TRACE_VIDEO, "Failed to allocate URB buffers (%u bytes "
-		"per packet).\n", psize);
+	pr_debug("%s: Failed to allocate URB buffers (%u bytes "
+		"per packet).", __func__, psize);
 	return 0;
 }
 
@@ -856,6 +925,8 @@ static void uvc_uninit_video(struct uvc_streaming *stream, int free_buffers)
 	struct urb *urb;
 	unsigned int i;
 
+	pr_debug("%s", __func__);
+
 	for (i = 0; i < UVC_URBS; ++i) {
 		urb = stream->urb[i];
 		if (urb == NULL)
@@ -882,6 +953,8 @@ static int uvc_init_video_isoc(struct uvc_streaming *stream,
 	u16 psize;
 	u32 size;
 
+	pr_debug("%s", __func__);
+
 	psize = le16_to_cpu(ep->desc.wMaxPacketSize);
 	psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
 	size = stream->ctrl.dwMaxVideoFrameSize;
@@ -934,6 +1007,8 @@ static int uvc_init_video_bulk(struct uvc_streaming *stream,
 	u16 psize;
 	u32 size;
 
+	pr_debug("%s", __func__);
+
 	psize = le16_to_cpu(ep->desc.wMaxPacketSize) & 0x07ff;
 	size = stream->ctrl.dwMaxPayloadTransferSize;
 	stream->bulk.max_payload_size = size;
@@ -983,6 +1058,8 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
 	unsigned int i;
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	stream->sequence = -1;
 	stream->last_fid = -1;
 	stream->bulk.header_size = 0;
@@ -1000,12 +1077,12 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
 		bandwidth = stream->ctrl.dwMaxPayloadTransferSize;
 
 		if (bandwidth == 0) {
-			uvc_trace(UVC_TRACE_VIDEO, "Device requested null "
-				"bandwidth, defaulting to lowest.\n");
+			pr_debug("%s: Device requested null "
+				"bandwidth, defaulting to lowest.", __func__);
 			bandwidth = 1;
 		} else {
-			uvc_trace(UVC_TRACE_VIDEO, "Device requested %u "
-				"B/frame bandwidth.\n", bandwidth);
+			pr_debug("%s: Device requested %u "
+				"B/frame bandwidth.", __func__, bandwidth);
 		}
 
 		for (i = 0; i < intf->num_altsetting; ++i) {
@@ -1029,13 +1106,14 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
 		}
 
 		if (best_ep == NULL) {
-			uvc_trace(UVC_TRACE_VIDEO, "No fast enough alt setting "
-				"for requested bandwidth.\n");
+			pr_debug("%s: No fast enough alt setting "
+				"for requested bandwidth.", __func__);
 			return -EIO;
 		}
 
-		uvc_trace(UVC_TRACE_VIDEO, "Selecting alternate setting %u "
-			"(%u B/frame bandwidth).\n", altsetting, best_psize);
+		pr_debug("%s: Selecting alternate setting %u "
+			"(%u B/frame bandwidth).", __func__,
+			altsetting, best_psize);
 
 		ret = usb_set_interface(stream->dev->udev, intfnum, altsetting);
 		if (ret < 0)
@@ -1082,6 +1160,9 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
  */
 int uvc_video_suspend(struct uvc_streaming *stream)
 {
+
+	pr_debug("%s", __func__);
+
 	if (!uvc_queue_streaming(&stream->queue))
 		return 0;
 
@@ -1103,6 +1184,8 @@ int uvc_video_resume(struct uvc_streaming *stream)
 {
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	stream->frozen = 0;
 
 	ret = uvc_commit_video(stream, &stream->ctrl);
@@ -1143,6 +1226,8 @@ int uvc_video_init(struct uvc_streaming *stream)
 	unsigned int i;
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	if (stream->nformats == 0) {
 		uvc_printk(KERN_INFO, "No supported video formats found.\n");
 		return -EINVAL;
@@ -1237,6 +1322,8 @@ int uvc_video_enable(struct uvc_streaming *stream, int enable)
 {
 	int ret;
 
+	pr_debug("%s", __func__);
+
 	if (!enable) {
 		uvc_uninit_video(stream, 1);
 		usb_set_interface(stream->dev->udev, stream->intfnum, 0);
-- 
1.7.1



From bug-track at fisher-privat.net  Sun Mar  6 11:57:14 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun,  6 Mar 2011 11:57:14 +0100
Subject: [Linux-uvc-devel] [PATCH 2/3] Recalculate dwMaxVideoFrameBufferSize
	for MJPEG
In-Reply-To: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
Message-ID: <1299409035-28090-2-git-send-email-bug-track@fisher-privat.net>

Some webcams report wired dwMaxVideoFrameBufferSize size,
some times too big, some times too smole.

I tested two webcams:
046d:0809 Logitech, Inc. Webcam Pro 9000
046d:0991 Logitech, Inc. QuickCam Pro for Notebooks
with fallowing results.

The dwMaxVideoFrameBufferSize is not always the same. Reported
range is about betwene 4 and 10 bpp calculated with this formula:
bpp = (dwMaxVideoFrameBufferSize * 8) / (frame->wWidth * frame->wHeight)

I tested also a real comression on this cameras. Comression
with noremal conditions (video chat) was about 1 bpp.
Worst compression was by captureing moving text on monitore
(lots of light, high fps) is about 3bpp.
So we can calculate predictable buffer size in driver, insted of
getting some random numers from the cam.

Setting bpp to 4 for mjpeg should be safe.

Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
---
 drivers/media/video/uvc/uvc_driver.c |    5 +++--
 drivers/media/video/uvc/uvc_video.c  |    3 ++-
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/drivers/media/video/uvc/uvc_driver.c b/drivers/media/video/uvc/uvc_driver.c
index e41285a..5a74de0 100644
--- a/drivers/media/video/uvc/uvc_driver.c
+++ b/drivers/media/video/uvc/uvc_driver.c
@@ -347,7 +347,7 @@ static int uvc_parse_format(struct uvc_device *dev,
 		strlcpy(format->name, "MJPEG", sizeof format->name);
 		format->fcc = V4L2_PIX_FMT_MJPEG;
 		format->flags = UVC_FMT_FLAG_COMPRESSED;
-		format->bpp = 0;
+		format->bpp = 4;
 		ftype = UVC_VS_FRAME_MJPEG;
 		break;
 
@@ -460,7 +460,8 @@ static int uvc_parse_format(struct uvc_device *dev,
 		 * uncompressed formats this can be fixed by computing the
 		 * value from the frame size.
 		 */
-		if (!(format->flags & UVC_FMT_FLAG_COMPRESSED))
+		if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
+				(format->fcc == V4L2_PIX_FMT_MJPEG))
 			frame->dwMaxVideoFrameBufferSize = format->bpp
 				* frame->wWidth * frame->wHeight / 8;
 
diff --git a/drivers/media/video/uvc/uvc_video.c b/drivers/media/video/uvc/uvc_video.c
index 9a95a62..64bd1d6 100644
--- a/drivers/media/video/uvc/uvc_video.c
+++ b/drivers/media/video/uvc/uvc_video.c
@@ -114,7 +114,8 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 
 	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
 	     (ctrl->dwMaxVideoFrameSize == 0 &&
-	      stream->dev->uvc_version < 0x0110)) {
+	      stream->dev->uvc_version < 0x0110) ||
+	     (format->fcc == V4L2_PIX_FMT_MJPEG)) {
 		pr_debug("%s: rewrite dwMaxVideoFrameSize=%u to %u.",
 			 __func__, ctrl->dwMaxVideoFrameSize,
 			frame->dwMaxVideoFrameBufferSize);
-- 
1.7.1



From bug-track at fisher-privat.net  Sun Mar  6 11:57:15 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun,  6 Mar 2011 11:57:15 +0100
Subject: [Linux-uvc-devel] [PATCH 3/3] Make video fixup more robust
In-Reply-To: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
Message-ID: <1299409035-28090-3-git-send-email-bug-track@fisher-privat.net>

Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
---
 drivers/media/video/uvc/uvc_video.c |   59 ++++++++++++++++++++++++++++++-----
 1 files changed, 51 insertions(+), 8 deletions(-)

diff --git a/drivers/media/video/uvc/uvc_video.c b/drivers/media/video/uvc/uvc_video.c
index 64bd1d6..5380189 100644
--- a/drivers/media/video/uvc/uvc_video.c
+++ b/drivers/media/video/uvc/uvc_video.c
@@ -92,10 +92,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 {
 	struct uvc_format *format;
 	struct uvc_frame *frame = NULL;
+	struct usb_host_endpoint *ep;
 	unsigned int i;
 
-	pr_debug("%s", __func__);
-
 	if (ctrl->bFormatIndex <= 0 ||
 	    ctrl->bFormatIndex > stream->nformats)
 		return;
@@ -112,6 +111,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 	if (frame == NULL)
 		return;
 
+	pr_debug("%s: %s %ux%u", __func__,
+		 format->name, frame->wWidth, frame->wHeight);
+
 	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
 	     (ctrl->dwMaxVideoFrameSize == 0 &&
 	      stream->dev->uvc_version < 0x0110) ||
@@ -123,11 +125,13 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 			frame->dwMaxVideoFrameBufferSize;
 	}
 
-	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) &&
+	if ((!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
+	      format->fcc == V4L2_PIX_FMT_MJPEG ) &&
 	    stream->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
 	    stream->intf->num_altsetting > 1) {
 		u32 interval;
 		u32 bandwidth;
+		unsigned int best_psize = 3 * 1024;
 
 		interval = (ctrl->dwFrameInterval > 100000)
 			 ? ctrl->dwFrameInterval
@@ -139,13 +143,17 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 		 * high-speed devices) per second and add the UVC header size
 		 * (assumed to be 12 bytes long).
 		 */
-		bandwidth = frame->wWidth * frame->wHeight / 8 * format->bpp;
+		bandwidth = frame->dwMaxVideoFrameBufferSize;
+		//bandwidth = frame->wWidth * frame->wHeight / 8 * format->bpp;
 		bandwidth *= 10000000 / interval + 1;
 		bandwidth /= 1000;
 		if (stream->dev->udev->speed == USB_SPEED_HIGH)
 			bandwidth /= 8;
 		bandwidth += 12;
 
+		/* add 20% more, in some cases it is still not enough */
+		bandwidth *= 1.2;
+
 		/* The bandwidth estimate is too low for many cameras. Don't use
 		 * maximum packet sizes lower than 1024 bytes to try and work
 		 * around the problem. According to measurements done on two
@@ -153,12 +161,39 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
 		 * resolutions working while not preventing two simultaneous
 		 * VGA streams at 15 fps.
 		 */
+		pr_debug("%s: calculated bandwidth: %u for %u(fps); (before 1024 workaround).",
+			 __func__, bandwidth, 10000000/interval);
 		bandwidth = max_t(u32, bandwidth, 1024);
 
+		i = 0;
+		for (i = 0; i < stream->intf->num_altsetting; ++i) {
+			struct usb_host_interface *alts;
+			struct usb_host_endpoint *ep;
+			unsigned int psize;
+
+			alts = &stream->intf->altsetting[i];
+			ep = uvc_find_endpoint(alts,
+				stream->header.bEndpointAddress);
+			if (ep == NULL)
+				continue;
+
+			psize = le16_to_cpu(ep->desc.wMaxPacketSize);
+			psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
+			if ((psize >= bandwidth && psize <= best_psize) ||
+			    (i == stream->intf->num_altsetting - 1)) {
+				if (bandwidth > psize)
+					pr_debug("%s: trying psize=%u even if "
+						 "bandwidth=%u", __func__,
+						 psize, bandwidth);
+				best_psize = psize;
+				break;
+			}
+		}
+
 		pr_debug("%s: rewrite dwMaxPayloadTransferSize=%u to %u.",
-			__func__, ctrl->dwMaxPayloadTransferSize, bandwidth);
+			__func__, ctrl->dwMaxPayloadTransferSize, best_psize);
 
-		ctrl->dwMaxPayloadTransferSize = bandwidth;
+		ctrl->dwMaxPayloadTransferSize = best_psize;
 	}
 }
 
@@ -1099,11 +1134,19 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
 			/* Check if the bandwidth is high enough. */
 			psize = le16_to_cpu(ep->desc.wMaxPacketSize);
 			psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
-			if (psize >= bandwidth && psize <= best_psize) {
+			pr_debug("%s: bandwidth: %u; psize: %u; best_psize: %u",
+				 __func__, bandwidth, psize, best_psize);
+			if ((psize >= bandwidth && psize <= best_psize) ||
+			    (i == intf->num_altsetting - 1)) {
+				if (bandwidth > psize)
+					pr_debug("%s: trying psize=%u even if "
+						 "bandwidth=%u", __func__,
+						 psize, bandwidth);
 				altsetting = i;
 				best_psize = psize;
 				best_ep = ep;
-			}
+				break;
+			} 
 		}
 
 		if (best_ep == NULL) {
-- 
1.7.1



From bug-track at fisher-privat.net  Sun Mar  6 12:00:27 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun, 06 Mar 2011 12:00:27 +0100
Subject: [Linux-uvc-devel] [PATCH 0/0] description
In-Reply-To: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
Message-ID: <1299409227.25720.3.camel@zwerg>

Hi,

i had some time to play with some webcams i had access to, and made some
patches for it.
Please take a look,
if you think this is a good idea, i'll try to make them more clean.

-- 
Regards,
        Alexey



From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:14:19 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:14:19 +0100
Subject: [Linux-uvc-devel] Logitech C910 -- trying to run more than one.
In-Reply-To: <4D618034.5030807@gladstonefamily.net>
References: <4D618034.5030807@gladstonefamily.net>
Message-ID: <201103061214.19341.laurent.pinchart@ideasonboard.com>

Hi Philip,

On Sunday 20 February 2011 21:57:24 Philip Gladstone wrote:
> I attached two C910s to a small linux box, and ran into the 'Failed to
> submit URB' problem.
> 
> When I look at the descriptors for this camera, I think I understand the
> problem. I'm capturing at 5 Mpixels and I'm trying two cameras.
> 
>        VideoStreaming Interface Descriptor:
>          bLength                            38
>          bDescriptorType                    36
>          bDescriptorSubtype                  7 (FRAME_MJPEG)
>          bFrameIndex                        28
>          bmCapabilities                   0x01
>            Still image supported
>          wWidth                           2592
>          wHeight                          1944
>          dwMinBitRate                403107840
>          dwMaxBitRate                806215680
>          dwMaxVideoFrameBufferSize    10077696
>          dwDefaultFrameInterval        1000000
>          bFrameIntervalType                  3
>          dwFrameInterval( 0)           1000000
>          dwFrameInterval( 1)           1333333
>          dwFrameInterval( 2)           2000000
> 
> The video frame size is set to 10Mb. This is surprisingly large as
> actual frames captured with MJPEG on this camera are typically 500kb or
> less. When I checked the descriptor for the uncompressed version of the
> same frame, it came back with the same value of dwMaxVideoFrameBufferSize
> (effectively 16 bits per pixel). The values for min/max bit rate are
> (correctly) calculated from the frame intervals and the buffer size.

The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field to compute 
the required bandwidth but queries the device at runtime instead.

You can enable the UVC_TRACE_VIDEO trace flag to get the driver to print the 
bandwidth requested by the device to the kernel log.

> Typical JPEG compression gets down to 1 bit per pixel, and 2 bits is
> very unusual.
> 
> What I want to know is what the impact would be of defining a new QUIRK
> that overrode the frame buffer size for compressed frames and calculated
> them at (say) 2 bits per pixel?
> 
> Do other webcams get this right?

You would be surprised by how many webcams get things wrong.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:19:35 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:19:35 +0100
Subject: [Linux-uvc-devel] MS Lifecam disconnect event
In-Reply-To: <AANLkTi=zeM=qbkEA57rJnpS_LrySH0C59jWR6MUhqrb2@mail.gmail.com>
References: <AANLkTikzGL96pKUbBNvLhF79MZv_94UoFk0YPKOSsxEV@mail.gmail.com>
	<201102152007.04506.laurent.pinchart@ideasonboard.com>
	<AANLkTi=zeM=qbkEA57rJnpS_LrySH0C59jWR6MUhqrb2@mail.gmail.com>
Message-ID: <201103061219.35253.laurent.pinchart@ideasonboard.com>

Hi,

On Tuesday 22 February 2011 01:53:59 linux newbie wrote:
> [  515.220000] hub 1-0:1.0: state 7 ports 2 chg 0000 evt 0004
> [  515.220000] str8100-ehci str8100-ehci: GetStatus port 2 status
> 001009 POWER sig=se0 PEC CONNECT
> [  515.220000] hub 1-0:1.0: port 2 enable change, status 00000501
> [  515.220000] hub 1-0:1.0: port 2 disabled by hub (EMI?), re-enabling...
> [  515.220000] hub 1-0:1.0: port 2, status 0501, change 0002, 480 Mb/s
> [  515.220000] usb 1-2: USB disconnect, address 2
> [  515.220000] usb 1-2: unregistering device
> [  515.220000] usb 1-2: usb_disable_device nuking all URBs
> [  515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbe000 ep1in-iso
> [  515.220000] str8100-ehci str8100-ehci: shutdown urb c3c4d000 ep1in-iso
> [  515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbf800 ep1in-iso
> [  515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbf000 ep1in-iso
> [  515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbe800 ep1in-iso
> [  515.260000] usb 1-2: unlink qh16-0001/ffc02100 start 15 [1/0 us]
> [  515.260000] str8100-ehci str8100-ehci: shutdown urb c3c5b540 ep3in-intr
> [  515.260000] usb 1-2: unregistering interface 1-2:1.0
> [  515.270000] usb 1-2:1.0: uevent
> [  515.270000] usb 1-2: unregistering interface 1-2:1.1
> [  515.270000] usb 1-2:1.1: uevent
> [  515.280000] usb 1-2: unregistering interface 1-2:1.2
> [  515.280000] usb 1-2:1.2: uevent
> [  515.280000] usb 1-2: unregistering interface 1-2:1.3
> [  515.280000] usb 1-2:1.3: uevent
> [  515.280000] usb 1-2: uevent
> [  515.340000] str8100-ehci str8100-ehci: GetStatus port 2 status
> 001002 POWER sig=se0 CSC
> [  515.340000] hub 1-0:1.0: state 7 ports 2 chg 0000 evt 0004

That's a low-level USB issue. Bad cables, buggy webcam, noisy environment, ... 
The uvcvideo driver isn't at fault. If the camera decides to disconnect, 
there's little the driver can do.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:25:00 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:25:00 +0100
Subject: [Linux-uvc-devel] Microsoft LifeCam HD-5000 exposure/fps
	problem and a workaround
In-Reply-To: <AANLkTinwmkQBMnncZX2=MT7USfm5d3duqs5MqScHUwOF@mail.gmail.com>
References: <AANLkTinwmkQBMnncZX2=MT7USfm5d3duqs5MqScHUwOF@mail.gmail.com>
Message-ID: <201103061225.01067.laurent.pinchart@ideasonboard.com>

Hi Jani,

On Sunday 27 February 2011 08:42:33 Jani Frilander wrote:
> Hi.
> 
> I have a Microsoft LifeCam HD-5000 (045e:076d) working almost perfectly.

Could you please send me the output of

lsusb -v -d 045e:076d

(running as root if possible) ?

> I had some trouble getting a mjpeg stream @ 30 fps out of it. I figured out
> that I needed to turn auto-exposure off and adjust it manually.
> 
> But the camera does not respond to exposure adjustment linearly. There
> are some valid values between 5-20000. They are from darkest to brightest
> 5, 9 & 10 (same brightness), 19 & 20, 39, 78, 156, 312, 625, 1250, 2500,
> 5000 and 10000. Every other value gives the maximum brightness. 156 is the
> maximum value to get 30 fps.

Looks like the webcam has been designed by yet another brain-dead developer. 
*sigh* :-(

What are the minimum, maximum, default and step values reported by the driver 
when you query the exposure control ?

> I'm running 2.6.32-29-generic kernel on Ubuntu Lucid 64-bit. Don't know the
> driver version.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:34:38 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:34:38 +0100
Subject: [Linux-uvc-devel] Add GUID to UVC
In-Reply-To: <loom.20110302T150222-830@post.gmane.org>
References: <loom.20110302T150222-830@post.gmane.org>
Message-ID: <201103061234.39032.laurent.pinchart@ideasonboard.com>

Hi Robert,

On Wednesday 02 March 2011 15:08:49 Robert Lukassen wrote:
> Hi,
> 
> I have a request to add support for a particular pixel-format (RGB565) to
> the list of recognized formats in UVC. This format is known in video for
> linux, but UVC does not list it.
> 
> Here are the (rather minimal) patches with respect to the latest version of
> the UVC driver as used in Ubuntu 10.04 (kernel 2.6.32-28):

Thanks for the patch.

> diff -uN /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvc_driver.c
> uvc-new/uvc_driver.c
> ---
> /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvc_driver.c	2009-12-
> 03 04:51:21.000000000 +0100
> +++ uvc-new/uvc_driver.c	2011-03-02 14:54:36.000000000 +0100
> @@ -92,6 +92,11 @@
>  		.guid		= UVC_GUID_FORMAT_BY8,
>  		.fcc		= V4L2_PIX_FMT_SBGGR8,
>  	},
> +	{
> +		.name		= "RGB565",
> +		.guid		= UVC_GUID_FORMAT_RGBP,
> +		.fcc		= V4L2_PIX_FMT_RGB565,
> +	},
>  };
> 
>  /*
> ------------------------------------------------------------------------
> diff -uN /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvcvideo.h
> uvc-new/uvcvideo.h
> ---
> /usr/src/linux-source-2.6.32/drivers/media/video/uvc/uvcvideo.h	2009-12-03
> 04:51:21.000000000 +0100
> +++ uvc-new/uvcvideo.h	2011-03-02 14:55:14.000000000 +0100
> @@ -130,7 +130,9 @@
>  #define UVC_GUID_FORMAT_BY8 \
>  	{ 'B',  'Y',  '8',  ' ', 0x00, 0x00, 0x10, 0x00, \
>  	 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
> -
> +#define UVC_GUID_FORMAT_RGBP \
> +	{ 'R',  'G',  'B',  'P', 0x00, 0x00, 0x10, 0x00, \
> +	 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
> 
>  /*
> ------------------------------------------------------------------------ *
> Driver specific constants.
> 
> There is a product in the market that uses this pixel format, but as the
> RGBP format is not supported out-of-the-box by UVC, we need to patch the
> kernel driver each time we go along with a kernel upgrade.

Can I ask you which product ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:42:40 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:42:40 +0100
Subject: [Linux-uvc-devel] [PATCH 2/3] Recalculate
	dwMaxVideoFrameBufferSize for MJPEG
In-Reply-To: <1299409035-28090-2-git-send-email-bug-track@fisher-privat.net>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
	<1299409035-28090-2-git-send-email-bug-track@fisher-privat.net>
Message-ID: <201103061242.40285.laurent.pinchart@ideasonboard.com>

Hi Alexey,

On Sunday 06 March 2011 11:57:14 Alexey Fisher wrote:
> Some webcams report wired dwMaxVideoFrameBufferSize size,
> some times too big, some times too smole.
> 
> I tested two webcams:
> 046d:0809 Logitech, Inc. Webcam Pro 9000
> 046d:0991 Logitech, Inc. QuickCam Pro for Notebooks
> with fallowing results.
> 
> The dwMaxVideoFrameBufferSize is not always the same. Reported
> range is about betwene 4 and 10 bpp calculated with this formula:
> bpp = (dwMaxVideoFrameBufferSize * 8) / (frame->wWidth * frame->wHeight)
> 
> I tested also a real comression on this cameras. Comression
> with noremal conditions (video chat) was about 1 bpp.
> Worst compression was by captureing moving text on monitore
> (lots of light, high fps) is about 3bpp.
> So we can calculate predictable buffer size in driver, insted of
> getting some random numers from the cam.
> 
> Setting bpp to 4 for mjpeg should be safe.

Can you but sure that it will be safe for *all* cameras ? I can't.

The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field but 
queries the device at runtime for the maximum frame size value (there's one 
exception to this though, the driver uses dwMaxVideoFrameBufferSize for 
pre-1.10 UVC devices that report a 0 frame size at runtime).

The field is also totally unrelated to USB bandwidth management, the maximum 
frame size value is only used to allocate the V4L2 buffers.

> Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
> ---
>  drivers/media/video/uvc/uvc_driver.c |    5 +++--
>  drivers/media/video/uvc/uvc_video.c  |    3 ++-
>  2 files changed, 5 insertions(+), 3 deletions(-)
> 
> diff --git a/drivers/media/video/uvc/uvc_driver.c
> b/drivers/media/video/uvc/uvc_driver.c index e41285a..5a74de0 100644
> --- a/drivers/media/video/uvc/uvc_driver.c
> +++ b/drivers/media/video/uvc/uvc_driver.c
> @@ -347,7 +347,7 @@ static int uvc_parse_format(struct uvc_device *dev,
>  		strlcpy(format->name, "MJPEG", sizeof format->name);
>  		format->fcc = V4L2_PIX_FMT_MJPEG;
>  		format->flags = UVC_FMT_FLAG_COMPRESSED;
> -		format->bpp = 0;
> +		format->bpp = 4;
>  		ftype = UVC_VS_FRAME_MJPEG;
>  		break;
> 
> @@ -460,7 +460,8 @@ static int uvc_parse_format(struct uvc_device *dev,
>  		 * uncompressed formats this can be fixed by computing the
>  		 * value from the frame size.
>  		 */
> -		if (!(format->flags & UVC_FMT_FLAG_COMPRESSED))
> +		if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
> +				(format->fcc == V4L2_PIX_FMT_MJPEG))
>  			frame->dwMaxVideoFrameBufferSize = format->bpp
>  				* frame->wWidth * frame->wHeight / 8;
> 
> diff --git a/drivers/media/video/uvc/uvc_video.c
> b/drivers/media/video/uvc/uvc_video.c index 9a95a62..64bd1d6 100644
> --- a/drivers/media/video/uvc/uvc_video.c
> +++ b/drivers/media/video/uvc/uvc_video.c
> @@ -114,7 +114,8 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> *stream,
> 
>  	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
>  	     (ctrl->dwMaxVideoFrameSize == 0 &&
> -	      stream->dev->uvc_version < 0x0110)) {
> +	      stream->dev->uvc_version < 0x0110) ||
> +	     (format->fcc == V4L2_PIX_FMT_MJPEG)) {
>  		pr_debug("%s: rewrite dwMaxVideoFrameSize=%u to %u.",
>  			 __func__, ctrl->dwMaxVideoFrameSize,
>  			frame->dwMaxVideoFrameBufferSize);

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:47:22 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:47:22 +0100
Subject: [Linux-uvc-devel] [PATCH 3/3] Make video fixup more robust
In-Reply-To: <1299409035-28090-3-git-send-email-bug-track@fisher-privat.net>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
	<1299409035-28090-3-git-send-email-bug-track@fisher-privat.net>
Message-ID: <201103061247.22800.laurent.pinchart@ideasonboard.com>

Hi Alexey,

On Sunday 06 March 2011 11:57:15 Alexey Fisher wrote:

A description of how you're making it more robust would be nice.

> Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
> ---
>  drivers/media/video/uvc/uvc_video.c |   59
> ++++++++++++++++++++++++++++++----- 1 files changed, 51 insertions(+), 8
> deletions(-)
> 
> diff --git a/drivers/media/video/uvc/uvc_video.c
> b/drivers/media/video/uvc/uvc_video.c index 64bd1d6..5380189 100644
> --- a/drivers/media/video/uvc/uvc_video.c
> +++ b/drivers/media/video/uvc/uvc_video.c
> @@ -92,10 +92,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> *stream, {
>  	struct uvc_format *format;
>  	struct uvc_frame *frame = NULL;
> +	struct usb_host_endpoint *ep;
>  	unsigned int i;
> 
> -	pr_debug("%s", __func__);
> -
>  	if (ctrl->bFormatIndex <= 0 ||
>  	    ctrl->bFormatIndex > stream->nformats)
>  		return;
> @@ -112,6 +111,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> *stream, if (frame == NULL)
>  		return;
> 
> +	pr_debug("%s: %s %ux%u", __func__,
> +		 format->name, frame->wWidth, frame->wHeight);
> +
>  	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
>  	     (ctrl->dwMaxVideoFrameSize == 0 &&
>  	      stream->dev->uvc_version < 0x0110) ||
> @@ -123,11 +125,13 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> *stream, frame->dwMaxVideoFrameBufferSize;
>  	}
> 
> -	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) &&
> +	if ((!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
> +	      format->fcc == V4L2_PIX_FMT_MJPEG ) &&
>  	    stream->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
>  	    stream->intf->num_altsetting > 1) {
>  		u32 interval;
>  		u32 bandwidth;
> +		unsigned int best_psize = 3 * 1024;
> 
>  		interval = (ctrl->dwFrameInterval > 100000)
>  			 ? ctrl->dwFrameInterval
> @@ -139,13 +143,17 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> *stream, * high-speed devices) per second and add the UVC header size
>  		 * (assumed to be 12 bytes long).
>  		 */
> -		bandwidth = frame->wWidth * frame->wHeight / 8 * format->bpp;
> +		bandwidth = frame->dwMaxVideoFrameBufferSize;
> +		//bandwidth = frame->wWidth * frame->wHeight / 8 * format->bpp;

Why ? The whole point of your patch set is to work around untrusted 
dwMaxVideoFrameBufferSize values.

>  		bandwidth *= 10000000 / interval + 1;
>  		bandwidth /= 1000;
>  		if (stream->dev->udev->speed == USB_SPEED_HIGH)
>  			bandwidth /= 8;
>  		bandwidth += 12;
> 
> +		/* add 20% more, in some cases it is still not enough */
> +		bandwidth *= 1.2;
> +

That's not the kind of things I can accept with very very good arguments. I 
don't want to break some cameras just to lower the size of the V4L2 buffers 
allocated by the driver.

>  		/* The bandwidth estimate is too low for many cameras. Don't use
>  		 * maximum packet sizes lower than 1024 bytes to try and work
>  		 * around the problem. According to measurements done on two
> @@ -153,12 +161,39 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> *stream, * resolutions working while not preventing two simultaneous
>  		 * VGA streams at 15 fps.
>  		 */
> +		pr_debug("%s: calculated bandwidth: %u for %u(fps); (before 1024
> workaround).", +			 __func__, bandwidth, 10000000/interval);
>  		bandwidth = max_t(u32, bandwidth, 1024);
> 
> +		i = 0;
> +		for (i = 0; i < stream->intf->num_altsetting; ++i) {
> +			struct usb_host_interface *alts;
> +			struct usb_host_endpoint *ep;
> +			unsigned int psize;
> +
> +			alts = &stream->intf->altsetting[i];
> +			ep = uvc_find_endpoint(alts,
> +				stream->header.bEndpointAddress);
> +			if (ep == NULL)
> +				continue;
> +
> +			psize = le16_to_cpu(ep->desc.wMaxPacketSize);
> +			psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
> +			if ((psize >= bandwidth && psize <= best_psize) ||
> +			    (i == stream->intf->num_altsetting - 1)) {
> +				if (bandwidth > psize)
> +					pr_debug("%s: trying psize=%u even if "
> +						 "bandwidth=%u", __func__,
> +						 psize, bandwidth);
> +				best_psize = psize;
> +				break;
> +			}
> +		}
> +
>  		pr_debug("%s: rewrite dwMaxPayloadTransferSize=%u to %u.",
> -			__func__, ctrl->dwMaxPayloadTransferSize, bandwidth);
> +			__func__, ctrl->dwMaxPayloadTransferSize, best_psize);
> 
> -		ctrl->dwMaxPayloadTransferSize = bandwidth;
> +		ctrl->dwMaxPayloadTransferSize = best_psize;

Is this needed ? uvc_init_video() already selects the best endpoint alternate 
setting based on the requested bandwidth. This looks like duplicate code, 
what's the point ?

>  	}
>  }
> 
> @@ -1099,11 +1134,19 @@ static int uvc_init_video(struct uvc_streaming
> *stream, gfp_t gfp_flags) /* Check if the bandwidth is high enough. */
>  			psize = le16_to_cpu(ep->desc.wMaxPacketSize);
>  			psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
> -			if (psize >= bandwidth && psize <= best_psize) {
> +			pr_debug("%s: bandwidth: %u; psize: %u; best_psize: %u",
> +				 __func__, bandwidth, psize, best_psize);
> +			if ((psize >= bandwidth && psize <= best_psize) ||
> +			    (i == intf->num_altsetting - 1)) {
> +				if (bandwidth > psize)
> +					pr_debug("%s: trying psize=%u even if "
> +						 "bandwidth=%u", __func__,
> +						 psize, bandwidth);
>  				altsetting = i;
>  				best_psize = psize;
>  				best_ep = ep;
> -			}
> +				break;
> +			}
>  		}
> 
>  		if (best_ep == NULL) {

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 12:58:29 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 12:58:29 +0100
Subject: [Linux-uvc-devel] 0ac8:0332 Z-Star Microelectronics Corp.
	webcam not working
In-Reply-To: <AANLkTimhvfbxy2hyq-D=o79t0+ZdALh_Wp3K+FnvrZ1x@mail.gmail.com>
References: <AANLkTimhvfbxy2hyq-D=o79t0+ZdALh_Wp3K+FnvrZ1x@mail.gmail.com>
Message-ID: <201103061258.29625.laurent.pinchart@ideasonboard.com>

Hi,

On Wednesday 26 January 2011 06:41:01 Mohamed Amine JALLOULI wrote:
> Good morning,
> 
> I bought a webcam called XSwebcam of TravelPAC. This webcam didn't
> worked. Do not worry, I have not directly posted a message to this mailing
> list. In fact, In fact, I took a look at http://doc.ubuntu-fr.org/webcam. In
> addition, I found a discussion in forum relative to this my webcam, titled: 
> Probl?me de Webcam, logiciel EasyCam (Nouveau Topic)
> http://forum.ubuntu-fr.org/viewtopic.php?pid=3153965 [unfortunately in
> french] and it was too long to follow (13 pages). So, let me to explain my
> problem:
> *My distribution:* Ubuntu 10.10
> The name of my webcam given by that command *lsusb:*
> *Bus 001 Device 002: ID 0ac8:0332 Z-Star Microelectronics Corp.*
> 
> According to the documentation of Ubuntu, I should begin by testing
> the command *gstreamer-properties*.The result is as follows:
> 
> The video entry is:
> * *modul (in french, it's greffon) *: Video for linux 2 (v4l2)
> ** peripheral*: Vega USB 2.0 Camera
> * *pipeline*: v4l2src device=/dev/video0"
> By clicking on the test button, *Nothing happens! No window has been opened
> and no video has been displayed.*
> 
> The next step according to the ubuntu documentation is trying *cheese*. It
> has been installed successfully and cheese displayed just a black image
> continuously! Cheese returned 0 error message.
> 
> The next step according to the ubuntu documentation is trying
> *camorama. *Things do not go well. camorama is blocked while adjusting the
> window siwe. camorama can be closed only by forcing it.
> 
> The next step according to the ubuntu documentation is trying *guvcviewer*.
> It is well installed, 0 error message, black image displayed continuously.
> 
> At this step, the ubuntu forum asked me try these commands:
> 
> amine at amine-laptop:~$ dmesg | tail -20
> [   92.456297] Skipping EDID probe due to cached edid
> [   92.944226] Skipping EDID probe due to cached edid
> [   94.844249] Skipping EDID probe due to cached edid
> [   99.640261] Skipping EDID probe due to cached edid
> [  131.992815] synaptics: using relaxed packet validation
> [  136.435435] lib80211_crypt: registered algorithm 'CCMP'
> [  136.549907] padlock: VIA PadLock not detected.
> [  136.574886] lib80211_crypt: registered algorithm 'TKIP'
> [  140.132657] lo: Disabled Privacy Extensions
> [  848.392081] usb 1-3: new high speed USB device using ehci_hcd and
> address 2 [  848.675852] Linux video capture interface: v2.00
> [  848.686488] uvcvideo: Found UVC 1.00 device Vega USB 2.0 Camera.
> (0ac8:0332) [  848.691098] input: Vega USB 2.0 Camera. as
> /devices/pci0000:00/0000:00:1d.7/usb1/1-3/1-3:1.0/input/input7
> [  848.691845] usbcore: registered new interface driver uvcvideo
> [  848.691848] USB Video Class driver (v0.1.0)
> [  848.705093] usbcore: registered new interface driver snd-usb-audio
> [  930.169131] usb 1-3: USB disconnect, address 2
> [  932.264104] usb 1-3: new high speed USB device using ehci_hcd and
> address 3 [  932.505770] uvcvideo: Found UVC 1.00 device Vega USB 2.0
> Camera. (0ac8:0332) [  932.511787] input: Vega USB 2.0 Camera. as
> /devices/pci0000:00/0000:00:1d.7/usb1/1-3/1-3:1.0/input/input8
> 
> Then, i run cheese in the terminal to catch any error message.
> 
> 
> amine at amine-laptop:~$ cheese
> amine at amine-laptop:~$
> 
> 
> The Ubuntu forum told me that according to the results of the two showed no
> error. The Ubuntu forum concluded that it could be possibly a driver bug.
> That's why I sent this message to this mailing list.
> 
> Is there Any idea for solving this problem?

Could you please try to set the quirks option to 0x10 when loading the 
uvcvideo driver ? Please also send me the output of

lsusb -v -d 0ac8:0332

(running as root if possible).

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 13:05:34 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 13:05:34 +0100
Subject: [Linux-uvc-devel] Logitech portable webcam C905 046d:080a
In-Reply-To: <4D3EDFFA.2070308@kymp.net>
References: <4D2B1038.4090306@kymp.net>
	<201101251413.53871.laurent.pinchart@ideasonboard.com>
	<4D3EDFFA.2070308@kymp.net>
Message-ID: <201103061305.34843.laurent.pinchart@ideasonboard.com>

Hi Riku,

On Tuesday 25 January 2011 15:36:42 Riku Sepp?l? wrote:
> On 01/25/2011 03:13 PM, Laurent Pinchart wrote:
> > Hi Riku,
> > 
> > On Monday 10 January 2011 14:57:12 Riku Sepp?l? wrote:
> >> Hi,
> >> 
> >> I just bought Logitech c905 webcam and wanted to inform that it works
> >> out of the box on Fedora 14.
> >> (kernel 2.6.35.10-74.fc14.x86_64) Device id is 046d:080a.
> > 
> > Thank you for the report.
> > 
> >> (I'd send output of lsusb -v -d 046d:080a but the file is 66k and the
> >> mailing-list allows only 40k attachments.)
> > 
> > The limit has been raised, could you retry ?
> 
> Attached c905.txt

Thank you. I've updated the supported devices list.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Mar  6 13:12:38 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 13:12:38 +0100
Subject: [Linux-uvc-devel] JMicron 152d:0310 needs options quirks=2
In-Reply-To: <4D3EDC22.2000205@draigBrady.com>
References: <4D345BAD.20409@draigBrady.com>
	<201101251439.33491.laurent.pinchart@ideasonboard.com>
	<4D3EDC22.2000205@draigBrady.com>
Message-ID: <201103061312.39242.laurent.pinchart@ideasonboard.com>

Hi P?draig,

On Tuesday 25 January 2011 15:20:18 P?draig Brady wrote:
> On 25/01/11 13:39, Laurent Pinchart wrote:
> > On Monday 17 January 2011 16:09:33 P?draig Brady wrote:
> >> Otherwise one gets the following in dmesg:
> >> 
> >> uvcvideo: Failed to query (131) UVC probe control : -110 (exp. 26).
> >> uvcvideo: Failed to set UVC probe control : -110 (exp. 26).
> >> ...
> >> 
> >> That causes skype at least to core/hang on first
> >> open of /dev/video0 but work on subsequent runs.
> > 
> > Could you please send me the output of
> > 
> > lsusb -v -d 152d:0310
> > 
> > (running as root if possible) ?
> 
> Attached.

Thanks. I'll update the supported devices list and send a patch to mainline to 
add support for your webcam.

-- 
Regards,

Laurent Pinchart


From bug-track at fisher-privat.net  Sun Mar  6 13:32:29 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun, 06 Mar 2011 13:32:29 +0100
Subject: [Linux-uvc-devel] [PATCH 3/3] Make video fixup more robust
In-Reply-To: <201103061247.22800.laurent.pinchart@ideasonboard.com>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
	<1299409035-28090-3-git-send-email-bug-track@fisher-privat.net>
	<201103061247.22800.laurent.pinchart@ideasonboard.com>
Message-ID: <1299414749.8708.6.camel@mini>

Am Sonntag, den 06.03.2011, 12:47 +0100 schrieb Laurent Pinchart:
> Hi Alexey,
> 
> On Sunday 06 March 2011 11:57:15 Alexey Fisher wrote:
> 
> A description of how you're making it more robust would be nice.
> 
> > Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
> > ---
> >  drivers/media/video/uvc/uvc_video.c |   59
> > ++++++++++++++++++++++++++++++----- 1 files changed, 51 insertions(+), 8
> > deletions(-)
> > 
> > diff --git a/drivers/media/video/uvc/uvc_video.c
> > b/drivers/media/video/uvc/uvc_video.c index 64bd1d6..5380189 100644
> > --- a/drivers/media/video/uvc/uvc_video.c
> > +++ b/drivers/media/video/uvc/uvc_video.c
> > @@ -92,10 +92,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> > *stream, {
> >  	struct uvc_format *format;
> >  	struct uvc_frame *frame = NULL;
> > +	struct usb_host_endpoint *ep;
> >  	unsigned int i;
> > 
> > -	pr_debug("%s", __func__);
> > -
> >  	if (ctrl->bFormatIndex <= 0 ||
> >  	    ctrl->bFormatIndex > stream->nformats)
> >  		return;
> > @@ -112,6 +111,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> > *stream, if (frame == NULL)
> >  		return;
> > 
> > +	pr_debug("%s: %s %ux%u", __func__,
> > +		 format->name, frame->wWidth, frame->wHeight);
> > +
> >  	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
> >  	     (ctrl->dwMaxVideoFrameSize == 0 &&
> >  	      stream->dev->uvc_version < 0x0110) ||
> > @@ -123,11 +125,13 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> > *stream, frame->dwMaxVideoFrameBufferSize;
> >  	}
> > 
> > -	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) &&
> > +	if ((!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
> > +	      format->fcc == V4L2_PIX_FMT_MJPEG ) &&
> >  	    stream->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
> >  	    stream->intf->num_altsetting > 1) {
> >  		u32 interval;
> >  		u32 bandwidth;
> > +		unsigned int best_psize = 3 * 1024;
> > 
> >  		interval = (ctrl->dwFrameInterval > 100000)
> >  			 ? ctrl->dwFrameInterval
> > @@ -139,13 +143,17 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> > *stream, * high-speed devices) per second and add the UVC header size
> >  		 * (assumed to be 12 bytes long).
> >  		 */
> > -		bandwidth = frame->wWidth * frame->wHeight / 8 * format->bpp;
> > +		bandwidth = frame->dwMaxVideoFrameBufferSize;
> > +		//bandwidth = frame->wWidth * frame->wHeight / 8 * format->bpp;
> 
> Why ? The whole point of your patch set is to work around untrusted 
> dwMaxVideoFrameBufferSize values.
> 
> >  		bandwidth *= 10000000 / interval + 1;
> >  		bandwidth /= 1000;
> >  		if (stream->dev->udev->speed == USB_SPEED_HIGH)
> >  			bandwidth /= 8;
> >  		bandwidth += 12;
> > 
> > +		/* add 20% more, in some cases it is still not enough */
> > +		bandwidth *= 1.2;
> > +
> 
> That's not the kind of things I can accept with very very good arguments. I 
> don't want to break some cameras just to lower the size of the V4L2 buffers 
> allocated by the driver.
> 
> >  		/* The bandwidth estimate is too low for many cameras. Don't use
> >  		 * maximum packet sizes lower than 1024 bytes to try and work
> >  		 * around the problem. According to measurements done on two
> > @@ -153,12 +161,39 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> > *stream, * resolutions working while not preventing two simultaneous
> >  		 * VGA streams at 15 fps.
> >  		 */
> > +		pr_debug("%s: calculated bandwidth: %u for %u(fps); (before 1024
> > workaround).", +			 __func__, bandwidth, 10000000/interval);
> >  		bandwidth = max_t(u32, bandwidth, 1024);
> > 
> > +		i = 0;
> > +		for (i = 0; i < stream->intf->num_altsetting; ++i) {
> > +			struct usb_host_interface *alts;
> > +			struct usb_host_endpoint *ep;
> > +			unsigned int psize;
> > +
> > +			alts = &stream->intf->altsetting[i];
> > +			ep = uvc_find_endpoint(alts,
> > +				stream->header.bEndpointAddress);
> > +			if (ep == NULL)
> > +				continue;
> > +
> > +			psize = le16_to_cpu(ep->desc.wMaxPacketSize);
> > +			psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
> > +			if ((psize >= bandwidth && psize <= best_psize) ||
> > +			    (i == stream->intf->num_altsetting - 1)) {
> > +				if (bandwidth > psize)
> > +					pr_debug("%s: trying psize=%u even if "
> > +						 "bandwidth=%u", __func__,
> > +						 psize, bandwidth);
> > +				best_psize = psize;
> > +				break;
> > +			}
> > +		}
> > +
> >  		pr_debug("%s: rewrite dwMaxPayloadTransferSize=%u to %u.",
> > -			__func__, ctrl->dwMaxPayloadTransferSize, bandwidth);
> > +			__func__, ctrl->dwMaxPayloadTransferSize, best_psize);
> > 
> > -		ctrl->dwMaxPayloadTransferSize = bandwidth;
> > +		ctrl->dwMaxPayloadTransferSize = best_psize;
> 
> Is this needed ? uvc_init_video() already selects the best endpoint alternate 
> setting based on the requested bandwidth. This looks like duplicate code, 
> what's the point ?

Becouse we do uvc_set_video_ctrl with one bandwidth and uvc_video_init
with other. I do not know if it is good in case we recalculate the
value.

> 
> >  	}
> >  }
> > 
> > @@ -1099,11 +1134,19 @@ static int uvc_init_video(struct uvc_streaming
> > *stream, gfp_t gfp_flags) /* Check if the bandwidth is high enough. */
> >  			psize = le16_to_cpu(ep->desc.wMaxPacketSize);
> >  			psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
> > -			if (psize >= bandwidth && psize <= best_psize) {
> > +			pr_debug("%s: bandwidth: %u; psize: %u; best_psize: %u",
> > +				 __func__, bandwidth, psize, best_psize);
> > +			if ((psize >= bandwidth && psize <= best_psize) ||
> > +			    (i == intf->num_altsetting - 1)) {
> > +				if (bandwidth > psize)
> > +					pr_debug("%s: trying psize=%u even if "
> > +						 "bandwidth=%u", __func__,
> > +						 psize, bandwidth);

And here we can just fail, or try the luck (and may be fail). So this
part independet of all other changes.

> >  				altsetting = i;
> >  				best_psize = psize;
> >  				best_ep = ep;
> > -			}
> > +				break;
> > +			}
> >  		}

here we make too match loops, so it is nice to have here a break

> >  		if (best_ep == NULL) {
> 




From laurent.pinchart at ideasonboard.com  Sun Mar  6 13:34:07 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 13:34:07 +0100
Subject: [Linux-uvc-devel] Creative WebCam Live! Chat IM, increase fps
In-Reply-To: <AANLkTi=neHHDVx4shzk9+wxpdi1SWzYCTUYWCgvL6r6Z@mail.gmail.com>
References: <AANLkTi=FSishnq4j_oBZ9aDHVcGkcbQD6obhn-Pe4dF=@mail.gmail.com>
	<201101072202.01731.laurent.pinchart@ideasonboard.com>
	<AANLkTi=neHHDVx4shzk9+wxpdi1SWzYCTUYWCgvL6r6Z@mail.gmail.com>
Message-ID: <201103061334.07861.laurent.pinchart@ideasonboard.com>

Hi Alexander,

On Saturday 08 January 2011 14:47:41 Alexander Lopatin wrote:
> Sure. I've attached "lsusb -d 041e:406b -v" output, ran as root.

Thank you for the information, and apologies for the late reply. I've updated 
the supported devices list.

-- 
Regards,

Laurent Pinchart


From bug-track at fisher-privat.net  Sun Mar  6 13:40:39 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun, 06 Mar 2011 13:40:39 +0100
Subject: [Linux-uvc-devel] [PATCH 2/3] Recalculate
	dwMaxVideoFrameBufferSize for MJPEG
In-Reply-To: <201103061242.40285.laurent.pinchart@ideasonboard.com>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
	<1299409035-28090-2-git-send-email-bug-track@fisher-privat.net>
	<201103061242.40285.laurent.pinchart@ideasonboard.com>
Message-ID: <1299415239.8708.11.camel@mini>

Am Sonntag, den 06.03.2011, 12:42 +0100 schrieb Laurent Pinchart:
> Hi Alexey,
> 
> On Sunday 06 March 2011 11:57:14 Alexey Fisher wrote:
> > Some webcams report wired dwMaxVideoFrameBufferSize size,
> > some times too big, some times too smole.
> > 
> > I tested two webcams:
> > 046d:0809 Logitech, Inc. Webcam Pro 9000
> > 046d:0991 Logitech, Inc. QuickCam Pro for Notebooks
> > with fallowing results.
> > 
> > The dwMaxVideoFrameBufferSize is not always the same. Reported
> > range is about betwene 4 and 10 bpp calculated with this formula:
> > bpp = (dwMaxVideoFrameBufferSize * 8) / (frame->wWidth * frame->wHeight)
> > 
> > I tested also a real comression on this cameras. Comression
> > with noremal conditions (video chat) was about 1 bpp.
> > Worst compression was by captureing moving text on monitore
> > (lots of light, high fps) is about 3bpp.
> > So we can calculate predictable buffer size in driver, insted of
> > getting some random numers from the cam.
> > 
> > Setting bpp to 4 for mjpeg should be safe.
> 
> Can you but sure that it will be safe for *all* cameras ? I can't.
> 
> The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field but 
> queries the device at runtime for the maximum frame size value (there's one 
> exception to this though, the driver uses dwMaxVideoFrameBufferSize for 
> pre-1.10 UVC devices that report a 0 frame size at runtime).
> 
> The field is also totally unrelated to USB bandwidth management, the maximum 
> frame size value is only used to allocate the V4L2 buffers.


Correct. Suddently i found it later. But i use
dwMaxVideoFrameBufferSize in  uvc_fixup_video_ctrl to calculate
bundwidth (insted of bandwidth = frame->wWidth * frame->wHeight / 8 *
format->bpp).

The bandwidth do make a difference for usb.

> 
> > Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
> > ---
> >  drivers/media/video/uvc/uvc_driver.c |    5 +++--
> >  drivers/media/video/uvc/uvc_video.c  |    3 ++-
> >  2 files changed, 5 insertions(+), 3 deletions(-)
> > 
> > diff --git a/drivers/media/video/uvc/uvc_driver.c
> > b/drivers/media/video/uvc/uvc_driver.c index e41285a..5a74de0 100644
> > --- a/drivers/media/video/uvc/uvc_driver.c
> > +++ b/drivers/media/video/uvc/uvc_driver.c
> > @@ -347,7 +347,7 @@ static int uvc_parse_format(struct uvc_device *dev,
> >  		strlcpy(format->name, "MJPEG", sizeof format->name);
> >  		format->fcc = V4L2_PIX_FMT_MJPEG;
> >  		format->flags = UVC_FMT_FLAG_COMPRESSED;
> > -		format->bpp = 0;
> > +		format->bpp = 4;
> >  		ftype = UVC_VS_FRAME_MJPEG;
> >  		break;
> > 
> > @@ -460,7 +460,8 @@ static int uvc_parse_format(struct uvc_device *dev,
> >  		 * uncompressed formats this can be fixed by computing the
> >  		 * value from the frame size.
> >  		 */
> > -		if (!(format->flags & UVC_FMT_FLAG_COMPRESSED))
> > +		if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
> > +				(format->fcc == V4L2_PIX_FMT_MJPEG))
> >  			frame->dwMaxVideoFrameBufferSize = format->bpp
> >  				* frame->wWidth * frame->wHeight / 8;
> > 
> > diff --git a/drivers/media/video/uvc/uvc_video.c
> > b/drivers/media/video/uvc/uvc_video.c index 9a95a62..64bd1d6 100644
> > --- a/drivers/media/video/uvc/uvc_video.c
> > +++ b/drivers/media/video/uvc/uvc_video.c
> > @@ -114,7 +114,8 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming
> > *stream,
> > 
> >  	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
> >  	     (ctrl->dwMaxVideoFrameSize == 0 &&
> > -	      stream->dev->uvc_version < 0x0110)) {
> > +	      stream->dev->uvc_version < 0x0110) ||
> > +	     (format->fcc == V4L2_PIX_FMT_MJPEG)) {
> >  		pr_debug("%s: rewrite dwMaxVideoFrameSize=%u to %u.",
> >  			 __func__, ctrl->dwMaxVideoFrameSize,
> >  			frame->dwMaxVideoFrameBufferSize);
> 




From pj.assis at gmail.com  Sun Mar  6 13:47:16 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 6 Mar 2011 12:47:16 +0000
Subject: [Linux-uvc-devel] Logitech C910 -- trying to run more than one.
In-Reply-To: <201103061214.19341.laurent.pinchart@ideasonboard.com>
References: <4D618034.5030807@gladstonefamily.net>
	<201103061214.19341.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=RLXnSqcaFAOV19kaB1i_RjPKp6xqqZeVT3eWm@mail.gmail.com>

Hi,
please check this link:
http://forums.quickcamteam.net/showthread.php?tid=1305
 with a little fix to the previous patch the camera seems to work fine
with at least two units streaming at the same time.

I can't send an updated patch right now since my adsl connection is on
the slow side at the moment, and cloning the uvc git repo would take
several hours.
When/if I manage to get this done I'll post the full patch.

Regards,
Paulo

2011/3/6 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> Hi Philip,
>
> On Sunday 20 February 2011 21:57:24 Philip Gladstone wrote:
>> I attached two C910s to a small linux box, and ran into the 'Failed to
>> submit URB' problem.
>>
>> When I look at the descriptors for this camera, I think I understand the
>> problem. I'm capturing at 5 Mpixels and I'm trying two cameras.
>>
>> ? ? ? ?VideoStreaming Interface Descriptor:
>> ? ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?38
>> ? ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
>> ? ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
>> ? ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ?28
>> ? ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x01
>> ? ? ? ? ? ?Still image supported
>> ? ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? 2592
>> ? ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ?1944
>> ? ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ?403107840
>> ? ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?806215680
>> ? ? ? ? ?dwMaxVideoFrameBufferSize ? ?10077696
>> ? ? ? ? ?dwDefaultFrameInterval ? ? ? ?1000000
>> ? ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?3
>> ? ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? 1000000
>> ? ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? 1333333
>> ? ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? 2000000
>>
>> The video frame size is set to 10Mb. This is surprisingly large as
>> actual frames captured with MJPEG on this camera are typically 500kb or
>> less. When I checked the descriptor for the uncompressed version of the
>> same frame, it came back with the same value of dwMaxVideoFrameBufferSize
>> (effectively 16 bits per pixel). The values for min/max bit rate are
>> (correctly) calculated from the frame intervals and the buffer size.
>
> The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field to compute
> the required bandwidth but queries the device at runtime instead.
>
> You can enable the UVC_TRACE_VIDEO trace flag to get the driver to print the
> bandwidth requested by the device to the kernel log.
>
>> Typical JPEG compression gets down to 1 bit per pixel, and 2 bits is
>> very unusual.
>>
>> What I want to know is what the impact would be of defining a new QUIRK
>> that overrode the frame buffer size for compressed frames and calculated
>> them at (say) 2 bits per pixel?
>>
>> Do other webcams get this right?
>
> You would be surprised by how many webcams get things wrong.
>
> --
> Regards,
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From r3pek at r3pek.org  Sun Mar  6 13:55:16 2011
From: r3pek at r3pek.org (Carlos Silva)
Date: Sun, 6 Mar 2011 12:55:16 +0000
Subject: [Linux-uvc-devel] HP Pavillion DV3 WebCam
In-Reply-To: <201103061156.14985.laurent.pinchart@ideasonboard.com>
References: <AANLkTimF0ucM69vHaSf7Dxu4-=0Mw1b63KSXnEm69xY1@mail.gmail.com>
	<AANLkTi=4CEyGytG0zZzBAkHB35HEnpwHfwajPcFSPmdp@mail.gmail.com>
	<AANLkTinaFWGZbx=0Cse0qP4WjyeY7+C+-f-++ZXyA1bo@mail.gmail.com>
	<201103061156.14985.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=YWiGRn0CxMepzBoT-A9d0MDDcn9OhxCSd_3V_@mail.gmail.com>

On Sun, Mar 6, 2011 at 10:56, Laurent Pinchart <
laurent.pinchart at ideasonboard.com> wrote:

> Hi Carlos,
>
> On Sunday 20 February 2011 00:50:04 Carlos Silva wrote:
> > OK, just tested with no quirks and it works. Want me to send a patch for
> > it?
>
> If no quirk is required, you don't need to patch the driver. It will work
> out
> of the box.
>
Huummmm no. The device wasn't there. I had to added it myself (the
deviceid). At least on my kernel version... :/
Just checked and it's not on the latest kernel either.


> --
> Regards,
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110306/068a5f3f/attachment.html>

From laurent.pinchart at ideasonboard.com  Sun Mar  6 13:57:19 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 13:57:19 +0100
Subject: [Linux-uvc-devel] HP Pavillion DV3 WebCam
In-Reply-To: <AANLkTi=YWiGRn0CxMepzBoT-A9d0MDDcn9OhxCSd_3V_@mail.gmail.com>
References: <AANLkTimF0ucM69vHaSf7Dxu4-=0Mw1b63KSXnEm69xY1@mail.gmail.com>
	<201103061156.14985.laurent.pinchart@ideasonboard.com>
	<AANLkTi=YWiGRn0CxMepzBoT-A9d0MDDcn9OhxCSd_3V_@mail.gmail.com>
Message-ID: <201103061357.19844.laurent.pinchart@ideasonboard.com>

Hi Carlos,

On Sunday 06 March 2011 13:55:16 Carlos Silva wrote:
> On Sun, Mar 6, 2011 at 10:56, Laurent Pinchart wrote:
> > On Sunday 20 February 2011 00:50:04 Carlos Silva wrote:
> > > OK, just tested with no quirks and it works. Want me to send a patch
> > > for it?
> > 
> > If no quirk is required, you don't need to patch the driver. It will work
> > out
> > of the box.
> 
> Huummmm no. The device wasn't there. I had to added it myself (the
> deviceid). At least on my kernel version... :/
> Just checked and it's not on the latest kernel either.

What I mean is that the device entry doesn't need to be there. The driver 
should work out of the box without an entry for your device.

-- 
Regards,

Laurent Pinchart


From r3pek at r3pek.org  Sun Mar  6 14:02:08 2011
From: r3pek at r3pek.org (Carlos Silva)
Date: Sun, 6 Mar 2011 13:02:08 +0000
Subject: [Linux-uvc-devel] HP Pavillion DV3 WebCam
In-Reply-To: <201103061357.19844.laurent.pinchart@ideasonboard.com>
References: <AANLkTimF0ucM69vHaSf7Dxu4-=0Mw1b63KSXnEm69xY1@mail.gmail.com>
	<201103061156.14985.laurent.pinchart@ideasonboard.com>
	<AANLkTi=YWiGRn0CxMepzBoT-A9d0MDDcn9OhxCSd_3V_@mail.gmail.com>
	<201103061357.19844.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=t+tZCp29=sqaDxsR_+Y2CieWwBCt5qqT4VJs1@mail.gmail.com>

On Sun, Mar 6, 2011 at 12:57, Laurent Pinchart <
laurent.pinchart at ideasonboard.com> wrote:

> Hi Carlos,
>
> On Sunday 06 March 2011 13:55:16 Carlos Silva wrote:
> > On Sun, Mar 6, 2011 at 10:56, Laurent Pinchart wrote:
> > > On Sunday 20 February 2011 00:50:04 Carlos Silva wrote:
> > > > OK, just tested with no quirks and it works. Want me to send a patch
> > > > for it?
> > >
> > > If no quirk is required, you don't need to patch the driver. It will
> work
> > > out
> > > of the box.
> >
> > Huummmm no. The device wasn't there. I had to added it myself (the
> > deviceid). At least on my kernel version... :/
> > Just checked and it's not on the latest kernel either.
>
> What I mean is that the device entry doesn't need to be there. The driver
> should work out of the box without an entry for your device.
>

Ah, ok! But it didn't work... I can try again with a more recent kernel, but
this 2.6.37 it didn't work.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110306/6ce34aff/attachment.html>

From bug-track at fisher-privat.net  Sun Mar  6 14:04:38 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun, 06 Mar 2011 14:04:38 +0100
Subject: [Linux-uvc-devel] Logitech C910 -- trying to run more than one.
In-Reply-To: <AANLkTi=RLXnSqcaFAOV19kaB1i_RjPKp6xqqZeVT3eWm@mail.gmail.com>
References: <4D618034.5030807@gladstonefamily.net>
	<201103061214.19341.laurent.pinchart@ideasonboard.com>
	<AANLkTi=RLXnSqcaFAOV19kaB1i_RjPKp6xqqZeVT3eWm@mail.gmail.com>
Message-ID: <1299416678.8708.14.camel@mini>

Am Sonntag, den 06.03.2011, 12:47 +0000 schrieb Paulo Assis:
> Hi,
> please check this link:
> http://forums.quickcamteam.net/showthread.php?tid=1305
>  with a little fix to the previous patch the camera seems to work fine
> with at least two units streaming at the same time.
> 
> I can't send an updated patch right now since my adsl connection is on
> the slow side at the moment, and cloning the uvc git repo would take
> several hours.
> When/if I manage to get this done I'll post the full patch.

You do not need to,

i send a patch set to work with this problem,
Laurent need to think about it :D

> Regards,
> Paulo
> 
> 2011/3/6 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> > Hi Philip,
> >
> > On Sunday 20 February 2011 21:57:24 Philip Gladstone wrote:
> >> I attached two C910s to a small linux box, and ran into the 'Failed to
> >> submit URB' problem.
> >>
> >> When I look at the descriptors for this camera, I think I understand the
> >> problem. I'm capturing at 5 Mpixels and I'm trying two cameras.
> >>
> >>        VideoStreaming Interface Descriptor:
> >>          bLength                            38
> >>          bDescriptorType                    36
> >>          bDescriptorSubtype                  7 (FRAME_MJPEG)
> >>          bFrameIndex                        28
> >>          bmCapabilities                   0x01
> >>            Still image supported
> >>          wWidth                           2592
> >>          wHeight                          1944
> >>          dwMinBitRate                403107840
> >>          dwMaxBitRate                806215680
> >>          dwMaxVideoFrameBufferSize    10077696
> >>          dwDefaultFrameInterval        1000000
> >>          bFrameIntervalType                  3
> >>          dwFrameInterval( 0)           1000000
> >>          dwFrameInterval( 1)           1333333
> >>          dwFrameInterval( 2)           2000000
> >>
> >> The video frame size is set to 10Mb. This is surprisingly large as
> >> actual frames captured with MJPEG on this camera are typically 500kb or
> >> less. When I checked the descriptor for the uncompressed version of the
> >> same frame, it came back with the same value of dwMaxVideoFrameBufferSize
> >> (effectively 16 bits per pixel). The values for min/max bit rate are
> >> (correctly) calculated from the frame intervals and the buffer size.
> >
> > The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field to compute
> > the required bandwidth but queries the device at runtime instead.
> >
> > You can enable the UVC_TRACE_VIDEO trace flag to get the driver to print the
> > bandwidth requested by the device to the kernel log.
> >
> >> Typical JPEG compression gets down to 1 bit per pixel, and 2 bits is
> >> very unusual.
> >>
> >> What I want to know is what the impact would be of defining a new QUIRK
> >> that overrode the frame buffer size for compressed frames and calculated
> >> them at (say) 2 bits per pixel?
> >>
> >> Do other webcams get this right?
> >
> > You would be surprised by how many webcams get things wrong.
> >
> > --
> > Regards,
> >
> > Laurent Pinchart
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From laurent.pinchart at ideasonboard.com  Sun Mar  6 14:12:38 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 14:12:38 +0100
Subject: [Linux-uvc-devel] HP Pavillion DV3 WebCam
In-Reply-To: <AANLkTi=t+tZCp29=sqaDxsR_+Y2CieWwBCt5qqT4VJs1@mail.gmail.com>
References: <AANLkTimF0ucM69vHaSf7Dxu4-=0Mw1b63KSXnEm69xY1@mail.gmail.com>
	<201103061357.19844.laurent.pinchart@ideasonboard.com>
	<AANLkTi=t+tZCp29=sqaDxsR_+Y2CieWwBCt5qqT4VJs1@mail.gmail.com>
Message-ID: <201103061412.38381.laurent.pinchart@ideasonboard.com>

On Sunday 06 March 2011 14:02:08 Carlos Silva wrote:
> On Sun, Mar 6, 2011 at 12:57, Laurent Pinchart wrote:
> > On Sunday 06 March 2011 13:55:16 Carlos Silva wrote:
> > > On Sun, Mar 6, 2011 at 10:56, Laurent Pinchart wrote:
> > > > On Sunday 20 February 2011 00:50:04 Carlos Silva wrote:
> > > > > OK, just tested with no quirks and it works. Want me to send a
> > > > > patch for it?
> > > > 
> > > > If no quirk is required, you don't need to patch the driver. It will
> > > > work out of the box.
> > > 
> > > Huummmm no. The device wasn't there. I had to added it myself (the
> > > deviceid). At least on my kernel version... :/
> > > Just checked and it's not on the latest kernel either.
> > 
> > What I mean is that the device entry doesn't need to be there. The driver
> > should work out of the box without an entry for your device.
> 
> Ah, ok! But it didn't work... I can try again with a more recent kernel,
> but this 2.6.37 it didn't work.

How does it fail ? What are the log messages printed in the kernel log when 
you load the driver ?

-- 
Regards,

Laurent Pinchart


From bug-track at fisher-privat.net  Sun Mar  6 15:23:48 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun, 06 Mar 2011 15:23:48 +0100
Subject: [Linux-uvc-devel] [PATCH 1/3] Initial patch to use
	dynamic_debug system
In-Reply-To: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
References: <1299409035-28090-1-git-send-email-bug-track@fisher-privat.net>
Message-ID: <1299421428.8708.17.camel@mini>

Hi,

i need your feedback about the dynamic_debug patch. For me it is most
important. It make digging in to uvc code easier, especially for
beginners like me.

Am Sonntag, den 06.03.2011, 11:57 +0100 schrieb Alexey Fisher:
> it make possible use of fine tunable system.
> We can set exact verbosity.
> 
> Use case:
> 
> this will enablle all message in module uvcvideo:
> echo "module uvcvideo +p" > /sys/kernel/debug/dynamic_debug/control
> 
> this will disable message of function uvc_v4l2_do_ioctl:
> echo "func uvc_v4l2_do_ioctl -p" > /sys/kernel/debug/dynamic_debug/control
> 
> Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
> ---
>  drivers/media/video/uvc/uvc_queue.c |    8 ++-
>  drivers/media/video/uvc/uvc_v4l2.c  |    2 +
>  drivers/media/video/uvc/uvc_video.c |  137 ++++++++++++++++++++++++++++-------
>  3 files changed, 120 insertions(+), 27 deletions(-)
> 
> diff --git a/drivers/media/video/uvc/uvc_queue.c b/drivers/media/video/uvc/uvc_queue.c
> index 36f3c58..19e6cba 100644
> --- a/drivers/media/video/uvc/uvc_queue.c
> +++ b/drivers/media/video/uvc/uvc_queue.c
> @@ -137,6 +137,9 @@ int uvc_alloc_buffers(struct uvc_video_queue *queue, unsigned int nbuffers,
>  	void *mem = NULL;
>  	int ret;
>  
> +	pr_debug("%s: nbuffers %u; buflength: %u", __func__,
> +		nbuffers, buflength);
> +
>  	if (nbuffers > UVC_MAX_VIDEO_BUFFERS)
>  		nbuffers = UVC_MAX_VIDEO_BUFFERS;
>  
> @@ -347,8 +350,9 @@ int uvc_dequeue_buffer(struct uvc_video_queue *queue,
>  	if ((ret = uvc_queue_waiton(buf, nonblocking)) < 0)
>  		goto done;
>  
> -	uvc_trace(UVC_TRACE_CAPTURE, "Dequeuing buffer %u (%u, %u bytes).\n",
> -		buf->buf.index, buf->state, buf->buf.bytesused);
> +	pr_debug("%s: Dequeuing buffer %u (%u, %u/%u bytes).", __func__,
> +		buf->buf.index, buf->state,
> +		buf->buf.length, buf->buf.bytesused);
>  
>  	switch (buf->state) {
>  	case UVC_BUF_STATE_ERROR:
> diff --git a/drivers/media/video/uvc/uvc_v4l2.c b/drivers/media/video/uvc/uvc_v4l2.c
> index fa89ebf..3ba2563 100644
> --- a/drivers/media/video/uvc/uvc_v4l2.c
> +++ b/drivers/media/video/uvc/uvc_v4l2.c
> @@ -559,6 +559,8 @@ static long uvc_v4l2_do_ioctl(struct file *file, unsigned int cmd, void *arg)
>  	struct uvc_streaming *stream = handle->stream;
>  	long ret = 0;
>  
> +	pr_debug("%s: cmd: %u", __func__, cmd);
> +
>  	switch (cmd) {
>  	/* Query capabilities */
>  	case VIDIOC_QUERYCAP:
> diff --git a/drivers/media/video/uvc/uvc_video.c b/drivers/media/video/uvc/uvc_video.c
> index 43f955e..9a95a62 100644
> --- a/drivers/media/video/uvc/uvc_video.c
> +++ b/drivers/media/video/uvc/uvc_video.c
> @@ -73,6 +73,8 @@ int uvc_query_ctrl(struct uvc_device *dev, __u8 query, __u8 unit,
>  {
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	ret = __uvc_query_ctrl(dev, query, unit, intfnum, cs, data, size,
>  				UVC_CTRL_CONTROL_TIMEOUT);
>  	if (ret != size) {
> @@ -92,6 +94,8 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
>  	struct uvc_frame *frame = NULL;
>  	unsigned int i;
>  
> +	pr_debug("%s", __func__);
> +
>  	if (ctrl->bFormatIndex <= 0 ||
>  	    ctrl->bFormatIndex > stream->nformats)
>  		return;
> @@ -110,9 +114,13 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
>  
>  	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) ||
>  	     (ctrl->dwMaxVideoFrameSize == 0 &&
> -	      stream->dev->uvc_version < 0x0110))
> +	      stream->dev->uvc_version < 0x0110)) {
> +		pr_debug("%s: rewrite dwMaxVideoFrameSize=%u to %u.",
> +			 __func__, ctrl->dwMaxVideoFrameSize,
> +			frame->dwMaxVideoFrameBufferSize);
>  		ctrl->dwMaxVideoFrameSize =
>  			frame->dwMaxVideoFrameBufferSize;
> +	}
>  
>  	if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) &&
>  	    stream->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
> @@ -146,6 +154,9 @@ static void uvc_fixup_video_ctrl(struct uvc_streaming *stream,
>  		 */
>  		bandwidth = max_t(u32, bandwidth, 1024);
>  
> +		pr_debug("%s: rewrite dwMaxPayloadTransferSize=%u to %u.",
> +			__func__, ctrl->dwMaxPayloadTransferSize, bandwidth);
> +
>  		ctrl->dwMaxPayloadTransferSize = bandwidth;
>  	}
>  }
> @@ -157,6 +168,8 @@ static int uvc_get_video_ctrl(struct uvc_streaming *stream,
>  	__u16 size;
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	size = stream->dev->uvc_version >= 0x0110 ? 34 : 26;
>  	if ((stream->dev->quirks & UVC_QUIRK_PROBE_DEF) &&
>  			query == UVC_GET_DEF)
> @@ -233,6 +246,20 @@ static int uvc_get_video_ctrl(struct uvc_streaming *stream,
>  	uvc_fixup_video_ctrl(stream, ctrl);
>  	ret = 0;
>  
> +	pr_debug("%s: bmHint: %u; bFormatIndex: %u; bFrameIndex: %u; "
> +		 "dwFrameInterval: %u; wKeyFrameRate: %u; "
> +		 "wCompQuality: %u; wCompWindowSize: %u; wDelay: %u; "
> +		 "dwMaxVideoFrameSize %u; dwMaxPayloadTransferSize: %u",
> +		__func__, ctrl->bmHint,
> +		ctrl->bFormatIndex,
> +		ctrl->bFrameIndex,
> +		ctrl->dwFrameInterval,
> +		ctrl->wKeyFrameRate,
> +		ctrl->wCompQuality,
> +		ctrl->wCompWindowSize,
> +		ctrl->wDelay,
> +		ctrl->dwMaxVideoFrameSize,
> +		ctrl->dwMaxPayloadTransferSize);
>  out:
>  	kfree(data);
>  	return ret;
> @@ -245,6 +272,21 @@ static int uvc_set_video_ctrl(struct uvc_streaming *stream,
>  	__u16 size;
>  	int ret;
>  
> +	pr_debug("%s: bmHint: %u; bFormatIndex: %u; bFrameIndex: %u; "
> +		 "dwFrameInterval: %u; wKeyFrameRate: %u; "
> +		 "wCompQuality: %u; wCompWindowSize: %u; wDelay: %u; "
> +		 "dwMaxVideoFrameSize %u; dwMaxPayloadTransferSize: %u",
> +		__func__, ctrl->bmHint,
> +		ctrl->bFormatIndex,
> +		ctrl->bFrameIndex,
> +		ctrl->dwFrameInterval,
> +		ctrl->wKeyFrameRate,
> +		ctrl->wCompQuality,
> +		ctrl->wCompWindowSize,
> +		ctrl->wDelay,
> +		ctrl->dwMaxVideoFrameSize,
> +		ctrl->dwMaxPayloadTransferSize);
> +
>  	size = stream->dev->uvc_version >= 0x0110 ? 34 : 26;
>  	data = kzalloc(size, GFP_KERNEL);
>  	if (data == NULL)
> @@ -292,6 +334,8 @@ int uvc_probe_video(struct uvc_streaming *stream,
>  	unsigned int i;
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	/* Perform probing. The device should adjust the requested values
>  	 * according to its capabilities. However, some devices, namely the
>  	 * first generation UVC Logitech webcams, don't implement the Video
> @@ -349,6 +393,7 @@ done:
>  int uvc_commit_video(struct uvc_streaming *stream,
>  	struct uvc_streaming_control *probe)
>  {
> +	pr_debug("%s", __func__);
>  	return uvc_set_video_ctrl(stream, probe, 0);
>  }
>  
> @@ -406,6 +451,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
>  {
>  	__u8 fid;
>  
> +	pr_debug("%s", __func__);
> +
>  	/* Sanity checks:
>  	 * - packet must be at least 2 bytes long
>  	 * - bHeaderLength value must be at least 2 bytes (see above)
> @@ -416,8 +463,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
>  
>  	/* Skip payloads marked with the error bit ("error frames"). */
>  	if (data[1] & UVC_STREAM_ERR) {
> -		uvc_trace(UVC_TRACE_FRAME, "Dropping payload (error bit "
> -			  "set).\n");
> +		pr_debug("%s: Dropping payload (error bit "
> +			  "set).", __func__);
>  		return -ENODATA;
>  	}
>  
> @@ -449,8 +496,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
>  		struct timespec ts;
>  
>  		if (fid == stream->last_fid) {
> -			uvc_trace(UVC_TRACE_FRAME, "Dropping payload (out of "
> -				"sync).\n");
> +			pr_debug("%s: Dropping payload (out of "
> +				"sync).", __func__);
>  			if ((stream->dev->quirks & UVC_QUIRK_STREAM_NO_FID) &&
>  			    (data[1] & UVC_STREAM_EOF))
>  				stream->last_fid ^= UVC_STREAM_FID;
> @@ -486,8 +533,8 @@ static int uvc_video_decode_start(struct uvc_streaming *stream,
>  	 * previous payload had the EOF bit set.
>  	 */
>  	if (fid != stream->last_fid && buf->buf.bytesused != 0) {
> -		uvc_trace(UVC_TRACE_FRAME, "Frame complete (FID bit "
> -				"toggled).\n");
> +		pr_debug("%s: Frame complete (FID bit "
> +				"toggled).", __func__);
>  		buf->state = UVC_BUF_STATE_READY;
>  		return -EAGAIN;
>  	}
> @@ -504,6 +551,8 @@ static void uvc_video_decode_data(struct uvc_streaming *stream,
>  	unsigned int maxlen, nbytes;
>  	void *mem;
>  
> +	pr_debug("%s", __func__);
> +
>  	if (len <= 0)
>  		return;
>  
> @@ -516,7 +565,7 @@ static void uvc_video_decode_data(struct uvc_streaming *stream,
>  
>  	/* Complete the current frame if the buffer size was exceeded. */
>  	if (len > maxlen) {
> -		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
> +		pr_debug("%s: Frame complete (overflow).", __func__);
>  		buf->state = UVC_BUF_STATE_READY;
>  	}
>  }
> @@ -524,11 +573,14 @@ static void uvc_video_decode_data(struct uvc_streaming *stream,
>  static void uvc_video_decode_end(struct uvc_streaming *stream,
>  		struct uvc_buffer *buf, const __u8 *data, int len)
>  {
> +
> +	pr_debug("%s", __func__);
> +
>  	/* Mark the buffer as done if the EOF marker is set. */
>  	if (data[1] & UVC_STREAM_EOF && buf->buf.bytesused != 0) {
> -		uvc_trace(UVC_TRACE_FRAME, "Frame complete (EOF found).\n");
> +		pr_debug("%s: Frame complete (EOF found).", __func__);
>  		if (data[0] == len)
> -			uvc_trace(UVC_TRACE_FRAME, "EOF in empty payload.\n");
> +			pr_debug("%s: EOF in empty payload.", __func__);
>  		buf->state = UVC_BUF_STATE_READY;
>  		if (stream->dev->quirks & UVC_QUIRK_STREAM_NO_FID)
>  			stream->last_fid ^= UVC_STREAM_FID;
> @@ -549,6 +601,8 @@ static void uvc_video_decode_end(struct uvc_streaming *stream,
>  static int uvc_video_encode_header(struct uvc_streaming *stream,
>  		struct uvc_buffer *buf, __u8 *data, int len)
>  {
> +	pr_debug("%s", __func__);
> +
>  	data[0] = 2;	/* Header length */
>  	data[1] = UVC_STREAM_EOH | UVC_STREAM_EOF
>  		| (stream->last_fid & UVC_STREAM_FID);
> @@ -562,6 +616,8 @@ static int uvc_video_encode_data(struct uvc_streaming *stream,
>  	unsigned int nbytes;
>  	void *mem;
>  
> +	pr_debug("%s", __func__);
> +
>  	/* Copy video data to the URB buffer. */
>  	mem = queue->mem + buf->buf.m.offset + queue->buf_used;
>  	nbytes = min((unsigned int)len, buf->buf.bytesused - queue->buf_used);
> @@ -587,10 +643,13 @@ static void uvc_video_decode_isoc(struct urb *urb, struct uvc_streaming *stream,
>  	u8 *mem;
>  	int ret, i;
>  
> +	pr_debug("%s", __func__);
> +
>  	for (i = 0; i < urb->number_of_packets; ++i) {
>  		if (urb->iso_frame_desc[i].status < 0) {
> -			uvc_trace(UVC_TRACE_FRAME, "USB isochronous frame "
> -				"lost (%d).\n", urb->iso_frame_desc[i].status);
> +			pr_debug("%s: USB isochronous frame "
> +				"lost (%d).", __func__,
> +				urb->iso_frame_desc[i].status);
>  			/* Mark the buffer as faulty. */
>  			if (buf != NULL)
>  				buf->error = 1;
> @@ -635,6 +694,8 @@ static void uvc_video_decode_bulk(struct urb *urb, struct uvc_streaming *stream,
>  	u8 *mem;
>  	int len, ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	if (urb->actual_length == 0)
>  		return;
>  
> @@ -699,6 +760,8 @@ static void uvc_video_encode_bulk(struct urb *urb, struct uvc_streaming *stream,
>  	u8 *mem = urb->transfer_buffer;
>  	int len = stream->urb_size, ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	if (buf == NULL) {
>  		urb->transfer_buffer_length = 0;
>  		return;
> @@ -744,6 +807,8 @@ static void uvc_video_complete(struct urb *urb)
>  	unsigned long flags;
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	switch (urb->status) {
>  	case 0:
>  		break;
> @@ -783,6 +848,8 @@ static void uvc_free_urb_buffers(struct uvc_streaming *stream)
>  {
>  	unsigned int i;
>  
> +	pr_debug("%s", __func__);
> +
>  	for (i = 0; i < UVC_URBS; ++i) {
>  		if (stream->urb_buffer[i]) {
>  			usb_free_coherent(stream->dev->udev, stream->urb_size,
> @@ -811,6 +878,8 @@ static int uvc_alloc_urb_buffers(struct uvc_streaming *stream,
>  	unsigned int npackets;
>  	unsigned int i;
>  
> +	pr_debug("%s", __func__);
> +
>  	/* Buffers are already allocated, bail out. */
>  	if (stream->urb_size)
>  		return stream->urb_size / psize;
> @@ -836,15 +905,15 @@ static int uvc_alloc_urb_buffers(struct uvc_streaming *stream,
>  		}
>  
>  		if (i == UVC_URBS) {
> -			uvc_trace(UVC_TRACE_VIDEO, "Allocated %u URB buffers "
> -				"of %ux%u bytes each.\n", UVC_URBS, npackets,
> -				psize);
> +			pr_debug("%s: Allocated %u URB buffers "
> +				"of %ux%u bytes each.", __func__,
> +				UVC_URBS, npackets, psize);
>  			return npackets;
>  		}
>  	}
>  
> -	uvc_trace(UVC_TRACE_VIDEO, "Failed to allocate URB buffers (%u bytes "
> -		"per packet).\n", psize);
> +	pr_debug("%s: Failed to allocate URB buffers (%u bytes "
> +		"per packet).", __func__, psize);
>  	return 0;
>  }
>  
> @@ -856,6 +925,8 @@ static void uvc_uninit_video(struct uvc_streaming *stream, int free_buffers)
>  	struct urb *urb;
>  	unsigned int i;
>  
> +	pr_debug("%s", __func__);
> +
>  	for (i = 0; i < UVC_URBS; ++i) {
>  		urb = stream->urb[i];
>  		if (urb == NULL)
> @@ -882,6 +953,8 @@ static int uvc_init_video_isoc(struct uvc_streaming *stream,
>  	u16 psize;
>  	u32 size;
>  
> +	pr_debug("%s", __func__);
> +
>  	psize = le16_to_cpu(ep->desc.wMaxPacketSize);
>  	psize = (psize & 0x07ff) * (1 + ((psize >> 11) & 3));
>  	size = stream->ctrl.dwMaxVideoFrameSize;
> @@ -934,6 +1007,8 @@ static int uvc_init_video_bulk(struct uvc_streaming *stream,
>  	u16 psize;
>  	u32 size;
>  
> +	pr_debug("%s", __func__);
> +
>  	psize = le16_to_cpu(ep->desc.wMaxPacketSize) & 0x07ff;
>  	size = stream->ctrl.dwMaxPayloadTransferSize;
>  	stream->bulk.max_payload_size = size;
> @@ -983,6 +1058,8 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
>  	unsigned int i;
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	stream->sequence = -1;
>  	stream->last_fid = -1;
>  	stream->bulk.header_size = 0;
> @@ -1000,12 +1077,12 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
>  		bandwidth = stream->ctrl.dwMaxPayloadTransferSize;
>  
>  		if (bandwidth == 0) {
> -			uvc_trace(UVC_TRACE_VIDEO, "Device requested null "
> -				"bandwidth, defaulting to lowest.\n");
> +			pr_debug("%s: Device requested null "
> +				"bandwidth, defaulting to lowest.", __func__);
>  			bandwidth = 1;
>  		} else {
> -			uvc_trace(UVC_TRACE_VIDEO, "Device requested %u "
> -				"B/frame bandwidth.\n", bandwidth);
> +			pr_debug("%s: Device requested %u "
> +				"B/frame bandwidth.", __func__, bandwidth);
>  		}
>  
>  		for (i = 0; i < intf->num_altsetting; ++i) {
> @@ -1029,13 +1106,14 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
>  		}
>  
>  		if (best_ep == NULL) {
> -			uvc_trace(UVC_TRACE_VIDEO, "No fast enough alt setting "
> -				"for requested bandwidth.\n");
> +			pr_debug("%s: No fast enough alt setting "
> +				"for requested bandwidth.", __func__);
>  			return -EIO;
>  		}
>  
> -		uvc_trace(UVC_TRACE_VIDEO, "Selecting alternate setting %u "
> -			"(%u B/frame bandwidth).\n", altsetting, best_psize);
> +		pr_debug("%s: Selecting alternate setting %u "
> +			"(%u B/frame bandwidth).", __func__,
> +			altsetting, best_psize);
>  
>  		ret = usb_set_interface(stream->dev->udev, intfnum, altsetting);
>  		if (ret < 0)
> @@ -1082,6 +1160,9 @@ static int uvc_init_video(struct uvc_streaming *stream, gfp_t gfp_flags)
>   */
>  int uvc_video_suspend(struct uvc_streaming *stream)
>  {
> +
> +	pr_debug("%s", __func__);
> +
>  	if (!uvc_queue_streaming(&stream->queue))
>  		return 0;
>  
> @@ -1103,6 +1184,8 @@ int uvc_video_resume(struct uvc_streaming *stream)
>  {
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	stream->frozen = 0;
>  
>  	ret = uvc_commit_video(stream, &stream->ctrl);
> @@ -1143,6 +1226,8 @@ int uvc_video_init(struct uvc_streaming *stream)
>  	unsigned int i;
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	if (stream->nformats == 0) {
>  		uvc_printk(KERN_INFO, "No supported video formats found.\n");
>  		return -EINVAL;
> @@ -1237,6 +1322,8 @@ int uvc_video_enable(struct uvc_streaming *stream, int enable)
>  {
>  	int ret;
>  
> +	pr_debug("%s", __func__);
> +
>  	if (!enable) {
>  		uvc_uninit_video(stream, 1);
>  		usb_set_interface(stream->dev->udev, stream->intfnum, 0);




From j.frilander at gmail.com  Sun Mar  6 16:12:01 2011
From: j.frilander at gmail.com (Jani Frilander)
Date: Sun, 6 Mar 2011 17:12:01 +0200
Subject: [Linux-uvc-devel] Microsoft LifeCam HD-5000 exposure/fps
 problem and a workaround
In-Reply-To: <201103061225.01067.laurent.pinchart@ideasonboard.com>
References: <AANLkTinwmkQBMnncZX2=MT7USfm5d3duqs5MqScHUwOF@mail.gmail.com>
	<201103061225.01067.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTinO6p5p6ajZMLtFLh2VzNG81uYjKQ_xpV7TM3=B@mail.gmail.com>

Hi,

2011/3/6 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:

> Could you please send me the output of
>
> lsusb -v -d 045e:076d
>
> (running as root if possible) ?

Gzipped file attached.

> Looks like the webcam has been designed by yet another brain-dead developer.
> *sigh* :-(

Or maybe they have crippled it for a purpose.

> What are the minimum, maximum, default and step values reported by the driver
> when you query the exposure control ?
>

Output of v4l2-ctl -l:
brightness (int)  : min=30 max=255 step=1 default=133 value=153
contrast (int)  : min=0 max=10 step=1 default=5 value=5
saturation (int)  : min=0 max=200 step=1 default=83 value=83
white_balance_temperature_auto (bool) : default=1 value=1
power_line_frequency (menu) : min=0 max=2 default=2 value=1
white_balance_temperature (int)  : min=2800 max=10000 step=1
default=4500 value=3935
sharpness (int)  : min=0 max=50 step=1 default=20 value=50
backlight_compensation (int)  : min=0 max=10 step=1 default=0 value=0
exposure_auto (menu) : min=0 max=3 default=1 value=3
exposure_absolute (int)  : min=5 max=20000 step=1 default=156 value=156
focus_absolute (int)  : min=0 max=40 step=1 default=0 value=0
focus_auto (bool) : default=0 value=1
zoom_absolute (int)  : min=0 max=10 step=1 default=0 value=0

As a side note, this webcam doesn't support all exposure_auto values.
Output from guvcview, when trying out all modes:

checking format: 1196444237
VIDIOC_G_COMP:: Invalid argument
   compression control not supported
vid:045e
pid:076d
driver:uvcvideo
VIDIOC_S_CTRL - Unable to set control: Input/output error
Exposure, Auto change to 0 failed
hardware value is 3
VIDIOC_S_CTRL - Unable to set control: Input/output error
Exposure, Auto change to 2 failed
hardware value is 1

Hope this helps.

Regards,
Jani
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.gz
Type: application/x-gzip
Size: 3515 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110306/713ff6bc/attachment.bin>

From laurent.pinchart at ideasonboard.com  Sun Mar  6 22:01:29 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 6 Mar 2011 22:01:29 +0100
Subject: [Linux-uvc-devel] 0ac8:0332 Z-Star Microelectronics Corp.
	webcam not working
In-Reply-To: <AANLkTinbDFBnkzxTbquyJ1YQPmfqUfo9skJ-OgFE1Cs7@mail.gmail.com>
References: <AANLkTimhvfbxy2hyq-D=o79t0+ZdALh_Wp3K+FnvrZ1x@mail.gmail.com>
	<201103061258.29625.laurent.pinchart@ideasonboard.com>
	<AANLkTinbDFBnkzxTbquyJ1YQPmfqUfo9skJ-OgFE1Cs7@mail.gmail.com>
Message-ID: <201103062201.30495.laurent.pinchart@ideasonboard.com>

Hi Mohamed,

On Sunday 06 March 2011 21:50:57 Mohamed Amine JALLOULI wrote:
> Hi Laurent Pinchart,
> 
> Thanks you very much for answering ton my question.
> 
> First, how can I set the quirks option to 0x10 when loading the uvcvideo
> drive? (if you have a command line, it would be preferable.)

modprobe uvcvideo quirks=0x10

Make sure the driver is not already loaded, if it is, remove it with

modprobe -r uvcvideo

> This is the result of the command you asked:
> 
> *Bus 001 Device 003: ID 0ac8:0332 Z-Star Microelectronics Corp. *

[snip]

Could you please resend it in text-only format ? The HTML message messes the 
formatting up. Alternatively you can send the output as an attachement.

-- 
Regards,

Laurent Pinchart


From philip at gladstonefamily.net  Sun Mar  6 23:30:18 2011
From: philip at gladstonefamily.net (Philip Gladstone)
Date: Sun, 06 Mar 2011 17:30:18 -0500
Subject: [Linux-uvc-devel] Logitech C910 -- trying to run more than one.
In-Reply-To: <201103061214.19341.laurent.pinchart@ideasonboard.com>
References: <4D618034.5030807@gladstonefamily.net>
	<201103061214.19341.laurent.pinchart@ideasonboard.com>
Message-ID: <4D740AFA.5010803@gladstonefamily.net>

It turned out that my kernel had an old uvcvideo module which didn't 
have the right debug log messages, and so I'm in the process of 
upgrading to a current kernel version. So far, I've managed to render my 
machine unbootable [it is a little embedded linux box].

Philip

On 3/6/2011 6:14 AM, Laurent Pinchart wrote:
> Hi Philip,
>
> On Sunday 20 February 2011 21:57:24 Philip Gladstone wrote:
>> I attached two C910s to a small linux box, and ran into the 'Failed to
>> submit URB' problem.
>>
>> When I look at the descriptors for this camera, I think I understand the
>> problem. I'm capturing at 5 Mpixels and I'm trying two cameras.
>>
>>         VideoStreaming Interface Descriptor:
>>           bLength                            38
>>           bDescriptorType                    36
>>           bDescriptorSubtype                  7 (FRAME_MJPEG)
>>           bFrameIndex                        28
>>           bmCapabilities                   0x01
>>             Still image supported
>>           wWidth                           2592
>>           wHeight                          1944
>>           dwMinBitRate                403107840
>>           dwMaxBitRate                806215680
>>           dwMaxVideoFrameBufferSize    10077696
>>           dwDefaultFrameInterval        1000000
>>           bFrameIntervalType                  3
>>           dwFrameInterval( 0)           1000000
>>           dwFrameInterval( 1)           1333333
>>           dwFrameInterval( 2)           2000000
>>
>> The video frame size is set to 10Mb. This is surprisingly large as
>> actual frames captured with MJPEG on this camera are typically 500kb or
>> less. When I checked the descriptor for the uncompressed version of the
>> same frame, it came back with the same value of dwMaxVideoFrameBufferSize
>> (effectively 16 bits per pixel). The values for min/max bit rate are
>> (correctly) calculated from the frame intervals and the buffer size.
>
> The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field to compute
> the required bandwidth but queries the device at runtime instead.
>
> You can enable the UVC_TRACE_VIDEO trace flag to get the driver to print the
> bandwidth requested by the device to the kernel log.
>
>> Typical JPEG compression gets down to 1 bit per pixel, and 2 bits is
>> very unusual.
>>
>> What I want to know is what the impact would be of defining a new QUIRK
>> that overrode the frame buffer size for compressed frames and calculated
>> them at (say) 2 bits per pixel?
>>
>> Do other webcams get this right?
>
> You would be surprised by how many webcams get things wrong.
>

-- 
Philip Gladstone
Ham: N1DQ


From r3pek at r3pek.org  Mon Mar  7 00:20:55 2011
From: r3pek at r3pek.org (Carlos Silva)
Date: Sun, 6 Mar 2011 23:20:55 +0000
Subject: [Linux-uvc-devel] HP Pavillion DV3 WebCam
In-Reply-To: <201103061412.38381.laurent.pinchart@ideasonboard.com>
References: <AANLkTimF0ucM69vHaSf7Dxu4-=0Mw1b63KSXnEm69xY1@mail.gmail.com>
	<201103061357.19844.laurent.pinchart@ideasonboard.com>
	<AANLkTi=t+tZCp29=sqaDxsR_+Y2CieWwBCt5qqT4VJs1@mail.gmail.com>
	<201103061412.38381.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=WdArg-Pvk6RvOM4dE6Cuh1T8Qwh11itn3n7Dc@mail.gmail.com>

On Sun, Mar 6, 2011 at 13:12, Laurent Pinchart <
laurent.pinchart at ideasonboard.com> wrote:

> On Sunday 06 March 2011 14:02:08 Carlos Silva wrote:
> > On Sun, Mar 6, 2011 at 12:57, Laurent Pinchart wrote:
> > > On Sunday 06 March 2011 13:55:16 Carlos Silva wrote:
> > > > On Sun, Mar 6, 2011 at 10:56, Laurent Pinchart wrote:
> > > > > On Sunday 20 February 2011 00:50:04 Carlos Silva wrote:
> > > > > > OK, just tested with no quirks and it works. Want me to send a
> > > > > > patch for it?
> > > > >
> > > > > If no quirk is required, you don't need to patch the driver. It
> will
> > > > > work out of the box.
> > > >
> > > > Huummmm no. The device wasn't there. I had to added it myself (the
> > > > deviceid). At least on my kernel version... :/
> > > > Just checked and it's not on the latest kernel either.
> > >
> > > What I mean is that the device entry doesn't need to be there. The
> driver
> > > should work out of the box without an entry for your device.
> >
> > Ah, ok! But it didn't work... I can try again with a more recent kernel,
> > but this 2.6.37 it didn't work.
>
> How does it fail ? What are the log messages printed in the kernel log when
> you load the driver ?
>


Sorry about my report but I probably was doing something wrong 'cause I just
tested it and it works as expected.

Thanks anyway.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110306/681a6ecb/attachment.html>

From bug-track at fisher-privat.net  Mon Mar  7 11:53:49 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Mon, 07 Mar 2011 11:53:49 +0100
Subject: [Linux-uvc-devel] Logitech C910 -- trying to run more than one.
In-Reply-To: <4D740AFA.5010803@gladstonefamily.net>
References: <4D618034.5030807@gladstonefamily.net>
	<201103061214.19341.laurent.pinchart@ideasonboard.com>
	<4D740AFA.5010803@gladstonefamily.net>
Message-ID: <1299495229.15216.8.camel@zwerg>

Hi Philip,

i probably will not solve your problem but i wont to take a look on it.
Can you please apply attached debug patch and send me the log.
this patch was made on top of fd2b6dd22743f7c96f7c6e97d49ff5f4b422e741

Make sure you have CONFIG_DYNAMIC_DEBUG=y enabled. To start dynamic
debug you need do as root:

echo "module uvcvideo +p" > /sys/kernel/debug/dynamic_debug/control
echo "func uvc_video_decode_end -p"
> /sys/kernel/debug/dynamic_debug/control
echo "func uvc_video_decode_start -p"
> /sys/kernel/debug/dynamic_debug/control
echo "func uvc_video_decode_data -p"
> /sys/kernel/debug/dynamic_debug/control
echo "func uvc_video_decode_isoc -p"
> /sys/kernel/debug/dynamic_debug/control
echo "func uvc_video_complete -p"
> /sys/kernel/debug/dynamic_debug/control
echo "func uvc_v4l2_do_ioctl -p"
> /sys/kernel/debug/dynamic_debug/control

and start video with this, it will make onl?y one shot:
gst-launch-0.10 -v v4l2src num-buffers=1 ! jpegdec ! ffmpegcolorspace !
autovideosink

Am Sonntag, den 06.03.2011, 17:30 -0500 schrieb Philip Gladstone:
> It turned out that my kernel had an old uvcvideo module which didn't 
> have the right debug log messages, and so I'm in the process of 
> upgrading to a current kernel version. So far, I've managed to render my 
> machine unbootable [it is a little embedded linux box].
> 
> Philip
> 
> On 3/6/2011 6:14 AM, Laurent Pinchart wrote:
> > Hi Philip,
> >
> > On Sunday 20 February 2011 21:57:24 Philip Gladstone wrote:
> >> I attached two C910s to a small linux box, and ran into the 'Failed to
> >> submit URB' problem.
> >>
> >> When I look at the descriptors for this camera, I think I understand the
> >> problem. I'm capturing at 5 Mpixels and I'm trying two cameras.
> >>
> >>         VideoStreaming Interface Descriptor:
> >>           bLength                            38
> >>           bDescriptorType                    36
> >>           bDescriptorSubtype                  7 (FRAME_MJPEG)
> >>           bFrameIndex                        28
> >>           bmCapabilities                   0x01
> >>             Still image supported
> >>           wWidth                           2592
> >>           wHeight                          1944
> >>           dwMinBitRate                403107840
> >>           dwMaxBitRate                806215680
> >>           dwMaxVideoFrameBufferSize    10077696
> >>           dwDefaultFrameInterval        1000000
> >>           bFrameIntervalType                  3
> >>           dwFrameInterval( 0)           1000000
> >>           dwFrameInterval( 1)           1333333
> >>           dwFrameInterval( 2)           2000000
> >>
> >> The video frame size is set to 10Mb. This is surprisingly large as
> >> actual frames captured with MJPEG on this camera are typically 500kb or
> >> less. When I checked the descriptor for the uncompressed version of the
> >> same frame, it came back with the same value of dwMaxVideoFrameBufferSize
> >> (effectively 16 bits per pixel). The values for min/max bit rate are
> >> (correctly) calculated from the frame intervals and the buffer size.
> >
> > The uvcvideo driver doesn't use the dwMaxVideoFrameBufferSize field to compute
> > the required bandwidth but queries the device at runtime instead.
> >
> > You can enable the UVC_TRACE_VIDEO trace flag to get the driver to print the
> > bandwidth requested by the device to the kernel log.
> >
> >> Typical JPEG compression gets down to 1 bit per pixel, and 2 bits is
> >> very unusual.
> >>
> >> What I want to know is what the impact would be of defining a new QUIRK
> >> that overrode the frame buffer size for compressed frames and calculated
> >> them at (say) 2 bits per pixel?
> >>
> >> Do other webcams get this right?
> >
> > You would be surprised by how many webcams get things wrong.
> >
> 

-- 
Regards,
        Alexey
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc3.diff
Type: text/x-patch
Size: 39020 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110307/57628eef/attachment.bin>

From jallouli.med.amine at gmail.com  Mon Mar  7 15:54:42 2011
From: jallouli.med.amine at gmail.com (Mohamed Amine JALLOULI)
Date: Mon, 7 Mar 2011 18:54:42 +0400
Subject: [Linux-uvc-devel] 0ac8:0332 Z-Star Microelectronics Corp.
 webcam not working
In-Reply-To: <201103062201.30495.laurent.pinchart@ideasonboard.com>
References: <AANLkTimhvfbxy2hyq-D=o79t0+ZdALh_Wp3K+FnvrZ1x@mail.gmail.com>
	<201103061258.29625.laurent.pinchart@ideasonboard.com>
	<AANLkTinbDFBnkzxTbquyJ1YQPmfqUfo9skJ-OgFE1Cs7@mail.gmail.com>
	<201103062201.30495.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTimDC3-J-zqfAd-AkiuNV4S5s3V=LRVV8nA1y1Ue@mail.gmail.com>

Hi Laurent,

#1- I set the option to 0x10
modprobe uvcvideo quirks=0x10

#2- I Make sure the driver is not already loaded
modprobe -r uvcvideo
  # this command did not return any information.

#3- the result of the command sudo lsusb -v -d 0ac8:0332 is

Bus 001 Device 003: ID 0ac8:0332 Z-Star Microelectronics Corp.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0ac8 Z-Star Microelectronics Corp.
  idProduct          0x0332
  bcdDevice            1.00
  iManufacturer           1 Vimicro Corp.
  iProduct                2 Vega USB 2.0 Camera.
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          751
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               2 Vega USB 2.0 Camera.
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              2 Vega USB 2.0 Camera.
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           79
        dwClockFrequency       24.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0004000a
          Auto-Exposure Mode
          Exposure Time (Absolute)
          Privacy
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000177f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x 9
          None
          SECAM - 625/50
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                28
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {5dc717a9-1941-da11-ae0e-000d56ac7b4c}
        bNumControl            13
        bNrPins                 1
        baSourceID( 0)          1
        bControlSize            3
        bmControls( 0)       0xf9
        bmControls( 1)       0x1f
        bmControls( 2)       0x18
        iExtension              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x000a  1x 10 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                      381
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                104857600
        dwMaxBitRate                209715200
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1333333
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        352
        wHeight( 1)                       288
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        176
        wHeight( 3)                       144
        wWidth( 4)                        160
        wHeight( 4)                       120
        wWidth( 5)                       1280
        wHeight( 5)                      1024
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b00  2x 768 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       2 Streaming
      bFunctionProtocol       0
      iFunction               2 Vega USB 2.0 Camera.
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0
      iInterface              2 Vega USB 2.0 Camera.
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           39
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0602 Digital Audio Interface
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0
        iTerminal               0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            1
        bmaControls( 0)      0x00
        bmaControls( 1)      0x03
          Mute
          Volume
        iFeature                0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                35
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            9 Discrete
        tSamFreq[ 0]         8000
        tSamFreq[ 1]        11025
        tSamFreq[ 2]        12000
        tSamFreq[ 3]        16000
        tSamFreq[ 4]        22050
        tSamFreq[ 5]        24000
        tSamFreq[ 6]        32000
        tSamFreq[ 7]        44100
        tSamFreq[ 8]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0062  1x 98 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

# I hope, this time, my email will not exceed the email size limit.

Thanks again.


2011/3/7 Laurent Pinchart <laurent.pinchart at ideasonboard.com>
>
> Hi Mohamed,
>
> On Sunday 06 March 2011 21:50:57 Mohamed Amine JALLOULI wrote:
> > Hi Laurent Pinchart,
> >
> > Thanks you very much for answering ton my question.
> >
> > First, how can I set the quirks option to 0x10 when loading the uvcvideo
> > drive? (if you have a command line, it would be preferable.)
>
> modprobe uvcvideo quirks=0x10
>
> Make sure the driver is not already loaded, if it is, remove it with
>
> modprobe -r uvcvideo
>
> > This is the result of the command you asked:
> >
> > *Bus 001 Device 003: ID 0ac8:0332 Z-Star Microelectronics Corp. *
>
> [snip]
>
> Could you please resend it in text-only format ? The HTML message messes the
> formatting up. Alternatively you can send the output as an attachement.
>
> --
> Regards,
>
> Laurent Pinchart



--
Mohamed Amine JALLOULI


From white at mpi-cbg.de  Mon Mar  7 17:41:45 2011
From: white at mpi-cbg.de (Daniel James White)
Date: Mon, 7 Mar 2011 17:41:45 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
Message-ID: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>

Hi Folks,

here is a new camera for the list - imagingsource DFK72BUC02
http://www.theimagingsource.com/en_US/products/cameras/usb-cmos-color/dfk72buc02/

I've got this camera in my hand, but its not seen as a v4l2 device... does it need to be white listed?

DFK 72BUC02:

  Product ID:	0x8207
  Vendor ID:	0x199e
  Version:	 8.13
  Serial Number:	44010155
  Speed:	Up to 480 Mb/sec
  Manufacturer:	The Imaging Source, GmbH
  Location ID:	0xfd410000
  Current Available (mA):	500
  Current Required (mA):	500
  Extra Operating Current (mA):	400

This manufacturer makes a ton of different USB cmos and ccd cameras, and declares to be standards compliant....

We have firewire and USB versions of their cameras, and are getting more of the USB ones...
so i could contribute testing and hardware specs if anyone is interested. 

I see 
199e:8101	DFx 21BU04	ImagingSource
is supported already... what else can I provide or do to add support for my camera and the other similar ones?

Is it as simple as adding the device id to a white list?

cheers

Dan




Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Visualisation, Processing and Analysis
Light Microscopy and Image Processing Facilities 
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49 (0)351 210 2627 (Work phone at MPI-CBG)
+49 (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net 	BioImageXD
http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
http://www.chalkie.org.uk		Dan's Homepages
https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
dan (at) chalkie.org.uk
( white (at) mpi-cbg.de )













From laurent.pinchart at ideasonboard.com  Mon Mar  7 17:59:06 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 7 Mar 2011 17:59:06 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
Message-ID: <201103071759.06809.laurent.pinchart@ideasonboard.com>

Hi Daniel,

On Monday 07 March 2011 17:41:45 Daniel James White wrote:
> Hi Folks,
> 
> here is a new camera for the list - imagingsource DFK72BUC02
> http://www.theimagingsource.com/en_US/products/cameras/usb-cmos-color/dfk72
> buc02/
> 
> I've got this camera in my hand, but its not seen as a v4l2 device... does
> it need to be white listed?
> 
> DFK 72BUC02:
> 
>   Product ID:	0x8207
>   Vendor ID:	0x199e
>   Version:	 8.13
>   Serial Number:	44010155
>   Speed:	Up to 480 Mb/sec
>   Manufacturer:	The Imaging Source, GmbH
>   Location ID:	0xfd410000
>   Current Available (mA):	500
>   Current Required (mA):	500
>   Extra Operating Current (mA):	400
> 
> This manufacturer makes a ton of different USB cmos and ccd cameras, and
> declares to be standards compliant....
> 
> We have firewire and USB versions of their cameras, and are getting more of
> the USB ones... so i could contribute testing and hardware specs if anyone
> is interested.
> 
> I see
> 199e:8101	DFx 21BU04	ImagingSource
> is supported already... what else can I provide or do to add support for my
> camera and the other similar ones?
> 
> Is it as simple as adding the device id to a white list?

Could you please send me the output of

lsusb -v -d 199e:8297

(running as root if possible) ?

-- 
Regards,

Laurent Pinchart


From white at mpi-cbg.de  Mon Mar  7 21:54:21 2011
From: white at mpi-cbg.de (Dan White)
Date: Mon, 7 Mar 2011 21:54:21 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <201103071759.06809.laurent.pinchart@ideasonboard.com>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103071759.06809.laurent.pinchart@ideasonboard.com>
Message-ID: <DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>

Hi Laurent,

not so good news from imagingsource...

they explained that they dont support UVC on linux directly themselves.... but there is some 3rd party support (eg right here with the linux kernel UVC driver, and with unicam)

then they pointed me to this .pdf, which says the cmos cameras are !NOT!   UVC compliant at all....  :-(

>> 
>> Please download attachments from:
>> ftp://tis_ftp:Imaging199 at ftp.theimagingsource.com/Imaging/728a91/Linux%20and%20TIS%20cameras.pdf
> 
> In that doc i read this:
> 
> "
> The Imaging Source USB CMOS cameras are not UVC compliant, however in some cases, the ?uvcvideo? driver can be modified to deliver video data from such a camera. 
> The camera reports an incorrect UVC Video Format descriptor so that the driver will see two color formats: YUY2 and UYVY. The video data streamed by the camera will 
> always be 8 bit monochrome video. 
> The height will be as indicated in the video format descriptor. The width of the video format is twice the width indicated by the video format descriptor. On color cameras, 
> the video data will contain a ?bayer pattern? which needs to be interpolated to get a color image from the monochrome data. The video format descriptor will report only 
> one frame rate. There is no way to alter the frame rate via the UVC video format interface.
> Important: due to unpredictable variations of the chipsets used in The Imaging Source USB CMOS cameras these parameters are subject to change without any notice
> "
> 

I wrote these words to them expressing my disappointment...

> Frankly, this is disappointing:
> On your front webpage, you make a big deal out of implementing
> "Technology based on standards"

So i fear these imaging source USB cmos cameras are not good targets for easy inclusion into the linux-uvc world....
maybe i'm wrong...?

I think i will have to try the USB CCD cameras or even the firewire ones...

On Mar 7, 2011, at 5:59 PM, Laurent Pinchart wrote:

> Hi Daniel,
> 
> On Monday 07 March 2011 17:41:45 Daniel James White wrote:
>> Hi Folks,
>> 
>> here is a new camera for the list - imagingsource DFK72BUC02
>> http://www.theimagingsource.com/en_US/products/cameras/usb-cmos-color/dfk72
>> buc02/
>> 
>> I've got this camera in my hand, but its not seen as a v4l2 device... does
>> it need to be white listed?
>> 
>> DFK 72BUC02:
>> 
>>  Product ID:	0x8207
>>  Vendor ID:	0x199e
>>  Version:	 8.13
>>  Serial Number:	44010155
>>  Speed:	Up to 480 Mb/sec
>>  Manufacturer:	The Imaging Source, GmbH
>>  Location ID:	0xfd410000
>>  Current Available (mA):	500
>>  Current Required (mA):	500
>>  Extra Operating Current (mA):	400
>> 
>> This manufacturer makes a ton of different USB cmos and ccd cameras, and
>> declares to be standards compliant....
>> 
>> We have firewire and USB versions of their cameras, and are getting more of
>> the USB ones... so i could contribute testing and hardware specs if anyone
>> is interested.
>> 
>> I see
>> 199e:8101	DFx 21BU04	ImagingSource
>> is supported already... what else can I provide or do to add support for my
>> camera and the other similar ones?
>> 
>> Is it as simple as adding the device id to a white list?
> 
> Could you please send me the output of
> 
> lsusb -v -d 199e:8297
> 
> (running as root if possible) ?

here goes....

cheers

Dan



on an osx 10.6 machine
with OSX compiled  lsusb from 
http://rapidshare.com/#!download|416l32|146616592|lsusb|295

sudo  /Users/dan/Downloads/lsusb  -v -d 199e:8207
/Users/dan/Downloads/lsusb: cannot open "/Users/charlton/install/usbutils/share/usb.ids", No such file or directory

Bus 005 Device 004-199e-8207-ef-02: ID 199e:8207  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 
  bDeviceSubClass         2 
  bDeviceProtocol         1 
  bMaxPacketSize0        64
  idVendor           0x199e 
  idProduct          0x8207 
  bcdDevice            8.13
  iManufacturer           2 The Imaging Source, GmbH
  iProduct                1 DFK 72BUC02
  iSerial                 3 44010155
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          349
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass        255 
      bFunctionSubClass       3 
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 
      bInterfaceSubClass      1 
      bInterfaceProtocol      0 
      iInterface              0 
      ** UNRECOGNIZED:  0d 24 01 00 01 4e 00 80 8d 5b 00 01 01
      ** UNRECOGNIZED:  12 24 02 01 01 02 00 00 00 00 00 00 00 00 03 18 00 04
      ** UNRECOGNIZED:  0c 24 05 03 01 00 00 03 00 02 00 00
      ** UNRECOGNIZED:  1a 24 06 04 26 52 21 5a 89 32 56 41 89 4a 5c 55 7c df 96 64 04 01 03 01 1f 00
      ** UNRECOGNIZED:  09 24 03 02 01 01 00 04 00
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      217
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                2
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1296
        wHeight                          1944
        dwMinBitRate                3809017920
        dwMaxBitRate                3809017920
        dwMaxVideoFrameBufferSize     5111808
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                3809017920
        dwMaxBitRate                3809017920
        dwMaxVideoFrameBufferSize     5111808
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1296
        wHeight( 0)                      1944
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                2
        guidFormat                            {55595659-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1296
        wHeight                          1944
        dwMinBitRate                3809017920
        dwMaxBitRate                3809017920
        dwMaxVideoFrameBufferSize     5111808
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                3809017920
        dwMaxBitRate                3809017920
        dwMaxVideoFrameBufferSize     5111808
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1296
        wHeight( 0)                      1944
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 
  bDeviceSubClass         2 
  bDeviceProtocol         1 
  bMaxPacketSize0        64
  bNumConfigurations      1
can't get debug descriptor: No such file or directory
Device Status:     0x0000
  (Bus Powered)

> 
> -- 
> Regards,
> 
> Laurent Pinchart

Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Processing and Analysis
Light Microscopy Facility
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49  (0)351 210 2627 (Work phone at MPI-CBG)
+49  (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net		BioImageXD
http://pacific.mpi-cbg.de		Fiji (is just ImageJ - batteries included)
http://www.chalkie.org.uk
dan at chalkie.org.uk
( white at mpi-cbg.de )








From laurent.pinchart at ideasonboard.com  Mon Mar  7 23:51:07 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 7 Mar 2011 23:51:07 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103071759.06809.laurent.pinchart@ideasonboard.com>
	<DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>
Message-ID: <201103072351.08288.laurent.pinchart@ideasonboard.com>

Hi Dan,

On Monday 07 March 2011 21:54:21 Dan White wrote:
> Hi Laurent,
> 
> not so good news from imagingsource...
> 
> they explained that they dont support UVC on linux directly themselves....
> but there is some 3rd party support (eg right here with the linux kernel
> UVC driver, and with unicam)
> 
> then they pointed me to this .pdf, which says the cmos cameras are !NOT!  
> UVC compliant at all....  :-(

It might not be *that* bad, see below.

> >> Please download attachments from:
> >> ftp://tis_ftp:Imaging199 at ftp.theimagingsource.com/Imaging/728a91/Linux%2
> >> 0and%20TIS%20cameras.pdf
> > 
> > In that doc i read this:
> > 
> > "
> > The Imaging Source USB CMOS cameras are not UVC compliant, however in
> > some cases, the ?uvcvideo? driver can be modified to deliver video data
> > from such a camera. The camera reports an incorrect UVC Video Format
> > descriptor so that the driver will see two color formats: YUY2 and UYVY.
> > The video data streamed by the camera will always be 8 bit monochrome
> > video.
> > The height will be as indicated in the video format descriptor. The width
> > of the video format is twice the width indicated by the video format
> > descriptor. On color cameras, the video data will contain a ?bayer
> > pattern? which needs to be interpolated to get a color image from the
> > monochrome data. The video format descriptor will report only one frame
> > rate. There is no way to alter the frame rate via the UVC video format
> > interface. Important: due to unpredictable variations of the chipsets
> > used in The Imaging Source USB CMOS cameras these parameters are subject
> > to change without any notice "
> 
> I wrote these words to them expressing my disappointment...
> 
> > Frankly, this is disappointing:
> > On your front webpage, you make a big deal out of implementing
> > "Technology based on standards"
> 
> So i fear these imaging source USB cmos cameras are not good targets for
> easy inclusion into the linux-uvc world.... maybe i'm wrong...?
> 
> I think i will have to try the USB CCD cameras or even the firewire ones...

[snip]

> Bus 005 Device 004-199e-8207-ef-02: ID 199e:8207
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239
>   bDeviceSubClass         2
>   bDeviceProtocol         1
>   bMaxPacketSize0        64
>   idVendor           0x199e
>   idProduct          0x8207
>   bcdDevice            8.13
>   iManufacturer           2 The Imaging Source, GmbH
>   iProduct                1 DFK 72BUC02
>   iSerial                 3 44010155
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          349
>     bNumInterfaces          2
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0x80
>       (Bus Powered)
>     MaxPower              500mA
>     Interface Association:
>       bLength                 8
>       bDescriptorType        11
>       bFirstInterface         0
>       bInterfaceCount         2
>       bFunctionClass        255
>       bFunctionSubClass       3
>       bFunctionProtocol       0
>       iFunction               0
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           1
>       bInterfaceClass       255
>       bInterfaceSubClass      1
>       bInterfaceProtocol      0
>       iInterface              0

That's definitely not UVC compliant, but it looks like that's the only UVC 
non-compliance in the descriptors.

Could you try adding the following entry in the uvc_ids array (uvc_driver.c) ?

        { .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
                                | USB_DEVICE_ID_MATCH_INT_INFO,
          .idVendor             = 0x199e,
          .idProduct            = 0x8207,
          .bInterfaceClass      = USB_CLASS_VENDOR_SPEC,
          .bInterfaceSubClass   = 1,
          .bInterfaceProtocol   = 0 },

Please load the module with trace=65535 for additional debug messages in the 
kernel log.

-- 
Regards,

Laurent Pinchart


From white at mpi-cbg.de  Tue Mar  8 18:28:09 2011
From: white at mpi-cbg.de (Daniel James White)
Date: Tue, 8 Mar 2011 18:28:09 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <201103072351.08288.laurent.pinchart@ideasonboard.com>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103071759.06809.laurent.pinchart@ideasonboard.com>
	<DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>
	<201103072351.08288.laurent.pinchart@ideasonboard.com>
Message-ID: <5CC7B661-11AC-40F2-9E7B-F787ADB1C2FA@mpi-cbg.de>

Hi Laurent,

> That's definitely not UVC compliant, but it looks like that's the only UVC 
> non-compliance in the descriptors.
> 
> Could you try adding the following entry in the uvc_ids array (uvc_driver.c) ?
> 
>        { .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
>                                | USB_DEVICE_ID_MATCH_INT_INFO,
>          .idVendor             = 0x199e,
>          .idProduct            = 0x8207,
>          .bInterfaceClass      = USB_CLASS_VENDOR_SPEC,
>          .bInterfaceSubClass   = 1,
>          .bInterfaceProtocol   = 0 },

Ok, so i got the kernel sources unpacked, and found the uvc_driver.c file, 
and added the above, and saved it... 

but my lack of experience is now getting in my way. 

make isnt working for me, it says 
make: No targets. Stop

Clearly my Makefile is wrong. 

I never complied a kernel module before, 
so i had  better get some tips form a friendly local linux programmer, 
and I will get back to you...

I guess i need to change the Makefile before i will compile. 

> 
> Please load the module with trace=65535 for additional debug messages in the 
> kernel log.
> 

will do , once i have the module built and loaded successfully...

cheers

Dan



> -- 
> Regards,
> 
> Laurent Pinchart

Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Visualisation, Processing and Analysis
Light Microscopy and Image Processing Facilities 
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49 (0)351 210 2627 (Work phone at MPI-CBG)
+49 (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net 	BioImageXD
http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
http://www.chalkie.org.uk		Dan's Homepages
https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
dan (at) chalkie.org.uk
( white (at) mpi-cbg.de )













From white at mpi-cbg.de  Tue Mar  8 19:15:04 2011
From: white at mpi-cbg.de (Daniel James White)
Date: Tue, 8 Mar 2011 19:15:04 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <5CC7B661-11AC-40F2-9E7B-F787ADB1C2FA@mpi-cbg.de>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103071759.06809.laurent.pinchart@ideasonboard.com>
	<DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>
	<201103072351.08288.laurent.pinchart@ideasonboard.com>
	<5CC7B661-11AC-40F2-9E7B-F787ADB1C2FA@mpi-cbg.de>
Message-ID: <2AA8282C-15E3-48E9-963E-CADE3970149E@mpi-cbg.de>

Hi Again Laurent,

On Mar 8, 2011, at 6:28 PM, Daniel James White wrote:

> Hi Laurent,
> 
>> That's definitely not UVC compliant, but it looks like that's the only UVC 
>> non-compliance in the descriptors.
>> 
>> Could you try adding the following entry in the uvc_ids array (uvc_driver.c) ?
>> 
>>       { .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
>>                               | USB_DEVICE_ID_MATCH_INT_INFO,
>>         .idVendor             = 0x199e,
>>         .idProduct            = 0x8207,
>>         .bInterfaceClass      = USB_CLASS_VENDOR_SPEC,
>>         .bInterfaceSubClass   = 1,
>>         .bInterfaceProtocol   = 0 },
> 
> Ok, so i got the kernel sources unpacked, and found the uvc_driver.c file, 
> and added the above, and saved it... 
> 
> but my lack of experience is now getting in my way. 
> 
> make isnt working for me, it says 
> make: No targets. Stop
> 
> Clearly my Makefile is wrong. 
> 
> I never complied a kernel module before, 
> so i had  better get some tips form a friendly local linux programmer, 
> and I will get back to you...
> 
> I guess i need to change the Makefile before i will compile. 

Ok, some progress... and learning for me....

so I added the all and clean sections to the Makefile, 

and found out that sudo make doesn't work
but 
sudo su
make
does work... no idea why that is so...

anyway, I have built the kernel module:

root at lmf-MacBookPro:/usr/src/linux-source-2.6.35/drivers/media/video/uvc# make
make -C /lib/modules/2.6.35-22-generic/build M=/usr/src/linux-source-2.6.35/drivers/media/video/uvc modules
make[1]: Entering directory `/usr/src/linux-headers-2.6.35-22-generic'
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_driver.o
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_queue.o
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_v4l2.o
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_video.o
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_ctrl.o
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_status.o
  CC [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_isight.o
  LD [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvcvideo.o
  Building modules, stage 2.
  MODPOST 1 modules
  CC      /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvcvideo.mod.o
  LD [M]  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvcvideo.ko
make[1]: Leaving directory `/usr/src/linux-headers-2.6.35-22-generic'

looks good...

Next i looked at lsmod, and did not see the uvcvideo kernel module already loaded, 
so i tried to load it, again root, but got this error:

root at lmf-MacBookPro:/usr/src/linux-source-2.6.35/drivers/media/video/uvc# insmod uvcvideo.ko 
insmod: error inserting 'uvcvideo.ko': -1 Unknown symbol in module

any clues what I am doing wrong ?
sounds like i might have a difference between my running kernel and the source tree i built from ?

but
root at lmf-MacBookPro:/usr/src/linux-source-2.6.35/drivers/media/video/uvc# uname -a
Linux lmf-MacBookPro 2.6.35-22-generic #33-Ubuntu SMP Sun Sep 19 20:34:50 UTC 2010 i686 GNU/Linux

goes the -generic part matter?


> 
>> 
>> Please load the module with trace=65535 for additional debug messages in the 
>> kernel log.
>> 
> 
> will do , once i have the module built and loaded successfully...

Oh, and how do i load the kernel module with trace=65535 ?

insmod uvcvideo.ko trace=65535 
?

cheers

Dan



> 
> cheers
> 
> Dan
> 
> 
> 
>> -- 
>> Regards,
>> 
>> Laurent Pinchart
> 
> Dr. Daniel James White BSc. (Hons.) PhD
> Senior Microscopist / Image Visualisation, Processing and Analysis
> Light Microscopy and Image Processing Facilities 
> Max Planck Institute of Molecular Cell Biology and Genetics
> Pfotenhauerstrasse 108
> 01307 DRESDEN
> Germany
> 
> +49 (0)15114966933 (German Mobile)
> +49 (0)351 210 2627 (Work phone at MPI-CBG)
> +49 (0)351 210 1078 (Fax MPI-CBG LMF)
> 
> http://www.bioimagexd.net 	BioImageXD
> http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
> http://www.chalkie.org.uk		Dan's Homepages
> https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
> dan (at) chalkie.org.uk
> ( white (at) mpi-cbg.de )
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 

Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Visualisation, Processing and Analysis
Light Microscopy and Image Processing Facilities 
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49 (0)351 210 2627 (Work phone at MPI-CBG)
+49 (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net 	BioImageXD
http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
http://www.chalkie.org.uk		Dan's Homepages
https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
dan (at) chalkie.org.uk
( white (at) mpi-cbg.de )













From laurent.pinchart at ideasonboard.com  Tue Mar  8 21:30:28 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 8 Mar 2011 21:30:28 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <2AA8282C-15E3-48E9-963E-CADE3970149E@mpi-cbg.de>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<5CC7B661-11AC-40F2-9E7B-F787ADB1C2FA@mpi-cbg.de>
	<2AA8282C-15E3-48E9-963E-CADE3970149E@mpi-cbg.de>
Message-ID: <201103082130.28352.laurent.pinchart@ideasonboard.com>

Hi Daniel,

On Tuesday 08 March 2011 19:15:04 Daniel James White wrote:
> On Mar 8, 2011, at 6:28 PM, Daniel James White wrote:
> > Hi Laurent,
> > 
> >> That's definitely not UVC compliant, but it looks like that's the only
> >> UVC non-compliance in the descriptors.
> >> 
> >> Could you try adding the following entry in the uvc_ids array
> >> (uvc_driver.c) ?
> >> 
> >>       { .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
> >>       
> >>                               | USB_DEVICE_ID_MATCH_INT_INFO,
> >>         
> >>         .idVendor             = 0x199e,
> >>         .idProduct            = 0x8207,
> >>         .bInterfaceClass      = USB_CLASS_VENDOR_SPEC,
> >>         .bInterfaceSubClass   = 1,
> >>         .bInterfaceProtocol   = 0 },
> > 
> > Ok, so i got the kernel sources unpacked, and found the uvc_driver.c
> > file, and added the above, and saved it...
> > 
> > but my lack of experience is now getting in my way.
> > 
> > make isnt working for me, it says
> > make: No targets. Stop
> > 
> > Clearly my Makefile is wrong.
> > 
> > I never complied a kernel module before,
> > so i had  better get some tips form a friendly local linux programmer,
> > and I will get back to you...
> > 
> > I guess i need to change the Makefile before i will compile.
> 
> Ok, some progress... and learning for me....
> 
> so I added the all and clean sections to the Makefile,
> 
> and found out that sudo make doesn't work
> but
> sudo su
> make
> does work... no idea why that is so...
> 
> anyway, I have built the kernel module:
> 
> root at lmf-MacBookPro:/usr/src/linux-source-2.6.35/drivers/media/video/uvc#
> make make -C /lib/modules/2.6.35-22-generic/build
> M=/usr/src/linux-source-2.6.35/drivers/media/video/uvc modules make[1]:
> Entering directory `/usr/src/linux-headers-2.6.35-22-generic' CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_driver.o CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_queue.o CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_v4l2.o CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_video.o CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_ctrl.o CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_status.o CC [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvc_isight.o LD [M] 
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvcvideo.o Building
> modules, stage 2.
>   MODPOST 1 modules
>   CC     
> /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvcvideo.mod.o LD [M]
>  /usr/src/linux-source-2.6.35/drivers/media/video/uvc/uvcvideo.ko make[1]:
> Leaving directory `/usr/src/linux-headers-2.6.35-22-generic'
> 
> looks good...

'make' is usually invoked at the root of the kernel source tree, not in 
subdirectories. If you want to compile the uvcvideo driver only, run

make drivers/media/video/uvcvideo

in the root of the kernel source tree. You won't need to modify any Makefile.

> Next i looked at lsmod, and did not see the uvcvideo kernel module already
> loaded, so i tried to load it, again root, but got this error:
> 
> root at lmf-MacBookPro:/usr/src/linux-source-2.6.35/drivers/media/video/uvc#
> insmod uvcvideo.ko insmod: error inserting 'uvcvideo.ko': -1 Unknown
> symbol in module
> 
> any clues what I am doing wrong ?
> sounds like i might have a difference between my running kernel and the
> source tree i built from ?

That's right.

> but
> root at lmf-MacBookPro:/usr/src/linux-source-2.6.35/drivers/media/video/uvc#
> uname -a Linux lmf-MacBookPro 2.6.35-22-generic #33-Ubuntu SMP Sun Sep 19
> 20:34:50 UTC 2010 i686 GNU/Linux
> 
> goes the -generic part matter?

Yes it does. You should install the sources of your running kernel. 
Distributions usually provide a kernel sources package.

> >> Please load the module with trace=65535 for additional debug messages in
> >> the kernel log.
> > 
> > will do , once i have the module built and loaded successfully...
> 
> Oh, and how do i load the kernel module with trace=65535 ?
> 
> insmod uvcvideo.ko trace=65535
> ?

Yes.

-- 
Regards,

Laurent Pinchart


From formisc at gmail.com  Wed Mar  9 17:26:27 2011
From: formisc at gmail.com (Misc Things)
Date: Wed, 9 Mar 2011 11:26:27 -0500
Subject: [Linux-uvc-devel]  Vimicro USB Camera (Altair)
Message-ID: <AANLkTimiuAZdxhSEhQmSE1rL3N0UxH2ytf+11GqESVA7@mail.gmail.com>

Simon, Laurent
?I recently got

0ac8:3450 Z-Star Microelectronics Vimicro USB Camera (Altair) camera.
And though i got the video working without an (major) issues i can't
seemed to figure out how to get the sound to work.
The details are here:
http://www.linuxquestions.org/questions/linux-hardware-18/web-cam-gearhead-model-wc735i-vimicro-usb-camera-altair-0ac8-3450-z-star-microelectr-sound-867108/

I would appreciate if you can take a look.

Thank you.
Andrew


From j.frilander at gmail.com  Wed Mar  9 21:30:54 2011
From: j.frilander at gmail.com (Jani Frilander)
Date: Wed, 9 Mar 2011 22:30:54 +0200
Subject: [Linux-uvc-devel] Vimicro USB Camera (Altair)
In-Reply-To: <AANLkTimiuAZdxhSEhQmSE1rL3N0UxH2ytf+11GqESVA7@mail.gmail.com>
References: <AANLkTimiuAZdxhSEhQmSE1rL3N0UxH2ytf+11GqESVA7@mail.gmail.com>
Message-ID: <AANLkTik5n4d8sb6vwRRD-Ep5vGnf+WgQ9005YjdwHNGW@mail.gmail.com>

Hi,

2011/3/9 Misc Things <formisc at gmail.com>:
> Simon, Laurent
> ?I recently got
>
> 0ac8:3450 Z-Star Microelectronics Vimicro USB Camera (Altair) camera.
> And though i got the video working without an (major) issues i can't
> seemed to figure out how to get the sound to work.
> The details are here:
> http://www.linuxquestions.org/questions/linux-hardware-18/web-cam-gearhead-model-wc735i-vimicro-usb-camera-altair-0ac8-3450-z-star-microelectr-sound-867108/
>

Can you see an audio device for your webcam by typing

cat /proc/asound/cards

Cheers,
Jani


From linux.newbie79 at gmail.com  Wed Mar  9 23:21:21 2011
From: linux.newbie79 at gmail.com (linux newbie)
Date: Thu, 10 Mar 2011 09:21:21 +1100
Subject: [Linux-uvc-devel] MS Lifecam disconnect event
In-Reply-To: <201103061219.35253.laurent.pinchart@ideasonboard.com>
References: <AANLkTikzGL96pKUbBNvLhF79MZv_94UoFk0YPKOSsxEV@mail.gmail.com>
	<201102152007.04506.laurent.pinchart@ideasonboard.com>
	<AANLkTi=zeM=qbkEA57rJnpS_LrySH0C59jWR6MUhqrb2@mail.gmail.com>
	<201103061219.35253.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTikc7O34Uqe346C4dBp-tx_Y4SPunmhbZxCUQCRx@mail.gmail.com>

Hi,

Thanks for your replies.



On Sun, Mar 6, 2011 at 10:19 PM, Laurent Pinchart
<laurent.pinchart at ideasonboard.com> wrote:
> Hi,
>
> On Tuesday 22 February 2011 01:53:59 linux newbie wrote:
>> [ ?515.220000] hub 1-0:1.0: state 7 ports 2 chg 0000 evt 0004
>> [ ?515.220000] str8100-ehci str8100-ehci: GetStatus port 2 status
>> 001009 POWER sig=se0 PEC CONNECT
>> [ ?515.220000] hub 1-0:1.0: port 2 enable change, status 00000501
>> [ ?515.220000] hub 1-0:1.0: port 2 disabled by hub (EMI?), re-enabling...
>> [ ?515.220000] hub 1-0:1.0: port 2, status 0501, change 0002, 480 Mb/s
>> [ ?515.220000] usb 1-2: USB disconnect, address 2
>> [ ?515.220000] usb 1-2: unregistering device
>> [ ?515.220000] usb 1-2: usb_disable_device nuking all URBs
>> [ ?515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbe000 ep1in-iso
>> [ ?515.220000] str8100-ehci str8100-ehci: shutdown urb c3c4d000 ep1in-iso
>> [ ?515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbf800 ep1in-iso
>> [ ?515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbf000 ep1in-iso
>> [ ?515.220000] str8100-ehci str8100-ehci: shutdown urb c3fbe800 ep1in-iso
>> [ ?515.260000] usb 1-2: unlink qh16-0001/ffc02100 start 15 [1/0 us]
>> [ ?515.260000] str8100-ehci str8100-ehci: shutdown urb c3c5b540 ep3in-intr
>> [ ?515.260000] usb 1-2: unregistering interface 1-2:1.0
>> [ ?515.270000] usb 1-2:1.0: uevent
>> [ ?515.270000] usb 1-2: unregistering interface 1-2:1.1
>> [ ?515.270000] usb 1-2:1.1: uevent
>> [ ?515.280000] usb 1-2: unregistering interface 1-2:1.2
>> [ ?515.280000] usb 1-2:1.2: uevent
>> [ ?515.280000] usb 1-2: unregistering interface 1-2:1.3
>> [ ?515.280000] usb 1-2:1.3: uevent
>> [ ?515.280000] usb 1-2: uevent
>> [ ?515.340000] str8100-ehci str8100-ehci: GetStatus port 2 status
>> 001002 POWER sig=se0 CSC
>> [ ?515.340000] hub 1-0:1.0: state 7 ports 2 chg 0000 evt 0004
>
> That's a low-level USB issue. Bad cables, buggy webcam, noisy environment, ...
> The uvcvideo driver isn't at fault. If the camera decides to disconnect,
> there's little the driver can do.
>
> --
> Regards,
>
> Laurent Pinchart
>


From formisc at gmail.com  Thu Mar 10 00:51:03 2011
From: formisc at gmail.com (Misc Things)
Date: Wed, 9 Mar 2011 18:51:03 -0500
Subject: [Linux-uvc-devel] Vimicro USB Camera (Altair)
In-Reply-To: <AANLkTik5n4d8sb6vwRRD-Ep5vGnf+WgQ9005YjdwHNGW@mail.gmail.com>
References: <AANLkTimiuAZdxhSEhQmSE1rL3N0UxH2ytf+11GqESVA7@mail.gmail.com>
	<AANLkTik5n4d8sb6vwRRD-Ep5vGnf+WgQ9005YjdwHNGW@mail.gmail.com>
Message-ID: <AANLkTi=p-F_S7g8HaeOp3pZrUuahhKx0vW5Xu+5uovAH@mail.gmail.com>

On Wed, Mar 9, 2011 at 3:30 PM, Jani Frilander <j.frilander at gmail.com> wrote:
> Hi,
>
> 2011/3/9 Misc Things <formisc at gmail.com>:
>> Simon, Laurent
>> ?I recently got
>>
>> 0ac8:3450 Z-Star Microelectronics Vimicro USB Camera (Altair) camera.
>> And though i got the video working without an (major) issues i can't
>> seemed to figure out how to get the sound to work.
>> The details are here:
>> http://www.linuxquestions.org/questions/linux-hardware-18/web-cam-gearhead-model-wc735i-vimicro-usb-camera-altair-0ac8-3450-z-star-microelectr-sound-867108/
>>
>
> Can you see an audio device for your webcam by typing
>
> cat /proc/asound/cards
>
> Cheers,
> Jani
>
Jani,
 good point. thank you!

Doesn't look like it sees it :

 cat /proc/asound/cards
 0 [ICH            ]: NFORCE - Intel ICH
                      Intel ICH with ALC850 at irq 11

Andrew


From asmaa.elassal.student at pua.edu.eg  Thu Mar 10 20:30:35 2011
From: asmaa.elassal.student at pua.edu.eg (modysama)
Date: Thu, 10 Mar 2011 19:30:35 +0000 (UTC)
Subject: [Linux-uvc-devel] Fixing bandwidth quirk ***just inquire
Message-ID: <loom.20110310T202522-717@post.gmane.org>

Fixing bandwidth quirk is only works for uncompressed stream the YUYV format, it
doesn?t work for MJPG.



From asmaa.elassal.student at pua.edu.eg  Thu Mar 10 20:43:09 2011
From: asmaa.elassal.student at pua.edu.eg (modysama)
Date: Thu, 10 Mar 2011 19:43:09 +0000 (UTC)
Subject: [Linux-uvc-devel] Fixing bandwidth quirk ***just inquire
References: <loom.20110310T202522-717@post.gmane.org>
Message-ID: <loom.20110310T204041-468@post.gmane.org>

modysama <asmaa.elassal.student <at> pua.edu.eg> writes:

> 
> Fixing bandwidth quirk is only works for uncompressed stream 
the YUYV format, it doesn?t work for MJPG.
> Why??need explain, please
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel <at> lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 






From bug-track at fisher-privat.net  Thu Mar 10 22:59:47 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Thu, 10 Mar 2011 22:59:47 +0100
Subject: [Linux-uvc-devel] Fixing bandwidth quirk ***just inquire
In-Reply-To: <loom.20110310T204041-468@post.gmane.org>
References: <loom.20110310T202522-717@post.gmane.org>
	<loom.20110310T204041-468@post.gmane.org>
Message-ID: <1299794387.6124.8.camel@zwerg>

Compressed stream is not really predictable. Every camera can act
differently, so my be it will brick more than fix.

Do your camera need this quirk?

Am Donnerstag, den 10.03.2011, 19:43 +0000 schrieb modysama:
> modysama <asmaa.elassal.student <at> pua.edu.eg> writes:
> 
> > 
> > Fixing bandwidth quirk is only works for uncompressed stream 
> the YUYV format, it doesn?t work for MJPG.
> > Why??need explain, please
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel <at> lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> > 
> 
> 
> 
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel

-- 
Regards,
        Alexey



From formisc at gmail.com  Fri Mar 11 03:04:08 2011
From: formisc at gmail.com (Misc Things)
Date: Thu, 10 Mar 2011 21:04:08 -0500
Subject: [Linux-uvc-devel] Vimicro USB Camera (Altair)
In-Reply-To: <4D793DD1.3010703@skynet.be>
References: <AANLkTimiuAZdxhSEhQmSE1rL3N0UxH2ytf+11GqESVA7@mail.gmail.com>
	<AANLkTik5n4d8sb6vwRRD-Ep5vGnf+WgQ9005YjdwHNGW@mail.gmail.com>
	<AANLkTi=p-F_S7g8HaeOp3pZrUuahhKx0vW5Xu+5uovAH@mail.gmail.com>
	<4D793DD1.3010703@skynet.be>
Message-ID: <AANLkTinim3hjnz5DVhGdXZ4_BXQ9zgVex7fJm26887xh@mail.gmail.com>

On Thu, Mar 10, 2011 at 4:08 PM, borsprl <borsprl at skynet.be> wrote:
> Le 10/03/11 00:51, Misc Things a ?crit :
>>
>> On Wed, Mar 9, 2011 at 3:30 PM, Jani Frilander<j.frilander at gmail.com>
>> ?wrote:
>>>
>>> Hi,
>>>
>>> 2011/3/9 Misc Things<formisc at gmail.com>:
>>>>
>>>> Simon, Laurent
>>>> ?I recently got
>>>>
>>>> 0ac8:3450 Z-Star Microelectronics Vimicro USB Camera (Altair) camera.
>>>> And though i got the video working without an (major) issues i can't
>>>> seemed to figure out how to get the sound to work.
>>>> The details are here:
>>>>
>>>> http://www.linuxquestions.org/questions/linux-hardware-18/web-cam-gearhead-model-wc735i-vimicro-usb-camera-altair-0ac8-3450-z-star-microelectr-sound-867108/
>>>>
>>>
>>> Can you see an audio device for your webcam by typing
>>>
>>> cat /proc/asound/cards
>>>
>>> Cheers,
>>> Jani
>>>
>> Jani,
>> ?good point. thank you!
>>
>> Doesn't look like it sees it :
>>
>> ?cat /proc/asound/cards
>> ?0 [ICH ? ? ? ? ? ?]: NFORCE - Intel ICH
>> ? ? ? ? ? ? ? ? ? ? ? Intel ICH with ALC850 at irq 11
>>
>> Andrew
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
> Hello,
>
> You need the snd_usb_audio kernel module to be loaded.
> Check with lsmod if it is.
> If is not, load the module with modprobe snd_usb_audio as root.
> I hope this will help.
>
> Tasev Nikola
>


Nikola,
 I edited the lsmod output to shorten it a bit. took out what seemed
to have no relation to sound. Please see below:

[code]
[root at server ~]# id
uid=0(root) gid=0(root)
groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
[root at server ~]# lsmod
Module                  Size  Used by
snd_usb_audio          77761  0
snd_usb_lib            19137  1 snd_usb_audio
snd_rawmidi            26561  1 snd_usb_lib
snd_hwdep              12869  1 snd_usb_audio
<skip>
video                  21193  0
backlight              10049  1 video
<skip>
snd_intel8x0           35421  3
snd_ac97_codec         93025  1 snd_intel8x0
ac97_bus                6337  1 snd_ac97_codec
snd_seq_dummy           7877  0
snd_seq_oss            32577  0
snd_seq_midi_event     11073  1 snd_seq_oss
snd_seq                49585  5 snd_seq_dummy,snd_seq_oss,snd_seq_midi_event
snd_seq_device         11725  4 snd_rawmidi,snd_seq_dummy,snd_seq_oss,snd_seq
snd_pcm_oss            42817  0
snd_mixer_oss          19009  1 snd_pcm_oss
snd_pcm                72133  5
snd_usb_audio,snd_intel8x0,snd_ac97_codec,snd_pcm_oss
snd_timer              24516  3 snd_seq,snd_pcm
snd                    55749  16
snd_usb_audio,snd_rawmidi,snd_hwdep,snd_intel8x0,snd_ac97_codec,snd_seq_oss,snd_seq,snd_seq_device,snd_pcm_oss,snd_mixer_oss,snd_pcm,snd_timer
nvidia               9337504  28
uvcvideo               53833  0
soundcore              11553  1 snd
ohci1394               35717  0
snd_page_alloc         14281  2 snd_intel8x0,snd_pcm
compat_ioctl32          5569  1 uvcvideo
videodev               25793  1 uvcvideo
ieee1394              293625  1 ohci1394
forcedeth              54997  0
v4l1_compat            16069  2 uvcvideo,videodev
v4l2_common            24385  2 uvcvideo,videodev
<skip>
usblp                  16833  0
usb_storage            80673  1
<skip>

[root at server ~]# cat /proc/asound/cards
 0 [ICH            ]: NFORCE - Intel ICH
                      Intel ICH with ALC850 at irq 11

mencoder tv:// -tv
driver=v4l2:width=1280:height=960:device=/dev/video0 -ovc lavc -oac
mp3lame -lameopts cbr:br=64:mode=3 -o webcam_1.avi
az at server ~]$ . ~/bin/web_cam_record.sh
MEncoder SVN-r31628-4.1.2 (C) 2000-2010 MPlayer Team
success: format: 9  data: 0x0 - 0x0
TV file format detected.
Selected driver: v4l2
 name: Video 4 Linux 2 input
 author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
 comment: first try, more to come ;-)
v4l2: your device driver does not support VIDIOC_G_STD ioctl, VIDIOC_G_PARM was
used instead.
Selected device: Vimicro USB Camera (Altair)
 Capabilites:  video capture  streaming
 supported norms:
 inputs: 0 = Camera 1;
 Current input: 0
 Current format: YUYV
v4l2: ioctl set format failed: Invalid argument
v4l2: ioctl set format failed: Invalid argument
v4l2: ioctl set format failed: Invalid argument
tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
v4l2: ioctl enum norm failed: Invalid argument
Error: Cannot set norm!
Selected input hasn't got a tuner!
Audio block size too low, setting to 16384!
v4l2: ioctl set mute failed: Invalid argument
v4l2: ioctl query control failed: Invalid argument
[V] filefmt:9  fourcc:0x32595559  size:640x480  fps:30.000  ftime:=0.0333
Opening video filter: [expand osd=1]
Expand: -1 x -1, -1 ; -1, osd: 1, aspect: 0.000000, round: 1
==========================================================================
Opening video decoder: [raw] RAW Uncompressed Video
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
Movie-Aspect is undefined - no prescaling applied.
[swscaler @ 0x9afb840] using unscaled yuyv422 -> yuv420p special converter
videocodec: libavcodec (640x480 fourcc=34504d46 [FMP4])
Selected video codec: [rawyuy2] vfm: raw (RAW YUY2)
==========================================================================
Forcing audio preload to 0, max pts correction to 0.
Writing header...
ODML: Aspect information not (yet?) available or unspecified, not writing vprp h
eader.
Writing header...
ODML: Aspect information not (yet?) available or unspecified, not writing vprp h
eader.

3 duplicate frame(s)!
Pos:   0.1s      1f ( 0%)  0.00fps Trem:   0min   0mb  A-V:0.000 [0:0]
3 duplicate frame(s)!
Pos:   0.3s      2f ( 0%)  0.00fps Trem:   0min   0mb  A-V:0.000 [0:0]
3 duplicate frame(s)!
Pos:   0.4s      3f ( 0%)  2.91fps Trem:   0min   0mb  A-V:0.000 [0:0]
3 duplicate frame(s)!
<skip>
Pos:   9.9s     71f ( 0%)  6.73fps Trem:   0min   0mb  A-V:0.000 [186:0]
Error reading audio: Input/output error

3 duplicate frame(s)!
<skip>

mplayer webcam_1.avi
MPlayer SVN-r31628-4.1.2 (C) 2000-2010 MPlayer Team
mplayer: could not connect to socket
mplayer: No such file or directory
Failed to open LIRC support. You will not be able to use your remote control.

Playing webcam_1.avi.
AVI file format detected.
[aviheader] Video stream found, -vid 0
AVI: No audio stream found -> no sound.
VIDEO:  [FMP4]  640x480  24bpp  30.000 fps  184.9 kbps (22.6 kbyte/s)
Clip info:
 Software: MEncoder VERSION
==========================================================================
Opening video decoder: [ffmpeg] FFmpeg's libavcodec codec family
Selected video codec: [ffodivx] vfm: ffmpeg (FFmpeg MPEG-4)
==========================================================================
Audio: no sound
Starting playback...
Movie-Aspect is 1.33:1 - prescaling to correct movie aspect.
VO: [xv] 640x480 => 640x480 Planar YV12
V:   3.2  96/ 96  5%  1%  0.0% 0 0
Exiting... (Quit)
[/code]

nothing much changed :(


From pj.assis at gmail.com  Fri Mar 11 11:19:59 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 11 Mar 2011 10:19:59 +0000
Subject: [Linux-uvc-devel] Fixing bandwidth quirk ***just inquire
In-Reply-To: <1299794387.6124.8.camel@zwerg>
References: <loom.20110310T202522-717@post.gmane.org>
	<loom.20110310T204041-468@post.gmane.org>
	<1299794387.6124.8.camel@zwerg>
Message-ID: <AANLkTimPNeLpg_pad6fj6BBhJKQfQm6puBSYZsbf_+gW@mail.gmail.com>

Hi,

2011/3/10 Alexey Fisher <bug-track at fisher-privat.net>:
> Compressed stream is not really predictable. Every camera can act
> differently, so my be it will brick more than fix.
>

Actually one can assume if you need this quirk, the camera is already broken.
So I would see enabling mjpg bandwidth calculation with this quirk a
win/win situation.
Currently if you need this quirk for your camera, you will be limited
to yuyv streams.

The value you proposed of 4 bpp for mjpg seems a very good one ( I've
never seen mjpg frames this size), and even if you drop a couple of
frames because they are bigger I can't really see the big deal with
that.

Currently newer logitech HD cameras suffer from a bandwidth
reservation issue that prevent more than one camera to work. In some
cases even a single camera won't work if other usb devices are connect
to the same controller.
Adding mjpg to the quirk fixes this:
http://forums.quickcamteam.net/showthread.php?tid=1305

Regards,
Paulo


> Do your camera need this quirk?
>
> Am Donnerstag, den 10.03.2011, 19:43 +0000 schrieb modysama:
>> modysama <asmaa.elassal.student <at> pua.edu.eg> writes:
>>
>> >
>> > Fixing bandwidth quirk is only works for uncompressed stream
>> the YUYV format, it doesn?t work for MJPG.
>> > Why??need explain, please
>> > _______________________________________________
>> > Linux-uvc-devel mailing list
>> > Linux-uvc-devel <at> lists.berlios.de
>> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>> >
>>
>>
>>
>>
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
> --
> Regards,
> ? ? ? ?Alexey
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From bug-track at fisher-privat.net  Fri Mar 11 11:20:54 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Fri, 11 Mar 2011 11:20:54 +0100
Subject: [Linux-uvc-devel] Fixing bandwidth quirk ***just inquire
In-Reply-To: <AANLkTimUkUjZLfdbnduDsTHTxsYCsiwzjMdObEYXznV4@mail.gmail.com>
References: <loom.20110310T202522-717@post.gmane.org>
	<loom.20110310T204041-468@post.gmane.org>
	<1299794387.6124.8.camel@zwerg>
	<AANLkTimUkUjZLfdbnduDsTHTxsYCsiwzjMdObEYXznV4@mail.gmail.com>
Message-ID: <1299838854.9529.24.camel@mini>

Raw stream is "simple", for example YUYV need 16 bits to describe one
pixel. No extra action is done on this stream. Even if the camera lie
about it setting, we can still calculate it our self. For example if you
use YUYV 640x480 with 30 fps:
640?480?16=4915200 bit or 4915200/8=614400 byte
so dwMaxVideoFrameSize=614400.

Same value you will get if you check lsusb -vd xxxx:xxxx

To calculate bandwidth uvc use framerate. This value deiced, can you or
not use your webcam with some particular settings on your usb hub.

Compressed stream can use different compression algorithms, most populas
is jpeg. Compression depend on texture what your cam capture, and on the
time it has for compression. For example if camera forced to push 30fps,
it will choice speed against compression rate.
With compressed stream we can't say for sure, how match bandwidth do we
need. On cam's i tested it variate between 6% and  30% of uncompressed
stream. If you provide wrong bandwidth to the cam, it will just freeze
or send you black frame.

So, manufacture should provide correct settings and they are different
for each cam.

Or we should add new quirk setting, what adjust compression ratio too.
But before, we need some test cases, to find worts compression ratio,
and add statistic collection to the driver. 

Am Freitag, den 11.03.2011, 00:35 +0200 schrieb Asmaa ElAssal:
> Yes, sir, but I use another one.
> I received that analysiz from someone on that site about that old
> webcam. I want to understand the problem of that previous cam
> Excuse me, Could you more explain "Compressed stream is not really
> predictable" and it's different of the uncompressed format.
> 
> On Thu, Mar 10, 2011 at 11:59 PM, Alexey Fisher
> <bug-track at fisher-privat.net> wrote:
>         Compressed stream is not really predictable. Every camera can
>         act
>         differently, so my be it will brick more than fix.
>         
>         Do your camera need this quirk?
>         
>         Am Donnerstag, den 10.03.2011, 19:43 +0000 schrieb modysama:
>         > modysama <asmaa.elassal.student <at> pua.edu.eg> writes:
>         >
>         > >
>         > > Fixing bandwidth quirk is only works for uncompressed
>         stream
>         > the YUYV format, it doesn?t work for MJPG.
>         > > Why??need explain, please
>         > > _______________________________________________
>         > > Linux-uvc-devel mailing list
>         > > Linux-uvc-devel <at> lists.berlios.de
>         > > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>         > >
>         >
>         >
>         >
>         >
>         > _______________________________________________
>         > Linux-uvc-devel mailing list
>         > Linux-uvc-devel at lists.berlios.de
>         > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>         
>         --
>         Regards,
>                Alexey
>         
> 
> 
> 
> -- 
> Asmaa El-said Rashad
> Pharos University of Alex
> Computer Department
> 5th year
> 
> 
> 




From pj.assis at gmail.com  Fri Mar 11 11:38:50 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 11 Mar 2011 10:38:50 +0000
Subject: [Linux-uvc-devel] Fixing bandwidth quirk ***just inquire
In-Reply-To: <1299838854.9529.24.camel@mini>
References: <loom.20110310T202522-717@post.gmane.org>
	<loom.20110310T204041-468@post.gmane.org>
	<1299794387.6124.8.camel@zwerg>
	<AANLkTimUkUjZLfdbnduDsTHTxsYCsiwzjMdObEYXznV4@mail.gmail.com>
	<1299838854.9529.24.camel@mini>
Message-ID: <AANLkTikzqv1N-9PJ-Mb1SXgEBeGiQ0q-cLZfNcVpdvDG@mail.gmail.com>

Hi,

2011/3/11 Alexey Fisher <bug-track at fisher-privat.net>:
> Raw stream is "simple", for example YUYV need 16 bits to describe one
> pixel. No extra action is done on this stream. Even if the camera lie
> about it setting, we can still calculate it our self. For example if you
> use YUYV 640x480 with 30 fps:
> 640?480?16=4915200 bit or 4915200/8=614400 byte
> so dwMaxVideoFrameSize=614400.
>
> Same value you will get if you check lsusb -vd xxxx:xxxx
>
> To calculate bandwidth uvc use framerate. This value deiced, can you or
> not use your webcam with some particular settings on your usb hub.
>
> Compressed stream can use different compression algorithms, most populas
> is jpeg. Compression depend on texture what your cam capture, and on the
> time it has for compression. For example if camera forced to push 30fps,
> it will choice speed against compression rate.

actually it can also only send a part of the sensor image, just try
any of the logitech HD models,
when you pick a different frame rate (even for the same resolution)
you will get a very different image (more or less zoomed),
The compression ration seems more or less the same (at least the
quantization tables don't seem to alter).



> With compressed stream we can't say for sure, how match bandwidth do we
> need. On cam's i tested it variate between 6% and ?30% of uncompressed
> stream. If you provide wrong bandwidth to the cam, it will just freeze
> or send you black frame.

Yes but you can decide on a maximum (say 40% :D) that is never
reached, this is better than allocating 100% of the bandwidth and can
be the difference between a working camera and a non working one.

>
> So, manufacture should provide correct settings and they are different
> for each cam.

I totally agree with this, but unfortunately, this is not always the
case, hence the need for the quirks.
In fact the bandwidth settings should vary at least according to
resolution, but what wee see in some cases is that manufactures just
use the same value for every situation (laziness related maybe).

>
> Or we should add new quirk setting, what adjust compression ratio too.
> But before, we need some test cases, to find worts compression ratio,
> and add statistic collection to the driver.

V4l2 has jpeg compression related ioctls, Laurent event created a
patch for uvc, but for some reason it was never integrated, in fact I
add support for it in guvcview, but as I remember although the cameras
I tested seem to accepted it, it didn't really cause any change in the
compression ratio, so I doubt very much it would cause any on the
bandwidth settings.

Regards,
Paulo

>
> Am Freitag, den 11.03.2011, 00:35 +0200 schrieb Asmaa ElAssal:
>> Yes, sir, but I use another one.
>> I received that analysiz from someone on that site about that old
>> webcam. I want to understand the problem of that previous cam
>> Excuse me, Could you more explain "Compressed stream is not really
>> predictable" and it's different of the uncompressed format.
>>
>> On Thu, Mar 10, 2011 at 11:59 PM, Alexey Fisher
>> <bug-track at fisher-privat.net> wrote:
>> ? ? ? ? Compressed stream is not really predictable. Every camera can
>> ? ? ? ? act
>> ? ? ? ? differently, so my be it will brick more than fix.
>>
>> ? ? ? ? Do your camera need this quirk?
>>
>> ? ? ? ? Am Donnerstag, den 10.03.2011, 19:43 +0000 schrieb modysama:
>> ? ? ? ? > modysama <asmaa.elassal.student <at> pua.edu.eg> writes:
>> ? ? ? ? >
>> ? ? ? ? > >
>> ? ? ? ? > > Fixing bandwidth quirk is only works for uncompressed
>> ? ? ? ? stream
>> ? ? ? ? > the YUYV format, it doesn?t work for MJPG.
>> ? ? ? ? > > Why??need explain, please
>> ? ? ? ? > > _______________________________________________
>> ? ? ? ? > > Linux-uvc-devel mailing list
>> ? ? ? ? > > Linux-uvc-devel <at> lists.berlios.de
>> ? ? ? ? > > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>> ? ? ? ? > >
>> ? ? ? ? >
>> ? ? ? ? >
>> ? ? ? ? >
>> ? ? ? ? >
>> ? ? ? ? > _______________________________________________
>> ? ? ? ? > Linux-uvc-devel mailing list
>> ? ? ? ? > Linux-uvc-devel at lists.berlios.de
>> ? ? ? ? > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
>> ? ? ? ? --
>> ? ? ? ? Regards,
>> ? ? ? ? ? ? ? ?Alexey
>>
>>
>>
>>
>> --
>> Asmaa El-said Rashad
>> Pharos University of Alex
>> Computer Department
>> 5th year
>>
>>
>>
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From pauljurczak at yahoo.com  Fri Mar 18 02:11:41 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Thu, 17 Mar 2011 18:11:41 -0700 (PDT)
Subject: [Linux-uvc-devel] Extension unit documentation
Message-ID: <724909.66364.qm@web65406.mail.ac4.yahoo.com>

Hello,
I there any documentation available about XU (extension unit) for webcams other than Logitech? XML definition files for uvcdynctrl maybe? I'm specifically looking for disabling on-board image processing in order to get raw Bayer data. Large number of modern UVC compliant webcam controllers support this feature now.
Paul


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110317/42d6fe5e/attachment.html>

From pj.assis at gmail.com  Fri Mar 18 10:57:33 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 18 Mar 2011 09:57:33 +0000
Subject: [Linux-uvc-devel] Extension unit documentation
In-Reply-To: <724909.66364.qm@web65406.mail.ac4.yahoo.com>
References: <724909.66364.qm@web65406.mail.ac4.yahoo.com>
Message-ID: <AANLkTin4Qbxr=nFxVxZ8TVBt9k=5btEsQ5i2NKavoyP_@mail.gmail.com>

Hi,

2011/3/18 Paul Jurczak <pauljurczak at yahoo.com>

> Hello,
>
> I there any documentation available about XU (extension unit) for webcams
> other than Logitech? XML definition files for uvcdynctrl maybe? I'm
> specifically looking for disabling on-board image processing in order to get
> raw Bayer data. Large number of modern UVC compliant webcam controllers
> support this feature now.
>
>

None that I'm aware off. Even in the case of logitech, the new Cx10 models
are currently missing this type of information.

Regards,
Paulo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110318/b3e312ec/attachment.html>

From ender.tekin at yahoo.com  Wed Mar 23 01:18:21 2011
From: ender.tekin at yahoo.com (Ender Tekin)
Date: Tue, 22 Mar 2011 17:18:21 -0700 (PDT)
Subject: [Linux-uvc-devel] New UVC Device
Message-ID: <581520.54883.qm@web45303.mail.sp1.yahoo.com>

Hi,
I have the following UVC device (which I am having issues with) that is not 
listed on http://www.ideasonboard.org/uvc/#devices.

My device has ID 0c45:6450, and is the integrated webcam in a Dell Vostro 3300 
with Intel core i5. Below is part of the dmesg output:

Mar 22 15:34:44 kamyon-dell kernel: [   54.255630] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 10
Mar 22 15:34:44 kamyon-dell kernel: [   54.465583] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 15:34:44 kamyon-dell kernel: [   54.474277] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input15
Mar 22 15:34:45 kamyon-dell kernel: [   55.113561] usb 1-1.4: USB disconnect, 
address 10
Mar 22 15:34:45 kamyon-dell kernel: [   55.474784] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 11
Mar 22 15:34:45 kamyon-dell kernel: [   55.667568] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 15:34:45 kamyon-dell kernel: [   55.676179] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input16
Mar 22 15:34:45 kamyon-dell kernel: [   55.782029] Bluetooth: HIDP (Human 
Interface Emulation) ver 1.2
Mar 22 15:34:45 kamyon-dell kernel: [   55.880879] usb 1-1.4: USB disconnect, 
address 11

I seem to be having problems with the device not showing up frequently. Below is 
part of kern.log

Mar 22 12:36:55 kamyon-dell kernel: [  929.867637] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 111
Mar 22 12:36:56 kamyon-dell kernel: [  930.058971] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 12:36:56 kamyon-dell kernel: [  930.067922] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input124
Mar 22 12:51:05 kamyon-dell kernel: [ 1779.088533] usb 1-1.4: USB disconnect, 
address 111
Mar 22 12:51:06 kamyon-dell kernel: [ 1779.449266] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 112
Mar 22 12:51:06 kamyon-dell kernel: [ 1779.637279] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 12:51:06 kamyon-dell kernel: [ 1779.646385] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input125
Mar 22 13:01:29 kamyon-dell kernel: [ 2402.371187] usb 1-1.4: USB disconnect, 
address 112
Mar 22 13:01:29 kamyon-dell kernel: [ 2402.691832] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 113
Mar 22 13:01:30 kamyon-dell kernel: [ 2403.188834] usb 1-1.4: device not 
accepting address 113, error -71
Mar 22 13:01:30 kamyon-dell kernel: [ 2403.209374] hub 1-1:1.0: unable to 
enumerate USB device on port 4
Mar 22 13:01:30 kamyon-dell kernel: [ 2403.448814] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 115
Mar 22 13:01:30 kamyon-dell kernel: [ 2403.640088] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:01:30 kamyon-dell kernel: [ 2403.648928] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input126
Mar 22 13:02:22 kamyon-dell kernel: [ 2455.322975] usb 1-1.4: USB disconnect, 
address 115
Mar 22 13:02:22 kamyon-dell kernel: [ 2455.678068] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 116
Mar 22 13:02:22 kamyon-dell kernel: [ 2455.869375] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:02:22 kamyon-dell kernel: [ 2455.878479] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input127
Mar 22 13:02:52 kamyon-dell kernel: [ 2485.770418] usb 1-1.4: USB disconnect, 
address 116
Mar 22 13:02:53 kamyon-dell kernel: [ 2486.141395] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 117
Mar 22 13:02:53 kamyon-dell kernel: [ 2486.354998] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:02:53 kamyon-dell kernel: [ 2486.363801] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input128
Mar 22 13:03:06 kamyon-dell kernel: [ 2499.074570] usb 1-1.4: USB disconnect, 
address 117
Mar 22 13:03:06 kamyon-dell kernel: [ 2499.412319] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 118
Mar 22 13:03:06 kamyon-dell kernel: [ 2499.605341] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:06 kamyon-dell kernel: [ 2499.614559] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input129
Mar 22 13:03:15 kamyon-dell kernel: [ 2508.798807] usb 1-1.4: USB disconnect, 
address 118
Mar 22 13:03:16 kamyon-dell kernel: [ 2509.120285] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 119
Mar 22 13:03:16 kamyon-dell kernel: [ 2509.321579] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:16 kamyon-dell kernel: [ 2509.330482] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input130
Mar 22 13:03:17 kamyon-dell kernel: [ 2510.077003] usb 1-1.4: USB disconnect, 
address 119
Mar 22 13:03:17 kamyon-dell kernel: [ 2510.445847] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 120
Mar 22 13:03:17 kamyon-dell kernel: [ 2510.638246] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:17 kamyon-dell kernel: [ 2510.647661] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input131
Mar 22 13:03:18 kamyon-dell kernel: [ 2511.100076] usb 1-1.4: USB disconnect, 
address 120
Mar 22 13:03:19 kamyon-dell kernel: [ 2512.025166] hub 1-1:1.0: unable to 
enumerate USB device on port 4
Mar 22 13:03:19 kamyon-dell kernel: [ 2512.264838] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 122
Mar 22 13:03:19 kamyon-dell kernel: [ 2512.467376] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:19 kamyon-dell kernel: [ 2512.476339] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input132
Mar 22 13:03:22 kamyon-dell kernel: [ 2515.705890] usb 1-1.4: USB disconnect, 
address 122
Mar 22 13:03:23 kamyon-dell kernel: [ 2516.112443] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 123
Mar 22 13:03:23 kamyon-dell kernel: [ 2516.135217] hub 1-1:1.0: unable to 
enumerate USB device on port 4
Mar 22 13:03:23 kamyon-dell kernel: [ 2516.452253] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 124
Mar 22 13:03:23 kamyon-dell kernel: [ 2516.644816] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:23 kamyon-dell kernel: [ 2516.654056] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input133
Mar 22 13:03:27 kamyon-dell kernel: [ 2520.055859] usb 1-1.4: USB disconnect, 
address 124
Mar 22 13:03:27 kamyon-dell kernel: [ 2520.380007] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 125
Mar 22 13:03:27 kamyon-dell kernel: [ 2520.572904] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:27 kamyon-dell kernel: [ 2520.581886] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input134
Mar 22 13:03:29 kamyon-dell kernel: [ 2522.357970] usb 1-1.4: USB disconnect, 
address 125
Mar 22 13:03:29 kamyon-dell kernel: [ 2522.708560] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 126
Mar 22 13:03:30 kamyon-dell kernel: [ 2523.208102] usb 1-1.4: device not 
accepting address 126, error -71
Mar 22 13:03:30 kamyon-dell kernel: [ 2523.228622] hub 1-1:1.0: unable to 
enumerate USB device on port 4
Mar 22 13:03:30 kamyon-dell kernel: [ 2523.468130] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 3
Mar 22 13:03:30 kamyon-dell kernel: [ 2523.660820] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:30 kamyon-dell kernel: [ 2523.669533] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input135
Mar 22 13:03:31 kamyon-dell kernel: [ 2524.405101] usb 1-1.4: USB disconnect, 
address 3
Mar 22 13:03:31 kamyon-dell kernel: [ 2524.727461] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 6
Mar 22 13:03:31 kamyon-dell kernel: [ 2524.919307] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:31 kamyon-dell kernel: [ 2524.928491] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input136
Mar 22 13:03:33 kamyon-dell kernel: [ 2526.963804] usb 1-1.4: USB disconnect, 
address 6
Mar 22 13:03:34 kamyon-dell kernel: [ 2527.315934] usb 1-1.4: new high speed USB 
device using ehci_hcd and address 7
Mar 22 13:03:34 kamyon-dell kernel: [ 2527.508843] uvcvideo: Found UVC 1.00 
device Laptop_Integrated_Webcam_2M (0c45:6450)
Mar 22 13:03:34 kamyon-dell kernel: [ 2527.517909] input: 
Laptop_Integrated_Webcam_2M as 
/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.4/1-1.4:1.0/input/input137
Mar 22 13:03:34 kamyon-dell kernel: [ 2527.987113] usb 1-1.4: USB disconnect, 
address 7
Mar 22 13:03:35 kamyon-dell kernel: [ 2528.339304] hub 1-1:1.0: unable to 
enumerate USB device on port 4

It seems to be connecting/disconnecting a whole lot, and in the end, I do not 
even get a /dev/video0, and any webcam software reports webcam not found. I am 
running Ubuntu 10.10 (Kernel 2.6.35.28), and did not seem to have this problem 
with Ubuntu 10.04, although I updated soon after. It will sometimes work, and 
once or twice it seemed to work after turning bluetooth off. Any ideas?

Thanks in advance,

Ender



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110322/b177c3cd/attachment.html>

From skottfelt at gmail.com  Wed Mar 23 10:15:28 2011
From: skottfelt at gmail.com (Jesper Skottfelt)
Date: Wed, 23 Mar 2011 10:15:28 +0100
Subject: [Linux-uvc-devel] Creative Live! Cam Chat HD
Message-ID: <AANLkTin07prRE48amMj351QXZV1LyptwagOH7Cb=RfzP@mail.gmail.com>

Hi

'Creative Live! Cam Chat HD' is not on the list.

The ID number is:  041e:4088


Regards, Jesper


From riku.seppala at kymp.net  Wed Mar 23 10:51:01 2011
From: riku.seppala at kymp.net (=?ISO-8859-1?Q?Riku_Sepp=E4l=E4?=)
Date: Wed, 23 Mar 2011 11:51:01 +0200
Subject: [Linux-uvc-devel] Creative Live! Cam Chat HD
In-Reply-To: <AANLkTin07prRE48amMj351QXZV1LyptwagOH7Cb=RfzP@mail.gmail.com>
References: <AANLkTin07prRE48amMj351QXZV1LyptwagOH7Cb=RfzP@mail.gmail.com>
Message-ID: <4D89C285.2090608@kymp.net>

On 03/23/2011 11:15 AM, Jesper Skottfelt wrote:
> Hi
>
> 'Creative Live! Cam Chat HD' is not on the list.
>
> The ID number is:  041e:4088
>
>
> Regards, Jesper
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
I'll bet Laurent want you to send the output of

lsusb -v -d 041e:4088

(running as root if possible :)



From skottfelt at gmail.com  Wed Mar 23 11:45:02 2011
From: skottfelt at gmail.com (Jesper Skottfelt)
Date: Wed, 23 Mar 2011 11:45:02 +0100
Subject: [Linux-uvc-devel] Creative Live! Cam Chat HD
In-Reply-To: <4D89C285.2090608@kymp.net>
References: <AANLkTin07prRE48amMj351QXZV1LyptwagOH7Cb=RfzP@mail.gmail.com>
	<4D89C285.2090608@kymp.net>
Message-ID: <AANLkTikFvu1JD+yZgprtnc8CByRSdJULFwjq=NxEsf44@mail.gmail.com>

'lsusb -v -d 041e:4088' as root gives:

Bus 001 Device 021: ID 041e:4088 Creative Technology, Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x041e Creative Technology, Ltd
  idProduct          0x4088
  bcdDevice           10.10
  iManufacturer           1 Creative Technology Ltd.
  iProduct                2 VF0700 Live! Cam Chat HD
  iSerial                 3 0K051262
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength         1101
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              200mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               4 VF0700 Live! Cam Chat HD
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              4 VF0700 Live! Cam Chat HD
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          105
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          5
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0000000a
          Auto-Exposure Mode
          Exposure Time (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000157f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x1b
          None
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 3
        guidExtensionCode         {0a3e1874-8254-1a48-b402-48b8b8c49cc8}
        bNumControl             9
        bNrPins                 1
        baSourceID( 0)          2
        bControlSize            2
        bmControls( 0)       0xff
        bmControls( 1)       0x01
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {5bef79f6-df54-fc4b-b8cb-ca7e89a5233f}
        bNumControl             4
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            2
        bmControls( 0)       0x0b
        bmControls( 1)       0x08
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             5
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               8
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         2
        wTotalLength                      697
        bEndPointAddress                  130
        bmInfo                              1
        bTerminalLink                       5
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x02
          Interlaced stream or variable: No
          Fields per frame: 2 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           360
        dwMinBitRate                 18432000
        dwMaxBitRate                110592000
        dwMaxVideoFrameBufferSize      460800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  6144000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1536000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            960
        wHeight                           544
        dwMinBitRate                 41779200
        dwMaxBitRate                125337600
        dwMaxVideoFrameBufferSize     1044480
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            666666
        dwFrameInterval( 1)           1000000
        dwFrameInterval( 2)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                 73728000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize     1843200
        dwDefaultFrameInterval        1000000
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1000000
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                        640
        wHeight( 0)                       360
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        160
        wHeight( 3)                       120
        wWidth( 4)                        960
        wHeight( 4)                       544
        wWidth( 5)                       1280
        wHeight( 5)                       720
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        2
        bNumFrameDescriptors                6
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x02
          Interlaced stream or variable: No
          Fields per frame: 2 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           360
        dwMinBitRate                 27648000
        dwMaxBitRate                165888000
        dwMaxVideoFrameBufferSize      691200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 36864000
        dwMaxBitRate                221184000
        dwMaxVideoFrameBufferSize      921600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  9216000
        dwMaxBitRate                 55296000
        dwMaxVideoFrameBufferSize      230400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  2304000
        dwMaxBitRate                 13824000
        dwMaxVideoFrameBufferSize       57600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            960
        wHeight                           544
        dwMinBitRate                 62668800
        dwMaxBitRate                376012800
        dwMaxVideoFrameBufferSize     1566720
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                110592000
        dwMaxBitRate                663552000
        dwMaxVideoFrameBufferSize     2764800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                        640
        wHeight( 0)                       360
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        160
        wHeight( 3)                       120
        wWidth( 4)                        960
        wHeight( 4)                       544
        wWidth( 5)                       1280
        wHeight( 5)                       720
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13c0  3x 960 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       2 Streaming
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0
      iInterface              0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           38
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0
        iTerminal               0
      AudioControl Interface Descriptor:
        bLength                 8
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            1
        bmaControls( 0)      0x03
          Mute
          Volume
        iFeature                0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          1
        bSourceID               2
        iTerminal               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]         8000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0020  1x 32 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        44100
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x005a  1x 90 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0060  1x 96 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

2011/3/23 Riku Sepp?l? <riku.seppala at kymp.net>:
> On 03/23/2011 11:15 AM, Jesper Skottfelt wrote:
>>
>> Hi
>>
>> 'Creative Live! Cam Chat HD' is not on the list.
>>
>> The ID number is: ?041e:4088
>>
>>
>> Regards, Jesper
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
> I'll bet Laurent want you to send the output of
>
> lsusb -v -d 041e:4088
>
> (running as root if possible :)
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>



-- 
Venlig hilsen

Jesper Skottfelt

tlf: +45 30 13 53 51
email: skottfelt at gmail.com
skype: jskottfelt


From Arnaud.Guichard at heig-vd.ch  Wed Mar 23 14:34:26 2011
From: Arnaud.Guichard at heig-vd.ch (Guichard Arnaud)
Date: Wed, 23 Mar 2011 13:34:26 +0000
Subject: [Linux-uvc-devel] USB camera DFK 22BUC03 from ImagingSource
Message-ID: <E42EC68E1AFBBB4480A6C16145747C83127534ED@EINTMBX01.einet.ad.eivd.ch>

Hello,

I am tring to use the camera DFK 22BUC03 form ImagingSource, but it seems not to be working with the UVC driver.

Here are the result of some command used to test it:
lsusb -v
Bus 001 Device 006: ID 199e:8202 The Imaging Source Europe GmbH
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x199e The Imaging Source Europe GmbH
  idProduct          0x8202
  bcdDevice            8.13
  iManufacturer           2 The Imaging Source Europe GmbH
  iProduct                1 DFx 22BUC03
  iSerial                 3 01110024
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          409
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass        255 Vendor Specific Class
      bFunctionSubClass       3
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      1
      bInterfaceProtocol      0
      iInterface              0
      ** UNRECOGNIZED:  0d 24 01 00 01 4e 00 80 8d 5b 00 01 01
      ** UNRECOGNIZED:  12 24 02 01 01 02 00 00 00 00 00 00 00 00 03 1a 00 04
      ** UNRECOGNIZED:  0c 24 05 03 01 00 00 03 00 02 00 00
      ** UNRECOGNIZED:  1a 24 06 04 26 52 21 5a 89 32 56 41 89 4a 5c 55 7c df 96 64 04 01 03 01 1f 00
      ** UNRECOGNIZED:  09 24 03 02 01 01 00 04 00
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         2
        wTotalLength                      277
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                3
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            372
        wHeight                           480
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      786432
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           480
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      786432
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           240
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      786432
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                        744
        wHeight( 0)                       480
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                3
        guidFormat                            {55595659-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            372
        wHeight                           480
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      786432
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           480
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      786432
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           240
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      786432
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                        744
        wHeight( 0)                       480
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

After plugin the camera, the result of dmesg is:

[ 1316.088022] usb 1-2: new high speed USB device using ehci_hcd and address 6
[ 1316.485435] usb 1-2: New USB device found, idVendor=199e, idProduct=8202
[ 1316.485438] usb 1-2: New USB device strings: Mfr=2, Product=1, SerialNumber=3
[ 1316.485440] usb 1-2: Product: DFx 22BUC03
[ 1316.485442] usb 1-2: Manufacturer: The Imaging Source Europe GmbH
[ 1316.485444] usb 1-2: SerialNumber: 01110024
[ 1316.485535] usb 1-2: configuration #1 chosen from 1 choice

So, it means the camear is not recognized as a valid UVC device.
kernel version is: 2.6.32-5-amd64
and distro is Debian Squeeze: Debian GNU/Linux 6.0

Is there any chance this camera could be supported soon by UVC?

Thank you.
Best regards.

Arnaud Guichard




From alexandrefm at mandriva.com.br  Wed Mar 23 15:43:11 2011
From: alexandrefm at mandriva.com.br (Alexandre Felipe Muller de Souza)
Date: Wed, 23 Mar 2011 11:43:11 -0300
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5986:0203) crash ucview
Message-ID: <1300891391.5875.11.camel@localhost.localdomain>

Hello, I experienced some problems with Acer BisonCam builtin on
Notebook. I tried to update packages to most updated (kernel, uvcdriver)
but the problem occurs at the same way. When I use ucview application,
sometimes it crashed when I try to initialize the cam. I found the
device information as fully compatible at device list, but the name is
different. When the problem occurs I have to remove and add again the
module to work again.
At terminal the application writes:

error: input/output error
error: input/output error
error: input/output error
Aborted

The demsg output:
uvcvideo: Failed to query (135) UVC control 3 (unit 5) : -110 (exp. 2).
RX: IEEE802.1X EPAOL frame!
alg name:TKIP
===========>set_swcam():EntryNo is 2,KeyIndex is 2,KeyType is 2,is_mesh
is 0
uvcvideo: Failed to query (135) UVC control 2 (unit 5) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 2 (unit 5) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 3 (unit 5) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 7 (unit 5) : -110 (exp. 2).
RX: IEEE802.1X EPAOL frame!
alg name:TKIP
===========>set_swcam():EntryNo is 1,KeyIndex is 1,KeyType is 2,is_mesh
is 0
RX: IEEE802.1X EPAOL frame!
alg name:TKIP
===========>set_swcam():EntryNo is 2,KeyIndex is 2,KeyType is 2,is_mesh
is 0
RX: IEEE802.1X EPAOL frame!
alg name:TKIP
===========>set_swcam():EntryNo is 1,KeyIndex is 1,KeyType is 2,is_mesh
is 0
========>too long to sleep:f, ffffffe1, 3e8
========>too long to sleep:19, ffffffeb, 3e8
========>too long to sleep:23, fffffff5, 3e8
RX: IEEE802.1X EPAOL frame!
alg name:TKIP


The information of the device is:
Bus 004 Device 002: ID 5986:0241 Acer, Inc 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x5986 Acer, Inc
  idProduct          0x0241 
  bcdDevice            6.05
  iManufacturer           3 BISON Corporation
  iProduct                1 BisonCam, NB Pro
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          459
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               1 BisonCam, NB Pro
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              1 BisonCam, NB Pro
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           85
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               6
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               1
        baSource( 0)            1
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000043f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Power Line Frequency
        iProcessing             0 
        bmVideoStandards     0x1b
          None
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 6
        guidExtensionCode         {564c97a7-7ea7-904b-8cbf-1c71ec303000}
        bNumControl            16
        bNrPins                 1
        baSourceID( 0)          5
        bControlSize            2
        bmControls( 0)       0xff
        bmControls( 1)       0xff
        iExtension              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              15
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      291
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 12288000
        dwMaxBitRate                 12288000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         555555
        bFrameIntervalType                  3
        dwFrameInterval( 0)            555555
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  3072000
        dwMaxBitRate                  3072000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x01
          Still image supported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   768000
        dwMaxBitRate                   768000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x01
          Still image supported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  4055040
        dwMaxBitRate                  4055040
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x01
          Still image supported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1013760
        dwMaxBitRate                  1013760
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 26214400
        dwMaxBitRate                 26214400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      ** UNRECOGNIZED:  12 98 05 02 76 2f 12 98 05 02 76 2f 90 91 97 e0
b4 05
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


Does any one knows what could be wrong?


Thanks 
Alexandre



From white at mpi-cbg.de  Wed Mar 23 18:03:26 2011
From: white at mpi-cbg.de (Daniel James White)
Date: Wed, 23 Mar 2011 18:03:26 +0100
Subject: [Linux-uvc-devel] USB camera DFK 22BUC03 from ImagingSource
In-Reply-To: <mailman.3885.1300892592.1407.linux-uvc-devel@lists.berlios.de>
References: <mailman.3885.1300892592.1407.linux-uvc-devel@lists.berlios.de>
Message-ID: <02152457-BC49-4A9A-98AC-F18038ED4184@mpi-cbg.de>

Hi Arnaud, 


On Mar 23, 2011, at 4:03 PM, linux-uvc-devel-request at lists.berlios.de wrote:

> Message: 1
> Date: Wed, 23 Mar 2011 13:34:26 +0000
> From: Guichard Arnaud <Arnaud.Guichard at heig-vd.ch>
> To: "linux-uvc-devel at lists.berlios.de"
> 	<linux-uvc-devel at lists.berlios.de>
> Subject: [Linux-uvc-devel] USB camera DFK 22BUC03 from ImagingSource
> Message-ID:
> 	<E42EC68E1AFBBB4480A6C16145747C83127534ED at EINTMBX01.einet.ad.eivd.ch>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> Hello,
> 
> I am tring to use the camera DFK 22BUC03 form ImagingSource, but it seems not to be working with the UVC driver.

I have a very similar camera
DFK 72BUC02

and it has the same issue... not UVC compliant...

I have been trying to rebuild my linux kernel uvc driver with an exception for my camera, 
in addition to all the many other exceptions that are in the code...
but I am struggling with that sop far...

however I am happy to share experience with you. 

Can you see me previous posts to this list about my camera, 
and the responses from those who know?

There you will see what I have been trying. 

cheers

Dan


> 
> Here are the result of some command used to test it:
> lsusb -v
> Bus 001 Device 006: ID 199e:8202 The Imaging Source Europe GmbH
> Device Descriptor:
>  bLength                18
>  bDescriptorType         1
>  bcdUSB               2.00
>  bDeviceClass          239 Miscellaneous Device
>  bDeviceSubClass         2 ?
>  bDeviceProtocol         1 Interface Association
>  bMaxPacketSize0        64
>  idVendor           0x199e The Imaging Source Europe GmbH
>  idProduct          0x8202
>  bcdDevice            8.13
>  iManufacturer           2 The Imaging Source Europe GmbH
>  iProduct                1 DFx 22BUC03
>  iSerial                 3 01110024
>  bNumConfigurations      1
>  Configuration Descriptor:
>    bLength                 9
>    bDescriptorType         2
>    wTotalLength          409
>    bNumInterfaces          2
>    bConfigurationValue     1
>    iConfiguration          0
>    bmAttributes         0x80
>      (Bus Powered)
>    MaxPower              500mA
>    Interface Association:
>      bLength                 8
>      bDescriptorType        11
>      bFirstInterface         0
>      bInterfaceCount         2
>      bFunctionClass        255 Vendor Specific Class
>      bFunctionSubClass       3
>      bFunctionProtocol       0
>      iFunction               0
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        0
>      bAlternateSetting       0
>      bNumEndpoints           1
>      bInterfaceClass       255 Vendor Specific Class
>      bInterfaceSubClass      1
>      bInterfaceProtocol      0
>      iInterface              0
>      ** UNRECOGNIZED:  0d 24 01 00 01 4e 00 80 8d 5b 00 01 01
>      ** UNRECOGNIZED:  12 24 02 01 01 02 00 00 00 00 00 00 00 00 03 1a 00 04
>      ** UNRECOGNIZED:  0c 24 05 03 01 00 00 03 00 02 00 00
>      ** UNRECOGNIZED:  1a 24 06 04 26 52 21 5a 89 32 56 41 89 4a 5c 55 7c df 96 64 04 01 03 01 1f 00
>      ** UNRECOGNIZED:  09 24 03 02 01 01 00 04 00
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            3
>          Transfer Type            Interrupt
>          Synch Type               None
>          Usage Type               Data
>        wMaxPacketSize     0x0008  1x 8 bytes
>        bInterval               9
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       0
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      VideoStreaming Interface Descriptor:
>        bLength                            15
>        bDescriptorType                    36
>        bDescriptorSubtype                  1 (INPUT_HEADER)
>        bNumFormats                         2
>        wTotalLength                      277
>        bEndPointAddress                  130
>        bmInfo                              0
>        bTerminalLink                       2
>        bStillCaptureMethod                 2
>        bTriggerSupport                     1
>        bTriggerUsage                       0
>        bControlSize                        1
>        bmaControls( 0)                    27
>        bmaControls( 1)                    27
>      VideoStreaming Interface Descriptor:
>        bLength                            27
>        bDescriptorType                    36
>        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>        bFormatIndex                        1
>        bNumFrameDescriptors                3
>        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
>        bBitsPerPixel                      16
>        bDefaultFrameIndex                  1
>        bAspectRatioX                       0
>        bAspectRatioY                       0
>        bmInterlaceFlags                 0x00
>          Interlaced stream or variable: No
>          Fields per frame: 1 fields
>          Field 1 first: No
>          Field pattern: Field 1 only
>          bCopyProtect                      0
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         1
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            372
>        wHeight                           480
>        dwMinBitRate                838992000
>        dwMaxBitRate                838992000
>        dwMaxVideoFrameBufferSize      786432
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         2
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            320
>        wHeight                           480
>        dwMinBitRate                838992000
>        dwMaxBitRate                838992000
>        dwMaxVideoFrameBufferSize      786432
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         3
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            160
>        wHeight                           240
>        dwMinBitRate                838992000
>        dwMaxBitRate                838992000
>        dwMaxVideoFrameBufferSize      786432
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            11
>        bDescriptorType                    36
>        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>        bEndpointAddress                    0
>        bNumImageSizePatterns               1
>        wWidth( 0)                        744
>        wHeight( 0)                       480
>        bNumCompressionPatterns             1
>        bCompression( 0)                    0
>      VideoStreaming Interface Descriptor:
>        bLength                            27
>        bDescriptorType                    36
>        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>        bFormatIndex                        2
>        bNumFrameDescriptors                3
>        guidFormat                            {55595659-0000-1000-8000-00aa00389b71}
>        bBitsPerPixel                      16
>        bDefaultFrameIndex                  1
>        bAspectRatioX                       0
>        bAspectRatioY                       0
>        bmInterlaceFlags                 0x00
>          Interlaced stream or variable: No
>          Fields per frame: 1 fields
>          Field 1 first: No
>          Field pattern: Field 1 only
>          bCopyProtect                      0
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         1
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            372
>        wHeight                           480
>        dwMinBitRate                838992000
>        dwMaxBitRate                838992000
>        dwMaxVideoFrameBufferSize      786432
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         2
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            320
>        wHeight                           480
>        dwMinBitRate                838992000
>        dwMaxBitRate                838992000
>        dwMaxVideoFrameBufferSize      786432
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         3
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            160
>        wHeight                           240
>        dwMinBitRate                838992000
>        dwMaxBitRate                838992000
>        dwMaxVideoFrameBufferSize      786432
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            11
>        bDescriptorType                    36
>        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>        bEndpointAddress                    0
>        bNumImageSizePatterns               1
>        wWidth( 0)                        744
>        wHeight( 0)                       480
>        bNumCompressionPatterns             1
>        bCompression( 0)                    0
>      VideoStreaming Interface Descriptor:
>        bLength                             6
>        bDescriptorType                    36
>        bDescriptorSubtype                 13 (COLORFORMAT)
>        bColorPrimaries                     0 (Unspecified)
>        bTransferCharacteristics            0 (Unspecified)
>        bMatrixCoefficients                 0 (Unspecified)
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            2
>          Transfer Type            Bulk
>          Synch Type               None
>          Usage Type               Data
>        wMaxPacketSize     0x0200  1x 512 bytes
>        bInterval               1
> Device Qualifier (for other device speed):
>  bLength                10
>  bDescriptorType         6
>  bcdUSB               2.00
>  bDeviceClass          239 Miscellaneous Device
>  bDeviceSubClass         2 ?
>  bDeviceProtocol         1 Interface Association
>  bMaxPacketSize0        64
>  bNumConfigurations      1
> Device Status:     0x0000
>  (Bus Powered)
> 
> After plugin the camera, the result of dmesg is:
> 
> [ 1316.088022] usb 1-2: new high speed USB device using ehci_hcd and address 6
> [ 1316.485435] usb 1-2: New USB device found, idVendor=199e, idProduct=8202
> [ 1316.485438] usb 1-2: New USB device strings: Mfr=2, Product=1, SerialNumber=3
> [ 1316.485440] usb 1-2: Product: DFx 22BUC03
> [ 1316.485442] usb 1-2: Manufacturer: The Imaging Source Europe GmbH
> [ 1316.485444] usb 1-2: SerialNumber: 01110024
> [ 1316.485535] usb 1-2: configuration #1 chosen from 1 choice
> 
> So, it means the camear is not recognized as a valid UVC device.
> kernel version is: 2.6.32-5-amd64
> and distro is Debian Squeeze: Debian GNU/Linux 6.0
> 
> Is there any chance this camera could be supported soon by UVC?
> 
> Thank you.
> Best regards.
> 
> Arnaud Guichard

Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Visualisation, Processing and Analysis
Light Microscopy and Image Processing Facilities 
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49 (0)351 210 2627 (Work phone at MPI-CBG)
+49 (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net 	BioImageXD
http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
http://www.chalkie.org.uk		Dan's Homepages
https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
dan (at) chalkie.org.uk
( white (at) mpi-cbg.de )













From pauljurczak at yahoo.com  Wed Mar 23 19:29:44 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Wed, 23 Mar 2011 11:29:44 -0700 (PDT)
Subject: [Linux-uvc-devel] Raw Bayer data streaming from unknown camera
Message-ID: <381936.8308.qm@web65402.mail.ac4.yahoo.com>

Hi,
I have a project, which require raw pixel data from UVC camera (image processor off). There are products in China, which use UVC camera controller known to support streaming raw pixel data, for example Vimicro VC0345. Their Windows driver exposes 8-bit and 10-bit raw data modes, but they don't support it on Linux. What is the easiest way to make it available on Linux? If they tell me what is?guidExtensionCode and?bmControls address (bit mask) for the control to turn image processor off, is it going to be enough information to access this control? If I can't get any information from them, is brute force method of testing each?EXTENSION_UNIT control feasible? BTW, I know that some Logitech webcams support raw data streaming, but I can't use them for mechanical and other reasons.
Thank you,Paul


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110323/162e9a83/attachment.html>

From skottfelt at gmail.com  Wed Mar 23 21:40:07 2011
From: skottfelt at gmail.com (Jesper Skottfelt)
Date: Wed, 23 Mar 2011 21:40:07 +0100
Subject: [Linux-uvc-devel] Creative Live! Cam Chat HD
In-Reply-To: <AANLkTikFvu1JD+yZgprtnc8CByRSdJULFwjq=NxEsf44@mail.gmail.com>
References: <AANLkTin07prRE48amMj351QXZV1LyptwagOH7Cb=RfzP@mail.gmail.com>
	<4D89C285.2090608@kymp.net>
	<AANLkTikFvu1JD+yZgprtnc8CByRSdJULFwjq=NxEsf44@mail.gmail.com>
Message-ID: <AANLkTimwmxuUVa5UOihuh8ZXeYcPp7mZWe2YPdb55Kv1@mail.gmail.com>

The webcam works fine in kubuntu 10.10, but it doesn't work in kubuntu 10.04.

2011/3/23 Jesper Skottfelt <skottfelt at gmail.com>:
> 'lsusb -v -d 041e:4088' as root gives:
>
> Bus 001 Device 021: ID 041e:4088 Creative Technology, Ltd
> Device Descriptor:
> ?bLength ? ? ? ? ? ? ? ?18
> ?bDescriptorType ? ? ? ? 1
> ?bcdUSB ? ? ? ? ? ? ? 2.00
> ?bDeviceClass ? ? ? ? ?239 Miscellaneous Device
> ?bDeviceSubClass ? ? ? ? 2 ?
> ?bDeviceProtocol ? ? ? ? 1 Interface Association
> ?bMaxPacketSize0 ? ? ? ?64
> ?idVendor ? ? ? ? ? 0x041e Creative Technology, Ltd
> ?idProduct ? ? ? ? ?0x4088
> ?bcdDevice ? ? ? ? ? 10.10
> ?iManufacturer ? ? ? ? ? 1 Creative Technology Ltd.
> ?iProduct ? ? ? ? ? ? ? ?2 VF0700 Live! Cam Chat HD
> ?iSerial ? ? ? ? ? ? ? ? 3 0K051262
> ?bNumConfigurations ? ? ?1
> ?Configuration Descriptor:
> ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ?bDescriptorType ? ? ? ? 2
> ? ?wTotalLength ? ? ? ? 1101
> ? ?bNumInterfaces ? ? ? ? ?4
> ? ?bConfigurationValue ? ? 1
> ? ?iConfiguration ? ? ? ? ?0
> ? ?bmAttributes ? ? ? ? 0x80
> ? ? ?(Bus Powered)
> ? ?MaxPower ? ? ? ? ? ? ?200mA
> ? ?Interface Association:
> ? ? ?bLength ? ? ? ? ? ? ? ? 8
> ? ? ?bDescriptorType ? ? ? ?11
> ? ? ?bFirstInterface ? ? ? ? 0
> ? ? ?bInterfaceCount ? ? ? ? 2
> ? ? ?bFunctionClass ? ? ? ? 14 Video
> ? ? ?bFunctionSubClass ? ? ? 3 Video Interface Collection
> ? ? ?bFunctionProtocol ? ? ? 0
> ? ? ?iFunction ? ? ? ? ? ? ? 4 VF0700 Live! Cam Chat HD
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?0
> ? ? ?bAlternateSetting ? ? ? 0
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?1 Video Control
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?4 VF0700 Live! Cam Chat HD
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?13
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (HEADER)
> ? ? ? ?bcdUVC ? ? ? ? ? ? ? 1.00
> ? ? ? ?wTotalLength ? ? ? ? ?105
> ? ? ? ?dwClockFrequency ? ? ? 30.000000MHz
> ? ? ? ?bInCollection ? ? ? ? ? 1
> ? ? ? ?baInterfaceNr( 0) ? ? ? 1
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?18
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (INPUT_TERMINAL)
> ? ? ? ?bTerminalID ? ? ? ? ? ? 1
> ? ? ? ?wTerminalType ? ? ?0x0201 Camera Sensor
> ? ? ? ?bAssocTerminal ? ? ? ? ?5
> ? ? ? ?iTerminal ? ? ? ? ? ? ? 0
> ? ? ? ?wObjectiveFocalLengthMin ? ? ?0
> ? ? ? ?wObjectiveFocalLengthMax ? ? ?0
> ? ? ? ?wOcularFocalLength ? ? ? ? ? ?0
> ? ? ? ?bControlSize ? ? ? ? ? ? ? ? ?3
> ? ? ? ?bmControls ? ? ? ? ? 0x0000000a
> ? ? ? ? ?Auto-Exposure Mode
> ? ? ? ? ?Exposure Time (Absolute)
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?5 (PROCESSING_UNIT)
> ? ? ?Warning: Descriptor too short
> ? ? ? ?bUnitID ? ? ? ? ? ? ? ? 2
> ? ? ? ?bSourceID ? ? ? ? ? ? ? 1
> ? ? ? ?wMaxMultiplier ? ? ? ? ?0
> ? ? ? ?bControlSize ? ? ? ? ? ?2
> ? ? ? ?bmControls ? ? 0x0000157f
> ? ? ? ? ?Brightness
> ? ? ? ? ?Contrast
> ? ? ? ? ?Hue
> ? ? ? ? ?Saturation
> ? ? ? ? ?Sharpness
> ? ? ? ? ?Gamma
> ? ? ? ? ?White Balance Temperature
> ? ? ? ? ?Backlight Compensation
> ? ? ? ? ?Power Line Frequency
> ? ? ? ? ?White Balance Temperature, Auto
> ? ? ? ?iProcessing ? ? ? ? ? ? 0
> ? ? ? ?bmVideoStandards ? ? 0x1b
> ? ? ? ? ?None
> ? ? ? ? ?NTSC - 525/60
> ? ? ? ? ?SECAM - 625/50
> ? ? ? ? ?NTSC - 625/50
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?27
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?6 (EXTENSION_UNIT)
> ? ? ? ?bUnitID ? ? ? ? ? ? ? ? 3
> ? ? ? ?guidExtensionCode ? ? ? ? {0a3e1874-8254-1a48-b402-48b8b8c49cc8}
> ? ? ? ?bNumControl ? ? ? ? ? ? 9
> ? ? ? ?bNrPins ? ? ? ? ? ? ? ? 1
> ? ? ? ?baSourceID( 0) ? ? ? ? ?2
> ? ? ? ?bControlSize ? ? ? ? ? ?2
> ? ? ? ?bmControls( 0) ? ? ? 0xff
> ? ? ? ?bmControls( 1) ? ? ? 0x01
> ? ? ? ?iExtension ? ? ? ? ? ? ?0
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?27
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?6 (EXTENSION_UNIT)
> ? ? ? ?bUnitID ? ? ? ? ? ? ? ? 4
> ? ? ? ?guidExtensionCode ? ? ? ? {5bef79f6-df54-fc4b-b8cb-ca7e89a5233f}
> ? ? ? ?bNumControl ? ? ? ? ? ? 4
> ? ? ? ?bNrPins ? ? ? ? ? ? ? ? 1
> ? ? ? ?baSourceID( 0) ? ? ? ? ?3
> ? ? ? ?bControlSize ? ? ? ? ? ?2
> ? ? ? ?bmControls( 0) ? ? ? 0x0b
> ? ? ? ?bmControls( 1) ? ? ? 0x08
> ? ? ? ?iExtension ? ? ? ? ? ? ?0
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?3 (OUTPUT_TERMINAL)
> ? ? ? ?bTerminalID ? ? ? ? ? ? 5
> ? ? ? ?wTerminalType ? ? ?0x0101 USB Streaming
> ? ? ? ?bAssocTerminal ? ? ? ? ?0
> ? ? ? ?bSourceID ? ? ? ? ? ? ? 4
> ? ? ? ?iTerminal ? ? ? ? ? ? ? 0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?3
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Interrupt
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? None
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0010 ?1x 16 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 8
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 0
> ? ? ?bNumEndpoints ? ? ? ? ? 0
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?15
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?1 (INPUT_HEADER)
> ? ? ? ?bNumFormats ? ? ? ? ? ? ? ? ? ? ? ? 2
> ? ? ? ?wTotalLength ? ? ? ? ? ? ? ? ? ? ?697
> ? ? ? ?bEndPointAddress ? ? ? ? ? ? ? ? ?130
> ? ? ? ?bmInfo ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bTerminalLink ? ? ? ? ? ? ? ? ? ? ? 5
> ? ? ? ?bStillCaptureMethod ? ? ? ? ? ? ? ? 2
> ? ? ? ?bTriggerSupport ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?bTriggerUsage ? ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?bControlSize ? ? ? ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bmaControls( 0) ? ? ? ? ? ? ? ? ? ?27
> ? ? ? ?bmaControls( 1) ? ? ? ? ? ? ? ? ? ?27
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?27
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?4 (FORMAT_UNCOMPRESSED)
> ? ? ? ?bFormatIndex ? ? ? ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bNumFrameDescriptors ? ? ? ? ? ? ? ?6
> ? ? ? ?guidFormat
> {59555932-0000-1000-8000-00aa00389b71}
> ? ? ? ?bBitsPerPixel ? ? ? ? ? ? ? ? ? ? ?16
> ? ? ? ?bDefaultFrameIndex ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bAspectRatioX ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bAspectRatioY ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bmInterlaceFlags ? ? ? ? ? ? ? ? 0x02
> ? ? ? ? ?Interlaced stream or variable: No
> ? ? ? ? ?Fields per frame: 2 fields
> ? ? ? ? ?Field 1 first: No
> ? ? ? ? ?Field pattern: Field 1 only
> ? ? ? ? ?bCopyProtect ? ? ? ? ? ? ? ? ? ? ?0
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 360
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 18432000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?110592000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?460800
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 2
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 480
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 24576000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?147456000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?614400
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 3
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?320
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 240
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?6144000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 36864000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?153600
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 4
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?160
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 120
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?1536000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? ?9216000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ? 38400
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?38
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 5
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?960
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 544
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 41779200
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?125337600
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? 1044480
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 666666
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?3
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?34
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 6
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? 1280
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 720
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 73728000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?147456000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? 1843200
> ? ? ? ?dwDefaultFrameInterval ? ? ? ?1000000
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?2
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?3 (STILL_IMAGE_FRAME)
> ? ? ? ?bEndpointAddress ? ? ? ? ? ? ? ? ? ?0
> ? ? ? ?bNumImageSizePatterns ? ? ? ? ? ? ? 6
> ? ? ? ?wWidth( 0) ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight( 0) ? ? ? ? ? ? ? ? ? ? ? 360
> ? ? ? ?wWidth( 1) ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight( 1) ? ? ? ? ? ? ? ? ? ? ? 480
> ? ? ? ?wWidth( 2) ? ? ? ? ? ? ? ? ? ? ? ?320
> ? ? ? ?wHeight( 2) ? ? ? ? ? ? ? ? ? ? ? 240
> ? ? ? ?wWidth( 3) ? ? ? ? ? ? ? ? ? ? ? ?160
> ? ? ? ?wHeight( 3) ? ? ? ? ? ? ? ? ? ? ? 120
> ? ? ? ?wWidth( 4) ? ? ? ? ? ? ? ? ? ? ? ?960
> ? ? ? ?wHeight( 4) ? ? ? ? ? ? ? ? ? ? ? 544
> ? ? ? ?wWidth( 5) ? ? ? ? ? ? ? ? ? ? ? 1280
> ? ? ? ?wHeight( 5) ? ? ? ? ? ? ? ? ? ? ? 720
> ? ? ? ?bNumCompressionPatterns ? ? ? ? ? ? 6
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ? 6
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? 13 (COLORFORMAT)
> ? ? ? ?bColorPrimaries ? ? ? ? ? ? ? ? ? ? 1 (BT.709,sRGB)
> ? ? ? ?bTransferCharacteristics ? ? ? ? ? ?1 (BT.709)
> ? ? ? ?bMatrixCoefficients ? ? ? ? ? ? ? ? 4 (SMPTE 170M (BT.601))
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?6 (FORMAT_MJPEG)
> ? ? ? ?bFormatIndex ? ? ? ? ? ? ? ? ? ? ? ?2
> ? ? ? ?bNumFrameDescriptors ? ? ? ? ? ? ? ?6
> ? ? ? ?bFlags ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?0
> ? ? ? ? ?Fixed-size samples: No
> ? ? ? ?bDefaultFrameIndex ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bAspectRatioX ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bAspectRatioY ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bmInterlaceFlags ? ? ? ? ? ? ? ? 0x02
> ? ? ? ? ?Interlaced stream or variable: No
> ? ? ? ? ?Fields per frame: 2 fields
> ? ? ? ? ?Field 1 first: No
> ? ? ? ? ?Field pattern: Field 1 only
> ? ? ? ? ?bCopyProtect ? ? ? ? ? ? ? ? ? ? ?0
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 360
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 27648000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?165888000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?691200
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 2
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 480
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 36864000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?221184000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?921600
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 3
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?320
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 240
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?9216000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 55296000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?230400
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 4
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?160
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 120
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?2304000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 13824000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ? 57600
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 5
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?960
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 544
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 62668800
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?376012800
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? 1566720
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?50
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?7 (FRAME_MJPEG)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 6
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? 1280
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 720
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ?110592000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?663552000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? 2764800
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?6
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?400000
> ? ? ? ?dwFrameInterval( 2) ? ? ? ? ? ?500000
> ? ? ? ?dwFrameInterval( 3) ? ? ? ? ? ?666666
> ? ? ? ?dwFrameInterval( 4) ? ? ? ? ? 1000000
> ? ? ? ?dwFrameInterval( 5) ? ? ? ? ? 2000000
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?3 (STILL_IMAGE_FRAME)
> ? ? ? ?bEndpointAddress ? ? ? ? ? ? ? ? ? ?0
> ? ? ? ?bNumImageSizePatterns ? ? ? ? ? ? ? 6
> ? ? ? ?wWidth( 0) ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight( 0) ? ? ? ? ? ? ? ? ? ? ? 360
> ? ? ? ?wWidth( 1) ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight( 1) ? ? ? ? ? ? ? ? ? ? ? 480
> ? ? ? ?wWidth( 2) ? ? ? ? ? ? ? ? ? ? ? ?320
> ? ? ? ?wHeight( 2) ? ? ? ? ? ? ? ? ? ? ? 240
> ? ? ? ?wWidth( 3) ? ? ? ? ? ? ? ? ? ? ? ?160
> ? ? ? ?wHeight( 3) ? ? ? ? ? ? ? ? ? ? ? 120
> ? ? ? ?wWidth( 4) ? ? ? ? ? ? ? ? ? ? ? ?960
> ? ? ? ?wHeight( 4) ? ? ? ? ? ? ? ? ? ? ? 544
> ? ? ? ?wWidth( 5) ? ? ? ? ? ? ? ? ? ? ? 1280
> ? ? ? ?wHeight( 5) ? ? ? ? ? ? ? ? ? ? ? 720
> ? ? ? ?bNumCompressionPatterns ? ? ? ? ? ? 6
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ? 6
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? 13 (COLORFORMAT)
> ? ? ? ?bColorPrimaries ? ? ? ? ? ? ? ? ? ? 1 (BT.709,sRGB)
> ? ? ? ?bTransferCharacteristics ? ? ? ? ? ?1 (BT.709)
> ? ? ? ?bMatrixCoefficients ? ? ? ? ? ? ? ? 4 (SMPTE 170M (BT.601))
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 1
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x82 ?EP 2 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x13c0 ?3x 960 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Association:
> ? ? ?bLength ? ? ? ? ? ? ? ? 8
> ? ? ?bDescriptorType ? ? ? ?11
> ? ? ?bFirstInterface ? ? ? ? 2
> ? ? ?bInterfaceCount ? ? ? ? 2
> ? ? ?bFunctionClass ? ? ? ? ?1 Audio
> ? ? ?bFunctionSubClass ? ? ? 2 Streaming
> ? ? ?bFunctionProtocol ? ? ? 0
> ? ? ?iFunction ? ? ? ? ? ? ? 0
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?2
> ? ? ?bAlternateSetting ? ? ? 0
> ? ? ?bNumEndpoints ? ? ? ? ? 0
> ? ? ?bInterfaceClass ? ? ? ? 1 Audio
> ? ? ?bInterfaceSubClass ? ? ?1 Control Device
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?AudioControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (HEADER)
> ? ? ? ?bcdADC ? ? ? ? ? ? ? 1.00
> ? ? ? ?wTotalLength ? ? ? ? ? 38
> ? ? ? ?bInCollection ? ? ? ? ? 1
> ? ? ? ?baInterfaceNr( 0) ? ? ? 3
> ? ? ?AudioControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?12
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (INPUT_TERMINAL)
> ? ? ? ?bTerminalID ? ? ? ? ? ? 1
> ? ? ? ?wTerminalType ? ? ?0x0201 Microphone
> ? ? ? ?bAssocTerminal ? ? ? ? ?0
> ? ? ? ?bNrChannels ? ? ? ? ? ? 1
> ? ? ? ?wChannelConfig ? ? 0x0000
> ? ? ? ?iChannelNames ? ? ? ? ? 0
> ? ? ? ?iTerminal ? ? ? ? ? ? ? 0
> ? ? ?AudioControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 8
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?6 (FEATURE_UNIT)
> ? ? ? ?bUnitID ? ? ? ? ? ? ? ? 2
> ? ? ? ?bSourceID ? ? ? ? ? ? ? 1
> ? ? ? ?bControlSize ? ? ? ? ? ?1
> ? ? ? ?bmaControls( 0) ? ? ?0x03
> ? ? ? ? ?Mute
> ? ? ? ? ?Volume
> ? ? ? ?iFeature ? ? ? ? ? ? ? ?0
> ? ? ?AudioControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?3 (OUTPUT_TERMINAL)
> ? ? ? ?bTerminalID ? ? ? ? ? ? 3
> ? ? ? ?wTerminalType ? ? ?0x0101 USB Streaming
> ? ? ? ?bAssocTerminal ? ? ? ? ?1
> ? ? ? ?bSourceID ? ? ? ? ? ? ? 2
> ? ? ? ?iTerminal ? ? ? ? ? ? ? 0
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?3
> ? ? ?bAlternateSetting ? ? ? 0
> ? ? ?bNumEndpoints ? ? ? ? ? 0
> ? ? ?bInterfaceClass ? ? ? ? 1 Audio
> ? ? ?bInterfaceSubClass ? ? ?2 Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?3
> ? ? ?bAlternateSetting ? ? ? 1
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ? 1 Audio
> ? ? ?bInterfaceSubClass ? ? ?2 Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (AS_GENERAL)
> ? ? ? ?bTerminalLink ? ? ? ? ? 3
> ? ? ? ?bDelay ? ? ? ? ? ? ? ? ?1 frames
> ? ? ? ?wFormatTag ? ? ? ? ? ? ?1 PCM
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (FORMAT_TYPE)
> ? ? ? ?bFormatType ? ? ? ? ? ? 1 (FORMAT_TYPE_I)
> ? ? ? ?bNrChannels ? ? ? ? ? ? 1
> ? ? ? ?bSubframeSize ? ? ? ? ? 2
> ? ? ? ?bBitResolution ? ? ? ? 16
> ? ? ? ?bSamFreqType ? ? ? ? ? ?1 Discrete
> ? ? ? ?tSamFreq[ 0] ? ? ? ? 8000
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x83 ?EP 3 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0010 ?1x 16 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 4
> ? ? ? ?bRefresh ? ? ? ? ? ? ? ?0
> ? ? ? ?bSynchAddress ? ? ? ? ? 0
> ? ? ? ?AudioControl Endpoint Descriptor:
> ? ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ? ?bDescriptorType ? ? ? ?37
> ? ? ? ? ?bDescriptorSubtype ? ? ?1 (EP_GENERAL)
> ? ? ? ? ?bmAttributes ? ? ? ? 0x01
> ? ? ? ? ? ?Sampling Frequency
> ? ? ? ? ?bLockDelayUnits ? ? ? ? 0 Undefined
> ? ? ? ? ?wLockDelay ? ? ? ? ? ? ?0 Undefined
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?3
> ? ? ?bAlternateSetting ? ? ? 2
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ? 1 Audio
> ? ? ?bInterfaceSubClass ? ? ?2 Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (AS_GENERAL)
> ? ? ? ?bTerminalLink ? ? ? ? ? 3
> ? ? ? ?bDelay ? ? ? ? ? ? ? ? ?1 frames
> ? ? ? ?wFormatTag ? ? ? ? ? ? ?1 PCM
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (FORMAT_TYPE)
> ? ? ? ?bFormatType ? ? ? ? ? ? 1 (FORMAT_TYPE_I)
> ? ? ? ?bNrChannels ? ? ? ? ? ? 1
> ? ? ? ?bSubframeSize ? ? ? ? ? 2
> ? ? ? ?bBitResolution ? ? ? ? 16
> ? ? ? ?bSamFreqType ? ? ? ? ? ?1 Discrete
> ? ? ? ?tSamFreq[ 0] ? ? ? ?16000
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x83 ?EP 3 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0020 ?1x 32 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 4
> ? ? ? ?bRefresh ? ? ? ? ? ? ? ?0
> ? ? ? ?bSynchAddress ? ? ? ? ? 0
> ? ? ? ?AudioControl Endpoint Descriptor:
> ? ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ? ?bDescriptorType ? ? ? ?37
> ? ? ? ? ?bDescriptorSubtype ? ? ?1 (EP_GENERAL)
> ? ? ? ? ?bmAttributes ? ? ? ? 0x01
> ? ? ? ? ? ?Sampling Frequency
> ? ? ? ? ?bLockDelayUnits ? ? ? ? 0 Undefined
> ? ? ? ? ?wLockDelay ? ? ? ? ? ? ?0 Undefined
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?3
> ? ? ?bAlternateSetting ? ? ? 3
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ? 1 Audio
> ? ? ?bInterfaceSubClass ? ? ?2 Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (AS_GENERAL)
> ? ? ? ?bTerminalLink ? ? ? ? ? 3
> ? ? ? ?bDelay ? ? ? ? ? ? ? ? ?1 frames
> ? ? ? ?wFormatTag ? ? ? ? ? ? ?1 PCM
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (FORMAT_TYPE)
> ? ? ? ?bFormatType ? ? ? ? ? ? 1 (FORMAT_TYPE_I)
> ? ? ? ?bNrChannels ? ? ? ? ? ? 1
> ? ? ? ?bSubframeSize ? ? ? ? ? 2
> ? ? ? ?bBitResolution ? ? ? ? 16
> ? ? ? ?bSamFreqType ? ? ? ? ? ?1 Discrete
> ? ? ? ?tSamFreq[ 0] ? ? ? ?44100
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x83 ?EP 3 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x005a ?1x 90 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 4
> ? ? ? ?bRefresh ? ? ? ? ? ? ? ?0
> ? ? ? ?bSynchAddress ? ? ? ? ? 0
> ? ? ? ?AudioControl Endpoint Descriptor:
> ? ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ? ?bDescriptorType ? ? ? ?37
> ? ? ? ? ?bDescriptorSubtype ? ? ?1 (EP_GENERAL)
> ? ? ? ? ?bmAttributes ? ? ? ? 0x01
> ? ? ? ? ? ?Sampling Frequency
> ? ? ? ? ?bLockDelayUnits ? ? ? ? 0 Undefined
> ? ? ? ? ?wLockDelay ? ? ? ? ? ? ?0 Undefined
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?3
> ? ? ?bAlternateSetting ? ? ? 4
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ? 1 Audio
> ? ? ?bInterfaceSubClass ? ? ?2 Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (AS_GENERAL)
> ? ? ? ?bTerminalLink ? ? ? ? ? 3
> ? ? ? ?bDelay ? ? ? ? ? ? ? ? ?1 frames
> ? ? ? ?wFormatTag ? ? ? ? ? ? ?1 PCM
> ? ? ?AudioStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (FORMAT_TYPE)
> ? ? ? ?bFormatType ? ? ? ? ? ? 1 (FORMAT_TYPE_I)
> ? ? ? ?bNrChannels ? ? ? ? ? ? 1
> ? ? ? ?bSubframeSize ? ? ? ? ? 2
> ? ? ? ?bBitResolution ? ? ? ? 16
> ? ? ? ?bSamFreqType ? ? ? ? ? ?1 Discrete
> ? ? ? ?tSamFreq[ 0] ? ? ? ?48000
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x83 ?EP 3 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0060 ?1x 96 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 4
> ? ? ? ?bRefresh ? ? ? ? ? ? ? ?0
> ? ? ? ?bSynchAddress ? ? ? ? ? 0
> ? ? ? ?AudioControl Endpoint Descriptor:
> ? ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ? ?bDescriptorType ? ? ? ?37
> ? ? ? ? ?bDescriptorSubtype ? ? ?1 (EP_GENERAL)
> ? ? ? ? ?bmAttributes ? ? ? ? 0x01
> ? ? ? ? ? ?Sampling Frequency
> ? ? ? ? ?bLockDelayUnits ? ? ? ? 0 Undefined
> ? ? ? ? ?wLockDelay ? ? ? ? ? ? ?0 Undefined
> Device Qualifier (for other device speed):
> ?bLength ? ? ? ? ? ? ? ?10
> ?bDescriptorType ? ? ? ? 6
> ?bcdUSB ? ? ? ? ? ? ? 2.00
> ?bDeviceClass ? ? ? ? ?239 Miscellaneous Device
> ?bDeviceSubClass ? ? ? ? 2 ?
> ?bDeviceProtocol ? ? ? ? 1 Interface Association
> ?bMaxPacketSize0 ? ? ? ?64
> ?bNumConfigurations ? ? ?1
> Device Status: ? ? 0x0000
> ?(Bus Powered)
>
> 2011/3/23 Riku Sepp?l? <riku.seppala at kymp.net>:
>> On 03/23/2011 11:15 AM, Jesper Skottfelt wrote:
>>>
>>> Hi
>>>
>>> 'Creative Live! Cam Chat HD' is not on the list.
>>>
>>> The ID number is: ?041e:4088
>>>
>>>
>>> Regards, Jesper
>>> _______________________________________________
>>> Linux-uvc-devel mailing list
>>> Linux-uvc-devel at lists.berlios.de
>>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
>> I'll bet Laurent want you to send the output of
>>
>> lsusb -v -d 041e:4088
>>
>> (running as root if possible :)
>>
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
>
>
>
> --
> Venlig hilsen
>
> Jesper Skottfelt
>
> tlf: +45 30 13 53 51
> email: skottfelt at gmail.com
> skype: jskottfelt
>



-- 
Venlig hilsen

Jesper Skottfelt

tlf: +45 30 13 53 51
email: skottfelt at gmail.com
skype: jskottfelt

From pj.assis at gmail.com  Thu Mar 24 10:48:34 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Mar 2011 09:48:34 +0000
Subject: [Linux-uvc-devel] USB camera DFK 22BUC03 from ImagingSource
In-Reply-To: <02152457-BC49-4A9A-98AC-F18038ED4184@mpi-cbg.de>
References: <mailman.3885.1300892592.1407.linux-uvc-devel@lists.berlios.de>
	<02152457-BC49-4A9A-98AC-F18038ED4184@mpi-cbg.de>
Message-ID: <AANLkTintmyc76UruAQxv3g=i6437-nZj5rSLs_BRVyQT@mail.gmail.com>

Hi,

>     bFunctionClass        255 Vendor Specific Class
>     bFunctionSubClass       3

The camera is not uvc compatible, should read something like:

      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection

so I don't think it will work with the uvc driver, no matter how hard
you try :C.
You may have better luck with gspca, though, even if this implies a
bit of reverse engineering from the windows driver.


Best regards,
Paulo


From lists at easyb.ch  Thu Mar 24 14:18:42 2011
From: lists at easyb.ch (=?iso-8859-1?Q?Ezra_B=FChler?=)
Date: Thu, 24 Mar 2011 14:18:42 +0100
Subject: [Linux-uvc-devel] DigiMicro Scale 2.0
Message-ID: <6C71FAA0-4FD0-42BA-BCFB-999234FBBC0E@easyb.ch>

Hello

I am experiencing problems with a DigiMicro Scale 2.0 digital microscope when the video format is set to MJPEG. The frames received seem to be incomplete. When using a test app based on OpenCV following errors appear:

libv4lconvert: Error decompressing JPEG: fill_nbits error: need 1 more bits
libv4lconvert: Error decompressing JPEG: unknown huffman code: 0000fff6

With luvcview I get the same result. When using the YUYV format the picture is fine though. The cam is detected as a 0ac8:3420 Z-Star Microelectronics Corp. Venus USB2.0 Camera. The strange thing is that an other microscope of the same type works without problems. Looking more closely, I found that the camera with the issues uses a newer revision of the Camera Processor, a VC0342PLVBE, whereas the working one uses a VC0342PLVBD.

This was experienced on a Debian Squeeze machine using a 2.6.32-5-amd64 kernel. The problem persists with a 2.6.38 kernel.

I'm not sure how to approach further debugging. It would be nice if the camera would work out of the box.
I've attached some perhaps helpful information.

Thanx in advance,
Ezra.

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: demsg.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110324/cc70c8ef/attachment.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lsusb.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110324/cc70c8ef/attachment-0001.txt>

From pauljurczak at yahoo.com  Thu Mar 24 16:38:50 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Thu, 24 Mar 2011 08:38:50 -0700 (PDT)
Subject: [Linux-uvc-devel] DigiMicro Scale 2.0
In-Reply-To: <6C71FAA0-4FD0-42BA-BCFB-999234FBBC0E@easyb.ch>
Message-ID: <591304.88644.qm@web65412.mail.ac4.yahoo.com>

Hi Ezra,
VC0342PLVBD means 4th version of firmware and?VC0342PLVBE means 5th version of firmware. Chips are one time programmable. Quite likely they introduced a bug with a new release - happens all the time in software business.
Paul

--- On Thu, 3/24/11, Ezra B?hler <lists at easyb.ch> wrote:

From: Ezra B?hler <lists at easyb.ch>
Subject: [Linux-uvc-devel] DigiMicro Scale 2.0
To: Linux-uvc-devel at lists.berlios.de
Date: Thursday, March 24, 2011, 8:18 AM

Hello

I am experiencing problems with a DigiMicro Scale 2.0 digital microscope when the video format is set to MJPEG. The frames received seem to be incomplete. When using a test app based on OpenCV following errors appear:

libv4lconvert: Error decompressing JPEG: fill_nbits error: need 1 more bits
libv4lconvert: Error decompressing JPEG: unknown huffman code: 0000fff6

With luvcview I get the same result. When using the YUYV format the picture is fine though. The cam is detected as a 0ac8:3420 Z-Star Microelectronics Corp. Venus USB2.0 Camera. The strange thing is that an other microscope of the same type works without problems. Looking more closely, I found that the camera with the issues uses a newer revision of the Camera Processor, a VC0342PLVBE, whereas the working one uses a VC0342PLVBD.

This was experienced on a Debian Squeeze machine using a 2.6.32-5-amd64 kernel. The problem persists with a 2.6.38 kernel.

I'm not sure how to approach further debugging. It would be nice if the camera would work out of the box.
I've attached some perhaps helpful information.

Thanx in advance,
Ezra.


-----Inline Attachment Follows-----

_______________________________________________
Linux-uvc-devel mailing list
Linux-uvc-devel at lists.berlios.de
https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110324/0cfe64d6/attachment.html>

From laurent.pinchart at ideasonboard.com  Fri Mar 25 13:07:01 2011
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 25 Mar 2011 13:07:01 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <E73468FC-55DF-4D01-A07B-261427344CB8@mpi-cbg.de>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103072351.08288.laurent.pinchart@ideasonboard.com>
	<E73468FC-55DF-4D01-A07B-261427344CB8@mpi-cbg.de>
Message-ID: <201103251307.02957.laurent.pinchart@ideasonboard.com>

Hi Daniel,

On Friday 25 March 2011 11:48:57 Daniel James White wrote:

[snip]

> After learning how to compile the linux kernel (thanks Johannes for help
> there!)
> 
> (
> and realising that to insmod the uvcvideo.ko kernel module
> I needed to first
>  modprobe v4l1_compat
> then
> modprobe videodev
> since uvcvideo depends on them!
> )
> 
> I got the modified kernel module loaded,
> and connected the camera,
> and yes, it was recognised and cheese could see it.
> 
> Cheese sees 2 resolution modes,
> but neither seems to give a sensible image.
> The higher resolution mode is all black,
> and the 1024 mode is a magenta modern art piece.
> 
> Looks like some tweaking is needed to get the data in the right order?
> Maybe something to do the the paragraph copied in above from
> ftp://tis_ftp:Imaging199 at ftp.theimagingsource.com/Imaging/728a91/Linux%20an
> d%20TIS%20cameras.pdf
> 
> I did
> sudo insmod uvcvideo.ko trace=65535
> 
> so there are lots of nice messages in my kernel log,
> which I hope mean more to you than they do to me, so far... but I am
> learning along the way here.
> 
> The relevant part of the kernel log is attached as a zipped .txt file (it
> was quite big!)
> 
> Maybe Johannes and I can now figure out the rest,
> but if you have any tips on how to proceed, they would certainly be very
> welcome.
> 
> My colleague Pete has bought some similar cameras that we also need to make
> work, for a fancy new portable / briefcase SPIM microscope...
> so it will bear more fruit than just my own success.
> 
> cheers for the help so far... its very much appreciated!

You're welcome. Unfortunately, I'm afraid you won't be able to come up with a 
fix for your problem. Based on information I've received from the camera 
manufacturer, your camera is really not UVC compliant. It understands some UVC 
commands, but it requires a proprietary protocol for proper configuration.

-- 
Regards,

Laurent Pinchart


From white at mpi-cbg.de  Fri Mar 25 11:48:57 2011
From: white at mpi-cbg.de (Daniel James White)
Date: Fri, 25 Mar 2011 11:48:57 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <201103072351.08288.laurent.pinchart@ideasonboard.com>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103071759.06809.laurent.pinchart@ideasonboard.com>
	<DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>
	<201103072351.08288.laurent.pinchart@ideasonboard.com>
Message-ID: <E73468FC-55DF-4D01-A07B-261427344CB8@mpi-cbg.de>

Hi Laurent,

So I finally got a little time to keep investigating this:

On Mar 7, 2011, at 11:51 PM, Laurent Pinchart wrote:

snip

> Hi Dan,
> 
> On Monday 07 March 2011 21:54:21 Dan White wrote:
>> Hi Laurent,
>> 
>> not so good news from imagingsource...
>> 
>> they explained that they dont support UVC on linux directly themselves....
>> but there is some 3rd party support (eg right here with the linux kernel
>> UVC driver, and with unicam)
>> 
>> then they pointed me to this .pdf, which says the cmos cameras are !NOT!  
>> UVC compliant at all....  :-(
> 
> It might not be *that* bad, see below.
> 
>>>> Please download attachments from:
>>>> ftp://tis_ftp:Imaging199 at ftp.theimagingsource.com/Imaging/728a91/Linux%2
>>>> 0and%20TIS%20cameras.pdf
>>> 
>>> In that doc i read this:
>>> 
>>> "
>>> The Imaging Source USB CMOS cameras are not UVC compliant, however in
>>> some cases, the ?uvcvideo? driver can be modified to deliver video data
>>> from such a camera. The camera reports an incorrect UVC Video Format
>>> descriptor so that the driver will see two color formats: YUY2 and UYVY.
>>> The video data streamed by the camera will always be 8 bit monochrome
>>> video.
>>> The height will be as indicated in the video format descriptor. The width
>>> of the video format is twice the width indicated by the video format
>>> descriptor. On color cameras, the video data will contain a ?bayer
>>> pattern? which needs to be interpolated to get a color image from the
>>> monochrome data. The video format descriptor will report only one frame
>>> rate. There is no way to alter the frame rate via the UVC video format
>>> interface. Important: due to unpredictable variations of the chipsets
>>> used in The Imaging Source USB CMOS cameras these parameters are subject
>>> to change without any notice "
>> 
>> I wrote these words to them expressing my disappointment...
>> 
>>> Frankly, this is disappointing:
>>> On your front webpage, you make a big deal out of implementing
>>> "Technology based on standards"
>> 
>> So i fear these imaging source USB cmos cameras are not good targets for
>> easy inclusion into the linux-uvc world.... maybe i'm wrong...?
>> 
>> I think i will have to try the USB CCD cameras or even the firewire ones...
> 
> [snip]
> 
>> Bus 005 Device 004-199e-8207-ef-02: ID 199e:8207
>> Device Descriptor:
>>  bLength                18
>>  bDescriptorType         1
>>  bcdUSB               2.00
>>  bDeviceClass          239
>>  bDeviceSubClass         2
>>  bDeviceProtocol         1
>>  bMaxPacketSize0        64
>>  idVendor           0x199e
>>  idProduct          0x8207
>>  bcdDevice            8.13
>>  iManufacturer           2 The Imaging Source, GmbH
>>  iProduct                1 DFK 72BUC02
>>  iSerial                 3 44010155
>>  bNumConfigurations      1
>>  Configuration Descriptor:
>>    bLength                 9
>>    bDescriptorType         2
>>    wTotalLength          349
>>    bNumInterfaces          2
>>    bConfigurationValue     1
>>    iConfiguration          0
>>    bmAttributes         0x80
>>      (Bus Powered)
>>    MaxPower              500mA
>>    Interface Association:
>>      bLength                 8
>>      bDescriptorType        11
>>      bFirstInterface         0
>>      bInterfaceCount         2
>>      bFunctionClass        255
>>      bFunctionSubClass       3
>>      bFunctionProtocol       0
>>      iFunction               0
>>    Interface Descriptor:
>>      bLength                 9
>>      bDescriptorType         4
>>      bInterfaceNumber        0
>>      bAlternateSetting       0
>>      bNumEndpoints           1
>>      bInterfaceClass       255
>>      bInterfaceSubClass      1
>>      bInterfaceProtocol      0
>>      iInterface              0
> 
> That's definitely not UVC compliant, but it looks like that's the only UVC 
> non-compliance in the descriptors.
> 
> Could you try adding the following entry in the uvc_ids array (uvc_driver.c) ?
> 
>        { .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
>                                | USB_DEVICE_ID_MATCH_INT_INFO,
>          .idVendor             = 0x199e,
>          .idProduct            = 0x8207,
>          .bInterfaceClass      = USB_CLASS_VENDOR_SPEC,
>          .bInterfaceSubClass   = 1,
>          .bInterfaceProtocol   = 0 },
> 
> Please load the module with trace=65535 for additional debug messages in the 
> kernel log.

After learning how to compile the linux kernel (thanks Johannes for help there!)

(
and realising that to insmod the uvcvideo.ko kernel module
I needed to first
 modprobe v4l1_compat
then 
modprobe videodev
since uvcvideo depends on them!
)

I got the modified kernel module loaded, 
and connected the camera, 
and yes, it was recognised and cheese could see it. 

Cheese sees 2 resolution modes, 
but neither seems to give a sensible image. 
The higher resolution mode is all black, 
and the 1024 mode is a magenta modern art piece. 

Looks like some tweaking is needed to get the data in the right order?
Maybe something to do the the paragraph copied in above from 
ftp://tis_ftp:Imaging199 at ftp.theimagingsource.com/Imaging/728a91/Linux%20and%20TIS%20cameras.pdf

I did 
sudo insmod uvcvideo.ko trace=65535

so there are lots of nice messages in my kernel log, 
which I hope mean more to you than they do to me, so far... but I am learning along the way here. 

The relevant part of the kernel log is attached as a zipped .txt file (it was quite big!)

Maybe Johannes and I can now figure out the rest, 
but if you have any tips on how to proceed, they would certainly be very welcome. 

My colleague Pete has bought some similar cameras that we also need to make work, 
for a fancy new portable / briefcase SPIM microscope...
so it will bear more fruit than just my own success. 

cheers for the help so far... its very much appreciated!

Dan



-------------- next part --------------
A non-text attachment was scrubbed...
Name: DFK72BUC02-kernelLog.txt.zip
Type: application/zip
Size: 170720 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110325/e47d6ee3/attachment.zip>
-------------- next part --------------




> 
> -- 
> Regards,
> 
> Laurent Pinchart

Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Visualisation, Processing and Analysis
Light Microscopy and Image Processing Facilities 
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49 (0)351 210 2627 (Work phone at MPI-CBG)
+49 (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net 	BioImageXD
http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
http://www.chalkie.org.uk		Dan's Homepages
https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
dan (at) chalkie.org.uk
( white (at) mpi-cbg.de )












From white at mpi-cbg.de  Fri Mar 25 12:39:29 2011
From: white at mpi-cbg.de (Daniel James White)
Date: Fri, 25 Mar 2011 12:39:29 +0100
Subject: [Linux-uvc-devel] a new camera for the list - imagingsource
	DFK72BUC02
In-Reply-To: <alpine.DEB.1.00.1103251214120.15247@pacific.mpi-cbg.de>
References: <172F2C9A-953A-4452-8769-6FDC12E59DDB@mpi-cbg.de>
	<201103071759.06809.laurent.pinchart@ideasonboard.com>
	<DE96DBC7-5481-46E8-8B5C-701B144C71FF@mpi-cbg.de>
	<201103072351.08288.laurent.pinchart@ideasonboard.com>
	<E73468FC-55DF-4D01-A07B-261427344CB8@mpi-cbg.de>
	<alpine.DEB.1.00.1103251214120.15247@pacific.mpi-cbg.de>
Message-ID: <7C5BADDA-1EAE-41A1-8B3F-77C713DB0A6B@mpi-cbg.de>

Hi Johannes,

On Mar 25, 2011, at 12:16 PM, Johannes Schindelin wrote:

> Hi,
> 
> On Fri, 25 Mar 2011, Daniel James White wrote:
> 
>> The higher resolution mode is all black, and the 1024 mode is a magenta 
>> modern art piece.
> 
> Maybe the mode is not detected correctly. Is it possible that a YCbCr 
> image is mistaken for RGB? IOW do you see sensible shapes, but only the 
> color is off, or are even pixel locations wrong?

I, indeed do not see sensible shapes, the xy space is scrambled
as if the frame size is wrong. This seems to be predicted by the text of the doc I linked to in the last email:
ftp://tis_ftp:Imaging199 at ftp.theimagingsource.com/Imaging/728a91/Linux%20and%20TIS%20cameras.pdf

it can do these resolutions (from http://www.theimagingsource.com/en_US/products/cameras/usb-cmos-color/dfk72buc02/)

Example Configurations
Resolution	Format	FPS	Sensitivity
SET RESOLUTION, FORMAT, FPS AND SENSITIVITY WITH SHIPPED SOFTWARE.
2592x1944	1/2.5 "	6	1.4 V/lux-sec
2048x1536	1/3 "	9	1.4 V/lux-sec
1600x1200	1/4 "	13	1.4 V/lux-sec
1280x960	1/4.5 "	19	1.4 V/lux-sec
1280x960	1/2.5 "	15	5.6 V/lux-sec
1024x768	1/5.5 "	27	1.4 V/lux-sec
640x480	1/9 "	52	1.4 V/lux-sec
640x480	1/2.5 "	23	22.4 V/lux-sec

but I'm not sure what UVC supports out of those....
cheese sees only
1296x1944 (which must be wrong - should be 2592x1944
and
1024 x 768 (which could be correct, but reading out only a small part of the centre of the chip)

AFAIK the different FORMATs mean that smaller or larger areas of the chip area are read out, 
and the lower resolution of the same Format size mean that there is pixel group binning....

Also, yes, the colours do seem to be in the wrong space. 
Darkness gives green and light gives magenta. 
This is also mentioned i think in that doc. 

This is a colour CMOS, so we do expect an RGB image on the screen, not monochrome. 

see attached screenshot

But, good news is that the frame rate is high... maybe 10 fps, and uses only 25% of my CPU power, 
so on Petes netbook it should not struggle to go fast either. 

cheers

D
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Screen shot 2011-03-25 at 12.25.40 PM.png
Type: image/png
Size: 377726 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110325/a8837f54/attachment.png>
-------------- next part --------------

> 
> Ciao,
> Dscho

Dr. Daniel James White BSc. (Hons.) PhD
Senior Microscopist / Image Visualisation, Processing and Analysis
Light Microscopy and Image Processing Facilities 
Max Planck Institute of Molecular Cell Biology and Genetics
Pfotenhauerstrasse 108
01307 DRESDEN
Germany

+49 (0)15114966933 (German Mobile)
+49 (0)351 210 2627 (Work phone at MPI-CBG)
+49 (0)351 210 1078 (Fax MPI-CBG LMF)

http://www.bioimagexd.net 	BioImageXD
http://pacific.mpi-cbg.de		Fiji -  is just ImageJ (Batteries Included)
http://www.chalkie.org.uk		Dan's Homepages
https://ifn.mpi-cbg.de 			Dresden Imaging Facility Network
dan (at) chalkie.org.uk
( white (at) mpi-cbg.de )












From pauljurczak at yahoo.com  Sat Mar 26 00:31:51 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Fri, 25 Mar 2011 16:31:51 -0700 (PDT)
Subject: [Linux-uvc-devel] DigiMicro Scale 2.0
Message-ID: <483687.21973.qm@web65406.mail.ac4.yahoo.com>

I just bought Gear Head WC1300BLK camera with the same?VC0342PLVBE?controller and VGA sensor. Camera works fine with GUVCViewer. Compared with your camera it lacks FRAME_MJPEG formats, only FRAME_UNCOMPRESSED are present.
VC0342PLVBE supports MJPEG in high speed mode as pass-trough, only if image sensor is able to provide it.?VC0342PLVBE will perform MJPEG compression in full speed mode at CIF and lower resolutions (you can test it by going through USB1.1 hub). So what may have happened here is manufacturing change of image sensor used on your camera. The new one no longer has MJPEG output. These things happen with terrifying frequency when you source the product from China. Each shipment brings something new and exciting.
Paul.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110325/511eb2c0/attachment.html>

From formisc at gmail.com  Sat Mar 26 14:21:13 2011
From: formisc at gmail.com (Misc Things)
Date: Sat, 26 Mar 2011 09:21:13 -0400
Subject: [Linux-uvc-devel] can't compile UVC package
Message-ID: <AANLkTin=_TatueMdACAmVvj9QoLipmmUtgzJ1XZ9dJ+8@mail.gmail.com>

Hello,
 i'm trying to compile the package and this is what i'm stuck @:
[code]
az at server v4l-dvb-abd3aac6644e]$ pwd
/home/az/v4l-dvb-abd3aac6644e

[az at server v4l-dvb-abd3aac6644e]$ id
uid=500(az) gid=502(az) groups=100(users),101(mock),502(az)

[az at server v4l-dvb-abd3aac6644e]$ uname -a
Linux server.home 2.6.18-194.17.1.el5.centos.plus #1 SMP Thu Sep 30
19:27:35 EDT 2010 i686 athlon i386 GNU/Linux

rpm -qa |grep kernel*
kernel-2.6.18-164.11.1.el5.centos.plus
kernel-2.6.18-164.15.1.el5.centos.plus
kernel-devel-2.6.18-194.17.1.el5.centos.plus
kernel-2.6.18-194.17.1.el5.centos.plus
kernel-devel-2.6.18-164.11.1.el5.centos.plus
kernel-headers-2.6.18-194.17.1.el5.centos.plus
kernel-devel-2.6.18-164.15.1.el5.centos.plus

ls -lh /usr/src/kernels/
total 12K
drwxr-xr-x 19 root root 4.0K Jan 24  2010 2.6.18-164.11.1.el5.centos.plus-i686
drwxr-xr-x 19 root root 4.0K Mar 20  2010 2.6.18-164.15.1.el5.centos.plus-i686
drwxr-xr-x 19 root root 4.0K Oct  7 23:05 2.6.18-194.17.1.el5.centos.plus-i686
ls -lh /usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686/
total 852K
drwxr-xr-x 26 root root 4.0K Oct  7 23:05 arch
drwxr-xr-x  2 root root 4.0K Oct  7 23:05 block
drwxr-xr-x  4 root root 4.0K Oct  7 23:05 crypto
drwxr-xr-x 68 root root 4.0K Oct  7 23:05 drivers
drwxr-xr-x 66 root root 4.0K Oct  7 23:05 fs
drwxr-xr-x 22 root root 4.0K Oct  7 23:05 include
drwxr-xr-x  2 root root 4.0K Oct  7 23:05 init
drwxr-xr-x  2 root root 4.0K Oct  7 23:05 ipc
-rw-r--r--  1 root root  57K Sep 30 20:01 kabi_whitelist
drwxr-xr-x  5 root root 4.0K Oct  7 23:05 kernel
drwxr-xr-x  5 root root 4.0K Oct  7 23:05 lib
-rw-r--r--  1 root root  48K Sep 30 20:03 Makefile
drwxr-xr-x  2 root root 4.0K Oct  7 23:05 mm
-rw-r--r--  1 root root 165K Sep 30 20:02 Module.kabi
-rw-r--r--  1 root root 2.1K Sep 30 20:03 Module.markers
-rw-r--r--  1 root root 433K Sep 30 20:03 Module.symvers
drwxr-xr-x 43 root root 4.0K Oct  7 23:05 net
drwxr-xr-x  4 root root 4.0K Oct  7 23:05 samples
drwxr-xr-x 10 root root 4.0K Oct  7 23:05 scripts
drwxr-xr-x  4 root root 4.0K Oct  7 23:05 security
drwxr-xr-x 18 root root 4.0K Oct  7 23:05 sound
-rw-r--r--  1 root root  49K Sep 30 20:03
symsets-2.6.18-194.17.1.el5.centos.plus.tar.gz
drwxr-xr-x  2 root root 4.0K Oct  7 23:05 usr

[/code]

and now :
[code]
pwd
/home/az/v4l-dvb-abd3aac6644e

[az at server v4l-dvb-abd3aac6644e]$ ls
COPYING  hgimport  INSTALL  linux  mailimport  Makefile  media-specs
README  README.patches  v4l  v4l_experimental

[az at server v4l-dvb-abd3aac6644e]$ make menuconfig
make -C /home/az/v4l-dvb-abd3aac6644e/v4l menuconfig
make[1]: Entering directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
make -C /lib/modules/2.6.18-194.17.1.el5.centos.plus/build -f
/home/az/v4l-dvb-abd3aac6644e/v4l/Makefile.kernel config-targets=1
mixed-targets=0 dot-config=0
SRCDIR=/lib/modules/2.6.18-194.17.1.el5.centos.plus/source v4l-mconf
make[2]: Entering directory
`/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
  HOSTCC  scripts/basic/fixdep
scripts/basic/fixdep.c:393: fatal error: opening dependency file
scripts/basic/.fixdep.d: Permission denied
compilation terminated.
make[3]: *** [scripts/basic/fixdep] Error 1
make[2]: *** [scripts_basic] Error 2
make[2]: Leaving directory
`/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
make[1]: *** [/lib/modules/2.6.18-194.17.1.el5.centos.plus/build/scripts/kconfig/mconf]
Error 2
make[1]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
make: *** [menuconfig] Error 2
[/code]


From formisc at gmail.com  Sat Mar 26 16:25:12 2011
From: formisc at gmail.com (Misc Things)
Date: Sat, 26 Mar 2011 11:25:12 -0400
Subject: [Linux-uvc-devel] can't compile UVC package
In-Reply-To: <AANLkTin=_TatueMdACAmVvj9QoLipmmUtgzJ1XZ9dJ+8@mail.gmail.com>
References: <AANLkTin=_TatueMdACAmVvj9QoLipmmUtgzJ1XZ9dJ+8@mail.gmail.com>
Message-ID: <AANLkTimu1No_ZR22f8b4LJoWSjA_xxjO=3ksGxXyjXRB@mail.gmail.com>

On Sat, Mar 26, 2011 at 9:21 AM, Misc Things <formisc at gmail.com> wrote:
> Hello,
> ?i'm trying to compile the package and this is what i'm stuck @:
> [code]
> az at server v4l-dvb-abd3aac6644e]$ pwd
> /home/az/v4l-dvb-abd3aac6644e
>
> [az at server v4l-dvb-abd3aac6644e]$ id
> uid=500(az) gid=502(az) groups=100(users),101(mock),502(az)
>
<skip>
> scripts/basic/fixdep.c:393: fatal error: opening dependency file
> scripts/basic/.fixdep.d: Permission denied
> compilation terminated.
<skip>
> [/code]


uh-uh, i just spotted it - i should be "root" to compile. very strange, but ok.

all right, i was able to make selections in menuconfig, but all
attepmts to proceed with the compilation failed:

[code]
#
# configuration written to .config
#


*** End of Linux kernel configuration.
*** Execute 'make' to build the kernel or try 'make help'.

./scripts/fix_kconfig.pl
make[1]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
[root at server v4l-dvb-abd3aac6644e]# make
make -C /home/az/v4l-dvb-abd3aac6644e/v4l
make[1]: Entering directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
scripts/make_makefile.pl
./scripts/make_myconfig.pl
make[1]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
make[1]: Entering directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
perl scripts/make_config_compat.pl
/lib/modules/2.6.18-194.17.1.el5.centos.plus/source ./.myconfig
./config-compat.h
creating symbolic links...
ln -sf . oss
make -C firmware prep
make[2]: Entering directory `/home/az/v4l-dvb-abd3aac6644e/v4l/firmware'
make[2]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l/firmware'
make -C firmware
make[2]: Entering directory `/home/az/v4l-dvb-abd3aac6644e/v4l/firmware'
  CC  ihex2fw
Generating vicam/firmware.fw
Generating dabusb/firmware.fw
Generating dabusb/bitstream.bin
Generating ttusb-budget/dspbootcode.bin
Generating cpia2/stv0672_vp4.bin
Generating av7110/bootcode.bin
make[2]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l/firmware'
Kernel build directory is /lib/modules/2.6.18-194.17.1.el5.centos.plus/build
make -C /lib/modules/2.6.18-194.17.1.el5.centos.plus/build
SUBDIRS=/home/az/v4l-dvb-abd3aac6644e/v4l  modules
make[2]: Entering directory
`/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
  CC [M]  /home/az/v4l-dvb-abd3aac6644e/v4l/tuner-xc2028.o
In file included from /home/az/v4l-dvb-abd3aac6644e/v4l/tuner-xc2028.c:19:
/home/az/v4l-dvb-abd3aac6644e/v4l/compat.h:133: error: static
declaration of 'strict_strtoul' follows non-static declaration
include/linux/kernel.h:141: error: previous declaration of
'strict_strtoul' was here
make[3]: *** [/home/az/v4l-dvb-abd3aac6644e/v4l/tuner-xc2028.o] Error 1
make[2]: *** [_module_/home/az/v4l-dvb-abd3aac6644e/v4l] Error 2
make[2]: Leaving directory
`/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
make[1]: *** [default] Error 2
make[1]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
make: *** [all] Error 2

[/code]
now i'm completely clueless. I also attached config file for the reference.

Please advise.
Andrew
-------------- next part --------------
A non-text attachment was scrubbed...
Name: .config
Type: application/octet-stream
Size: 5834 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110326/38056577/attachment.obj>

From formisc at gmail.com  Sat Mar 26 19:37:38 2011
From: formisc at gmail.com (Misc Things)
Date: Sat, 26 Mar 2011 14:37:38 -0400
Subject: [Linux-uvc-devel] can't compile UVC package
In-Reply-To: <AANLkTimu1No_ZR22f8b4LJoWSjA_xxjO=3ksGxXyjXRB@mail.gmail.com>
References: <AANLkTin=_TatueMdACAmVvj9QoLipmmUtgzJ1XZ9dJ+8@mail.gmail.com>
	<AANLkTimu1No_ZR22f8b4LJoWSjA_xxjO=3ksGxXyjXRB@mail.gmail.com>
Message-ID: <AANLkTi=6-8qTb+rtDASRXjHwv+XFikuAS8N2x=PBQjh=@mail.gmail.com>

On Sat, Mar 26, 2011 at 11:25 AM, Misc Things <formisc at gmail.com> wrote:
<skip>
> make -C /lib/modules/2.6.18-194.17.1.el5.centos.plus/build
> SUBDIRS=/home/az/v4l-dvb-abd3aac6644e/v4l ?modules
> make[2]: Entering directory
> `/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
> ?CC [M] ?/home/az/v4l-dvb-abd3aac6644e/v4l/tuner-xc2028.o
> In file included from /home/az/v4l-dvb-abd3aac6644e/v4l/tuner-xc2028.c:19:
> /home/az/v4l-dvb-abd3aac6644e/v4l/compat.h:133: error: static
> declaration of 'strict_strtoul' follows non-static declaration
> include/linux/kernel.h:141: error: previous declaration of
> 'strict_strtoul' was here
> make[3]: *** [/home/az/v4l-dvb-abd3aac6644e/v4l/tuner-xc2028.o] Error 1
> make[2]: *** [_module_/home/az/v4l-dvb-abd3aac6644e/v4l] Error 2
> make[2]: Leaving directory
> `/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
> make[1]: *** [default] Error 2
> make[1]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
> make: *** [all] Error 2
>
> [/code]
> now i'm completely clueless. I also attached config file for the reference.
>
> Please advise.
> Andrew
>

One another step - i commented out the declaration of strict_strtoul'
from compact.h
[code]
diff -h ./compat.h ./compat.h0
132d131
< /*
153d151
< */
[/code]

but now it's crashing on
[code]
CC [M]  /home/az/v4l-dvb-abd3aac6644e/v4l/bttv-driver.o
In file included from /home/az/v4l-dvb-abd3aac6644e/v4l/bttvp.h:40,
                 from /home/az/v4l-dvb-abd3aac6644e/v4l/bttv-driver.c:48:
/home/az/v4l-dvb-abd3aac6644e/v4l/compat.h:66: error: static
declaration of 'pci_msi_enabled' follows non-static declaration
include/linux/pci.h:740: error: previous declaration of
'pci_msi_enabled' was here
In file included from
/home/az/v4l-dvb-abd3aac6644e/v4l/../linux/include/media/ir-common.h:29,
                 from /home/az/v4l-dvb-abd3aac6644e/v4l/bttvp.h:45,
                 from /home/az/v4l-dvb-abd3aac6644e/v4l/bttv-driver.c:48:
/home/az/v4l-dvb-abd3aac6644e/v4l/../linux/include/media/ir-core.h: In
function 'ir_input_register':
/home/az/v4l-dvb-abd3aac6644e/v4l/../linux/include/media/ir-core.h:121:
error: implicit declaration of function 'input_get_drv
 data'
/home/az/v4l-dvb-abd3aac6644e/v4l/../linux/include/media/ir-core.h:121:
warning: assignment makes pointer from integer without
  a cast
make[3]: *** [/home/az/v4l-dvb-abd3aac6644e/v4l/bttv-driver.o] Error 1
make[2]: *** [_module_/home/az/v4l-dvb-abd3aac6644e/v4l] Error 2
make[2]: Leaving directory
`/usr/src/kernels/2.6.18-194.17.1.el5.centos.plus-i686'
make[1]: *** [default] Error 2
make[1]: Leaving directory `/home/az/v4l-dvb-abd3aac6644e/v4l'
make: *** [all] Error 2
[/code]

can't move further again...
 what a pain :(


From benson.bear at gmail.com  Sun Mar 27 13:18:25 2011
From: benson.bear at gmail.com (Benson Bear)
Date: Sun, 27 Mar 2011 07:18:25 -0400
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
Message-ID: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>

I have a UVC web cam, the Creative Live! Cam Chat HD, and am trying
to  run it under Fedora 14's 2.6.35.11-83.fc14.i686.PAE kernel,
using X.Org X Server 1.9.4, and the current intel driver for the on-chip
integrated graphics of a core I3 processor.

This camera works nicely in everything like cheese, camstream, camorama,
xawtv and guvcview.  It doesn't work in the one thing I want it for: Skype.

I am pretty sure this is Skype's fault, exacerbated by its closed nature
and the fact it has not had an upgrade for a long while.   But I
wonder if anyone has an idea whether this could be fixed or whether
I should just return the camera for restocking fee and keep trying
other ones. (I note that the V0700 doesn't appear to be officially
supported, but since it works in everything else, Skype seems to be
to blame).

Here is the ID from lsusb:
Bus 001 Device 009: ID 041e:4088 Creative Technology, Ltd

What usb and uvcvideo report in /var/log/messages:
[52201.794788] usb 1-1.5: Product: VF0700 Live! Cam Chat HD
[52201.794793] usb 1-1.5: Manufacturer: Creative Technology Ltd.
[52201.794797] usb 1-1.5: SerialNumber: 0L220009
[52201.799938] uvcvideo: Found UVC 1.00 device VF0700 Live! Cam Chat
HD (041e:4088)

I can include in subsequent messages more of v4l-info and lsusb details,
but for now the most potentially useful observations seem to me to be the
following:

v4l-info seems to be saying that the camera has multiple possible
video capture modes:

video capture
    VIDIOC_ENUM_FMT(0,VIDEO_CAPTURE)
        index                   : 0
        type                    : VIDEO_CAPTURE
        flags                   : 0
        description             : "YUV 4:2:2 (YUYV)"
        pixelformat             : 0x56595559 [YUYV]
    VIDIOC_ENUM_FMT(1,VIDEO_CAPTURE)
        index                   : 1
        type                    : VIDEO_CAPTURE
        flags                   : 1
        description             : "MJPEG"
        pixelformat             : 0x47504a4d [MJPG]
    VIDIOC_G_FMT(VIDEO_CAPTURE)
        type                    : VIDEO_CAPTURE
        fmt.pix.width           : 320
        fmt.pix.height          : 240
        fmt.pix.pixelformat     : 0x56595559 [YUYV]
        fmt.pix.field           : NONE
        fmt.pix.bytesperline    : 640
        fmt.pix.sizeimage       : 153600
        fmt.pix.colorspace      : SRGB
        fmt.pix.priv            : 0

Guvcview, it seems (I keep saying "it seems" because I don't
really understand this) to allow us to see what the cameras streaming
output looks like when interpreted in different ways.

By default it chooses MJPG, but if I choose YUYV, it
produces a distorted output that looks *very similar* to
the distorted output produced by Skype.

This leads me to believe that perhaps the only problem is
that Skype is not interpreting the output of the camera
correctly, and all that perhaps need be done is to force
the camera to put out the kind of output Skype thinks it
is getting.

This does not seem to require any conversion anywhere
since the camera appears to be capable of putting out
the YUYV that I speculate Skype thinks it is getting.

Does any expert think this is a possibility, and if so
would it be hard to force the camera to just put out
a selected one of its native modes?

I assume the UVC interface already allows one to force a
certain mode output but that Skype messes this up and
the solution would have to be to set the default mode
differently.  Perhaps not as there is not option for
any of this on the two v4l control panels I am aware
of.

(Other things tried to far, to no avail: setting
Skype to various capture sizes and frame rates,
thinking perhaps it was confused about thos, and
also trying the fake video stream thing that is
floating around from a view years ago.  Haven't
gotten too far with that as of yet.)

Thanks


From bug-track at fisher-privat.net  Sun Mar 27 15:07:42 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Sun, 27 Mar 2011 15:07:42 +0200
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
Message-ID: <1301231263.18238.2.camel@mini>

Am Sonntag, den 27.03.2011, 07:18 -0400 schrieb Benson Bear:
> I have a UVC web cam, the Creative Live! Cam Chat HD, and am trying
> to  run it under Fedora 14's 2.6.35.11-83.fc14.i686.PAE kernel,
> using X.Org X Server 1.9.4, and the current intel driver for the on-chip
> integrated graphics of a core I3 processor.
> 
> This camera works nicely in everything like cheese, camstream, camorama,
> xawtv and guvcview.  It doesn't work in the one thing I want it for: Skype.
> 
> I am pretty sure this is Skype's fault, exacerbated by its closed nature
> and the fact it has not had an upgrade for a long while.   But I
> wonder if anyone has an idea whether this could be fixed or whether
> I should just return the camera for restocking fee and keep trying
> other ones. (I note that the V0700 doesn't appear to be officially
> supported, but since it works in everything else, Skype seems to be
> to blame).
> 
> Here is the ID from lsusb:
> Bus 001 Device 009: ID 041e:4088 Creative Technology, Ltd
> 
> What usb and uvcvideo report in /var/log/messages:
> [52201.794788] usb 1-1.5: Product: VF0700 Live! Cam Chat HD
> [52201.794793] usb 1-1.5: Manufacturer: Creative Technology Ltd.
> [52201.794797] usb 1-1.5: SerialNumber: 0L220009
> [52201.799938] uvcvideo: Found UVC 1.00 device VF0700 Live! Cam Chat
> HD (041e:4088)
> 
> I can include in subsequent messages more of v4l-info and lsusb details,
> but for now the most potentially useful observations seem to me to be the
> following:
> 
> v4l-info seems to be saying that the camera has multiple possible
> video capture modes:
> 
> video capture
>     VIDIOC_ENUM_FMT(0,VIDEO_CAPTURE)
>         index                   : 0
>         type                    : VIDEO_CAPTURE
>         flags                   : 0
>         description             : "YUV 4:2:2 (YUYV)"
>         pixelformat             : 0x56595559 [YUYV]
>     VIDIOC_ENUM_FMT(1,VIDEO_CAPTURE)
>         index                   : 1
>         type                    : VIDEO_CAPTURE
>         flags                   : 1
>         description             : "MJPEG"
>         pixelformat             : 0x47504a4d [MJPG]
>     VIDIOC_G_FMT(VIDEO_CAPTURE)
>         type                    : VIDEO_CAPTURE
>         fmt.pix.width           : 320
>         fmt.pix.height          : 240
>         fmt.pix.pixelformat     : 0x56595559 [YUYV]
>         fmt.pix.field           : NONE
>         fmt.pix.bytesperline    : 640
>         fmt.pix.sizeimage       : 153600
>         fmt.pix.colorspace      : SRGB
>         fmt.pix.priv            : 0
> 
> Guvcview, it seems (I keep saying "it seems" because I don't
> really understand this) to allow us to see what the cameras streaming
> output looks like when interpreted in different ways.
> 
> By default it chooses MJPG, but if I choose YUYV, it
> produces a distorted output that looks *very similar* to
> the distorted output produced by Skype.
> 
> This leads me to believe that perhaps the only problem is
> that Skype is not interpreting the output of the camera
> correctly, and all that perhaps need be done is to force
> the camera to put out the kind of output Skype thinks it
> is getting.
> 
> This does not seem to require any conversion anywhere
> since the camera appears to be capable of putting out
> the YUYV that I speculate Skype thinks it is getting.
> 
> Does any expert think this is a possibility, and if so
> would it be hard to force the camera to just put out
> a selected one of its native modes?
> 
> I assume the UVC interface already allows one to force a
> certain mode output but that Skype messes this up and
> the solution would have to be to set the default mode
> differently.  Perhaps not as there is not option for
> any of this on the two v4l control panels I am aware
> of.
> 
> (Other things tried to far, to no avail: setting
> Skype to various capture sizes and frame rates,
> thinking perhaps it was confused about thos, and
> also trying the fake video stream thing that is
> floating around from a view years ago.  Haven't
> gotten too far with that as of yet.)
> 

please attach output of "lsusb -vd 041e:4088 > lsusb"

and please attach a dump of first frame "luvcview -f yuv -s 320x240 -c"
(you will get file frame000.raw)

Regards,
	Alexey



From pauljurczak at yahoo.com  Sun Mar 27 20:50:56 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Sun, 27 Mar 2011 11:50:56 -0700 (PDT)
Subject: [Linux-uvc-devel] uvcvideo.txt missing?
Message-ID: <479273.89560.qm@web65401.mail.ac4.yahoo.com>

Hi,
I'm trying to get UVC driver documentation and it seems that?uvcvideo.txt file is missing. I looked at kernel.org sources for versions 2.6.38 and 2.6.31. Is there another place to look for current documentation of UVC driver API?
Thank you,Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110327/28978eca/attachment.html>

From benson.bear at gmail.com  Mon Mar 28 00:24:19 2011
From: benson.bear at gmail.com (Benson Bear)
Date: Sun, 27 Mar 2011 18:24:19 -0400
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <1301231263.18238.2.camel@mini>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<1301231263.18238.2.camel@mini>
Message-ID: <AANLkTi=pX1AofNtDSZhjKQwV3kvSwoa1j_qw+GTqO9DB@mail.gmail.com>

On Sun, Mar 27, 2011 at 9:07 AM, Alexey Fisher
<bug-track at fisher-privat.net> wrote:

> please attach output of "lsusb -vd 041e:4088 > lsusb"
> and please attach a dump of first frame "luvcview -f yuv -s 320x240 -c"

Thank you for your reply.   Please see attached.

I have never used luvcview.  It is interesting that
no matter how I specify the -f option here, it gives
the same result, and that result is subjectively
very similar to what skype is showing.  The
horizontal split in the screen hops up and down.
I cannot get luvcview to show a normal
undistorted view at all, counter to all the other
programs I mentioned in my last message: is
it perhaps subject to the same problem that
skype is?

(Actually, the raw image attachment is too
large for the list.  In the rare event
anyone other than Alexey wants to take
a look at it, let me know.  I can describe
it a little:  the correct image is cut horizontally
about 2/3 of the way down and glued
together with the top part on the bottom,
and it has horizontal bands of
distortion throughout.)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb
Type: application/octet-stream
Size: 30977 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110327/358b0e07/attachment.obj>

From benson.bear at gmail.com  Mon Mar 28 03:04:05 2011
From: benson.bear at gmail.com (Benson Bear)
Date: Sun, 27 Mar 2011 21:04:05 -0400
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
Message-ID: <AANLkTikY0zFsOzvYu-S2031Zmp5X3adi94HaxznQ1UYw@mail.gmail.com>

On Sun, Mar 27, 2011 at 7:18 AM, I wrote:

> This camera works nicely in everything like cheese, camstream, camorama,
> xawtv and guvcview. ?It doesn't work in the one thing I want it for: Skype.

> This leads me to believe that perhaps the only problem is
> that Skype is not interpreting the output of the camera
> correctly, and all that perhaps need be done is to force
> the camera to put out the kind of output Skype thinks it
> is getting.

In some practical sense at least I think I sort of solved
the problem, with a lot of googling.  Having seen the
idea of gstreamer pipes as used years ago in that
"gst video stream" thing,  I thought there should be a sink
to a virtual webcam, and it turns out there is, something
called v42loopback.

I built this, loaded the kernel module it makes, getting
a /dev/video0, then plugged in the camera, getting a /dev/video1,
and then with some fiddling and guesswork ended up with:

gst-launch v4l2src device=/dev/video1 !
video/x-raw-yuv,width=640,height=480,framerate=20/1 ! v4l2sink
device=/dev/video0

and with this, skype produces good results reading from /dev/video0.

I am still not sure what is happening here, perhaps an expert could explain.
I presume the v4l2src is putting out mjpg format and the second pipe
element forces it to yuv, which is what skype wants.

Could Alexey or some other person say if there still could
be some issue with the webcam that could be fixed so this
would not be necessary?  Also, could they advise on whether
this technique is an acceptable solution?  For example,
I am a little concerned that the v4l2loopback is a kernel module
that  is not distributed and I just causally built it and loaded
it without knowing much about how wise that is. (Maybe knowing
nothing about what is available for these gstreamer pipes
I have missed a more current technique for doing this
sort of thing).  Also, this seems to be doing some
unnecessary work if the webcam can be forced to
serve up the correct pixel format from the beginning.

Thanks.


From pj.assis at gmail.com  Mon Mar 28 10:26:52 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 28 Mar 2011 09:26:52 +0100
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTikY0zFsOzvYu-S2031Zmp5X3adi94HaxznQ1UYw@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<AANLkTikY0zFsOzvYu-S2031Zmp5X3adi94HaxznQ1UYw@mail.gmail.com>
Message-ID: <AANLkTi=VYD+ZUPHc-HNtxW0-Xeq0KA6+MpA7_Ynh-uK4@mail.gmail.com>

Hi,
you could also try preloading libv4l, something like:

LD_PRELOAD=/usr/lib/libv4l/v4l2convert.so skype

Regards,
Paulo


2011/3/28 Benson Bear <benson.bear at gmail.com>:
> On Sun, Mar 27, 2011 at 7:18 AM, I wrote:
>
>> This camera works nicely in everything like cheese, camstream, camorama,
>> xawtv and guvcview. ?It doesn't work in the one thing I want it for: Skype.
>
>> This leads me to believe that perhaps the only problem is
>> that Skype is not interpreting the output of the camera
>> correctly, and all that perhaps need be done is to force
>> the camera to put out the kind of output Skype thinks it
>> is getting.
>
> In some practical sense at least I think I sort of solved
> the problem, with a lot of googling. ?Having seen the
> idea of gstreamer pipes as used years ago in that
> "gst video stream" thing, ?I thought there should be a sink
> to a virtual webcam, and it turns out there is, something
> called v42loopback.
>
> I built this, loaded the kernel module it makes, getting
> a /dev/video0, then plugged in the camera, getting a /dev/video1,
> and then with some fiddling and guesswork ended up with:
>
> gst-launch v4l2src device=/dev/video1 !
> video/x-raw-yuv,width=640,height=480,framerate=20/1 ! v4l2sink
> device=/dev/video0
>
> and with this, skype produces good results reading from /dev/video0.
>
> I am still not sure what is happening here, perhaps an expert could explain.
> I presume the v4l2src is putting out mjpg format and the second pipe
> element forces it to yuv, which is what skype wants.
>
> Could Alexey or some other person say if there still could
> be some issue with the webcam that could be fixed so this
> would not be necessary? ?Also, could they advise on whether
> this technique is an acceptable solution? ?For example,
> I am a little concerned that the v4l2loopback is a kernel module
> that ?is not distributed and I just causally built it and loaded
> it without knowing much about how wise that is. (Maybe knowing
> nothing about what is available for these gstreamer pipes
> I have missed a more current technique for doing this
> sort of thing). ?Also, this seems to be doing some
> unnecessary work if the webcam can be forced to
> serve up the correct pixel format from the beginning.
>
> Thanks.
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From bug-track at fisher-privat.net  Mon Mar 28 11:36:35 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Mon, 28 Mar 2011 11:36:35 +0200
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTi=pX1AofNtDSZhjKQwV3kvSwoa1j_qw+GTqO9DB@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<1301231263.18238.2.camel@mini>
	<AANLkTi=pX1AofNtDSZhjKQwV3kvSwoa1j_qw+GTqO9DB@mail.gmail.com>
Message-ID: <1301304995.22264.18.camel@mini>

Am Sonntag, den 27.03.2011, 18:24 -0400 schrieb Benson Bear:
> On Sun, Mar 27, 2011 at 9:07 AM, Alexey Fisher
> <bug-track at fisher-privat.net> wrote:
> 
> > please attach output of "lsusb -vd 041e:4088 > lsusb"
> > and please attach a dump of first frame "luvcview -f yuv -s 320x240 -c"
> 
> Thank you for your reply.   Please see attached.
> 
> I have never used luvcview.  It is interesting that
> no matter how I specify the -f option here, it gives
> the same result, and that result is subjectively
> very similar to what skype is showing.  The
> horizontal split in the screen hops up and down.
> I cannot get luvcview to show a normal
> undistorted view at all, counter to all the other
> programs I mentioned in my last message: is
> it perhaps subject to the same problem that
> skype is?
> 
> (Actually, the raw image attachment is too
> large for the list.  In the rare event
> anyone other than Alexey wants to take
> a look at it, let me know.  I can describe
> it a little:  the correct image is cut horizontally
> about 2/3 of the way down and glued
> together with the top part on the bottom,
> and it has horizontal bands of
> distortion throughout.)

According to the raw sample you send, you get only ~3/4 of first frame,
last part of the image is the beginning of second frame.

The reason can be... lost packets by usb controller... or may be camera
send only this parts... or hmm...

Can you please attach dmesg with trace, to enable trace you need:
sudo rmmod uvcvideo && sudo modprobe uvcvideo trace=0xffff

Can you please also try different frame rates with yuv.

Your gstreamer workaround probably grubs jpg stream from the cam.

One other interesting thing is, dwMaxVideoFrameBufferSize for yuv is
correctly reported by the cam: 153600 (320*240*16/8); but reported frame
buffer size for jpeg is mach bigger: 230400 (it should be actually
less).

The answer to your previous question: IMHO, if you can return this cam,
do it. UVC should just work.

Regards,
	Alexey.



From service at cybernet.su  Mon Mar 28 18:26:42 2011
From: service at cybernet.su (=?UTF-8?B?ItCa0LvQuNC10L3RgtGB0LrQuNC5INC+0YLQtNC10LsgXCLQmtC40LHQtQ==?= =?UTF-8?B?0YDQvdC10YJcIiI=?=)
Date: Mon, 28 Mar 2011 20:26:42 +0400
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV" streaming
	web-cams
Message-ID: <4D90B6C2.6020001@cybernet.su>

Hi.

I'm using zoneminder server to record events from usb uvcvideo web-cams.

3 same A4tech PK-836MJ works well with 352x288 yuyv streaming if I
modify /sys/module/uvcvideo/parameters/quirks to 128.

But I unable to attach more webcams. These cams have no mjpeg. Could
anybody help me to apply quirks or recalculate bandwith to use more
webcams. As I understood "no space on left device" message depends on
total bandwith utilisation of my usb hub. There is no other root usb 2.0
hubs on my motherboard. I'm use 2.6.36-gentoo-r8 kernel. I explore
/drivers/media/video/uvc. As I understand, the camera reports that it
can much better resolutiont than 640x480x24bit with 30fps. Is it
possible to manualy decrease bandwith of these cameras? Or maybe it is
possible to patch uvc_video.c?


Any suggessions are welcome.

Hank you in advance.

Vladimir.


From benson.bear at gmail.com  Tue Mar 29 06:57:58 2011
From: benson.bear at gmail.com (Benson Bear)
Date: Tue, 29 Mar 2011 00:57:58 -0400
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTi=VYD+ZUPHc-HNtxW0-Xeq0KA6+MpA7_Ynh-uK4@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<AANLkTikY0zFsOzvYu-S2031Zmp5X3adi94HaxznQ1UYw@mail.gmail.com>
	<AANLkTi=VYD+ZUPHc-HNtxW0-Xeq0KA6+MpA7_Ynh-uK4@mail.gmail.com>
Message-ID: <AANLkTinFV==sVKq7DUFniucO9azkFHhjRx114EpO6i4G@mail.gmail.com>

On Mon, Mar 28, 2011 at 4:26 AM, Paulo Assis <pj.assis at gmail.com> wrote:

> you could also try preloading libv4l, something like:
>
> LD_PRELOAD=/usr/lib/libv4l/v4l2convert.so skype

Thanks.  I tried that with no effect.

Could you explain why you think it  might help? As I
understand it, this is a brand new UVC camera,
and UVC is handled in v4l2, so v4l libraries won't
help.


From benson.bear at gmail.com  Tue Mar 29 06:59:38 2011
From: benson.bear at gmail.com (Benson Bear)
Date: Tue, 29 Mar 2011 00:59:38 -0400
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <1301304995.22264.18.camel@mini>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<1301231263.18238.2.camel@mini>
	<AANLkTi=pX1AofNtDSZhjKQwV3kvSwoa1j_qw+GTqO9DB@mail.gmail.com>
	<1301304995.22264.18.camel@mini>
Message-ID: <AANLkTimJWh6jV95t5-s0gq9JJtHAmPQywMBbbj7TcpkU@mail.gmail.com>

On Mon, Mar 28, 2011 at 5:36 AM, Alexey Fisher
<bug-track at fisher-privat.net> wrote:

> The reason can be... lost packets by usb controller... or may be camera
> send only this parts... or hmm...

You seem to be suggesting some hardware problem or a defect
with the camera?  This seems very unlikely to me: recall the
camera seems to works "out of the box" with cheese, camorama,
xawtv, camstream, guvcview.   Only with skype and in some cases
with luvcview do I get this distorted pattern, which is the same sort
of pattern subjectively that I get when I run the gstreamer pipeline
without the conversion element in it.

I also have now tested in in Windows 7 and it seems to work
fine there "out of the box" as well.

> Can you please attach dmesg with trace, to enable trace you need:
> sudo rmmod uvcvideo && sudo modprobe uvcvideo trace=0xffff

Don't know quite what you mean?  dmesg output during
what?   I attached the dmesg output when the camera is
plugged in, followed by two runs of luvcview (the
first two command lines below). I

Except I edited out huge amounts of these lines
throughout (which are very suggestive of a format
mismatch as well):

"uvcvideo: Dropping payload (out of sync)."

> Can you please also try different frame rates with yuv.

Yes, before, per instruction, I used the default.   But I now
find that lucview gives nice looking results for any frame rate
above 17.

In other words,

 luvcview  -f yuv  -s 320x240  -d /dev/video1 -i 17

does not work, but

 luvcview  -f yuv  -s 320x240  -d /dev/video1 -i 18
 luvcview  -f yuv  -s 320x240  -d /dev/video1 -i 19

etc all do work.


> Your gstreamer workaround probably grubs jpg stream from the cam.

Yes, in more detail I speculate it goes like this:

I have not yet tried to find the basic API for using webcams, but
I assume the following are true:

1) uvc webcams can produce various streaming output formats
in addition to different frame rates and frame sizes.
2) mine can produce at least two, a yuv kind and a jmpg kind
3) it produces jmpg by default (at least v4l2src puts that out)
4) all modern programs either set the format and then
use the correct one, or take the default, detect it, and
do the right thing
5) skype and luvciew, two old programs not modified for
a long time, do not do this successfully in many, or all, cases.
Skype in particular just takes what it gets and assumes it
is in yuv format.

(Although the luvcview runs from the dmesg seem to
find the camera producing yuv format...)

I will fiddle around with this more myself, to see what
happens in dmesg when skype tries to use the camera
for example.

> The answer to your previous question: IMHO, if you can return this cam,
> do it. UVC should just work.

Unfortunately it is difficult to return it, there would
be a restocking fee, and I am not even confident that
I would not have similar issues or worse with other
cameras.  So if I can be assured it is reasonably
okay to do things this way, I will just do them this way
for now.

As I understand the concept "UVC should just
work", that means that if UVC is implemented
totally correctly, then a UVC camera should
"just work".  But we don't know that UVC is
implemented perfectly in Linux right now.  Again,
camera seems to work with almost all programs
available on Linux, and works in Windows too.

Perhaps the camera is doing something
wrong, but it seems like it could be a
simple miscommunication of format
information easily bypassed with a
small hack.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg
Type: application/octet-stream
Size: 29304 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110329/07fba9b3/attachment.obj>

From bug-track at fisher-privat.net  Tue Mar 29 10:03:26 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Tue, 29 Mar 2011 10:03:26 +0200
Subject: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTikudu_y9zFGebWWT+2yD9eMp9PDirrGJTD3tP2Q@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<1301231263.18238.2.camel@mini>
	<AANLkTi=pX1AofNtDSZhjKQwV3kvSwoa1j_qw+GTqO9DB@mail.gmail.com>
	<1301304995.22264.18.camel@mini>
	<AANLkTikudu_y9zFGebWWT+2yD9eMp9PDirrGJTD3tP2Q@mail.gmail.com>
Message-ID: <1301385806.4320.23.camel@mini>

Am Dienstag, den 29.03.2011, 00:48 -0400 schrieb Benson Bear:
> On Mon, Mar 28, 2011 at 5:36 AM, Alexey Fisher
> <bug-track at fisher-privat.net> wrote:
> 
> > The reason can be... lost packets by usb controller... or may be camera
> > send only this parts... or hmm...
> 
> You seem to be suggesting some hardware problem or a defect
> with the camera?  This seems very unlikely to me: recall the
> camera seems to works "out of the box" with cheese, camorama,
> xawtv, camstream, guvcview.   Only with skype and in some cases
> with lucvview do I get this distorted pattern, which is the same sort
> of pattern subjectively that I get when I run the gstreamer pipeline
> without the conversion element in it.
> 
> I also have now tested in in Windows 7 and it seems to work
> fine there "out of the box" as well.
> 
> > Can you please attach dmesg with trace, to enable trace you need:
> > sudo rmmod uvcvideo && sudo modprobe uvcvideo trace=0xffff
> 
> Don't know quite what you mean?  dmesg output during
> what?   I attached the dmesg output when the camera is
> plugged in, followed by two runs of luvcview (the
> first two command lines below). I
> 
> Except I edited out huge amounts of these lines
> throughout (which are very suggestive of a format
> mismatch as well):
> 
> "uvcvideo: Dropping payload (out of sync)."
> 
> > Can you please also try different frame rates with yuv.
> 
> Yes, before, per instruction, I used the default.   But I now
> find that lucview gives nice looking results for any frame rate
> above 17.
> 
> In other words,
> 
>  luvcview  -f yuv  -s 320x240  -d /dev/video1 -i 17
> 
> does not work, but
> 
>  luvcview  -f yuv  -s 320x240  -d /dev/video1 -i 18
>  luvcview  -f yuv  -s 320x240  -d /dev/video1 -i 19
> 
> etc all do work.

Your webcam support(or claim) fallowing framerates 30, 25, 20, 15, 10, 5
(fps). If you set 17fps, luvcview will tell you, that this framerate is
unsupported and fall back to 15fps; if you tray set 18 it will fallback
to 20fps.

"Dropping payload (out of sync)."  mean - camera send more data als
driver is expecting. The same tell this message "Frame complete
(overflow)."

Skype prefer to use 640x480 (in some situations 320x240) at 15fps
uncompressed stream. This is the reason why you hit this bug. Cheese
prefer to use biggest framerate - 30fps, compressed stream. this is the
reason why cheese do not hit this bug.

Driver should know the frame rate to check if some packets are lost or
not.

I assume your webcam just ignore framerate setting and push the maximum
it can.

Try to use UVC_QUIRK_RESTRICT_FRAME_RATE workaround:
sudo rmmod uvcvideo && sudo modprobe uvcvideo quirks=0x200

Regrads,
	Alexey




From pj.assis at gmail.com  Tue Mar 29 10:28:19 2011
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 29 Mar 2011 09:28:19 +0100
Subject: [Linux-uvc-devel] Fwd: Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTi=q94PAGZn+CsYkALb_EoRURV+7DiyziHZ0xJ=m@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<AANLkTikY0zFsOzvYu-S2031Zmp5X3adi94HaxznQ1UYw@mail.gmail.com>
	<AANLkTi=VYD+ZUPHc-HNtxW0-Xeq0KA6+MpA7_Ynh-uK4@mail.gmail.com>
	<AANLkTin2qwUu7b2q-N7Oy+1xkjaWECod+U=6WSh-haKE@mail.gmail.com>
	<AANLkTi=q94PAGZn+CsYkALb_EoRURV+7DiyziHZ0xJ=m@mail.gmail.com>
Message-ID: <AANLkTikvgnKA88-axrgWNwtr8K0hb+w39fnb65bqQHd-@mail.gmail.com>

---------- Forwarded message ----------
From: Paulo Assis <pj.assis at gmail.com>
Date: 2011/3/29
Subject: Re: [Linux-uvc-devel] Creative VF0700 Live! Cam Chat HD works
everywhere, except highly distorted video in Skype
To: Benson Bear <benson.bear at gmail.com>


2011/3/29 Benson Bear <benson.bear at gmail.com>:
> On Mon, Mar 28, 2011 at 4:26 AM, Paulo Assis <pj.assis at gmail.com> wrote:
>
>> you could also try preloading libv4l, something like:
>>
>> LD_PRELOAD=/usr/lib/libv4l/v4l2convert.so skype
>
> Thanks. ?I tried that with no effect.
>
> Could you explain why you think it ?might help? As I
> understand it, this is a brand new UVC camera,
> and UVC is handled in v4l2, so v4l libraries won't
> help.
>

libv4l is not only a v4l library, v4l2convert is also able of
converting compressed formats to uncompressed ones, say MJPG to YUV.
>From what I understand skype only accepts uncompressed formats, and
since some uvc cameras only support MJPG you will need v4l2convert in
this cases.

Regards,
Paulo


From benson.bear at gmail.com  Tue Mar 29 10:54:47 2011
From: benson.bear at gmail.com (Benson Bear)
Date: Tue, 29 Mar 2011 04:54:47 -0400
Subject: [Linux-uvc-devel] Fwd: Creative VF0700 Live! Cam Chat HD works
 everywhere, except highly distorted video in Skype
In-Reply-To: <AANLkTikvgnKA88-axrgWNwtr8K0hb+w39fnb65bqQHd-@mail.gmail.com>
References: <AANLkTinS_D7gDOoqBR9K4s8QNYReNavCnFi-pZh=0jwF@mail.gmail.com>
	<AANLkTikY0zFsOzvYu-S2031Zmp5X3adi94HaxznQ1UYw@mail.gmail.com>
	<AANLkTi=VYD+ZUPHc-HNtxW0-Xeq0KA6+MpA7_Ynh-uK4@mail.gmail.com>
	<AANLkTin2qwUu7b2q-N7Oy+1xkjaWECod+U=6WSh-haKE@mail.gmail.com>
	<AANLkTi=q94PAGZn+CsYkALb_EoRURV+7DiyziHZ0xJ=m@mail.gmail.com>
	<AANLkTikvgnKA88-axrgWNwtr8K0hb+w39fnb65bqQHd-@mail.gmail.com>
Message-ID: <AANLkTimL2QjqqKiE6vLoZ=iVDAvMCjvTkPCYV+4Kcd7x@mail.gmail.com>

On Tue, Mar 29, 2011 at 4:28 AM, Paulo Assis <pj.assis at gmail.com> wrote:

> libv4l is not only a v4l library, v4l2convert is also able of
> converting compressed formats to uncompressed ones, say MJPG to YUV.
> From what I understand skype only accepts uncompressed formats, and
> since some uvc cameras only support MJPG you will need v4l2convert in
> this cases.

Okay thanks, I have no idea what is in the library -- what routines it
might actually
provide that skype already calls, but which when called in the form
provided by the library, would effect such a translation from one
format to another.  (In effect, this is what that "gst fake video"
tried to do, by explicitly replacing in a preloaded library standard
functions that skype already called with new ones that did
the same as the old ones on every input except /dev/video0
and stuff handed back to them that were returned from such
calls.  Very kludgy but apparently it worked)


From bug-track at fisher-privat.net  Tue Mar 29 13:48:02 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Tue, 29 Mar 2011 13:48:02 +0200
Subject: [Linux-uvc-devel] [PATCH] Add support for Creative VF0700 Live! Cam
	Chat HD.
In-Reply-To: <AANLkTimU6K69Ns2XRvGY+uhJg5Qi32udHuC5dO-uDzmp@mail.gmail.com>
References: <AANLkTimU6K69Ns2XRvGY+uhJg5Qi32udHuC5dO-uDzmp@mail.gmail.com>
Message-ID: <1301399282-6430-1-git-send-email-bug-track@fisher-privat.net>

The camera requires the UVC_QUIRK_RESTRICT_FRAME_RATE quirk.

Reported-by: Benson Bear <benson.bear at gmail.com>
Signed-off-by: Alexey Fisher <bug-track at fisher-privat.net>
---
 drivers/media/video/uvc/uvc_driver.c |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

diff --git a/drivers/media/video/uvc/uvc_driver.c b/drivers/media/video/uvc/uvc_driver.c
index 0baa464..f8a1579 100644
--- a/drivers/media/video/uvc/uvc_driver.c
+++ b/drivers/media/video/uvc/uvc_driver.c
@@ -1970,6 +1970,17 @@ MODULE_PARM_DESC(timeout, "Streaming control requests timeout");
  * though they are compliant.
  */
 static struct usb_device_id uvc_ids[] = {
+	/* Creative VF0700 Live! Cam Chat HD.
+	 * Produce more frames als commited,
+	 * so it partially overwrite buffer with new frame */
+	{ .match_flags		= USB_DEVICE_ID_MATCH_DEVICE
+				| USB_DEVICE_ID_MATCH_INT_INFO,
+	  .idVendor		= 0x041e,
+	  .idProduct		= 0x4088,
+	  .bInterfaceClass	= USB_CLASS_VIDEO,
+	  .bInterfaceSubClass	= 1,
+	  .bInterfaceProtocol	= 0,
+	  .driver_info		= UVC_QUIRK_RESTRICT_FRAME_RATE },
 	/* Genius eFace 2025 */
 	{ .match_flags		= USB_DEVICE_ID_MATCH_DEVICE
 				| USB_DEVICE_ID_MATCH_INT_INFO,
-- 
1.7.4.1



From lists at easyb.ch  Sat Mar 26 09:41:33 2011
From: lists at easyb.ch (Ezra Buehler)
Date: Sat, 26 Mar 2011 09:41:33 +0100
Subject: [Linux-uvc-devel] DigiMicro Scale 2.0
In-Reply-To: <863987.49078.qm@web65416.mail.ac4.yahoo.com>
References: <863987.49078.qm@web65416.mail.ac4.yahoo.com>
Message-ID: <44B8C865-B32D-4996-BC9E-C5FAAAFBF8CE@easyb.ch>

Thanx for the answers.

Yes, seem like the chip really is faulty. I now could experience the same behavior on Windows. On the Mac the camera worked fine because Quicktime only supports YUYV as far as I know.

In that case, apologies for bothering the list.

Cheers,
Ezra.

On 26.03.2011, at 00:30, Paul Jurczak wrote:

> I just bought Gear Head WC1300BLK camera with the same VC0342PLVBE controller and VGA sensor. Camera works fine with GUVCViewer. Compared with your camera it lacks FRAME_MJPEG formats, only FRAME_UNCOMPRESSED are present.
> 
> VC0342PLVBE supports MJPEG in high speed mode as pass-trough, only if image sensor is able to provide it. VC0342PLVBE will perform MJPEG compression in full speed mode at CIF and lower resolutions (you can test it by going through USB1.1 hub). So what may have happened here is manufacturing change of image sensor used on your camera. The new one no longer has MJPEG output. These things happen with terrifying frequency when you source the product from China. Each shipment brings something new and exciting.
> 
> Paul.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110326/f7f54232/attachment.html>

From lists at easyb.ch  Mon Mar 28 11:53:50 2011
From: lists at easyb.ch (=?ISO-8859-1?Q?Ezra_B=FChler?=)
Date: Mon, 28 Mar 2011 11:53:50 +0200
Subject: [Linux-uvc-devel] DigiMicro Scale 2.0
Message-ID: <5132673A-9641-4015-97DB-6915BB4B1663@easyb.ch>

Thanx for the answers.

Yes, seem like the cam really is faulty. I now could experience the  
same behavior on Windows. On the Mac the camera worked fine because  
Quicktime only supports YUYV as far as I know.

In that case, apologies for bothering the list.

Cheers,
Ezra.

On 26.03.2011, at 00:30, Paul Jurczak wrote:

> I just bought Gear Head WC1300BLK camera with the same VC0342PLVBE  
> controller and VGA sensor. Camera works fine with GUVCViewer.  
> Compared with your camera it lacks FRAME_MJPEG formats, only  
> FRAME_UNCOMPRESSED are present.
>
> VC0342PLVBE supports MJPEG in high speed mode as pass-trough, only  
> if image sensor is able to provide it. VC0342PLVBE will perform  
> MJPEG compression in full speed mode at CIF and lower resolutions  
> (you can test it by going through USB1.1 hub). So what may have  
> happened here is manufacturing change of image sensor used on your  
> camera. The new one no longer has MJPEG output. These things happen  
> with terrifying frequency when you source the product from China.  
> Each shipment brings something new and exciting.
>
> Paul.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110328/b936e458/attachment.html>

From bug-track at fisher-privat.net  Tue Mar 29 14:59:52 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Tue, 29 Mar 2011 14:59:52 +0200
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
 streaming web-cams
In-Reply-To: <4D90B6C2.6020001@cybernet.su>
References: <4D90B6C2.6020001@cybernet.su>
Message-ID: <1301403592.8083.11.camel@mini>

Hi,

Am Montag, den 28.03.2011, 20:26 +0400 schrieb "?????????? ?????
\"????????\"":
> Hi.
> 
> I'm using zoneminder server to record events from usb uvcvideo web-cams.
> 
> 3 same A4tech PK-836MJ works well with 352x288 yuyv streaming if I
> modify /sys/module/uvcvideo/parameters/quirks to 128.
> 
> But I unable to attach more webcams. These cams have no mjpeg. Could
> anybody help me to apply quirks or recalculate bandwith to use more
> webcams. As I understood "no space on left device" message depends on

i assume it mean your hard drive. uvcvideo do not have this kind of
message.

> total bandwith utilisation of my usb hub. There is no other root usb 2.0
> hubs on my motherboard. I'm use 2.6.36-gentoo-r8 kernel. I explore
> /drivers/media/video/uvc. As I understand, the camera reports that it
> can much better resolutiont than 640x480x24bit with 30fps. Is it
> possible to manualy decrease bandwith of these cameras? Or maybe it is
> possible to patch uvc_video.c?

can you please send more info about this cam. "lsusb -v" will be good
start.

USB 2.0 theoretically can handle 480 Mbit/s. RAW yuyv (depends on
resolution and frame rate) will  need say: 640x480 at 30fps (16bpp) =
140 Mbit/s .  So, theoretically you can use 3,4 cams. DO not forget a
real usb bandwidth and uvc overhead.

If you need more cams, you need reduce resolution and/or frame rate. Not
all webcams support different frame rates.

Regards,
	Alexey.



From shop at open-t.co.uk  Tue Mar 29 22:47:21 2011
From: shop at open-t.co.uk (Sebastian Arcus)
Date: Tue, 29 Mar 2011 21:47:21 +0100
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
 streaming web-cams
In-Reply-To: <1301403592.8083.11.camel@mini>
References: <4D90B6C2.6020001@cybernet.su> <1301403592.8083.11.camel@mini>
Message-ID: <4D924559.6080109@open-t.co.uk>

Hi,

On 03/29/2011 01:59 PM, Alexey Fisher wrote:
</snip>
>>
>> But I unable to attach more webcams. These cams have no mjpeg. Could
>> anybody help me to apply quirks or recalculate bandwith to use more
>> webcams. As I understood "no space on left device" message depends on
>
> i assume it mean your hard drive. uvcvideo do not have this kind of
> message.

I believe "no space left on device" means that there isn't enough usb 
bandwidth for all cameras at selected resolution and framerate. Nothing 
to do with the hard-drive.

>
>> total bandwith utilisation of my usb hub. There is no other root usb 2.0
>> hubs on my motherboard.

You could always install another PCI or PCI-e USB card - which will give 
you another 4-5 USB ports - but more importantly, another USB root hub, 
separate from the one on the motherboard. That's what I did to run 6 
webcams at 640x480 (but using mjpeg stream, not yuyv). That is, of 
course, if you are using some sort of desktop motherboard, with a spare 
PCI or PCI-e slot.

</snip>

<
>
> USB 2.0 theoretically can handle 480 Mbit/s. RAW yuyv (depends on
> resolution and frame rate) will  need say: 640x480 at 30fps (16bpp) =
> 140 Mbit/s .  So, theoretically you can use 3,4 cams. DO not forget a
> real usb bandwidth and uvc overhead.

Don't forget that the 480Mbit/s is the theoretical maximum speed. In 
real life, depending on the quality of the controller and cables, the 
real, achievable, speed can very well be lower.


Sebastian


From pauljurczak at yahoo.com  Tue Mar 29 23:26:05 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Tue, 29 Mar 2011 14:26:05 -0700 (PDT)
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
	streaming web-cams
In-Reply-To: <4D924559.6080109@open-t.co.uk>
Message-ID: <755971.85945.qm@web65407.mail.ac4.yahoo.com>

> </snip>
> 
> You could always install another PCI or PCI-e USB card -
> which will give you another 4-5 USB ports - but more
> importantly, another USB root hub, separate from the one on
> the motherboard. That's what I did to run 6 webcams at
> 640x480 (but using mjpeg stream, not yuyv). That is, of
> course, if you are using some sort of desktop motherboard,
> with a spare PCI or PCI-e slot.
> 
> </snip>

Modern PC motherboard chipsets have dual EHCI controllers, giving you two independent high speed USB buses. Intel started doing it in 2006 or so.

Paul


From maravingian1977 at excite.co.uk  Wed Mar 30 02:34:49 2011
From: maravingian1977 at excite.co.uk (David Smith)
Date: Tue, 29 Mar 2011 17:34:49 -0700
Subject: [Linux-uvc-devel] Philips SPC210NC/00 Compatilbility
Message-ID: <9A91226D1DB74AE1A2DA912A0B32CFFD@mail2world.com>

Hello,

I wish to enquire as to the compatibility of my Webcam, a Philips
SPC210NC/00. 

I have had this webcam for many years but now have only decided that it
might come in useful for 
communications via the internet. Please can you advise.

Many Thanks


Dave 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20110329/b7844644/attachment.html>

From bug-track at fisher-privat.net  Wed Mar 30 08:31:05 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Wed, 30 Mar 2011 08:31:05 +0200
Subject: [Linux-uvc-devel] Philips SPC210NC/00 Compatilbility
In-Reply-To: <9A91226D1DB74AE1A2DA912A0B32CFFD@mail2world.com>
References: <9A91226D1DB74AE1A2DA912A0B32CFFD@mail2world.com>
Message-ID: <1301466665.6107.9.camel@zwerg>

Hi,

Am Dienstag, den 29.03.2011, 17:34 -0700 schrieb David Smith:
> Hello,
> 
> I wish to enquire as to the compatibility of my Webcam, a Philips
> SPC210NC/00. 
> 
> I have had this webcam for many years but now have only decided that it
> might come in useful for 
> communications via the internet. Please can you advise.

Usually you need send result of "lsusb -v", if you ask this kind of
question. But if you will google for "Philips SPC210NC linux" you will
find the answer.

Your cam should be supported by gspca_zc3xx driver, this tread for
uvcvideo driver.

-- 
Regards,
        Alexey



From shop at open-t.co.uk  Wed Mar 30 10:02:23 2011
From: shop at open-t.co.uk (Sebastian Arcus)
Date: Wed, 30 Mar 2011 09:02:23 +0100
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same
 "YUYV"	streaming web-cams
In-Reply-To: <755971.85945.qm@web65407.mail.ac4.yahoo.com>
References: <755971.85945.qm@web65407.mail.ac4.yahoo.com>
Message-ID: <4D92E38F.3090709@open-t.co.uk>



On 03/29/2011 10:26 PM, Paul Jurczak wrote:
>> </snip>
>>
>> You could always install another PCI or PCI-e USB card -
>> which will give you another 4-5 USB ports - but more
>> importantly, another USB root hub, separate from the one on
>> the motherboard. That's what I did to run 6 webcams at
>> 640x480 (but using mjpeg stream, not yuyv). That is, of
>> course, if you are using some sort of desktop motherboard,
>> with a spare PCI or PCI-e slot.
>>
>> </snip>
>
> Modern PC motherboard chipsets have dual EHCI controllers, giving you two independent high speed USB buses. Intel started doing it in 2006 or so.

I don't know about other cases, but I use an Intel D510MO motherboard 
for my project (with an Atom D510 dual core with hyperthreading) - and 
it shows only one Linux Foundation 2.0 root hub. Also my laptop with an 
Intel U2500 processor shows only one Linux Foundation 2.0 root hub. So 
it seems there are still motherboards with only one USB 2.0 root hub.

Sebastian


From pauljurczak at yahoo.com  Wed Mar 30 16:53:03 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Wed, 30 Mar 2011 07:53:03 -0700 (PDT)
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
	streaming web-cams
In-Reply-To: <4D92E38F.3090709@open-t.co.uk>
Message-ID: <413769.12705.qm@web65414.mail.ac4.yahoo.com>

> I don't know about other cases, but I use an Intel D510MO
> motherboard for my project (with an Atom D510 dual core with
> hyperthreading) - and it shows only one Linux Foundation 2.0
> root hub. Also my laptop with an Intel U2500 processor shows
> only one Linux Foundation 2.0 root hub. So it seems there
> are still motherboards with only one USB 2.0 root hub.
> 
> Sebastian

Yes, you are right. I have the same motherboard and it has only one EHCI Host Controller. Dual EHCI didn't trickle down to low end products yet. All of their mainstream desktop motherboards have it though. One caveat, second controller can be disabled and I'm sure their marketing department is fully aware of it.

Paul 



From pauljurczak at yahoo.com  Thu Mar 31 08:13:07 2011
From: pauljurczak at yahoo.com (Paul Jurczak)
Date: Wed, 30 Mar 2011 23:13:07 -0700 (PDT)
Subject: [Linux-uvc-devel] Adding dynamic controls
Message-ID: <150802.29942.qm@web65408.mail.ac4.yahoo.com>

Hello,

I'm trying to add dynamic controls for a camera with undocumented XUs (Gear Head WC1300). lsusb shows presence of XU:
VideoControl Interface Descriptor:
? ? ? ? bLength? ? ? ? ? ? ? ? 28
? ? ? ? bDescriptorType? ? ? ? 36
? ? ? ? bDescriptorSubtype? ? ? 6 (EXTENSION_UNIT)
? ? ? ? bUnitID? ? ? ? ? ? ? ???4
? ? ? ? guidExtensionCode? ? ? ???{e3deaebb-c2ec-4d42-802c-72f2eb3dfb57}
? ? ? ? bNumControl? ? ? ? ? ???8
? ? ? ? bNrPins? ? ? ? ? ? ? ???1
? ? ? ? baSourceID( 0)? ? ? ? ? 1
? ? ? ? bControlSize? ? ? ? ? ? 3
? ? ? ? bmControls( 0)? ? ???0x59
? ? ? ? bmControls( 1)? ? ???0x80
? ? ? ? bmControls( 2)? ? ???0x80
? ? ? ? iExtension? ? ? ? ? ? ? 0 
Documentation of camera processor (Vimicro VC0342) indicates availability of image processing on/off and 8/10-bit raw controls. My plan is a brute force approach to test all possible values of controls.

I'm having some problems with the API. Adding a control with UVCIOC_CTRL_ADD succeeds even with bogus parameters (e.g. wrong GUID). Mapping it with UVCIOC_CTRL_MAP succeeds too. Trying VIDIOC_QUERYCTRL or UVCIOC_CTRL_GET fails with EINVAL. Is it normal that UVCIOC_CTRL_ADD works fine with random GUID? In addition to 0 return value from UVCIOC_CTRL_ADD, trying to add the same control again produces EEXIST error, so it seems that it was accepted by the driver.

Thank you for any hints,
Paul



From service at cybernet.su  Thu Mar 31 13:04:24 2011
From: service at cybernet.su (=?UTF-8?B?ItCa0LvQuNC10L3RgtGB0LrQuNC5INC+0YLQtNC10LsgXCLQmtC40LHQtQ==?= =?UTF-8?B?0YDQvdC10YJcIiI=?=)
Date: Thu, 31 Mar 2011 15:04:24 +0400
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
	streaming web-cams
Message-ID: <4D945FB8.4090302@cybernet.su>

Thanks to all for your answers.

Current disposition:

Gentoo linux: 2.6.36-r8 (kernel uvcvideo driver). I'm testing
2.6.37.5-zen patched kernel (zen-kernel.org). It slightly reduce total
cpu utilisation.
But in embedded usb-bus and uvc drivers I found no changes.
Yesterday I installed ZoneMinder 1.24.3 (trunk).
I'm loading uvcvideo as module with quirks=128. This is allow me to use
4 webcams A4Tech PK-836MJ on each usb-root hub with 352x288 YUYV 30FPS
streaming at the same time.

I'm using asus AT5MN10-I with Atom-330 (dual-core). It has only 1 root
usb2.0 hub (4 embedded usb connectors) and 1 PCI slot with VIA VT6212L
chip - another usb 2.0 root hub with 5 additional usb connectors.

When I attempt to change streaming resolution of any camera in the hub
to 640x480 - other three cameras stop streaming with an error - "no
space on left device". As I understood this error means that whole
bandwith of usb-bus related to the user utilised. 8 streaming cameras
with apache, ffmpeg, zoneminder and other processes itilizin less than
60% of my CPUs. How can I tweak uvcvideo driver or maybe usb-bus to
recalculate the bandwith of my cameras to start working with 640x480
resolution.

This worksation doesn't have X and other non-server environment. I'm
using p/s2 keyboard and ssh. There is no plans to use any other usb-type
devices, web-cams only.

Camera information from luvcview. Zoneminder can work with cameras only
when I use YUYV. When I attempt to change streaming to RGB3 - only one
camera streaming, 3 other stop responding. I think this happens bacause
"quirk" parametr belong only to YUYV stareaming.

Theoretical calculations tells me that 4 cameras with 640x480 YUYV with
25-30fps can stream at the same time...


SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30,
{ pixelformat = 'RGB3', description = 'RGB3' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30,
{ pixelformat = 'BGR3', description = 'BGR3' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30,
{ pixelformat = 'YU12', description = 'YU12' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30,
{ pixelformat = 'YV12', description = 'YV12' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30,



From bug-track at fisher-privat.net  Thu Mar 31 15:03:42 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Thu, 31 Mar 2011 15:03:42 +0200
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
 streaming web-cams
In-Reply-To: <4D945FB8.4090302@cybernet.su>
References: <4D945FB8.4090302@cybernet.su>
Message-ID: <1301576622.6425.17.camel@zwerg>

Am Donnerstag, den 31.03.2011, 15:04 +0400 schrieb "?????????? ?????
\"????????\"":
> Thanks to all for your answers.
> 
> Current disposition:
> 
> Gentoo linux: 2.6.36-r8 (kernel uvcvideo driver). I'm testing
> 2.6.37.5-zen patched kernel (zen-kernel.org). It slightly reduce total
> cpu utilisation.
> But in embedded usb-bus and uvc drivers I found no changes.
> Yesterday I installed ZoneMinder 1.24.3 (trunk).
> I'm loading uvcvideo as module with quirks=128. This is allow me to use
> 4 webcams A4Tech PK-836MJ on each usb-root hub with 352x288 YUYV 30FPS
> streaming at the same time.
> 
> I'm using asus AT5MN10-I with Atom-330 (dual-core). It has only 1 root
> usb2.0 hub (4 embedded usb connectors) and 1 PCI slot with VIA VT6212L
> chip - another usb 2.0 root hub with 5 additional usb connectors.
> 
> When I attempt to change streaming resolution of any camera in the hub
> to 640x480 - other three cameras stop streaming with an error - "no
> space on left device". As I understood this error means that whole
> bandwith of usb-bus related to the user utilised. 8 streaming cameras
> with apache, ffmpeg, zoneminder and other processes itilizin less than
> 60% of my CPUs. How can I tweak uvcvideo driver or maybe usb-bus to
> recalculate the bandwith of my cameras to start working with 640x480
> resolution.
> 
> This worksation doesn't have X and other non-server environment. I'm
> using p/s2 keyboard and ssh. There is no plans to use any other usb-type
> devices, web-cams only.
> 
> Camera information from luvcview. Zoneminder can work with cameras only
> when I use YUYV. When I attempt to change streaming to RGB3 - only one
> camera streaming, 3 other stop responding. I think this happens bacause
> "quirk" parametr belong only to YUYV stareaming.

uvcvideo recalculate all uncompressed pixel formats. 

RGB3 consume more band width than YUYV.

RGB3 and BGR3 use 3 Bytes, also 24 bits.
640 * 480 * 24bit * 30fps / 8 = 26 MByte/s  (max 2 cams)
YUYV - 16 bit
... = 17 MByte/s
YU12, YV12 - 12 bit
... = 13 MByte/s

YU12 or YV12 should be the best solution.

> Theoretical calculations tells me that 4 cameras with 640x480 YUYV with
> 25-30fps can stream at the same time...

YOur calculation is over optemistic. In my previous email i told you
maximal 3.4 cams, the 0.4 do not count. 

Sebastian pointed "Don't forget that the 480Mbit/s is the theoretical
maximum speed". In real live it is less.


> SDL information:
>   Video driver: x11
>   A window manager is available
> Device information:
>   Device path:  /dev/video0
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
>     Time interval between frame: 1/30,
> { discrete: width = 352, height = 288 }
>     Time interval between frame: 1/30,
> { discrete: width = 320, height = 240 }
>     Time interval between frame: 1/30,
> { discrete: width = 176, height = 144 }
>     Time interval between frame: 1/30,
> { discrete: width = 160, height = 120 }
>     Time interval between frame: 1/30,
> { pixelformat = 'RGB3', description = 'RGB3' }
> { discrete: width = 640, height = 480 }
>     Time interval between frame: 1/30,
> { discrete: width = 352, height = 288 }
>     Time interval between frame: 1/30,
> { discrete: width = 320, height = 240 }
>     Time interval between frame: 1/30,
> { discrete: width = 176, height = 144 }
>     Time interval between frame: 1/30,
> { discrete: width = 160, height = 120 }
>     Time interval between frame: 1/30,
> { pixelformat = 'BGR3', description = 'BGR3' }
> { discrete: width = 640, height = 480 }
>     Time interval between frame: 1/30,
> { discrete: width = 352, height = 288 }
>     Time interval between frame: 1/30,
> { discrete: width = 320, height = 240 }
>     Time interval between frame: 1/30,
> { discrete: width = 176, height = 144 }
>     Time interval between frame: 1/30,
> { discrete: width = 160, height = 120 }
>     Time interval between frame: 1/30,
> { pixelformat = 'YU12', description = 'YU12' }
> { discrete: width = 640, height = 480 }
>     Time interval between frame: 1/30,
> { discrete: width = 352, height = 288 }
>     Time interval between frame: 1/30,
> { discrete: width = 320, height = 240 }
>     Time interval between frame: 1/30,
> { discrete: width = 176, height = 144 }
>     Time interval between frame: 1/30,
> { discrete: width = 160, height = 120 }
>     Time interval between frame: 1/30,
> { pixelformat = 'YV12', description = 'YV12' }
> { discrete: width = 640, height = 480 }
>     Time interval between frame: 1/30,
> { discrete: width = 352, height = 288 }
>     Time interval between frame: 1/30,
> { discrete: width = 320, height = 240 }
>     Time interval between frame: 1/30,
> { discrete: width = 176, height = 144 }
>     Time interval between frame: 1/30,
> { discrete: width = 160, height = 120 }
>     Time interval between frame: 1/30,

I do not need this information. I need result of "lsusb -vd xxxx:xxxx",
xxxx - is the usb id of your webcam.


-- 
Regards,
        Alexey



From shop at open-t.co.uk  Thu Mar 31 15:08:36 2011
From: shop at open-t.co.uk (Sebastian Arcus)
Date: Thu, 31 Mar 2011 14:08:36 +0100
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same
 "YUYV"	streaming web-cams
In-Reply-To: <4D945FB8.4090302@cybernet.su>
References: <4D945FB8.4090302@cybernet.su>
Message-ID: <4D947CD4.8060509@open-t.co.uk>



On 03/31/2011 12:04 PM, "?????????? ????? \"????????\"" wrote:
> Thanks to all for your answers.
>
> Current disposition:
>
> Gentoo linux: 2.6.36-r8 (kernel uvcvideo driver). I'm testing
> 2.6.37.5-zen patched kernel (zen-kernel.org). It slightly reduce total
> cpu utilisation.
> But in embedded usb-bus and uvc drivers I found no changes.
> Yesterday I installed ZoneMinder 1.24.3 (trunk).
> I'm loading uvcvideo as module with quirks=128. This is allow me to use
> 4 webcams A4Tech PK-836MJ on each usb-root hub with 352x288 YUYV 30FPS
> streaming at the same time.
>

Have you considered using the mjpeg stream with mjpg_streamer (if the 
cameras support it)? I am currently streaming 6 cameras on an Atom D550 
(more powerful then the 330) - with a pci usb card - at 640x480 - but 
only 5fps (I think I can increase the fps without too much trouble). I 
am also transcoding to mp4 using ffmpeg on the same machine - and I have 
spare processor left - on average using about 50%-60%.

Sebastian


From bug-track at fisher-privat.net  Thu Mar 31 15:18:54 2011
From: bug-track at fisher-privat.net (Alexey Fisher)
Date: Thu, 31 Mar 2011 15:18:54 +0200
Subject: [Linux-uvc-devel] How to 'quirk' more than 3 same "YUYV"
 streaming web-cams
In-Reply-To: <4D947CB2.2070403@cybernet.su>
References: <4D945FB8.4090302@cybernet.su> <1301576622.6425.17.camel@zwerg>
	<4D947CB2.2070403@cybernet.su>
Message-ID: <1301577534.3647.5.camel@mini>

Hi,

ok, i see your webcam support only 30fps, so you can't reduce it. And it
has audio port. I hope, you do not captures sound it... it take some
bandwidth too. I do not see any chance to get more cams.

Am Donnerstag, den 31.03.2011, 17:08 +0400 schrieb "?????????? ?????
\"????????\"":
> 31.03.2011 17:03, Alexey Fisher ?????:
> > lsusb -vd
> Hi Alexey.
> 
> Here it is.
> 
> Bus 001 Device 009: ID 0ac8:c40a Z-Star Microelectronics Corp.
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   idVendor           0x0ac8 Z-Star Microelectronics Corp.
>   idProduct          0xc40a
>   bcdDevice            1.00
>   iManufacturer           1 A4 TECH
>   iProduct                2 A4 TECH USB2.0 PC Camera J
>   iSerial                 0
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          593
>     bNumInterfaces          4
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0x80
>       (Bus Powered)
>     MaxPower              500mA
>     Interface Association:
>       bLength                 8
>       bDescriptorType        11
>       bFirstInterface         0
>       bInterfaceCount         2
>       bFunctionClass         14 Video
>       bFunctionSubClass       3 Video Interface Collection
>       bFunctionProtocol       0
>       iFunction               2 A4 TECH USB2.0 PC Camera J
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      1 Video Control
>       bInterfaceProtocol      0
>       iInterface              2 A4 TECH USB2.0 PC Camera J
>       VideoControl Interface Descriptor:
>         bLength                13
>         bDescriptorType        36
>         bDescriptorSubtype      1 (HEADER)
>         bcdUVC               1.00
>         wTotalLength           79
>         dwClockFrequency       24.000000MHz
>         bInCollection           1
>         baInterfaceNr( 0)       1
>       VideoControl Interface Descriptor:
>         bLength                18
>         bDescriptorType        36
>         bDescriptorSubtype      2 (INPUT_TERMINAL)
>         bTerminalID             1
>         wTerminalType      0x0201 Camera Sensor
>         bAssocTerminal          0
>         iTerminal               0
>         wObjectiveFocalLengthMin      0
>         wObjectiveFocalLengthMax      0
>         wOcularFocalLength            0
>         bControlSize                  3
>         bmControls           0x00040a0e
>           Auto-Exposure Mode
>           Auto-Exposure Priority
>           Exposure Time (Absolute)
>           Zoom (Absolute)
>           PanTilt (Absolute)
>           Privacy
>       VideoControl Interface Descriptor:
>         bLength                11
>         bDescriptorType        36
>         bDescriptorSubtype      5 (PROCESSING_UNIT)
>       Warning: Descriptor too short
>         bUnitID                 2
>         bSourceID               1
>         wMaxMultiplier          0
>         bControlSize            2
>         bmControls     0x0000547f
>           Brightness
>           Contrast
>           Hue
>           Saturation
>           Sharpness
>           Gamma
>           White Balance Temperature
>           Power Line Frequency
>           White Balance Temperature, Auto
>           Digital Multiplier
>         iProcessing             0
>         bmVideoStandards     0x 9
>           None
>           SECAM - 625/50
>       VideoControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>         bTerminalID             3
>         wTerminalType      0x0101 USB Streaming
>         bAssocTerminal          0
>         bSourceID               2
>         iTerminal               0
>       VideoControl Interface Descriptor:
>         bLength                28
>         bDescriptorType        36
>         bDescriptorSubtype      6 (EXTENSION_UNIT)
>         bUnitID                 4
>         guidExtensionCode         {5dc717a9-1941-da11-ae0e-000d56ac7b4c}
>         bNumControl            14
>         bNrPins                 1
>         baSourceID( 0)          1
>         bControlSize            3
>         bmControls( 0)       0xf9
>         bmControls( 1)       0x1f
>         bmControls( 2)       0x80
>         iExtension              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x000a  1x 10 bytes
>         bInterval               5
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       VideoStreaming Interface Descriptor:
>         bLength                            14
>         bDescriptorType                    36
>         bDescriptorSubtype                  1 (INPUT_HEADER)
>         bNumFormats                         1
>         wTotalLength                      223
>         bEndPointAddress                  130
>         bmInfo                              0
>         bTerminalLink                       3
>         bStillCaptureMethod                 2
>         bTriggerSupport                     1
>         bTriggerUsage                       1
>         bControlSize                        1
>         bmaControls( 0)                    27
>       VideoStreaming Interface Descriptor:
>         bLength                            27
>         bDescriptorType                    36
>         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>         bFormatIndex                        1
>         bNumFrameDescriptors                5
>         guidFormat                           
> {59555932-0000-1000-8000-00aa00389b71}
>         bBitsPerPixel                      16
>         bDefaultFrameIndex                  1
>         bAspectRatioX                       0
>         bAspectRatioY                       0
>         bmInterlaceFlags                 0x00
>           Interlaced stream or variable: No
>           Fields per frame: 2 fields
>           Field 1 first: No
>           Field pattern: Field 1 only
>           bCopyProtect                      0
>       VideoStreaming Interface Descriptor:
>         bLength                            30
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         1
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            640
>         wHeight                           480
>         dwMinBitRate                147456000
>         dwMaxBitRate                147456000
>         dwMaxVideoFrameBufferSize      614400
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  1
>         dwFrameInterval( 0)            333333
>       VideoStreaming Interface Descriptor:
>         bLength                            30
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         2
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            352
>         wHeight                           288
>         dwMinBitRate                 48660480
>         dwMaxBitRate                 48660480
>         dwMaxVideoFrameBufferSize      202752
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  1
>         dwFrameInterval( 0)            333333
>       VideoStreaming Interface Descriptor:
>         bLength                            30
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         3
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            320
>         wHeight                           240
>         dwMinBitRate                 36864000
>         dwMaxBitRate                 36864000
>         dwMaxVideoFrameBufferSize      153600
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  1
>         dwFrameInterval( 0)            333333
>       VideoStreaming Interface Descriptor:
>         bLength                            30
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         4
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            176
>         wHeight                           144
>         dwMinBitRate                 12165120
>         dwMaxBitRate                 12165120
>         dwMaxVideoFrameBufferSize       50688
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  1
>         dwFrameInterval( 0)            333333
>       VideoStreaming Interface Descriptor:
>         bLength                            30
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         5
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            160
>         wHeight                           120
>         dwMinBitRate                  9216000
>         dwMaxBitRate                  9216000
>         dwMaxVideoFrameBufferSize       38400
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  1
>         dwFrameInterval( 0)            333333
>       VideoStreaming Interface Descriptor:
>         bLength                            26
>         bDescriptorType                    36
>         bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>         bEndpointAddress                    0
>         bNumImageSizePatterns               5
>         wWidth( 0)                        640
>         wHeight( 0)                       480
>         wWidth( 1)                        352
>         wHeight( 1)                       288
>         wWidth( 2)                        320
>         wHeight( 2)                       240
>         wWidth( 3)                        176
>         wHeight( 3)                       144
>         wWidth( 4)                        160
>         wHeight( 4)                       120
>         bNumCompressionPatterns             5
>       VideoStreaming Interface Descriptor:
>         bLength                             6
>         bDescriptorType                    36
>         bDescriptorSubtype                 13 (COLORFORMAT)
>         bColorPrimaries                     0 (Unspecified)
>         bTransferCharacteristics            0 (Unspecified)
>         bMatrixCoefficients                 0 (Unspecified)
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       1
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0080  1x 128 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       2
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0200  1x 512 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       3
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0400  1x 1024 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       4
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0b00  2x 768 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       5
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0c00  2x 1024 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       6
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1380  3x 896 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       7
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1400  3x 1024 bytes
>         bInterval               1
>     Interface Association:
>       bLength                 8
>       bDescriptorType        11
>       bFirstInterface         2
>       bInterfaceCount         2
>       bFunctionClass          1 Audio
>       bFunctionSubClass       2 Streaming
>       bFunctionProtocol       0
>       iFunction               3 USB2.0 Camera Audio
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        2
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      1 Control Device
>       bInterfaceProtocol      0
>       iInterface              3 USB2.0 Camera Audio
>       AudioControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      1 (HEADER)
>         bcdADC               1.00
>         wTotalLength           39
>         bInCollection           1
>         baInterfaceNr( 0)       3
>       AudioControl Interface Descriptor:
>         bLength                12
>         bDescriptorType        36
>         bDescriptorSubtype      2 (INPUT_TERMINAL)
>         bTerminalID             1
>         wTerminalType      0x0201 Microphone
>         bAssocTerminal          0
>         bNrChannels             1
>         wChannelConfig     0x0000
>         iChannelNames           0
>         iTerminal               0
>       AudioControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      6 (FEATURE_UNIT)
>         bUnitID                 2
>         bSourceID               1
>         bControlSize            1
>         bmaControls( 0)      0x00
>         bmaControls( 1)      0x43
>           Mute Control
>           Volume Control
>           Automatic Gain Control
>         iFeature                0
>       AudioControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>         bTerminalID             3
>         wTerminalType      0x0101 USB Streaming
>         bAssocTerminal          0
>         bSourceID               2
>         iTerminal               0
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        3
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      2 Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        3
>       bAlternateSetting       1
>       bNumEndpoints           1
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      2 Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       AudioStreaming Interface Descriptor:
>         bLength                 7
>         bDescriptorType        36
>         bDescriptorSubtype      1 (AS_GENERAL)
>         bTerminalLink           3
>         bDelay                  1 frames
>         wFormatTag              1 PCM
>       AudioStreaming Interface Descriptor:
>         bLength                35
>         bDescriptorType        36
>         bDescriptorSubtype      2 (FORMAT_TYPE)
>         bFormatType             1 (FORMAT_TYPE_I)
>         bNrChannels             1
>         bSubframeSize           2
>         bBitResolution         16
>         bSamFreqType            9 Discrete
>         tSamFreq[ 0]         8000
>         tSamFreq[ 1]        11025
>         tSamFreq[ 2]        12000
>         tSamFreq[ 3]        16000
>         tSamFreq[ 4]        22050
>         tSamFreq[ 5]        24000
>         tSamFreq[ 6]        32000
>         tSamFreq[ 7]        44100
>         tSamFreq[ 8]        48000
>       Endpoint Descriptor:
>         bLength                 9
>         bDescriptorType         5
>         bEndpointAddress     0x83  EP 3 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0062  1x 98 bytes
>         bInterval               4
>         bRefresh                0
>         bSynchAddress           0
>         AudioControl Endpoint Descriptor:
>           bLength                 7
>           bDescriptorType        37
>           bDescriptorSubtype      1 (EP_GENERAL)
>           bmAttributes         0x01
>             Sampling Frequency
>           bLockDelayUnits         0 Undefined
>           wLockDelay              0 Undefined
> Device Qualifier (for other device speed):
>   bLength                10
>   bDescriptorType         6
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   bNumConfigurations      1
> Device Status:     0x0000
>   (Bus Powered)
> 




