From dionoea at videolan.org  Thu Jan  3 21:32:14 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Thu, 3 Jan 2008 21:32:14 +0100
Subject: [Linux-uvc-devel] Possible bug in while enumerating private controls
Message-ID: <20080103203214.GB23938@via.ecp.fr>

Hello,

I've stumbled upon a problem when hacking the VLC v4l2 driver:

I want to enumerate all the private controls to make them available in
the interface. The code used to enumerate the controls uses the same
logic as Example 1-8 in the spec:
http://v4l2spec.bytesex.org/spec-single/v4l2.html#AEN732

Unfortunately it doesn't work as expected. My webcam provides the
following private controls:
Backlight Compensation -> V4L2_CID_PRIVATE_BASE+0
Power Line Frequency -> V4L2_CID_PRIVATE_BASE+1
Sharpness -> V4L2_CID_PRIVATE_BASE+2
White Balance Temperature Auto -> V4L2_CID_PRIVATE_BASE+12
White Balance Temperature -> V4L2_CID_PRIVATE_BASE+13
Unfortunately, ioctl( fd, VIDIOC_QUERYCTRL, &queryctrl ) on
V4L2_CID_PRIVATE_BASE+3 returns -1, which exits the private controls
enumartion code.

According to footnote [24] in the spec,
"V4L2_CTRL_FLAG_DISABLED was intended for two purposes: Drivers can skip
predefined controls not supported by the hardware (although returning
EINVAL would do as well), or disable predefined and private controls
after hardware detection without the trouble of reordering control
arrays and indices (EINVAL cannot be used to skip private controls
because it would prematurely end the enumeration)."

If I understand that correctly, the ioctl (at least for private
controls), should be succesfull for all the private controls supported
by the uvcvideo drive and set the V4L2_CTRL_FLAG_DISABLED flag if that
control isn't handled by the hardware. This would fix private control
enumartion.

Since I don't know the uvcvideo control code really well I haven't
started patching it yet and would like a confirmation from the gurus
that I'm reading the spec correctly.

Thanks,

-- 
Antoine Cellerier
dionoea


From dionoea at videolan.org  Thu Jan  3 23:08:45 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Thu, 3 Jan 2008 23:08:45 +0100
Subject: [Linux-uvc-devel] Possible bug in while enumerating private
	controls
In-Reply-To: <20080103203214.GB23938@via.ecp.fr>
References: <20080103203214.GB23938@via.ecp.fr>
Message-ID: <20080103220845.GA22364@via.ecp.fr>

On Thu, Jan 03, 2008, Antoine Cellerier wrote:
> Since I don't know the uvcvideo control code really well I haven't
> started patching it yet and would like a confirmation from the gurus
> that I'm reading the spec correctly.

Ok, so here is a patch that "fixes" the problem as far as i can tell.
It involved:
1/ filling in the gaps in uvc_control_mappings so all the controls up to
V4L2_CID_PRIVATE_LAST are present. I looked up the controls in the
USB_Video_Class_1.1.pdf file. The only one which I can't figure out is
V4L2_CID_PANTILT_RESET, I don't understand why it even has a CID.
Of course I don't own a device implementing any of those new controls so
I haven't been able to try them out yet.
2/ adding code to return the control with V4L2_CTRL_FLAG_DISABLED set in
uvc_query_v4l2_ctrl() when uvc_find_control() failed.

Sorry if I got some of the code conventions wrong or something.

-- 
Antoine Cellerier
dionoea
-------------- next part --------------
A non-text attachment was scrubbed...
Name: linux-uvc.flag_disabled.patch
Type: text/x-diff
Size: 2979 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080103/bda25c04/attachment.patch>

From dionoea at videolan.org  Fri Jan  4 00:20:49 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Fri, 4 Jan 2008 00:20:49 +0100
Subject: [Linux-uvc-devel] [PATCH] Fix auto exposure mode control
Message-ID: <20080103232049.GB22364@via.ecp.fr>

This patch fixes the auto exposure mode control so it complies with
4.2.2.1.2. of USB_Video_Class_1.1.pdf .

-- 
Antoine Cellerier
dionoea
-------------- next part --------------
A non-text attachment was scrubbed...
Name: linux-uvc.exposure_auto.patch
Type: text/x-diff
Size: 813 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080104/120f6e9d/attachment.patch>

From dionoea at videolan.org  Fri Jan  4 00:39:02 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Fri, 4 Jan 2008 00:39:02 +0100
Subject: [Linux-uvc-devel] [PATCH] Add auto exposure priority control
Message-ID: <20080103233902.GC22364@via.ecp.fr>

This patch adds the Auto-Exposure Priority Control as defined in
4.2.2.1.3. in USB_Video_Class_1.1.pdf .

-- 
Antoine Cellerier
dionoea
-------------- next part --------------
A non-text attachment was scrubbed...
Name: linux-uvc.auto_exposure_priority.patch
Type: text/x-diff
Size: 1474 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080104/ad4859db/attachment.patch>

From police.federale at gmail.com  Fri Jan  4 10:46:51 2008
From: police.federale at gmail.com (jean-charles klingler)
Date: Fri, 4 Jan 2008 10:46:51 +0100
Subject: [Linux-uvc-devel] SPC1000N PHilips
Message-ID: <2aaf68290801040146l1a9e557j89e15d6620519204@mail.gmail.com>

By adding this on uvc_driver.c

    /* SPC1000N PHILIPS - Unknown vendor */
    { .match_flags        = USB_DEVICE_ID_MATCH_DEVICE
                | USB_DEVICE_ID_MATCH_INT_INFO,
      .idVendor        = 0x0471,
      .idProduct        = 0x0332,
      .bInterfaceClass    = USB_CLASS_VENDOR_SPEC,
      .bInterfaceSubClass    = 1,
      .bInterfaceProtocol    = 0,
    },
it makes my philips SPC1000N getting an output image or video with xawtv.
Is it possible to integer the idvendor and product to the next svn ?

TIA,

Jean-Charles
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080104/ef90447e/attachment.html>

From maurizio.monge at gmail.com  Fri Jan  4 12:38:56 2008
From: maurizio.monge at gmail.com (Maurizio Monge)
Date: Fri, 4 Jan 2008 12:38:56 +0100
Subject: [Linux-uvc-devel] Reording sync'ed audio and video with uvcvideo +
	alsa
Message-ID: <e4c519350801040338x220acaa4s5cfec32804c5d626@mail.gmail.com>

Hi,
please excuse me if this question is not exactly about uvcvideo
development, but was anyone able to record sync'ed audio and video
with some tool?
This is really driving me mad...
transcode for some reason only records at 1fps, mencoder segfaults,
vlc and ffmpeg lose sync, lavrec does not work with v4l2.
Any suggestion? thanks a lot!
Regards.

-- 
Ciao
Maurizio
http://stregatto.wordpress.com

"Well we all shine on
Like the moon and the stars and the sun" (John Lennon)


From moh0815 at freenet.de  Fri Jan  4 19:09:00 2008
From: moh0815 at freenet.de (moh0815 at freenet.de)
Date: Fri, 04 Jan 2008 19:09:00 +0100
Subject: [Linux-uvc-devel] Labtec WebCam Pro (0x046d:0x08a2) uvc support
	possible?
Message-ID: <E1JAqya-0003iL-80@www2.emo.freenet-rz.de>

Hi,
is it possible to add support in linux-uvc for the webcam 'Labtec WebCam Pro' (vendor=0x046d, product=0x08a2)?

I also attached the corresponding output from lsusb (0.72, ubuntu 7.10), maybe this helps...

Thanks in advance & best regards,
moh








-------------- next part --------------
Bus 004 Device 004: ID 046d:08a2 Logitech, Inc. Labtec WebCam Pro
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x046d Logitech, Inc.
  idProduct          0x08a2 Labtec WebCam Pro
  bcdDevice            1.00
  iManufacturer           0 
  iProduct                0 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          336
    bNumInterfaces          3
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xa0
      (Bus Powered)
      Remote Wakeup
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       4
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       5
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       6
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0300  1x 768 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       7
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03ff  1x 1023 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           39
        bInCollection           1
        baInterfaceNr( 0)       2
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            2
        bmaControls( 0)      0x43
        bmaControls( 0)      0x00
          Mute
          Volume
          Automatic Gain
        iFeature                0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]         8000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               1
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x00
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0020  1x 32 bytes
        bInterval               1
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x00
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Status:     0x0000
  (Bus Powered)



From whitesnake78 at mail.com  Sun Jan  6 18:02:23 2008
From: whitesnake78 at mail.com (White Snake)
Date: Sun, 6 Jan 2008 12:02:23 -0500
Subject: [Linux-uvc-devel] ID 064e:a101 Suyin Corp not working
Message-ID: <20080106170223.207011CE7A2@ws1-6.us4.outblaze.com>

 Hello,
I've a hp dv9000 with this webcam "Bus 007 Device 004: ID 064e:a101 Suyin
Corp.".
My kernel is a ubuntu 2.6.22-14-generic with the latest (svn rev 159)
uvcvideo driver.
When I try  "luvcview -L" I get the following:
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
{ discrete: width = 352, height = 288 }
Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
{ discrete: width = 320, height = 240 }
Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
{ discrete: width = 176, height = 144 }
Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
{ discrete: width = 160, height = 120 }
Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,

dmesg says:
[12596.120000] uvcvideo: Found UVC 1.00 device HP Webcam (064e:a101)
[12596.120000] usbcore: registered new interface driver uvcvideo
[12596.120000] USB Video Class driver (v0.1.0)

do you have any suggestions ?

thanks !!!

-- 
Got No Time? Shop Online for Great Gift Ideas!
http://mail.shopping.com/?linkin_id=8033174

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080106/51d4d935/attachment.html>

From tnetter at ifi.uzh.ch  Mon Jan  7 19:09:12 2008
From: tnetter at ifi.uzh.ch (Thomas Netter)
Date: Mon, 07 Jan 2008 19:09:12 +0100
Subject: [Linux-uvc-devel] Debugging UVC + Sanyo Xacti cameras
In-Reply-To: <200712282328.04081.laurent.pinchart@skynet.be>
References: <44759.130.60.75.225.1198150630.squirrel@bela.ifi.unizh.ch>
	<200712282328.04081.laurent.pinchart@skynet.be>
Message-ID: <47826AC8.8070508@ifi.uzh.ch>

Dear Laurent,

Bonne ann?e 2008 et merci pour votre aide.
Here's a follow-up to the Sanyo Xacti uvc problem.
I did the following:

mount -t debugfs none_debugs /sys/kernel/debug/
modprobe usbmon
lsusb
   Bus 007 Device 003: ID 0474:0241 Sanyo Electric Co., Ltd
cat /sys/kernel/debug/usbmon/7t > WebcamStart.dump
   I then switch on the camera by flipping open the screen and put it 
into PC CAMERA mode.
ctrl-c
http://www.ailab.ch/~tnetter/WebcamStart.dump


cat /sys/kernel/debug/usbmon/7t > WebcamClose.dump
  I then switch off the camera by flapping close the screen.
ctrl-c
http://www.ailab.ch/~tnetter/WebcamClose.dump

I then load v4l modules to try out luvcview
modprobe v4l2-common
modprobe videodev
modprobe v4l1-compat
modprobe compat_ioctl32
modprobe video-buf

cat /sys/kernel/debug/usbmon/7t > Webcam.dump
sudo ./luvcview
     Open webcam. Camera image appears on screen.
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
G_FMT -1 0 0  0 0 0 134612088
prepare S_FMT 1 320  240 1196444237 0 0
Closing vd->fd
 Clean Up done Quit
http://www.ailab.ch/~tnetter/Webcam.dump

Let's give it another try:
cat /sys/kernel/debug/usbmon/7t > Webcam2.dump
sudo ./luvcview
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
G_FMT -1 0 0  0 0 0 134612088
prepare S_FMT 1 320  240 1196444237 0 0
Unable to set format: 5.
 Init v4L2 failed !! exit fatal
http://www.ailab.ch/~tnetter/Webcam2.dump

Closing the camera produces no usbmon data.

Many thanks for your help,

-Thomas
 

Laurent Pinchart wrote:
> On Thursday 20 December 2007, Thomas Netter wrote:
>> Hi Laurent and UVC developers,
>>
>> I'm starting to give a close look at luvcview failures when using Xacti
>> cameras with UVC. I'm new to UVC so any help would be greatly appreciated.
>> The problem was initially described by Lars T?uber with the Sanyo HD 1000:
>> http://lists.berlios.de/pipermail/linux-uvc-devel/2007-September/002145.htm
>> l To summarize: luvcview works on the first execute-quit sequence but fails
>> if you try to execute luvcview again. I tried plugging Lars T?uber's code
>> snippet into uvc_driver.c but that had no visible effect.
>>
>> I'm experiencing the same problem with a Xacti C6. I also have access to
>> Xacti C4, HD 1000, and HD 2 cameras to test on other models.
>>
>> Device numbers:
>> Xacti HD 1000: 0474:0238
>> Xacti C6:      0474:0241
>>
>> Below are logs obtained with SnoopyPro-022 while starting AMCap video
>> capture on Windows XP ( http://noeld.com/programs.asp?cat=video )
>> These logs track the following sequence:
>> - Start Amcap
>> - Capture 2 to 3 seconds of 320x240 video
>> - Quit Amcap
>> - Wait a few seconds
>> - Start Amcap
>> - Capture 2 to 3 seconds of 320x240 video
>> - Quit Amcap
>>
>> Log from "video device":
>> Snoopy binary log: http://www.ailab.ch/~tnetter/USBLog12.usblog
>> Text version: http://www.ailab.ch/~tnetter/log12.txt.gz
>>
>> Simultaneous log from "composite device":
>> Snoopy binary log: http://www.ailab.ch/~tnetter/USBLog13.usblog
>> Text version: http://www.ailab.ch/~tnetter/log13.txt.gz
>>
>> Here's what happens in Ubuntu 7.10, linux 2.6.22-14-generic,
>> uvcvideo-r104, luvcview-20070512 (tried both from SVN and from deb
>> package).
>>
>> First attempt works:
>> sudo ./luvcview
>> luvcview version 0.2.1
>> Video driver: x11
>> A window manager is available
>> video /dev/video0
>> Stop asked
>>  Clean Up done Quit
>>
>> Second attempt fails:
>> sudo ./luvcview
>> luvcview version 0.2.1
>> Video driver: x11
>> A window manager is available
>> video /dev/video0
>> Unable to set format: 5.
>>  Init v4L2 failed !! exit fatal
>>
>> If I unplug and replug the camera into the USB port then luvcview
>> works again for one more attempt.
>>
>> Any help / hints are welcome.
>
> Thanks a lot for the logs. Unfortunately I won't be able to look at them 
> before January 7th as I'll be away next week. I'll try to debug the problem 
> when I'll come back.
>
> In the meantime, could you generate a log on Linux that includes the two 
> luvcview runs ? In a nutshell, to use usbmon:
>
> mount -t debug none /sys/kernel/debug
> cat /sys/kernel/debug/usbmon/<busnr>t > usbmon.dump
>
> You will need debugfs and usbmon support in your kernel.
>
> Best regards,
>
> Laurent Pinchart
>
>


From pierpaolo.vittorini at gmail.com  Tue Jan  8 10:54:07 2008
From: pierpaolo.vittorini at gmail.com (Pierpaolo Vittorini)
Date: Tue, 8 Jan 2008 10:54:07 +0100
Subject: [Linux-uvc-devel] Unsupported device
Message-ID: <200801081054.07627.pierpaolo.vittorini@gmail.com>

Attached is the portion of "lsusb -v" output regarding my unsupported chicony 
web cam, shipped with an HP laptop (idProduct = 0xb016).

Regards.
-------------- next part --------------
Bus 002 Device 002: ID 04f2:b016 Chicony Electronics Co., Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04f2 Chicony Electronics Co., Ltd
  idProduct          0xb016
  bcdDevice            6.04
  iManufacturer           2 Chicony Electronics Co., Ltd.
  iProduct                1 HP Webcam
  iSerial                 3 SN0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          543
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
    MaxPower              500mA
    UNRECOGNIZED:  08 0b 00 02 0e 03 00 01
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              1 HP Webcam
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13e8  3x 1000 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1

From marcel at datkan.net  Tue Jan  8 22:01:59 2008
From: marcel at datkan.net (Marcel van Beurden)
Date: Tue, 08 Jan 2008 22:01:59 +0100
Subject: [Linux-uvc-devel] Failed to initialize the device (-5)
Message-ID: <4783E4C7.3050506@datkan.net>

Hi,

I decided to try a new version of the UVC driver with my Logitech 
Quickcam Fusion, revision 159 from SVN. Unfortunately this version does 
not work anymore. When I plug in my cam I get this:

[ 5218.366509] usb 7-6: new high speed USB device using ehci_hcd and 
address 6
[ 5218.675776] usb 7-6: configuration #1 chosen from 1 choice
[ 5218.675962] uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
[ 5219.674869] uvcvideo: Failed to query (135) UVC control 1 (unit 0) : 
-110 (exp. 26).
[ 5220.674950] uvcvideo: Failed to query (129) UVC control 1 (unit 0) : 
-110 (exp. 26).
[ 5220.674958] uvcvideo: Failed to initialize the device (-5).
[ 5221.636108] 6:3:3: cannot set freq 16000 to ep 0x86

Both aMSN and Skype don't detect my cam anymore. Anyone knows what is 
going on? I'm using Ubuntu 7.04, kernel 2.6.20-16 and the latest release 
of aMSN (0.97).

Regards,
Marcel


From andrewfenn at gmail.com  Tue Jan  8 22:29:31 2008
From: andrewfenn at gmail.com (Andrew Fenn)
Date: Wed, 9 Jan 2008 04:29:31 +0700
Subject: [Linux-uvc-devel] QuickCam Pro 9000 "Light Bug"
Message-ID: <b594ca9d0801081329i34be1b2fo34a12fd98675f024@mail.gmail.com>

Hi, I don't know if I am posting this correctly because I am not used to
using mailing lists.

Anyway, I read in last month's archives about a bug discussed on the
Quickcam pro 9000 and about how it freezes in skype (I haven't tested other
programs, any suggestions?). I have the webcam and I wanted to confirm that
it does freeze the camera for some reason unless you hold the camera up to a
light for a few seconds after you start the camera. For some reason it works
fine after that. Sometimes you don't have to do this, if for example your
room is quite bright anyway.

If the camera does freeze I have to unplug the camera and plug it back in to
get it working again. After the camera is frozen the camera's light will
stay on even if I stop using the webcam.

I'm running on svn revision 159 (updated on 8th jan 08).

Thanks,
Andrew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080109/08248dce/attachment.html>

From julian at selectparks.net  Tue Jan  8 23:55:53 2008
From: julian at selectparks.net (Julian Oliver)
Date: Tue, 8 Jan 2008 23:55:53 +0100
Subject: [Linux-uvc-devel] QuickCam Pro 9000 "Light Bug"
In-Reply-To: <b594ca9d0801081329i34be1b2fo34a12fd98675f024@mail.gmail.com>
References: <b594ca9d0801081329i34be1b2fo34a12fd98675f024@mail.gmail.com>
Message-ID: <20080108225553.GF21748@dropworld>

hi Andrew,

..on or around Wed, Jan 09, 2008 at 04:29:31AM +0700, Andrew Fenn said:
> Hi, I don't know if I am posting this correctly because I am not used to
> using mailing lists.
> 
> Anyway, I read in last month's archives about a bug discussed on the
> Quickcam pro 9000 and about how it freezes in skype (I haven't tested other
> programs, any suggestions?). I have the webcam and I wanted to confirm that
> it does freeze the camera for some reason unless you hold the camera up to a
> light for a few seconds after you start the camera. For some reason it works
> fine after that. Sometimes you don't have to do this, if for example your
> room is quite bright anyway.
> 
> If the camera does freeze I have to unplug the camera and plug it back in to
> get it working again. After the camera is frozen the camera's light will
> stay on even if I stop using the webcam.
> 

as a temporary workaround you could try turning off automatic exposure 
using either luvcview or Logitech's own uvcdynctrl (from their libwebcam
distribution). i use the latter:

  ./uvcdynctrl --set "Exposure, Auto" 1

while you don't get the fancy great-picture-in-low-light feature, you do
get much better performance and stability.

cheers,

julian oliver
-- 
http://julianoliver.com
http://selectparks.net
emails containing HTML will not be read.




From moldy86 at gmail.com  Wed Jan  9 02:53:19 2008
From: moldy86 at gmail.com (Kevin A Kricfalusi)
Date: Wed, 09 Jan 2008 03:53:19 +0200
Subject: [Linux-uvc-devel] v4l-dvb-kernel and uvcvideo
Message-ID: <1199843599.28981.9.camel@Ishapen-moble>

If i get the current hg of v4l-dvb-kernel from mcentral is it not going
to be compatible with uvc? Have been using uvcvideo for a fusion webcam
since the beginning and this is the first time i had a problem with it. 

I am running ubuntu 7.04

self compiled v4l-dvb-kernel repository "need it for a tvtuner usb id
issue"

The dmesg after installing the new dvb repository. 

[11635.108000] usb 5-5.1: new high speed USB device using ehci_hcd and
address 27
[11635.392000] usb 5-5.1: configuration #1 chosen from 1 choice
[11635.504000] uvcvideo: disagrees about version of symbol video_devdata
[11635.504000] uvcvideo: Unknown symbol video_devdata
[11635.504000] uvcvideo: disagrees about version of symbol
video_unregister_device
[11635.504000] uvcvideo: Unknown symbol video_unregister_device
[11635.504000] uvcvideo: disagrees about version of symbol
video_device_alloc
[11635.504000] uvcvideo: Unknown symbol video_device_alloc
[11635.504000] uvcvideo: disagrees about version of symbol
video_register_device
[11635.504000] uvcvideo: Unknown symbol video_register_device
[11635.504000] uvcvideo: disagrees about version of symbol
video_device_release
[11635.504000] uvcvideo: Unknown symbol video_device_release

did some googling and 1 other post.. Should i be taking this to the dvb
team for "breaking it" or is it an issue with uvc?


Camera works on my gentoo box though ;)!


thank you,
kevin a kricfalusi



From brandon at ifup.org  Wed Jan  9 10:39:11 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 9 Jan 2008 01:39:11 -0800
Subject: [Linux-uvc-devel] [PATCH] uvcvideo: usb power management
In-Reply-To: <200712151917.34906.laurent.pinchart@skynet.be>
References: <20071213015919.GD530@ifup.org>
	<200712151917.34906.laurent.pinchart@skynet.be>
Message-ID: <20080109093911.GA4208@ifup.org>

On 19:17 Sat 15 Dec 2007, Laurent Pinchart wrote:
> On Thursday 13 December 2007, Brandon Philips wrote:
> > This patch enables usb power management in the UVC driver.  As cameras
> > are built into more and more modern laptops it is important that we get
> > power management for them working.
> 
> Thanks for the patch. Comments inlined.
> >
> > Signed-off-by: Oliver Neukum <oliver at neukum.org>
> > Reviewed-by: Brandon Philips <bphilips at suse.de>
> >
> > ---
> >  uvc_driver.c |    7 ++++++-
> >  uvc_v4l2.c   |    6 ++++++
> >  2 files changed, 12 insertions(+), 1 deletion(-)
> >
> > Index: uvc/uvc_v4l2.c
> > ===================================================================
> > --- uvc.orig/uvc_v4l2.c
> > +++ uvc/uvc_v4l2.c
> > @@ -413,10 +413,15 @@ static int uvc_v4l2_open(struct inode *i
> >  		goto done;
> >  	}
> >
> > +	ret = usb_autopm_get_interface(video->dev->intf);
> > +	if (ret < 0)
> > +		goto done;
> > +
> >  	/* Create the device handle. */
> >  	handle = kzalloc(sizeof *handle, GFP_KERNEL);
> >  	if (handle == NULL) {
> >  		ret = -ENOMEM;
> > +		usb_autopm_put_interface(video->dev->intf);
> >  		goto done;
> >  	}
> >
> > @@ -455,6 +460,7 @@ static int uvc_v4l2_release(struct inode
> >  	kfree(handle);
> >  	file->private_data = NULL;
> >
> > +	usb_autopm_put_interface(video->dev->intf);
> >  	kref_put(&video->dev->kref, uvc_delete);
> >  	return 0;
> >  }
> 
> Is autosuspend interface-based or device-based ? If I understand things 
> correctly, a device won't be autosuspended as long as at least one of its 
> interfaces have a PM counter greater than 0. In that case incrementing the PM 
> counter for the control interface should be enough, there's no need to 
> increment the streaming interface PM counter. Am I right ?

autosuspend won't happen until all interfaces on a device reach 0 (see
usb/core/driver.c: autosuspend_check()).  So, incrementing just the one
interface is fine.

> > Index: uvc/uvc_driver.c
> > ===================================================================
> > --- uvc.orig/uvc_driver.c
> > +++ uvc/uvc_driver.c
> > @@ -678,8 +678,10 @@ static int uvc_parse_streaming(struct uv
> >  			format->frame = frame;
> >  			ret = uvc_parse_format(dev, streaming, format,
> >  				&interval, buffer, buflen);
> > -			if (ret < 0)
> > +			if (ret < 0) {
> > +				kfree(format);
> >  				return ret;
> > +			}
> 
> Are you sure about this ? format is freed in uvc_delete().

Yes, this is unnecessary.  Do you need me to resubmit?

> >  			frame += format->nframes;
> >  			format++;
> > @@ -1605,6 +1607,8 @@ static int uvc_suspend(struct usb_interf
> >  	uvc_trace(UVC_TRACE_SUSPEND, "Suspending interface %u\n",
> >  		intf->cur_altsetting->desc.bInterfaceNumber);
> >
> > +	usb_kill_urb(dev->int_urb);
> > +
> 
> The URB should be resubmitted on resume. I'll take care of this.

Ok.

> >  	/* Controls are cached on the fly so they don't need to be saved. */
> >  	if (intf->cur_altsetting->desc.bInterfaceSubClass == SC_VIDEOCONTROL)
> >  		return 0;
> > @@ -1809,6 +1813,7 @@ struct uvc_driver uvc_driver = {
> >  		.suspend	= uvc_suspend,
> >  		.resume		= uvc_resume,
> >  		.id_table	= uvc_ids,
> > +		.supports_autosuspend = 1,
> >  	},
> >  };
> 
> What about devices that don't implement suspend properly ? Do I need some kind 
> of quirk for them ?

I am not sure how broken devices are handled in this case.  Oliver?

Cheers,

	Brandon


From oliver at neukum.org  Wed Jan  9 11:08:53 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Wed, 9 Jan 2008 11:08:53 +0100
Subject: [Linux-uvc-devel] [PATCH] uvcvideo: usb power management
In-Reply-To: <20080109093911.GA4208@ifup.org>
References: <20071213015919.GD530@ifup.org>
	<200712151917.34906.laurent.pinchart@skynet.be>
	<20080109093911.GA4208@ifup.org>
Message-ID: <200801091108.53996.oliver@neukum.org>

Am Mittwoch, 9. Januar 2008 10:39:11 schrieb Brandon Philips:
> > What about devices that don't implement suspend properly ? Do I need some kind 
> > of quirk for them ?
> 
> I am not sure how broken devices are handled in this case. ?Oliver?

Some of them can handle suspend/resume if they are reset. These need a quirk.
For the others you simply don't activate autosuspend through sysfs. By default
it is off.

In a production system that will have to be done by udev.

	Regards
		Oliver



From brandon at ifup.org  Wed Jan  9 22:55:02 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 9 Jan 2008 13:55:02 -0800
Subject: [Linux-uvc-devel] v4l-dvb-kernel and uvcvideo
In-Reply-To: <1199843599.28981.9.camel@Ishapen-moble>
References: <1199843599.28981.9.camel@Ishapen-moble>
Message-ID: <20080109215502.GB4208@ifup.org>

On 03:53 Wed 09 Jan 2008, Kevin A Kricfalusi wrote:
> If i get the current hg of v4l-dvb-kernel from mcentral is it not going
> to be compatible with uvc? Have been using uvcvideo for a fusion webcam
> since the beginning and this is the first time i had a problem with it. 

The UVC driver would work against the v4l-dvb Mercurial tree; however
you need to compile UVC against the Mercurial tree instead of your
currently installed kernel.

The easiest way to get UVC and bleeding edge v4l-dvb code to work
together is to use this git tree to build a fresh Kernel and install
that:

 git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/v4l-dvb.git

> The dmesg after installing the new dvb repository. 
> 
> [11635.108000] usb 5-5.1: new high speed USB device using ehci_hcd and
> address 27
> [11635.392000] usb 5-5.1: configuration #1 chosen from 1 choice
> [11635.504000] uvcvideo: disagrees about version of symbol video_devdata
> [11635.504000] uvcvideo: Unknown symbol video_devdata
> [11635.504000] uvcvideo: disagrees about version of symbol
> video_unregister_device
> [11635.504000] uvcvideo: Unknown symbol video_unregister_device
> [11635.504000] uvcvideo: disagrees about version of symbol
> video_device_alloc
> [11635.504000] uvcvideo: Unknown symbol video_device_alloc
> [11635.504000] uvcvideo: disagrees about version of symbol
> video_register_device
> [11635.504000] uvcvideo: Unknown symbol video_register_device
> [11635.504000] uvcvideo: disagrees about version of symbol
> video_device_release
> [11635.504000] uvcvideo: Unknown symbol video_device_release
> 
> did some googling and 1 other post.. Should i be taking this to the dvb
> team for "breaking it" or is it an issue with uvc?

As mentioned above, this is not a bug- the UVC driver is being compiled
against your Kernel's V4L (/lib/modules/`uname -r`/build) not the one in
v4l-dvb.

If we can get UVC merged into mainline soon and this will be a
non-issue.  :)

Cheers,

	Brandon


From brandon at ifup.org  Wed Jan  9 23:51:58 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 9 Jan 2008 14:51:58 -0800
Subject: [Linux-uvc-devel] (041e:4063) uvc_trace_param enhanced output
In-Reply-To: <20071229185204.q554lepfwgowskc0@webmail.xmission.com>
References: <20071229001237.82yfahbd0k848cgs@webmail.xmission.com>
	<200712291242.11322.laurent.pinchart@skynet.be>
	<20071229185204.q554lepfwgowskc0@webmail.xmission.com>
Message-ID: <20080109225158.GC4208@ifup.org>

On 18:52 Sat 29 Dec 2007, George Peter Staplin wrote:
> Quoted Laurent Pinchart <laurent.pinchart at skynet.be>:
> 
> > Hi George,
> 
> Hi Laurent,
> 
> > On Saturday 29 December 2007, George Peter Staplin wrote:
> >> This is a followup to my message about the Creative VF0410 Live! Cam
> >> Video IM Pro (041e:4063)
> >>
> >> I changed the uvc_trace_param in uvc_driver.c, so that I could get
> >> more information about what is going on:
> >> unsigned int uvc_trace_param = UVC_TRACE_PROBE | UVC_TRACE_DESCR |
> >> UVC_TRACE_CONTROL | UVC_TRACE_FORMAT | UVC_TRACE_CAPTURE |
> >> UVC_TRACE_CALLS | UVC_TRACE_IOCTL | UVC_TRACE_FRAME;
> >>
> >> Now when I insmod the driver, and plug in the webcam I get:
> >>
> >> [ 2626.794551] usb 5-8: new high speed USB device using ehci_hcd and
> >> address 12
> >> [ 2626.968643] usb 5-8: configuration #1 chosen from 1 choice
> >> [ 2626.969218] uvcvideo: Probing generic UVC device 8
> >> [ 2626.969234] uvcvideo: Found format YUV 4:2:2 (YUYV).
> >> [ 2626.969239] uvcvideo: - 640x480 (30.0 fps)
> >> [ 2626.969243] uvcvideo: - 352x288 (30.0 fps)
> >> [ 2626.969247] uvcvideo: - 320x240 (30.0 fps)
> >> [ 2626.969250] uvcvideo: - 176x144 (30.0 fps)
> >> [ 2626.969253] uvcvideo: - 160x120 (30.0 fps)
> >> [ 2626.969257] uvcvideo: Found format MJPEG.
> >> [ 2626.969261] uvcvideo: - 640x480 (30.0 fps)
> >> [ 2626.969264] uvcvideo: - 352x288 (30.0 fps)
> >> [ 2626.969267] uvcvideo: - 320x240 (30.0 fps)
> >> [ 2626.969271] uvcvideo: - 176x144 (30.0 fps)
> >> [ 2626.969274] uvcvideo: - 160x120 (30.0 fps)
> >> [ 2626.969282] uvcvideo: Found a Status endpoint (addr 83).
> >> [ 2626.969286] uvcvideo: Found UVC 1.00 device VF0410 Live! Cam Video
> >> IM Pro (041e:4063)
> >> [ 2626.969296] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/2 to device 8 entity 3
> >> [ 2626.969302] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/3 to device 8 entity 3
> >> [ 2626.969309] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/6 to device 8 entity 3
> >> [ 2626.969315] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/7 to device 8 entity 3
> >> [ 2626.969322] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/8 to device 8 entity 3
> >> [ 2626.969330] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/9 to device 8 entity 3
> >> [ 2626.969339] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/1 to device 8 entity 3
> >> [ 2626.969348] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/4 to device 8 entity 3
> >> [ 2626.969357] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/5 to device 8 entity 3
> >> [ 2626.969366] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000001/2 to device 8 entity 1
> >> [ 2626.969375] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000001/4 to device 8 entity 1
> >> [ 2626.969386] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/11 to device 8 entity 3
> >> [ 2626.969395] uvcvideo: Added control
> >> 00000000-0000-0000-0000-000000000101/10 to device 8 entity 3
> >> [ 2626.969402] uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <-
> >> PU 3 <- IT 1
> >> [ 2626.969415] uvcvideo: Found a valid video chain (1 -> 2).
> >> [ 2626.975707] uvcvideo: UVC device initialized.
> >> [ 2627.004211] 12:3:1: cannot get freq at ep 0x84
> >>
> >> Any clue as to why 12:3:1 (what is that?) thinks the endpoint 0x84 is
> >> invalid for freq (fetching?)?
> >
> > The message is printed by the usbaudio driver. Don't worry about it. usbaudio
> > has been fixed in 2.6.22 (or 2.6.23, can't remember from the top of my head).
> > It shouldn't break anything anyway.
> 
> Oh, I see.
> 
> > Your webcam seems to be correctly detected and initialised by the   
> > driver. It's
> > now time to try and use it. I suggest luvcview, uvccapture or ucview for a
> > first try. Let me know if it works.
> 
> I see.  lucview works.  thank you :)
> 
> Unfortunately some other tools fail that worked with another webcam.   
> I'm finding that kopete (a KDE instant messaging program) prints this  
> endlessly "read error 19, No such device"
> 
> A tool called camstream also has a similar error 19.
> 
> I just did an svn update to get rid of my local changes.
> 
> I see: uvcvideo: uvc_v4l2_read: not implemented when using camstream  
> and kopete.
> 
> Does that mean that an mmap interface is the only interface supported?  

Yes, UVC only implements the mmap() system call at this time.  

[ I have patches that are mostly ready that convert UVC to use the
videobuf API but there are a few patches and fixes I would like to see
go in to videobuf before I ask Laurent to review my patches. The
videobuf conversion will add read() support. ]

> Or perhaps that these programs are using the old Video4Linux kernel  
> API?

kopete should use v4l2 and it should really have mmap support.  From
glancing at the camstream site it appears to only support v4l1.

Cheers,

	Brandon


From brandon at ifup.org  Thu Jan 10 00:00:34 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 9 Jan 2008 15:00:34 -0800
Subject: [Linux-uvc-devel] Logitech 9000 shows up as a output device.
In-Reply-To: <20071229222337.GA26445@vilya>
References: <86d2b63e0712291329y1435be77r1fc3570da013496d@mail.gmail.com>
	<20071229222337.GA26445@vilya>
Message-ID: <20080109230034.GD4208@ifup.org>

On 23:23 Sat 29 Dec 2007, Richard Atterer wrote:
> On Sat, Dec 29, 2007 at 01:29:48PM -0800, Robert Lewis wrote:
> > However, I notice that the Skype control panel shows the Camera as both 
> > an input and output device.
> 
> I can confirm this. IMHO Skype is just buggy in this respect, because 
> "aplay -l" does not list the camera as an output device, whereas "arecord 
> -l" does correctly list it as an input device.

Yep.  I finally filed a report to Skype today via:
 http://support.skype.com/index.php?_a=tickets&_m=submit

It is a bug that has bothered me for awhile too.

For reference, my report follows.

Cheers,

	Brandon

---

Linux client shows USB microphone as both input and output device

Brandon Philips brandon at ifup.org

I have a webcam with a usb microphone. The microphone works great as a
input device but Skype incorrectly shows the device in the dropdown for
output devices too.

ALSA makes data available about whether a device is in or out:
philips at plankton:~$ aplay -l
**** List of PLAYBACK Hardware Devices ****
card 0: Intel [HDA Intel], device 0: AD198x Analog [AD198x Analog]
Subdevices: 1/1
Subdevice #0: subdevice #0
card 0: Intel [HDA Intel], device 1: AD198x Digital [AD198x Digital]
Subdevices: 1/1
Subdevice #0: subdevice #0

philips at plankton:~$ arecord -l
**** List of CAPTURE Hardware Devices ****
card 0: Intel [HDA Intel], device 0: AD198x Analog [AD198x Analog]
Subdevices: 1/1
Subdevice #0: subdevice #0
card 1: U0x46d0x991 [USB Device 0x46d:0x991], device 0: USB Audio [USB
Audio]
Subdevices: 1/1
Subdevice #0: subdevice #0

If you need more information please feel free to email me:
brandon at ifup.org

Thanks,

Brandon


From brandon at ifup.org  Thu Jan 10 00:12:33 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 9 Jan 2008 15:12:33 -0800
Subject: [Linux-uvc-devel] As Green as they come.
In-Reply-To: <971906.52222.qm@web30502.mail.mud.yahoo.com>
References: <971906.52222.qm@web30502.mail.mud.yahoo.com>
Message-ID: <20080109231233.GA1470@ifup.org>

On 11:58 Mon 31 Dec 2007, Leslie Satenstein wrote:
> I am a (semi-retired) C programmer (15 years of coding), who stopped
> coding a while back. I bought a webcam that does not function well,
> (MS VX1000), and I have another webcam (Creative Live Voice) that is
> still waiting for debugging.

The VX1000 is supported by the gspca driver, so we won't be able to help
you with this device here. See http://mxhaard.free.fr/spca5xx.html

I am fairly sure the Creative Live Voice isn't UVC but could you please
reply with the device USB descriptors ('lsusb -v' with usbutils 0.72 or
newer) to be sure.

Cheers,

	Brandon


From rumi_ml at rtfm.hu  Thu Jan 10 01:38:51 2008
From: rumi_ml at rtfm.hu (RUMI Szabolcs)
Date: Thu, 10 Jan 2008 01:38:51 +0100
Subject: [Linux-uvc-devel] QC Fusion (046d:08c1) inconsistent buggyness?
Message-ID: <20080110013851.2a0490db.rumi_ml@rtfm.hu>

Hello!

I'm blessed with a Logitech QC Fusion (046d:08c1) in my neighborhood...
I get (the usual?) problems on enumeration:

uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)
ehci_hcd 0000:00:1d.7: remove, state 1
usb usb1: USB disconnect, address 1
usb 1-2: USB disconnect, address 2
ehci_hcd 0000:00:1d.7: USB bus 1 deregistered
ACPI: PCI interrupt for device 0000:00:1d.7 disabled
usb 2-2: new full speed USB device using uhci_hcd and address 2
usb 2-2: configuration #1 chosen from 1 choice
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: deregistering interface driver uvcvideo
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)
usbcore: deregistering interface driver uvcvideo
usb 2-2: USB disconnect, address 2
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)
usb 2-2: new full speed USB device using uhci_hcd and address 3
usb 2-2: configuration #1 chosen from 1 choice
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: deregistering interface driver uvcvideo
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)
usbcore: deregistering interface driver uvcvideo
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)
usbcore: deregistering interface driver uvcvideo
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)

As you can see, after several rmmod/modprobe cycles on uvcvideo sooner
or later the camera gets detected. Somewhere I've read that this
problem is restricted to high-speed usb mode so I tried to rmmod ehci-hcd
but apparently it doesn't work any better in full-speed mode than in
high-speed mode.

Anyway, after an occasional correct detection of the camera,
the following behavior can be observed:

- Skype can see /dev/video1 and also provides the USB id
of the camera in the drop down box. After starting camera test,
it takes some seconds for the camera to turn on (it's blue led
comes on) but no picture comes through and CPU usage jumps to
100% permanently while there is no video at all as long as I
do not stop the camera test.

- Camorama simply says it cannot open /dev/video1 and that's it.

- luvcview works seamlessly, as many times I want! Even after the
above applications have failed to open the camera, luvcview always
works even afterwards, both with ehci-hcd enabled and without!

Does luvcview use some hack/fix/kludge that makes it work?
What makes this difference that it works while other apps don't?

Versions:
kernel 2.6.23-gentoo-r5 PREEMPT
linux-uvc-0.1.0_pre157
luvcview-20070512
camorama-0.19
skype-2.0.0.27

Thanks,

Sab


From brandon at ifup.org  Thu Jan 10 02:01:40 2008
From: brandon at ifup.org (Brandon Philips)
Date: Wed, 9 Jan 2008 17:01:40 -0800
Subject: [Linux-uvc-devel] Labtec WebCam Pro (0x046d:0x08a2) uvc	support
	possible?
In-Reply-To: <E1JAqya-0003iL-80@www2.emo.freenet-rz.de>
References: <E1JAqya-0003iL-80@www2.emo.freenet-rz.de>
Message-ID: <20080110010140.GB1470@ifup.org>

On 19:09 Fri 04 Jan 2008, moh0815 at freenet.de wrote:
> Is it possible to add support in linux-uvc for the webcam 'Labtec
> WebCam Pro' (vendor=0x046d, product=0x08a2)?

It does not appear to be possible.  The device appears to use a vendor
specific interface (255 Vendor Specific Class).

However, the spca5xx driver claims to support it:
 http://mxhaard.free.fr/spca5xx.html

Hope that helps.

Cheers,

	Brandon

>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0000  1x 0 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       1
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0080  1x 128 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       2
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x00c0  1x 192 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       3
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0100  1x 256 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       4
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0180  1x 384 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       5
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0200  1x 512 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       6
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0300  1x 768 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       7
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0 
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x03ff  1x 1023 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0008  1x 8 bytes
>         bInterval              10
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      1 Control Device
>       bInterfaceProtocol      0 
>       iInterface              0 
>       AudioControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      1 (HEADER)
>         bcdADC               1.00
>         wTotalLength           39
>         bInCollection           1
>         baInterfaceNr( 0)       2
>       AudioControl Interface Descriptor:
>         bLength                12
>         bDescriptorType        36
>         bDescriptorSubtype      2 (INPUT_TERMINAL)
>         bTerminalID             1
>         wTerminalType      0x0201 Microphone
>         bAssocTerminal          0
>         bNrChannels             1
>         wChannelConfig     0x0000
>         iChannelNames           0 
>         iTerminal               0 
>       AudioControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      6 (FEATURE_UNIT)
>         bUnitID                 2
>         bSourceID               1
>         bControlSize            2
>         bmaControls( 0)      0x43
>         bmaControls( 0)      0x00
>           Mute
>           Volume
>           Automatic Gain
>         iFeature                0 
>       AudioControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>         bTerminalID             3
>         wTerminalType      0x0101 USB Streaming
>         bAssocTerminal          0
>         bSourceID               2
>         iTerminal               0 
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        2
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      2 Streaming
>       bInterfaceProtocol      0 
>       iInterface              0 
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        2
>       bAlternateSetting       1
>       bNumEndpoints           1
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      2 Streaming
>       bInterfaceProtocol      0 
>       iInterface              0 
>       AudioStreaming Interface Descriptor:
>         bLength                 7
>         bDescriptorType        36
>         bDescriptorSubtype      1 (AS_GENERAL)
>         bTerminalLink           3
>         bDelay                  1 frames
>         wFormatTag              1 PCM
>       AudioStreaming Interface Descriptor:
>         bLength                11
>         bDescriptorType        36
>         bDescriptorSubtype      2 (FORMAT_TYPE)
>         bFormatType             1 (FORMAT_TYPE_I)
>         bNrChannels             1
>         bSubframeSize           2
>         bBitResolution         16
>         bSamFreqType            1 Discrete
>         tSamFreq[ 0]         8000
>       Endpoint Descriptor:
>         bLength                 9
>         bDescriptorType         5
>         bEndpointAddress     0x83  EP 3 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               1
>         bRefresh                0
>         bSynchAddress           0
>         AudioControl Endpoint Descriptor:
>           bLength                 7
>           bDescriptorType        37
>           bDescriptorSubtype      1 (EP_GENERAL)
>           bmAttributes         0x00
>           bLockDelayUnits         0 Undefined
>           wLockDelay              0 Undefined
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        2
>       bAlternateSetting       2
>       bNumEndpoints           1
>       bInterfaceClass         1 Audio
>       bInterfaceSubClass      2 Streaming
>       bInterfaceProtocol      0 
>       iInterface              0 
>       AudioStreaming Interface Descriptor:
>         bLength                 7
>         bDescriptorType        36
>         bDescriptorSubtype      1 (AS_GENERAL)
>         bTerminalLink           3
>         bDelay                  1 frames
>         wFormatTag              1 PCM
>       AudioStreaming Interface Descriptor:
>         bLength                11
>         bDescriptorType        36
>         bDescriptorSubtype      2 (FORMAT_TYPE)
>         bFormatType             1 (FORMAT_TYPE_I)
>         bNrChannels             1
>         bSubframeSize           2
>         bBitResolution         16
>         bSamFreqType            1 Discrete
>         tSamFreq[ 0]        16000
>       Endpoint Descriptor:
>         bLength                 9
>         bDescriptorType         5
>         bEndpointAddress     0x83  EP 3 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0020  1x 32 bytes
>         bInterval               1
>         bRefresh                0
>         bSynchAddress           0
>         AudioControl Endpoint Descriptor:
>           bLength                 7
>           bDescriptorType        37
>           bDescriptorSubtype      1 (EP_GENERAL)
>           bmAttributes         0x00
>           bLockDelayUnits         0 Undefined
>           wLockDelay              0 Undefined
> Device Status:     0x0000
>   (Bus Powered)
> 
> 

> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



From expires07 at logular.com  Thu Jan 10 09:58:20 2008
From: expires07 at logular.com (Jason Grant)
Date: Thu, 10 Jan 2008 19:58:20 +1100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
Message-ID: <1199955500.5487.4.camel@speck.logular.com>

Hello,
        
I rarely use the integrated webcam on my laptop (046d:08c6).  It runs
very hot, and I would like to stop it consuming battery power.

It looks like a power-management patch is in the works, however in the
interim, I have read that it is possible to power off the camera by
doing something like:

echo "0"
> /sys/devices/pci0000:00/0000:00:1d.7/usb1/1-5/bConfigurationValue

I have tried this without success (running fedora 8 and latest uvcvideo
from svn).  Is there any truth to this?  If not, I am hoping that
someone here could provide me with info on how to manually turn this
camera off/on.  I will happily write a c program to do this if required.

Thanks for any tips.

Jason.

PS: Source of this rumour was:
http://ubuntuforums.org/archive/index.php/t-502064.html


From oliver at neukum.org  Thu Jan 10 12:57:37 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Thu, 10 Jan 2008 12:57:37 +0100
Subject: [Linux-uvc-devel] [PATCH] uvcvideo: usb power management
In-Reply-To: <20080109093911.GA4208@ifup.org>
References: <20071213015919.GD530@ifup.org>
	<200712151917.34906.laurent.pinchart@skynet.be>
	<20080109093911.GA4208@ifup.org>
Message-ID: <200801101257.38638.oliver@neukum.org>

Am Mittwoch, 9. Januar 2008 10:39:11 schrieb Brandon Philips:
> > > --- uvc.orig/uvc_driver.c
> > > +++ uvc/uvc_driver.c
> > > @@ -678,8 +678,10 @@ static int uvc_parse_streaming(struct uv
> > > ????????????????????format->frame = frame;
> > > ????????????????????ret = uvc_parse_format(dev, streaming, format,
> > > ????????????????????????????&interval, buffer, buflen);
> > > -???????????????????if (ret < 0)
> > > +???????????????????if (ret < 0) {
> > > +???????????????????????????kfree(format);
> > > ????????????????????????????return ret;
> > > +???????????????????}
> > 
> > Are you sure about this ? format is freed in uvc_delete().
> 
> Yes, this is unnecessary. ?Do you need me to resubmit?

How is this supposed to be freed?

uvc_parse_streaming() stores a pointer to format in streaming:

	format = kzalloc(size, GFP_KERNEL);
	if (format == NULL)
		return -ENOMEM;

	frame = (struct uvc_frame*)&format[nformats];
	interval = (__u32*)&frame[nframes];

	streaming->format = format;
	streaming->nformats = nformats;

If uvc_parse_streaming() returns an error to the caller:

				if (uvc_parse_streaming(dev, streaming) < 0) {
					usb_put_intf(intf);
					kfree(streaming);
					continue;
				}

				list_add_tail(&streaming->list, &dev->streaming);

streaming is freed and the addition to the list skipped. So uvc_delete()
walks the list, but it won't find the entry. This looks like a memory leak to me.

	Regards
		Oliver


From arne at unicap-imaging.org  Thu Jan 10 18:44:23 2008
From: arne at unicap-imaging.org (Arne Caspari)
Date: Thu, 10 Jan 2008 18:44:23 +0100
Subject: [Linux-uvc-devel] Better support for FRAME_BASED formats
Message-ID: <1199987063.17172.6.camel@localhost>

Hi List, ( hi Laurent! ), 

I want to put this little patch to discussion. If a FRAME_BASED ( or
UNCOMPRESSED ) format is not known to the driver, this patch sets the
fcc field of the uvc_format structure to the first 4 bytes of the GUID.
This assertion is true for all GUIDs of YUV formats I know. 

Currently the fcc field is set to 0 which means that this format can not
be set by VIDIOC_S_FMT since this ioctl selects the format based on the
fcc - ie. setting fcc to 0 renders the format completely unusable. 

The only other approach to make unknown formats would be to add some
UVCIOC_FMT_ADD ioctl, similar to UVCIOC_CTRL_ADD but this would be more
complicated :-/


 /Arne
-------------- next part --------------
A non-text attachment was scrubbed...
Name: frame_based_fcc.patch
Type: text/x-patch
Size: 608 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080110/15daf88d/attachment.bin>

From laurent.pinchart at skynet.be  Thu Jan 10 20:30:32 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 20:30:32 +0100
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <5f52f6d70712290413s5ce515f2q88924e604fd73b5d@mail.gmail.com>
References: <200712281340.17571.herton@mandriva.com.br>
	<200712290026.53860.laurent.pinchart@skynet.be>
	<5f52f6d70712290413s5ce515f2q88924e604fd73b5d@mail.gmail.com>
Message-ID: <200801102030.32842.laurent.pinchart@skynet.be>

Hi Claudio,

On Saturday 29 December 2007, Claudio Matsuoka wrote:
> On Dec 28, 2007 9:26 PM, Laurent Pinchart <laurent.pinchart at skynet.be> 
wrote:
> > I have a pending patch that passes the uvc_video_device structure to URB
> > completion callbacks instead of the uvc_video_queue structure. This
> > should take care of the problem you solved by setting dev->udev->quirks.
>
> Could you send me that patch so I can rework the Syntek quirk to use it?

I've just committed it to SVN.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 20:49:59 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 20:49:59 +0100
Subject: [Linux-uvc-devel] about number of packets inside URB..
In-Reply-To: <a81f87bb0712301223w2ab5fc90u4324b429de587d89@mail.gmail.com>
References: <a81f87bb0712211823ofe3740bmb374a5d6e4d72dab@mail.gmail.com>
	<200712282342.59542.laurent.pinchart@skynet.be>
	<a81f87bb0712301223w2ab5fc90u4324b429de587d89@mail.gmail.com>
Message-ID: <200801102049.59888.laurent.pinchart@skynet.be>

Hi Brian,

On Sunday 30 December 2007, Brian Pin wrote:
> Hi Laurent,
> Can I say that one URB corresponds to one frame only?

No, a frame can be split across multiple URBs.

> Because I saw the driver send out multiple URB at a time,
>
>  for (i = 0; i < UVC_URBS; ++i) {
>   if ((ret = usb_submit_urb(video->urb[i], GFP_KERNEL)) < 0) {
>
> and this goes to the following question that
> what if a URB is not capable of containing one frame...

The driver will copy data from multiple URBs to the video frame buffer.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 20:57:46 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 20:57:46 +0100
Subject: [Linux-uvc-devel] UVC supported device report
In-Reply-To: <1198976559.4528.19.camel@maxilab.localdomain>
References: <1198976559.4528.19.camel@maxilab.localdomain>
Message-ID: <200801102057.46990.laurent.pinchart@skynet.be>

Hi Vaclav,

On Sunday 30 December 2007, Vaclav Bartacek wrote:
> Hello,
>
> since I did not found my Apple iSight mentioned in your list of tested
> UVC cameras (http://linux-uvc.berlios.de), I am sending it to you:
>
> Device Id: 05ac:8502
> Manufacturer: Apple
> Name: iSight internal camera - MacBook Pro 15"
>
> Kernel: x86_64
>         2.6.23.9 + mactel patches
>           (+ nvidia driver (64bit), + alsa, + madwifi)
>
> # sudo svn co  svn://svn.berlios.de/linux-uvc/linux-uvc/trunk linux-uvc
> ...
> Checked out revision 159.
>
> # cd linux-uvc
> # make && make install
> # modprobe uvcvideo
>
> syslog:
> Dec 30 01:33:29 maxilab kernel: Linux video capture interface: v2.00
> Dec 30 01:33:29 maxilab kernel: uvcvideo: Found UVC 1.00 device Built-in
> iSight (05ac:8502)
> Dec 30 01:33:29 maxilab kernel: usbcore: registered new interface driver
> uvcvideo
> Dec 30 01:33:29 maxilab kernel: USB Video Class driver (v0.1.0)
>
> $ ekiga
> --> Preferences -> Video Devices --> Video plugin = V4L2 --> works !
>
> Thanks a lot !

Thanks for the report. I added the webcam to the supported devices list on the 
website.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 21:06:55 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:06:55 +0100
Subject: [Linux-uvc-devel] [PATCH] Fix auto exposure mode control
In-Reply-To: <20080103232049.GB22364@via.ecp.fr>
References: <20080103232049.GB22364@via.ecp.fr>
Message-ID: <200801102106.55131.laurent.pinchart@skynet.be>

On Friday 04 January 2008, Antoine Cellerier wrote:
> This patch fixes the auto exposure mode control so it complies with
> 4.2.2.1.2. of USB_Video_Class_1.1.pdf .

Thanks. Applied.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Thu Jan 10 21:10:52 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:10:52 +0100
Subject: [Linux-uvc-devel] [PATCH] Add auto exposure priority control
In-Reply-To: <20080103233902.GC22364@via.ecp.fr>
References: <20080103233902.GC22364@via.ecp.fr>
Message-ID: <200801102110.52830.laurent.pinchart@skynet.be>

On Friday 04 January 2008, Antoine Cellerier wrote:
> This patch adds the Auto-Exposure Priority Control as defined in
> 4.2.2.1.3. in USB_Video_Class_1.1.pdf .

Thanks. Applied.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 21:13:03 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:13:03 +0100
Subject: [Linux-uvc-devel] SPC1000N PHilips
In-Reply-To: <2aaf68290801040146l1a9e557j89e15d6620519204@mail.gmail.com>
References: <2aaf68290801040146l1a9e557j89e15d6620519204@mail.gmail.com>
Message-ID: <200801102113.03302.laurent.pinchart@skynet.be>

Hi Jean-Charles,

On Friday 04 January 2008, jean-charles klingler wrote:
> By adding this on uvc_driver.c
>
>     /* SPC1000N PHILIPS - Unknown vendor */
>     { .match_flags        = USB_DEVICE_ID_MATCH_DEVICE
>
>                 | USB_DEVICE_ID_MATCH_INT_INFO,
>
>       .idVendor        = 0x0471,
>       .idProduct        = 0x0332,
>       .bInterfaceClass    = USB_CLASS_VENDOR_SPEC,
>       .bInterfaceSubClass    = 1,
>       .bInterfaceProtocol    = 0,
>     },
> it makes my philips SPC1000N getting an output image or video with xawtv.
> Is it possible to integer the idvendor and product to the next svn ?

A user reported success with his SPC1000 without the above patch. Could you 
please make sure it's really needed ? If so, please send me the output of 
lsusb -v (using usbutils 0.72 or newer).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 21:16:07 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:16:07 +0100
Subject: [Linux-uvc-devel] ID 064e:a101 Suyin Corp not working
In-Reply-To: <20080106170223.207011CE7A2@ws1-6.us4.outblaze.com>
References: <20080106170223.207011CE7A2@ws1-6.us4.outblaze.com>
Message-ID: <200801102116.07903.laurent.pinchart@skynet.be>

Hi,

On Sunday 06 January 2008, White Snake wrote:
>  Hello,
> I've a hp dv9000 with this webcam "Bus 007 Device 004: ID 064e:a101 Suyin
> Corp.".
> My kernel is a ubuntu 2.6.22-14-generic with the latest (svn rev 159)
> uvcvideo driver.
> When I try  "luvcview -L" I get the following:
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> /dev/video0 does not support read i/o
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
> Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
> { discrete: width = 352, height = 288 }
> Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
> { discrete: width = 320, height = 240 }
> Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
> { discrete: width = 176, height = 144 }
> Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
> { discrete: width = 160, height = 120 }
> Time interval between frame: 1/24, 1/12, 1/8, 1/6, 1/4, 1/1,
>
> dmesg says:
> [12596.120000] uvcvideo: Found UVC 1.00 device HP Webcam (064e:a101)
> [12596.120000] usbcore: registered new interface driver uvcvideo
> [12596.120000] USB Video Class driver (v0.1.0)
>
> do you have any suggestions ?

I don't see any error. Running

luvcview -f yuv

should display the video stream.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 21:19:29 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:19:29 +0100
Subject: [Linux-uvc-devel] Unsupported device
In-Reply-To: <200801081054.07627.pierpaolo.vittorini@gmail.com>
References: <200801081054.07627.pierpaolo.vittorini@gmail.com>
Message-ID: <200801102119.29558.laurent.pinchart@skynet.be>

Hi Pierpaolo,

On Tuesday 08 January 2008, Pierpaolo Vittorini wrote:
> Attached is the portion of "lsusb -v" output regarding my unsupported
> chicony web cam, shipped with an HP laptop (idProduct = 0xb016).

Could you please upgrade to usbutils 0.72 and then resend me the lsusb 
output ?

Does the webcam work with the Linux UVC driver ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 21:28:14 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:28:14 +0100
Subject: [Linux-uvc-devel] Failed to initialize the device (-5)
In-Reply-To: <4783E4C7.3050506@datkan.net>
References: <4783E4C7.3050506@datkan.net>
Message-ID: <200801102128.14340.laurent.pinchart@skynet.be>

Hi Marcel,

On Tuesday 08 January 2008, Marcel van Beurden wrote:
> Hi,
>
> I decided to try a new version of the UVC driver with my Logitech
> Quickcam Fusion, revision 159 from SVN. Unfortunately this version does
> not work anymore. When I plug in my cam I get this:
>
> [ 5218.366509] usb 7-6: new high speed USB device using ehci_hcd and
> address 6
> [ 5218.675776] usb 7-6: configuration #1 chosen from 1 choice
> [ 5218.675962] uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> [ 5219.674869] uvcvideo: Failed to query (135) UVC control 1 (unit 0) :
> -110 (exp. 26).
> [ 5220.674950] uvcvideo: Failed to query (129) UVC control 1 (unit 0) :
> -110 (exp. 26).
> [ 5220.674958] uvcvideo: Failed to initialize the device (-5).
> [ 5221.636108] 6:3:3: cannot set freq 16000 to ep 0x86
>
> Both aMSN and Skype don't detect my cam anymore. Anyone knows what is
> going on? I'm using Ubuntu 7.04, kernel 2.6.20-16 and the latest release
> of aMSN (0.97).

Looks like the dreaded Logitech firmware bug. Have you upgraded your kernel 
recently ? Even small modifications that could influence the USB timings 
might turn a working camera into an unusable device (or sometimes the other 
way around).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 21:34:13 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 21:34:13 +0100
Subject: [Linux-uvc-devel] QC Fusion (046d:08c1) inconsistent buggyness?
In-Reply-To: <20080110013851.2a0490db.rumi_ml@rtfm.hu>
References: <20080110013851.2a0490db.rumi_ml@rtfm.hu>
Message-ID: <200801102134.13646.laurent.pinchart@skynet.be>

Hi Sab,

On Thursday 10 January 2008, RUMI Szabolcs wrote:
> Hello!
>
> I'm blessed with a Logitech QC Fusion (046d:08c1) in my neighborhood...
> I get (the usual?) problems on enumeration:
>
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)
> ehci_hcd 0000:00:1d.7: remove, state 1
> usb usb1: USB disconnect, address 1
> usb 1-2: USB disconnect, address 2
> ehci_hcd 0000:00:1d.7: USB bus 1 deregistered
> ACPI: PCI interrupt for device 0000:00:1d.7 disabled
> usb 2-2: new full speed USB device using uhci_hcd and address 2
> usb 2-2: configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: deregistering interface driver uvcvideo
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)
> usbcore: deregistering interface driver uvcvideo
> usb 2-2: USB disconnect, address 2
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)
> usb 2-2: new full speed USB device using uhci_hcd and address 3
> usb 2-2: configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: deregistering interface driver uvcvideo
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)
> usbcore: deregistering interface driver uvcvideo
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)
> usbcore: deregistering interface driver uvcvideo
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)
>
> As you can see, after several rmmod/modprobe cycles on uvcvideo sooner
> or later the camera gets detected. Somewhere I've read that this
> problem is restricted to high-speed usb mode so I tried to rmmod ehci-hcd
> but apparently it doesn't work any better in full-speed mode than in
> high-speed mode.
>
> Anyway, after an occasional correct detection of the camera,
> the following behavior can be observed:
>
> - Skype can see /dev/video1 and also provides the USB id
> of the camera in the drop down box. After starting camera test,
> it takes some seconds for the camera to turn on (it's blue led
> comes on) but no picture comes through and CPU usage jumps to
> 100% permanently while there is no video at all as long as I
> do not stop the camera test.
>
> - Camorama simply says it cannot open /dev/video1 and that's it.

That's pretty normal, as camorama supports v4l1 only.

> - luvcview works seamlessly, as many times I want! Even after the
> above applications have failed to open the camera, luvcview always
> works even afterwards, both with ehci-hcd enabled and without!
>
> Does luvcview use some hack/fix/kludge that makes it work?

Not that I know of.

> What makes this difference that it works while other apps don't?

Skype might be buggy ;-) I know that Skype tries to change the frame rate 
while streaming. The driver currently allows that but doesn't handle the 
request properly. It might make the webcam crash.

I plan to fix it, probably by disallowing frame rate changes while streaming.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 22:03:15 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 22:03:15 +0100
Subject: [Linux-uvc-devel] BUG with uvcvideo SVN and 2.6.23.11
In-Reply-To: <613695.87540.qm@web52907.mail.re2.yahoo.com>
References: <613695.87540.qm@web52907.mail.re2.yahoo.com>
Message-ID: <200801102203.15617.laurent.pinchart@skynet.be>

Hi Chris,

On Sunday 23 December 2007, Chris Rankin wrote:
> Hi,
>
> I am running the uvcvideo module from subversion with Linux 2.6.23.11, and
> I have just found this BUG in my message log:
>
> usb 4-3: new high speed USB device using ehci_hcd and address 4
> usb 4-3: configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:0992)
> BUG: atomic counter underflow at:
[snip]

This should be fixed in the latest SVN revision. Could you please check ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 22:16:47 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 22:16:47 +0100
Subject: [Linux-uvc-devel] supported device Philips SPC1000NC
In-Reply-To: <200712291317.19829.jice@free.fr>
References: <200712272349.18294.jice@free.fr>
	<200712282355.48719.laurent.pinchart@skynet.be>
	<200712291317.19829.jice@free.fr>
Message-ID: <200801102216.47839.laurent.pinchart@skynet.be>

Hi Jean-Christophe,

On Saturday 29 December 2007, Jean-Christophe Jice Cardot wrote:
> Le vendredi 28 d?cembre 2007, Laurent Pinchart a ?crit :
> > That doesn't look good. Do the 'USB disconnect' messages appear on their
> > own when you're not doing anything, or are they printed only when you try
> > to use the webcam ? Please try to plug the camera in another port and see
> > if it helps.
>
> here it is. after the ">", the lines from dmesg.
>
> rmmod uvcvideo (ro remove the old version)
>
> >usbcore: deregistering driver uvcvideo
>
> insmod ./uvcvideo.ko
>
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >usbcore: registered new driver uvcvideo
> >USB Video Class driver (v0.1.0)
>
> press the camera button
>
> >uvcvideo: Button event (1).
> >uvcvideo: Button event (0).
>
> [fred at jice luvcview-20070512]$ ./luvcview -d /dev/video1
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video1
>
> Stop asked
>  Clean Up done Quit
>
> >nothing in dmesg
>
> [fred at jice luvcview-20070512]$ ./luvcview -d /dev/video1
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video1
> Unable to dequeue buffer (5).
> Error grabbing
>  Clean Up done Quit
>
> >usb 1-1: USB disconnect, address 2
> >usb 1-1: new high speed USB device using ehci_hcd and address 3
> >usb 1-1: configuration #1 chosen from 1 choice
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >3:3:1: cannot get freq at ep 0x84
>
> also, /dev/video1 has been recreated:
>
> it was:
> >crw-rw---- 1 fred video 81, 1 2007-12-29 12:12 /dev/v4l/video1
>
> and is now, after the failure:
> >crw-rw---- 1 fred video 81, 1 2007-12-29 12:25 /dev/v4l/video1
>
> note the change in the time.
>
> again a failure of luvcview:
> >usb 1-1: USB disconnect, address 3
> >usb 1-1: new high speed USB device using ehci_hcd and address 4
> >usb 1-1: configuration #1 chosen from 1 choice
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >4:3:1: cannot get freq at ep 0x84
>
> then another:
> >usb 1-1: USB disconnect, address 4
> >usb 1-1: new high speed USB device using ehci_hcd and address 5
> >usb 1-1: configuration #1 chosen from 1 choice
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >5:3:1: cannot get freq at ep 0x84
>
> then it works (and nothing in dmesg).
>
> there is no logical suite in the failures and successes (like 2 failures
> then one success).
>
> so let's try to change the plug:
>
> unplug:
> >usb 1-1: USB disconnect, address 13
>
> plug:
> >usb 1-3: new high speed USB device using ehci_hcd and address 14
> >usb 1-3: configuration #1 chosen from 1 choice
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >14:3:1: cannot get freq at ep 0x84
>
> again luvcview fails then works then fails then fails...
>
> >usb 1-3: USB disconnect, address 14
> >usb 1-3: new high speed USB device using ehci_hcd and address 15
> >usb 1-3: configuration #1 chosen from 1 choice
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >15:3:1: cannot get freq at ep 0x84
>
> ok, this was my only usb2 controller, so let's try a USB1 controller:
> >usb 1-3: USB disconnect, address 15
> >usb 5-2: new full speed USB device using uhci_hcd and address 4
> >usb 5-2: not running at top speed; connect to a high speed hub
> >usb 5-2: configuration #1 chosen from 1 choice
> >uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> >4:3:1: cannot get freq at ep 0x84
>
> surprise! luvcview always work properly! and with the same fps (12).
>
> so now I've a work-around, but still I'd like to help it work on the USB2
> controller if it suits you, because maybe others will have the same
> problem...

It looks like the camera crashes. I guess the timing is somehow wrong. It's 
very difficult to find a good workaround without knowing exactly why the 
camera crashes, and that's difficult to know without access to the firmware's 
source code.

If you already have a workaround, and as long as nobody else experiences the 
issue, I'd leave it as is.

> bye and have a good "f?tes de fin d'ann?e" ! (you're speaking french,
> Laurent, aren't you?)

Thanks. J'esp?re que tu as pass? de bonnes f?tes :-)

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 22:36:04 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 22:36:04 +0100
Subject: [Linux-uvc-devel] Possible bug in while enumerating private
	controls
In-Reply-To: <20080103203214.GB23938@via.ecp.fr>
References: <20080103203214.GB23938@via.ecp.fr>
Message-ID: <200801102236.04374.laurent.pinchart@skynet.be>

Hi Antoine,

On Thursday 03 January 2008, Antoine Cellerier wrote:
> Hello,
>
> I've stumbled upon a problem when hacking the VLC v4l2 driver:
>
> I want to enumerate all the private controls to make them available in
> the interface. The code used to enumerate the controls uses the same
> logic as Example 1-8 in the spec:
> http://v4l2spec.bytesex.org/spec-single/v4l2.html#AEN732
>
> Unfortunately it doesn't work as expected. My webcam provides the
> following private controls:
> Backlight Compensation -> V4L2_CID_PRIVATE_BASE+0
> Power Line Frequency -> V4L2_CID_PRIVATE_BASE+1
> Sharpness -> V4L2_CID_PRIVATE_BASE+2
> White Balance Temperature Auto -> V4L2_CID_PRIVATE_BASE+12
> White Balance Temperature -> V4L2_CID_PRIVATE_BASE+13
> Unfortunately, ioctl( fd, VIDIOC_QUERYCTRL, &queryctrl ) on
> V4L2_CID_PRIVATE_BASE+3 returns -1, which exits the private controls
> enumartion code.
>
> According to footnote [24] in the spec,
> "V4L2_CTRL_FLAG_DISABLED was intended for two purposes: Drivers can skip
> predefined controls not supported by the hardware (although returning
> EINVAL would do as well), or disable predefined and private controls
> after hardware detection without the trouble of reordering control
> arrays and indices (EINVAL cannot be used to skip private controls
> because it would prematurely end the enumeration)."
>
> If I understand that correctly, the ioctl (at least for private
> controls), should be succesfull for all the private controls supported
> by the uvcvideo drive and set the V4L2_CTRL_FLAG_DISABLED flag if that
> control isn't handled by the hardware. This would fix private control
> enumartion.

Yes and no. Drivers can use V4L2_CTRL_FLAG_DISABLED but are not required to do 
so.

For most drivers this isn't a problem. The driver support only a limited 
number of controls, and setting V4L2_CTRL_FLAG_DISABLED when a particular 
hardware doesn't support a given control is easy.

The UVC driver is different. The UVC spec allows devices to define new 
controls. The total number of controls could be huge, so using 
V4L2_CTRL_FLAG_DISABLED is not practical. For this reason, you should use the 
enumeration method described in 
http://v4l2spec.bytesex.org/spec-single/v4l2.html#AEN794

> Since I don't know the uvcvideo control code really well I haven't
> started patching it yet and would like a confirmation from the gurus
> that I'm reading the spec correctly.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 23:04:48 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 23:04:48 +0100
Subject: [Linux-uvc-devel] [PATCH] uvcvideo: usb power management
In-Reply-To: <200801101257.38638.oliver@neukum.org>
References: <20071213015919.GD530@ifup.org> <20080109093911.GA4208@ifup.org>
	<200801101257.38638.oliver@neukum.org>
Message-ID: <200801102304.49084.laurent.pinchart@skynet.be>

Hi Oliver,

On Thursday 10 January 2008, Oliver Neukum wrote:
> Am Mittwoch, 9. Januar 2008 10:39:11 schrieb Brandon Philips:
> > > > --- uvc.orig/uvc_driver.c
> > > > +++ uvc/uvc_driver.c
> > > > @@ -678,8 +678,10 @@ static int uvc_parse_streaming(struct uv
> > > > ????????????????????format->frame = frame;
> > > > ????????????????????ret = uvc_parse_format(dev, streaming, format,
> > > > ????????????????????????????&interval, buffer, buflen);
> > > > -???????????????????if (ret < 0)
> > > > +???????????????????if (ret < 0) {
> > > > +???????????????????????????kfree(format);
> > > > ????????????????????????????return ret;
> > > > +???????????????????}
> > >
> > > Are you sure about this ? format is freed in uvc_delete().
> >
> > Yes, this is unnecessary. ?Do you need me to resubmit?
>
> How is this supposed to be freed?
>
> uvc_parse_streaming() stores a pointer to format in streaming:
>
> 	format = kzalloc(size, GFP_KERNEL);
> 	if (format == NULL)
> 		return -ENOMEM;
>
> 	frame = (struct uvc_frame*)&format[nformats];
> 	interval = (__u32*)&frame[nframes];
>
> 	streaming->format = format;
> 	streaming->nformats = nformats;
>
> If uvc_parse_streaming() returns an error to the caller:
>
> 				if (uvc_parse_streaming(dev, streaming) < 0) {
> 					usb_put_intf(intf);
> 					kfree(streaming);
> 					continue;
> 				}
>
> 				list_add_tail(&streaming->list, &dev->streaming);
>
> streaming is freed and the addition to the list skipped. So uvc_delete()
> walks the list, but it won't find the entry. This looks like a memory leak
> to me.

You're right. My bad. Thanks for the report. I committed a fix.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 10 23:53:17 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 10 Jan 2008 23:53:17 +0100
Subject: [Linux-uvc-devel] [PATCH] uvcvideo: usb power management
In-Reply-To: <20071213015919.GD530@ifup.org>
References: <20071213015919.GD530@ifup.org>
Message-ID: <200801102353.17525.laurent.pinchart@skynet.be>

Hi,

On Thursday 13 December 2007, Brandon Philips wrote:
> This patch enables usb power management in the UVC driver.  As cameras
> are built into more and more modern laptops it is important that we get
> power management for them working.

I committed a power management patch based on yours, with modifications to fix 
the memory leak pointed out by Oliver and the status URB resubmission.

Thanks for your work.

Best regards,

Laurent Pinchart


From dionoea at videolan.org  Thu Jan 10 23:57:53 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Thu, 10 Jan 2008 23:57:53 +0100
Subject: [Linux-uvc-devel] Possible bug in while enumerating private
	controls
In-Reply-To: <200801102236.04374.laurent.pinchart@skynet.be>
References: <20080103203214.GB23938@via.ecp.fr>
	<200801102236.04374.laurent.pinchart@skynet.be>
Message-ID: <20080110225753.GB10608@via.ecp.fr>

On Thu, Jan 10, 2008, Laurent Pinchart wrote:
> The UVC driver is different. The UVC spec allows devices to define new 
> controls. The total number of controls could be huge, so using 
> V4L2_CTRL_FLAG_DISABLED is not practical. For this reason, you should use the 
> enumeration method described in 
> http://v4l2spec.bytesex.org/spec-single/v4l2.html#AEN794

That's what I ended up doing in VLC (since I needed to use the new API
to get MPEG controls anyway) but other apps still use the old method (at
least the versions packages in debian sid do, stuff like v4l-info for
example). So I figured that this might still be usefull to make sure
nobody gets left out.

Regards,

-- 
Antoine Cellerier
dionoea


From brandon at ifup.org  Fri Jan 11 00:08:03 2008
From: brandon at ifup.org (Brandon Philips)
Date: Thu, 10 Jan 2008 15:08:03 -0800
Subject: [Linux-uvc-devel] [PATCH] uvcvideo: usb power management
In-Reply-To: <200801102353.17525.laurent.pinchart@skynet.be>
References: <20071213015919.GD530@ifup.org>
	<200801102353.17525.laurent.pinchart@skynet.be>
Message-ID: <20080110230803.GB24387@plankton.ifup.org>

On 23:53 Thu 10 Jan 2008, Laurent Pinchart wrote:
> Hi,
> 
> On Thursday 13 December 2007, Brandon Philips wrote:
> > This patch enables usb power management in the UVC driver.  As cameras
> > are built into more and more modern laptops it is important that we get
> > power management for them working.
> 
> I committed a power management patch based on yours, with modifications to fix 
> the memory leak pointed out by Oliver and the status URB resubmission.

Thanks.  I would take a look but it seems that svn.berlios.de is having
problems.

Cheers,

	Brandon


From contact at i-nz.net  Fri Jan 11 00:42:04 2008
From: contact at i-nz.net (Ivan N. Zlatev)
Date: Thu, 10 Jan 2008 23:42:04 +0000
Subject: [Linux-uvc-devel] [SVN] iSight support
In-Reply-To: <1198777921.7164.6.camel@thilivren>
References: <200712112335.41024.laurent.pinchart@skynet.be>	
	<475F1541.9060908@i-nz.net> <1198777921.7164.6.camel@thilivren>
Message-ID: <4786AD4C.2090303@i-nz.net>

?tienne Bersac wrote:
> Hi everyone,
> 
> After some days (who said weeks ?) i finally got the time to work on ift
> and fix it. I also added Leopard driver support ! I produce a 1.0
> without RC (i'm not afraid of a 1.1 ?). It has now lots of driver
> hash/offset, and should work on many env. It rely on DEVICE being of the
> form /dev/bus/usb/<bus-id>/<dev-id> .
> 
> http://bersace03.free.fr/ift
> 
> The packages should land soon on my PPA.
> 
> So, this is kind of my gift for Xmas (i confess a bit late). Happy new
> year !
> 

There is still one problem remaining for me with your build system. You 
install ift-load in ${libdir}/udev, but then in the rule input 
(isight.rule.in) you reference it by @prefix@/lib/. It should be 
@libdir@/udev/ift-load in order to avoid conflicts. Also keep in mind 
that some distributions use "lib64" instead of "lib" for 64bit. In this 
context you should better use @libdir@ instead of "lib" in /lib/firmware 
as well. Something like:

--- isight.rules.in_orig        2007-12-11 15:59:11.000000000 +0000
+++ isight.rules.in     2008-01-10 23:12:35.000000000 +0000
@@ -1 +1 @@
-ACTION=="add", SYSFS{idVendor}=="05ac", SYSFS{idProduct}=="8300", 
RUN+="@prefix@/lib/udev/ift-load --firmware /lib/firmware/isight.fw"
+ACTION=="add", SYSFS{idVendor}=="05ac", SYSFS{idProduct}=="8300", 
RUN+="@libdir@/udev/ift-load --firmware @libdir@/firmware/isight.fw"

Cheers.
-- 
Ivan N. Zlatev

Web: http://www.i-nZ.net
"It's all some kind of whacked out conspiracy."


From rumi_ml at rtfm.hu  Fri Jan 11 03:49:11 2008
From: rumi_ml at rtfm.hu (RUMI Szabolcs)
Date: Fri, 11 Jan 2008 03:49:11 +0100
Subject: [Linux-uvc-devel] Labtec WebCam Pro (0x046d:0x08a2) uvc support
 possible?
In-Reply-To: <E1JAqya-0003iL-80@www2.emo.freenet-rz.de>
References: <E1JAqya-0003iL-80@www2.emo.freenet-rz.de>
Message-ID: <20080111034911.a9a220eb.rumi_ml@rtfm.hu>

Hi!

On Fri, 04 Jan 2008 19:09:00 +0100
moh0815 at freenet.de wrote:

> Hi,
> is it possible to add support in linux-uvc for the webcam 'Labtec
> WebCam Pro' (vendor=0x046d, product=0x08a2)?
> 
> I also attached the corresponding output from lsusb (0.72, ubuntu
> 7.10), maybe this helps...

I believe this is not an UVC camera.
I've actually had one of these and it's working reliably using
the "gspcav1" driver. Also works quite good with Skype 2.x for Linux.

Best regards,

Sab


From rumi_ml at rtfm.hu  Fri Jan 11 04:41:13 2008
From: rumi_ml at rtfm.hu (RUMI Szabolcs)
Date: Fri, 11 Jan 2008 04:41:13 +0100
Subject: [Linux-uvc-devel] QC Fusion (046d:08c1) inconsistent buggyness?
In-Reply-To: <200801102134.13646.laurent.pinchart@skynet.be>
References: <20080110013851.2a0490db.rumi_ml@rtfm.hu>
	<200801102134.13646.laurent.pinchart@skynet.be>
Message-ID: <20080111044113.a338a270.rumi_ml@rtfm.hu>

Hi!

On Thu, 10 Jan 2008 21:34:13 +0100
Laurent Pinchart <laurent.pinchart at skynet.be> wrote:

> > What makes this difference that it works while other apps don't?
> 
> Skype might be buggy ;-) I know that Skype tries to change the frame
> rate while streaming. The driver currently allows that but doesn't
> handle the request properly. It might make the webcam crash.
> 
> I plan to fix it, probably by disallowing frame rate changes while
> streaming.

I'd be more than happy to test that fix you are planning... ;-)

I've read somewhere that there have been some people who tried to
create various patches in order to get this camera to work but you
refused to integrate them because you didn't wanted to taint your
nice code with such ugly and/or occasionally working things which
sounds reasonable.

I ain't got no clue about no nothing but I thought maybe there could
be made an established interface for that like a "workarounds=0x0000"
module parameter where 0x0000 is a bitmask that can be used to enable
or disable the various kludges which iron out such bugs like the ones
that the QC Fusion has. It might happen with various cameras even in
the future that they've got a bug that is ugly to work around or it
is no good for some reason to always work around them in the same way.

Of course the default would be 0x0000 as in no workarounds enabled
for the main driver to be nice and solid but any of them could be
easily enabled and tested by those who need them to get their camera
working. This way they could also get evolved within the broader
linux-uvc community including people who are not able or willing
to patch/hack their kernel sources on their own for example.

What do you think?

Best regards,

Sab


From brandon at ifup.org  Fri Jan 11 05:25:45 2008
From: brandon at ifup.org (Brandon Philips)
Date: Thu, 10 Jan 2008 20:25:45 -0800
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <1199955500.5487.4.camel@speck.logular.com>
References: <1199955500.5487.4.camel@speck.logular.com>
Message-ID: <20080111042545.GC24387@plankton.ifup.org>

On 19:58 Thu 10 Jan 2008, Jason Grant wrote:
> I rarely use the integrated webcam on my laptop (046d:08c6).  It runs
> very hot, and I would like to stop it consuming battery power.
> 
> It looks like a power-management patch is in the works, however in the
> interim, I have read that it is possible to power off the camera by
> doing something like:
> 
> echo "0"
> > /sys/devices/pci0000:00/0000:00:1d.7/usb1/1-5/bConfigurationValue
> 
> I have tried this without success (running fedora 8 and latest uvcvideo
> from svn).  Is there any truth to this?  If not, I am hoping that
> someone here could provide me with info on how to manually turn this
> camera off/on.  I will happily write a c program to do this if required.

The autosuspend code has been added to SVN if you want to test it.

0. Recompile with CONFIG_USB_DEBUG if you want to see debugging output
1. Locate the device with lsusb
2. Go to its sysfs directory
3. echo "auto" > power/level
4. wait for messages about the device and its root hub being suspended
   in syslog. It'll take a few seconds (if you have CONFIG_USB_DEBUG)

e.g.

~$ lsusb
Bus 005 Device 005: ID 046d:0991 Logitech, Inc.

# echo auto >
/sys/devices/pci0000\:00/0000\:00\:1d.7/usb5/5-1/power/level

Cheers,

	Brandon


From jschen.cse at gmail.com  Fri Jan 11 05:58:11 2008
From: jschen.cse at gmail.com (Jhih-Sin Chen)
Date: Fri, 11 Jan 2008 12:58:11 +0800
Subject: [Linux-uvc-devel] Chicony camera will flip on 640*320 resolution
Message-ID: <6f91bc8f0801102058y306bea55o8a7a67a9acfdf6ce@mail.gmail.com>

Hi all,

I have a chicony camera using uvcvideo driver on ubuntu710.
It works fine on while resolution is 320*240.
But when the resolution is bigger than 320*240, luvcview will flip and
upside down.

If I disable smp and rebuild the kernel, the problem will be solved.
Could you finger out what the problem is ? driver ? hardware ?
Any suggestion is welcome. Thanks :)


From oliver at neukum.org  Fri Jan 11 09:23:39 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Fri, 11 Jan 2008 09:23:39 +0100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <20080111042545.GC24387@plankton.ifup.org>
References: <1199955500.5487.4.camel@speck.logular.com>
	<20080111042545.GC24387@plankton.ifup.org>
Message-ID: <200801110923.40146.oliver@neukum.org>

Am Freitag, 11. Januar 2008 05:25:45 schrieb Brandon Philips:
> > I have tried this without success (running fedora 8 and latest uvcvideo
> > from svn). ?Is there any truth to this? ?If not, I am hoping that
> > someone here could provide me with info on how to manually turn this
> > camera off/on. ?I will happily write a c program to do this if required.
> 
> The autosuspend code has been added to SVN if you want to test it.
> 
> 0. Recompile with CONFIG_USB_DEBUG if you want to see debugging output

You also need CONFIG_USB_SUSPEND

	Regards
		Oliver



From bersace03 at gmail.com  Fri Jan 11 10:50:03 2008
From: bersace03 at gmail.com (=?ISO-8859-1?Q?=C9tienne?= Bersac)
Date: Fri, 11 Jan 2008 10:50:03 +0100
Subject: [Linux-uvc-devel] [SVN] iSight support
In-Reply-To: <4786AD4C.2090303@i-nz.net>
References: <200712112335.41024.laurent.pinchart@skynet.be>
	<475F1541.9060908@i-nz.net> <1198777921.7164.6.camel@thilivren>
	<4786AD4C.2090303@i-nz.net>
Message-ID: <1200045004.7086.1.camel@thilivren>

Hi,

> There is still one problem remaining for me with your build system. You 
> install ift-load in ${libdir}/udev, but then in the rule input 
> (isight.rule.in) you reference it by @prefix@/lib/. It should be 
> @libdir@/udev/ift-load in order to avoid conflicts. Also keep in mind 
> that some distributions use "lib64" instead of "lib" for 64bit.

Right but, did you test the solution you propose ? I remember configure
substituting with shell variable ? :/

Regards,
?tienne.



From expires07 at logular.com  Fri Jan 11 12:46:32 2008
From: expires07 at logular.com (Jason Grant)
Date: Fri, 11 Jan 2008 22:46:32 +1100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <20080111042545.GC24387@plankton.ifup.org>
References: <1199955500.5487.4.camel@speck.logular.com>
	<20080111042545.GC24387@plankton.ifup.org>
Message-ID: <1200051992.4091.12.camel@speck.logular.com>

Hi All,

Thanks for your efforts and tips on this.

I am running the following fedora kernel

  2.6.23.1-42.fc8

with CONFIG_USB_SUSPEND=y, and uvcvideo compiled from today's svn head.

When I echo "auto" to the relevant /sys/devices/../power/level, the cam
seems to continue to draw power indefinitely.  As soon as I echo "1"
to /sys/devices/../power/autosuspend, the camera immediately cools, and
the laptop consumes approx 1.4W less power.  I also see the "Suspending
interface" trace message from uvc_driver.c.

Is there something else that needs to be configured before suspend will
be triggered automatically?

Thanks for any tips, and I'm happy to troubleshoot further,

Jason.

On Thu, 2008-01-10 at 20:25 -0800, Brandon Philips wrote:
> On 19:58 Thu 10 Jan 2008, Jason Grant wrote:
> > I rarely use the integrated webcam on my laptop (046d:08c6).  It runs
> > very hot, and I would like to stop it consuming battery power.
> > 
> > It looks like a power-management patch is in the works, however in the
> > interim, I have read that it is possible to power off the camera by
> > doing something like:
> > 
> > echo "0"
> > > /sys/devices/pci0000:00/0000:00:1d.7/usb1/1-5/bConfigurationValue
> > 
> > I have tried this without success (running fedora 8 and latest uvcvideo
> > from svn).  Is there any truth to this?  If not, I am hoping that
> > someone here could provide me with info on how to manually turn this
> > camera off/on.  I will happily write a c program to do this if required.
> 
> The autosuspend code has been added to SVN if you want to test it.
> 
> 0. Recompile with CONFIG_USB_DEBUG if you want to see debugging output
> 1. Locate the device with lsusb
> 2. Go to its sysfs directory
> 3. echo "auto" > power/level
> 4. wait for messages about the device and its root hub being suspended
>    in syslog. It'll take a few seconds (if you have CONFIG_USB_DEBUG)
> 
> e.g.
> 
> ~$ lsusb
> Bus 005 Device 005: ID 046d:0991 Logitech, Inc.
> 
> # echo auto >
> /sys/devices/pci0000\:00/0000\:00\:1d.7/usb5/5-1/power/level
> 
> Cheers,
> 
> 	Brandon


From oliver at neukum.org  Fri Jan 11 12:52:04 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Fri, 11 Jan 2008 12:52:04 +0100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <1200051992.4091.12.camel@speck.logular.com>
References: <1199955500.5487.4.camel@speck.logular.com>
	<20080111042545.GC24387@plankton.ifup.org>
	<1200051992.4091.12.camel@speck.logular.com>
Message-ID: <200801111252.04475.oliver@neukum.org>

Am Freitag, 11. Januar 2008 12:46:32 schrieb Jason Grant:
> Hi All,
> 
> Thanks for your efforts and tips on this.
> 
> I am running the following fedora kernel
> 
>   2.6.23.1-42.fc8
> 
> with CONFIG_USB_SUSPEND=y, and uvcvideo compiled from today's svn head.
> 
> When I echo "auto" to the relevant /sys/devices/../power/level, the cam
> seems to continue to draw power indefinitely.  As soon as I echo "1"
> to /sys/devices/../power/autosuspend, the camera immediately cools, and
> the laptop consumes approx 1.4W less power.  I also see the "Suspending
> interface" trace message from uvc_driver.c.
> 
> Is there something else that needs to be configured before suspend will
> be triggered automatically?

It should be enough. Does your camera have a microphone? What does lsusb -v
say about the camera?

	Regards
		Oliver


From contact at i-nz.net  Fri Jan 11 15:54:30 2008
From: contact at i-nz.net (Ivan N. Zlatev)
Date: Fri, 11 Jan 2008 14:54:30 +0000
Subject: [Linux-uvc-devel] [SVN] iSight support
In-Reply-To: <1200045004.7086.1.camel@thilivren>
References: <200712112335.41024.laurent.pinchart@skynet.be>	
	<475F1541.9060908@i-nz.net> <1198777921.7164.6.camel@thilivren>	
	<4786AD4C.2090303@i-nz.net> <1200045004.7086.1.camel@thilivren>
Message-ID: <47878326.8060005@i-nz.net>

?tienne Bersac wrote:
> Hi,
> 
>> There is still one problem remaining for me with your build system. You 
>> install ift-load in ${libdir}/udev, but then in the rule input 
>> (isight.rule.in) you reference it by @prefix@/lib/. It should be 
>> @libdir@/udev/ift-load in order to avoid conflicts. Also keep in mind 
>> that some distributions use "lib64" instead of "lib" for 64bit.
> 
> Right but, did you test the solution you propose ? 

Yes with the patch I've managed to configure it properly for my 32bit 
openSUSE:

./configure --prefix=/usr --libdir=/lib --bindir=/usr/bin 
--sbindir=/sbin --datadir=/usr/share --datarootdir=/usr/share 
--sysconfdir=/etc

To install as follows:

/etc/udev/rules.d/isight.rules
/lib/udev/ift-load
/usr/bin/ift-export
/usr/bin/ift-extract
/usr/share/doc/isight-firmware-tools/HOWTO
/usr/share/info/ift-export.info.gz
/usr/share/info/ift-extract.info.gz
/usr/share/locale/fr_FR/LC_MESSAGES/isight-firmware-tools.mo
/usr/share/man/man1/ift-export.1.gz
/usr/share/man/man1/ift-extract.1.gz

and the rule to be:

ACTION=="add", SYSFS{idVendor}=="05ac", SYSFS{idProduct}=="8300", 
RUN+="/lib/udev/ift-load --firmware /lib/firmware/isight.fw"

> I remember configure substituting with shell variable ? :/
> 

Yes, because I used to set prefix to / in order to get the rule to have 
the path to ift-load: /lib/udev/ and @prefix@/lib/udev/, where prefix == 
/ --> //lib/udev. The problem with prefix == / is that the prefix is 
used for the translations and if prefix == / the translations are 
installed in /share and not /usr/share. And if prefix == /usr (as it 
should be) then the rule has the path /usr/lib/udev/ift-load/. So yeah 
@libdir@ instead of @prefix@ works well for me in the rule.

Regards.
-- 
Ivan N. Zlatev

Web: http://www.i-nZ.net
"It's all some kind of whacked out conspiracy."


From pierpaolo.vittorini at gmail.com  Fri Jan 11 15:43:53 2008
From: pierpaolo.vittorini at gmail.com (Pierpaolo Vittorini)
Date: Fri, 11 Jan 2008 15:43:53 +0100
Subject: [Linux-uvc-devel] Unsupported device
In-Reply-To: <200801102119.29558.laurent.pinchart@skynet.be>
References: <200801081054.07627.pierpaolo.vittorini@gmail.com>
	<200801102119.29558.laurent.pinchart@skynet.be>
Message-ID: <200801111543.54095.pierpaolo.vittorini@gmail.com>

Alle gioved? 10 gennaio 2008, Laurent Pinchart ha scritto:
> Hi Pierpaolo,
>
> On Tuesday 08 January 2008, Pierpaolo Vittorini wrote:
> > Attached is the portion of "lsusb -v" output regarding my unsupported
> > chicony web cam, shipped with an HP laptop (idProduct = 0xb016).
>
> Could you please upgrade to usbutils 0.72 and then resend me the lsusb
> output ?
>
> Does the webcam work with the Linux UVC driver ?
>
> Best regards,
>
> Laurent Pinchart

Dear Laurent,
the lsusb output is attached. Though - and please apologize if my previous 
email was really ... short - my webcam actually works with the latest Linux 
UVC driver, even if it is not listed among those supported.

Best regards,
Pierpaolo Vittorini.
-------------- next part --------------
Bus 002 Device 002: ID 04f2:b016 Chicony Electronics Co., Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04f2 Chicony Electronics Co., Ltd
  idProduct          0xb016
  bcdDevice            6.04
  iManufacturer           2 Chicony Electronics Co., Ltd.
  iProduct                1 HP Webcam
  iSerial                 3 SN0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          543
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               1 HP Webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              1 HP Webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           77
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             1
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x01
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000053f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      323
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   614400
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   202752
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   153600
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                    50688
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                    38400
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            26
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               5
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        352
        wHeight( 1)                       288
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        176
        wHeight( 3)                       144
        wWidth( 4)                        160
        wHeight( 4)                       120
        bNumCompressionPatterns             5
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13e8  3x 1000 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

From laurent.pinchart at skynet.be  Fri Jan 11 21:38:56 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 11 Jan 2008 21:38:56 +0100
Subject: [Linux-uvc-devel] QC Fusion (046d:08c1) inconsistent buggyness?
In-Reply-To: <20080111044113.a338a270.rumi_ml@rtfm.hu>
References: <20080110013851.2a0490db.rumi_ml@rtfm.hu>
	<200801102134.13646.laurent.pinchart@skynet.be>
	<20080111044113.a338a270.rumi_ml@rtfm.hu>
Message-ID: <200801112138.57032.laurent.pinchart@skynet.be>

Hi Sab,

On Friday 11 January 2008, RUMI Szabolcs wrote:
> Hi!
>
> On Thu, 10 Jan 2008 21:34:13 +0100
>
> Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > > What makes this difference that it works while other apps don't?
> >
> > Skype might be buggy ;-) I know that Skype tries to change the frame
> > rate while streaming. The driver currently allows that but doesn't
> > handle the request properly. It might make the webcam crash.
> >
> > I plan to fix it, probably by disallowing frame rate changes while
> > streaming.
>
> I'd be more than happy to test that fix you are planning... ;-)

Then grab the latest SVN version. I've just committed a patch that disallows 
changing the frame format or the frame size while streaming.

> I've read somewhere that there have been some people who tried to
> create various patches in order to get this camera to work but you
> refused to integrate them because you didn't wanted to taint your
> nice code with such ugly and/or occasionally working things which
> sounds reasonable.

The early UVC Logitech webcams were all buggy. Under some particular timing 
conditions the firmware misses an interrupt which results in errors. Those 
timing conditions, while very uncommon under Windows, happen quite often for 
some Linux users. A few people tried various workarounds but no definitive 
fix has been found.

> I ain't got no clue about no nothing but I thought maybe there could
> be made an established interface for that like a "workarounds=0x0000"
> module parameter where 0x0000 is a bitmask that can be used to enable
> or disable the various kludges which iron out such bugs like the ones
> that the QC Fusion has. It might happen with various cameras even in
> the future that they've got a bug that is ugly to work around or it
> is no good for some reason to always work around them in the same way.
>
> Of course the default would be 0x0000 as in no workarounds enabled
> for the main driver to be nice and solid but any of them could be
> easily enabled and tested by those who need them to get their camera
> working. This way they could also get evolved within the broader
> linux-uvc community including people who are not able or willing
> to patch/hack their kernel sources on their own for example.
>
> What do you think?

The driver already includes workarounds for various broken devices. Have a 
look at the UVC_QUIRK_* macros in uvcvideo.h and how they are associated with 
devices in uvc_driver.c.

For early Logitech devices, however, no satisfying workaround has been find so 
far.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 11 21:41:52 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 11 Jan 2008 21:41:52 +0100
Subject: [Linux-uvc-devel] Chicony camera will flip on 640*320 resolution
In-Reply-To: <6f91bc8f0801102058y306bea55o8a7a67a9acfdf6ce@mail.gmail.com>
References: <6f91bc8f0801102058y306bea55o8a7a67a9acfdf6ce@mail.gmail.com>
Message-ID: <200801112141.52687.laurent.pinchart@skynet.be>

Hi,

On Friday 11 January 2008, Jhih-Sin Chen wrote:
> Hi all,
>
> I have a chicony camera using uvcvideo driver on ubuntu710.
> It works fine on while resolution is 320*240.
> But when the resolution is bigger than 320*240, luvcview will flip and
> upside down.

Is it just a resolution issue, or do you use another format (YUV/MJPEG) for 
resolutions higher than 320x240 ?

> If I disable smp and rebuild the kernel, the problem will be solved.

Really ? Can you please double check ? The driver doesn't process the received 
image in any way. I'm very curious as to why SMP would cause the image to be 
flipped.

> Could you finger out what the problem is ? driver ? hardware ?
> Any suggestion is welcome. Thanks :)

I've heard of various cameras embedded in laptops that are mounted upside 
down. There is currently no known way to ask the camera to unflip the image.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 11 21:47:43 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 11 Jan 2008 21:47:43 +0100
Subject: [Linux-uvc-devel] Unsupported device
In-Reply-To: <200801111543.54095.pierpaolo.vittorini@gmail.com>
References: <200801081054.07627.pierpaolo.vittorini@gmail.com>
	<200801102119.29558.laurent.pinchart@skynet.be>
	<200801111543.54095.pierpaolo.vittorini@gmail.com>
Message-ID: <200801112147.43165.laurent.pinchart@skynet.be>

Hi,

On Friday 11 January 2008, Pierpaolo Vittorini wrote:
> Alle gioved? 10 gennaio 2008, Laurent Pinchart ha scritto:
> > Hi Pierpaolo,
> >
> > On Tuesday 08 January 2008, Pierpaolo Vittorini wrote:
> > > Attached is the portion of "lsusb -v" output regarding my unsupported
> > > chicony web cam, shipped with an HP laptop (idProduct = 0xb016).
> >
> > Could you please upgrade to usbutils 0.72 and then resend me the lsusb
> > output ?
> >
> > Does the webcam work with the Linux UVC driver ?
> >
> > Best regards,
> >
> > Laurent Pinchart
>
> Dear Laurent,
> the lsusb output is attached. Though - and please apologize if my previous
> email was really ... short - my webcam actually works with the latest Linux
> UVC driver, even if it is not listed among those supported.

Thanks for the information. I added the webcam to the supported devices list 
on the website.

Best regards,

Laurent Pinchart


From expires07 at logular.com  Fri Jan 11 23:54:17 2008
From: expires07 at logular.com (Jason Grant)
Date: Sat, 12 Jan 2008 09:54:17 +1100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <200801111252.04475.oliver@neukum.org>
References: <1199955500.5487.4.camel@speck.logular.com>
	<20080111042545.GC24387@plankton.ifup.org>
	<1200051992.4091.12.camel@speck.logular.com>
	<200801111252.04475.oliver@neukum.org>
Message-ID: <1200092057.3026.5.camel@speck.logular.com>

Hi Oliver,

On Fri, 2008-01-11 at 12:52 +0100, Oliver Neukum wrote:
> Am Freitag, 11. Januar 2008 12:46:32 schrieb Jason Grant:
> > Hi All,
> > 
> > Thanks for your efforts and tips on this.
> > 
> > I am running the following fedora kernel
> > 
> >   2.6.23.1-42.fc8
> > 
> > with CONFIG_USB_SUSPEND=y, and uvcvideo compiled from today's svn head.
> > 
> > When I echo "auto" to the relevant /sys/devices/../power/level, the cam
> > seems to continue to draw power indefinitely.  As soon as I echo "1"
> > to /sys/devices/../power/autosuspend, the camera immediately cools, and
> > the laptop consumes approx 1.4W less power.  I also see the "Suspending
> > interface" trace message from uvc_driver.c.
> > 
> > Is there something else that needs to be configured before suspend will
> > be triggered automatically?
> 
> It should be enough. Does your camera have a microphone? What does lsusb -v
> say about the camera?
> 
> 	Regards
> 		Oliver

Yes, the camera has a microphone, but I tried the experiment after a
"modprobe -r snd_usb_audio".

I've attached the output from lsusb -v below.

Let me know if there is more I can do to help troubleshoot this.

Thanks,

Jason.

----------------------------------
[root at speck ~]# lsusb -v -d 046d:08c6

Bus 001 Device 003: ID 046d:08c6 Logitech, Inc. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         1 
  bMaxPacketSize0        64
  idVendor           0x046d Logitech, Inc.
  idProduct          0x08c6 
  bcdDevice           80.05
  iManufacturer           0 
  iProduct                0 
  iSerial                 2 E9A1AAA2
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength         1293
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
    MaxPower              500mA
    UNRECOGNIZED:  08 0b 00 02 ff 03 00 00
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      1 
      bInterfaceProtocol      0 
      iInterface              0 
      UNRECOGNIZED:  20 41 01 08 82 06 61 63 70 50 ab 49 b8 cc b3 85 5e
8d 22 51 03 01 04 03 19 00 00 00 00 00 00 00
      UNRECOGNIZED:  20 41 01 0a 82 06 61 63 70 50 ab 49 b8 cc b3 85 5e
8d 22 52 01 01 04 03 00 40 00 00 00 00 00 00
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x87  EP 7 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               8
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0280  1x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03b0  1x 944 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0a80  2x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       8
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       9
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0be0  2x 992 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting      10
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting      11
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x13fc  3x 1020 bytes
        bInterval               1
        UNRECOGNIZED:  08 0b 02 02 01 02 00 00
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           38
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                 8
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 5
        bSourceID               1
        bControlSize            1
        bmaControls( 0)      0x03
          Mute
          Volume
        iFeature                0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       2
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0030  1x 48 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         1 
  bMaxPacketSize0        64
  bNumConfigurations      1


From oliver at neukum.org  Sat Jan 12 00:30:16 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Sat, 12 Jan 2008 00:30:16 +0100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <1200092057.3026.5.camel@speck.logular.com>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801111252.04475.oliver@neukum.org>
	<1200092057.3026.5.camel@speck.logular.com>
Message-ID: <200801120030.16909.oliver@neukum.org>

Am Freitag, 11. Januar 2008 23:54:17 schrieb Jason Grant:
> Yes, the camera has a microphone, but I tried the experiment after a
> "modprobe -r snd_usb_audio".

OK, that would have been the simplest answer.

> I've attached the output from lsusb -v below.
> 
> Let me know if there is more I can do to help troubleshoot this.

Can you please compile your kernel with CONFIG_USB_DEBUG and post dmesg?

	Regards
		Oliver


From oliver at neukum.org  Sat Jan 12 00:37:24 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Sat, 12 Jan 2008 00:37:24 +0100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <1200092057.3026.5.camel@speck.logular.com>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801111252.04475.oliver@neukum.org>
	<1200092057.3026.5.camel@speck.logular.com>
Message-ID: <200801120037.25028.oliver@neukum.org>

Am Freitag, 11. Januar 2008 23:54:17 schrieb Jason Grant:
> Let me know if there is more I can do to help troubleshoot this.
> 

Sorry, I take everything back. With this kernel version you also need
to set an autosuspend timeout. All is well.

	Sorry
		Oliver



From mathewss at nutech.com  Sat Jan 12 04:16:51 2008
From: mathewss at nutech.com (sean mathews)
Date: Fri, 11 Jan 2008 19:16:51 -0800
Subject: [Linux-uvc-devel] support for eMPIA 2761
Message-ID: <200801111916.51388.mathewss@nutech.com>

I have a laptop with an eMPIA 2750 built in to the monitor. 

It has a vendor id of 0xeb1a and a device id of 0x2750

 I had seen your the site at http://linux-uvc.berlios.de/ that a similar 
device was supported so I figured I could try and get this working, but when 
i got the svn source I noticed that this device is not even listed in the 
uvc_ids array.

 Did i miss a bit? I dont see how this device could be supported if its not in 
this array yet on the site it shows as supported. Maybe a special svn trunk 
exists?

here is the svn command i used.

svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk

Thanks in advance..


-- 
?Regards
? Sean Mathews Nu Tech CTO

struct SoftwareProfessional {
? ?double salary;
? ?long ? lunches;
? ?float ?jobs;
? ?char ? unstable;
? ?void ? work;
? ?short ?tempers;
};


From laurent.pinchart at skynet.be  Sat Jan 12 19:28:20 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 12 Jan 2008 19:28:20 +0100
Subject: [Linux-uvc-devel] support for eMPIA 2761
In-Reply-To: <200801111916.51388.mathewss@nutech.com>
References: <200801111916.51388.mathewss@nutech.com>
Message-ID: <200801121928.20537.laurent.pinchart@skynet.be>

Hi Sean,

On Saturday 12 January 2008, sean mathews wrote:
> I have a laptop with an eMPIA 2750 built in to the monitor.
>
> It has a vendor id of 0xeb1a and a device id of 0x2750
>
>  I had seen your the site at http://linux-uvc.berlios.de/ that a similar
> device was supported so I figured I could try and get this working, but
> when i got the svn source I noticed that this device is not even listed in
> the uvc_ids array.
>
>  Did i miss a bit? I dont see how this device could be supported if its not
> in this array yet on the site it shows as supported.

The uvc_ids array ends with

        /* Generic USB Video Class */
        { USB_INTERFACE_INFO(USB_CLASS_VIDEO, 1, 0) },

This catches all UVC compliant devices using the bInterfaceClass and 
bInterfaceSubclass fields.

If your camera is UVC compliant (see http://linux-uvc.berlios.de/faq/ for 
instructions how to find out), you won't have to modify the driver at all. It 
should work out of the box.

If your device is UVC compliant, please post the output of lsusb -v (using 
usbutils 0.72 or newer) here.

However, some UVC-compliant devices are buggy and require specific processing 
in the driver. Those devices are explicitly listed in the uvc_ids array with 
device-specific information set in the driver_info field.

> Maybe a special svn trunk exists?
>
> here is the svn command i used.
>
> svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
>
> Thanks in advance..

Best regards,

Laurent Pinchart


From expires07 at logular.com  Sun Jan 13 00:19:34 2008
From: expires07 at logular.com (Jason Grant)
Date: Sun, 13 Jan 2008 10:19:34 +1100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <200801120037.25028.oliver@neukum.org>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801111252.04475.oliver@neukum.org>
	<1200092057.3026.5.camel@speck.logular.com>
	<200801120037.25028.oliver@neukum.org>
Message-ID: <1200179974.3150.10.camel@speck.logular.com>

Hello,

I am happy to report that the new power management feature of uvcvideo
is working very well with my Dell XPS M1210 laptop.  After invoking the
script below during init, the camera powers down after the specified
timeout period, and as soon as I run a tool such as luvcview, the camera
powers up again and is operational before powering off when I am done.

I also had to blacklist snd_usb_audio in my modprobe.conf for this to
work.

Thanks again for this great patch.  It seems to conserve about 1.4W of
power on my laptop.

Cheers,

Jason.

# --------------------------------------------

#!/bin/bash

TIMEOUT=5
CAMID="046d:08c6"


for i in $(find /sys/devices -type f -name idVendor)
do
  dir=$(dirname $i)
  id="$(cat $i):$(cat $dir/idProduct)"
  if [ "$id" = "$CAMID" ] ; then 
    echo "auto" > $dir/power/level
    echo "$TIMEOUT" > $dir/power/autosuspend
  fi
done



From oliver at neukum.org  Sun Jan 13 12:19:56 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Sun, 13 Jan 2008 12:19:56 +0100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <1200179974.3150.10.camel@speck.logular.com>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801120037.25028.oliver@neukum.org>
	<1200179974.3150.10.camel@speck.logular.com>
Message-ID: <200801131219.56919.oliver@neukum.org>

Am Sonntag, 13. Januar 2008 00:19:34 schrieb Jason Grant:
> Hello,
> 
> I am happy to report that the new power management feature of uvcvideo
> is working very well with my Dell XPS M1210 laptop.  After invoking the
> script below during init, the camera powers down after the specified

Ideally you'd convert the script to udev so people with hotplugged cameras
can also use it.

> timeout period, and as soon as I run a tool such as luvcview, the camera
> powers up again and is operational before powering off when I am done.
> 
> I also had to blacklist snd_usb_audio in my modprobe.conf for this to
> work.

I do have a patch for the audio driver but it is under development.
 
> Thanks again for this great patch.  It seems to conserve about 1.4W of
> power on my laptop.

Good.

	Regards
		Oliver


From expires07 at logular.com  Sun Jan 13 13:28:37 2008
From: expires07 at logular.com (Jason Grant)
Date: Sun, 13 Jan 2008 23:28:37 +1100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <200801131219.56919.oliver@neukum.org>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801120037.25028.oliver@neukum.org>
	<1200179974.3150.10.camel@speck.logular.com>
	<200801131219.56919.oliver@neukum.org>
Message-ID: <1200227317.13818.5.camel@speck.logular.com>


On Sun, 2008-01-13 at 12:19 +0100, Oliver Neukum wrote:
> 
> Ideally you'd convert the script to udev so people with hotplugged cameras
> can also use it.
> 

I'll look into this, because I suspect that another benefit of this
approach would be proper setting of the camera powersave params when the
laptop comes out of suspend.  I've noticed that the camera otherwise
doesn't powersave after the laptop resumes, until I manually run my
script.

> > I also had to blacklist snd_usb_audio in my modprobe.conf for this to
> > work.
> 
> I do have a patch for the audio driver but it is under development.
>  

Is there another mailing list where you will be reporting status?

Thanks,

Jason.


From dionoea at videolan.org  Sun Jan 13 15:53:19 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Sun, 13 Jan 2008 15:53:19 +0100
Subject: [Linux-uvc-devel] [Patch] Add support for Zoom (Absolute),
	Digital Modifier and PanTilt (Absolute) controls
Message-ID: <20080113145319.GB32449@via.ecp.fr>

This patch adds support for the Zoom (Absolute), Digital Modifier and
PanTilt (Absolute) controls as defined in paragraphs 4.2.2.1.11,
4.2.2.3.14 and 4.2.2.1.13 of USB_Video_Class_1.1.pdf

The controls have been tested on a 05a9:2640 OmniVision Technologies,
Inc. webcam (used in Dell Laptops).

-- 
Antoine Cellerier
dionoea
-------------- next part --------------
A non-text attachment was scrubbed...
Name: linux-uvc.zoom_pantilt_absolute.patch
Type: text/x-diff
Size: 3015 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080113/e9951514/attachment.patch>

From julian at selectparks.net  Sun Jan 13 17:21:07 2008
From: julian at selectparks.net (Julian Oliver)
Date: Sun, 13 Jan 2008 17:21:07 +0100
Subject: [Linux-uvc-devel] // low QuickCam Pro 9000 fps //
In-Reply-To: <200801131219.56919.oliver@neukum.org>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801120037.25028.oliver@neukum.org>
	<1200179974.3150.10.camel@speck.logular.com>
	<200801131219.56919.oliver@neukum.org>
Message-ID: <20080113162107.GC17251@selectparks.net>


hi list,

while i'm very happy with the Quickcam Pro 9000 on the current (checked
out yesterday) uvcvideo driver, i'm a little disappointed with the frame
rate: luvcview never reports a higher rate than 15fps for this device,
regardless of capture size: 320x240 is as slow as 960x720.

also, on the current version i can't seem to set the autoexposure to off
using the luvcvideo interface. previously i was using uvcdynctrl from
Logitech's own libwebcam, but now that reports an error:

	$./uvcdynctrl --clist
	[libwebcam] Unable to refresh device list. (error 12: A Video4Linux2 API call returned an unexpected error)

is there a trick to improving the frame rate? furthermore, is anyone
else having trouble using luvcvideo or uvcdynctrl to manipulate camera
paramaters?

where frame rate is concerned, it's perhaps worth mentioning that i'm
testing this on a Dual Core 2.4GHz laptop with 4GB of physical memory.
the machine hsa hardware graphics acceleration provided by an NVIDIA
Quadro FX 570M.

cheers,

Julian Oliver
Madrid, Spain


From laurent.pinchart at skynet.be  Sun Jan 13 22:45:47 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 13 Jan 2008 22:45:47 +0100
Subject: [Linux-uvc-devel] Debugging UVC + Sanyo Xacti cameras
In-Reply-To: <47826AC8.8070508@ifi.uzh.ch>
References: <44759.130.60.75.225.1198150630.squirrel@bela.ifi.unizh.ch>
	<200712282328.04081.laurent.pinchart@skynet.be>
	<47826AC8.8070508@ifi.uzh.ch>
Message-ID: <200801132245.48079.laurent.pinchart@skynet.be>

Hi Thomas,

On Monday 07 January 2008, Thomas Netter wrote:
> Dear Laurent,
>
> Bonne ann?e 2008 et merci pour votre aide.

Thanks. Happy new year to you too.

> Here's a follow-up to the Sanyo Xacti uvc problem.
> I did the following:
[snip]

I had a look at the various dumps (from Windows and Linux) and I have to say 
I'm really puzzled. When stopping streaming the Windows driver sends a SET 
INTERFACE request (called SELECT INTERFACE in the Snoopy log) that succeeds. 
The Linux driver sends the exact same request, but the request times out. 
Further requests then fail, and luvcview exits with an error.

I'm puzzled as to why the device times out in Linux. It might be that a 
previous request left it in some kind of bad state, but that's hard to tell.

As a wild guess, could you try the following patch and see if it helps ? Make 
sure you have a look at the kernel log for debug messages.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sanyo.diff
Type: text/x-diff
Size: 473 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080113/292fc272/attachment.diff>

From laurent.pinchart at skynet.be  Sun Jan 13 23:56:04 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 13 Jan 2008 23:56:04 +0100
Subject: [Linux-uvc-devel] // low QuickCam Pro 9000 fps //
In-Reply-To: <20080113162107.GC17251@selectparks.net>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801131219.56919.oliver@neukum.org>
	<20080113162107.GC17251@selectparks.net>
Message-ID: <200801132356.04957.laurent.pinchart@skynet.be>

Hi Julian,

On Sunday 13 January 2008, Julian Oliver wrote:
> hi list,
>
> while i'm very happy with the Quickcam Pro 9000 on the current (checked
> out yesterday) uvcvideo driver, i'm a little disappointed with the frame
> rate: luvcview never reports a higher rate than 15fps for this device,
> regardless of capture size: 320x240 is as slow as 960x720.
>
> also, on the current version i can't seem to set the autoexposure to off
> using the luvcvideo interface. previously i was using uvcdynctrl from
> Logitech's own libwebcam, but now that reports an error:
>
> 	$./uvcdynctrl --clist
> 	[libwebcam] Unable to refresh device list. (error 12: A Video4Linux2 API
> call returned an unexpected error)

uvcdynctrl isn't needed to control auto-exposure. It shouldn't fail though.

If you used an old version of the UVC driver, control identifiers might have 
changed. Recompiling luvcview might help.

> is there a trick to improving the frame rate? furthermore, is anyone
> else having trouble using luvcvideo or uvcdynctrl to manipulate camera
> paramaters?
>
> where frame rate is concerned, it's perhaps worth mentioning that i'm
> testing this on a Dual Core 2.4GHz laptop with 4GB of physical memory.
> the machine hsa hardware graphics acceleration provided by an NVIDIA
> Quadro FX 570M.

Best regards,

Laurent Pinchart


From leftmostcat at gmail.com  Mon Jan 14 10:22:20 2008
From: leftmostcat at gmail.com (=?UTF-8?B?U2XDoW4gZGUgQsO6cmNh?=)
Date: Mon, 14 Jan 2008 02:22:20 -0700
Subject: [Linux-uvc-devel] [SVN] iSight support
In-Reply-To: <47878326.8060005@i-nz.net>
References: <200712112335.41024.laurent.pinchart@skynet.be>		<475F1541.9060908@i-nz.net>
	<1198777921.7164.6.camel@thilivren>		<4786AD4C.2090303@i-nz.net>
	<1200045004.7086.1.camel@thilivren> <47878326.8060005@i-nz.net>
Message-ID: <478B29CC.5060202@gmail.com>

Using linux-uvc SVN revision 157 and isight-firmware-tools 1.0 (the
versions available in Gentoo's tree), no device seems to be created for
the camera. The driver claims to be loaded successfully, it seems, and
the firmware tools never complain. /dev/video0 still doesn't exist,
however, and neither does any other video device. Incidentally, running
`udevstart' produces a message that the bus ID can't be determined. This
is likely a problem with the environment variable business and I wonder
if there's another way this could be dealt with.


Se?n de B?rca


From julian at selectparks.net  Mon Jan 14 11:28:46 2008
From: julian at selectparks.net (Julian Oliver)
Date: Mon, 14 Jan 2008 11:28:46 +0100
Subject: [Linux-uvc-devel] Solved: (was // low QuickCam Pro 9000 fps //)
In-Reply-To: <200801132356.04957.laurent.pinchart@skynet.be>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801131219.56919.oliver@neukum.org>
	<20080113162107.GC17251@selectparks.net>
	<200801132356.04957.laurent.pinchart@skynet.be>
Message-ID: <20080114102846.GB26386@selectparks.net>

please ignore the below post. 

it seems i had an old debian package of luvcview on board this system i
didn't remember installing.. using a freshly compiled luvcview and the
latest uvcvideo module fixes the aforementioned problems. 

frame rate is excellent again.

thanks for your time.

julian

..on or around Sun, Jan 13, 2008 at 11:56:04PM +0100, Laurent Pinchart said:
> Hi Julian,
> 
> On Sunday 13 January 2008, Julian Oliver wrote:
> > hi list,
> >
> > while i'm very happy with the Quickcam Pro 9000 on the current (checked
> > out yesterday) uvcvideo driver, i'm a little disappointed with the frame
> > rate: luvcview never reports a higher rate than 15fps for this device,
> > regardless of capture size: 320x240 is as slow as 960x720.
> >
> > also, on the current version i can't seem to set the autoexposure to off
> > using the luvcvideo interface. previously i was using uvcdynctrl from
> > Logitech's own libwebcam, but now that reports an error:
> >
> > 	$./uvcdynctrl --clist
> > 	[libwebcam] Unable to refresh device list. (error 12: A Video4Linux2 API
> > call returned an unexpected error)
> 
> uvcdynctrl isn't needed to control auto-exposure. It shouldn't fail though.
> 
> If you used an old version of the UVC driver, control identifiers might have 
> changed. Recompiling luvcview might help.

i took your advice and compiled luvcview-20070512 (the latest i could
find) against yesterday's uvcvideo trunk, but still have no luck turning
off auto-exposure. i see the stdout:

	Auto Exposure set to 1
	Auto Exposure set to 8 

when clicking the On/Off buttons accordingly, but the settings are not applied.

in half-light this means the camera will pass about 5 frames a second over USB.

looking at the luvcvideo source i see a case definition for that particular
button event:

	case A_EXPOSURE_OFF:
		control.id    =V4L2_CID_EXPOSURE_AUTO;
		control.value =8;
		if ((value = ioctl(videoIn->fd, VIDIOC_S_CTRL, &control)) < 0)
		  printf("Set Auto Exposure off error\n");
		else
		  printf("Auto Exposure set to %d \n", control.value);
	break;

it seems the control value is being changed but strangely not set by the ioctl
call.

in the source i see definition for a switch so that i load settings from a
'luvcview.cfg'.  is this actually supposed to work? if so, is there an example
cfg around for me to look at?

cheers,

-- 
http://julianoliver.com
http://selectparks.net

messages containing HTML will not be read.


From mathewss at nutech.com  Mon Jan 14 19:26:33 2008
From: mathewss at nutech.com (sean mathews)
Date: Mon, 14 Jan 2008 10:26:33 -0800
Subject: [Linux-uvc-devel] support for eMPIA 2761
In-Reply-To: <200801121928.20537.laurent.pinchart@skynet.be>
References: <200801111916.51388.mathewss@nutech.com>
	<200801121928.20537.laurent.pinchart@skynet.be>
Message-ID: <200801141026.33340.mathewss@nutech.com>

 Thanks for the input.. 

 I had made an assumption that it was based upon the other model from this 
manufacturer and that fact that its usb.. Also thanks for the insight on how 
the driver works i had thought that with all the other devices that they were 
all usb..

 Here is my output from lsusb.. it does not seem to be a uvc device. I know 
this is not the correct forum for no uvc devices but i figured someone here 
may have some ideas just what type of device this is? This is an alienware 
m7700 and it is the default camera well at that time that they put into the 
display. 

 Get a load of this.. this is funny : c ) 
idProduct "0x8613 CY7C68013 EZ-USB FX2 USB 2.0 Development Kit"

lsusb -d 04b4:8613 -v

Bus 002 Device 005: ID 04b4:8613 Cypress Semiconductor Corp. CY7C68013 EZ-USB 
FX2 USB 2.0 Development Kit
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass       255 Vendor Specific Subclass
  bDeviceProtocol       255 Vendor Specific Protocol
  bMaxPacketSize0        64
  idVendor           0x04b4 Cypress Semiconductor Corp.
  idProduct          0x8613 CY7C68013 EZ-USB FX2 USB 2.0 Development Kit
  bcdDevice           a0.01
  iManufacturer           0
  iProduct                0
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          171
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           6
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x01  EP 1 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           6
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x01  EP 1 OUT
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           6
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x01  EP 1 OUT
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass       255 Vendor Specific Subclass
  bDeviceProtocol       255 Vendor Specific Protocol
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


On Saturday 12 January 2008 10:28:20 am Laurent Pinchart wrote:
> Hi Sean,
>
> On Saturday 12 January 2008, sean mathews wrote:
> > I have a laptop with an eMPIA 2750 built in to the monitor.
> >
> > It has a vendor id of 0xeb1a and a device id of 0x2750
> >
> >  I had seen your the site at http://linux-uvc.berlios.de/ that a similar
> > device was supported so I figured I could try and get this working, but
> > when i got the svn source I noticed that this device is not even listed
> > in the uvc_ids array.
> >
> >  Did i miss a bit? I dont see how this device could be supported if its
> > not in this array yet on the site it shows as supported.
>
> The uvc_ids array ends with
>
>         /* Generic USB Video Class */
>         { USB_INTERFACE_INFO(USB_CLASS_VIDEO, 1, 0) },
>
> This catches all UVC compliant devices using the bInterfaceClass and
> bInterfaceSubclass fields.
>
> If your camera is UVC compliant (see http://linux-uvc.berlios.de/faq/ for
> instructions how to find out), you won't have to modify the driver at all.
> It should work out of the box.
>
> If your device is UVC compliant, please post the output of lsusb -v (using
> usbutils 0.72 or newer) here.
>
> However, some UVC-compliant devices are buggy and require specific
> processing in the driver. Those devices are explicitly listed in the
> uvc_ids array with device-specific information set in the driver_info
> field.
>
> > Maybe a special svn trunk exists?
> >
> > here is the svn command i used.
> >
> > svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
> >
> > Thanks in advance..
>
> Best regards,
>
> Laurent Pinchart



-- 
?Regards
? Sean Mathews Nu Tech CTO

struct SoftwareProfessional {
? ?double salary;
? ?long ? lunches;
? ?float ?jobs;
? ?char ? unstable;
? ?void ? work;
? ?short ?tempers;
};


From philipp at kolmann.at  Mon Jan 14 19:45:15 2008
From: philipp at kolmann.at (Philipp Kolmann)
Date: Mon, 14 Jan 2008 19:45:15 +0100
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <200712070137.46488.laurent.pinchart@skynet.be>
References: <20071204195929.GA1101@kolmann.at>
	<200712052331.59034.laurent.pinchart@skynet.be>
	<20071206065637.GA26483@kolmann.at>
	<200712070137.46488.laurent.pinchart@skynet.be>
Message-ID: <20080114184515.GA30445@kolmann.at>

Hi,

On Fri, Dec 07, 2007 at 01:37:46AM +0100, Laurent Pinchart wrote:
> - The uvcvideo driver could stop streaming, renegotiate the parameters and 
> restart streaming. The webcam might still crash as the cause of the crash is 
> not understood.

your change in rev 166 makes skype work for me also in bad light conditions
now.

Thanks
Philipp

-- 
The more I learn about people, the more I like my dog!


From sergei.litvinenko at gmail.com  Mon Jan 14 19:50:29 2008
From: sergei.litvinenko at gmail.com (Sergei LITVINENKO)
Date: Mon, 14 Jan 2008 20:50:29 +0200
Subject: [Linux-uvc-devel] 046d:0990, QC Pro 9000,  5 FPS in any mode
Message-ID: <478BAEF5.4020502@gmail.com>

Fedora-8, CPU: E6850, Video: 8800GTX (NVIDIA-Linux-x86-100.14.19)
Drivers: trunk 166

[sergeil at homedesk ~]$ modinfo uvcvideo
filename:       /lib/modules/2.6.23.9-85.fc8/usb/media/uvcvideo.ko
license:        GPL
description:    USB Video Class driver
author:         Laurent Pinchart <laurent.pinchart at skynet.be>
alias:          usb:v*p*d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v5986p0200d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v5986p0102d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v5986p0100d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v19ABp1000d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v18CDpCAFEd*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v090CpB371d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v046Dp08C7d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C6d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C5d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C3d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C2d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C1d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v045Ep00F8d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v05ACp8501d*dc*dsc*dp*ic*isc*ip*
alias:          usb:v041Ep4057d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v0402p5606d*dc*dsc*dp*ic0Eisc01ip00*
depends:        videodev,v4l2-common,v4l1-compat,compat_ioctl32
vermagic:       2.6.23.9-85.fc8 SMP mod_unload 686 4KSTACKS
parm:           trace:uint


[sergeil at homedesk ~]$ luvcview -L
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 160, height = 120 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 176, height = 144 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 352, height = 288 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 800, height = 600 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 960, height = 720 }
        Time interval between frame: 1/15, 1/10, 1/5,
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 160, height = 120 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 176, height = 144 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 352, height = 288 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 800, height = 600 }
        Time interval between frame: 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 960, height = 720 }
        Time interval between frame: 1/10, 1/5,
{ discrete: width = 1600, height = 1200 }
        Time interval between frame: 1/5,


[sergeil at homedesk ~]$ luvcview -l
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean 3=Menu 
4=Button)
V4L2_CID_BASE         (predefined controls):
 index:9963776    name:Brightness                       type:1 min:0     
max:255   step:1     def:128   now:128
 index:9963777    name:Contrast                         type:1 min:0     
max:255   step:1     def:32    now:32
 index:9963778    name:Saturation                       type:1 min:0     
max:255   step:1     def:32    now:34
 index:9963795    name:Gain                             type:1 min:0     
max:255   step:1     def:0     now:234
V4L2_CID_PRIVATE_BASE (driver specific controls):
 index:134217728  name:Backlight Compensation           type:1 min:0     
max:2     step:1     def:1     now:1
 index:134217729  name:Power Line Frequency             type:3 min:0     
max:2     step:1     def:2     now:2
  Menu items:
  index:0 name:Disabled
  index:1 name:50 Hz
  index:2 name:60 Hz
 index:134217730  name:Sharpness                        type:1 min:0     
max:255   step:1     def:224   now:224


[sergeil at homedesk ~]$ luvcview -s 800x600 -f yuv -i 1/25
luvcview version 0.2.1
 size width: 800 height: 600
 interval: 1 fps
Video driver: x11
A window manager is available
video /dev/video0
 Clean Up done Quit

[sergeil at homedesk ~]$ luvcview -s 800x600 -f yuv -i 25
luvcview version 0.2.1
 size width: 800 height: 600
 interval: 25 fps
Video driver: x11
A window manager is available
video /dev/video0
 Clean Up done Quit

[sergeil at homedesk ~]$ luvcview -s 640x480 -f yuv -i 30
luvcview version 0.2.1
 size width: 640 height: 480
 interval: 30 fps
Video driver: x11
A window manager is available
video /dev/video0
                          

*Physically, FPS is the same **(5 FPS in any mode)*.

-- 
There is a great difference between
"be involved" and "be committed".
Usually we are committed...


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080114/76d0ba09/attachment.html>

From andrewfenn at gmail.com  Mon Jan 14 20:53:38 2008
From: andrewfenn at gmail.com (Andrew Fenn)
Date: Mon, 14 Jan 2008 19:53:38 +0000
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <20080114184515.GA30445@kolmann.at>
References: <20071204195929.GA1101@kolmann.at>
	<200712052331.59034.laurent.pinchart@skynet.be>
	<20071206065637.GA26483@kolmann.at>
	<200712070137.46488.laurent.pinchart@skynet.be>
	<20080114184515.GA30445@kolmann.at>
Message-ID: <b594ca9d0801141153k593f34fbr42b22f83a196d480@mail.gmail.com>

My Logitech QC 9000 still crashes in 166. Happened today after I started the
camera in skype with bad lighting.

On 14/01/2008, Philipp Kolmann <philipp at kolmann.at> wrote:
>
> Hi,
>
> On Fri, Dec 07, 2007 at 01:37:46AM +0100, Laurent Pinchart wrote:
> > - The uvcvideo driver could stop streaming, renegotiate the parameters
> and
> > restart streaming. The webcam might still crash as the cause of the
> crash is
> > not understood.
>
> your change in rev 166 makes skype work for me also in bad light
> conditions
> now.
>
> Thanks
> Philipp
>
> --
> The more I learn about people, the more I like my dog!
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080114/586c7c5c/attachment.html>

From richard at 2008.atterer.net  Mon Jan 14 21:22:29 2008
From: richard at 2008.atterer.net (Richard Atterer)
Date: Mon, 14 Jan 2008 21:22:29 +0100
Subject: [Linux-uvc-devel] 046d:0990, QC Pro 9000,  5 FPS in any mode
In-Reply-To: <478BAEF5.4020502@gmail.com>
References: <478BAEF5.4020502@gmail.com>
Message-ID: <20080114202229.GA32028@vilya>

For more FPS, you either need lots of light, or you need to switch off auto 
exposure and set the exposure value yourself.

Cheers,

  Richard

-- 
  __   _
  |_) /|  Richard Atterer     |  GnuPG key: 888354F7
  | \/?|  http://atterer.net  |  08A9 7B7D 3D13 3EF2 3D25  D157 79E6 F6DC 8883 54F7
  ? '` ?


From gabrisa at szfki.hu  Mon Jan 14 21:34:35 2008
From: gabrisa at szfki.hu (Aurel Gabris)
Date: Mon, 14 Jan 2008 21:34:35 +0100 (CET)
Subject: [Linux-uvc-devel] ViewSonic VX2255WMB (Chicony 1.3M 04f2:b021)
Message-ID: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>

Hi all,

I have a ViewSonic monitor that has a built-in webcam. It appears as a usb 
device, with ID 04f2:b021. Some other Chicony webcams are tagged as 
supported but this one isn't. Yet, I've come across only one previous 
posting about this webcam: he was given advice on how to load the module. 
He didn't reply to that advice, so we don't know if it worked for him or 
not...

I have successfully compiled and configured my uvc module, but not 
everything is working.

I can use luvcview and have pretty good picture. There are some error 
messages with each frame, also the produced jpeg has "Invalid SOS 
parameters for sequential JPEG." But it seems these messages can be 
ignored.

However, when I try to use it with amsn things turn more gloomy. If I have 
amsn configured to use my old usb webcam (uses gspca) it starts well, and 
in the camera selection panel I see the ViewSonic 1.3M webcam, and 
selecting it also gives a nice picture -- like in luvcview. But right 
after closing this video config window, and at any subsequent start of the 
application there seems to be some (re)initialization problem, and amsn no 
longer works. It terminates with the following rror messages:

ioctl:  VIDIOC_S_CTRL(id=9963776;value=25536): Input/output error
ioctl:  VIDIOC_S_CTRL(id=9963777;value=32768): Input/output error
Not a JPEG file: starts with 0x9a 0x67
Oops: malloc_video_bufs is 1 (expected 0) 
[utils/linux/capture/libng/grab-ng.c:malloc_bufs_check:235]
Oops: processes is 1 (expected 0) 
[utils/linux/capture/libng/convert.c:process_check:179]

The amsn developers say it must be a bug in the driver module, and aren't very 
enthusiastic in checking their code.

I wonder if this is a known problem with this or other webcams? Does 
anyone have an idea how to work around this? I'd even be happy to have 
some suggestions which applications to use to test the webcam, to be able 
to compile more concise bug report...

Thanks,
   Aurel

---------------------------------------------------------
Web:    http://www.szfki.hu/~gabrisa
"Ha ezt el tudja olvasni, minden bizonnyal tud magyarul."
---------------------------------------------------------


From oliver at neukum.org  Mon Jan 14 22:15:07 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Mon, 14 Jan 2008 22:15:07 +0100
Subject: [Linux-uvc-devel] Powering off 046d:08c6
In-Reply-To: <1200227317.13818.5.camel@speck.logular.com>
References: <1199955500.5487.4.camel@speck.logular.com>
	<200801131219.56919.oliver@neukum.org>
	<1200227317.13818.5.camel@speck.logular.com>
Message-ID: <200801142215.09005.oliver@neukum.org>

Am Sonntag, 13. Januar 2008 13:28:37 schrieb Jason Grant:
> > > I also had to blacklist snd_usb_audio in my modprobe.conf for this to
> > > work.
> > 
> > I do have a patch for the audio driver but it is under development.
> > ?
> 
> Is there another mailing list where you will be reporting status?

I am looking for testers. The patches will be posted to
linux-usb at vger.kernel.org

	Regards
		Oliver


From mathewss at nutech.com  Tue Jan 15 00:06:35 2008
From: mathewss at nutech.com (sean mathews)
Date: Mon, 14 Jan 2008 15:06:35 -0800
Subject: [Linux-uvc-devel] support for eMPIA 2761
In-Reply-To: <200801141026.33340.mathewss@nutech.com>
References: <200801111916.51388.mathewss@nutech.com>
	<200801121928.20537.laurent.pinchart@skynet.be>
	<200801141026.33340.mathewss@nutech.com>
Message-ID: <200801141506.36026.mathewss@nutech.com>

Sorry about that last post it was the wrong Device ID..

here is the corrected dump

lsusb -d eb1a:2750 -v

Bus 002 Device 003: ID eb1a:2750 eMPIA Technology, Inc.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  idVendor           0xeb1a eMPIA Technology, Inc.
  idProduct          0x2750
  bcdDevice            1.00
  iManufacturer           0
  iProduct                0
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          249
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0ad4  2x 724 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       4
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1300  3x 768 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       5
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x135c  3x 860 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       6
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x13c4  3x 964 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       7
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol    255
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              11
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1


From laurent.pinchart at skynet.be  Tue Jan 15 01:57:25 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 01:57:25 +0100
Subject: [Linux-uvc-devel] support for eMPIA 2761
In-Reply-To: <200801141506.36026.mathewss@nutech.com>
References: <200801111916.51388.mathewss@nutech.com>
	<200801141026.33340.mathewss@nutech.com>
	<200801141506.36026.mathewss@nutech.com>
Message-ID: <200801150157.25187.laurent.pinchart@skynet.be>

Hi Sean,

On Tuesday 15 January 2008, sean mathews wrote:
> Sorry about that last post it was the wrong Device ID..
>
> here is the corrected dump
>
> lsusb -d eb1a:2750 -v
[snip]

You're right, it doesn't look like a UVC device. I'm afraid there's not much I 
can do :-/

Best regards,

Laurent Pinchart


From clists at perrin.socsci.unc.edu  Tue Jan 15 01:54:59 2008
From: clists at perrin.socsci.unc.edu (Andrew Perrin)
Date: Mon, 14 Jan 2008 19:54:59 -0500 (EST)
Subject: [Linux-uvc-devel] Skype w/ logitech quickcam 9000 pro
Message-ID: <Pine.LNX.4.64.0801141953490.25967@perrin.socsci.unc.edu>

I have a quickcam 9000 pro working fine with luvcview, but it gives the 
famous "black rectangle" with Skype. This is the latest (166) rev. of 
uvcvideo. These messages are in the log when I try:

Jan 14 19:53:08 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f74175c0 
(#81) state 2
Jan 14 19:53:22 joehill kernel: uvcvideo: Failed to submit URB 0 (-28).
Jan 14 19:53:30 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f7417600 
(#81) state 2



Thoughts?

Thanks.

----------------------------------------------------------------------
Andrew J Perrin - andrew_perrin (at) unc.edu - http://perrin.socsci.unc.edu
Associate Professor of Sociology; Book Review Editor, _Social Forces_
University of North Carolina - CB#3210, Chapel Hill, NC 27599-3210 USA




From laurent.pinchart at skynet.be  Tue Jan 15 02:16:53 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 02:16:53 +0100
Subject: [Linux-uvc-devel] ViewSonic VX2255WMB (Chicony 1.3M 04f2:b021)
In-Reply-To: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
References: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
Message-ID: <200801150216.53104.laurent.pinchart@skynet.be>

Hi Aurel,

On Monday 14 January 2008, Aurel Gabris wrote:
> Hi all,
>
> I have a ViewSonic monitor that has a built-in webcam. It appears as a usb
> device, with ID 04f2:b021. Some other Chicony webcams are tagged as
> supported but this one isn't. Yet, I've come across only one previous
> posting about this webcam: he was given advice on how to load the module.
> He didn't reply to that advice, so we don't know if it worked for him or
> not...
>
> I have successfully compiled and configured my uvc module, but not
> everything is working.
>
> I can use luvcview and have pretty good picture. There are some error
> messages with each frame, also the produced jpeg has "Invalid SOS
> parameters for sequential JPEG." But it seems these messages can be
> ignored.

That's a good start. Not sure about the invalid SOS parameters, it might be a 
warning only.

> However, when I try to use it with amsn things turn more gloomy. If I have
> amsn configured to use my old usb webcam (uses gspca) it starts well, and
> in the camera selection panel I see the ViewSonic 1.3M webcam, and
> selecting it also gives a nice picture -- like in luvcview. But right
> after closing this video config window, and at any subsequent start of the
> application there seems to be some (re)initialization problem, and amsn no
> longer works. It terminates with the following rror messages:
>
> ioctl:  VIDIOC_S_CTRL(id=9963776;value=25536): Input/output error
> ioctl:  VIDIOC_S_CTRL(id=9963777;value=32768): Input/output error
> Not a JPEG file: starts with 0x9a 0x67
> Oops: malloc_video_bufs is 1 (expected 0)
> [utils/linux/capture/libng/grab-ng.c:malloc_bufs_check:235]
> Oops: processes is 1 (expected 0)
> [utils/linux/capture/libng/convert.c:process_check:179]
>
> The amsn developers say it must be a bug in the driver module, and aren't
> very enthusiastic in checking their code.
>
> I wonder if this is a known problem with this or other webcams? Does
> anyone have an idea how to work around this? I'd even be happy to have
> some suggestions which applications to use to test the webcam, to be able
> to compile more concise bug report...

Could you please check the kernel log for error messages generated by the 
driver ?

I would also appreciate if you could post the output of lsusb -v (using 
usbutils 0.72 or newer).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 02:28:36 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 02:28:36 +0100
Subject: [Linux-uvc-devel] Skype w/ logitech quickcam 9000 pro
In-Reply-To: <Pine.LNX.4.64.0801141953490.25967@perrin.socsci.unc.edu>
References: <Pine.LNX.4.64.0801141953490.25967@perrin.socsci.unc.edu>
Message-ID: <200801150228.36247.laurent.pinchart@skynet.be>

Hi Andrew,

On Tuesday 15 January 2008, Andrew Perrin wrote:
> I have a quickcam 9000 pro working fine with luvcview, but it gives the
> famous "black rectangle" with Skype. This is the latest (166) rev. of
> uvcvideo. These messages are in the log when I try:
>
> Jan 14 19:53:08 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f74175c0
> (#81) state 2
> Jan 14 19:53:22 joehill kernel: uvcvideo: Failed to submit URB 0 (-28).
> Jan 14 19:53:30 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f7417600
> (#81) state 2

-28 is -ENOSPC. It means using the device would exceed the available USB bus 
bandwidth. If your webcam is plugged into a hub try moving it to a root port. 
Make sure you're using an EHCI controller.

Best regards,

Laurent Pinchart


From clists at perrin.socsci.unc.edu  Tue Jan 15 02:55:21 2008
From: clists at perrin.socsci.unc.edu (Andrew Perrin)
Date: Mon, 14 Jan 2008 20:55:21 -0500 (EST)
Subject: [Linux-uvc-devel] Skype w/ logitech quickcam 9000 pro
In-Reply-To: <200801150228.36247.laurent.pinchart@skynet.be>
References: <Pine.LNX.4.64.0801141953490.25967@perrin.socsci.unc.edu>
	<200801150228.36247.laurent.pinchart@skynet.be>
Message-ID: <Pine.LNX.4.64.0801142053130.25967@perrin.socsci.unc.edu>

On Tue, 15 Jan 2008, Laurent Pinchart wrote:

> Hi Andrew,
>
> On Tuesday 15 January 2008, Andrew Perrin wrote:
>> I have a quickcam 9000 pro working fine with luvcview, but it gives the
>> famous "black rectangle" with Skype. This is the latest (166) rev. of
>> uvcvideo. These messages are in the log when I try:
>>
>> Jan 14 19:53:08 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f74175c0
>> (#81) state 2
>> Jan 14 19:53:22 joehill kernel: uvcvideo: Failed to submit URB 0 (-28).
>> Jan 14 19:53:30 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f7417600
>> (#81) state 2
>
> -28 is -ENOSPC. It means using the device would exceed the available USB bus
> bandwidth. If your webcam is plugged into a hub try moving it to a root port.
> Make sure you're using an EHCI controller.
>
> Best regards,
>
> Laurent Pinchart
>

Very interesting, and thanks for your quick reply. Plugging it directly 
into the USB port (instead of through a hub) makes both luvcview *and 
Skype* give a very flickery, but recognizable, image. luvcview dies after 
a few seconds with the result:

Ignoring empty buffer ...
Ignoring empty buffer ...
Ignoring empty buffer ...
Ignoring empty buffer ...
Unable to dequeue buffer (22).
Error grabbing
  Clean Up done Quit

...while Skype just keeps the flickery image on.  /var/log/syslog 
contains:

Jan 14 20:51:15 joehill kernel: usb 1-6: new high speed USB device using ehci_hcd and address 9
Jan 14 20:51:16 joehill kernel: usb 1-6: configuration #1 chosen from 1 choice
Jan 14 20:51:16 joehill kernel: uvcvideo: Found UVC 1.00 device <unnamed> (046d:0990)
Jan 14 20:51:48 joehill kernel: usb 1-6: USB disconnect, address 9
Jan 14 20:52:04 joehill kernel: usb 1-6: new high speed USB device using ehci_hcd and address 10
Jan 14 20:52:04 joehill kernel: usb 1-6: device descriptor read/all, error -71
Jan 14 20:52:04 joehill kernel: usb 1-6: new high speed USB device using ehci_hcd and address 11
Jan 14 20:52:05 joehill kernel: usb 1-6: configuration #1 chosen from 1 choice
Jan 14 20:52:05 joehill kernel: uvcvideo: Found UVC 1.00 device <unnamed> (046d:0990)
Jan 14 20:52:11 joehill kernel: uvcvideo: Failed to query (131) UVC control 1 (unit 0) : -71 (exp. 26).
Jan 14 20:52:15 joehill kernel: uvcvideo: Failed to query (131) UVC control 1 (unit 0) : -71 (exp. 26).



----------------------------------------------------------------------
Andrew J Perrin - andrew_perrin (at) unc.edu - http://perrin.socsci.unc.edu
Associate Professor of Sociology; Book Review Editor, _Social Forces_
University of North Carolina - CB#3210, Chapel Hill, NC 27599-3210 USA






From sboyce at blueyonder.co.uk  Tue Jan 15 04:07:01 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Tue, 15 Jan 2008 03:07:01 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101 problem
	with luvcview
Message-ID: <478C2355.1000802@blueyonder.co.uk>

  # luvcview -l
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 16.
  Init v4L2 failed !! exit fatal

# luvcview -L
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 352, height = 288 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 320, height = 240 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 176, height = 144 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 160, height = 120 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,


# lsmod|grep uvc
uvcvideo               68740  1
compat_ioctl32         25728  1 uvcvideo
videodev               44160  2 uvcvideo
v4l1_compat            28932  2 uvcvideo,videodev
v4l2_common            36608  3 uvcvideo,compat_ioctl32,videodev
usbcore               164256  5 uvcvideo,usbhid,ohci_hcd,ehci_hcd

openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
Help appreciated.
Regards
Sid.
-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From rumi_ml at rtfm.hu  Tue Jan 15 05:55:15 2008
From: rumi_ml at rtfm.hu (RUMI Szabolcs)
Date: Tue, 15 Jan 2008 05:55:15 +0100
Subject: [Linux-uvc-devel] QC Fusion (046d:08c1) inconsistent buggyness?
In-Reply-To: <200801112138.57032.laurent.pinchart@skynet.be>
References: <20080110013851.2a0490db.rumi_ml@rtfm.hu>
	<200801102134.13646.laurent.pinchart@skynet.be>
	<20080111044113.a338a270.rumi_ml@rtfm.hu>
	<200801112138.57032.laurent.pinchart@skynet.be>
Message-ID: <20080115055515.9352819d.rumi_ml@rtfm.hu>

Hi Laurent,

On Fri, 11 Jan 2008 21:38:56 +0100
Laurent Pinchart <laurent.pinchart at skynet.be> wrote:

> > > I plan to fix it, probably by disallowing frame rate changes while
> > > streaming.
> >
> > I'd be more than happy to test that fix you are planning... ;-)
> 
> Then grab the latest SVN version. I've just committed a patch that
> disallows changing the frame format or the frame size while streaming.

I have tested svn version 166. The results are the following:

- luvcview works after proper detection as almost always.

- Skype turned on camera but failed to get picture when started after luvcview.

- luvcview failed when started again after Skype failed as above.

luvcview stderr: "unable to set format: 5."
dmesg:
uvcvideo: Failed to query (130) UVC control 3 (unit 2) : -32 (exp. 2).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -75 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).

- after some rmmod/insmod cycles and proper redetection I've started
Skype without starting any other programs in between. It started to
work but the picture was distorted, to be more exact, it was stretched
to about 120% of the original in the Y (vertical) direction from the
center of the image but basically your code change seems to work! :)

I have also tested what luvcview controls work and how:

brightness - works
contrast - works
saturation - works
gain - works
sharpness - setting works but no apparent effect
gamma - adjusted down with effect but then could not be adjusted up anymore
reset to default - works sometimes (only when camera is in a workable state?)
pan - ioctl querycontrol error 22
tilt - ioctl querycontrol error 22
pan/tilt reset - ioctl querycontrol error 22
switch light freq filter - works
exposure - ioctl set control error
auto exposure - setting works but apparently always remains on
white balance - ioctl set control error
auto white balance - setting works but apparently always remains on

> The driver already includes workarounds for various broken devices.
> Have a look at the UVC_QUIRK_* macros in uvcvideo.h and how they are
> associated with devices in uvc_driver.c.
> 
> For early Logitech devices, however, no satisfying workaround has
> been find so far.

I see, what I was suggesting wasn't device specific: it's about not having
to dig up the sources to enable/disable a hack but to be able to control
them on the module parameter level.

I don't have a clue but what I can imagine as a solution for the QC Fusion
in particular is that it should be detected somehow when the camera gets
into an unworkable state (failed uvc control queries or failed initialization)
and then it should be reset or reenumerated. Basically doing automatically
what one is doing by hand using rmmod/insmod cycles when it's apparent
from the dmesg that the camera is probably unworkable...

By the way recently I have seen various cameras working under
Windows and apparently several of them are buggy enough to freeze
or get unworkable within a certain amount of time of submitting
video. Even original OEM Windows drivers seem to reset these cams
repeatedly (at least it seems like it) as a solution which results
in temporary video breakages in a video enabled Skype connection.
So it's not unique to the QC Fusion and Linux I guess...

Thanks!

Best regards,
Sab


From t.st1 at gmx.net  Tue Jan 15 08:07:25 2008
From: t.st1 at gmx.net (Tom St)
Date: Tue, 15 Jan 2008 08:07:25 +0100
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <478C2355.1000802@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
Message-ID: <478C5BAD.3040808@gmx.net>

Hi Sid,
Did you try to invoke luvcview with this parameter:
# luvcview -f yuv
to enable YUYV streaming mode. Your camera seems to do not support 
JPEG-format.

Regards,
Tom

Sid Boyce schrieb:
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }



From herton at mandriva.com.br  Tue Jan 15 14:42:23 2008
From: herton at mandriva.com.br (Herton Ronaldo Krzesinski)
Date: Tue, 15 Jan 2008 11:42:23 -0200
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801102030.32842.laurent.pinchart@skynet.be>
References: <200712281340.17571.herton@mandriva.com.br>
	<5f52f6d70712290413s5ce515f2q88924e604fd73b5d@mail.gmail.com>
	<200801102030.32842.laurent.pinchart@skynet.be>
Message-ID: <200801151142.24985.herton@mandriva.com.br>

Em Thursday 10 January 2008 17:30:32 Laurent Pinchart escreveu:
> Hi Claudio,
>
> On Saturday 29 December 2007, Claudio Matsuoka wrote:
> > On Dec 28, 2007 9:26 PM, Laurent Pinchart <laurent.pinchart at skynet.be>
>
> wrote:
> > > I have a pending patch that passes the uvc_video_device structure to
> > > URB completion callbacks instead of the uvc_video_queue structure. This
> > > should take care of the problem you solved by setting
> > > dev->udev->quirks.
> >
> > Could you send me that patch so I can rework the Syntek quirk to use it?
>
> I've just committed it to SVN.
>
> Best regards,
>
> Laurent Pinchart

Hi Laurent, thanks for the commit and advice. We played with the webcam again 
(sorry for delay) and we found out that it isn't really reporting the FID 
bit, but only end of frame marker (EOF). This is strange indeed, as from what 
I understand from UVC spec FID is required while EOF is optional. I reworked 
the quirk that Claudio made against revision 166 from svn, but now using the 
EOF to sync the stream (the previous quirk was ok, but on laggy 
communication, like using to transmit a video stream over internet etc., the 
frames would overlap etc. resulting in many display issues):

The Syntek 174f:5212 UVC camera in HP Spartan/Leon laptops don't report
FID bit for each frame, but report EOF. Add quirk to use EOF to synchronize
frames and use it.

Signed-off-by: Herton Ronaldo Krzesinski <herton at mandriva.com>
Signed-off-by: Claudio Matsuoka <cmatsuoka at gmail.com>

diff -Naurp uvc.orig/uvc_driver.c uvc/uvc_driver.c
--- uvc.orig/uvc_driver.c	2008-01-11 11:14:27.000000000 -0200
+++ uvc/uvc_driver.c	2008-01-14 16:22:15.000000000 -0200
@@ -1658,6 +1658,16 @@ static int uvc_resume(struct usb_interfa
  * though they are compliant.
  */
 static struct usb_device_id uvc_ids[] = {
+	/* Syntek (HP Spartan) */
+	{ .match_flags		= USB_DEVICE_ID_MATCH_DEVICE
+				| USB_DEVICE_ID_MATCH_INT_INFO,
+	  .idVendor		= 0x174f,
+	  .idProduct		= 0x5212,
+	  .bInterfaceClass	= USB_CLASS_VIDEO,
+	  .bInterfaceSubClass	= 1,
+	  .bInterfaceProtocol	= 0,
+	  .driver_info		= UVC_QUIRK_EOF_SYNC
+	},
 	/* ALi M5606 (Clevo M540SR) */
 	{ .match_flags		= USB_DEVICE_ID_MATCH_DEVICE
 				| USB_DEVICE_ID_MATCH_INT_INFO,
diff -Naurp uvc.orig/uvc_video.c uvc/uvc_video.c
--- uvc.orig/uvc_video.c	2008-01-11 11:14:27.000000000 -0200
+++ uvc/uvc_video.c	2008-01-14 16:32:04.000000000 -0200
@@ -286,6 +286,12 @@ static int uvc_video_decode_start(struct
 
 	fid = data[1] & UVC_STREAM_FID;
 
+	/* Some webcams don't report FID as they should. For now use EOF
+	 * marker as a workaround
+	 */
+	if (video->dev->quirks & UVC_QUIRK_EOF_SYNC)
+		fid = !!(data[1] & UVC_STREAM_EOF);
+
 	/* Store the payload FID bit and return immediately when the buffer is
 	 * NULL.
 	 */
diff -Naurp uvc.orig/uvcvideo.h uvc/uvcvideo.h
--- uvc.orig/uvcvideo.h	2008-01-11 11:14:27.000000000 -0200
+++ uvc/uvcvideo.h	2008-01-14 16:33:01.000000000 -0200
@@ -313,6 +313,7 @@ struct uvc_xu_control {
 #define UVC_QUIRK_PROBE_MINMAX		0x00000002
 #define UVC_QUIRK_PROBE_EXTRAFIELDS	0x00000004
 #define UVC_QUIRK_BUILTIN_ISIGHT	0x00000008
+#define UVC_QUIRK_EOF_SYNC		0x00000010
 
 /* Format flags */
 #define UVC_FMT_FLAG_COMPRESSED		0x00000001

And attached is the kernel log output without the quirk above enabled as
requested, I placed printks in the start of each decode function (
printing header info in hexa). Note that it starts decoding the first
frame, but as it doesn't sees FID after first frame it just gets stuck at
uvc_video_decode_start (and FID is never reported, but EOF is).

-- 
[]'s
Herton
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvcvideo.log.gz
Type: application/x-gzip
Size: 1031 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080115/239e1143/attachment.bin>

From bartje.verbruggen at gmail.com  Tue Jan 15 15:30:33 2008
From: bartje.verbruggen at gmail.com (Bart Verbruggen)
Date: Tue, 15 Jan 2008 15:30:33 +0100
Subject: [Linux-uvc-devel] Will there be support for the 0c45:624f Microdia
Message-ID: <478CC389.3060309@gmail.com>

Hi,

I have a laptop with integrated webcam (asus W7j), but I can't seem to
get the webcam to work. Is there any way this webcam will be supported
in the future?

TIA




From tnetter at ifi.uzh.ch  Tue Jan 15 15:50:57 2008
From: tnetter at ifi.uzh.ch (Thomas Netter)
Date: Tue, 15 Jan 2008 15:50:57 +0100
Subject: [Linux-uvc-devel] Debugging UVC + Sanyo Xacti cameras
In-Reply-To: <200801132245.48079.laurent.pinchart@skynet.be>
References: <44759.130.60.75.225.1198150630.squirrel@bela.ifi.unizh.ch>
	<200712282328.04081.laurent.pinchart@skynet.be>
	<47826AC8.8070508@ifi.uzh.ch>
	<200801132245.48079.laurent.pinchart@skynet.be>
Message-ID: <478CC851.2010000@ifi.uzh.ch>

Hi Laurent,

Many thanks for attempting a patch. I patched it against uvc-r166. 
Didn't solve the problem. Here's the output:

--> Connect camera to USB port. Put camera into PC CAMERA mode.

Syslog:


Jan 15 15:28:25 zadig kernel: [20530.696000] usb 7-1: new high speed USB 
device using ehci_hcd and address 6
Jan 15 15:28:26 zadig kernel: [20530.828000] usb 7-1: configuration #1 
chosen from 1 choice
Jan 15 15:28:26 zadig kernel: [20530.828000] uvcvideo: Found UVC 1.00 
device SANYO Digital Camera (0474:0241)
Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.016313] 
nm_hal_device_added(): New device added (hal udi is 
'/org/freedesktop/Hal/devices/usb_device_474_241_000095970948').
Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.102361] 
nm_hal_device_added(): New device added (hal udi is 
'/org/freedesktop/Hal/devices/usb_device_ffffffff_ffffffff_noserial').
Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.193626] 
nm_hal_device_added(): New device added (hal udi is 
'/org/freedesktop/Hal/devices/usb_device_ffffffff_ffffffff_noserial_video4linux'). 

Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.654525] 
nm_hal_device_added(): New device added (hal udi is 
'/org/freedesktop/Hal/devices/usb_device_474_241_000095970948_if1').
Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.684166] 
nm_hal_device_added(): New device added (hal udi is 
'/org/freedesktop/Hal/devices/usb_device_474_241_000095970948_usbraw').


--> Start luvcview:

sudo ./luvcview
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
G_FMT -1 0 0  0 0 0 134612088
prepare S_FMT 1 320  240 1196444237 0 0

--> Image from camera is visible
---> Press Q

Closing vd->fd
 Clean Up done Quit

--> Start luvcview again:

 sudo ./luvcview
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
G_FMT -1 0 0  0 0 0 134612088
prepare S_FMT 1 320  240 1196444237 0 0
Unable to set format: 5.
 Init v4L2 failed !! exit fatal

Nothing more is printed in /var/log/syslog or messages.

Cheers,

-Thomas



From sboyce at blueyonder.co.uk  Tue Jan 15 18:18:54 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Tue, 15 Jan 2008 17:18:54 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
	problem with luvcview
In-Reply-To: <478C2355.1000802@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
Message-ID: <478CEAFE.2060901@blueyonder.co.uk>

Sid Boyce wrote:
> # luvcview -l
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 16.
> Init v4L2 failed !! exit fatal
> 
> # luvcview -L
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> /dev/video0 does not support read i/o
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 352, height = 288 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 320, height = 240 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 176, height = 144 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 160, height = 120 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> 
> 
> # lsmod|grep uvc
> uvcvideo 68740 1
> compat_ioctl32 25728 1 uvcvideo
> videodev 44160 2 uvcvideo
> v4l1_compat 28932 2 uvcvideo,videodev
> v4l2_common 36608 3 uvcvideo,compat_ioctl32,videodev
> usbcore 164256 5 uvcvideo,usbhid,ohci_hcd,ehci_hcd
> 
> openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
> Help appreciated.
> Regards
> Sid.

Checked out my Logitech QuickCam Pro 9000 on my other x86_64 box - skype 
and luvcview - and it's fine, so there must be a problem with the driver 
with respect to the CrystalEye.
Regards
Sid.
-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From laurent.pinchart at skynet.be  Tue Jan 15 20:24:31 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 20:24:31 +0100
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
	problem with luvcview
In-Reply-To: <478CEAFE.2060901@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478CEAFE.2060901@blueyonder.co.uk>
Message-ID: <200801152024.31499.laurent.pinchart@skynet.be>

Hi Sid,

On Tuesday 15 January 2008, Sid Boyce wrote:
> Sid Boyce wrote:
> > # luvcview -l
> > luvcview version 0.2.1
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> > Unable to set format: 16.
> > Init v4L2 failed !! exit fatal
> >
> > # luvcview -L
> > luvcview version 0.2.1
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> > /dev/video0 does not support read i/o
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 640, height = 480 }
> > Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> > { discrete: width = 352, height = 288 }
> > Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> > { discrete: width = 320, height = 240 }
> > Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> > { discrete: width = 176, height = 144 }
> > Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> > { discrete: width = 160, height = 120 }
> > Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >
> >
> > # lsmod|grep uvc
> > uvcvideo 68740 1
> > compat_ioctl32 25728 1 uvcvideo
> > videodev 44160 2 uvcvideo
> > v4l1_compat 28932 2 uvcvideo,videodev
> > v4l2_common 36608 3 uvcvideo,compat_ioctl32,videodev
> > usbcore 164256 5 uvcvideo,usbhid,ohci_hcd,ehci_hcd
> >
> > openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
> > Help appreciated.
> > Regards
> > Sid.
>
> Checked out my Logitech QuickCam Pro 9000 on my other x86_64 box - skype
> and luvcview - and it's fine, so there must be a problem with the driver
> with respect to the CrystalEye.

-16 means -EBUSY. The camera is probably already in use by another 
application.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 20:28:32 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 20:28:32 +0100
Subject: [Linux-uvc-devel] Will there be support for the 0c45:624f
	Microdia
In-Reply-To: <478CC389.3060309@gmail.com>
References: <478CC389.3060309@gmail.com>
Message-ID: <200801152028.32502.laurent.pinchart@skynet.be>

On Tuesday 15 January 2008, Bart Verbruggen wrote:
> Hi,
>
> I have a laptop with integrated webcam (asus W7j), but I can't seem to
> get the webcam to work. Is there any way this webcam will be supported
> in the future?

The UVC driver supports UVC-compatible cameras only. As your webcam isn't UVC 
compatible, it won't be supported by the UVC driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 20:38:13 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 20:38:13 +0100
Subject: [Linux-uvc-devel] Skype w/ logitech quickcam 9000 pro
In-Reply-To: <Pine.LNX.4.64.0801142053130.25967@perrin.socsci.unc.edu>
References: <Pine.LNX.4.64.0801141953490.25967@perrin.socsci.unc.edu>
	<200801150228.36247.laurent.pinchart@skynet.be>
	<Pine.LNX.4.64.0801142053130.25967@perrin.socsci.unc.edu>
Message-ID: <200801152038.13175.laurent.pinchart@skynet.be>

Hi Andrew,

On Tuesday 15 January 2008, Andrew Perrin wrote:
> On Tue, 15 Jan 2008, Laurent Pinchart wrote:
> > Hi Andrew,
> >
> > On Tuesday 15 January 2008, Andrew Perrin wrote:
> >> I have a quickcam 9000 pro working fine with luvcview, but it gives the
> >> famous "black rectangle" with Skype. This is the latest (166) rev. of
> >> uvcvideo. These messages are in the log when I try:
> >>
> >> Jan 14 19:53:08 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f74175c0
> >> (#81) state 2
> >> Jan 14 19:53:22 joehill kernel: uvcvideo: Failed to submit URB 0 (-28).
> >> Jan 14 19:53:30 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f7417600
> >> (#81) state 2
> >
> > -28 is -ENOSPC. It means using the device would exceed the available USB
> > bus bandwidth. If your webcam is plugged into a hub try moving it to a
> > root port. Make sure you're using an EHCI controller.
> >
> > Best regards,
> >
> > Laurent Pinchart
>
> Very interesting, and thanks for your quick reply. Plugging it directly
> into the USB port (instead of through a hub) makes both luvcview *and
> Skype* give a very flickery, but recognizable, image. luvcview dies after
> a few seconds with the result:
>
> Ignoring empty buffer ...
> Ignoring empty buffer ...
> Ignoring empty buffer ...
> Ignoring empty buffer ...
> Unable to dequeue buffer (22).
> Error grabbing
>   Clean Up done Quit
>
> ...while Skype just keeps the flickery image on.  /var/log/syslog
> contains:
>
> usb 1-6: new high speed USB device using ehci_hcd and address 9
> usb 1-6:  configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:0990)
> usb 1-6: USB disconnect, address 9
> usb 1-6: new high speed USB device using ehci_hcd and address 10
> usb 1-6: device descriptor read/all, error -71

Your webcam seem to be very flaky. Failing to respond to the first GET 
DESCRIPTOR request with -71 means serious hardware trouble.

> usb 1-6: new high speed USB device using ehci_hcd and address 11
> usb 1-6: configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:0990)
> uvcvideo: Failed to query (131) UVC control 1 (unit 0) : -71 (exp. 26).
> uvcvideo: Failed to query (131) UVC control 1 (unit 0) : -71 (exp. 26).

You should check your cables. Is your computer in an extremely noisy 
environment (electrically speaking) ? Do you experience the same kind of 
trouble with other USB devices ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 20:49:22 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 20:49:22 +0100
Subject: [Linux-uvc-devel] QC Fusion (046d:08c1) inconsistent buggyness?
In-Reply-To: <20080115055515.9352819d.rumi_ml@rtfm.hu>
References: <20080110013851.2a0490db.rumi_ml@rtfm.hu>
	<200801112138.57032.laurent.pinchart@skynet.be>
	<20080115055515.9352819d.rumi_ml@rtfm.hu>
Message-ID: <200801152049.22942.laurent.pinchart@skynet.be>

Hi,

On Tuesday 15 January 2008, RUMI Szabolcs wrote:
> On Fri, 11 Jan 2008 21:38:56 +0100
> Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > > > I plan to fix it, probably by disallowing frame rate changes while
> > > > streaming.
> > >
> > > I'd be more than happy to test that fix you are planning... ;-)
> >
> > Then grab the latest SVN version. I've just committed a patch that
> > disallows changing the frame format or the frame size while streaming.
>
> I have tested svn version 166. The results are the following:
>
> - luvcview works after proper detection as almost always.
>
> - Skype turned on camera but failed to get picture when started after
> luvcview.
>
> - luvcview failed when started again after Skype failed as above.
>
> luvcview stderr: "unable to set format: 5."
> dmesg:
> uvcvideo: Failed to query (130) UVC control 3 (unit 2) : -32 (exp. 2).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -75 (exp. 26).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).

Good old Logitech firmware bug :-/

To be completely fair we should rename it the Logitech+SPCA bug as that part 
of the firmware was provided by the chip vendor. Logitech is "only" 
responsible for not testing the devices enough with Linux.

> - after some rmmod/insmod cycles and proper redetection I've started
> Skype without starting any other programs in between. It started to
> work but the picture was distorted, to be more exact, it was stretched
> to about 120% of the original in the Y (vertical) direction from the
> center of the image but basically your code change seems to work! :)

I'm pretty sure that's not the driver's fault :-) Skype might be stretching 
the picture to fit the fixed-size window.

> I have also tested what luvcview controls work and how:
>
> brightness - works
> contrast - works
> saturation - works
> gain - works
> sharpness - setting works but no apparent effect
> gamma - adjusted down with effect but then could not be adjusted up anymore
> reset to default - works sometimes (only when camera is in a workable
> state?) pan - ioctl querycontrol error 22
> tilt - ioctl querycontrol error 22
> pan/tilt reset - ioctl querycontrol error 22

pan/tilt only work if the camera isn't streaming at a resolution higher than 
640x480. Don't ask me why.

> switch light freq filter - works
> exposure - ioctl set control error
> auto exposure - setting works but apparently always remains on
> white balance - ioctl set control error
> auto white balance - setting works but apparently always remains on

As you experienced the firmware bug, error might be caused by communication 
issues with the camera.

> > The driver already includes workarounds for various broken devices.
> > Have a look at the UVC_QUIRK_* macros in uvcvideo.h and how they are
> > associated with devices in uvc_driver.c.
> >
> > For early Logitech devices, however, no satisfying workaround has
> > been find so far.
>
> I see, what I was suggesting wasn't device specific: it's about not having
> to dig up the sources to enable/disable a hack but to be able to control
> them on the module parameter level.
>
> I don't have a clue but what I can imagine as a solution for the QC Fusion
> in particular is that it should be detected somehow when the camera gets
> into an unworkable state (failed uvc control queries or failed
> initialization) and then it should be reset or reenumerated. Basically
> doing automatically what one is doing by hand using rmmod/insmod cycles
> when it's apparent from the dmesg that the camera is probably unworkable...

If there was an easy way to detect and fix those situations I would include a 
workaround in the driver. Unfortunately, all the proposed workarounds often 
fail and they are too intrusive. I don't want to mess the code with a very 
intrusive workaround that don't even work well.

The real problem is that we have no idea today why the camera fails. There is 
a known firmware bug, but there is no explanation as to why the bug isn't 
triggered by Windows and is triggered by Linux.

> By the way recently I have seen various cameras working under
> Windows and apparently several of them are buggy enough to freeze
> or get unworkable within a certain amount of time of submitting
> video. Even original OEM Windows drivers seem to reset these cams
> repeatedly (at least it seems like it) as a solution which results
> in temporary video breakages in a video enabled Skype connection.
> So it's not unique to the QC Fusion and Linux I guess...

I hope those are not UVC cameras. I'd rather have other drivers implement all 
kind of hacks to get them working :-)

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 20:59:37 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 20:59:37 +0100
Subject: [Linux-uvc-devel] [Patch] Add support for Zoom (Absolute),
	Digital Modifier and PanTilt (Absolute) controls
In-Reply-To: <20080113145319.GB32449@via.ecp.fr>
References: <20080113145319.GB32449@via.ecp.fr>
Message-ID: <200801152059.37431.laurent.pinchart@skynet.be>

On Sunday 13 January 2008, Antoine Cellerier wrote:
> This patch adds support for the Zoom (Absolute), Digital Modifier and
> PanTilt (Absolute) controls as defined in paragraphs 4.2.2.1.11,
> 4.2.2.3.14 and 4.2.2.1.13 of USB_Video_Class_1.1.pdf
>
> The controls have been tested on a 05a9:2640 OmniVision Technologies,
> Inc. webcam (used in Dell Laptops).

Thanks for the patch. I'll have to discuss it with V4L developers to find the 
best way to support both relative and absolute controls.

Does the camera move in response to pan/tilt or does it just crop the image ?

Best regards,

Laurent Pinchart


From dionoea at videolan.org  Tue Jan 15 21:16:00 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Tue, 15 Jan 2008 21:16:00 +0100
Subject: [Linux-uvc-devel] [Patch] Add support for Zoom (Absolute),
	Digital Modifier and PanTilt (Absolute) controls
In-Reply-To: <200801152059.37431.laurent.pinchart@skynet.be>
References: <20080113145319.GB32449@via.ecp.fr>
	<200801152059.37431.laurent.pinchart@skynet.be>
Message-ID: <20080115201600.GC30694@via.ecp.fr>

Laurent,

On Tue, Jan 15, 2008, Laurent Pinchart wrote:
> Thanks for the patch. I'll have to discuss it with V4L developers to find the 
> best way to support both relative and absolute controls.
> 
> Does the camera move in response to pan/tilt or does it just crop the image ?

It's all digital (nothing optical or mirrors). So the digital zoom crops
the image and the pan/tilt controls let you chose where the zoom is
centered on. It doesn't offer the relative counter part which is why I
focused on the absolute one.

Regards,

-- 
Antoine Cellerier
dionoea


From laurent.pinchart at skynet.be  Tue Jan 15 21:56:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 21:56:35 +0100
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801151142.24985.herton@mandriva.com.br>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801102030.32842.laurent.pinchart@skynet.be>
	<200801151142.24985.herton@mandriva.com.br>
Message-ID: <200801152156.35188.laurent.pinchart@skynet.be>

Hi Herton,

On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> Hi Laurent, thanks for the commit and advice. We played with the webcam
> again (sorry for delay) and we found out that it isn't really reporting the
> FID bit, but only end of frame marker (EOF). This is strange indeed, as
> from what I understand from UVC spec FID is required while EOF is optional.

The bmFramingInfo field in the probe&commit control can be used by the device 
to report if it supports FID and/or EOF. However, for known frame-based 
formats, the field must be ignored. Just out of curiosity, could you print 
the field's value when reading the probe and commit controls ?

> I reworked the quirk that Claudio made against revision 166 from svn, but
> now using the EOF to sync the stream (the previous quirk was ok, but on
> laggy communication, like using to transmit a video stream over internet
> etc., the frames would overlap etc. resulting in many display issues):

Your patch could drop the last payload of each frame. Could you please try the 
attached patch ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: stream-no-fid.patch
Type: text/x-diff
Size: 1474 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080115/8a760d73/attachment.patch>

From laurent.pinchart at skynet.be  Tue Jan 15 22:20:26 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 22:20:26 +0100
Subject: [Linux-uvc-devel] [Patch] Add support for Zoom (Absolute),
	Digital Modifier and PanTilt (Absolute) controls
In-Reply-To: <20080115201600.GC30694@via.ecp.fr>
References: <20080113145319.GB32449@via.ecp.fr>
	<200801152059.37431.laurent.pinchart@skynet.be>
	<20080115201600.GC30694@via.ecp.fr>
Message-ID: <200801152220.27108.laurent.pinchart@skynet.be>

On Tuesday 15 January 2008, Antoine Cellerier wrote:
> Laurent,
>
> On Tue, Jan 15, 2008, Laurent Pinchart wrote:
> > Thanks for the patch. I'll have to discuss it with V4L developers to find
> > the best way to support both relative and absolute controls.
> >
> > Does the camera move in response to pan/tilt or does it just crop the
> > image ?
>
> It's all digital (nothing optical or mirrors). So the digital zoom crops
> the image and the pan/tilt controls let you chose where the zoom is
> centered on. It doesn't offer the relative counter part which is why I
> focused on the absolute one.

This should really be mapped to the crop controls in V4L, but I can't think of 
an easy way to achieve that. The pan/tilt controls were not designed to 
select a cropped area (they express their value as an angle). UVC misses 
proper cropping functionality.

Anyway the driver should still implement pan/tilt relative. I'll just need 
some time to discuss this on the v4l mailing list, as Mauro, the v4l 
maintainer, didn't like the idea of having both an absolute and a relative 
control.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 22:22:46 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 22:22:46 +0100
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <b594ca9d0801141153k593f34fbr42b22f83a196d480@mail.gmail.com>
References: <20071204195929.GA1101@kolmann.at>
	<20080114184515.GA30445@kolmann.at>
	<b594ca9d0801141153k593f34fbr42b22f83a196d480@mail.gmail.com>
Message-ID: <200801152222.46237.laurent.pinchart@skynet.be>

On Monday 14 January 2008, Andrew Fenn wrote:
> My Logitech QC 9000 still crashes in 166. Happened today after I started
> the camera in skype with bad lighting.

First of all, make sure you really use rev 166 and not an older driver that 
was still lying around. Then, please provide debug logs (application & kernel 
logs).

> On 14/01/2008, Philipp Kolmann <philipp at kolmann.at> wrote:
> > Hi,
> >
> > On Fri, Dec 07, 2007 at 01:37:46AM +0100, Laurent Pinchart wrote:
> > > - The uvcvideo driver could stop streaming, renegotiate the parameters
> > > and restart streaming. The webcam might still crash as the cause of the
> > > crash is not understood.
> >
> > your change in rev 166 makes skype work for me also in bad light
> > conditions now.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 15 22:26:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 22:26:35 +0100
Subject: [Linux-uvc-devel] Debugging UVC + Sanyo Xacti cameras
In-Reply-To: <478CC851.2010000@ifi.uzh.ch>
References: <44759.130.60.75.225.1198150630.squirrel@bela.ifi.unizh.ch>
	<200801132245.48079.laurent.pinchart@skynet.be>
	<478CC851.2010000@ifi.uzh.ch>
Message-ID: <200801152226.35332.laurent.pinchart@skynet.be>

Hi Thomas,

On Tuesday 15 January 2008, Thomas Netter wrote:
> Hi Laurent,
>
> Many thanks for attempting a patch. I patched it against uvc-r166.
> Didn't solve the problem.

I can't say I'm surprised, but I was still hoping it would work :-)

> Here's the output: 
>
> --> Connect camera to USB port. Put camera into PC CAMERA mode.
>
> Syslog:
>

Please get the kernel log messages using dmesg instead. The networkmanager and 
hal messages just cripple the output.

> Jan 15 15:28:25 zadig kernel: [20530.696000] usb 7-1: new high speed USB
> device using ehci_hcd and address 6
> Jan 15 15:28:26 zadig kernel: [20530.828000] usb 7-1: configuration #1
> chosen from 1 choice
> Jan 15 15:28:26 zadig kernel: [20530.828000] uvcvideo: Found UVC 1.00
> device SANYO Digital Camera (0474:0241)
> Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.016313]
> nm_hal_device_added(): New device added (hal udi is
> '/org/freedesktop/Hal/devices/usb_device_474_241_000095970948').
> Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.102361]
> nm_hal_device_added(): New device added (hal udi is
> '/org/freedesktop/Hal/devices/usb_device_ffffffff_ffffffff_noserial').
> Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.193626]
> nm_hal_device_added(): New device added (hal udi is
> '/org/freedesktop/Hal/devices/usb_device_ffffffff_ffffffff_noserial_video4l
>inux').
>
> Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.654525]
> nm_hal_device_added(): New device added (hal udi is
> '/org/freedesktop/Hal/devices/usb_device_474_241_000095970948_if1').
> Jan 15 15:28:26 zadig NetworkManager: <debug> [1200407306.684166]
> nm_hal_device_added(): New device added (hal udi is
> '/org/freedesktop/Hal/devices/usb_device_474_241_000095970948_usbraw').
>
>
> --> Start luvcview:
>
> sudo ./luvcview
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> G_FMT -1 0 0  0 0 0 134612088
> prepare S_FMT 1 320  240 1196444237 0 0
>
> --> Image from camera is visible
> ---> Press Q
>
> Closing vd->fd
>  Clean Up done Quit
>
> --> Start luvcview again:
>
>  sudo ./luvcview
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> G_FMT -1 0 0  0 0 0 134612088
> prepare S_FMT 1 320  240 1196444237 0 0
> Unable to set format: 5.
>  Init v4L2 failed !! exit fatal
>
> Nothing more is printed in /var/log/syslog or messages.

Get the messages from the kernel log directly, as syslog might need a small 
delay to flush the messages to the log. If the driver returns -EIO to 
luvcview there must be a corresponding message in the kernel log.

Cheers,

Laurent Pinchart


From herton at mandriva.com.br  Tue Jan 15 22:53:27 2008
From: herton at mandriva.com.br (Herton Ronaldo Krzesinski)
Date: Tue, 15 Jan 2008 19:53:27 -0200
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801152156.35188.laurent.pinchart@skynet.be>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801151142.24985.herton@mandriva.com.br>
	<200801152156.35188.laurent.pinchart@skynet.be>
Message-ID: <200801151953.28034.herton@mandriva.com.br>

Em Tuesday 15 January 2008 18:56:35 Laurent Pinchart escreveu:
> Hi Herton,
> 
> On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > Hi Laurent, thanks for the commit and advice. We played with the webcam
> > again (sorry for delay) and we found out that it isn't really reporting the
> > FID bit, but only end of frame marker (EOF). This is strange indeed, as
> > from what I understand from UVC spec FID is required while EOF is optional.
> 
> The bmFramingInfo field in the probe&commit control can be used by the device 
> to report if it supports FID and/or EOF. However, for known frame-based 
> formats, the field must be ignored. Just out of curiosity, could you print 
> the field's value when reading the probe and commit controls ?

It's always 0x00, falls at else in size check inside uvc_get_video_ctrl:
uvc_get_video_ctrl: size != 34, bmFramingInfo = 0x00

> 
> > I reworked the quirk that Claudio made against revision 166 from svn, but
> > now using the EOF to sync the stream (the previous quirk was ok, but on
> > laggy communication, like using to transmit a video stream over internet
> > etc., the frames would overlap etc. resulting in many display issues):
> 
> Your patch could drop the last payload of each frame. Could you please try the 
> attached patch ?

It works, but gives a different behaviour: for example, I simulate lag
in luvcview placing a sleep(1) at the start of uvcGrab function, with
this patch it captures only some frames at start and stops, with the
patch I posted I receive continous snapshots.

> 
> Best regards,
> 
> Laurent Pinchart
> 

-- 
[]'s
Herton


From laurent.pinchart at skynet.be  Tue Jan 15 23:12:16 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 15 Jan 2008 23:12:16 +0100
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801151953.28034.herton@mandriva.com.br>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801152156.35188.laurent.pinchart@skynet.be>
	<200801151953.28034.herton@mandriva.com.br>
Message-ID: <200801152312.17089.laurent.pinchart@skynet.be>

On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> Em Tuesday 15 January 2008 18:56:35 Laurent Pinchart escreveu:
> > Hi Herton,
> >
> > On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > > Hi Laurent, thanks for the commit and advice. We played with the webcam
> > > again (sorry for delay) and we found out that it isn't really reporting
> > > the FID bit, but only end of frame marker (EOF). This is strange
> > > indeed, as from what I understand from UVC spec FID is required while
> > > EOF is optional.
> >
> > The bmFramingInfo field in the probe&commit control can be used by the
> > device to report if it supports FID and/or EOF. However, for known
> > frame-based formats, the field must be ignored. Just out of curiosity,
> > could you print the field's value when reading the probe and commit
> > controls ?
>
> It's always 0x00, falls at else in size check inside uvc_get_video_ctrl:
> uvc_get_video_ctrl: size != 34, bmFramingInfo = 0x00
>
> > > I reworked the quirk that Claudio made against revision 166 from svn,
> > > but now using the EOF to sync the stream (the previous quirk was ok,
> > > but on laggy communication, like using to transmit a video stream over
> > > internet etc., the frames would overlap etc. resulting in many display
> > > issues):
> >
> > Your patch could drop the last payload of each frame. Could you please
> > try the attached patch ?
>
> It works, but gives a different behaviour: for example, I simulate lag
> in luvcview placing a sleep(1) at the start of uvcGrab function, with
> this patch it captures only some frames at start and stops, with the
> patch I posted I receive continous snapshots.

I'm not sure to understand. Could you please elaborate ?

Best regards,

Laurent Pinchart


From herton at mandriva.com.br  Tue Jan 15 23:27:19 2008
From: herton at mandriva.com.br (Herton Ronaldo Krzesinski)
Date: Tue, 15 Jan 2008 20:27:19 -0200
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801152312.17089.laurent.pinchart@skynet.be>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801151953.28034.herton@mandriva.com.br>
	<200801152312.17089.laurent.pinchart@skynet.be>
Message-ID: <200801152027.19532.herton@mandriva.com.br>

Em Tuesday 15 January 2008 20:12:16 Laurent Pinchart escreveu:
> On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > Em Tuesday 15 January 2008 18:56:35 Laurent Pinchart escreveu:
> > > Hi Herton,
> > >
> > > On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > > > Hi Laurent, thanks for the commit and advice. We played with the webcam
> > > > again (sorry for delay) and we found out that it isn't really reporting
> > > > the FID bit, but only end of frame marker (EOF). This is strange
> > > > indeed, as from what I understand from UVC spec FID is required while
> > > > EOF is optional.
> > >
> > > The bmFramingInfo field in the probe&commit control can be used by the
> > > device to report if it supports FID and/or EOF. However, for known
> > > frame-based formats, the field must be ignored. Just out of curiosity,
> > > could you print the field's value when reading the probe and commit
> > > controls ?
> >
> > It's always 0x00, falls at else in size check inside uvc_get_video_ctrl:
> > uvc_get_video_ctrl: size != 34, bmFramingInfo = 0x00
> >
> > > > I reworked the quirk that Claudio made against revision 166 from svn,
> > > > but now using the EOF to sync the stream (the previous quirk was ok,
> > > > but on laggy communication, like using to transmit a video stream over
> > > > internet etc., the frames would overlap etc. resulting in many display
> > > > issues):
> > >
> > > Your patch could drop the last payload of each frame. Could you please
> > > try the attached patch ?
> >
> > It works, but gives a different behaviour: for example, I simulate lag
> > in luvcview placing a sleep(1) at the start of uvcGrab function, with
> > this patch it captures only some frames at start and stops, with the
> > patch I posted I receive continous snapshots.
> 
> I'm not sure to understand. Could you please elaborate ?

If I patch luvcview like this:

--- v4l2uvc.c.orig      2008-01-15 20:19:57.000000000 -0200
+++ v4l2uvc.c   2008-01-15 20:19:40.000000000 -0200
@@ -462,6 +462,8 @@ int uvcGrab(struct vdIn *vd)
 #define HEADERFRAME1 0xaf
     int ret;

+    sleep(1);
+
     if (!vd->isstreaming)
        if (video_enable(vd))
            goto err;

And use luvcview with patched uvcvideo, the behaviour between the two
patches is different. With your patch, the stream of video doesn't work
well, it captures only the first 1/2 frames and stop. But in stock luvcview
without the sleep your patch works fine. The difference here is that with
the patch I posted earlier it works in both cases, it doesn't fail with the
luvcview patched with sleep.

> 
> Best regards,
> 
> Laurent Pinchart
> 

-- 
[]'s
Herton


From clists at perrin.socsci.unc.edu  Wed Jan 16 02:34:23 2008
From: clists at perrin.socsci.unc.edu (Andrew Perrin)
Date: Tue, 15 Jan 2008 20:34:23 -0500 (EST)
Subject: [Linux-uvc-devel] Skype w/ logitech quickcam 9000 pro
In-Reply-To: <200801152038.13175.laurent.pinchart@skynet.be>
References: <Pine.LNX.4.64.0801141953490.25967@perrin.socsci.unc.edu>
	<200801150228.36247.laurent.pinchart@skynet.be>
	<Pine.LNX.4.64.0801142053130.25967@perrin.socsci.unc.edu>
	<200801152038.13175.laurent.pinchart@skynet.be>
Message-ID: <Pine.LNX.4.64.0801152033520.2312@perrin.socsci.unc.edu>

*fascinating* - it works fine when plugged into the USB port in the back 
of my machine, but not in the front. Thanks for all your advice.

Andy

----------------------------------------------------------------------
Andrew J Perrin - andrew_perrin (at) unc.edu - http://perrin.socsci.unc.edu
Associate Professor of Sociology; Book Review Editor, _Social Forces_
University of North Carolina - CB#3210, Chapel Hill, NC 27599-3210 USA



On Tue, 15 Jan 2008, Laurent Pinchart wrote:

> Hi Andrew,
>
> On Tuesday 15 January 2008, Andrew Perrin wrote:
>> On Tue, 15 Jan 2008, Laurent Pinchart wrote:
>>> Hi Andrew,
>>>
>>> On Tuesday 15 January 2008, Andrew Perrin wrote:
>>>> I have a quickcam 9000 pro working fine with luvcview, but it gives the
>>>> famous "black rectangle" with Skype. This is the latest (166) rev. of
>>>> uvcvideo. These messages are in the log when I try:
>>>>
>>>> Jan 14 19:53:08 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f74175c0
>>>> (#81) state 2
>>>> Jan 14 19:53:22 joehill kernel: uvcvideo: Failed to submit URB 0 (-28).
>>>> Jan 14 19:53:30 joehill kernel: ohci_hcd 0000:00:0b.0: leak ed f7417600
>>>> (#81) state 2
>>>
>>> -28 is -ENOSPC. It means using the device would exceed the available USB
>>> bus bandwidth. If your webcam is plugged into a hub try moving it to a
>>> root port. Make sure you're using an EHCI controller.
>>>
>>> Best regards,
>>>
>>> Laurent Pinchart
>>
>> Very interesting, and thanks for your quick reply. Plugging it directly
>> into the USB port (instead of through a hub) makes both luvcview *and
>> Skype* give a very flickery, but recognizable, image. luvcview dies after
>> a few seconds with the result:
>>
>> Ignoring empty buffer ...
>> Ignoring empty buffer ...
>> Ignoring empty buffer ...
>> Ignoring empty buffer ...
>> Unable to dequeue buffer (22).
>> Error grabbing
>>   Clean Up done Quit
>>
>> ...while Skype just keeps the flickery image on.  /var/log/syslog
>> contains:
>>
>> usb 1-6: new high speed USB device using ehci_hcd and address 9
>> usb 1-6:  configuration #1 chosen from 1 choice
>> uvcvideo: Found UVC 1.00 device <unnamed> (046d:0990)
>> usb 1-6: USB disconnect, address 9
>> usb 1-6: new high speed USB device using ehci_hcd and address 10
>> usb 1-6: device descriptor read/all, error -71
>
> Your webcam seem to be very flaky. Failing to respond to the first GET
> DESCRIPTOR request with -71 means serious hardware trouble.
>
>> usb 1-6: new high speed USB device using ehci_hcd and address 11
>> usb 1-6: configuration #1 chosen from 1 choice
>> uvcvideo: Found UVC 1.00 device <unnamed> (046d:0990)
>> uvcvideo: Failed to query (131) UVC control 1 (unit 0) : -71 (exp. 26).
>> uvcvideo: Failed to query (131) UVC control 1 (unit 0) : -71 (exp. 26).
>
> You should check your cables. Is your computer in an extremely noisy
> environment (electrically speaking) ? Do you experience the same kind of
> trouble with other USB devices ?
>
> Best regards,
>
> Laurent Pinchart
>


From andrewfenn at gmail.com  Wed Jan 16 06:28:30 2008
From: andrewfenn at gmail.com (Andrew Fenn)
Date: Wed, 16 Jan 2008 05:28:30 +0000
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <200801152222.46237.laurent.pinchart@skynet.be>
References: <20071204195929.GA1101@kolmann.at>
	<20080114184515.GA30445@kolmann.at>
	<b594ca9d0801141153k593f34fbr42b22f83a196d480@mail.gmail.com>
	<200801152222.46237.laurent.pinchart@skynet.be>
Message-ID: <b594ca9d0801152128j36dadfd5t308188a720567a5e@mail.gmail.com>

I am building from svn, but maybe I am doing something wrong?

Please could you give me a step by step of what you'd like me to provide?

Thanks,
Andrew

On 15/01/2008, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
>
> On Monday 14 January 2008, Andrew Fenn wrote:
> > My Logitech QC 9000 still crashes in 166. Happened today after I started
> > the camera in skype with bad lighting.
>
> First of all, make sure you really use rev 166 and not an older driver
> that
> was still lying around. Then, please provide debug logs (application &
> kernel
> logs).
>
> > On 14/01/2008, Philipp Kolmann <philipp at kolmann.at> wrote:
> > > Hi,
> > >
> > > On Fri, Dec 07, 2007 at 01:37:46AM +0100, Laurent Pinchart wrote:
> > > > - The uvcvideo driver could stop streaming, renegotiate the
> parameters
> > > > and restart streaming. The webcam might still crash as the cause of
> the
> > > > crash is not understood.
> > >
> > > your change in rev 166 makes skype work for me also in bad light
> > > conditions now.
>
> Best regards,
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080116/655c36c2/attachment.html>

From herton at mandriva.com.br  Wed Jan 16 14:02:34 2008
From: herton at mandriva.com.br (Herton Ronaldo Krzesinski)
Date: Wed, 16 Jan 2008 11:02:34 -0200
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <5f52f6d70801151432x37dede52rfa853b01e9dee9e5@mail.gmail.com>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801152027.19532.herton@mandriva.com.br>
	<5f52f6d70801151432x37dede52rfa853b01e9dee9e5@mail.gmail.com>
Message-ID: <200801161102.40201.herton@mandriva.com.br>

Em Tuesday 15 January 2008 20:32:14 Claudio Matsuoka escreveu:
> On Jan 15, 2008 8:27 PM, Herton Ronaldo Krzesinski
> <herton at mandriva.com.br> wrote:
> 
> > And use luvcview with patched uvcvideo, the behaviour between the two
> > patches is different. With your patch, the stream of video doesn't work
> > well, it captures only the first 1/2 frames and stop. But in stock 
luvcview
> > without the sleep your patch works fine. The difference here is that with
> > the patch I posted earlier it works in both cases, it doesn't fail with 
the
> > luvcview patched with sleep.
> 
> And, if I recall correctly, kopete behaves like luvcvideo with sleep
> during normal operation, so Laurent's patch would possibly fail there.
> Have you tested it with kopete or ekiga?

Yes, tested kopete today and same issue. Over a LAN the connection is fast 
enough and you don't see the problem, but over slow internet the same problem 
of luvcview with sleep occurs.

> 
> Best regards,
> Claudio
> 

--
[]'s
Herton


From sboyce at blueyonder.co.uk  Wed Jan 16 15:21:35 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Wed, 16 Jan 2008 14:21:35 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <478DFAD1.2020407@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478CEAFE.2060901@blueyonder.co.uk>
	<200801152024.31499.laurent.pinchart@skynet.be>
	<478DFAD1.2020407@blueyonder.co.uk>
Message-ID: <478E12EF.7010607@blueyonder.co.uk>

Sid Boyce wrote:
> Laurent Pinchart wrote:
>> Hi Sid,
>>
>> On Tuesday 15 January 2008, Sid Boyce wrote:
>>> Sid Boyce wrote:
>>>> # luvcview -l
>>>> luvcview version 0.2.1
>>>> Video driver: x11
>>>> A window manager is available
>>>> video /dev/video0
>>>> Unable to set format: 16.
>>>> Init v4L2 failed !! exit fatal
>>>>
>>>> # luvcview -L
>>>> luvcview version 0.2.1
>>>> Video driver: x11
>>>> A window manager is available
>>>> video /dev/video0
>>>> /dev/video0 does not support read i/o
>>>> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>>>> { discrete: width = 640, height = 480 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 352, height = 288 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 320, height = 240 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 176, height = 144 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 160, height = 120 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>
>>>>
>>>> # lsmod|grep uvc
>>>> uvcvideo 68740 1
>>>> compat_ioctl32 25728 1 uvcvideo
>>>> videodev 44160 2 uvcvideo
>>>> v4l1_compat 28932 2 uvcvideo,videodev
>>>> v4l2_common 36608 3 uvcvideo,compat_ioctl32,videodev
>>>> usbcore 164256 5 uvcvideo,usbhid,ohci_hcd,ehci_hcd
>>>>
>>>> openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
>>>> Help appreciated.
>>>> Regards
>>>> Sid.
>>> Checked out my Logitech QuickCam Pro 9000 on my other x86_64 box - skype
>>> and luvcview - and it's fine, so there must be a problem with the driver
>>> with respect to the CrystalEye.
>>
>> -16 means -EBUSY. The camera is probably already in use by another
>> application.
>>
>> Best regards,
>>
>> Laurent Pinchart
>>
>>
> 
> Nothing else that would use the camera is running, "lsof /dev/video0" 
> also confirms that. I've tried 2 other USB webcams, gspca and ov51x, 
> both work fine.
> It's either broken hardware or something strange in code. I've run both 
> strace and gdb against luvcview, no more information. xawtv also gives 
> EBUSY. I'm restoring XP to another HD to see if I get problems there also.
> Regards
> Sid.
> 

Whilst restoring XP I remembered the webcam did work. XP restored and 
the webcam definitely is OK under XP. In with the Linux drive again.
I always do "svn up" to make sure I have the latest uvcvideo.
Regards
Sid.
-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From tnetter at ifi.uzh.ch  Wed Jan 16 16:53:59 2008
From: tnetter at ifi.uzh.ch (Thomas Netter)
Date: Wed, 16 Jan 2008 16:53:59 +0100
Subject: [Linux-uvc-devel] Debugging UVC + Sanyo Xacti cameras
In-Reply-To: <200801152226.35332.laurent.pinchart@skynet.be>
References: <44759.130.60.75.225.1198150630.squirrel@bela.ifi.unizh.ch>
	<200801132245.48079.laurent.pinchart@skynet.be>
	<478CC851.2010000@ifi.uzh.ch>
	<200801152226.35332.laurent.pinchart@skynet.be>
Message-ID: <478E2897.8020209@ifi.uzh.ch>

Laurent Pinchard wrote:
> Please get the kernel log messages using dmesg instead. The networkmanager and 
> hal messages just cripple the output.

Load modules:
modprobe v4l2-common
modprobe videodev
modprobe v4l1-compat
modprobe compat_ioctl32
modprobe video-buf
insmod uvcvideo.ko

/etc/syslog/messages:
Jan 16 16:43:43 zadig kernel: [ 7844.608000] Linux video capture interface: v2.00
Jan 16 16:44:17 zadig kernel: [ 7877.848000] usbcore: registered new interface driver uvcvideo
Jan 16 16:44:17 zadig kernel: [ 7877.852000] USB Video Class driver (v0.1.0)

dmesg:
[ 7844.608000] Linux video capture interface: v2.00
[ 7877.848000] usbcore: registered new interface driver uvcvideo
[ 7877.852000] USB Video Class driver (v0.1.0)


Start camera into PC CAMERA mode:
[ 8037.988000] usb 2-1: new high speed USB device using ehci_hcd and address 3
[ 8038.120000] usb 2-1: configuration #1 chosen from 1 choice
[ 8038.132000] uvcvideo: Found UVC 1.00 device SANYO Digital Camera (0474:0241)

Start luvcview. Image is good. No dmesg output.
Stop luvcview. No dmesg output
Start luvcview. Error:

luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
Unable to set format: 5.
 Init v4L2 failed !! exit fatal

dmesg:
[ 8191.364000] uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).



From sboyce at blueyonder.co.uk  Wed Jan 16 13:38:41 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Wed, 16 Jan 2008 12:38:41 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <200801152024.31499.laurent.pinchart@skynet.be>
References: <478C2355.1000802@blueyonder.co.uk>
	<478CEAFE.2060901@blueyonder.co.uk>
	<200801152024.31499.laurent.pinchart@skynet.be>
Message-ID: <478DFAD1.2020407@blueyonder.co.uk>

Laurent Pinchart wrote:
> Hi Sid,
> 
> On Tuesday 15 January 2008, Sid Boyce wrote:
>> Sid Boyce wrote:
>>> # luvcview -l
>>> luvcview version 0.2.1
>>> Video driver: x11
>>> A window manager is available
>>> video /dev/video0
>>> Unable to set format: 16.
>>> Init v4L2 failed !! exit fatal
>>>
>>> # luvcview -L
>>> luvcview version 0.2.1
>>> Video driver: x11
>>> A window manager is available
>>> video /dev/video0
>>> /dev/video0 does not support read i/o
>>> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>>> { discrete: width = 640, height = 480 }
>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>> { discrete: width = 352, height = 288 }
>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>> { discrete: width = 320, height = 240 }
>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>> { discrete: width = 176, height = 144 }
>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>> { discrete: width = 160, height = 120 }
>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>
>>>
>>> # lsmod|grep uvc
>>> uvcvideo 68740 1
>>> compat_ioctl32 25728 1 uvcvideo
>>> videodev 44160 2 uvcvideo
>>> v4l1_compat 28932 2 uvcvideo,videodev
>>> v4l2_common 36608 3 uvcvideo,compat_ioctl32,videodev
>>> usbcore 164256 5 uvcvideo,usbhid,ohci_hcd,ehci_hcd
>>>
>>> openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
>>> Help appreciated.
>>> Regards
>>> Sid.
>> Checked out my Logitech QuickCam Pro 9000 on my other x86_64 box - skype
>> and luvcview - and it's fine, so there must be a problem with the driver
>> with respect to the CrystalEye.
> 
> -16 means -EBUSY. The camera is probably already in use by another
> application.
> 
> Best regards,
> 
> Laurent Pinchart
> 
> 

Nothing else that would use the camera is running, "lsof /dev/video0" 
also confirms that. I've tried 2 other USB webcams, gspca and ov51x, 
both work fine.
It's either broken hardware or something strange in code. I've run both 
strace and gdb against luvcview, no more information. xawtv also gives 
EBUSY. I'm restoring XP to another HD to see if I get problems there also.
Regards
Sid.

-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From laurent.pinchart at skynet.be  Wed Jan 16 21:05:44 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 16 Jan 2008 21:05:44 +0100
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801152027.19532.herton@mandriva.com.br>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801152312.17089.laurent.pinchart@skynet.be>
	<200801152027.19532.herton@mandriva.com.br>
Message-ID: <200801162105.44785.laurent.pinchart@skynet.be>

On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> Em Tuesday 15 January 2008 20:12:16 Laurent Pinchart escreveu:
> > On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > > Em Tuesday 15 January 2008 18:56:35 Laurent Pinchart escreveu:
> > > > Hi Herton,
> > > >
> > > > On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > > > > Hi Laurent, thanks for the commit and advice. We played with the
> > > > > webcam again (sorry for delay) and we found out that it isn't
> > > > > really reporting the FID bit, but only end of frame marker (EOF).
> > > > > This is strange indeed, as from what I understand from UVC spec FID
> > > > > is required while EOF is optional.
> > > >
> > > > The bmFramingInfo field in the probe&commit control can be used by
> > > > the device to report if it supports FID and/or EOF. However, for
> > > > known frame-based formats, the field must be ignored. Just out of
> > > > curiosity, could you print the field's value when reading the probe
> > > > and commit controls ?
> > >
> > > It's always 0x00, falls at else in size check inside
> > > uvc_get_video_ctrl: uvc_get_video_ctrl: size != 34, bmFramingInfo =
> > > 0x00
> > >
> > > > > I reworked the quirk that Claudio made against revision 166 from
> > > > > svn, but now using the EOF to sync the stream (the previous quirk
> > > > > was ok, but on laggy communication, like using to transmit a video
> > > > > stream over internet etc., the frames would overlap etc. resulting
> > > > > in many display issues):
> > > >
> > > > Your patch could drop the last payload of each frame. Could you
> > > > please try the attached patch ?
> > >
> > > It works, but gives a different behaviour: for example, I simulate lag
> > > in luvcview placing a sleep(1) at the start of uvcGrab function, with
> > > this patch it captures only some frames at start and stops, with the
> > > patch I posted I receive continous snapshots.
> >
> > I'm not sure to understand. Could you please elaborate ?
>
> If I patch luvcview like this:
>
> --- v4l2uvc.c.orig      2008-01-15 20:19:57.000000000 -0200
> +++ v4l2uvc.c   2008-01-15 20:19:40.000000000 -0200
> @@ -462,6 +462,8 @@ int uvcGrab(struct vdIn *vd)
>  #define HEADERFRAME1 0xaf
>      int ret;
>
> +    sleep(1);
> +
>      if (!vd->isstreaming)
>         if (video_enable(vd))
>             goto err;
>
> And use luvcview with patched uvcvideo, the behaviour between the two
> patches is different. With your patch, the stream of video doesn't work
> well, it captures only the first 1/2 frames and stop. But in stock luvcview
> without the sleep your patch works fine. The difference here is that with
> the patch I posted earlier it works in both cases, it doesn't fail with the
> luvcview patched with sleep.

I see where the problem comes from. Could you please test the attached patch ? 
It should fix the freeze and still prevent the last payload of each frame to 
be discarded.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: stream-no-fid.patch
Type: text/x-diff
Size: 2138 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080116/89efb2a7/attachment.patch>

From laurent.pinchart at skynet.be  Wed Jan 16 21:25:48 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 16 Jan 2008 21:25:48 +0100
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
	problem with luvcview
In-Reply-To: <478DFAD1.2020407@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<200801152024.31499.laurent.pinchart@skynet.be>
	<478DFAD1.2020407@blueyonder.co.uk>
Message-ID: <200801162125.48417.laurent.pinchart@skynet.be>

Hi Sid,

On Wednesday 16 January 2008, Sid Boyce wrote:
> Laurent Pinchart wrote:
> > On Tuesday 15 January 2008, Sid Boyce wrote:
> >> Sid Boyce wrote:
> >>> # luvcview -l
> >>> luvcview version 0.2.1
> >>> Video driver: x11
> >>> A window manager is available
> >>> video /dev/video0
> >>> Unable to set format: 16.
> >>> Init v4L2 failed !! exit fatal
> >>>
> >>> # luvcview -L
> >>> luvcview version 0.2.1
> >>> Video driver: x11
> >>> A window manager is available
> >>> video /dev/video0
> >>> /dev/video0 does not support read i/o
> >>> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >>> { discrete: width = 640, height = 480 }
> >>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >>> { discrete: width = 352, height = 288 }
> >>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >>> { discrete: width = 320, height = 240 }
> >>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >>> { discrete: width = 176, height = 144 }
> >>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >>> { discrete: width = 160, height = 120 }
> >>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >>>
> >>>
> >>> # lsmod|grep uvc
> >>> uvcvideo 68740 1
> >>> compat_ioctl32 25728 1 uvcvideo
> >>> videodev 44160 2 uvcvideo
> >>> v4l1_compat 28932 2 uvcvideo,videodev
> >>> v4l2_common 36608 3 uvcvideo,compat_ioctl32,videodev
> >>> usbcore 164256 5 uvcvideo,usbhid,ohci_hcd,ehci_hcd
> >>>
> >>> openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
> >>> Help appreciated.
> >>> Regards
> >>> Sid.
> >>
> >> Checked out my Logitech QuickCam Pro 9000 on my other x86_64 box - skype
> >> and luvcview - and it's fine, so there must be a problem with the driver
> >> with respect to the CrystalEye.
> >
> > -16 means -EBUSY. The camera is probably already in use by another
> > application.
> >
> > Best regards,
> >
> > Laurent Pinchart
>
> Nothing else that would use the camera is running, "lsof /dev/video0"
> also confirms that. I've tried 2 other USB webcams, gspca and ov51x,
> both work fine.
> It's either broken hardware or something strange in code. I've run both
> strace and gdb against luvcview, no more information. xawtv also gives
> EBUSY. I'm restoring XP to another HD to see if I get problems there also.

VIDIOC_S_FMT can return EBUSY either when the device is already streaming or 
when another process has acquired a "streaming privilege". Basically, this 
means another process has already called one of the following ioctls:

VIDIOC_S_INPUT
VIDIOC_S_PARM
VIDIOC_S_FMT
VIDIOC_TRY_FMT
VIDIOC_REQBUFS

Please apply the attached patch and check the kernel log. The driver should 
report every process that acquire or release streaming privileges, as well as 
attemps to call VIDIOC_S_FMT while streaming.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: busy-debug.patch
Type: text/x-diff
Size: 1379 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080116/0fa982b1/attachment.patch>

From laurent.pinchart at skynet.be  Wed Jan 16 21:35:12 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 16 Jan 2008 21:35:12 +0100
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <b594ca9d0801152128j36dadfd5t308188a720567a5e@mail.gmail.com>
References: <20071204195929.GA1101@kolmann.at>
	<200801152222.46237.laurent.pinchart@skynet.be>
	<b594ca9d0801152128j36dadfd5t308188a720567a5e@mail.gmail.com>
Message-ID: <200801162135.12584.laurent.pinchart@skynet.be>

On Wednesday 16 January 2008, Andrew Fenn wrote:
> I am building from svn, but maybe I am doing something wrong?

Just make sure you remove all occurrences of uvcvideo.ko 
in /lib/modules/<kernel version> before you install the new, in case the 
makefile would install it in a different location.

> Please could you give me a step by step of what you'd like me to provide?

You reported a camera crash. I suppose your conclusion is based on a specific 
behaviour you noticed or on messages printed to a log. Please describe with 
specificity the wrong behaviour, and please provide any kernel log message 
printed by the driver (using dmesg) and any application log message (I've 
never used the application but I assume Skype prints messages to a log) 
related to the problem.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Jan 16 21:53:04 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 16 Jan 2008 21:53:04 +0100
Subject: [Linux-uvc-devel] Debugging UVC + Sanyo Xacti cameras
In-Reply-To: <478E2897.8020209@ifi.uzh.ch>
References: <44759.130.60.75.225.1198150630.squirrel@bela.ifi.unizh.ch>
	<200801152226.35332.laurent.pinchart@skynet.be>
	<478E2897.8020209@ifi.uzh.ch>
Message-ID: <200801162153.04671.laurent.pinchart@skynet.be>

Hi Thomas,

On Wednesday 16 January 2008, Thomas Netter wrote:
> Laurent Pinchard wrote:
> > Please get the kernel log messages using dmesg instead. The
> > networkmanager and hal messages just cripple the output.
>
> Load modules:
> modprobe v4l2-common
> modprobe videodev
> modprobe v4l1-compat
> modprobe compat_ioctl32
> modprobe video-buf
> insmod uvcvideo.ko
>
> /etc/syslog/messages:
> Jan 16 16:43:43 zadig kernel: [ 7844.608000] Linux video capture interface:
> v2.00 Jan 16 16:44:17 zadig kernel: [ 7877.848000] usbcore: registered new
> interface driver uvcvideo Jan 16 16:44:17 zadig kernel: [ 7877.852000] USB
> Video Class driver (v0.1.0)
>
> dmesg:
> [ 7844.608000] Linux video capture interface: v2.00
> [ 7877.848000] usbcore: registered new interface driver uvcvideo
> [ 7877.852000] USB Video Class driver (v0.1.0)
>
>
> Start camera into PC CAMERA mode:
> [ 8037.988000] usb 2-1: new high speed USB device using ehci_hcd and
> address 3 [ 8038.120000] usb 2-1: configuration #1 chosen from 1 choice
> [ 8038.132000] uvcvideo: Found UVC 1.00 device SANYO Digital Camera
> (0474:0241)
>
> Start luvcview. Image is good. No dmesg output.
> Stop luvcview. No dmesg output
> Start luvcview. Error:
>
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 5.
>  Init v4L2 failed !! exit fatal
>
> dmesg:
> [ 8191.364000] uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110
> (exp. 26).

This is quite weird. The camera starts streaming without any problem, but 
after streaming for a while it fails to answer all USB requests. The requests 
sent before stream start probably confuse the camera somehow.

I'll have another wild guess, could you please try the attached patch ? It 
removes a few differences in requests sent to the device compared to what the 
Windows driver does.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sanyo.diff
Type: text/x-diff
Size: 1419 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080116/15119363/attachment.diff>

From philipp at kolmann.at  Wed Jan 16 21:54:26 2008
From: philipp at kolmann.at (Philipp Kolmann)
Date: Wed, 16 Jan 2008 21:54:26 +0100
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <200801162135.12584.laurent.pinchart@skynet.be>
References: <20071204195929.GA1101@kolmann.at>
	<200801152222.46237.laurent.pinchart@skynet.be>
	<b594ca9d0801152128j36dadfd5t308188a720567a5e@mail.gmail.com>
	<200801162135.12584.laurent.pinchart@skynet.be>
Message-ID: <20080116205426.GA18791@kolmann.at>

On Wed, Jan 16, 2008 at 09:35:12PM +0100, Laurent Pinchart wrote:
> ... and any application log message (I've 
> never used the application but I assume Skype prints messages to a log) 
> related to the problem.

Sadly, Skype logs some stuff, but the log is encrypted and only skype can
decrypt stuff. :(

Philipp

-- 
The more I learn about people, the more I like my dog!


From sboyce at blueyonder.co.uk  Wed Jan 16 21:59:25 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Wed, 16 Jan 2008 20:59:25 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <478E12EF.7010607@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478CEAFE.2060901@blueyonder.co.uk>
	<200801152024.31499.laurent.pinchart@skynet.be>
	<478DFAD1.2020407@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
Message-ID: <478E702D.5030001@blueyonder.co.uk>

Sid Boyce wrote:
> Sid Boyce wrote:
>> Laurent Pinchart wrote:
>>> Hi Sid,
>>>
>>> On Tuesday 15 January 2008, Sid Boyce wrote:
>>>> Sid Boyce wrote:
>>>>> # luvcview -l
>>>>> luvcview version 0.2.1
>>>>> Video driver: x11
>>>>> A window manager is available
>>>>> video /dev/video0
>>>>> Unable to set format: 16.
>>>>> Init v4L2 failed !! exit fatal
>>>>>
>>>>> # luvcview -L
>>>>> luvcview version 0.2.1
>>>>> Video driver: x11
>>>>> A window manager is available
>>>>> video /dev/video0
>>>>> /dev/video0 does not support read i/o
>>>>> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>>>>> { discrete: width = 640, height = 480 }
>>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>> { discrete: width = 352, height = 288 }
>>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>> { discrete: width = 320, height = 240 }
>>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>> { discrete: width = 176, height = 144 }
>>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>> { discrete: width = 160, height = 120 }
>>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>>
>>>>>
>>>>> # lsmod|grep uvc
>>>>> uvcvideo 68740 1
>>>>> compat_ioctl32 25728 1 uvcvideo
>>>>> videodev 44160 2 uvcvideo
>>>>> v4l1_compat 28932 2 uvcvideo,videodev
>>>>> v4l2_common 36608 3 uvcvideo,compat_ioctl32,videodev
>>>>> usbcore 164256 5 uvcvideo,usbhid,ohci_hcd,ehci_hcd
>>>>>
>>>>> openSUSE 11.0Alpha0 x86_64 with kernel 2.6.24-rc7-git5-smp.
>>>>> Help appreciated.
>>>>> Regards
>>>>> Sid.
>>>> Checked out my Logitech QuickCam Pro 9000 on my other x86_64 box - 
>>>> skype
>>>> and luvcview - and it's fine, so there must be a problem with the 
>>>> driver
>>>> with respect to the CrystalEye.
>>>
>>> -16 means -EBUSY. The camera is probably already in use by another
>>> application.
>>>
>>> Best regards,
>>>
>>> Laurent Pinchart
>>>
>>>
>>
>> Nothing else that would use the camera is running, "lsof /dev/video0" 
>> also confirms that. I've tried 2 other USB webcams, gspca and ov51x, 
>> both work fine.
>> It's either broken hardware or something strange in code. I've run 
>> both strace and gdb against luvcview, no more information. xawtv also 
>> gives EBUSY. I'm restoring XP to another HD to see if I get problems 
>> there also.
>> Regards
>> Sid.
>>
> 
> Whilst restoring XP I remembered the webcam did work. XP restored and 
> the webcam definitely is OK under XP. In with the Linux drive again.
> I always do "svn up" to make sure I have the latest uvcvideo.
> Regards
> Sid.

After upgrading to 2.6.24-rc8, getting different results.
  # luvcview
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 22.
  Init v4L2 failed !! exit fatal

# xawtv -c /dev/video0
This is xawtv-3.95, running on Linux/x86_64 (2.6.24-rc8-smp)
xinerama 0: 1440x900+0+0
WARNING: No DGA support available for this display.
/dev/video0 [v4l2]: no overlay support
v4l-conf had some trouble, trying to continue anyway
ioctl: VIDIOC_G_STD(std=0x7ffff4508444 
[PAL_G,PAL_D1,PAL_Nc,?,SECAM_K,SECAM_L,(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null)]): 
Invalid argument
ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument
ioctl: VIDIOC_DQBUF(index=0;type=VIDEO_CAPTURE;bytesused=0;flags=0x0 
[];field=ANY;;timecode.type=0;timecode.flags=0;timecode.frames=0;timecode.seconds=0;timecode.minutes=0;timecode.hours=0;timecode.userbits="";sequence=0;memory=unknown): 
Invalid argument
ioctl: VIDIOC_DQBUF(index=0;type=VIDEO_CAPTURE;bytesused=0;flags=0x0 
[];field=ANY;;timecode.type=0;timecode.flags=0;timecode.frames=0;timecode.seconds=0;timecode.minutes=0;timecode.hours=0;timecode.userbits="";sequence=0;memory=unknown): 
Invalid argument

Regards
Sid.
-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From laurent.pinchart at skynet.be  Wed Jan 16 22:12:13 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 16 Jan 2008 22:12:13 +0100
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
	problem with luvcview
In-Reply-To: <478E702D.5030001@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
	<478E702D.5030001@blueyonder.co.uk>
Message-ID: <200801162212.13338.laurent.pinchart@skynet.be>

Hi Sid,

On Wednesday 16 January 2008, Sid Boyce wrote:
> Sid Boyce wrote:
>
> After upgrading to 2.6.24-rc8, getting different results.
>   # luvcview
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 22.
>   Init v4L2 failed !! exit fatal
>
> # xawtv -c /dev/video0
> This is xawtv-3.95, running on Linux/x86_64 (2.6.24-rc8-smp)
> xinerama 0: 1440x900+0+0
> WARNING: No DGA support available for this display.
> /dev/video0 [v4l2]: no overlay support
> v4l-conf had some trouble, trying to continue anyway
> ioctl: VIDIOC_G_STD(std=0x7ffff4508444
> [PAL_G,PAL_D1,PAL_Nc,?,SECAM_K,SECAM_L,(null),(null),(null),(null),(null),(
>null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),
>(null),(null),(null),(null)]): Invalid argument
> ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument
> ioctl: VIDIOC_DQBUF(index=0;type=VIDEO_CAPTURE;bytesused=0;flags=0x0
> [];field=ANY;;timecode.type=0;timecode.flags=0;timecode.frames=0;timecode.s
>econds=0;timecode.minutes=0;timecode.hours=0;timecode.userbits="";sequence=0
>;memory=unknown): Invalid argument
> ioctl: VIDIOC_DQBUF(index=0;type=VIDEO_CAPTURE;bytesused=0;flags=0x0
> [];field=ANY;;timecode.type=0;timecode.flags=0;timecode.frames=0;timecode.s
>econds=0;timecode.minutes=0;timecode.hours=0;timecode.userbits="";sequence=0
>;memory=unknown): Invalid argument

xawtv 3.95 has a known bug. Please try luvcview instead.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Jan 16 22:13:41 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 16 Jan 2008 22:13:41 +0100
Subject: [Linux-uvc-devel] Logitech QC 9000 lockup on dwFrameInterval
	change during Skype call
In-Reply-To: <20080116205426.GA18791@kolmann.at>
References: <20071204195929.GA1101@kolmann.at>
	<200801162135.12584.laurent.pinchart@skynet.be>
	<20080116205426.GA18791@kolmann.at>
Message-ID: <200801162213.41361.laurent.pinchart@skynet.be>

On Wednesday 16 January 2008, Philipp Kolmann wrote:
> On Wed, Jan 16, 2008 at 09:35:12PM +0100, Laurent Pinchart wrote:
> > ... and any application log message (I've
> > never used the application but I assume Skype prints messages to a log)
> > related to the problem.
>
> Sadly, Skype logs some stuff, but the log is encrypted and only skype can
> decrypt stuff. :(

To quote your signature, the more I learn about Skype, the more I like Free 
Software...

You can always check the kernel log, that's not encrypted.

Best regards,

Laurent Pinchart


From sboyce at blueyonder.co.uk  Thu Jan 17 01:34:28 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Thu, 17 Jan 2008 00:34:28 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <200801162212.13338.laurent.pinchart@skynet.be>
References: <478C2355.1000802@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
	<478E702D.5030001@blueyonder.co.uk>
	<200801162212.13338.laurent.pinchart@skynet.be>
Message-ID: <478EA294.3070603@blueyonder.co.uk>

Laurent Pinchart wrote:
> Hi Sid,
> 
> On Wednesday 16 January 2008, Sid Boyce wrote:
>> Sid Boyce wrote:
>>
>> After upgrading to 2.6.24-rc8, getting different results.
#### Guessed you missed this.
>>   # luvcview
>> luvcview version 0.2.1
>> Video driver: x11
>> A window manager is available
>> video /dev/video0
>> Unable to set format: 22.
>>   Init v4L2 failed !! exit fatal
>>
# luvcview -l
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 22.
  Init v4L2 failed !! exit fatal
sepulot:~ # luvcview -L
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 352, height = 288 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 320, height = 240 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 176, height = 144 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
{ discrete: width = 160, height = 120 }
         Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,


> xawtv 3.95 has a known bug. Please try luvcview instead.
> 
> Best regards,
> 
> Laurent Pinchart
> 
> 

Regards
Sid.

-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From sboyce at blueyonder.co.uk  Thu Jan 17 04:18:10 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Thu, 17 Jan 2008 03:18:10 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <478EA294.3070603@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
	<478E702D.5030001@blueyonder.co.uk>
	<200801162212.13338.laurent.pinchart@skynet.be>
	<478EA294.3070603@blueyonder.co.uk>
Message-ID: <478EC8F2.80909@blueyonder.co.uk>

Sid Boyce wrote:
> Laurent Pinchart wrote:
>> Hi Sid,
>>
>> On Wednesday 16 January 2008, Sid Boyce wrote:
>>> Sid Boyce wrote:
>>>
>>> After upgrading to 2.6.24-rc8, getting different results.
> #### Guessed you missed this.
>>> # luvcview
>>> luvcview version 0.2.1
>>> Video driver: x11
>>> A window manager is available
>>> video /dev/video0
>>> Unable to set format: 22.
>>> Init v4L2 failed !! exit fatal
>>>
> # luvcview -l
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 22.
> Init v4L2 failed !! exit fatal
> sepulot:~ # luvcview -L
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> /dev/video0 does not support read i/o
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 352, height = 288 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 320, height = 240 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 176, height = 144 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> { discrete: width = 160, height = 120 }
> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> 
> 
>> xawtv 3.95 has a known bug. Please try luvcview instead.
>>
>> Best regards,
>>
>> Laurent Pinchart
>>
>>
> 
> Regards
> Sid.
> 

Seen in  "strace -s 256 -f luvcview -d /dev/video1".
open("/dev/video1", O_RDWR)             = 7
ioctl(7, VIDIOC_QUERYCAP or VT_OPENQRY, 0x64a520) = 0
ioctl(7, VIDIOC_S_FMT or VT_RELDISP, 0x64a588) = -1 EINVAL (Invalid 
argument)
close(7)                                = 0
write(1, "luvcview version 0.2.1 \nVideo driver: x11\nA window manager 
is available\nvideo /dev/video1 \nUnable to set format: 22.\n Init v4L2 
failed !! exit fatal \n", 150luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video1
Unable to set format: 22.
  Init v4L2 failed !! exit fatal
) = 150
exit_group(1)

Problem with format.
Worked finally using "luvcview -f yuv -d /dev/video1".
Regards
Sid.

-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From herton at mandriva.com.br  Thu Jan 17 14:34:17 2008
From: herton at mandriva.com.br (Herton Ronaldo Krzesinski)
Date: Thu, 17 Jan 2008 11:34:17 -0200
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801162105.44785.laurent.pinchart@skynet.be>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801152027.19532.herton@mandriva.com.br>
	<200801162105.44785.laurent.pinchart@skynet.be>
Message-ID: <200801171134.17549.herton@mandriva.com.br>

Em Wednesday 16 January 2008 18:05:44 Laurent Pinchart escreveu:
> On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > Em Tuesday 15 January 2008 20:12:16 Laurent Pinchart escreveu:
> > If I patch luvcview like this:
> >
> > --- v4l2uvc.c.orig      2008-01-15 20:19:57.000000000 -0200
> > +++ v4l2uvc.c   2008-01-15 20:19:40.000000000 -0200
> > @@ -462,6 +462,8 @@ int uvcGrab(struct vdIn *vd)
> >  #define HEADERFRAME1 0xaf
> >      int ret;
> >
> > +    sleep(1);
> > +
> >      if (!vd->isstreaming)
> >         if (video_enable(vd))
> >             goto err;
> >
> > And use luvcview with patched uvcvideo, the behaviour between the two
> > patches is different. With your patch, the stream of video doesn't work
> > well, it captures only the first 1/2 frames and stop. But in stock
> > luvcview without the sleep your patch works fine. The difference here is
> > that with the patch I posted earlier it works in both cases, it doesn't
> > fail with the luvcview patched with sleep.
>
> I see where the problem comes from. Could you please test the attached
> patch ? It should fix the freeze and still prevent the last payload of each
> frame to be discarded.

Yes, tested and everything is ok now with this patch.

>
> Best regards,
>
> Laurent Pinchart

--
[]'s
Herton


From sboyce at blueyonder.co.uk  Thu Jan 17 15:00:12 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Thu, 17 Jan 2008 14:00:12 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <478EC8F2.80909@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
	<478E702D.5030001@blueyonder.co.uk>
	<200801162212.13338.laurent.pinchart@skynet.be>
	<478EA294.3070603@blueyonder.co.uk>
	<478EC8F2.80909@blueyonder.co.uk>
Message-ID: <478F5F6C.5070704@blueyonder.co.uk>

Sid Boyce wrote:
> Sid Boyce wrote:
>> Laurent Pinchart wrote:
>>> Hi Sid,
>>>
>>> On Wednesday 16 January 2008, Sid Boyce wrote:
>>>> Sid Boyce wrote:
>>>>
>>>> After upgrading to 2.6.24-rc8, getting different results.
>> #### Guessed you missed this.
>>>> # luvcview
>>>> luvcview version 0.2.1
>>>> Video driver: x11
>>>> A window manager is available
>>>> video /dev/video0
>>>> Unable to set format: 22.
>>>> Init v4L2 failed !! exit fatal
>>>>
>> # luvcview -l
>> luvcview version 0.2.1
>> Video driver: x11
>> A window manager is available
>> video /dev/video0
>> Unable to set format: 22.
>> Init v4L2 failed !! exit fatal
>> sepulot:~ # luvcview -L
>> luvcview version 0.2.1
>> Video driver: x11
>> A window manager is available
>> video /dev/video0
>> /dev/video0 does not support read i/o
>> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> { discrete: width = 640, height = 480 }
>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>> { discrete: width = 352, height = 288 }
>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>> { discrete: width = 320, height = 240 }
>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>> { discrete: width = 176, height = 144 }
>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>> { discrete: width = 160, height = 120 }
>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>
>>
>>> xawtv 3.95 has a known bug. Please try luvcview instead.
>>>
>>> Best regards,
>>>
>>> Laurent Pinchart
>>>
>>>
>>
>> Regards
>> Sid.
>>
> 
> Seen in "strace -s 256 -f luvcview -d /dev/video1".
> open("/dev/video1", O_RDWR) = 7
> ioctl(7, VIDIOC_QUERYCAP or VT_OPENQRY, 0x64a520) = 0
> ioctl(7, VIDIOC_S_FMT or VT_RELDISP, 0x64a588) = -1 EINVAL (Invalid 
> argument)
> close(7) = 0
> write(1, "luvcview version 0.2.1 \nVideo driver: x11\nA window manager 
> is available\nvideo /dev/video1 \nUnable to set format: 22.\n Init v4L2 
> failed !! exit fatal \n", 150luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video1
> Unable to set format: 22.
> Init v4L2 failed !! exit fatal
> ) = 150
> exit_group(1)
> 
> Problem with format.
> Worked finally using "luvcview -f yuv -d /dev/video1".
> Regards
> Sid.
> 

# luvcview -f jpg -d /dev/video1
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video1
Unable to set format: 22.
  Init v4L2 failed !! exit fatal

Also does not work with skype. No format or other errors seen in skype. 
The only referene in strace for skype:
[pid 19901] open("/dev/video1", O_RDWR|O_NONBLOCK) = 17
[pid 19901] ioctl(17, VIDIOC_QUERYCAP or VT_OPENQRY, 0xf41d1054) = 0
[pid 19901] close(17)
I don't see any strace reference for when I try the skype camera test.

It seems the camera only works with the yuv format.
The Logitech Quickcam Pro 9000 using the same uvcvideo driver on my main 
PC works, so I shall try it on the laptop later. A gspca and a ov51x 
have both work with skype on this laptop.
Regards
Sid.
-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From dionoea at videolan.org  Thu Jan 17 23:00:34 2008
From: dionoea at videolan.org (Antoine Cellerier)
Date: Thu, 17 Jan 2008 23:00:34 +0100
Subject: [Linux-uvc-devel] Dynamic controls
Message-ID: <20080117220034.GA22185@via.ecp.fr>

Hi,

I was wondering what the status of dynamic controls in the UVC driver
was. Is it already used by some apps? If so, how is the application
supposed to know all the possible vendor specific controls? Is a
documentation about dynamic controls usage available somewhere?

Thanks,

-- 
Antoine Cellerier
dionoea


From laurent.pinchart at skynet.be  Fri Jan 18 01:19:45 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 18 Jan 2008 01:19:45 +0100
Subject: [Linux-uvc-devel] Add new sync quirk to uvcvideo and use with
	Syntek 174f:5212
In-Reply-To: <200801171134.17549.herton@mandriva.com.br>
References: <200712281340.17571.herton@mandriva.com.br>
	<200801162105.44785.laurent.pinchart@skynet.be>
	<200801171134.17549.herton@mandriva.com.br>
Message-ID: <200801180119.46086.laurent.pinchart@skynet.be>

On Thursday 17 January 2008, Herton Ronaldo Krzesinski wrote:
> Em Wednesday 16 January 2008 18:05:44 Laurent Pinchart escreveu:
> > On Tuesday 15 January 2008, Herton Ronaldo Krzesinski wrote:
> > > Em Tuesday 15 January 2008 20:12:16 Laurent Pinchart escreveu:
> > > If I patch luvcview like this:
> > >
> > > --- v4l2uvc.c.orig      2008-01-15 20:19:57.000000000 -0200
> > > +++ v4l2uvc.c   2008-01-15 20:19:40.000000000 -0200
> > > @@ -462,6 +462,8 @@ int uvcGrab(struct vdIn *vd)
> > >  #define HEADERFRAME1 0xaf
> > >      int ret;
> > >
> > > +    sleep(1);
> > > +
> > >      if (!vd->isstreaming)
> > >         if (video_enable(vd))
> > >             goto err;
> > >
> > > And use luvcview with patched uvcvideo, the behaviour between the two
> > > patches is different. With your patch, the stream of video doesn't work
> > > well, it captures only the first 1/2 frames and stop. But in stock
> > > luvcview without the sleep your patch works fine. The difference here
> > > is that with the patch I posted earlier it works in both cases, it
> > > doesn't fail with the luvcview patched with sleep.
> >
> > I see where the problem comes from. Could you please test the attached
> > patch ? It should fix the freeze and still prevent the last payload of
> > each frame to be discarded.
>
> Yes, tested and everything is ok now with this patch.

Thanks. I've committed the patch to SVN.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 18 01:26:02 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 18 Jan 2008 01:26:02 +0100
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
	problem with luvcview
In-Reply-To: <478F5F6C.5070704@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478EC8F2.80909@blueyonder.co.uk>
	<478F5F6C.5070704@blueyonder.co.uk>
Message-ID: <200801180126.02731.laurent.pinchart@skynet.be>

On Thursday 17 January 2008, Sid Boyce wrote:
> Sid Boyce wrote:
> > Sid Boyce wrote:
> >> Laurent Pinchart wrote:
> >>> Hi Sid,
> >>>
> >>> On Wednesday 16 January 2008, Sid Boyce wrote:
> >>>> Sid Boyce wrote:
> >>>>
> >>>> After upgrading to 2.6.24-rc8, getting different results.
> >>
> >> #### Guessed you missed this.
> >>
> >>>> # luvcview
> >>>> luvcview version 0.2.1
> >>>> Video driver: x11
> >>>> A window manager is available
> >>>> video /dev/video0
> >>>> Unable to set format: 22.
> >>>> Init v4L2 failed !! exit fatal
> >>
> >> # luvcview -l
> >> luvcview version 0.2.1
> >> Video driver: x11
> >> A window manager is available
> >> video /dev/video0
> >> Unable to set format: 22.
> >> Init v4L2 failed !! exit fatal
> >> sepulot:~ # luvcview -L
> >> luvcview version 0.2.1
> >> Video driver: x11
> >> A window manager is available
> >> video /dev/video0
> >> /dev/video0 does not support read i/o
> >> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> { discrete: width = 640, height = 480 }
> >> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >> { discrete: width = 352, height = 288 }
> >> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >> { discrete: width = 320, height = 240 }
> >> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >> { discrete: width = 176, height = 144 }
> >> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >> { discrete: width = 160, height = 120 }
> >> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
> >>
> >>> xawtv 3.95 has a known bug. Please try luvcview instead.
> >>>
> >>> Best regards,
> >>>
> >>> Laurent Pinchart
> >>
> >> Regards
> >> Sid.
> >
> > Seen in "strace -s 256 -f luvcview -d /dev/video1".
> > open("/dev/video1", O_RDWR) = 7
> > ioctl(7, VIDIOC_QUERYCAP or VT_OPENQRY, 0x64a520) = 0
> > ioctl(7, VIDIOC_S_FMT or VT_RELDISP, 0x64a588) = -1 EINVAL (Invalid
> > argument)
> > close(7) = 0
> > write(1, "luvcview version 0.2.1 \nVideo driver: x11\nA window manager
> > is available\nvideo /dev/video1 \nUnable to set format: 22.\n Init v4L2
> > failed !! exit fatal \n", 150luvcview version 0.2.1
> > Video driver: x11
> > A window manager is available
> > video /dev/video1
> > Unable to set format: 22.
> > Init v4L2 failed !! exit fatal
> > ) = 150
> > exit_group(1)
> >
> > Problem with format.
> > Worked finally using "luvcview -f yuv -d /dev/video1".
> > Regards
> > Sid.
>
> # luvcview -f jpg -d /dev/video1
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video1
> Unable to set format: 22.
>   Init v4L2 failed !! exit fatal

That's pretty normal, your camera supports YUV only. You must use

luvcview -f yuv -d /dev/video1

> Also does not work with skype. No format or other errors seen in skype.
> The only referene in strace for skype:
> [pid 19901] open("/dev/video1", O_RDWR|O_NONBLOCK) = 17
> [pid 19901] ioctl(17, VIDIOC_QUERYCAP or VT_OPENQRY, 0xf41d1054) = 0
> [pid 19901] close(17)
> I don't see any strace reference for when I try the skype camera test.

As Skype is a closed-source software there's not much I can do to find out why 
it doesn't like your camera. You should contact Skype's technical support.

> It seems the camera only works with the yuv format.

That's right.

> The Logitech Quickcam Pro 9000 using the same uvcvideo driver on my main
> PC works, so I shall try it on the laptop later.

The QC Pro 9000 supports both YUV and MJPEG.

> A gspca and a ov51x have both work with skype on this laptop.

Regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 18 01:53:05 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 18 Jan 2008 01:53:05 +0100
Subject: [Linux-uvc-devel] Dynamic controls
In-Reply-To: <20080117220034.GA22185@via.ecp.fr>
References: <20080117220034.GA22185@via.ecp.fr>
Message-ID: <200801180153.05854.laurent.pinchart@skynet.be>

Hi Antoine,

On Thursday 17 January 2008, Antoine Cellerier wrote:
> Hi,
>
> I was wondering what the status of dynamic controls in the UVC driver
> was. Is it already used by some apps? If so, how is the application
> supposed to know all the possible vendor specific controls? Is a
> documentation about dynamic controls usage available somewhere?

"Dynamic controls" is the name of a UVC specific API that lets userspace 
applications declare new controls at runtime. Those controls are then usable 
by any V4L2 compliant application through the V4L2 API.

The uvcdynctrl application shipped with libwebcam 
(http://www.quickcamteam.net/software/libwebcam/) is invoked by udev (or at 
least should be, I'm not sure if the necessary rules are shipped with the 
current version) and use the dynamic controls API to configure the driver 
when a webcam is plugged.

UVC controls can also be accessed directly using UVC specific ioctls. I'm not 
aware of any application doing this at the moment (test applications shipped 
with libwebcam might but I haven't checked this).

Best regards,

Laurent Pinchart


From philipp at kolmann.at  Fri Jan 18 07:45:02 2008
From: philipp at kolmann.at (Philipp Kolmann)
Date: Fri, 18 Jan 2008 07:45:02 +0100
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
	problem with luvcview
In-Reply-To: <478F5F6C.5070704@blueyonder.co.uk>
References: <478C2355.1000802@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
	<478E702D.5030001@blueyonder.co.uk>
	<200801162212.13338.laurent.pinchart@skynet.be>
	<478EA294.3070603@blueyonder.co.uk>
	<478EC8F2.80909@blueyonder.co.uk>
	<478F5F6C.5070704@blueyonder.co.uk>
Message-ID: <20080118064502.GA3139@kolmann.at>

On Thu, Jan 17, 2008 at 02:00:12PM +0000, Sid Boyce wrote:
> Also does not work with skype. No format or other errors seen in skype. 
> The only referene in strace for skype:
> [pid 19901] open("/dev/video1", O_RDWR|O_NONBLOCK) = 17
> [pid 19901] ioctl(17, VIDIOC_QUERYCAP or VT_OPENQRY, 0xf41d1054) = 0
> [pid 19901] close(17)
> I don't see any strace reference for when I try the skype camera test.

Regarding Skype troubles:

1st: enable logging:
https://developer.skype.com/Support/LogFile#head-443d8755e24edad0f80c8d70abe6c2cf5e9015de

    * Close Skype
    * Create directory "Logs" under your Skype data directory (~/.Skype/)
    * Restart Skype
    * Log file (skype_yyyy-mm-dd-hhmmss) will be created in ~/.Skype/Logs
    * To turn off logging again, delete the "Logs" directory 

Then take the logfile (not trace) and open a new thread on the skype forums for linux:

http://forum.skype.com/index.php?showforum=18

There you might get answers.

Philipp

-- 
The more I learn about people, the more I like my dog!


From alex at seewald.at  Fri Jan 18 14:00:45 2008
From: alex at seewald.at (Dr. Alexander K. Seewald)
Date: Fri, 18 Jan 2008 14:00:45 +0100
Subject: [Linux-uvc-devel] Dynamic controls
Message-ID: <20080118130045.GA7821@sdg.at>

Hi Antoine,

My standalone software autofocus application uses dynamic or
static controls, depending on which version of uvcvideo it was
compiled with (recent version -> dynamic controls). If the focus for
QC 9000 has not been configured, it will configure it on the first
run (similar to libwebcam) and use it afterwards. Alternatively, it
uses the control configured by libwebcam. Perhaps taking a quick
look at the code will help.

See http://projects.seewald.at, Software AutoFocus

Best,
  Alex
-- 
Dr. Alexander K. Seewald         +43(664)1106886
              Seewald Solutions                 
------------------------------------------------
  Research & Development for the 21st Century
--------------- www.seewald.at -----------------


From gabrisa at szfki.hu  Fri Jan 18 15:21:28 2008
From: gabrisa at szfki.hu (Aurel Gabris)
Date: Fri, 18 Jan 2008 15:21:28 +0100 (CET)
Subject: [Linux-uvc-devel] ViewSonic VX2255WMB (Chicony 1.3M 04f2:b021)
In-Reply-To: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
References: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
Message-ID: <Pine.LNX.4.64.0801181458420.5263@bibic.local>

Hello Laureant,

Thanks for the quick reaction. (Although I had to read it off the web 
archives: your ISP is being blocked at our site.)

I have produced some logs when passing "trace=0xff" to the module on the 
command line. It's got very long, and I don't know what may be interesting 
and what not. Therefore instead of attaching it the e-mail I've made it 
available at http://optics.szfki.kfki.hu/~gabrisa/outgoing/syslog-04f2:b021

The logs were recorded when I was using luvcvideo and trying to use amsn.

Amsn was runnig in the interval: 14:45:27 -> 14:45:46
ending up with these errors:
ioctl: VIDIOC_S_CTRL(id=9963776;value=25536): Input/output error
ioctl: VIDIOC_S_CTRL(id=9963777;value=32768): Input/output error
Not a JPEG file: starts with 0x3a 0xd7
Oops: malloc_video_bufs is 1 (expected 0) 
[utils/linux/capture/libng/grab-ng.c:malloc_bufs_check:235]
Oops: processes is 1 (expected 0) 
[utils/linux/capture/libng/convert.c:process_check:179]


Luvcvideo was running within 3 intervals: 14:44:47 -> 14:44:51, 14:46:05 
-> 14:46:08, and for a while in the begining but I forgot to document it
I was getting the error: "hmm FW error,not seq DCT ??"
for apparently every frame.
Further, the output JPEGS have "Invalid SOS parameters for sequential 
JPEG"


I tried to remove all other messages from the syslog, however, I had the 
old webcam plugged in, and that generated some v4l messages also.

One more thing that just came into my mind: I have disabled the ehci 
module in the kernel as it was causing problems with the old webcam.

I hope you can figure out what is the problem here...

Aurel


---------------------------------------------------------
Web:    http://www.szfki.hu/~gabrisa
E-mail: gabrisa at szfki.hu
Mobile: +36 (20) 240-50-15
Office: +36 (1) 39-22222/1229
"Ha ezt el tudja olvasni, minden bizonnyal tud magyarul."
---------------------------------------------------------


From sboyce at blueyonder.co.uk  Fri Jan 18 16:57:26 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Fri, 18 Jan 2008 15:57:26 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <200801180126.02731.laurent.pinchart@skynet.be>
References: <478C2355.1000802@blueyonder.co.uk>
	<478EC8F2.80909@blueyonder.co.uk>
	<478F5F6C.5070704@blueyonder.co.uk>
	<200801180126.02731.laurent.pinchart@skynet.be>
Message-ID: <4790CC66.3080502@blueyonder.co.uk>

Laurent Pinchart wrote:
> On Thursday 17 January 2008, Sid Boyce wrote:
>> Sid Boyce wrote:
>>> Sid Boyce wrote:
>>>> Laurent Pinchart wrote:
>>>>> Hi Sid,
>>>>>
>>>>> On Wednesday 16 January 2008, Sid Boyce wrote:
>>>>>> Sid Boyce wrote:
>>>>>>
>>>>>> After upgrading to 2.6.24-rc8, getting different results.
>>>> #### Guessed you missed this.
>>>>
>>>>>> # luvcview
>>>>>> luvcview version 0.2.1
>>>>>> Video driver: x11
>>>>>> A window manager is available
>>>>>> video /dev/video0
>>>>>> Unable to set format: 22.
>>>>>> Init v4L2 failed !! exit fatal
>>>> # luvcview -l
>>>> luvcview version 0.2.1
>>>> Video driver: x11
>>>> A window manager is available
>>>> video /dev/video0
>>>> Unable to set format: 22.
>>>> Init v4L2 failed !! exit fatal
>>>> sepulot:~ # luvcview -L
>>>> luvcview version 0.2.1
>>>> Video driver: x11
>>>> A window manager is available
>>>> video /dev/video0
>>>> /dev/video0 does not support read i/o
>>>> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>>>> { discrete: width = 640, height = 480 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 352, height = 288 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 320, height = 240 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 176, height = 144 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>> { discrete: width = 160, height = 120 }
>>>> Time interval between frame: 1/30, 1/20, 1/15, 1/10, 1/5, 1/1,
>>>>
>>>>> xawtv 3.95 has a known bug. Please try luvcview instead.
>>>>>
>>>>> Best regards,
>>>>>
>>>>> Laurent Pinchart
>>>> Regards
>>>> Sid.
>>> Seen in "strace -s 256 -f luvcview -d /dev/video1".
>>> open("/dev/video1", O_RDWR) = 7
>>> ioctl(7, VIDIOC_QUERYCAP or VT_OPENQRY, 0x64a520) = 0
>>> ioctl(7, VIDIOC_S_FMT or VT_RELDISP, 0x64a588) = -1 EINVAL (Invalid
>>> argument)
>>> close(7) = 0
>>> write(1, "luvcview version 0.2.1 \nVideo driver: x11\nA window manager
>>> is available\nvideo /dev/video1 \nUnable to set format: 22.\n Init v4L2
>>> failed !! exit fatal \n", 150luvcview version 0.2.1
>>> Video driver: x11
>>> A window manager is available
>>> video /dev/video1
>>> Unable to set format: 22.
>>> Init v4L2 failed !! exit fatal
>>> ) = 150
>>> exit_group(1)
>>>
>>> Problem with format.
>>> Worked finally using "luvcview -f yuv -d /dev/video1".
>>> Regards
>>> Sid.
>> # luvcview -f jpg -d /dev/video1
>> luvcview version 0.2.1
>> Video driver: x11
>> A window manager is available
>> video /dev/video1
>> Unable to set format: 22.
>>   Init v4L2 failed !! exit fatal
> 
> That's pretty normal, your camera supports YUV only. You must use
> 
> luvcview -f yuv -d /dev/video1
> 
>> Also does not work with skype. No format or other errors seen in skype.
>> The only referene in strace for skype:
>> [pid 19901] open("/dev/video1", O_RDWR|O_NONBLOCK) = 17
>> [pid 19901] ioctl(17, VIDIOC_QUERYCAP or VT_OPENQRY, 0xf41d1054) = 0
>> [pid 19901] close(17)
>> I don't see any strace reference for when I try the skype camera test.
> 
> As Skype is a closed-source software there's not much I can do to find out why
> it doesn't like your camera. You should contact Skype's technical support.
> 
>> It seems the camera only works with the yuv format.
> 
> That's right.
> 
>> The Logitech Quickcam Pro 9000 using the same uvcvideo driver on my main
>> PC works, so I shall try it on the laptop later.
> 
> The QC Pro 9000 supports both YUV and MJPEG.
> 
>> A gspca and a ov51x have both work with skype on this laptop.
> 
> Regards,
> 
> Laurent Pinchart
> 
> 

Good idea, I was thinking along those lines also, so the next version of 
skype supports both.
Regards
Sid.

-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From sboyce at blueyonder.co.uk  Fri Jan 18 17:28:59 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Fri, 18 Jan 2008 16:28:59 +0000
Subject: [Linux-uvc-devel] Acer Notebook Suyin CrystalEye 064e:a101
 problem with luvcview
In-Reply-To: <20080118064502.GA3139@kolmann.at>
References: <478C2355.1000802@blueyonder.co.uk>
	<478E12EF.7010607@blueyonder.co.uk>
	<478E702D.5030001@blueyonder.co.uk>
	<200801162212.13338.laurent.pinchart@skynet.be>
	<478EA294.3070603@blueyonder.co.uk>
	<478EC8F2.80909@blueyonder.co.uk>
	<478F5F6C.5070704@blueyonder.co.uk>
	<20080118064502.GA3139@kolmann.at>
Message-ID: <4790D3CB.9070205@blueyonder.co.uk>

Philipp Kolmann wrote:
> On Thu, Jan 17, 2008 at 02:00:12PM +0000, Sid Boyce wrote:
>> Also does not work with skype. No format or other errors seen in skype.
>> The only referene in strace for skype:
>> [pid 19901] open("/dev/video1", O_RDWR|O_NONBLOCK) = 17
>> [pid 19901] ioctl(17, VIDIOC_QUERYCAP or VT_OPENQRY, 0xf41d1054) = 0
>> [pid 19901] close(17)
>> I don't see any strace reference for when I try the skype camera test.
> 
> Regarding Skype troubles:
> 
> 1st: enable logging:
> https://developer.skype.com/Support/LogFile#head-443d8755e24edad0f80c8d70abe6c2cf5e9015de
> 
>     * Close Skype
>     * Create directory "Logs" under your Skype data directory (~/.Skype/)
>     * Restart Skype
>     * Log file (skype_yyyy-mm-dd-hhmmss) will be created in ~/.Skype/Logs
>     * To turn off logging again, delete the "Logs" directory
> 
> Then take the logfile (not trace) and open a new thread on the skype forums for linux:
> 
> http://forum.skype.com/index.php?showforum=18
> 
> There you might get answers.
> 
> Philipp
> 

Thanks, submitted to skype forum.
Regards
Sid.

-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From gabrisa at szfki.hu  Fri Jan 18 21:40:49 2008
From: gabrisa at szfki.hu (Aurel Gabris)
Date: Fri, 18 Jan 2008 21:40:49 +0100 (CET)
Subject: [Linux-uvc-devel] ViewSonic VX2255WMB (Chicony 1.3M 04f2:b021)
In-Reply-To: <Pine.LNX.4.64.0801181458420.5263@bibic.local>
References: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
	<Pine.LNX.4.64.0801181458420.5263@bibic.local>
Message-ID: <Pine.LNX.4.64.0801182136530.5263@bibic.local>

On Fri, 18 Jan 2008, Aurel Gabris wrote:

> The logs were recorded when I was using luvcvideo and trying to use amsn.

Just a little report: I've finally managed to build and install the Debian 
package for Ekiga 2.0.11 on Debian Etch. The webcam with this version 
seems to work fine when using v4l2.

I still have the problems with amsn, though, and that's the application 
I'm using usually.

Aurel

---------------------------------------------------------
Web:    http://www.szfki.hu/~gabrisa
"Ha ezt el tudja olvasni, minden bizonnyal tud magyarul."
---------------------------------------------------------


From jice at free.fr  Fri Jan 18 23:29:09 2008
From: jice at free.fr (Jean-Christophe Jice Cardot)
Date: Fri, 18 Jan 2008 23:29:09 +0100
Subject: [Linux-uvc-devel] supported device Philips SPC1000NC
In-Reply-To: <200801102216.47839.laurent.pinchart@skynet.be>
References: <200712272349.18294.jice@free.fr> <200712291317.19829.jice@free.fr>
	<200801102216.47839.laurent.pinchart@skynet.be>
Message-ID: <200801182329.09609.jice@free.fr>

Le jeudi 10 janvier 2008, vous avez ?crit :

> > so now I've a work-around, but still I'd like to help it work on the USB2
> > controller if it suits you, because maybe others will have the same
> > problem...
>
> It looks like the camera crashes. I guess the timing is somehow wrong. It's
> very difficult to find a good workaround without knowing exactly why the
> camera crashes, and that's difficult to know without access to the
> firmware's source code.
>
> If you already have a workaround, and as long as nobody else experiences
> the issue, I'd leave it as is.

tested with rev 170 and same behaviour.

anyway it seems I have always 4-5 fps, be it USB 1 or 2 (is this normal?), so 
as it works on my USB1 controler, I'll use this one.

regards

-- 
Jean-Christophe "Jic?" Cardot - cofondateur de http://lea-linux.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080118/f933396c/attachment.pgp>

From jice at free.fr  Fri Jan 18 23:47:11 2008
From: jice at free.fr (Jean-Christophe Jice Cardot)
Date: Fri, 18 Jan 2008 23:47:11 +0100
Subject: [Linux-uvc-devel] SPC1000N PHilips
In-Reply-To: <200801102113.03302.laurent.pinchart@skynet.be>
References: <2aaf68290801040146l1a9e557j89e15d6620519204@mail.gmail.com>
	<200801102113.03302.laurent.pinchart@skynet.be>
Message-ID: <200801182347.11568.jice@free.fr>

Le jeudi 10 janvier 2008, Laurent Pinchart a ?crit :
> Hi Jean-Charles,
>
> On Friday 04 January 2008, jean-charles klingler wrote:
> > By adding this on uvc_driver.c
> >
> >     /* SPC1000N PHILIPS - Unknown vendor */
> >     { .match_flags        = USB_DEVICE_ID_MATCH_DEVICE
> >
> >                 | USB_DEVICE_ID_MATCH_INT_INFO,
> >
> >       .idVendor        = 0x0471,
> >       .idProduct        = 0x0332,
> >       .bInterfaceClass    = USB_CLASS_VENDOR_SPEC,
> >       .bInterfaceSubClass    = 1,
> >       .bInterfaceProtocol    = 0,
> >     },
> > it makes my philips SPC1000N getting an output image or video with xawtv.
> > Is it possible to integer the idvendor and product to the next svn ?
>
> A user reported success with his SPC1000 without the above patch. Could you
> please make sure it's really needed ? If so, please send me the output of
> lsusb -v (using usbutils 0.72 or newer).

I'm this user ;)

It works fine without the above patch, but I never managed to have xawtv 
working. How did you do this Jean-Charles?
Did you try luvcview also?

by the way you wrote "SPC1000N" and my webcam is a SPC1000NC. Is the 
missing "C" a typo?

++

-- 
Jean-Christophe "Jic?" Cardot - cofondateur de http://lea-linux.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080118/cc548089/attachment.pgp>

From laurent.pinchart at skynet.be  Sat Jan 19 12:47:29 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 19 Jan 2008 12:47:29 +0100
Subject: [Linux-uvc-devel] ViewSonic VX2255WMB (Chicony 1.3M 04f2:b021)
In-Reply-To: <Pine.LNX.4.64.0801181458420.5263@bibic.local>
References: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
	<Pine.LNX.4.64.0801181458420.5263@bibic.local>
Message-ID: <200801191247.30047.laurent.pinchart@skynet.be>

Hi Aurel,

On Friday 18 January 2008, Aurel Gabris wrote:
> Hello Laureant,
>
> Thanks for the quick reaction. (Although I had to read it off the web
> archives: your ISP is being blocked at our site.)
>
> I have produced some logs when passing "trace=0xff" to the module on the
> command line. It's got very long, and I don't know what may be interesting
> and what not. Therefore instead of attaching it the e-mail I've made it
> available at http://optics.szfki.kfki.hu/~gabrisa/outgoing/syslog-04f2:b021
>
> The logs were recorded when I was using luvcvideo and trying to use amsn.
>
> Amsn was runnig in the interval: 14:45:27 -> 14:45:46
> ending up with these errors:
> ioctl: VIDIOC_S_CTRL(id=9963776;value=25536): Input/output error
> ioctl: VIDIOC_S_CTRL(id=9963777;value=32768): Input/output error
> Not a JPEG file: starts with 0x3a 0xd7
> Oops: malloc_video_bufs is 1 (expected 0)
> [utils/linux/capture/libng/grab-ng.c:malloc_bufs_check:235]
> Oops: processes is 1 (expected 0)
> [utils/linux/capture/libng/convert.c:process_check:179]
>
>
> Luvcvideo was running within 3 intervals: 14:44:47 -> 14:44:51, 14:46:05
> -> 14:46:08, and for a while in the begining but I forgot to document it
> I was getting the error: "hmm FW error,not seq DCT ??"
> for apparently every frame.
> Further, the output JPEGS have "Invalid SOS parameters for sequential
> JPEG"
>
>
> I tried to remove all other messages from the syslog, however, I had the
> old webcam plugged in, and that generated some v4l messages also.
>
> One more thing that just came into my mind: I have disabled the ehci
> module in the kernel as it was causing problems with the old webcam.
>
> I hope you can figure out what is the problem here...

It seems many USB packets are dropped. You should load the ehci module and 
plug the webcam in a root USB port if it's currently plugged in a USB hub.

Best regards,

Laurent Pinchart


From t.st1 at gmx.net  Sun Jan 20 17:17:30 2008
From: t.st1 at gmx.net (Tom St)
Date: Sun, 20 Jan 2008 17:17:30 +0100
Subject: [Linux-uvc-devel] Dynamic controls
In-Reply-To: <20080117220034.GA22185@via.ecp.fr>
References: <20080117220034.GA22185@via.ecp.fr>
Message-ID: <4793741A.2030709@gmx.net>

Hi Antoine,
I also managed to integrate initialisation of dynctrls now. First i
adopted the code of Mr. Seewald and his initialisation of focus-control.
Yesterday I received a patch written by someone called "Toyota".
Unluckily the patch was not send to me directly, so i am not sure who 
the original author is. However I adopted his code and integrated it:
http://mjpg-streamer.svn.sourceforge.net/viewvc/mjpg-streamer/mjpg-streamer/plugins/input_uvc/dynctrl.c?view=markup

My motivation to initialize the logitech controls (pan/tilt/focus) in
mjpg-streamer emerged because compiling libwebcam and the tools was not
easy. To disable initialisation a command line switch can prevent the
initialisation, if libwebcam will get part of distributions the default
will be to disable my initialisation as default option.

Writing a standalone application with the "dynctrl.c" above should be 
easy. The "official" way (using libwebcam) is better, as soon as more 
webcams and different features/controls will show up. It really depends 
on your needs, I assume my approach is not the cleanest one for use on 
PC where size and dependencies do not matter that much.

Kind regards,
Tom

Antoine Cellerier schrieb:
> Hi,
>
> I was wondering what the status of dynamic controls in the UVC driver
> was. Is it already used by some apps? If so, how is the application
> supposed to know all the possible vendor specific controls? Is a
> documentation about dynamic controls usage available somewhere?
>
> Thanks,
>
>   




From rossen at webhydra.com  Tue Jan 22 00:57:41 2008
From: rossen at webhydra.com (Rossen Raykov)
Date: Mon, 21 Jan 2008 18:57:41 -0500
Subject: [Linux-uvc-devel] Creative Live! Cam Voice
Message-ID: <1200959861.28729.5.camel@pe1800.home.webhydra.com>

Hi All,

I have Creative Live! Cam Voice and I wonder if it is going to be
supported or if there is anything I can do to help this happen.

When attached to the USB it reports the following two devices:


T:  Bus=04 Lev=05 Prnt=42 Port=00 Cnt=01 Dev#= 43 Spd=12  MxCh= 0
D:  Ver= 1.10 Cls=00(>ifc ) Sub=00 Prot=00 MxPS= 8 #Cfgs=  1
P:  Vendor=041e ProdID=4048 Rev= 0.ff
C:* #Ifs= 2 Cfg#= 1 Atr=80 MxPwr= 90mA
I:* If#= 0 Alt= 0 #EPs= 0 Cls=01(audio) Sub=01 Prot=00
Driver=snd-usb-audio
I:* If#= 1 Alt= 0 #EPs= 0 Cls=01(audio) Sub=02 Prot=00
Driver=snd-usb-audio
I:  If#= 1 Alt= 1 #EPs= 1 Cls=01(audio) Sub=02 Prot=00
Driver=snd-usb-audio
E:  Ad=81(I) Atr=05(Isoc) MxPS= 100 Ivl=1ms
I:  If#= 1 Alt= 2 #EPs= 1 Cls=01(audio) Sub=02 Prot=00
Driver=snd-usb-audio
E:  Ad=81(I) Atr=05(Isoc) MxPS= 200 Ivl=1ms

T:  Bus=04 Lev=05 Prnt=42 Port=01 Cnt=02 Dev#= 44 Spd=480 MxCh= 0
D:  Ver= 2.00 Cls=00(>ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1
P:  Vendor=041e ProdID=4045 Rev= 1.02
S:  Product=Live! Cam Voice
C:* #Ifs= 1 Cfg#= 1 Atr=80 MxPwr=  0mA
I:* If#= 0 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=81(I) Atr=01(Isoc) MxPS=   0 Ivl=125us
E:  Ad=82(I) Atr=03(Int.) MxPS=   0 Ivl=1ms
I:  If#= 0 Alt= 1 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=81(I) Atr=01(Isoc) MxPS=3072 Ivl=125us
E:  Ad=82(I) Atr=03(Int.) MxPS=  16 Ivl=1ms
I:  If#= 0 Alt= 2 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=81(I) Atr=01(Isoc) MxPS=2688 Ivl=125us
E:  Ad=82(I) Atr=03(Int.) MxPS=  16 Ivl=1ms
I:  If#= 0 Alt= 3 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=81(I) Atr=01(Isoc) MxPS=2112 Ivl=125us
E:  Ad=82(I) Atr=03(Int.) MxPS=  16 Ivl=1ms


Rossen



From laurent.pinchart at skynet.be  Tue Jan 22 10:19:47 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 22 Jan 2008 10:19:47 +0100
Subject: [Linux-uvc-devel] Creative Live! Cam Voice
In-Reply-To: <1200959861.28729.5.camel@pe1800.home.webhydra.com>
References: <1200959861.28729.5.camel@pe1800.home.webhydra.com>
Message-ID: <200801221019.47266.laurent.pinchart@skynet.be>

Hi Rossen,

On Tuesday 22 January 2008 00:57, Rossen Raykov wrote:
> Hi All,
>
> I have Creative Live! Cam Voice and I wonder if it is going to be
> supported or if there is anything I can do to help this happen.

The Creative Live! Cam Voice is not UVC compatible. It won't be supported by 
the Linux UVC driver. Sorry.

> When attached to the USB it reports the following two devices:
>
> T:  Bus=04 Lev=05 Prnt=42 Port=00 Cnt=01 Dev#= 43 Spd=12  MxCh= 0
> D:  Ver= 1.10 Cls=00(>ifc ) Sub=00 Prot=00 MxPS= 8 #Cfgs=  1
> P:  Vendor=041e ProdID=4048 Rev= 0.ff
> C:* #Ifs= 2 Cfg#= 1 Atr=80 MxPwr= 90mA
> I:* If#= 0 Alt= 0 #EPs= 0 Cls=01(audio) Sub=01 Prot=00
> Driver=snd-usb-audio
> I:* If#= 1 Alt= 0 #EPs= 0 Cls=01(audio) Sub=02 Prot=00
> Driver=snd-usb-audio
> I:  If#= 1 Alt= 1 #EPs= 1 Cls=01(audio) Sub=02 Prot=00
> Driver=snd-usb-audio
> E:  Ad=81(I) Atr=05(Isoc) MxPS= 100 Ivl=1ms
> I:  If#= 1 Alt= 2 #EPs= 1 Cls=01(audio) Sub=02 Prot=00
> Driver=snd-usb-audio
> E:  Ad=81(I) Atr=05(Isoc) MxPS= 200 Ivl=1ms
>
> T:  Bus=04 Lev=05 Prnt=42 Port=01 Cnt=02 Dev#= 44 Spd=480 MxCh= 0
> D:  Ver= 2.00 Cls=00(>ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1
> P:  Vendor=041e ProdID=4045 Rev= 1.02
> S:  Product=Live! Cam Voice
> C:* #Ifs= 1 Cfg#= 1 Atr=80 MxPwr=  0mA
> I:* If#= 0 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
> E:  Ad=81(I) Atr=01(Isoc) MxPS=   0 Ivl=125us
> E:  Ad=82(I) Atr=03(Int.) MxPS=   0 Ivl=1ms
> I:  If#= 0 Alt= 1 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
> E:  Ad=81(I) Atr=01(Isoc) MxPS=3072 Ivl=125us
> E:  Ad=82(I) Atr=03(Int.) MxPS=  16 Ivl=1ms
> I:  If#= 0 Alt= 2 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
> E:  Ad=81(I) Atr=01(Isoc) MxPS=2688 Ivl=125us
> E:  Ad=82(I) Atr=03(Int.) MxPS=  16 Ivl=1ms
> I:  If#= 0 Alt= 3 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
> E:  Ad=81(I) Atr=01(Isoc) MxPS=2112 Ivl=125us
> E:  Ad=82(I) Atr=03(Int.) MxPS=  16 Ivl=1ms

Best regards,

Laurent Pinchart


From michel.stempin at wanadoo.fr  Wed Jan 23 12:14:59 2008
From: michel.stempin at wanadoo.fr (Michel Stempin)
Date: Wed, 23 Jan 2008 12:14:59 +0100 (CET)
Subject: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
Message-ID: <15152143.158281201086899709.JavaMail.www@wwinf1b02>

Hi list,

I stumbled upon the timing problem with the QuickCam Sphere MP.

Fortunately, I found Evgeny's patch. It was rather outdated, since code has undergone a lot of code refactoring since then. So, I had to adapt it to the last code (rev 173) in SVN.

I had to modify it a little, since I was blocked before submitting the first URB, as dev->last_urb was initialized to 0. I also added some code to resend all URBs.

Don't forget to define UVC_RESET_ON_TIMEOUT if you want the reset feature.

I hope this will be useful to someone.

Regards,

-- 
Michel Stempin

Index: uvc_status.c
===================================================================
--- uvc_status.c        (r?vision 173)
+++ uvc_status.c        (copie de travail)
@@ -96,9 +96,14 @@
        /* Resubmit the URB. */
        urb->interval = dev->int_ep->desc.bInterval;
        if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
-               uvc_printk(KERN_ERR, "Failed to resubmit status URB (%d).\n",
-                       ret);
+               if (ret == -EL2NSYNC) {
+                       if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
+                               uvc_printk(KERN_ERR, "Failed to resubmit status URB (%d).\n",
+                                       ret);
+                       }
+               }
        }
+       dev->last_urb = jiffies;
 }
 
 int uvc_status_init(struct uvc_device *dev)
@@ -106,6 +111,7 @@
        struct usb_host_endpoint *ep = dev->int_ep;
        unsigned int pipe;
        int interval;
+       int ret = 0;
 
        if (ep == NULL)
                return 0;
@@ -128,7 +134,16 @@
                dev->status, sizeof dev->status, uvc_status_complete,
                dev, interval);
 
-       return usb_submit_urb(dev->int_urb, GFP_KERNEL);
+       if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL)) < 0) {
+               if (ret == -EL2NSYNC) {
+                       if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL)) < 0) {
+                               uvc_printk(KERN_ERR, "Failed to resubmit status URB (%d).\n",
+                                       ret);
+                       }
+               }
+       }
+       dev->last_urb = jiffies;
+       return ret;
 }
 
 void uvc_status_cleanup(struct uvc_device *dev)
@@ -145,9 +160,19 @@
 
 int uvc_status_resume(struct uvc_device *dev)
 {
+       int ret = 0;
        if (dev->int_urb == NULL)
                return 0;
 
-       return usb_submit_urb(dev->int_urb, GFP_KERNEL);
+       if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL)) < 0) {
+               if (ret == -EL2NSYNC) {
+                       if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL)) < 0) {
+                               uvc_printk(KERN_ERR, "Failed to resubmit status URB (%d).\n",
+                                       ret);
+                       }
+               }
+       }
+       dev->last_urb = jiffies;
+       return ret;
 }
 
Index: uvc_video.c
===================================================================
--- uvc_video.c (r?vision 173)
+++ uvc_video.c (copie de travail)
@@ -38,18 +38,37 @@
        __u8 type = USB_TYPE_CLASS | USB_RECIP_INTERFACE;
        unsigned int pipe;
        int ret;
+       int delayed = 0;
 
        pipe = (query & 0x80) ? usb_rcvctrlpipe(dev->udev, 0)
                              : usb_sndctrlpipe(dev->udev, 0);
        type |= (query & 0x80) ? USB_DIR_IN : USB_DIR_OUT;
 
+       if (dev->last_urb) {
+               while (time_before(jiffies,dev->last_urb + 2)) {
+                       schedule();
+                       delayed = 1;
+               }
+       }
+
        ret = usb_control_msg(dev->udev, pipe, query, type, cs << 8,
                        unit << 8 | intfnum, data, size, timeout);
+       dev->last_urb = jiffies;
 
        if (ret != size) {
                uvc_printk(KERN_ERR, "Failed to query (%u) UVC control %u "
                        "(unit %u) : %d (exp. %u).\n", query, cs, unit, ret,
                        size);
+               if (delayed) {
+                       uvc_printk(KERN_ERR,"usb_control_msg was delayed\n");
+               } else {
+                       uvc_printk(KERN_ERR,"usb_control_msg was NOT delayed\n");
+               }
+#ifdef UVC_RESET_ON_TIMEOUT
+               if (ret == -ETIMEDOUT) // reset the device in case of -110 error
+                       dev->state |= UVC_DEV_IOERROR;
+#endif
+
                return -EIO;
        }
 
@@ -528,9 +547,15 @@
        video->decode(urb, video, buf);
 
        if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
-               uvc_printk(KERN_ERR, "Failed to resubmit video URB (%d).\n",
-                       ret);
-        }
+
+               if (ret == -EL2NSYNC) {
+                       if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
+                               uvc_printk(KERN_ERR, "Failed to resubmit video URB (%d).\n",
+                                       ret);
+                       }
+               }
+       }
+       video->dev->last_urb = jiffies;
 }
 
 /*
@@ -748,6 +773,7 @@
                        return ret;
                }
        }
+       video->dev->last_urb = jiffies;
 
        return 0;
 }
Index: uvc_v4l2.c
===================================================================
--- uvc_v4l2.c  (r?vision 173)
+++ uvc_v4l2.c  (copie de travail)
@@ -461,6 +461,12 @@
                mutex_unlock(&video->queue.mutex);
        }
 
+#ifdef UVC_RESET_ON_TIMEOUT
+       /* leave usb device in a clean state */
+       if (video->dev->state & UVC_DEV_IOERROR)
+               uvc_video_reinit(video);
+#endif
+
        /* Release the file handle. */
        uvc_dismiss_privileges(handle);
        kfree(handle);
Index: uvc_driver.c
===================================================================
--- uvc_driver.c        (r?vision 173)
+++ uvc_driver.c        (copie de travail)
@@ -156,6 +156,52 @@
        return 0;
 }
 
+#ifdef UVC_RESET_ON_TIMEOUT
+/* 
+ * Reset and Re-Initialize video device
+ */
+int uvc_video_reinit(struct uvc_video_device *video)
+{
+       int ret;
+
+       if ((ret = uvc_usb_reset(video->dev)) < 0)
+               return ret;
+
+       if ((ret = uvc_set_video_ctrl(video, &video->streaming->ctrl, 0)) < 0) {
+               uvc_printk(KERN_DEBUG, "uvc_video_reinit: Unable to commit format "
+                          "(%d).\n", ret);
+               return ret;
+       }
+
+       return 0;
+}
+
+
+int uvc_usb_reset(struct uvc_device *dev)
+{
+       int l, ret;
+
+       l = usb_lock_device_for_reset(dev->udev, dev->intf);
+
+       if (l >= 0) {
+               ret = usb_reset_device(dev->udev);
+               if (l)
+                       usb_unlock_device(dev->udev);
+       }
+       else
+               ret = -EBUSY;
+
+       if (ret)
+               uvc_printk(KERN_DEBUG, "uvc_usb_reset: Unable to reset usb device"
+                          "(%d).\n", ret);
+       else
+               dev->state &= ~UVC_DEV_IOERROR;
+
+       return ret;
+}
+#endif
+
+
 /* Simplify a fraction using a simple continued fraction decomposition. The
  * idea here is to convert fractions such as 333333/10000000 to 1/30 using
  * 32 bit arithmetic only. The algorithm is not perfect and relies upon two
@@ -1413,9 +1459,23 @@
         * parameters.
         */
        if ((ret = uvc_video_init(&dev->video)) < 0) {
+#ifdef UVC_RESET_ON_TIMEOUT
+               uvc_printk(KERN_ERR, "Failed to initialize the device, "
+                          "(%d). trying to reset ...\n", ret);
+
+               if ((ret = uvc_usb_reset(dev)))
+                       return ret;
+
+               if ((ret = uvc_video_init(&dev->video)) < 0) {
+                       uvc_printk(KERN_ERR, "Failed to initialize the device "
+                                  "(%d).\n", ret);
+                       return ret;
+               }
+#else
                uvc_printk(KERN_ERR, "Failed to initialize the device "
                        "(%d).\n", ret);
                return ret;
+#endif
        }
 
        /* Register the device with V4L. */
@@ -1534,6 +1594,7 @@
        dev->udev = usb_get_dev(udev);
        dev->intf = usb_get_intf(intf);
        dev->intfnum = intf->cur_altsetting->desc.bInterfaceNumber;
+       dev->last_urb = 0;
        dev->quirks = id->driver_info;
 
        /* Parse the Video Class control descriptor */
Index: uvcvideo.h
===================================================================
--- uvcvideo.h  (r?vision 173)
+++ uvcvideo.h  (copie de travail)
@@ -324,6 +324,9 @@
 #define UVC_FMT_FLAG_COMPRESSED                0x00000001
 #define UVC_FMT_FLAG_STREAM            0x00000002
 
+/* Uncomment this to enable reset-on-timeout*/
+//#define UVC_RESET_ON_TIMEOUT
+
 /* ------------------------------------------------------------------------
  * Structures.
  */
@@ -608,6 +611,11 @@
 
 enum uvc_device_state {
        UVC_DEV_DISCONNECTED = 1,
+
+#ifdef UVC_RESET_ON_TIMEOUT
+       UVC_DEV_IOERROR = 2,
+#endif
+
 };
 
 struct uvc_device {
@@ -617,6 +625,7 @@
        int intfnum;
 
        enum uvc_device_state state;
+       unsigned long last_urb;
        struct kref kref;
        struct list_head list;
 
@@ -777,6 +786,14 @@
 extern struct usb_host_endpoint *uvc_find_endpoint(
                struct usb_host_interface *alts, __u8 epaddr);
 
+
+#ifdef UVC_RESET_ON_TIMEOUT
+
+extern int uvc_video_reinit(struct uvc_video_device *video);
+extern int uvc_usb_reset(struct uvc_device *dev);
+
+#endif
+
 /* Quirks support */
 void uvc_video_decode_isight (struct urb *urb, struct uvc_video_device *video, 
                struct uvc_buffer *buf);




From gabrisa at szfki.hu  Thu Jan 24 18:40:58 2008
From: gabrisa at szfki.hu (Aurel Gabris)
Date: Thu, 24 Jan 2008 18:40:58 +0100 (CET)
Subject: [Linux-uvc-devel] ViewSonic VX2255WMB (Chicony 1.3M 04f2:b021)
In-Reply-To: <200801191247.30047.laurent.pinchart@skynet.be>
References: <Pine.LNX.4.64.0801142124390.13899@bird.szfki.kfki.hu>
	<Pine.LNX.4.64.0801181458420.5263@bibic.local>
	<200801191247.30047.laurent.pinchart@skynet.be>
Message-ID: <Pine.LNX.4.64.0801241819060.5441@bibic.local>

Hi Laurent,

First of all, it seems that I have a problem with my on-board usb 2.0 
controller. Even after upgrading the BIOS to the most recent one, the USB 
2.0 host writes this into the syslog:
usb 4-2: new high speed USB device using ehci_hcd and address 3
usb 4-2: unable to read config index 0 descriptor/start
usb 4-2: chopping to 0 config(s)
usb 4-2: string descriptor 0 read error: -71
usb 4-2: string descriptor 0 read error: -71
usb 4-2: string descriptor 0 read error: -71
usb 4-2: no configuration chosen from 0 choices

(the camera is plugged directly into a port on the motherboard, using the 
cable that came with the monitor)

I've spent hours searching the web for a solution, but no success... I 
have upgraded to latest kernel, latest BIOS: nothing. Interestingly, it 
does seem to work in Windows! Anyway, I just thought I'll mention this, 
perhaps you have some ideas...

On the other hand, I tested the webcam with another machine (where USB 2.0 
worked). I tested both with and without the ehci-hcd module. With USB 2.0 
enabled everything was working fine:
  luvcview (0.2.1)
  amsn  (0.97b)
  ekiga (2.0.11)

When I unloaded ehci-hcd and left the USB only with ohci-hcd, I was 
receiving the same errors as I've reported in my last post. So, in 
nutshell luvcview and ekiga was basically usable, but amsn mostly died.


There's one strange thing you may be interested in:

With USB 2.0, luvcview can only use the yuv format: jpg dies with "Unable 
to set format: 22".

With USB 1.1, it behaves the contrary: only "-f jpg" works.

I wonder if this is on purpose. If not, I could send you some trace logs.


So, in summary you can probably include this webcam on the supported list 
(limited support with USB 1.1). I'm going to copy here the full outputs of 
'lsusb -v' both when the EHCI module was loaded, and when I used it with 
OHCI. The latter may be interesting for you if you'd like to go into the 
yuv<->jpg format issue.

Best regards,
  Aurel


With ehci-hcd loaded:

Bus 003 Device 002: ID 04f2:b021 Chicony Electronics Co., Ltd 
Device Descriptor:
   bLength                18
   bDescriptorType         1
   bcdUSB               2.00
   bDeviceClass          239 Miscellaneous Device
   bDeviceSubClass         2 Common Class
   bDeviceProtocol         1 Interface Association
   bMaxPacketSize0        64
   idVendor           0x04f2 Chicony Electronics Co., Ltd
   idProduct          0xb021
   bcdDevice            3.54
   iManufacturer           2 Chicony Electronics Co., Ltd.
   iProduct                1 ViewSonic 1.3M, USB2.0 Webcam
   iSerial                 3 SN0001
   bNumConfigurations      1
   Configuration Descriptor:
     bLength                 9
     bDescriptorType         2
     wTotalLength          591
     bNumInterfaces          2
     bConfigurationValue     1
     iConfiguration          0
     bmAttributes         0x80
       (Bus Powered)
     MaxPower               98mA
     Interface Association:
       bLength                 8
       bDescriptorType        11
       bFirstInterface         0
       bInterfaceCount         2
       bFunctionClass         14 Video
       bFunctionSubClass       3 Video Interface Collection
       bFunctionProtocol       0
       iFunction               1 ViewSonic 1.3M, USB2.0 Webcam
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        0
       bAlternateSetting       0
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      1 Video Control
       bInterfaceProtocol      0
       iInterface              1 ViewSonic 1.3M, USB2.0 Webcam
       VideoControl Interface Descriptor:
         bLength                13
         bDescriptorType        36
         bDescriptorSubtype      1 (HEADER)
         bcdUVC               1.00
         wTotalLength          103
         dwClockFrequency       15.000000MHz
         bInCollection           1
         baInterfaceNr( 0)       1
       VideoControl Interface Descriptor:
         bLength                 9
         bDescriptorType        36
         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
         bTerminalID             2
         wTerminalType      0x0101 USB Streaming
         bAssocTerminal          0
         bSourceID               5
         iTerminal               0
       VideoControl Interface Descriptor:
         bLength                26
         bDescriptorType        36
         bDescriptorSubtype      6 (EXTENSION_UNIT)
         bUnitID                 4
         guidExtensionCode         {28f03370-6311-4a2e-ba2c-6890eb334016}
         bNumControl             8
         bNrPins                 1
         baSourceID( 0)          3
         bControlSize            1
         bmControls( 0)       0x0f
         iExtension              0
       VideoControl Interface Descriptor:
         bLength                26
         bDescriptorType        36
         bDescriptorSubtype      6 (EXTENSION_UNIT)
         bUnitID                 5
         guidExtensionCode         {2812ae3f-bcd7-4e11-a357-6f1edef7d61d}
         bNumControl             8
         bNrPins                 1
         baSourceID( 0)          4
         bControlSize            1
         bmControls( 0)       0x01
         iExtension              0
       VideoControl Interface Descriptor:
         bLength                18
         bDescriptorType        36
         bDescriptorSubtype      2 (INPUT_TERMINAL)
         bTerminalID             1
         wTerminalType      0x0201 Camera Sensor
         bAssocTerminal          0
         iTerminal               0
         wObjectiveFocalLengthMin      0
         wObjectiveFocalLengthMax      0
         wOcularFocalLength            0
         bControlSize                  3
         bmControls           0x00000000
       VideoControl Interface Descriptor:
         bLength                11
         bDescriptorType        36
         bDescriptorSubtype      5 (PROCESSING_UNIT)
       Warning: Descriptor too short
         bUnitID                 3
         bSourceID               1
         wMaxMultiplier          0
         bControlSize            2
         bmControls     0x0000053f
           Brightness
           Contrast
           Hue
           Saturation
           Sharpness
           Gamma
           Backlight Compensation
           Power Line Frequency
         iProcessing             0
         bmVideoStandards     0x64
           PAL - 625/50
           PAL - 525/60
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x83  EP 3 IN
         bmAttributes            3
           Transfer Type            Interrupt
           Synch Type               None
           Usage Type               Data
         wMaxPacketSize     0x0010  1x 16 bytes
         bInterval               6
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       0
       bNumEndpoints           0
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       VideoStreaming Interface Descriptor:
         bLength                            14
         bDescriptorType                    36
         bDescriptorSubtype                  1 (INPUT_HEADER)
         bNumFormarts                        1
         wTotalLength                    33025
         bEndPointAddress                    0
         bmInfo                              2
         bTerminalLink                       0
         bStillCaptureMethod                 1
         bTriggerSupport                     0
         bTriggerUsage                       1
         bControlSize                        1
         bmaControls( 0)                    27
       VideoStreaming Interface Descriptor:
         bLength                            27
         bDescriptorType                    36
         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
         bFormatIndex                        1
         bNumFrameDescriptors                7
         guidFormat                            {32595559-0000-0010-8000-00aa00389b71}
         bBitsPerPixel                      16
         bDefaultFrameIndex                  1
         bAspectRatioX                       0
         bAspectRatioY                       0
         bmInterlaceFlags                 0x00
           Interlaced stream or variable: No
           Fields per frame: 1 fields
           Field 1 first: No
           Field pattern: Field 1 only
           bCopyProtect                      0
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         1
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            640
         wHeight                           480
         dwMinBitRate                   614400
         dwMaxBitRate                 18432000
         dwMaxVideoFrameBufferSize      614400
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         2
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            352
         wHeight                           288
         dwMinBitRate                   202752
         dwMaxBitRate                  6082560
         dwMaxVideoFrameBufferSize      202752
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         3
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            320
         wHeight                           240
         dwMinBitRate                   153600
         dwMaxBitRate                  4608000
         dwMaxVideoFrameBufferSize      153600
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         4
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            176
         wHeight                           144
         dwMinBitRate                    50688
         dwMaxBitRate                  1520640
         dwMaxVideoFrameBufferSize       50688
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         5
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            160
         wHeight                           120
         dwMinBitRate                    38400
         dwMaxBitRate                  1152000
         dwMaxVideoFrameBufferSize       38400
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            34
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         6
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                           1280
         wHeight                           960
         dwMinBitRate                  2457600
         dwMaxBitRate                 22118400
         dwMaxVideoFrameBufferSize     2457600
         dwDefaultFrameInterval        1111111
         bFrameIntervalType                  2
         dwFrameInterval( 0)           1111111
         dwFrameInterval( 1)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            34
         bDescriptorType                    36
         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
         bFrameIndex                         7
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                           1280
         wHeight                          1024
         dwMinBitRate                  2621440
         dwMaxBitRate                 23592960
         dwMaxVideoFrameBufferSize     2621440
         dwDefaultFrameInterval        1111111
         bFrameIntervalType                  2
         dwFrameInterval( 0)           1111111
         dwFrameInterval( 1)           2000000
       VideoStreaming Interface Descriptor:
         bLength                             6
         bDescriptorType                    36
         bDescriptorSubtype                 13 (COLORFORMAT)
         bColorPrimaries                     1 (BT.709,sRGB)
         bTransferCharacteristics            1 (BT.709)
         bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       1
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0080  1x 128 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       2
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0100  1x 256 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       3
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0320  1x 800 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       4
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0b20  2x 800 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       5
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x1320  3x 800 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       6
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x1400  3x 0 bytes
         bInterval               1
Device Qualifier (for other device speed):
   bLength                10
   bDescriptorType         6
   bcdUSB               2.00
   bDeviceClass          239 Miscellaneous Device
   bDeviceSubClass         2 Common Class
   bDeviceProtocol         1 Interface Association
   bMaxPacketSize0        64
   bNumConfigurations      1
Device Status:     0x0000
   (Bus Powered)



With only ohci-hcd loaded:

Bus 004 Device 007: ID 04f2:b021 Chicony Electronics Co., Ltd 
Device Descriptor:
   bLength                18
   bDescriptorType         1
   bcdUSB               2.00
   bDeviceClass          239 Miscellaneous Device
   bDeviceSubClass         2 Common Class
   bDeviceProtocol         1 Interface Association
   bMaxPacketSize0        64
   idVendor           0x04f2 Chicony Electronics Co., Ltd
   idProduct          0xb021
   bcdDevice            3.54
   iManufacturer           2 Chicony Electronics Co., Ltd.
   iProduct                1 ViewSonic 1.3M, USB2.0 Webcam
   iSerial                 3 SN0001
   bNumConfigurations      1
   Configuration Descriptor:
     bLength                 9
     bDescriptorType         2
     wTotalLength          507
     bNumInterfaces          2
     bConfigurationValue     1
     iConfiguration          0
     bmAttributes         0x80
       (Bus Powered)
     MaxPower               98mA
     Interface Association:
       bLength                 8
       bDescriptorType        11
       bFirstInterface         0
       bInterfaceCount         2
       bFunctionClass         14 Video
       bFunctionSubClass       3 Video Interface Collection
       bFunctionProtocol       0
       iFunction               1 ViewSonic 1.3M, USB2.0 Webcam
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        0
       bAlternateSetting       0
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      1 Video Control
       bInterfaceProtocol      0
       iInterface              1 ViewSonic 1.3M, USB2.0 Webcam
       VideoControl Interface Descriptor:
         bLength                13
         bDescriptorType        36
         bDescriptorSubtype      1 (HEADER)
         bcdUVC               1.00
         wTotalLength          103
         dwClockFrequency       15.000000MHz
         bInCollection           1
         baInterfaceNr( 0)       1
       VideoControl Interface Descriptor:
         bLength                 9
         bDescriptorType        36
         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
         bTerminalID             2
         wTerminalType      0x0101 USB Streaming
         bAssocTerminal          0
         bSourceID               5
         iTerminal               0
       VideoControl Interface Descriptor:
         bLength                26
         bDescriptorType        36
         bDescriptorSubtype      6 (EXTENSION_UNIT)
         bUnitID                 4
         guidExtensionCode         {28f03370-6311-4a2e-ba2c-6890eb334016}
         bNumControl             8
         bNrPins                 1
         baSourceID( 0)          3
         bControlSize            1
         bmControls( 0)       0x0f
         iExtension              0
       VideoControl Interface Descriptor:
         bLength                26
         bDescriptorType        36
         bDescriptorSubtype      6 (EXTENSION_UNIT)
         bUnitID                 5
         guidExtensionCode         {2812ae3f-bcd7-4e11-a357-6f1edef7d61d}
         bNumControl             8
         bNrPins                 1
         baSourceID( 0)          4
         bControlSize            1
         bmControls( 0)       0x01
         iExtension              0
       VideoControl Interface Descriptor:
         bLength                18
         bDescriptorType        36
         bDescriptorSubtype      2 (INPUT_TERMINAL)
         bTerminalID             1
         wTerminalType      0x0201 Camera Sensor
         bAssocTerminal          0
         iTerminal               0
         wObjectiveFocalLengthMin      0
         wObjectiveFocalLengthMax      0
         wOcularFocalLength            0
         bControlSize                  3
         bmControls           0x00000000
       VideoControl Interface Descriptor:
         bLength                11
         bDescriptorType        36
         bDescriptorSubtype      5 (PROCESSING_UNIT)
       Warning: Descriptor too short
         bUnitID                 3
         bSourceID               1
         wMaxMultiplier          0
         bControlSize            2
         bmControls     0x0000053f
           Brightness
           Contrast
           Hue
           Saturation
           Sharpness
           Gamma
           Backlight Compensation
           Power Line Frequency
         iProcessing             0
         bmVideoStandards     0x82
           NTSC - 525/60
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x83  EP 3 IN
         bmAttributes            3
           Transfer Type            Interrupt
           Synch Type               None
           Usage Type               Data
         wMaxPacketSize     0x0010  1x 16 bytes
         bInterval               6
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       0
       bNumEndpoints           0
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       VideoStreaming Interface Descriptor:
         bLength                            14
         bDescriptorType                    36
         bDescriptorSubtype                  1 (INPUT_HEADER)
         bNumFormarts                        1
         wTotalLength                    33025
         bEndPointAddress                    0
         bmInfo                              2
         bTerminalLink                       0
         bStillCaptureMethod                 1
         bTriggerSupport                     0
         bTriggerUsage                       1
         bControlSize                        1
         bmaControls( 0)                    11
       VideoStreaming Interface Descriptor:
         bLength                            11
         bDescriptorType                    36
         bDescriptorSubtype                  6 (FORMAT_MJPEG)
         bFormatIndex                        1
         bNumFrameDescriptors                5
         bFlags                              0
           Fixed-size samples: No
         bDefaultFrameIndex                  1
         bAspectRatioX                       0
         bAspectRatioY                       0
         bmInterlaceFlags                 0x00
           Interlaced stream or variable: No
           Fields per frame: 1 fields
           Field 1 first: No
           Field pattern: Field 1 only
           bCopyProtect                      0
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  7 (FRAME_MJPEG)
         bFrameIndex                         1
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            640
         wHeight                           480
         dwMinBitRate                    76800
         dwMaxBitRate                  2304000
         dwMaxVideoFrameBufferSize       76800
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  7 (FRAME_MJPEG)
         bFrameIndex                         2
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            352
         wHeight                           288
         dwMinBitRate                    25344
         dwMaxBitRate                   760320
         dwMaxVideoFrameBufferSize       25344
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  7 (FRAME_MJPEG)
         bFrameIndex                         3
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            320
         wHeight                           240
         dwMinBitRate                    19200
         dwMaxBitRate                   576000
         dwMaxVideoFrameBufferSize       19200
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  7 (FRAME_MJPEG)
         bFrameIndex                         4
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            176
         wHeight                           144
         dwMinBitRate                     6336
         dwMaxBitRate                   190080
         dwMaxVideoFrameBufferSize        6336
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                            46
         bDescriptorType                    36
         bDescriptorSubtype                  7 (FRAME_MJPEG)
         bFrameIndex                         5
         bmCapabilities                   0x00
           Still image unsupported
         wWidth                            160
         wHeight                           120
         dwMinBitRate                     4800
         dwMaxBitRate                   144000
         dwMaxVideoFrameBufferSize        4800
         dwDefaultFrameInterval         333333
         bFrameIntervalType                  5
         dwFrameInterval( 0)            333333
         dwFrameInterval( 1)            500000
         dwFrameInterval( 2)            666666
         dwFrameInterval( 3)           1000000
         dwFrameInterval( 4)           2000000
       VideoStreaming Interface Descriptor:
         bLength                             6
         bDescriptorType                    36
         bDescriptorSubtype                 13 (COLORFORMAT)
         bColorPrimaries                     1 (BT.709,sRGB)
         bTransferCharacteristics            1 (BT.709)
         bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       1
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0080  1x 128 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       2
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0100  1x 256 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       3
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0200  1x 512 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       4
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0258  1x 600 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       5
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x0320  1x 800 bytes
         bInterval               1
     Interface Descriptor:
       bLength                 9
       bDescriptorType         4
       bInterfaceNumber        1
       bAlternateSetting       6
       bNumEndpoints           1
       bInterfaceClass        14 Video
       bInterfaceSubClass      2 Video Streaming
       bInterfaceProtocol      0
       iInterface              0
       Endpoint Descriptor:
         bLength                 7
         bDescriptorType         5
         bEndpointAddress     0x81  EP 1 IN
         bmAttributes            5
           Transfer Type            Isochronous
           Synch Type               Asynchronous
           Usage Type               Data
         wMaxPacketSize     0x03bc  1x 956 bytes
         bInterval               1
Device Qualifier (for other device speed):
   bLength                10
   bDescriptorType         6
   bcdUSB               2.00
   bDeviceClass          239 Miscellaneous Device
   bDeviceSubClass         2 Common Class
   bDeviceProtocol         1 Interface Association
   bMaxPacketSize0        64
   bNumConfigurations      1
Device Status:     0x0000
   (Bus Powered)


---------------------------------------------------------
Web:    http://www.szfki.hu/~gabrisa
"Ha ezt el tudja olvasni, minden bizonnyal tud magyarul."
---------------------------------------------------------


From shaohuang at gmail.com  Fri Jan 25 02:13:14 2008
From: shaohuang at gmail.com (Brian Pin)
Date: Thu, 24 Jan 2008 17:13:14 -0800
Subject: [Linux-uvc-devel] Slow framerate ...
Message-ID: <a81f87bb0801241713y6aa8538esba971b1e47516923@mail.gmail.com>

I ported linux-uvc driver on our simple os system, which is quite the same
as linux, since I ported the all the usb (hcd and hub, message..) from
Linux.
The question is our verification system runs at a FPGA platform and I can
successfully connected to a Microsoft camera, get its descriptors and all
probing and initialization procedures is done.

When I started streaming, the frame rate is nearly 1~2 FPS, that is so
confusing to me. I have tried settings from 800x600(30FPS), to
160x120(30FPS) none of them achieve higher than 2 FPS.

My question is, although our FPGA runs at 40MHz, memory speed is 60~75MHz,
is this possible to achieve 30FPS? We have an USB analyzer which captures
lots of "IN" tokens from my host to the cam(one IN per microFrame), and the
cam just responds with zero bytes data. When I test the device on PC , it
works fine to 30FPS.
So I am wondering if there is any cause that makes the device dynamically
changing to slow framerate?

Thanks

-- 
Best Regards
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080124/ae71c242/attachment.html>

From juby.victor at gmail.com  Fri Jan 25 09:45:48 2008
From: juby.victor at gmail.com (Juby Victor)
Date: Fri, 25 Jan 2008 00:45:48 -0800
Subject: [Linux-uvc-devel] Unsupported webcam | Creative Live! Cam Notebook
Message-ID: <d47392040801250045y7c66ce79q867f1dc25c3ed579@mail.gmail.com>

Hi

I am wondering if this camera could be got working using the UVC drivers, I
took a checkout, and installed the drivers, but could not get it working.
Please let me know if you will need any more info.

Thanks
-jv


Name: Creative Live! Cam Notebook
USB 1.1 device, 800x600 video resolution , upto 1.3 MP as still photo, Has
inbuilt microphone too.

o/p of lsusb

Bus 002 Device 002: ID 041e:4068 Creative Technology, Ltd

o/p of lsusb -v

Bus 004 Device 004: ID 041e:4068 Creative Technology, Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0         8
  idVendor           0x041e Creative Technology, Ltd
  idProduct          0x4068
  bcdDevice            1.00
  iManufacturer           1 Creative Labs
  iProduct                2 VF0470 Live! Cam Notebook
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          180
    bNumInterfaces          3
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0300  1x 768 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0380  1x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0
      iInterface              0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           30
        bInCollection           1
        baInterfaceNr( 0)       2
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0
        iTerminal               0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               1
        iTerminal               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           2
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0028  1x 40 bytes
        bInterval               1
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x00
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Status:     0x0000
  (Bus Powered)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080125/446f397e/attachment.html>

From laurent.pinchart at skynet.be  Fri Jan 25 10:03:39 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 25 Jan 2008 10:03:39 +0100
Subject: [Linux-uvc-devel] Unsupported webcam | Creative Live! Cam
	Notebook
In-Reply-To: <d47392040801250045y7c66ce79q867f1dc25c3ed579@mail.gmail.com>
References: <d47392040801250045y7c66ce79q867f1dc25c3ed579@mail.gmail.com>
Message-ID: <200801251003.39653.laurent.pinchart@skynet.be>

Hi,

On Friday 25 January 2008 09:45, Juby Victor wrote:
> Hi
>
> I am wondering if this camera could be got working using the UVC drivers, I
> took a checkout, and installed the drivers, but could not get it working.
> Please let me know if you will need any more info.

The Creative Live! Cam Notebook is not UVC compatible, therefore it can't be 
supported by the Linux UVC driver.

Best regards,

Laurent Pinchart


From mythtv at email.it  Fri Jan 25 11:55:35 2008
From: mythtv at email.it (Franco)
Date: Fri, 25 Jan 2008 11:55:35 +0100
Subject: [Linux-uvc-devel] device ID  0471:0331 not actually working
Message-ID: <4799C027.7090409@email.it>

Hello,

I am a new user of this list. I am not a developer, sorry, but the 
http://linux-uvc.berlios.de/ did not provide me a better way to contact 
you other than subscribing to this list.

Your site's main page reports this in the list of supported device:

0471:0331    Philips SPC 1300NC    Philips    Status: device works

After double checking and rechecking at least a dozen times (I had 
already bought a non-supported webcam in the past), I placed an order 
and bought 3 (THREE) PHILIPS SPC1300NC for my family.

And now, it doesn't seem to work.

"lsusb" confirms the IDs:
Bus 008 Device 002: ID 0471:0331 Philips

but then v4l2-tool confirms it can't work:
"Entered USB ID's of a webcam is NOT supported
  by neither uvcvideo nor gspca drivers"


I have a Fedora Core 7 system, updated with "yum" on a daily basis 
(latest kernel etc.).  I can't  afford to trash 3 new cameras.

May you kindly suggest me any solution?

Thank you,
Franco



From laurent.pinchart at skynet.be  Fri Jan 25 14:16:56 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 25 Jan 2008 14:16:56 +0100
Subject: [Linux-uvc-devel] Slow framerate ...
In-Reply-To: <a81f87bb0801241713y6aa8538esba971b1e47516923@mail.gmail.com>
References: <a81f87bb0801241713y6aa8538esba971b1e47516923@mail.gmail.com>
Message-ID: <200801251416.57578.laurent.pinchart@skynet.be>

Hi Brian,

On Friday 25 January 2008 02:13, Brian Pin wrote:
> I ported linux-uvc driver on our simple os system, which is quite the same
> as linux, since I ported the all the usb (hcd and hub, message..) from
> Linux.

Nice. Just out of curiosity, what kind of OS is this ? And what kind of 
platform does it run on ? I'm always interested in hearing about real-life 
projects using the Linux UVC driver.

> The question is our verification system runs at a FPGA platform and I can
> successfully connected to a Microsoft camera, get its descriptors and all
> probing and initialization procedures is done.
>
> When I started streaming, the frame rate is nearly 1~2 FPS, that is so
> confusing to me. I have tried settings from 800x600(30FPS), to
> 160x120(30FPS) none of them achieve higher than 2 FPS.
>
> My question is, although our FPGA runs at 40MHz, memory speed is 60~75MHz,
> is this possible to achieve 30FPS? We have an USB analyzer which captures
> lots of "IN" tokens from my host to the cam(one IN per microFrame), and the
> cam just responds with zero bytes data. When I test the device on PC , it
> works fine to 30FPS.

Do you use the same userspace software on your FPGA and on the PC ?

> So I am wondering if there is any cause that makes the device dynamically
> changing to slow framerate?

Lightning conditions might play a role but should not lower the frame rate 
that much. Does your system have an EHCI (USB 2.0) controller ? USB 1.1 is 
obviously slower, and if the camera doesn't support MJPEG compression frame 
rates on USB 1.1 will be quite low.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 25 15:12:39 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 25 Jan 2008 15:12:39 +0100
Subject: [Linux-uvc-devel] device ID  0471:0331 not actually working
In-Reply-To: <4799C027.7090409@email.it>
References: <4799C027.7090409@email.it>
Message-ID: <200801251512.40322.laurent.pinchart@skynet.be>

Hi Franco,

On Friday 25 January 2008 11:55, Franco wrote:
> Hello,
>
> I am a new user of this list. I am not a developer, sorry, but the
> http://linux-uvc.berlios.de/ did not provide me a better way to contact
> you other than subscribing to this list.
>
> Your site's main page reports this in the list of supported device:
>
> 0471:0331    Philips SPC 1300NC    Philips    Status: device works
>
> After double checking and rechecking at least a dozen times (I had
> already bought a non-supported webcam in the past), I placed an order
> and bought 3 (THREE) PHILIPS SPC1300NC for my family.
>
> And now, it doesn't seem to work.
>
> "lsusb" confirms the IDs:
> Bus 008 Device 002: ID 0471:0331 Philips
>
> but then v4l2-tool confirms it can't work:
> "Entered USB ID's of a webcam is NOT supported
>   by neither uvcvideo nor gspca drivers"
>
>
> I have a Fedora Core 7 system, updated with "yum" on a daily basis
> (latest kernel etc.).  I can't  afford to trash 3 new cameras.
>
> May you kindly suggest me any solution?

Instead or relying on v4l2-tool's output, why don't you actually try using 
your webcams with the Linux UVC driver ? Install a supported application (I 
personally use luvcview for the first test when trying a new webcam) and give 
it a try.

Best regards,

Laurent Pinchart


From echassandemottin at gmail.com  Fri Jan 25 15:23:26 2008
From: echassandemottin at gmail.com (Eric Chassande-Mottin)
Date: Fri, 25 Jan 2008 15:23:26 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebook Pro 046d:08c3
Message-ID: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>

hi,

I can't get my webcam (Logitech Quickcam for Notebook Pro 046d:08c3)
working on my linux box. I receive the following error in the log:

2:3:3: cannot set freq 16000 to ep 0x86

can anyone tell me what I am missing?
I attach all the status info I could think of below.

thanks,
eric.

uname -av

Linux apcpc111 2.6.22-3-686 #1 SMP Mon Nov 12 08:32:57 UTC 2007 i686 GNU/Linux

(debian lenny)
---------------------------------------------------------------------------------------------------------
dmesg
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c3)
2:3:3: cannot set freq 16000 to ep 0x86
---------------------------------------------------------------------------------------------------------
ls -l /dev/video*
crw-rw---- 1 root video 81, 0 2008-01-25 15:09 /dev/video0
---------------------------------------------------------------------------------------------------------
lsmod | grep uvcvideo
uvcvideo               42864  0
compat_ioctl32          1376  2 uvcvideo,pwc
videodev               26656  2 uvcvideo,pwc
v4l2_common            16672  2 uvcvideo,videodev
v4l1_compat            12580  2 uvcvideo,videodev
usbcore               125416  6 uvcvideo,pwc,snd_usb_audio,snd_usb_lib,uhci_hcd
---------------------------------------------------------------------------------------------------------
sudo modinfo uvcvideo
filename:       /lib/modules/2.6.22-3-686/usb/media/uvcvideo.ko
license:        GPL
description:    USB Video Class driver
author:         Laurent Pinchart <laurent.pinchart at skynet.be>
alias:          usb:v*p*d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v05ACp8300d*dc*dsc*dp*icFFiscFFipFF*
alias:          usb:v05ACp8501d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v5986p0200d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v5986p0100d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v18CDpCAFEd*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v041Ep4057d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v19ABp1000d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v046Dp08C7d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C6d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C5d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C3d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C2d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C1d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v045Ep00F8d*dc*dsc*dp*ic0Eisc01ip00*
depends:        usbcore,videodev,v4l2-common,v4l1-compat,compat_ioctl32
vermagic:       2.6.22-3-686 SMP mod_unload 686
parm:           trace:uint
---------------------------------------------------------------------------------------------------------
less /proc/bus/usb/devices
T:  Bus=02 Lev=01 Prnt=01 Port=01 Cnt=01 Dev#=  2 Spd=12  MxCh= 0
D:  Ver= 2.00 Cls=00(>ifc ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1
P:  Vendor=046d ProdID=08c3 Rev= 0.05
C:* #Ifs= 4 Cfg#= 1 Atr=80 MxPwr=500mA
I:* If#= 0 Alt= 0 #EPs= 1 Cls=ff(vend.) Sub=01 Prot=00 Driver=uvcvideo
E:  Ad=87(I) Atr=03(Int.) MxPS=  16 Ivl=5ms
I:* If#= 1 Alt= 0 #EPs= 0 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
I:  If#= 1 Alt= 1 #EPs= 1 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=01(Isoc) MxPS= 192 Ivl=1ms
I:  If#= 1 Alt= 2 #EPs= 1 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=01(Isoc) MxPS= 384 Ivl=1ms
I:  If#= 1 Alt= 3 #EPs= 1 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=01(Isoc) MxPS= 512 Ivl=1ms
I:  If#= 1 Alt= 4 #EPs= 1 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=01(Isoc) MxPS= 640 Ivl=1ms
I:  If#= 1 Alt= 5 #EPs= 1 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=01(Isoc) MxPS= 800 Ivl=1ms
I:  If#= 1 Alt= 6 #EPs= 1 Cls=ff(vend.) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=01(Isoc) MxPS= 944 Ivl=1ms
I:* If#= 2 Alt= 0 #EPs= 0 Cls=01(audio) Sub=01 Prot=00 Driver=snd-usb-audio
I:* If#= 3 Alt= 0 #EPs= 0 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
I:  If#= 3 Alt= 1 #EPs= 1 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
E:  Ad=86(I) Atr=05(Isoc) MxPS=  16 Ivl=1ms
I:  If#= 3 Alt= 2 #EPs= 1 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
E:  Ad=86(I) Atr=05(Isoc) MxPS=  32 Ivl=1ms
I:  If#= 3 Alt= 3 #EPs= 1 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
E:  Ad=86(I) Atr=05(Isoc) MxPS=  48 Ivl=1ms


From laurent.pinchart at skynet.be  Fri Jan 25 15:32:58 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 25 Jan 2008 15:32:58 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebook Pro 046d:08c3
In-Reply-To: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>
References: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>
Message-ID: <200801251532.58234.laurent.pinchart@skynet.be>

On Friday 25 January 2008 15:23, Eric Chassande-Mottin wrote:
> hi,
>
> I can't get my webcam (Logitech Quickcam for Notebook Pro 046d:08c3)
> working on my linux box. I receive the following error in the log:
>
> 2:3:3: cannot set freq 16000 to ep 0x86
>
> can anyone tell me what I am missing?

You shouldn't be scared by that message. It didn't threaten you of a nuclear 
holocaust in case you would ignore it and still try using your webcam, so 
don't let it stop you.

The error message is printed by the USB audio driver and indicates a bug in 
the webcam. Have a look at http://linux-uvc.berlios.de/#footnote-2 for a 
workaround.

Best regards,

Laurent Pinchart


From felix at derklecks.de  Fri Jan 25 15:29:29 2008
From: felix at derklecks.de (=?ISO-8859-1?Q?Felix_M=F6ller?=)
Date: Fri, 25 Jan 2008 15:29:29 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebook Pro 046d:08c3
In-Reply-To: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>
References: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>
Message-ID: <4799F249.3030106@derklecks.de>

Hi,

> I can't get my webcam (Logitech Quickcam for Notebook Pro 046d:08c3)
> working on my linux box. I receive the following error in the log:
>
> 2:3:3: cannot set freq 16000 to ep 0x86
>
> can anyone tell me what I am missing?
> I attach all the status info I could think of below.
Laurent is probably interested in the output of lsusb -v of usbutils
0.72 or newer.

HTH
Felix M?ller



From laurent.pinchart at skynet.be  Fri Jan 25 15:38:27 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 25 Jan 2008 15:38:27 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebook Pro 046d:08c3
In-Reply-To: <4799F249.3030106@derklecks.de>
References: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>
	<4799F249.3030106@derklecks.de>
Message-ID: <200801251538.27571.laurent.pinchart@skynet.be>

On Friday 25 January 2008 15:29, Felix M?ller wrote:
> Hi,
>
> > I can't get my webcam (Logitech Quickcam for Notebook Pro 046d:08c3)
> > working on my linux box. I receive the following error in the log:
> >
> > 2:3:3: cannot set freq 16000 to ep 0x86
> >
> > can anyone tell me what I am missing?
> > I attach all the status info I could think of below.
>
> Laurent is probably interested in the output of lsusb -v of usbutils
> 0.72 or newer.

I already have the USB descriptors for all camera listed on the Linux UVC home 
page (http://www.linux-uvc.berlios.de), so there's usually no need to send 
them again for known webcams (except if you suspect your camera to have 
different descriptors for the same VID:PID).

Best regards,

Laurent Pinchart


From mythtv at email.it  Fri Jan 25 15:53:57 2008
From: mythtv at email.it (Franco)
Date: Fri, 25 Jan 2008 15:53:57 +0100
Subject: [Linux-uvc-devel] device ID  0471:0331 not actually working
In-Reply-To: <200801251512.40322.laurent.pinchart@skynet.be>
References: <4799C027.7090409@email.it>
	<200801251512.40322.laurent.pinchart@skynet.be>
Message-ID: <4799F805.809@email.it>

Hi Laurent,

thank you for answering.

> Instead or relying on v4l2-tool's output, why don't you actually try using 
> your webcams with the Linux UVC driver ? Install a supported application

yes, that's what I did. At first I tried with Skype (no success), then 
with Ekiga (which explicitly complained I didn't have a camera).
Then I looked for this famous luvcview program but I didn't find any 
precompiled binary.
After lot of searches, I found v4l2-tool which just seems to confirm my 
webcam isn't supported.

Anyway, the audio was audible and the blue light on the camera turns on.

I have Fedora Core 7. Should my system work out of the box?
I didn't find any file having "uvc" as part the filename in the whole 
system; I found a  "uvcvideo.ko" module on some web site, I placed it in 
/lib/modules/<kernel version>/uvcvideo/ (which I created),
but then if I do a "modprobe uvcvideo", it fails ("FATAL: Module 
uvcvideo not found.")

Franco


From mk87 at hw.ac.uk  Fri Jan 25 17:21:40 2008
From: mk87 at hw.ac.uk (Kersaudy Kerhoas, Maiwenn)
Date: Fri, 25 Jan 2008 16:21:40 -0000
Subject: [Linux-uvc-devel] Dino-Lite uvc support
Message-ID: <7BDA60158DFB57459DA4FDC11DE91A830135B228@ex5.mail.win.hw.ac.uk>

Hi,

 

I would like to install the Dino-Lite, which is a hand-held microscope camera, similar to ProScopeHR, on my machine with Linux.

 

Dino-Lite is sold by Big Catch, www.BigC.com <http://www.bigc.com/> 

 

It would be great if you could do something about it, Cheers,

 

Ma?wenn

 

 

 

******************************************************************

Ma?wenn Kersaudy-Kerhoas

PhD student 

School of Engineering and Physical Sciences, MISEC

Heriot Watt University

Earl Mountbatten building, R 3.32

EDINBURGH EH14 4AS - UK

+44 (0)131 451 3783

****************************************************************** 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080125/bfadea63/attachment.html>

From mythtv at email.it  Fri Jan 25 17:59:24 2008
From: mythtv at email.it (Franco)
Date: Fri, 25 Jan 2008 17:59:24 +0100
Subject: [Linux-uvc-devel] device ID  0471:0331 not actually working
In-Reply-To: <200801251512.40322.laurent.pinchart@skynet.be>
References: <4799C027.7090409@email.it>
	<200801251512.40322.laurent.pinchart@skynet.be>
Message-ID: <479A156C.1090707@email.it>

>> 0471:0331    Philips SPC 1300NC    Philips    Status: device works
> Instead or relying on v4l2-tool's output, why don't you actually try using 
> your webcams with the Linux UVC driver ?

OK, I installed kernel-devel and after that,
I compiled and installed uvcvideo from these sources:
http://svn.berlios.de/svnroot/repos/linux-uvc/linux-uvc/branches/dynctrl/
(is this the correct version to use?)

After that, Skype and Ekiga seem to work normally.

I also downloaded luvcview-20070512 but that, instead, gives a kernel 
OOPS after a little bit of usage (see other message)

Franco


From mythtv at email.it  Fri Jan 25 17:59:29 2008
From: mythtv at email.it (Franco)
Date: Fri, 25 Jan 2008 17:59:29 +0100
Subject: [Linux-uvc-devel] kernel oops (luvcview)
In-Reply-To: <200801251512.40322.laurent.pinchart@skynet.be>
References: <4799C027.7090409@email.it>
	<200801251512.40322.laurent.pinchart@skynet.be>
Message-ID: <479A1571.6050601@email.it>

This is what I get after running luvcview a few seconds:


Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: Oops: 0000 [#1]
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: SMP
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: CPU:    0
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: EIP:    0060:[<f8963dca>]    Tainted: P        VLI
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: EFLAGS: 00210202   (2.6.23.12-52.fc7 #1)
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: EIP is at __uvc_find_control+0x4e/0x90 [uvcvideo]
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: eax: 00200286   ebx: f7e0b9c0   ecx: 00980900   edx: 
f8968e00
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: esi: f7e0be40   edi: dedd0dfc   ebp: 00000000   esp: 
dedd0da0
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: ds: 007b   es: 007b   fs: 00d8  gs: 0033  ss: 0068
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: Process luvcview (pid: 3768, ti=dedd0000 task=df31a000 
task.ti=dedd0000)
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: Stack: 08000002 00000000 f7bec030 f7bec030 00000000 
08000002 f8963f9f dedd0dcc
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:        00000000 dedd0dfc e0c1a540 00000000 f7bec030 
c0445624 dedd0ec0 f7bec030
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:        f8964a1e 00200287 c0613369 00000020 e0c1ac40 
e0c1acac c06133bc 00200286
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel: Call Trace:
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<f8963f9f>] uvc_find_control+0x3a/0x111 [uvcvideo]
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<c0445624>] futex_lock_pi+0x34/0x986
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<f8964a1e>] uvc_query_v4l2_ctrl+0x16/0x1a8 [uvcvideo]
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<c0613369>] unix_stream_recvmsg+0x34f/0x4c3
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<c06133bc>] unix_stream_recvmsg+0x3a2/0x4c3
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<c0445624>] futex_lock_pi+0x34/0x986
Message from syslogd@ at Fri Jan 25 17:34:41 2008 ...
localhost kernel:  [<f8962223>] uvc_v4l2_do_ioctl+0x2c0/0xcb0 [uvcvideo]
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c05af6fd>] sock_aio_read+0xfc/0x108
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c0445624>] futex_lock_pi+0x34/0x986
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<f895aac9>] video_usercopy+0x172/0x236 [videodev]
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c043d3c9>] autoremove_wake_function+0x0/0x35
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c043fefe>] hrtimer_nanosleep+0x50/0xfc
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c0445624>] futex_lock_pi+0x34/0x986
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c0445624>] futex_lock_pi+0x34/0x986
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<f8961b48>] uvc_v4l2_ioctl+0x3b/0x41 [uvcvideo]
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<f8961f63>] uvc_v4l2_do_ioctl+0x0/0xcb0 [uvcvideo]
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c048b181>] do_ioctl+0x4d/0x63
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c048b3ce>] vfs_ioctl+0x237/0x249
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c048b42c>] sys_ioctl+0x4c/0x64
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c040518a>] syscall_call+0x7/0xb
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c0445624>] futex_lock_pi+0x34/0x986
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  [<c0610000>] xfrm_do_migrate+0x9e/0x10b
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel:  =======================
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel: Code: 8b 43 04 85 c0 74 4f 8b 50 08 eb 3a 8b 4a 0c 3b 
0c 24 75 11 83 7c 24 20 00 75 0a 8b 44 24 1c 89 18 89 17 eb 41 8b 07 85 
c0 74 05 <39> 48 0c 73 14 3b 0c 24 76 0f 83 7c 24 20 00 74 08 8b 44 24 1c
Message from syslogd@ at Fri Jan 25 17:34:42 2008 ...
localhost kernel: EIP: [<f8963dca>] __uvc_find_control+0x4e/0x90 
[uvcvideo] SS:ESP 0068:dedd0da0Killed






Franco


From shaohuang at gmail.com  Fri Jan 25 19:45:28 2008
From: shaohuang at gmail.com (Brian Pin)
Date: Fri, 25 Jan 2008 10:45:28 -0800
Subject: [Linux-uvc-devel] Slow framerate ...
In-Reply-To: <200801251416.57578.laurent.pinchart@skynet.be>
References: <a81f87bb0801241713y6aa8538esba971b1e47516923@mail.gmail.com>
	<200801251416.57578.laurent.pinchart@skynet.be>
Message-ID: <a81f87bb0801251045n5b9a1803qc532a365ddde0ca9@mail.gmail.com>

Hi Laurent:
This OS is quite simple and made by my colleague, it is running on
ARM926ejs, I adopted the driver from our USB IP vendor, and developing USB
layer from USBD, roothub to UVC driver. And I did not using the same user
space app on my FPGA platform. On PC, I am using windows application, on
FPGA, I am using my own simulated test thread to do streaming.( Because I
don't have V4L2 and I dont have app to test UVC device yet)
Here is the simulation thread:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 fmt.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;
 fmt.fmt.pix.pixelformat = V4L2_PIX_FMT_MJPEG;
 fmt.fmt.pix.width = 160;
 fmt.fmt.pix.height = 120;
 ret = uvc_v4l2_set_format(&dev->video, &fmt);
 if(ret){
  dev_err("uvc set format failed %d\n",ret);
 }
 bufsize = dev->video.streaming->ctrl.dwMaxVideoFrameSize;
 n = uvc_alloc_buffers(&dev->video.queue, V4L2_BUFFERS/*5*/, bufsize);
 for ( i = 0 ; i < n ; ++i ) {
  v4l2_buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;
  v4l2_buf.memory = V4L2_MEMORY_MMAP;
  v4l2_buf.index = i;
  uvc_queue_buffer(&dev->video.queue, &v4l2_buf);
 }
 ret = uvc_video_enable(&dev->video,1);
 if(ret) {
  dev_err("video stream enable failed %d\n", ret);
  goto done;
 }
 i = 0;
 while(1) {
  v4l2_buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;
  v4l2_buf.memory = V4L2_MEMORY_MMAP;
  v4l2_buf.index = i % n;
  uvc_dequeue_buffer(&dev->video.queue, &v4l2_buf, 0);
  uvc_queue_buffer(&dev->video.queue, &v4l2_buf);
  i++;
  if( i > 60 ) {
   uvc_video_enable(&dev->video,0);
   break;
  }
 }
done:
 uvc_free_buffers(&dev->video.queue);
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Our USB is 2.0 version and my cam compression format is MJPEG..
Thank you for your suggestion Laurent
Brian


-- 
Best Regards
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080125/9ec303bc/attachment.html>

From jews at vip.cybercity.dk  Sat Jan 26 12:43:37 2008
From: jews at vip.cybercity.dk (Jesper Pedersen)
Date: Sat, 26 Jan 2008 12:43:37 +0100
Subject: [Linux-uvc-devel] Acer Crystal Eye webcam (5986:0102)
Message-ID: <20080126114159.M49744@vip.cybercity.dk>

Hi.

I have a Acer TravelMate 6592 which contains the subject.

The device doesn't deliver any output with Ekiga 2.0.11 (wrong color format)
and luvcview - device information attached.

I would be happy to install patches or provide additional feedback.

Any ideas would be great !

TIA !
Jesper

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: CrystalEye.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080126/70dab208/attachment.txt>

From fab at mailsicura.org  Sat Jan 26 13:18:01 2008
From: fab at mailsicura.org (Fabrizio)
Date: Sat, 26 Jan 2008 12:18:01 +0000 (UTC)
Subject: [Linux-uvc-devel] Driver 05a9:2641 OmniVision Technologies
Message-ID: <loom.20080126T121144-953@post.gmane.org>

Hi guys,

I've the same webcam integrated in the same monitor.
Here's mine lspci -v

Bus 008 Device 008: ID 05a9:2641 OmniVision Technologies, Inc.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x05a9 OmniVision Technologies, Inc.
  idProduct          0x2641
  bcdDevice            1.00
  iManufacturer           1 OmniVision Technologies, Inc.-S2640-07.05.28.1
  iProduct                2 Monitor Integrated Webcam
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          765
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               2 Monitor Integrated Webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              2 Monitor Integrated Webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          109
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000a00
          Zoom (Absolute)
          PanTilt (Absolute)
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               1
        baSource( 0)            1
        iSelector               0
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000557f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
          Digital Multiplier
        iProcessing             0

...

Could someone please tell me which is the right driver for this webcam?
Thanks in advance.

Regards,
Fabrizio





From hickscorp at gmail.com  Mon Jan 28 11:29:07 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 11:29:07 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And possible
	solutions to my problem.
Message-ID: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>

Hello people,

First of all, happy new year to everyone reading this, since i'm new  
here :)
i have discovered the linux uvc project for a few days now, i have  
been looking for a good quality, supported webcam under linux, and i  
have to admit, the documentation lacks a lot...

So here is what i want to achieve:
We need a software which takes a snap of 5 connected webcams (The  
snapshots will then be used to make an accurate 3D mesh of the shooted  
object).

My first attempt was on Labtec webcam pro, which were working pretty  
well under linux with gpsa.
i have made a little application with C++ / Qt 4.3, which just calls  
vgrabbj on /dev/video* in a process. After the process ends, the  
pictures were retrieved and displayed...

The problem with this solution, was the resolution... 640x480 was not  
enough, the people told me that they need at least 1024x768.
So i have searched the internet, posted on forums, no one answered  
me... So i bought several QuickCam 9000.
Now, i'm trying to make them work the same way... And surprise: they  
can't work with my previous application, because vgrabbj can't handle  
the format in /dev/video*...

So i have looked at luvcview, and v4l also (i dont really understand  
what v4l has to do with everything here, i have never played with  
that). The result is, that i'm having several issues with both of them.

So my question is simple...
Is there any program, shell script, magic carot command which i can  
use to get a SIMPLE single shot on this device?

i'm on this project for a week now, i thought it would take a few  
hours to make... But the lack of doc / people on the net made me take  
a serious delay on the thing, so this request is kind of urgent...

Thanks a lot for your time, i hope that my request is clear. If not,  
feel free to tell me that my english is really bad, and you need some  
explaination about this or that :D

PS: Below is an email sent to the maintainer of luvcview, it is more  
precise about what i need to achieve... The email is in french.

Kind regards,
Pierre.


Bonjour,

Je m'appelle Pierre, et j'ai trouv? votre site en faisant des  
recherches ? propos de ma probl?matique...
J'ai actuellement un projet en cours, et j'aimerais vous demander un  
petit coup de main (Ceci n'est pas une requ?te de support, si la  
partie descriptive vous emb?te, passez directement ? la fin).

Voil? l'id?e:
Je dois cr?er un petit soft (Je fais le dev sous macosx avec comme  
target linux) permettant de commander 5 webcams simultan?ment (donc  
branch?es sur la m?me machine).
J'ai d?ja quelque chose de fonctionnel, bas? sur du QT et des appels ?  
vgrabbj... Cela fonctionne parfaitement avec des webcams labtec, mais  
il se trouve que les personnes me demandant cette application ont  
besoin d'obtenir des clich?s de 1024x768 au minimum...

J'ai donc ?t? chercher des Quickcam Pro 9000, webcam qui m'a sembl?  
?tre une des seules disponibles et compatible linux, avec comme  
r?solution du xga.

Une fois les drivers UVC compil?s et install?s, j'essaye mon appli, et  
l? je me rend compte que vgrabbj n'a pas l'air de comprendre ce qu'il  
voit dans /dev/video0... Aucune erreur, mais une image verte en sortie.

Je m'orriente alors vers des recherches sur internet (Le sujet n'est  
vraiment pas assez document? pour le grand public je trouve) et l? je  
tombe donc sur votre application, luvcview.

LUVCView fonctionne environ une fois sur 3 quand je la lance ? partir  
d'un xterm (sous XFCE). Les autres fois j'obtiens ceci:

luvcview version 0.2.1
Xlib: connection to ":0.0" refused by server
Xlib: XDM authorization key matches an existing client!
Couldn't initialize SDL: Couldn't open X11 display

Quand l'application fonctionne, elle fonctionne bien, sauf au premier  
lancement o? la palette semble "brul?e".

Si je liste les modes possibles, j'obtiens:

/dev/video0 does not support read i/o
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 160, height = 120 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 176, height = 144 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 320, height = 240 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 352, height = 288 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 640, height = 480 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 800, height = 600 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 960, height = 720 }
         Time interval between frame: 1/15, 1/10, 1/5,
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 160, height = 120 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 176, height = 144 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 320, height = 240 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 352, height = 288 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 640, height = 480 }
         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 800, height = 600 }
         Time interval between frame: 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 960, height = 720 }
         Time interval between frame: 1/10, 1/5,
{ discrete: width = 1600, height = 1200 }
         Time interval between frame: 1/5,

Mais quand je lance luvcview avec comme param?tre une taille au del?  
de 800 par 600, je r?cup?re l'erreur suivante:

X Error of failed request:  BadAlloc (insufficient resources for  
operation)
   Major opcode of failed request:  140 (XVideo)
   Minor opcode of failed request:  19 ()
   Serial number of failed request:  25
   Current serial number in output stream:  26

De l? mes questions sont les suivantes:
1) Comment puis-je r?gler le probl?me de r?solution? J'aimerais  
pouvoir shooter en 1600x1200 ou ? d?faut en 960x720...
2) Auriez vous par hasard un code source ou un script shell permettant  
de faire une acquisition d'image sur une telle webcam? Mon projet est  
open source, si vous ?tes d'accord pour que j'utilise vos sources bien  
s?r. Le but du jeu ?tant bien sur de lancer cet outil dans un process  
? partir de mon appli, et qu'? la fin du process si l'exitcode est ok,  
je puisse r?cup?rer une image exploitable...

Je suis cens? avoir termin? demain, je suis press? par le temps. Si  
vous ne pouvez pas me r?pondre, pourriez-vous SVP m'aiguiller vers des  
resources me permettant d'effectuer ce que je veux?

En vous remerciant de votre temps et de votre attention,
Amicalement,
Pierre.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/5c1d659c/attachment.html>

From hickscorp at gmail.com  Mon Jan 28 11:41:30 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 11:41:30 +0100
Subject: [Linux-uvc-devel] Simplified questions :D
Message-ID: <C4D138D7-B43A-4345-8ACB-2E355DA88796@GMail.com>

Hello again,

Here are some simplified questions, if there is an answer to any of  
them, i'm saved :)
All are related to taking a single picture from 5 connected webcams  
(QuickCam 9000), not displaying live video!

- Using vgrabbj, the output picture is always all green... and setting  
up the capture size to uxga gives me an error "Device doesn't support  
width/height". Is there a way to make vgrabbj work with such a device?
- Is there any way to use luvcview in command line without starting X,  
and tell it to just take a single picture from a /dev/video device and  
then exit?
- Is there any similar program in terms of features (i mean: which can  
start without X, take a snap, save it to PNG for instance, and exit)?
- With the help of Qt 4.3, is there a simple way to make for instance  
a QIODevice "uvc-aware"? If you're not familiar with Qt, you can have  
a look at this and tell me what you think: http://doc.trolltech.com/4.3/qiodevice.html 
  , it is just a simple abstraction class, but if someone here is able  
to help me to understand how to read in /dev/video for this specific  
webcam, set up the size, the palette and all, i will then be able to  
subclass QIODevice and make one which can "shoot" from the cam...

Thank you very much for your time!
Pierre.


From echassandemottin at gmail.com  Mon Jan 28 11:48:16 2008
From: echassandemottin at gmail.com (Eric Chassande-Mottin)
Date: Mon, 28 Jan 2008 11:48:16 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebook Pro 046d:08c3
In-Reply-To: <200801251532.58234.laurent.pinchart@skynet.be>
References: <75a01c1d0801250623u17a85861v5d7904c80f8e2bbb@mail.gmail.com>
	<200801251532.58234.laurent.pinchart@skynet.be>
Message-ID: <75a01c1d0801280248o6da1bfd9m6fbbe2c41be2dc05@mail.gmail.com>

thanks for your quick replies!

> You shouldn't be scared by that message. It didn't threaten you of a nuclear
> holocaust in case you would ignore it and still try using your webcam, so
> don't let it stop you.

I mentioned that because it was the only error message I had.

> The error message is printed by the USB audio driver and indicates a bug in
> the webcam. Have a look at http://linux-uvc.berlios.de/#footnote-2 for a
> workaround.

I got, compiled and installed the driver from the SVN rep as described in
http://linux-uvc.berlios.de/#footnote-2 and it worked immediately (ekiga
displays my cam).

thanks again, e.


From t.st1 at gmx.net  Mon Jan 28 13:51:09 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 13:51:09 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
 possible solutions to my problem.
In-Reply-To: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>
Message-ID: <479DCFBD.9050708@gmx.net>

Hello Pierre,
If you want to you can implement such an idea using mjpg-streamer. It 
continuously takes snapshots at the given framerate (5 fps is lowest, 
gives best light sensitivity, least noise/disturbance) and forward the 
frames to an output plugin. In your case you can simply start an 
instance of mjpg-streamer per webcam:

# mjpg-streamer --input "input_uvc.so -d /dev/video0 --fps 5 -r 
1600x1200 -y -q 100" -output "output_http.so --port 8080"
# mjpg-streamer --input "input_uvc.so -d /dev/video1 --fps 5 -r 
1600x1200 -y -q 100" -output "output_http.so --port 8081"
# mjpg-streamer --input "input_uvc.so -d /dev/video2 --fps 5 -r 
1600x1200 -y -q 100" -output "output_http.so --port 8082"
# mjpg-streamer --input "input_uvc.so -d /dev/video3 --fps 5 -r 
1600x1200 -y -q 100" -output "output_http.so --port 8083"
# mjpg-streamer --input "input_uvc.so -d /dev/video4 --fps 5 -r 
1600x1200 -y -q 100" -output "output_http.so --port 8084"

Then you can retrieve single images using the command line tools "curl" 
or "wget":

# curl http://localhost:8080/?action=snapshot > snapshot.jpg
...
# curl http://localhost:8084/?action=snapshot > snapshot.jpg

Or you may just want to hack the mjpg-streamer sources to suit your 
needs. Most likely you want to grab in YUYV mode, this allows to grab up 
to a resolution of 1600x1200 (tested with QC Sphere AF, but this should 
also be valid for QC 9000). All grabbing relevant stuff is located in 
the subfolder "plugins/input_uvc", just a few source files to read.

If you experience problems in understanding of the plugin-concept, you 
can reference to the "input_testpicture" plugin. That is as simple as 
possible and just serves two linked in JPG files (JPG-data converted to 
an array).

However, feel free to modify. Perhaps you also want to write your own 
output plugin, serving the files on request in an format you like more. 
This way you can avoid to worry about the Linux-UVC/V4L2 specific 
commands, on the other hand your application would have a dependency to 
that tool. Of course you can also use other tools like w3cam or motion 
for example (more projects mentioned at 
http://www.quickcamteam.net/software/linux/v4l2-software/) or have a 
look at libunicap and libwebcam.

Kind regards and HTH,
Tom


From hickscorp at gmail.com  Mon Jan 28 13:57:34 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 13:57:34 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
	possible solutions to my problem.
In-Reply-To: <479DCFBD.9050708@gmx.net>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>
	<479DCFBD.9050708@gmx.net>
Message-ID: <E8324B33-8ABC-4B46-829C-57CF972D77B7@GMail.com>

Thanks a lot!

This is exactly what i was looking for, so i guess my prevous emails  
were clear enough :)
i have also contacted Michel who maintains luvcview, and who gave me  
the advice to use his source code to directly talk with v4l2 in my  
application... The problem is that i have to be done by tonight, so  
maybe i'll do that another time.
Additionnaly, his code is based around SDL, and i never had used it.

So i'm going to try your advice right now, and will give feedback to  
the list whatever happends.

Thanks again!
Pierre.

On 28 janv. 08, at 13:51, Tom St wrote:

> Hello Pierre,
> If you want to you can implement such an idea using mjpg-streamer. It
> continuously takes snapshots at the given framerate (5 fps is lowest,
> gives best light sensitivity, least noise/disturbance) and forward the
> frames to an output plugin. In your case you can simply start an
> instance of mjpg-streamer per webcam:
>
> # mjpg-streamer --input "input_uvc.so -d /dev/video0 --fps 5 -r
> 1600x1200 -y -q 100" -output "output_http.so --port 8080"
> # mjpg-streamer --input "input_uvc.so -d /dev/video1 --fps 5 -r
> 1600x1200 -y -q 100" -output "output_http.so --port 8081"
> # mjpg-streamer --input "input_uvc.so -d /dev/video2 --fps 5 -r
> 1600x1200 -y -q 100" -output "output_http.so --port 8082"
> # mjpg-streamer --input "input_uvc.so -d /dev/video3 --fps 5 -r
> 1600x1200 -y -q 100" -output "output_http.so --port 8083"
> # mjpg-streamer --input "input_uvc.so -d /dev/video4 --fps 5 -r
> 1600x1200 -y -q 100" -output "output_http.so --port 8084"
>
> Then you can retrieve single images using the command line tools  
> "curl"
> or "wget":
>
> # curl http://localhost:8080/?action=snapshot > snapshot.jpg
> ...
> # curl http://localhost:8084/?action=snapshot > snapshot.jpg
>
> Or you may just want to hack the mjpg-streamer sources to suit your
> needs. Most likely you want to grab in YUYV mode, this allows to  
> grab up
> to a resolution of 1600x1200 (tested with QC Sphere AF, but this  
> should
> also be valid for QC 9000). All grabbing relevant stuff is located in
> the subfolder "plugins/input_uvc", just a few source files to read.
>
> If you experience problems in understanding of the plugin-concept, you
> can reference to the "input_testpicture" plugin. That is as simple as
> possible and just serves two linked in JPG files (JPG-data converted  
> to
> an array).
>
> However, feel free to modify. Perhaps you also want to write your own
> output plugin, serving the files on request in an format you like  
> more.
> This way you can avoid to worry about the Linux-UVC/V4L2 specific
> commands, on the other hand your application would have a dependency  
> to
> that tool. Of course you can also use other tools like w3cam or motion
> for example (more projects mentioned at
> http://www.quickcamteam.net/software/linux/v4l2-software/) or have a
> look at libunicap and libwebcam.
>
> Kind regards and HTH,
> Tom
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



From t.st1 at gmx.net  Mon Jan 28 13:59:49 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 13:59:49 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
 possible solutions to my problem.
In-Reply-To: <479DCFBD.9050708@gmx.net>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>
	<479DCFBD.9050708@gmx.net>
Message-ID: <479DD1C5.9070106@gmx.net>

Perhaps you also just want to use the plugin as it is.
It would "just" be necessary to write the right interface, but all you 
need is already in the shared object "input_uvc.so". Its job is to take 
snapshots and store those pictures in a global buffer. Images are 
already/converted-to in JPEG-format.


From hickscorp at gmail.com  Mon Jan 28 14:13:28 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 14:13:28 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
	possible solutions to my problem.
In-Reply-To: <479DD1C5.9070106@gmx.net>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>
	<479DCFBD.9050708@gmx.net> <479DD1C5.9070106@gmx.net>
Message-ID: <B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>

Hello List,

Thomas:
i have just finished to compile the mjpg_streamer package, and i have  
started a testing session.
it seems to perfectly work, and most important: FIT WHAT I NEED :D
i will use curl or directly Qt to download the pictures.

But there is a little problem, i hope someone knows the what or the why:
The pictures shown are totally wrong on colors. i believe the palette  
is not correctly set, all seem red, dark areas are almost pure blue...

Anyway thanks a lot for all these directions, i am very happy with  
this solution, and i discovered this tool which i will probably use  
for other purposes later.

Kind regards,
Pierre.

P.S.: i really believe that the main digests of this mailing list  
should be formated with eye candy and placed in a well known website  
(understand: well known for end users without any technical knowledge  
at all), it took me days to find the list and the archive!

On 28 janv. 08, at 13:59, Tom St wrote:

> Perhaps you also just want to use the plugin as it is.
> It would "just" be necessary to write the right interface, but all you
> need is already in the shared object "input_uvc.so". Its job is to  
> take
> snapshots and store those pictures in a global buffer. Images are
> already/converted-to in JPEG-format.
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



From t.st1 at gmx.net  Mon Jan 28 14:24:56 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 14:24:56 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos...
 And	possible solutions to my problem.
In-Reply-To: <B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>
	<479DD1C5.9070106@gmx.net>
	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>
Message-ID: <479DD7A8.6070705@gmx.net>

Hi Pierre,
> But there is a little problem, i hope someone knows the what or the why:
> The pictures shown are totally wrong on colors. i believe the palette  
> is not correctly set, all seem red, dark areas are almost pure blue...
>
>   
Can you verify this erroneous behaviour also with a browser like firefox?

Have you activated YUYV mode? This would capture YUYV images from the
webcam and convert it using libjpeg. Surely this will increase your CPU
usage a lot. Perhaps you need to check out the current snapshot from
subversion-repository, because i discovered issues with the buffer sizes
a few days ago.

Regards,
Tom




From hickscorp at gmail.com  Mon Jan 28 14:42:24 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 14:42:24 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos...
	And	possible solutions to my problem.
In-Reply-To: <479DD7A8.6070705@gmx.net>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>
	<479DD1C5.9070106@gmx.net>
	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>
	<479DD7A8.6070705@gmx.net>
Message-ID: <60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>

Hello Tom,

Here is the output of my listening MJPG Streamer:
./myStart.sh
MJPG Streamer Version.: 2.0
  i: Using V4L2 device.: /dev/video0
  i: Desired Resolution: 1600 x 1200
  i: Frames Per Second.: 1
  i: Format............: YUV
  i: JPEG Quality......: 100
  o: www-folder-path...: disabled
  o: HTTP TCP port.....: 8080
  o: username:password.: disabled
  o: commands..........: enabled

The mode is YUYV unless the -y switch doesnt work, but according to  
the console output, i think it's good.
You give me the advice to use the svn snap, but this is already what i  
have done... Revision was 54, am i good with this one?

The picture in firefox is wrong too.

Also i have tried the output_file plugin, and set up with the --folder  
thing after looking at the sources to know the parametters to use. But  
this output plugin gives a segmentation fault.

Also a fast question:
in the sources, i see a resolution table which only goes to 1280 x  
1024 (Which is SUFFICENT for me, no problem). Does it mean that the  
1600 x 1200 is software-side interpolated? What if i add UXGA 1600  
1200 in the table? :)

For now, i would be more than happy if the HTTP output plugin can give  
me "real" colors. Any clue for this please?

Thanks a lot for your support, for now you're the only person who  
provided me with a fast solution... So i place my hope in your  
knowledge now :D

Pierre.


On 28 janv. 08, at 14:24, Tom St wrote:

> Hi Pierre,
>> But there is a little problem, i hope someone knows the what or the  
>> why:
>> The pictures shown are totally wrong on colors. i believe the palette
>> is not correctly set, all seem red, dark areas are almost pure  
>> blue...
>>
>>
> Can you verify this erroneous behaviour also with a browser like  
> firefox?
>
> Have you activated YUYV mode? This would capture YUYV images from the
> webcam and convert it using libjpeg. Surely this will increase your  
> CPU
> usage a lot. Perhaps you need to check out the current snapshot from
> subversion-repository, because i discovered issues with the buffer  
> sizes
> a few days ago.
>
> Regards,
> Tom
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/6dda12b6/attachment.html>

From hickscorp at gmail.com  Mon Jan 28 14:52:31 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 14:52:31 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos...
	And	possible solutions to my problem.
In-Reply-To: <60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>
	<479DD1C5.9070106@gmx.net>
	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>
	<479DD7A8.6070705@gmx.net>
	<60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
Message-ID: <5F3E3814-C592-49D0-8286-BFE145EE4474@GMail.com>

Ooops... #2

After starting two instances of the program, it appears that it works  
for the 2nd webcam (on port 8081)...
So the ugly colors are only on the 1st cam...

What can be causing this?

Pierre.

On 28 janv. 08, at 14:42, Pierre MARTIN wrote:

> Hello Tom,
>
> Here is the output of my listening MJPG Streamer:
> ./myStart.sh
> MJPG Streamer Version.: 2.0
>  i: Using V4L2 device.: /dev/video0
>  i: Desired Resolution: 1600 x 1200
>  i: Frames Per Second.: 1
>  i: Format............: YUV
>  i: JPEG Quality......: 100
>  o: www-folder-path...: disabled
>  o: HTTP TCP port.....: 8080
>  o: username:password.: disabled
>  o: commands..........: enabled
>
> The mode is YUYV unless the -y switch doesnt work, but according to  
> the console output, i think it's good.
> You give me the advice to use the svn snap, but this is already what  
> i have done... Revision was 54, am i good with this one?
>
> The picture in firefox is wrong too.
>
> Also i have tried the output_file plugin, and set up with the -- 
> folder thing after looking at the sources to know the parametters to  
> use. But this output plugin gives a segmentation fault.
>
> Also a fast question:
> in the sources, i see a resolution table which only goes to 1280 x  
> 1024 (Which is SUFFICENT for me, no problem). Does it mean that the  
> 1600 x 1200 is software-side interpolated? What if i add UXGA 1600  
> 1200 in the table? :)
>
> For now, i would be more than happy if the HTTP output plugin can  
> give me "real" colors. Any clue for this please?
>
> Thanks a lot for your support, for now you're the only person who  
> provided me with a fast solution... So i place my hope in your  
> knowledge now :D
>
> Pierre.
>
>
> On 28 janv. 08, at 14:24, Tom St wrote:
>
>> Hi Pierre,
>>> But there is a little problem, i hope someone knows the what or  
>>> the why:
>>> The pictures shown are totally wrong on colors. i believe the  
>>> palette
>>> is not correctly set, all seem red, dark areas are almost pure  
>>> blue...
>>>
>>>
>> Can you verify this erroneous behaviour also with a browser like  
>> firefox?
>>
>> Have you activated YUYV mode? This would capture YUYV images from the
>> webcam and convert it using libjpeg. Surely this will increase your  
>> CPU
>> usage a lot. Perhaps you need to check out the current snapshot from
>> subversion-repository, because i discovered issues with the buffer  
>> sizes
>> a few days ago.
>>
>> Regards,
>> Tom
>>
>>
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/9e08f8ed/attachment.html>

From hickscorp at gmail.com  Mon Jan 28 14:56:02 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 14:56:02 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos...
	And	possible solutions to my problem.
In-Reply-To: <479DD7A8.6070705@gmx.net>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>
	<479DD1C5.9070106@gmx.net>
	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>
	<479DD7A8.6070705@gmx.net>
Message-ID: <CDEBF969-BB15-4909-9FB4-A0B7435EBD9A@GMail.com>

Ok my misstake (Maybe?):
After unplugging and replugging the webcams, both pictures are GOOD :)

Thanks for this cool tool, i'll give feedback if i encounter issue for  
my personnal use.

Pierre.


On 28 janv. 08, at 14:24, Tom St wrote:

> Hi Pierre,
>> But there is a little problem, i hope someone knows the what or the  
>> why:
>> The pictures shown are totally wrong on colors. i believe the palette
>> is not correctly set, all seem red, dark areas are almost pure  
>> blue...
>>
>>
> Can you verify this erroneous behaviour also with a browser like  
> firefox?
>
> Have you activated YUYV mode? This would capture YUYV images from the
> webcam and convert it using libjpeg. Surely this will increase your  
> CPU
> usage a lot. Perhaps you need to check out the current snapshot from
> subversion-repository, because i discovered issues with the buffer  
> sizes
> a few days ago.
>
> Regards,
> Tom
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



From richard at 2008.atterer.net  Mon Jan 28 15:04:50 2008
From: richard at 2008.atterer.net (Richard Atterer)
Date: Mon, 28 Jan 2008 15:04:50 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos...
	And	possible solutions to my problem.
In-Reply-To: <60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>
	<479DCFBD.9050708@gmx.net> <479DD1C5.9070106@gmx.net>
	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>
	<479DD7A8.6070705@gmx.net>
	<60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
Message-ID: <20080128140450.GB4452@fluff.lan>

On Mon, Jan 28, 2008 at 02:42:24PM +0100, Pierre MARTIN wrote:
> The mode is YUYV unless the -y switch doesnt work, but according to the 
> console output, i think it's good.
> You give me the advice to use the svn snap, but this is already what i have 
> done... Revision was 54, am i good with this one?

Not sure which SVN you mean - the current revision of the UVC driver is 
173, so 54 would be very old! 
<svn://svn.berlios.de/linux-uvc/linux-uvc/trunk>

> Also a fast question:
> in the sources, i see a resolution table which only goes to 1280 x 1024 
> (Which is SUFFICENT for me, no problem). Does it mean that the 1600 x 1200 
> is software-side interpolated? What if i add UXGA 1600 1200 in the table? 
> :)

The QuickCam 9000 has a 2 Mpixel sensor, so 1600 x 1200 is its native 
resolution! This is the resolution of the Bayer filter, i.e. each of those 
2 Mpixels is either red, green or blue.

All in all, don't expect too much: The QC 9k is a great webcam, but the 
resolution is not comparable to a digital camera. Even with enough light 
(i.e. *lots* of light!), you'll notice slight "checkered pixels" artefacts.

You might get slightly better quality with some cheap Canon digital cameras 
and automatic capture with PTP <http://libptp.sourceforge.net/>
<http://www.gphoto.org/doc/remote/>

Cheers,

  Richard

-- 
  __   _
  |_) /|  Richard Atterer     |  GnuPG key: 888354F7
  | \/?|  http://atterer.net  |  08A9 7B7D 3D13 3EF2 3D25  D157 79E6 F6DC 8883 54F7
  ? '` ?


From t.st1 at gmx.net  Mon Jan 28 15:05:48 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 15:05:48 +0100
Subject: [Linux-uvc-devel] Little questions about
 uvcvideos...	And	possible solutions to my problem.
In-Reply-To: <60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>	<479DD1C5.9070106@gmx.net>	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>	<479DD7A8.6070705@gmx.net>
	<60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
Message-ID: <479DE13C.6080404@gmx.net>

Hi Pierre,
The output of mjpg-streamer looks good, revision #54 is the most recent 
version.
> The picture in firefox is wrong too.

Damn...


> Also i have tried the output_file plugin, and set up with the --folder 
> thing after looking at the sources to know the parametters to use. But 
> this output plugin gives a segmentation fault.
>

Damn again...

> Also a fast question:
> in the sources, i see a resolution table which only goes to 1280 x 
> 1024 (Which is SUFFICENT for me, no problem). Does it mean that the 
> 1600 x 1200 is software-side interpolated? What if i add UXGA 1600 
> 1200 in the table? :)

No, the table is only used if you want to use a named resolution like 
SXGA or VGA. If you pass a certain resolution like 1600x1200 is will 
parse the values and tell the driver about the desired resolution. Have 
you tried other, smaller resolutions too? Perhaps i have an issue with 
those high resolutions.

> For now, i would be more than happy if the HTTP output plugin can give 
> me "real" colors. Any clue for this please?

If i would know better i would already have a fixed code. So i am afraid 
we have to go bug hunting. Considered your tight schedule you may want 
to try something other and come back to this issues later?

> Thanks a lot for your support, for now you're the only person who 
> provided me with a fast solution... So i place my hope in your 
> knowledge now :D

I will do my very best, but it is difficult because in my setup it works 
(Ubuntu 6.06 LTS + Linux-UVC #170 + Logitech Sphere AF). So tracking 
down the error depends on our descriptions, cooperation and information. 
This is difficult in such a short time.

Perhaps you want to try motion or nakenweb. Those applications should 
also "just work", but so far I thought the same about my software too ;o)

HTH,
Tom


From t.st1 at gmx.net  Mon Jan 28 15:08:34 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 15:08:34 +0100
Subject: [Linux-uvc-devel] Little questions about
 uvcvideos...	And	possible solutions to my problem.
In-Reply-To: <20080128140450.GB4452@fluff.lan>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>
	<479DD1C5.9070106@gmx.net>	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>	<479DD7A8.6070705@gmx.net>	<60C5EEE0-72FE-49AA-93F8-289FD2A1582C@GMail.com>
	<20080128140450.GB4452@fluff.lan>
Message-ID: <479DE1E2.9070802@gmx.net>

Hello,
>
> Not sure which SVN you mean - the current revision of the UVC driver is 
> 173, so 54 would be very old! 
> <svn://svn.berlios.de/linux-uvc/linux-uvc/trunk>
>   

It is the revision of mjpg-streamer, linux-uvc is at #172 or higher.

Regards,
Tom


From t.st1 at gmx.net  Mon Jan 28 15:10:06 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 15:10:06 +0100
Subject: [Linux-uvc-devel] Little questions about
 uvcvideos...	And	possible solutions to my problem.
In-Reply-To: <CDEBF969-BB15-4909-9FB4-A0B7435EBD9A@GMail.com>
References: <D3FD41E5-6A42-4F53-AE89-BDD80C46FD53@gmail.com>	<479DCFBD.9050708@gmx.net>	<479DD1C5.9070106@gmx.net>	<B22A5794-3141-45FB-B20A-C0E19EAD9882@GMail.com>	<479DD7A8.6070705@gmx.net>
	<CDEBF969-BB15-4909-9FB4-A0B7435EBD9A@GMail.com>
Message-ID: <479DE23E.7010504@gmx.net>

Hi Pierre,
> Ok my misstake (Maybe?):
> After unplugging and replugging the webcams, both pictures are GOOD :)
>   

*A breath of relieve*,
Tom


From hickscorp at gmail.com  Mon Jan 28 15:11:57 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 15:11:57 +0100
Subject: [Linux-uvc-devel] Little questions about
	uvcvideos...	And	possible solutions to my problem.
References: <7D647E28-EB01-43BB-BA8E-A315D446E24A@GMail.com>
Message-ID: <628C2788-B140-427A-989C-B262D7757FF8@GMail.com>



Okay i have identified the problem when starting multiple instances of  
the program:

- If i start the program in resolution 960x720, i can start it twice  
without errors.
- If i start the program in resolution 1024x768, i get the following  
error for the 2nd instance:
Unable to start capture: No space left on device
  i: Error grabbing frames

Maybe a static buffer alloc in the source?
So the question is now...  When i will have the 5 webcams (i only have  
2 for now), will the "space on device" will be enough to use all cams  
at 960x720 at least? =/

> Damn...
> Damn again...

My misstake, i have unplugged the devices and replugged them... Now  
both seem to have the good colors!

> No, the table is only used if you want to use a named resolution like
> SXGA or VGA. If you pass a certain resolution like 1600x1200 is will
> parse the values and tell the driver about the desired resolution.  
> Have
> you tried other, smaller resolutions too? Perhaps i have an issue with
> those high resolutions.
Okay, i have added 1600 x 1200 resolution so we will be able to use  
the named resolution :)

Thanks Tom, i really feel we're going ahead the good way :)

Pierre.

On 28 janv. 08, at 15:05, Tom St wrote:
> Hi Pierre,
> The output of mjpg-streamer looks good, revision #54 is the most  
> recent
> version.
>> The picture in firefox is wrong too.
>
> Damn...
>
>
>> Also i have tried the output_file plugin, and set up with the -- 
>> folder
>> thing after looking at the sources to know the parametters to use.  
>> But
>> this output plugin gives a segmentation fault.
>>
>
> Damn again...
>
>> Also a fast question:
>> in the sources, i see a resolution table which only goes to 1280 x
>> 1024 (Which is SUFFICENT for me, no problem). Does it mean that the
>> 1600 x 1200 is software-side interpolated? What if i add UXGA 1600
>> 1200 in the table? :)
>
> No, the table is only used if you want to use a named resolution like
> SXGA or VGA. If you pass a certain resolution like 1600x1200 is will
> parse the values and tell the driver about the desired resolution.  
> Have
> you tried other, smaller resolutions too? Perhaps i have an issue with
> those high resolutions.
>
>> For now, i would be more than happy if the HTTP output plugin can  
>> give
>> me "real" colors. Any clue for this please?
>
> If i would know better i would already have a fixed code. So i am  
> afraid
> we have to go bug hunting. Considered your tight schedule you may want
> to try something other and come back to this issues later?
>
>> Thanks a lot for your support, for now you're the only person who
>> provided me with a fast solution... So i place my hope in your
>> knowledge now :D
>
> I will do my very best, but it is difficult because in my setup it  
> works
> (Ubuntu 6.06 LTS + Linux-UVC #170 + Logitech Sphere AF). So tracking
> down the error depends on our descriptions, cooperation and  
> information.
> This is difficult in such a short time.
>
> Perhaps you want to try motion or nakenweb. Those applications should
> also "just work", but so far I thought the same about my software  
> too ;o)
>
> HTH,
> Tom
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/75dd808c/attachment.html>

From michel.stempin at wanadoo.fr  Mon Jan 28 15:26:50 2008
From: michel.stempin at wanadoo.fr (Michel Stempin)
Date: Mon, 28 Jan 2008 15:26:50 +0100
Subject: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
In-Reply-To: <264488.72270.qm@web50009.mail.re2.yahoo.com>
References: <264488.72270.qm@web50009.mail.re2.yahoo.com>
Message-ID: <001501c861b9$d2baca40$3ec2fea9@compaq6710b>

Hi J?rg,

Enclosed you will find the patch. This time, I did a safe "diff -Naur"
patch. It applies to the latest rev 173 without a glitch, using:
$ cd source_dir
$ patch -p1 < path_to/timing-mp.diff

This patch corrects the problems related in:
http://www.quickcamteam.net/documentation/faq/logitech-webcam-linux-usb-inco
mpatibilities

I am using a Logitech QuickCam Sphere MP, id: 046d:08cc.

Without the patch, the camera hangs randomly, with the following messages in
the logs:

uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -32

I also experience errors -110, -71 and -75.
I have to unload the driver and reload it to recover the camera.

Since I applied the given patch, I have no more problems, the camera works
like a charm!

I just had some trouble getting the PTZ to work, as the documentation on the
dynamic ioctl() API is sparse (no example):)

Don't forget to define UVC_RESET_ON_TIMEOUT in uvcvideo.h or in CFLAGS if
you want the reset feature, in case resending the faulty URB is not
sufficient.

Regards,
Michel Stempin

________________________________________
De?: J?rg Hermsdorf [mailto:funtasyspace at yahoo.com] 
Envoy??: lundi 28 janvier 2008 14:01
??: linux-uvc-devel at lists.berlios.de
Cc?: Michel Stempin
Objet?: AW: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch

I tried to apply your patch to revision 173, but I get the following errors:

# patch < timing-mp.diff
patching file uvc_status.c
Hunk #1 FAILED at 96.
Hunk #2 FAILED at 111.
Hunk #3 FAILED at 134.
Hunk #4 FAILED at 160.
4 out of 4 hunks FAILED -- saving rejects to file uvc_status.c.rej
patching file uvc_video.c
Hunk #1 FAILED at 38.
Hunk #2 FAILED at 547.
Hunk #3 FAILED at 773.
3 out of 3 hunks FAILED -- saving rejects to file uvc_video.c.rej
patching file uvc_v4l2.c
Hunk #1 FAILED at 461.
1 out of 1 hunk FAILED -- saving rejects to file uvc_v4l2.c.rej
patching file uvc_driver.c
Hunk #1 succeeded at 156 with fuzz 1.
Hunk #2 FAILED at 1459.
Hunk #3 FAILED at 1594.
2 out of 3 hunks FAILED -- saving rejects to file uvc_driver.c.rej
patching file uvcvideo.h
Hunk #1 succeeded at 324 with fuzz 2.
Hunk #2 FAILED at 611.
Hunk #3 FAILED at 625.
Hunk #4 succeeded at 786 with fuzz 2.
2 out of 4 hunks FAILED -- saving rejects to file uvcvideo.h.rej

What am I doing wrong? Was your patch code garbled while sent over this
mailing list? Could you send me your patch as a separate patch.diff text
file as an attachment, please? Thanks.

Best Regards,
J?rg

----- Urspr?ngliche Mail ----
Von: Michel Stempin <michel.stempin at wanadoo.fr>
An: linux-uvc-devel at lists.berlios.de
Gesendet: Mittwoch, den 23. Januar 2008, 12:14:59 Uhr
Betreff: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch

Hi list,

I stumbled upon the timing problem with the QuickCam Sphere MP.

Fortunately, I found Evgeny's patch. It was rather outdated, since code has
undergone a lot of code refactoring since then. So, I had to adapt it to the
last code (rev 173) in SVN.

I had to modify it a little, since I was blocked before submitting the first
URB, as dev->last_urb was initialized to 0. I also added some code to resend
all URBs.

Don't forget to define UVC_RESET_ON_TIMEOUT if you want the reset feature.

I hope this will be useful to someone.

Regards,

-- 
Michel Stempin

Index: uvc_status.c
===================================================================
--- uvc_status.c? ? ? ? (r?vision 173)
+++ uvc_status.c? ? ? ? (copie de travail)
@@ -96,9 +96,14 @@
? ? ? ? /* Resubmit the URB. */
? ? ? ? urb->interval = dev->int_ep->desc.bInterval;
? ? ? ? if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
-? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to resubmit status URB (%d).\n",
-? ? ? ? ? ? ? ? ? ? ? ret);
+? ? ? ? ? ? ? if (ret == -EL2NSYNC) {
+? ? ? ? ? ? ? ? ? ? ? if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to resubmit
status URB (%d).\n",
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ret);
+? ? ? ? ? ? ? ? ? ? ? }
+? ? ? ? ? ? ? }
? ? ? ? }
+? ? ? dev->last_urb = jiffies;
}

int uvc_status_init(struct uvc_device *dev)
@@ -106,6 +111,7 @@
? ? ? ? struct usb_host_endpoint *ep = dev->int_ep;
? ? ? ? unsigned int pipe;
? ? ? ? int interval;
+? ? ? int ret = 0;

? ? ? ? if (ep == NULL)
? ? ? ? ? ? ? ? return 0;
@@ -128,7 +134,16 @@
? ? ? ? ? ? ? ? dev->status, sizeof dev->status, uvc_status_complete,
? ? ? ? ? ? ? ? dev, interval);

-? ? ? return usb_submit_urb(dev->int_urb, GFP_KERNEL);
+? ? ? if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL)) < 0) {
+? ? ? ? ? ? ? if (ret == -EL2NSYNC) {
+? ? ? ? ? ? ? ? ? ? ? if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL))
< 0) {
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to resubmit
status URB (%d).\n",
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ret);
+? ? ? ? ? ? ? ? ? ? ? }
+? ? ? ? ? ? ? }
+? ? ? }
+? ? ? dev->last_urb = jiffies;
+? ? ? return ret;
}

void uvc_status_cleanup(struct uvc_device *dev)
@@ -145,9 +160,19 @@

int uvc_status_resume(struct uvc_device *dev)
{
+? ? ? int ret = 0;
? ? ? ? if (dev->int_urb == NULL)
? ? ? ? ? ? ? ? return 0;

-? ? ? return usb_submit_urb(dev->int_urb, GFP_KERNEL);
+? ? ? if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL)) < 0) {
+? ? ? ? ? ? ? if (ret == -EL2NSYNC) {
+? ? ? ? ? ? ? ? ? ? ? if ((ret = usb_submit_urb(dev->int_urb, GFP_KERNEL))
< 0) {
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to resubmit
status URB (%d).\n",
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ret);
+? ? ? ? ? ? ? ? ? ? ? }
+? ? ? ? ? ? ? }
+? ? ? }
+? ? ? dev->last_urb = jiffies;
+? ? ? return ret;
}

Index: uvc_video.c
===================================================================
--- uvc_video.c (r?vision 173)
+++ uvc_video.c (copie de travail)
@@ -38,18 +38,37 @@
? ? ? ? __u8 type = USB_TYPE_CLASS | USB_RECIP_INTERFACE;
? ? ? ? unsigned int pipe;
? ? ? ? int ret;
+? ? ? int delayed = 0;

? ? ? ? pipe = (query & 0x80) ? usb_rcvctrlpipe(dev->udev, 0)
? ? ? ? ? ? ? ? ? ? ? ? ? ? ? : usb_sndctrlpipe(dev->udev, 0);
? ? ? ? type |= (query & 0x80) ? USB_DIR_IN : USB_DIR_OUT;

+? ? ? if (dev->last_urb) {
+? ? ? ? ? ? ? while (time_before(jiffies,dev->last_urb + 2)) {
+? ? ? ? ? ? ? ? ? ? ? schedule();
+? ? ? ? ? ? ? ? ? ? ? delayed = 1;
+? ? ? ? ? ? ? }
+? ? ? }
+
? ? ? ? ret = usb_control_msg(dev->udev, pipe, query, type, cs << 8,
? ? ? ? ? ? ? ? ? ? ? ? unit << 8 | intfnum, data, size, timeout);
+? ? ? dev->last_urb = jiffies;

? ? ? ? if (ret != size) {
? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to query (%u) UVC control %u "
? ? ? ? ? ? ? ? ? ? ? ? "(unit %u) : %d (exp. %u).\n", query, cs, unit, ret,
? ? ? ? ? ? ? ? ? ? ? ? size);
+? ? ? ? ? ? ? if (delayed) {
+? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR,"usb_control_msg was delayed\n");
+? ? ? ? ? ? ? } else {
+? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR,"usb_control_msg was NOT
delayed\n");
+? ? ? ? ? ? ? }
+#ifdef UVC_RESET_ON_TIMEOUT
+? ? ? ? ? ? ? if (ret == -ETIMEDOUT) // reset the device in case of -110
error
+? ? ? ? ? ? ? ? ? ? ? dev->state |= UVC_DEV_IOERROR;
+#endif
+
? ? ? ? ? ? ? ? return -EIO;
? ? ? ? }

@@ -528,9 +547,15 @@
? ? ? ? video->decode(urb, video, buf);

? ? ? ? if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
-? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to resubmit video URB (%d).\n",
-? ? ? ? ? ? ? ? ? ? ? ret);
-? ? ? ? }
+
+? ? ? ? ? ? ? if (ret == -EL2NSYNC) {
+? ? ? ? ? ? ? ? ? ? ? if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to resubmit
video URB (%d).\n",
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ret);
+? ? ? ? ? ? ? ? ? ? ? }
+? ? ? ? ? ? ? }
+? ? ? }
+? ? ? video->dev->last_urb = jiffies;
}

/*
@@ -748,6 +773,7 @@
? ? ? ? ? ? ? ? ? ? ? ? return ret;
? ? ? ? ? ? ? ? }
? ? ? ? }
+? ? ? video->dev->last_urb = jiffies;

? ? ? ? return 0;
}
Index: uvc_v4l2.c
===================================================================
--- uvc_v4l2.c? (r?vision 173)
+++ uvc_v4l2.c? (copie de travail)
@@ -461,6 +461,12 @@
? ? ? ? ? ? ? ? mutex_unlock(&video->queue.mutex);
? ? ? ? }

+#ifdef UVC_RESET_ON_TIMEOUT
+? ? ? /* leave usb device in a clean state */
+? ? ? if (video->dev->state & UVC_DEV_IOERROR)
+? ? ? ? ? ? ? uvc_video_reinit(video);
+#endif
+
? ? ? ? /* Release the file handle. */
? ? ? ? uvc_dismiss_privileges(handle);
? ? ? ? kfree(handle);
Index: uvc_driver.c
===================================================================
--- uvc_driver.c? ? ? ? (r?vision 173)
+++ uvc_driver.c? ? ? ? (copie de travail)
@@ -156,6 +156,52 @@
? ? ? ? return 0;
}

+#ifdef UVC_RESET_ON_TIMEOUT
+/* 
+ * Reset and Re-Initialize video device
+ */
+int uvc_video_reinit(struct uvc_video_device *video)
+{
+? ? ? int ret;
+
+? ? ? if ((ret = uvc_usb_reset(video->dev)) < 0)
+? ? ? ? ? ? ? return ret;
+
+? ? ? if ((ret = uvc_set_video_ctrl(video, &video->streaming->ctrl, 0)) <
0) {
+? ? ? ? ? ? ? uvc_printk(KERN_DEBUG, "uvc_video_reinit: Unable to commit
format "
+? ? ? ? ? ? ? ? ? ? ? ? ? "(%d).\n", ret);
+? ? ? ? ? ? ? return ret;
+? ? ? }
+
+? ? ? return 0;
+}
+
+
+int uvc_usb_reset(struct uvc_device *dev)
+{
+? ? ? int l, ret;
+
+? ? ? l = usb_lock_device_for_reset(dev->udev, dev->intf);
+
+? ? ? if (l >= 0) {
+? ? ? ? ? ? ? ret = usb_reset_device(dev->udev);
+? ? ? ? ? ? ? if (l)
+? ? ? ? ? ? ? ? ? ? ? usb_unlock_device(dev->udev);
+? ? ? }
+? ? ? else
+? ? ? ? ? ? ? ret = -EBUSY;
+
+? ? ? if (ret)
+? ? ? ? ? ? ? uvc_printk(KERN_DEBUG, "uvc_usb_reset: Unable to reset usb
device"
+? ? ? ? ? ? ? ? ? ? ? ? ? "(%d).\n", ret);
+? ? ? else
+? ? ? ? ? ? ? dev->state &= ~UVC_DEV_IOERROR;
+
+? ? ? return ret;
+}
+#endif
+
+
/* Simplify a fraction using a simple continued fraction decomposition. The
? * idea here is to convert fractions such as 333333/10000000 to 1/30 using
? * 32 bit arithmetic only. The algorithm is not perfect and relies upon two
@@ -1413,9 +1459,23 @@
? ? ? ? * parameters.
? ? ? ? */
? ? ? ? if ((ret = uvc_video_init(&dev->video)) < 0) {
+#ifdef UVC_RESET_ON_TIMEOUT
+? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to initialize the device, "
+? ? ? ? ? ? ? ? ? ? ? ? ? "(%d). trying to reset ...\n", ret);
+
+? ? ? ? ? ? ? if ((ret = uvc_usb_reset(dev)))
+? ? ? ? ? ? ? ? ? ? ? return ret;
+
+? ? ? ? ? ? ? if ((ret = uvc_video_init(&dev->video)) < 0) {
+? ? ? ? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to initialize the device
"
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? "(%d).\n", ret);
+? ? ? ? ? ? ? ? ? ? ? return ret;
+? ? ? ? ? ? ? }
+#else
? ? ? ? ? ? ? ? uvc_printk(KERN_ERR, "Failed to initialize the device "
? ? ? ? ? ? ? ? ? ? ? ? "(%d).\n", ret);
? ? ? ? ? ? ? ? return ret;
+#endif
? ? ? ? }

? ? ? ? /* Register the device with V4L. */
@@ -1534,6 +1594,7 @@
? ? ? ? dev->udev = usb_get_dev(udev);
? ? ? ? dev->intf = usb_get_intf(intf);
? ? ? ? dev->intfnum = intf->cur_altsetting->desc.bInterfaceNumber;
+? ? ? dev->last_urb = 0;
? ? ? ? dev->quirks = id->driver_info;

? ? ? ? /* Parse the Video Class control descriptor */
Index: uvcvideo.h
===================================================================
--- uvcvideo.h? (r?vision 173)
+++ uvcvideo.h? (copie de travail)
@@ -324,6 +324,9 @@
#define UVC_FMT_FLAG_COMPRESSED? ? ? ? ? ? ? ? 0x00000001
#define UVC_FMT_FLAG_STREAM? ? ? ? ? ? 0x00000002

+/* Uncomment this to enable reset-on-timeout*/
+//#define UVC_RESET_ON_TIMEOUT
+
/* ------------------------------------------------------------------------
? * Structures.
? */
@@ -608,6 +611,11 @@

enum uvc_device_state {
? ? ? ? UVC_DEV_DISCONNECTED = 1,
+
+#ifdef UVC_RESET_ON_TIMEOUT
+? ? ? UVC_DEV_IOERROR = 2,
+#endif
+
};

struct uvc_device {
@@ -617,6 +625,7 @@
? ? ? ? int intfnum;

? ? ? ? enum uvc_device_state state;
+? ? ? unsigned long last_urb;
? ? ? ? struct kref kref;
? ? ? ? struct list_head list;

@@ -777,6 +786,14 @@
extern struct usb_host_endpoint *uvc_find_endpoint(
? ? ? ? ? ? ? ? struct usb_host_interface *alts, __u8 epaddr);

+
+#ifdef UVC_RESET_ON_TIMEOUT
+
+extern int uvc_video_reinit(struct uvc_video_device *video);
+extern int uvc_usb_reset(struct uvc_device *dev);
+
+#endif
+
/* Quirks support */
void uvc_video_decode_isight (struct urb *urb, struct uvc_video_device
*video, 
? ? ? ? ? ? ? ? struct uvc_buffer *buf);


_______________________________________________
Linux-uvc-devel mailing list
Linux-uvc-devel at lists.berlios.de
https://lists.berlios.de/mailman/listinfo/linux-uvc-devel


________________________________________
Ihre erste Baustelle? Wissenswertes f?r Bastler und Hobby Handwerker. 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: timing-mp.diff
Type: application/octet-stream
Size: 7443 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/8736bb34/attachment.obj>

From mxhaard at magic.fr  Mon Jan 28 16:39:02 2008
From: mxhaard at magic.fr (Michel Xhaard)
Date: Mon, 28 Jan 2008 16:39:02 +0100
Subject: [Linux-uvc-devel]
	=?utf-8?q?Little_questions_about_uvcvideos=2E?=
	=?utf-8?q?=2E=2E=09And=09possible_solutions_to_my_problem=2E?=
In-Reply-To: <628C2788-B140-427A-989C-B262D7757FF8@GMail.com>
References: <7D647E28-EB01-43BB-BA8E-A315D446E24A@GMail.com>
	<628C2788-B140-427A-989C-B262D7757FF8@GMail.com>
Message-ID: <200801281639.03298.mxhaard@magic.fr>

Le lundi 28 janvier 2008 15:11, Pierre MARTIN a ?crit?:
Pierre,
> Okay i have identified the problem when starting multiple instances of
> the program:
>
> - If i start the program in resolution 960x720, i can start it twice
> without errors.
> - If i start the program in resolution 1024x768, i get the following
> error for the 2nd instance:
> Unable to start capture: No space left on device
>   i: Error grabbing frames
No Space left on device mean there is not enought bandwidth on the usb bus. 
You can try to connect to another usb host controller on your mother board or 
add a USB to PCI addon card.
<snip>


-- 
Michel Xhaard
http://mxhaard.free.fr


From funtasyspace at yahoo.com  Mon Jan 28 15:57:26 2008
From: funtasyspace at yahoo.com (=?iso-8859-1?Q?J=F6rg_Hermsdorf?=)
Date: Mon, 28 Jan 2008 06:57:26 -0800 (PST)
Subject: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
Message-ID: <863928.96104.qm@web50006.mail.re2.yahoo.com>

I tried to apply your patch to revision 173, but I get the following errors:

# patch < timing-mp.diff
patching file uvc_status.c
Hunk #1 FAILED at 96.
Hunk #2 FAILED at 111.
Hunk #3 FAILED at 134.
Hunk #4 FAILED at 160.
4 out of 4 hunks FAILED -- saving rejects to file uvc_status.c.rej
patching file uvc_video.c
Hunk #1 FAILED at 38.
Hunk #2 FAILED at 547.
Hunk #3 FAILED at 773.
3 out of 3 hunks FAILED -- saving rejects to file uvc_video.c.rej
patching file uvc_v4l2.c
Hunk #1 FAILED at 461.
1 out of 1 hunk FAILED -- saving rejects to file uvc_v4l2.c.rej
patching file uvc_driver.c
Hunk #1 succeeded at 156 with fuzz 1.
Hunk #2 FAILED at 1459.
Hunk #3 FAILED at 1594.
2 out of 3
 hunks FAILED -- saving rejects to file uvc_driver.c.rej
patching file uvcvideo.h
Hunk #1 succeeded at 324 with fuzz 2.
Hunk #2 FAILED at 611.
Hunk #3 FAILED at 625.
Hunk #4 succeeded at 786 with fuzz 2.
2 out of 4 hunks FAILED -- saving rejects to file uvcvideo.h.rej

What am I doing wrong? Was your patch code garbled while sent over this mailing list? Could you send me your patch as a separate patch.diff text file as an attachment, please? Thanks.

Best Regards,
J?rg


 


      Heute schon einen Blick in die Zukunft von E-Mails wagen? www.yahoo.de/mail
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/a167b727/attachment.html>

From michel.stempin at wanadoo.fr  Mon Jan 28 16:03:23 2008
From: michel.stempin at wanadoo.fr (Michel Stempin)
Date: Mon, 28 Jan 2008 16:03:23 +0100
Subject: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
In-Reply-To: <479DEACA.8040309@gmx.net>
References: <264488.72270.qm@web50009.mail.re2.yahoo.com>
	<001501c861b9$d2baca40$3ec2fea9@compaq6710b>
	<479DEACA.8040309@gmx.net>
Message-ID: <000301c861be$ee45a000$3ec2fea9@compaq6710b>

Hello Tom,

Thank you, I already figured it out using this exact link!

I just meant that including some examples in the dynctrl.txt file would help
much, especially the values to fill in the structs, which are far from
obvious.

Regards,
Michel

> -----Message d'origine-----
> De?: Tom St [mailto:t.st1 at gmx.net]
> Envoy??: lundi 28 janvier 2008 15:47
> ??: Michel Stempin
> Objet?: Re: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
> 
> Hello Michel,
> > I just had some trouble getting the PTZ to work, as the documentation on
> the
> > dynamic ioctl() API is sparse (no example):)
> Perhaps you are interested in analysing in how i achieved to use
> dynctrls without much overhead.
> http://mjpg-streamer.svn.sourceforge.net/viewvc/mjpg-streamer/mjpg-
> streamer/plugins/input_uvc/dynctrl.c?revision=50&view=markup
> 
> Kind regards,
> Tom



From funtasyspace at yahoo.com  Mon Jan 28 16:36:46 2008
From: funtasyspace at yahoo.com (=?iso-8859-1?Q?J=F6rg_Hermsdorf?=)
Date: Mon, 28 Jan 2008 07:36:46 -0800 (PST)
Subject: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
Message-ID: <696752.12078.qm@web50001.mail.re2.yahoo.com>

Hi Michel,

> Enclosed 
you 
will 
find 
the 
patch. 
This 
time, 
I 
did 
a 
safe 
"diff 
-Naur"
> patch. 
It 
applies 
to 
the 
latest 
rev 
173 
without 
a 
glitch, 
using:
> $ 
cd 
source_dir
> $ 
patch 
-p1 
< 
path_to/timing-mp.diff

I could successfully apply your patch and compile uvcvideo. Thanks!

> This 
patch 
corrects 
the 
problems 
related 
in: 
> http://www.quickcamteam.net/documentation/faq/logitech-webcam-linux-usb-incompatibilities
> I 
am 
using 
a 
Logitech 
QuickCam 
Sphere 
MP, 
id: 
046d:08cc.
> Without 
the 
patch, 
the 
camera 
hangs 
randomly, 
with 
the 
following 
messages 
in the 
logs:
> uvcvideo: 
Failed 
to 
query 
(1) 
UVC 
control 
1 
(unit 
0) 
: 
-32
>
> I 
also 
experience 
errors 
-110, 
-71 
and 
-75.
> I 
have 
to 
unload 
the 
driver 
and 
reload 
it 
to 
recover 
the 
camera.

I have the same model. The only thing I experienced very seldom was, that after booting my machine 
the camera was not working / couldn't be correctly initialized or whatever. Just unloading the driver 
(with 'modprobe -r uvcvideo') and reloading it ('modprobe uvcvideo') didn't help in that case.
I had to unload the driver, plug-out the cam from the USB port and re-plug-in the cam
 (which reloads the driver automatically) to fix this situation. But as I said, this was very seldom the case.
I'll see if you patch fixes this problem too, or if I'll experience this hangs some day again :)

Best Regards,
J?rg






      Machen Sie Yahoo! zu Ihrer Startseite. Los geht's: 
http://de.yahoo.com/set
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/bf11cfcd/attachment.html>

From michel.stempin at wanadoo.fr  Mon Jan 28 16:44:15 2008
From: michel.stempin at wanadoo.fr (Michel Stempin)
Date: Mon, 28 Jan 2008 16:44:15 +0100
Subject: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch
In-Reply-To: <696752.12078.qm@web50001.mail.re2.yahoo.com>
References: <696752.12078.qm@web50001.mail.re2.yahoo.com>
Message-ID: <000d01c861c4$a399d070$3ec2fea9@compaq6710b>

Hi J?rg,

As stated in the link I provided, the problem is coming from the QC MP
firmware, and it looks like this is depending on the serial number :(

I guess I was unlucky, since I had the same problem with 3 different
cameras!

Regards,
Michel

________________________________________
De?: J?rg Hermsdorf [mailto:funtasyspace at yahoo.com] 
Envoy??: lundi 28 janvier 2008 16:37
??: linux-uvc-devel at lists.berlios.de
Cc?: Michel Stempin
Objet?: Re: [Linux-uvc-devel] Logitech QuickCam Sphere MP patch

Hi Michel,

> Enclosed you will find the patch. This time, I did a safe "diff -Naur"
> patch. It applies to the latest rev 173 without a glitch, using:
> $ cd source_dir
> $ patch -p1 < path_to/timing-mp.diff

I could successfully apply your patch and compile uvcvideo. Thanks!

> This patch corrects the problems related in: 
>
http://www.quickcamteam.net/documentation/faq/logitech-webcam-linux-usb-inco
mpatibilities
> I am using a Logitech QuickCam Sphere MP, id: 046d:08cc.
> Without the patch, the camera hangs randomly, with the following messages
in the logs:
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -32
>
> I also experience errors -110, -71 and -75.
> I have to unload the driver and reload it to recover the camera.

I have the same model. The only thing I experienced very seldom was, that
after booting my machine 
the camera was not working / couldn't be correctly initialized or whatever.
Just unloading the driver 
(with 'modprobe -r uvcvideo') and reloading it ('modprobe uvcvideo') didn't
help in that case.
I had to unload the driver, plug-out the cam from the USB port and
re-plug-in the cam
?(which reloads the driver automatically) to fix this situation. But as I
said, this was very seldom the case.
I'll see if you patch fixes this problem too, or if I'll experience this
hangs some day again :)

Best Regards,
J?rg


________________________________________
Jetzt Mails schnell in einem Vorschaufenster ?berfliegen. Dies und viel mehr
bietet das neue Yahoo! Mail. 



From hickscorp at gmail.com  Mon Jan 28 16:50:05 2008
From: hickscorp at gmail.com (Pierre MARTIN)
Date: Mon, 28 Jan 2008 16:50:05 +0100
Subject: [Linux-uvc-devel] Little questions about
	uvcvideos...	And	possible solutions to my problem.
In-Reply-To: <200801281639.03298.mxhaard@magic.fr>
References: <7D647E28-EB01-43BB-BA8E-A315D446E24A@GMail.com>
	<628C2788-B140-427A-989C-B262D7757FF8@GMail.com>
	<200801281639.03298.mxhaard@magic.fr>
Message-ID: <AB2C3BFF-5239-4226-8E6B-0A67D42ED9EE@gmail.com>

Oh. My. Gosh =/

The computer on which i need to make run 5 webcams is a laptop... How  
can i solve the problem?
Is there any way to tell MJPGStreamer to work with some mutexes to  
allow it to grab a frame on each webcam never simultaneously?

As i have said before, i don't need live previews of the cams, but to  
be able to shoot them (almost) simultaneously... We will then use the  
5 shots to make 3D meshes of the object.
Any idea? =/

Thanks for the info!
Pierre.

On 28 janv. 08, at 16:39, Michel Xhaard wrote:

> Le lundi 28 janvier 2008 15:11, Pierre MARTIN a ?crit :
> Pierre,
>> Okay i have identified the problem when starting multiple instances  
>> of
>> the program:
>>
>> - If i start the program in resolution 960x720, i can start it twice
>> without errors.
>> - If i start the program in resolution 1024x768, i get the following
>> error for the 2nd instance:
>> Unable to start capture: No space left on device
>>  i: Error grabbing frames
> No Space left on device mean there is not enought bandwidth on the  
> usb bus.
> You can try to connect to another usb host controller on your mother  
> board or
> add a USB to PCI addon card.
> <snip>
>
>
> -- 
> Michel Xhaard
> http://mxhaard.free.fr



From funtasyspace at yahoo.com  Mon Jan 28 17:16:21 2008
From: funtasyspace at yahoo.com (=?iso-8859-1?Q?J=F6rg_Hermsdorf?=)
Date: Mon, 28 Jan 2008 08:16:21 -0800 (PST)
Subject: [Linux-uvc-devel] drop incomplete frames
Message-ID: <244205.43955.qm@web50001.mail.re2.yahoo.com>

Hi Laurent, hi List,

back in October last year you wrote and send me the drop-incomplete patch. I still have to apply this patch to the latest uvcvideo revision (v173). 
Without this patch I can hardly grap a stream from the cam for longer than a few seconds.

I would like to raise the question if there a other users affected by this problem too and if there are plans to integrate this patch or a similar feature into trunk?

Best Regards,
J?rg




        __________________________________  Ihr erstes Baby? Holen Sie sich Tipps von anderen Eltern.  www.yahoo.de/clever
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/7a16edd4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: drop-incomplete.diff
Type: text/x-patch
Size: 1242 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/7a16edd4/attachment.bin>

From alex at seewald.at  Mon Jan 28 19:37:48 2008
From: alex at seewald.at (Dr. Alexander K. Seewald)
Date: Mon, 28 Jan 2008 19:37:48 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
	possible solutions to my problem.
Message-ID: <20080128183748.GA31787@sdg.at>

Hi Pierre,

Some ideas:
1) Try attaching the cameras to different USB ports, starting with
   only two cameras. Even the simplest notebooks should have two
   independent USB controllers. As Michael said, each one needs a lot
   of bandwidth.
2) Try reducing the framerate. I'm not sure whether this will have
   an effect, though.
3) Do you need the images in fast sequence? Setting up and getting
   single shots e.g. via uvccapture takes ~ 1-2 seconds per image,
   so in ten seconds you could sequentially access your five cameras.
   http://staticwave.ca/source/uvccapture/
   Probably removing the JPEG-to-YUV encoding code and outputting YUV
   would be a good idea to improve runtime. ;-)
   This _should_ allow you to keep all cameras connected to any port
   (IMHO - I have not tested this)
4) If you can work with image from multiple directions and one point
   of origin, there is a well-supported camera with pan/tilt - the
   Logitech QC Sphere.

HTH,
  Alex
-- 
Dr. Alexander K. Seewald         +43(664)1106886
              Seewald Solutions                 
------------------------------------------------
  Research & Development for the 21st Century
--------------- www.seewald.at -----------------


From t.st1 at gmx.net  Mon Jan 28 19:43:54 2008
From: t.st1 at gmx.net (Tom St)
Date: Mon, 28 Jan 2008 19:43:54 +0100
Subject: [Linux-uvc-devel] drop incomplete frames
In-Reply-To: <244205.43955.qm@web50001.mail.re2.yahoo.com>
References: <244205.43955.qm@web50001.mail.re2.yahoo.com>
Message-ID: <479E226A.9000401@gmx.net>

Hello J?rg,
I experienced issues in low light situations with my Logitech QC 5000 
(OpenWrt Kamikaze trunk + Linux-UVC #132). The resulting files are quite 
small (below 10k) and incomplete (i see JPEG-artifacts). Is this the 
same problem you encountered? Due to that behaviour is just added a 
"minimum-size" command line switch and drop frames smaller then this limit.

Regards,
Tom


From funtasyspace at yahoo.com  Mon Jan 28 20:17:07 2008
From: funtasyspace at yahoo.com (=?iso-8859-1?Q?J=F6rg_Hermsdorf?=)
Date: Mon, 28 Jan 2008 11:17:07 -0800 (PST)
Subject: [Linux-uvc-devel] drop incomplete frames
Message-ID: <444014.75701.qm@web50002.mail.re2.yahoo.com>

Hi Tom,

no, I think it has nothing to do with low light conditions...

ffmpeg aborts and reports errors like this:
> 
[video4linux2 
@ 
0x2b91704f3220]The 
v4l2 
frame 
is 
25600 
bytes, 
but 
153600
> 
bytes 
are 
expected 
....

Here's an excerpt of the conversation I had with Laurent in October:
J?rg:
>> 
It's 
always 
the 
same 
error, 
ffmpeg 
aborts 
because 
at 
some 
point 
it 
receives
>> 
a 
v4l2 
frame 
that 
has 
a 
smaller 
size 
than 
expected. 
The 
actual 
frame 
size
>> 
of 
the 
erroneous 
frame 
is 
always 
different 
(I 
posted 
two 
examples 
above) 
.
>> 
So 
it 
seems 
to 
me, 
that's 
a 
problem 
with 
uvcvideo, 
which 
at 
some 
point 
just
>> 
delivers 
a 
corrupt/incomplete 
frame. 
ffmpeg 
can't 
handle 
that 
and 
aborts.
>> 
But 
the 
file 
that 
has 
been 
captured 
so 
far 
(until 
ffmpeg 
aborts) 
looks 
good
>> 
and 
can 
be 
played 
with 
vlc, 
so 
I 
have 
hope 
that 
this 
issue 
can 
be 
fixed 
and
>> 
that 
piping 
ffmpeg's 
output 
to 
vlc 
should 
be 
possible 
to 
stream 
my 
cam
>> 
mpeg4 
encoded 
via 
http.

Laruents answer:
> The 
USB 
isochronous 
transfers 
are 
not 
error 
free. 
Packets 
can 
be 
lost, 
which 
> result 
in 
incomplete/erroneous 
frames. 
The 
only 
way 
I 
can 
think 
of 
to 
detect 
> those 
erroneous/incomplete 
frames 
is 
to 
look 
at 
the 
frame 
size. 
This 
can 
be 
> done 
for 
uncompressed 
formats, 
but 
will 
obviously 
be 
useless 
for 
compressed 
> format.

> The 
driver 
currently 
handles 
complete 
and 
incomplete 
frames 
the 
same 
way. 
I 
> can 
add 
a 
driver 
option 
to 
make 
it 
drop 
incomplete 
frames, 
returning 
complete 
> frames 
only 
to 
the 
application. 
Would 
you 
be 
able 
to 
test 
that 
?

Regards,
J?rg




        __________________________________  Ihr erstes Baby? Holen Sie sich Tipps von anderen Eltern.  www.yahoo.de/clever
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080128/e9dae9f1/attachment.html>

From rankincj at yahoo.com  Tue Jan 29 01:00:53 2008
From: rankincj at yahoo.com (Chris Rankin)
Date: Tue, 29 Jan 2008 00:00:53 +0000 (GMT)
Subject: [Linux-uvc-devel] Logitech Quickcam Deluxe (0x046d:0x0992) is
	temperamental
Message-ID: <274836.46427.qm@web52911.mail.re2.yahoo.com>

Hi,

I have a Logitech Quickcam Deluxe webcam (0x046d:0x0992) but have discovered that it has some
"quirks" under the uvcvideo (SVN #173, probably other versions too) driver:

a) Sometimes, there is no picture at all when I start ekiga (video-conferencing) up. In order to
restore the picture I either need to replug the device into the hub or reload the uvcvideo module
- I'm not sure exactly what it is that starts the webcam working again. The microphone still
works, though.
b) Despite being a USB 2.0 device, the picture is blurry when it moves. This does not compare at
all well with the picture from my Logitech 0x46d:0x09c1 device (also UVC), which has "movie
camera" quality on the same machine.

This is the webcam's device descriptor:

T:  Bus=04 Lev=02 Prnt=03 Port=03 Cnt=01 Dev#=  5 Spd=480 MxCh= 0
D:  Ver= 2.00 Cls=ef(unk. ) Sub=02 Prot=01 MxPS=64 #Cfgs=  1
P:  Vendor=046d ProdID=0992 Rev= 0.05
S:  SerialNumber=1D522ED1
C:* #Ifs= 4 Cfg#= 1 Atr=80 MxPwr=500mA
A:  FirstIf#= 0 IfCount= 2 Cls=0e(video) Sub=03 Prot=00
A:  FirstIf#= 2 IfCount= 2 Cls=01(audio) Sub=02 Prot=00
I:* If#= 0 Alt= 0 #EPs= 1 Cls=0e(video) Sub=01 Prot=00 Driver=uvcvideo
E:  Ad=87(I) Atr=03(Int.) MxPS=  16 Ivl=16ms
I:* If#= 1 Alt= 0 #EPs= 0 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
I:  If#= 1 Alt= 1 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS= 192 Ivl=125us
I:  If#= 1 Alt= 2 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS= 384 Ivl=125us
I:  If#= 1 Alt= 3 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS= 512 Ivl=125us
I:  If#= 1 Alt= 4 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS= 640 Ivl=125us
I:  If#= 1 Alt= 5 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS= 800 Ivl=125us
I:  If#= 1 Alt= 6 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS= 944 Ivl=125us
I:  If#= 1 Alt= 7 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS=1280 Ivl=125us
I:  If#= 1 Alt= 8 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS=1600 Ivl=125us
I:  If#= 1 Alt= 9 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS=1984 Ivl=125us
I:  If#= 1 Alt=10 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS=2688 Ivl=125us
I:  If#= 1 Alt=11 #EPs= 1 Cls=0e(video) Sub=02 Prot=00 Driver=uvcvideo
E:  Ad=81(I) Atr=05(Isoc) MxPS=3060 Ivl=125us
I:* If#= 2 Alt= 0 #EPs= 0 Cls=01(audio) Sub=01 Prot=00 Driver=snd-usb-audio
I:* If#= 3 Alt= 0 #EPs= 0 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
I:  If#= 3 Alt= 1 #EPs= 1 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
E:  Ad=86(I) Atr=05(Isoc) MxPS=  68 Ivl=1ms

Does anyone have any idea what is happening, please?

Thanks,
Chris



      ___________________________________________________________
Yahoo! Answers - Got a question? Someone out there knows the answer. Try it
now.
http://uk.answers.yahoo.com/ 


From alex at seewald.at  Tue Jan 29 14:08:37 2008
From: alex at seewald.at (Dr. Alexander K. Seewald)
Date: Tue, 29 Jan 2008 14:08:37 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
	possible solutions to my problem
Message-ID: <20080129130837.GA1357@sdg.at>

Hi Pierre,

It does not look good... according to USB bandwidth theoretically
three cameras per USB controller should be possible, but practically
at most two can be run at the desired maximum resolution. This means
that to attach five cameras, you need more USB controllers - easy
for a desktop system, but only possible to a limited extent for
notebooks... you could use two 2-port USB 2.0 controllers via
PCMCIA, which - provided you manage to connect two cameras each -
might just about suffice. But it's not sure whether this would work.

Alternatively, a decent desktop system should have at least two
independent USB 2.0 controllers; add three dedicated PCI cards
with USB2.0 controllers, and you have enough bandwidth to attach
five cameras. It's a bit cumbersome, but would probably work,
provided the system can handle the load.

Prevent snd-usb-audio from loading (e.g. by renaming the module from
/lib/modules, it's called snd-usb-audio.ko) - it also takes away
some bandwidth, but this is a minor issue.

There might still be a way to reduce USB camera bandwidth by
reducing framerate, but I'm not sure whether this is possible on
the hardware. I've asked around and will let you know the results.

Best,
  Alex
-- 
Dr. Alexander K. Seewald         +43(664)1106886
              Seewald Solutions                 
------------------------------------------------
  Research & Development for the 21st Century
--------------- www.seewald.at -----------------


From alex at seewald.at  Tue Jan 29 16:15:31 2008
From: alex at seewald.at (Dr. Alexander K. Seewald)
Date: Tue, 29 Jan 2008 16:15:31 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos... And
	possible solutions to my problem.
Message-ID: <20080129151531.GA2579@sdg.at>

Hi Pierre,

Sorry, the fps cannot be set below 5fps - it's a hardware limit.
mjpeg-streamer throws away superfluous frames, but they are still
sent. So you're stuck using:
a) uvccapture to get a single frame from each camera sequentially
   (with 1-2 seconds per camera ~ 10 seconds for getting all images)
b) one machine with multiple USB2 controllers (two cameras per controller)
... or even ...
c) multiple machines with multiple USB2 controllers

c) might be necessary because 6.6 cameras will max-out the
theoretical PCI bandwidth of around 1 GBit, and you might hit the practical
limit long before that. So a) is probably the best way, perhaps this
can be sped up a bit by taking a close look at the code.

All the best,
  Alex
-- 
Dr. Alexander K. Seewald         +43(664)1106886
              Seewald Solutions                 
------------------------------------------------
  Research & Development for the 21st Century
--------------- www.seewald.at -----------------


From t.st1 at gmx.net  Tue Jan 29 16:45:42 2008
From: t.st1 at gmx.net (Tom St)
Date: Tue, 29 Jan 2008 16:45:42 +0100
Subject: [Linux-uvc-devel] Little questions about uvcvideos...
 And	possible solutions to my problem.
In-Reply-To: <20080129151531.GA2579@sdg.at>
References: <20080129151531.GA2579@sdg.at>
Message-ID: <479F4A26.5070209@gmx.net>

Hi Pierre,
> a) uvccapture to get a single frame from each camera sequentially
>    (with 1-2 seconds per camera ~ 10 seconds for getting all images)
>
>   
a.2) run two instances of uvccapture in parallel (~5 s per update). The 
first script grabs /dev/video0 to /dev/video2 and the second script 
/dev/video3 to /dev/video5...


From shaohuang at gmail.com  Tue Jan 29 20:43:54 2008
From: shaohuang at gmail.com (Brian Pin)
Date: Tue, 29 Jan 2008 11:43:54 -0800
Subject: [Linux-uvc-devel] complete routine...
Message-ID: <a81f87bb0801291143q4e7b905dsb01fac5f72a28946@mail.gmail.com>

Hello,

Won't we spend a lot of time at video complete routine?
for each packet, there is 40 packets to deal with.
and if there is data inside each packet,
we are going to use memcpy to move data...and that could be
very slow. On the other side, we are doing completion in
interrupt....
So does anybody think that completion routine would cause
serious perforamnce degradation? Or I just thought too much?

-- 
Best Regards
Brian


From andfe082 at student.liu.se  Tue Jan 29 21:46:58 2008
From: andfe082 at student.liu.se (Andreas Ferm)
Date: Tue, 29 Jan 2008 21:46:58 +0100
Subject: [Linux-uvc-devel] Panasonic NV-GS230
Message-ID: <1201639618.29447.84.camel@mobilus>

Hello good people,

According to the list on http://linux-uvc.berlios.de/#devices this model
is not officially supported, and since one of those just popped in by
mail i would give it a try here.

Like some other cameras it has 2 modes, a dv and webcam mode. When in
webcam mode it is being identified as 

Bus 003 Device 012: ID 04da:2318 Panasonic (Matsushita)

Which is the same as the Panasonic NV-GS11 camera. It can stream in
luvcview, but when used in other programs (especially mjpeg-streamer) to
for example output jpegs it fails. The jpegs are around 20k which sounds
correct, but when opening them it complains over "Huffman table 0x00 was
not defined" so they've either been bad captured or there's something
spooky with the jpegs the camera outputs (less likely?).

lsusb output for webcam mode >>
Bus 003 Device 012: ID 04da:2318 Panasonic (Matsushita) 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04da Panasonic (Matsushita)
  idProduct          0x2318 
  bcdDevice            1.00
  iManufacturer           1 Panasonic
  iProduct                2 DVC
  iSerial                 3 119280e1
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          258
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                2mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               4 Web-Camera
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              4 Web-Camera
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           39
        dwClockFrequency       13.500000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          2
        iTerminal               6 Camera
        wObjectiveFocalLengthMin    100
        wObjectiveFocalLengthMax   1200
        wOcularFocalLength          100
        bControlSize                  2
        bmControls           0x00000200
          Zoom (Absolute)
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          1
        bSourceID               1
        iTerminal               7 USB
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              8 VideoStreamingInterface
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormarts                        1
        wTotalLength                    33024
        bEndPointAddress                    0
        bmInfo                              2
        bTerminalLink                       0
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                1
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x02
          Interlaced stream or variable: No
          Fields per frame: 2 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   655360
        dwMaxBitRate                  3276800
        dwMaxVideoFrameBufferSize       32768
        dwDefaultFrameInterval         800000
        bFrameIntervalType                  0
        dwMinFrameInterval             800000
        dwMaxFrameInterval             800000
        dwFrameIntervalStep                 0
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              8 VideoStreamingInterface
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       1 Control Device
      bFunctionProtocol       0 
      iFunction               2 DVC
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           30
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             2
        wChannelConfig     0x0003
          Left Front (L)
          Right Front (R)
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               1
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           2
        bDelay                  2 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             2
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x00
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Status:     0x0001
  Self Powered

>>>

The story for dv-mode is a bit different though, no output at all (not
so strange).

Bus 001 Device 020: ID 04da:231a Panasonic (Matsushita) 

lsusb output for dv-mode >>


Bus 001 Device 020: ID 04da:231a Panasonic (Matsushita) 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04da Panasonic (Matsushita)
  idProduct          0x231a 
  bcdDevice            1.00
  iManufacturer           1 Panasonic
  iProduct                2 DVC
  iSerial                 3 119280e1
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          175
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower                2mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               4 Video Edit
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              4 Video Edit
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           89
        dwClockFrequency       13.500000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               6 Camera
        wObjectiveFocalLengthMin    100
        wObjectiveFocalLengthMax   1000
        wOcularFocalLength          100
        bControlSize                  2
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                16
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0202 Sequential Media
        bAssocTerminal          0
        iTerminal               7 MTIT
        junk at descriptor end: 01 0f 05 ef ff ff 7f 02
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               8 OT
      VideoControl Interface Descriptor:
        bLength                 8
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               2
        baSource( 0)            1
        baSource( 1)            2
        iSelector               9 SU
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {6f04be00-b9e8-4b11-8fa2-a5b99e5a7698}
        bNumControl             3
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0x07
        iExtension             10 XU
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface             11 DV IN
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormarts                        1
        wTotalLength                    33024
        bEndPointAddress                    0
        bmInfo                              3
        bTerminalLink                       0
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                     9
      VideoStreaming Interface Descriptor:
        bLength                             9
        bDescriptorType                    36
        bDescriptorSubtype                 12         Invalid desc
subtype: 01 80 32 02 00 00
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface             11 DV IN
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x01ec  1x 492 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0         8
  bNumConfigurations      1
Device Status:     0x0001
  Self Powered
>>

I hope it can be of some use.

Regards
Andreas





From justinmattock at gmail.com  Tue Jan 29 21:59:03 2008
From: justinmattock at gmail.com (Justin Mattock)
Date: Tue, 29 Jan 2008 20:59:03 +0000
Subject: [Linux-uvc-devel] isight
Message-ID: <dd18b0c30801291259x7f44a9b1n6556ef8cb94ee56f@mail.gmail.com>

Hello I'm trying to compile against-revision-140 on kernel-2.6.24-rc8 with
no luck; the error message is this:
make[2]:  Entering directory `/home/kernel/linux-2.6.24-rc8'
     CC [M]    /home/?/against-revision-140/src/uvc_driver.o
/home/?/against-revision-140/src/uvc_driver.c: In function
'uvc_register_video' :
/home/?/against-revision-140/src/uvc_driver.c:1442: error: 'struct
video_device' has no member named 'hardware'
make[3]: ***[/home/?/against-revision-140/src/uvc_driver.o] Error 1
make[2]: ***[_module_/home/?/against-revision-140/src] Error 2
make[2]: Leaving directory `/home/kernel/linux-2.6.24-rc8'
make[1]: ***[uvcvideo] Error 2
make[1]: Leaving directory `/home/?/against-revision-140/src'
make: *** [all] Error 2

Is there a new patch for kernel-2.6.24-rc8 or is this a configuration within
the kernel (.config);
regards;
              --Justin P. Mattock
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080129/03b07577/attachment.html>

From daniel-linux at bol.com.br  Wed Jan 30 02:48:17 2008
From: daniel-linux at bol.com.br (daniel-linux)
Date: Tue, 29 Jan 2008 23:48:17 -0200
Subject: [Linux-uvc-devel] Acer Crystal Eye
Message-ID: <JVFP0H$1236FB34AB9715D4ED453F49CEB2BAED@bol.com.br>

Hi folks,

I am Daniel from Brazil...while people here just think at carnaval, i am working and i need my webcam to work :-)

I have the Acer 5720 laptop with Crystal Eye built-in (Bus 007 Device 002: ID 064e:a101 Suyin Corp) . My doubt.

The cam works ! But when I access any IM (amsn or kopete) I just can sent video for some minutes, after that the image just freeze. Than i need restart the video to get work. So, what do i need show here for you guys gimme some tips ?

Bests,
Daniel




From katarzyna.kaczor at lpmagazine.org  Wed Jan 30 16:03:25 2008
From: katarzyna.kaczor at lpmagazine.org (Katarzyna Kaczor)
Date: Wed, 30 Jan 2008 16:03:25 +0100
Subject: [Linux-uvc-devel] Total pack of Linux+ mag?
Message-ID: <200801301603.26157.katarzyna.kaczor@lpmagazine.org>

Good day to all,

We have prepared a very special offer available exclusively to the members and 
visitors of linux-uvc-devel at lists.berlios.de! ?

Only now you can get the TOTAL PACK of Linux+ issues in PDF for just 15 USD 
(The regular price is 24,99 USD)

In each issue you can find information concerning typical use of 
Linux: safety, databases, multimedia, scientific tools, entertainment, 
programming, e-mail, news and desktop environments.

By getting TOTAL PACK you will have a chance to have at your fingertip 
everything the Linux+ team has released since the beginning. ?Being in PDF 
format it is very easy to search through and it can travel with you as well.

Don't miss this unique chance! 

This offer is valid until the 7th of February 2008.

In order to subscribe feel free to contact me directly at 
katarzyna.kaczor at lpmagazine.org 

Thnx 
-- 
Katarzyna Kaczor
Linux+ DVD magazine

///////////////////////////////////////////////
Software Media LLC
1461 A First Avenue, # 360
New York, NY 10021-2209
USA

phone number: 1-917-338 - 3631/ +48 22 427 35 34
fax: ?+48 22 887 10 11
www.lpmagazine.org/en
http://www.buyitpress.com/en/


From matti at picus.org.il  Wed Jan 30 22:13:37 2008
From: matti at picus.org.il (matti)
Date: Wed, 30 Jan 2008 23:13:37 +0200
Subject: [Linux-uvc-devel] Grabbee X (Terratec Cinergy 200 USB)
Message-ID: <47A0E881.6070807@picus.org.il>

I got the grabbee X usb 2.0 video grabber to work on ubuntu 7.10 by
using the stock kernel
e28xx module then using usbreplay to load up a usbsnoop processed
logfile. How can I share my positive experience? Would someone like the
88kB analyzed log?

Matti Picus



From s0238762 at sms.ed.ac.uk  Thu Jan 31 02:14:56 2008
From: s0238762 at sms.ed.ac.uk (Ioannis Nousias)
Date: Thu, 31 Jan 2008 01:14:56 +0000
Subject: [Linux-uvc-devel] convert MJPEG to YUYV on-the-fly
Message-ID: <47A12110.4010701@sms.ed.ac.uk>


Although not directly related to linux-uvc development, I think this is 
the right crowd to ask this question.

I have a point-and-shoot Fuji camera, with webcam support. It works 
really well with linux-uvc driver thanks to  Laurent's efforts a while 
back. It produces MJPEG only. It doesn't have a YUYV option. That's ok 
for something like egika, but skype seems to not like it. I think it 
only accepts YUV raw streams.

Now my question is this. Is there an application/module that can sit 
between the video device and something like skype, converting the MJPEG 
in run-time to YUYV? Some kind of post-processing module that creates a 
re-directed video device, which can then be used by other applications. 
So you'll probably get something like '/dev/video1' which is in fact the 
processed '/dev/video0' (in my case the decoded MJPEG stream).

I would be really surprised if something like this doesn't exist. It's a 
really cool thing to have in general. A basic search on google didn't 
return anything relevant.

regards
-Ioannis



From mikiwoz at yahoo.co.uk  Wed Jan 30 11:40:23 2008
From: mikiwoz at yahoo.co.uk (=?utf-8?q?Micha=C5=82_Andrzej_Wo=C5=BAniak?=)
Date: Wed, 30 Jan 2008 11:40:23 +0100
Subject: [Linux-uvc-devel] ALI 5606
Message-ID: <200801301140.27889.mikiwoz@yahoo.co.uk>

Hi guys

I am trying to get ALI 5606 to work (ID 0402:5606) on Kubuntu 7.10 (Gutsy 
Gibbon).

The uvcvideo module (from SVN, rev173) compiled nicely and loads OK, but does 
*not* print anything in dmesg/syslog upon loading. When I try to run 
luvcview, I get:

luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
Unable to set format: 5.
 Init v4L2 failed !! exit fatal

...regardless, what format and/or other settings I use. On syslog/dmesg I ony 
get:

uvcvideo: Failed to query (130) UVC control 1 (unit 0) : 2 (exp. 26).

That is *very similar* to what has been described (and marked as solved!) 
here:
http://lists.berlios.de/pipermail/linux-uvc-devel/2007-November/002486.html

I even checked uvc_driver.c and I *do* have the lines as they should look 
after the patch has been applied. So, most probably, I am missing something 
very obvious. Or am I not?..

Any pointers will be apprecieated. Thanks
Mike

P.S.
Attached, outputs of:
 - lsusb -v (for the webcam device), 
 - luvcview
 - luvcview -L
 - xawtv -hwscan
 - v4l-info
-------------- next part --------------
A non-text attachment was scrubbed...
Name: v4l-info.log
Type: text/x-log
Size: 4369 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080130/a99f6c16/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: luvcview.log
Type: text/x-log
Size: 149 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080130/a99f6c16/attachment-0001.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: xawtv_-hwscan.log
Type: text/x-log
Size: 306 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080130/a99f6c16/attachment-0002.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb_-v.log
Type: text/x-log
Size: 19264 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080130/a99f6c16/attachment-0003.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: luvcview_-L.log
Type: text/x-log
Size: 1288 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080130/a99f6c16/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080130/a99f6c16/attachment.pgp>

