From swiergot at gmail.com  Sat Nov  1 21:48:12 2008
From: swiergot at gmail.com (Jaroslaw Swierczynski)
Date: Sat, 1 Nov 2008 21:48:12 +0100
Subject: [Linux-uvc-devel] Genesys Logic 05e3:f192
Message-ID: <d73d7acb0811011348k490a2bd5q53450448c8734165@mail.gmail.com>

Hello,

I have this webcam, built into Asus S96S laptop and I'm trying to get
it working. Googling I found a suggestion to edit uvc_driver.c and
replace 0505 with f192. So I did and had also to change
.bInterfaceClass and .bInterfaceSubClass to match modalias which is:

usb:v05E3pF192d0103dc00dsc00dp00icFFisc00ip00

Unfortunatelly that didn't do the trick. After loading the uvcvideo
module dmesg showed:

uvcvideo: Found UVC 0.00 device PC Camera4 (05e3:f192)
uvcvideo: No valid video chain found.
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r262)

No /dev/video0. Below is the output of "lsusb -v -d 05e3:f192". Please help.

Bus 002 Device 003: ID 05e3:f192 Genesys Logic, Inc.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  idVendor           0x05e3 Genesys Logic, Inc.
  idProduct          0xf192
  bcdDevice            1.03
  iManufacturer           2 Genesys Logic
  iProduct                3 PC Camera4
  iSerial                 4 000000001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          129
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower               96mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 1024 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval               5
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

Take care,
Jarek


From chris at slavesoftware.co.uk  Sun Nov  2 05:53:17 2008
From: chris at slavesoftware.co.uk (Chris Hodgkins)
Date: Sun, 02 Nov 2008 04:53:17 +0000
Subject: [Linux-uvc-devel] Anyone have Adobe's Flash 10 (now supports V4L2)
	working with a	UVC cam?
Message-ID: <1225601597.13990.11.camel@ubuntu>

Adobe's Flash 10.0 r12 now appears to have V4L2 support. 

Out of curiosity I tried to use a Creative Live Cam Optia that works
well with Ekiga, Cheese, Skype etc. with Yahoo's conferencing web
service at http://live.yahoo.com

It's close to working; My cam light comes on and I see myself for a
brief second but then the cam goes off. DMESG gives this:
[244583.228712] uvcvideo: device Live! Cam Optia requested null
bandwidth, defaulting to lowest.
I'm wondering if this is an Adobe Flash SNAFU, or something more
specific to my particular make of cam and its interaction with the uvc
driver.

cheers
-- 
Chris. 




From amy at ameliezapf.com  Sun Nov  2 23:55:19 2008
From: amy at ameliezapf.com (Amelie Zapf)
Date: Sun, 2 Nov 2008 23:55:19 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
Message-ID: <200811022355.20272.amy@ameliezapf.com>

Dear list members,

I have a new laptop with an included webcam that is identified by lsusb -v as 
[Exhibit 1]. As such it should be supported by the uvcvideo driver.

I compiled and installed the driver. Everything went well, the driver loads 
OK. Output from lsmod is shown in [Exhibit 2]. A device /dev/video0 is 
created. However, upon trying to use the camera, errors occur as shown in 
[Exhibit 3], the output of dmesg | grep uvc.

"Using the camera", as stated above, meant: using luvcview. Upon call of 
luvcview, [Exhibit 4] was received as error message, the logical next step of 
calling luvcview -f yuv returned the error message shown in [Exhibit 5].

I'd be grateful for anybody pointing me toward what I'm doing wrong. I'm 
frankly clueless.

Kind regards,

Amy



===
Exhibit 1:

Bus 006 Device 003: ID 174f:5a31 Syntek
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x174f Syntek
  idProduct          0x5a31
  bcdDevice           11.12
  iManufacturer           2
  iProduct                1
  iSerial                 3
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          627
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              1
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           77
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             1
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x01
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x000037ff
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          White Balance Component
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
          White Balance Component, Auto
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      407
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat                            
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   614400
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   202752
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   153600
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                    50688
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                    38400
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                  2457600
        dwMaxBitRate                 22118400
        dwMaxVideoFrameBufferSize     2457600
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
        dwFrameInterval( 2)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                  2621440
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
        dwFrameInterval( 2)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               7
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                       1280
        wHeight( 1)                       960
        wWidth( 2)                        640
        wHeight( 2)                       480
        wWidth( 3)                        352
        wHeight( 3)                       288
        wWidth( 4)                        320
        wHeight( 4)                       240
        wWidth( 5)                        176
        wHeight( 5)                       144
        wWidth( 6)                        160
        wHeight( 6)                       120
        bNumCompressionPatterns             7
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13e8  3x 1000 bytes
        bInterval               1

===
Exhibit 2:

Module                  Size  Used by
ip6t_LOG               23940  8
xt_tcpudp              20480  6
xt_pkttype             18944  3
ipt_LOG                23428  9
xt_limit               20356  17
snd_pcm_oss            68992  0
snd_mixer_oss          35584  1 snd_pcm_oss
binfmt_misc            30220  1
snd_seq                83600  0
nfs                   312408  1
lockd                  94032  2 nfs
nfs_acl                20736  1 nfs
sunrpc                240312  11 nfs,lockd,nfs_acl
ip6t_REJECT            22272  3
nf_conntrack_ipv6      36168  4
ipt_REJECT             21120  3
xt_state               19712  8
iptable_mangle         20608  0
iptable_nat            24976  0
nf_nat                 39576  1 iptable_nat
iptable_filter         20736  1
ip6table_mangle        20480  0
nf_conntrack_netbios_ns    19968  0
nf_conntrack_ipv4      29576  7 iptable_nat,nf_nat
nf_conntrack           91536  6 
nf_conntrack_ipv6,xt_state,iptable_nat,nf_nat,nf_conntrack_netbios_ns,nf_conntrack_ipv4
ip_tables              39056  3 iptable_mangle,iptable_nat,iptable_filter
cpufreq_conservative    26248  0
ip6table_filter        20608  1
cpufreq_userspace      23556  0
ip6_tables             40720  3 ip6t_LOG,ip6table_mangle,ip6table_filter
cpufreq_powersave      18816  0
x_tables               43144  11 
ip6t_LOG,xt_tcpudp,xt_pkttype,ipt_LOG,xt_limit,ip6t_REJECT,ipt_REJECT,xt_state,iptable_nat,ip_tables,ip6_tables
powernow_k8            32772  1
ipv6                  331544  21 ip6t_REJECT,nf_conntrack_ipv6,ip6table_mangle
vfat                   30848  0
fat                    74168  1 vfat
fuse                   72256  5
loop                   37508  0
dm_mod                 88600  0
uvcvideo               75912  0
snd_hda_intel         497452  1
snd_usb_audio         117504  0
snd_usb_lib            37504  1 snd_usb_audio
snd_pcm               115208  3 snd_pcm_oss,snd_hda_intel,snd_usb_audio
snd_rawmidi            46976  1 snd_usb_lib
snd_timer              45072  2 snd_seq,snd_pcm
snd_seq_device         26516  2 snd_seq,snd_rawmidi
snd_page_alloc         28688  2 snd_hda_intel,snd_pcm
snd_hwdep              28424  2 snd_hda_intel,snd_usb_audio
sdhci                  35980  0
snd                    96248  13 
snd_pcm_oss,snd_mixer_oss,snd_seq,snd_hda_intel,snd_usb_audio,snd_usb_lib,snd_pcm,snd_rawmidi,snd_timer,snd_seq_device,snd_hwdep
i2c_piix4              27276  0
rtc_cmos               28728  0
mmc_core               74304  1 sdhci
rtc_core               41012  1 rtc_cmos
k8temp                 23040  0
ohci1394               50868  0
rtc_lib                20224  1 rtc_core
serio_raw              24708  0
joydev                 30848  0
sr_mod                 35636  1
soundcore              26000  1 snd
i2c_core               45344  1 i2c_piix4
cdrom                  53416  1 sr_mod
ieee1394              122216  1 ohci1394
video                  43156  0
compat_ioctl32         25984  1 uvcvideo
asus_laptop            38492  0
output                 21248  1 video

===
Exhibit 3:

schlepptop:/home/amelie # dmesg | grep uvc
uvcvideo: Found UVC 1.00 device USB 2.0 Camera (174f:5a31)
usbcore: registered new interface driver uvcvideo
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
battery                33672  0
videodev               52096  2 uvcvideo,compat_ioctl32
ac                     24328  0
v4l1_compat            29444  2 uvcvideo,videodev
led_class              22920  1 asus_laptop
button                 27040  0
r8169                  51204  0
sg                     56912  0
usbhid                 65488  0
hid                    59296  1 usbhid
ff_memless             23176  1 usbhid
ehci_hcd               56204  0
ohci_hcd               42500  0
usbcore               188248  7 
uvcvideo,snd_usb_audio,snd_usb_lib,usbhid,ehci_hcd,ohci_hcd
sd_mod                 47280  6
edd                    28176  0
ext3                  170768  2
mbcache                27396  1 ext3
jbd                    82240  1 ext3
fan                    23944  0
ahci                   50696  5
pata_atiixp            25984  1
libata                194976  2 ahci,pata_atiixp
scsi_mod              194904  4 sr_mod,sg,sd_mod,libata
dock                   29344  1 libata
thermal                43040  0
processor              72668  2 powernow_k8,thermal

===
Exhibit 3:

schlepptop:/home/amelie # dmesg | grep uvc
uvcvideo: Found UVC 1.00 device USB 2.0 Camera (174f:5a31)
usbcore: registered new interface driver uvcvideo
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).

===
Exhibit 4:

luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 22.
 Init v4L2 failed !! exit fatal

===
Exhibit 5:

luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 5.
 Init v4L2 failed !! exit fatal


From svendem at gmail.com  Mon Nov  3 15:28:05 2008
From: svendem at gmail.com (Sven de Marothy)
Date: Mon, 3 Nov 2008 15:28:05 +0100
Subject: [Linux-uvc-devel] (Relative) Success with a Chicony CNF7045 cam
In-Reply-To: <94420310811030623x57be888cl72ef70f4f68d4fec@mail.gmail.com>
References: <94420310811030623x57be888cl72ef70f4f68d4fec@mail.gmail.com>
Message-ID: <94420310811030628y7f1ad785ye5ea6756837f2d5f@mail.gmail.com>

---------- Forwarded message ----------
From: Sven de Marothy <svendem at gmail.com>
Date: Mon, Nov 3, 2008 at 3:23 PM
Subject: (Relative) Success with a Chicony CNF7045 cam
To: linux-uvc-devel at lists.berlios.de


Hello uvc devs.
I'd just like to report the good news that the Chicony CNF7045 webcam (ID
04f2:b062) on my el-cheapo Packard-Bell laptop
works just fine with the current UVC driver.

Downside is, it doesn't actually work with any 'production' software out
there. :/
After some tinkering I figured out it's because it's a YUV cam, which it
doesn't seem anybody supports for whatever reason.
Once I'd figured that out, luvcview did work with the "-f yuv" option. (If I
may say so, it seems a bit lazy that it insists on hard-coded defaults
rather than doing a VIDIOC_G_FMT and first attempting to use the native
format.)

Would I be correct in thinking the fastest way to get more apps running with
this thing would be to fix Sane?

Anyway, I've attached the outputs from lsusb -v and v4l-info in case
anyone's interested on the details of this device.

/Sven
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081103/44eb8af4/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lsusb_output.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081103/44eb8af4/attachment.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: v4linfo_output.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081103/44eb8af4/attachment-0001.txt>

From laurent.pinchart at skynet.be  Mon Nov  3 15:51:14 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 3 Nov 2008 15:51:14 +0100
Subject: [Linux-uvc-devel] Genesys Logic 05e3:f192
In-Reply-To: <d73d7acb0811011348k490a2bd5q53450448c8734165@mail.gmail.com>
References: <d73d7acb0811011348k490a2bd5q53450448c8734165@mail.gmail.com>
Message-ID: <200811031551.14353.laurent.pinchart@skynet.be>

Hi,

On Saturday 01 November 2008, Jaroslaw Swierczynski wrote:
> Hello,
>
> I have this webcam, built into Asus S96S laptop and I'm trying to get
> it working. Googling I found a suggestion to edit uvc_driver.c and
> replace 0505 with f192. So I did and had also to change
> .bInterfaceClass and .bInterfaceSubClass to match modalias which is:
>
> usb:v05E3pF192d0103dc00dsc00dp00icFFisc00ip00
>
> Unfortunatelly that didn't do the trick. After loading the uvcvideo
> module dmesg showed:
>
> uvcvideo: Found UVC 0.00 device PC Camera4 (05e3:f192)
> uvcvideo: No valid video chain found.
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (SVN r262)
>
> No /dev/video0. Below is the output of "lsusb -v -d 05e3:f192". Please
> help.

[snip]

Your webcam is not UVC compliant, so it there's no chance of getting it 
supported by the Linux UVC driver.

For more information about UVC compliance, have a look at 
http://linux-uvc.berlios.de/faq/.

I'm personally not aware of any driver supporting your camera.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Nov  3 15:54:18 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 3 Nov 2008 15:54:18 +0100
Subject: [Linux-uvc-devel]
	=?iso-8859-1?q?Anyone_have_Adobe=27s_Flash_10_?=
	=?iso-8859-1?q?=28now_supports_V4L2=29_working_with_a=09UVC_cam=3F?=
In-Reply-To: <1225601597.13990.11.camel@ubuntu>
References: <1225601597.13990.11.camel@ubuntu>
Message-ID: <200811031554.18519.laurent.pinchart@skynet.be>

Hi Chris,

On Sunday 02 November 2008, Chris Hodgkins wrote:
> Adobe's Flash 10.0 r12 now appears to have V4L2 support.
>
> Out of curiosity I tried to use a Creative Live Cam Optia that works
> well with Ekiga, Cheese, Skype etc. with Yahoo's conferencing web
> service at http://live.yahoo.com
>
> It's close to working; My cam light comes on and I see myself for a
> brief second but then the cam goes off.

I personally got similar results but haven't tried to debug them yet.

> DMESG gives this: 
> [244583.228712] uvcvideo: device Live! Cam Optia requested null
> bandwidth, defaulting to lowest.

This is an informational message, nothing to worry about there.

> I'm wondering if this is an Adobe Flash SNAFU, or something more
> specific to my particular make of cam and its interaction with the uvc
> driver.

I would go for an Adobe Flash problem, although it's hard to be sure without 
access to the source code :-/

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Nov  3 16:42:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 3 Nov 2008 16:42:11 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811022355.20272.amy@ameliezapf.com>
References: <200811022355.20272.amy@ameliezapf.com>
Message-ID: <200811031642.11877.laurent.pinchart@skynet.be>

Hi Amelie,

On Sunday 02 November 2008, Amelie Zapf wrote:
> Dear list members,
>
> I have a new laptop with an included webcam that is identified by lsusb -v
> as [Exhibit 1]. As such it should be supported by the uvcvideo driver.
>
> I compiled and installed the driver. Everything went well, the driver loads
> OK. Output from lsmod is shown in [Exhibit 2]. A device /dev/video0 is
> created. However, upon trying to use the camera, errors occur as shown in
> [Exhibit 3], the output of dmesg | grep uvc.
>
> "Using the camera", as stated above, meant: using luvcview. Upon call of
> luvcview, [Exhibit 4] was received as error message, the logical next step
> of calling luvcview -f yuv returned the error message shown in [Exhibit 5].

As your camera supports YUV only, the '-f uvc' argument is required. The error 
message returned by luvcview in [Exhibit 4] is thus normal.

> I'd be grateful for anybody pointing me toward what I'm doing wrong. I'm
> frankly clueless.

I'm a bit puzzled as well. The camera has been listed as supported based on a 
user report I received on April the 27th, 2008. I haven't heard of any issue 
similar to the one you experienced.

Could you please try setting the quirks parameter to 4 when loading the 
uvcvideo driver ?

# modprobe uvcvideo quirks=4

If the driver is already loaded, make sure you unload it first.

# rmmod uvcvideo

Best regards,

Laurent Pinchart


From palmax at gmail.com  Mon Nov  3 17:28:16 2008
From: palmax at gmail.com (palmax at gmail.com)
Date: Mon, 3 Nov 2008 17:28:16 +0100
Subject: [Linux-uvc-devel] Rwd:  Webcam driver
Message-ID: <209499a0811030828g38b5d48ex65d1aeeb39f6f5ca@mail.gmail.com>

I am thinking about be a developer of your project for do my final
academic work. If you like that, you could bring me a TODO list with
some tasks that I can do as parallel as possible.

I will study all task of this TODO list with my mentor, because he has
to approve it. Like a final academic work, my time and resources are
limited.

Thank you for your collaboration
Palmax

2008/10/15  <palmax at gmail.com>:
> My project is for learning only of course. I don't know nothing about
> writting a linux driver, but I'm reading LDD 3rd edition.
>
> I want to have a list of unimplemented features in linux uvc driver,
> because it may be interesting for know the possibilities of "get" this
> knowledges.
>
> Bye
> Palmax
>
> 2008/10/15 Laurent Pinchart <laurent.pinchart at skynet.be>:
>> Hi,
>>
>> On Tuesday 14 October 2008, palmax at gmail.com wrote:
>>> Hello
>>>
>>> I want to do a webcam driver from scratch.
>>
>> Can I ask you why ? Do you have a webcam that is currently unsupported in
>> Linux, or is your project for learning purpose only ?
>>
>>> Your driver may be interesting in my "academy" intention because I know that
>>> a lot of cameras are compatible UVC (usb video class).
>>
>> Most new webcams are UVC compatible as Microsoft made it a requirement for the
>> Vista compatibility logo.
>>
>>> Can you tell me what is the most interesting "papers" for me?
>>
>> You can find a few documents about the Linux side of things at
>> http://www.linuxtv.org/docs.php. You will need to understand the V4L2 API.
>>
>> A good understanding of the Linux driver model will be required too. "Linux
>> Device Drivers", 3rd edition, is a good book and can be downloaded at
>> http://lwn.net/Kernel/LDD3/ (or better for the authors, bought from
>> O'Reilly).
>>
>> Regarding UVC itself, the specification can be downloaded from the USB
>> Implementers Forum at
>> http://www.usb.org/developers/devclass_docs/USB_Video_Class_1_1.zip. There's
>> not much other source of information (although the USB-IF forums could be
>> useful).
>>
>>> If I would enter in "UVC driver team", what will I do?
>>
>> That's up to you :-) If you write a UVC driver from scratch it will be a
>> separate project, unrelated to the current Linux UVC driver. If you want to
>> join the "team", pick up something you'd like to improve in the driver and
>> send a patch. I can provide a sample list of unimplemented features.
>>
>>> What will I need know knowledges?
>>
>> C programming (obviously) and Linux kernel development, although the later can
>> be learnt as you go.
>>
>> Best regards,
>>
>> Laurent Pinchart
>>
>


From swiergot at gmail.com  Mon Nov  3 18:20:28 2008
From: swiergot at gmail.com (Jaroslaw Swierczynski)
Date: Mon, 3 Nov 2008 18:20:28 +0100
Subject: [Linux-uvc-devel] Genesys Logic 05e3:f192
In-Reply-To: <200811031551.14353.laurent.pinchart@skynet.be>
References: <d73d7acb0811011348k490a2bd5q53450448c8734165@mail.gmail.com>
	<200811031551.14353.laurent.pinchart@skynet.be>
Message-ID: <d73d7acb0811030920v343d956ep2e7079d3ff4d2b61@mail.gmail.com>

Thanks. I was not aware of that FAQ page. Too bad it's not UVC
compliant but now at least it's clear as there were contradictory
statements on this.

Take care,
Jarek


From amy at ameliezapf.com  Mon Nov  3 21:05:48 2008
From: amy at ameliezapf.com (Amelie Zapf)
Date: Mon, 3 Nov 2008 21:05:48 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811031642.11877.laurent.pinchart@skynet.be>
References: <200811022355.20272.amy@ameliezapf.com>
	<200811031642.11877.laurent.pinchart@skynet.be>
Message-ID: <200811032105.49542.amy@ameliezapf.com>

Dear Laurent,

> As your camera supports YUV only, the '-f uvc' argument is required. The
> error message returned by luvcview in [Exhibit 4] is thus normal.

I assume you meant to say '-f yuv'. '-f uvc' delivers nothing better:

amelie at schlepptop:~> luvcview -f uvc
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 22.
 Init v4L2 failed !! exit fatal

> Could you please try setting the quirks parameter to 4 when loading the
> uvcvideo driver ?

This is weird. Upon rmmodding and re-modprobing the driver, the device 
file /dev/video0 is deleted and not recreated (why, I don't know). I tried 
modifying my /etc/modprobe.conf.local to:

install uvcvideo /sbin/modprobe snd_usb_audio; /sbin/modprobe --ignore-install 
uvcvideo quirks=4

and rebooting, but the error message persists:

amelie at schlepptop:~> luvcview -f uvc
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 22.
 Init v4L2 failed !! exit fatal

Sorry that I cannot bring better news, don't shoot the messenger :-)

Thanks for helping anyway,
kind regards,

Amy


From laurent.pinchart at skynet.be  Tue Nov  4 00:23:36 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 4 Nov 2008 00:23:36 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811032105.49542.amy@ameliezapf.com>
References: <200811022355.20272.amy@ameliezapf.com>
	<200811031642.11877.laurent.pinchart@skynet.be>
	<200811032105.49542.amy@ameliezapf.com>
Message-ID: <200811040023.36274.laurent.pinchart@skynet.be>

Hi Amelie,

On Monday 03 November 2008, Amelie Zapf wrote:
> Dear Laurent,
>
> > As your camera supports YUV only, the '-f uvc' argument is required. The
> > error message returned by luvcview in [Exhibit 4] is thus normal.
>
> I assume you meant to say '-f yuv'. '-f uvc' delivers nothing better:

Yes I meant '-f yuv'. Sorry, I need more sleep :-)

> amelie at schlepptop:~> luvcview -f uvc
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 22.
>  Init v4L2 failed !! exit fatal
>
> > Could you please try setting the quirks parameter to 4 when loading the
> > uvcvideo driver ?
>
> This is weird. Upon rmmodding and re-modprobing the driver, the device
> file /dev/video0 is deleted and not recreated (why, I don't know).

This is indeed weird. Could you check the kernel log (dmesg) when this happens 
to see if the driver prints any error message ?

> I tried modifying my /etc/modprobe.conf.local to:
>
> install uvcvideo /sbin/modprobe snd_usb_audio; /sbin/modprobe
> --ignore-install uvcvideo quirks=4
>
> and rebooting, but the error message persists:
>
> amelie at schlepptop:~> luvcview -f uvc
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 22.
>  Init v4L2 failed !! exit fatal

What about '-f yuv' ? :-)

> Sorry that I cannot bring better news, don't shoot the messenger :-)

Maybe the next try will be better. Fingers crossed.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov  4 00:30:02 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 4 Nov 2008 00:30:02 +0100
Subject: [Linux-uvc-devel] (Relative) Success with a Chicony CNF7045 cam
In-Reply-To: <94420310811030628y7f1ad785ye5ea6756837f2d5f@mail.gmail.com>
References: <94420310811030623x57be888cl72ef70f4f68d4fec@mail.gmail.com>
	<94420310811030628y7f1ad785ye5ea6756837f2d5f@mail.gmail.com>
Message-ID: <200811040030.02687.laurent.pinchart@skynet.be>

Hi Sven,

On Monday 03 November 2008, Sven de Marothy wrote:
> Hello uvc devs.
> I'd just like to report the good news that the Chicony CNF7045 webcam (ID
> 04f2:b062) on my el-cheapo Packard-Bell laptop
> works just fine with the current UVC driver.

Thanks for the report.

> Downside is, it doesn't actually work with any 'production' software out
> there. :/
> After some tinkering I figured out it's because it's a YUV cam, which it
> doesn't seem anybody supports for whatever reason.

The camera indeed supports YUV only, but that shouldn't prevent if from 
working with video software.

> Once I'd figured that out, luvcview did work with the "-f yuv" option. (If
> I may say so, it seems a bit lazy that it insists on hard-coded defaults
> rather than doing a VIDIOC_G_FMT and first attempting to use the native
> format.)

The latest luvcview version (available from the SVN repository at 
http://svn.quickcamteam.net/svn/luvcview/trunk/luvcview/) should be smarter 
and pick an appropriate format.

> Would I be correct in thinking the fastest way to get more apps running
> with this thing would be to fix Sane?

Sane, as in "scanner access now easy" ? I'm not sure to understand how that 
would affect other applications, as most video applications use the V4L2 API 
directly.

Could you elaborate on the production software that doesn't work with the 
camera ? At least Ekiga should work properly.

> Anyway, I've attached the outputs from lsusb -v and v4l-info in case
> anyone's interested on the details of this device.

Thanks for the data. I collect USB devices descriptors so I'm actually 
interested.

Best regars,

Laurent Pinchart


From amy at ameliezapf.com  Tue Nov  4 01:13:19 2008
From: amy at ameliezapf.com (Amelie Zapf)
Date: Tue, 4 Nov 2008 01:13:19 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811040023.36274.laurent.pinchart@skynet.be>
References: <200811022355.20272.amy@ameliezapf.com>
	<200811032105.49542.amy@ameliezapf.com>
	<200811040023.36274.laurent.pinchart@skynet.be>
Message-ID: <200811040113.19655.amy@ameliezapf.com>

Dear Laurent,

> > This is weird. Upon rmmodding and re-modprobing the driver, the device
> > file /dev/video0 is deleted and not recreated (why, I don't know).
>
> This is indeed weird. Could you check the kernel log (dmesg) when this
> happens to see if the driver prints any error message ?

Here's the whole shebang:

schlepptop:/home/amelie # lsmod | grep uvc
uvcvideo               75912  0
compat_ioctl32         25984  1 uvcvideo
videodev               52096  2 uvcvideo,compat_ioctl32
v4l1_compat            29444  2 uvcvideo,videodev
usbcore               188248  7 
uvcvideo,snd_usb_audio,snd_usb_lib,usbhid,ehci_hcd,ohci_hcd
schlepptop:/home/amelie # rmmod uvcvideo
schlepptop:/home/amelie # lsmod | grep uvc
schlepptop:/home/amelie # modprobe uvcvideo
schlepptop:/home/amelie # lsmod | grep uvc
uvcvideo               75912  0
compat_ioctl32         25984  1 uvcvideo
videodev               52096  2 uvcvideo,compat_ioctl32
v4l1_compat            29444  2 uvcvideo,videodev
usbcore               188248  7 
uvcvideo,snd_usb_audio,snd_usb_lib,usbhid,ehci_hcd,ohci_hcd
schlepptop:/home/amelie # dmesg
[...]
uvcvideo: Found UVC 1.00 device USB 2.0 Camera (174f:5a31)
uvcvideo: Forcing device quirks 0x4 by module parameter for testing purpose.
uvcvideo: Please report required quirks to the linux-uvc-devel mailing list.
[...]
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
[...]
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
usbcore: deregistering interface driver uvcvideo
uvcvideo: Found UVC 1.00 device USB 2.0 Camera (174f:5a31)
uvcvideo: Forcing device quirks 0x4 by module parameter for testing purpose.
uvcvideo: Please report required quirks to the linux-uvc-devel mailing list.
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r200)
schlepptop:/home/amelie # ls /dev/video*
ls: Zugriff auf /dev/video* nicht m?glich: Datei oder Verzeichnis nicht 
gefunden

> What about '-f yuv' ? :-)

No better, I'm afraid:

amelie at schlepptop:~> luvcview -f yuv
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 5.
 Init v4L2 failed !! exit fatal

Hope this helps,
thanks for all the support,

Amy


-- 
Amelie Zapf (amy at ameliezapf.com)
Jazz Pianist, Bassist, Composer, Weichselstr. 17, 12045 Berlin, Germany
Don't forget to check out http://www.ameliezapf.com/

"When the power of love overcomes the love of power, the world will know 
peace." - Jimi Hendrix


From chris at slavesoftware.co.uk  Tue Nov  4 02:45:43 2008
From: chris at slavesoftware.co.uk (Chris Hodgkins)
Date: Tue, 04 Nov 2008 01:45:43 +0000
Subject: [Linux-uvc-devel] Anyone have Adobe's Flash 10 (now
	supports	V4L2) working with a	UVC cam?
In-Reply-To: <200811031554.18519.laurent.pinchart@skynet.be>
References: <1225601597.13990.11.camel@ubuntu>
	<200811031554.18519.laurent.pinchart@skynet.be>
Message-ID: <1225763143.13990.36.camel@ubuntu>

Hi Laurent,

Thanks for the confirmation that you are seeing the same.

I've since been fishing on Adobe's web forums; looks like initial
reports of this went into Adobe back in July when Flash10 was still in
beta. Unfortunately they haven't as far as I can see passed any public
comment, grr.

cheers

Chris.

On Mon, 2008-11-03 at 15:54 +0100, Laurent Pinchart wrote:
> Hi Chris,
> 
> On Sunday 02 November 2008, Chris Hodgkins wrote:
> > Adobe's Flash 10.0 r12 now appears to have V4L2 support.
> >
> > Out of curiosity I tried to use a Creative Live Cam Optia that works
> > well with Ekiga, Cheese, Skype etc. with Yahoo's conferencing web
> > service at http://live.yahoo.com
> >
> > It's close to working; My cam light comes on and I see myself for a
> > brief second but then the cam goes off.
> 
> I personally got similar results but haven't tried to debug them yet.
> 
> > DMESG gives this: 
> > [244583.228712] uvcvideo: device Live! Cam Optia requested null
> > bandwidth, defaulting to lowest.
> 
> This is an informational message, nothing to worry about there.
> 
> > I'm wondering if this is an Adobe Flash SNAFU, or something more
> > specific to my particular make of cam and its interaction with the uvc
> > driver.
> 
> I would go for an Adobe Flash problem, although it's hard to be sure without 
> access to the source code :-/
> 
> Best regards,
> 
> Laurent Pinchart



From palo at bielyvlk.sk  Tue Nov  4 11:31:22 2008
From: palo at bielyvlk.sk (Pavel Revak)
Date: Tue, 4 Nov 2008 11:31:22 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
Message-ID: <200811041131.23108.palo@bielyvlk.sk>

Hi in my SONY VAIO TZ laptop is camera with chipset r5u870 and USB ID: 05ca:183a
For this camera I use firmware and loader from project: http://www.bitbucket.org/ahixon/r5u87x/ which use UVCVIDEO.
camera is working, but not in skype. The problem is that I see with overlapped image, because camera is 640x480 and skype request image with resolution 320x240
and UVCVIDEO bad resample the image, where is only right top and left top quadrates overlaped to one.
if I look on video through mplayer (this request image in original size 640x480), image is OK, but only on kernel version 2.6.26.
after kernel upgrade to 2.6.27 I need specify -fps, because I get the error message: "FPS not specified in the header or invalid, use the -fps option."
exist any solution for this problem? this camera is in skype unusable.
thanks for any help


From philipp at kolmann.at  Tue Nov  4 13:50:01 2008
From: philipp at kolmann.at (Philipp Kolmann)
Date: Tue, 04 Nov 2008 13:50:01 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <200811041131.23108.palo@bielyvlk.sk>
References: <200811041131.23108.palo@bielyvlk.sk>
Message-ID: <491044F9.3070106@kolmann.at>

Pavel Revak wrote:
> Hi in my SONY VAIO TZ laptop is camera with chipset r5u870 and USB ID: 05ca:183a
> For this camera I use firmware and loader from project: http://www.bitbucket.org/ahixon/r5u87x/ which use UVCVIDEO.
> camera is working, but not in skype. The problem is that I see with overlapped image, because camera is 640x480 and skype request image with resolution 320x240
> and UVCVIDEO bad resample the image, where is only right top and left top quadrates overlaped to one.
> if I look on video through mplayer (this request image in original size 640x480), image is OK, but only on kernel version 2.6.26.
> after kernel upgrade to 2.6.27 I need specify -fps, because I get the error message: "FPS not specified in the header or invalid, use the -fps option."
> exist any solution for this problem? this camera is in skype unusable.
>
>   
To get HQ Video in Skype, follow my Instructions from the Skype forum:

http://forum.skype.com/index.php?s=&showtopic=152201&view=findpost&p=838421


Hth
Philipp


From palo at bielyvlk.sk  Tue Nov  4 14:18:45 2008
From: palo at bielyvlk.sk (Pavel Revak)
Date: Tue, 4 Nov 2008 14:18:45 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <491044F9.3070106@kolmann.at>
References: <200811041131.23108.palo@bielyvlk.sk> <491044F9.3070106@kolmann.at>
Message-ID: <200811041418.46098.palo@bielyvlk.sk>

Hi Philipp
very nice, this solved my problem :)
thanks.

also I do some tests with luvcview and any other grabbed resolution than 640x480 is broken ... is here possible to disable, these resolutions for this camera or make software image resize ?

luvcview reports the following resolutions:
$ lucview -L
luvcview 0.2.4
SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/15,
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/15,
{ discrete: width = 176, height = 144 }
        Time interval between frame: 1/15,
{ discrete: width = 160, height = 120 }
        Time interval between frame: 1/15,

thanks.

On Tuesday 04 November 2008 13:50:01 Philipp Kolmann wrote:
> To get HQ Video in Skype, follow my Instructions from the Skype forum:
> 
> http://forum.skype.com/index.php?s=&showtopic=152201&view=findpost&p=838421


From andrewfenn at gmail.com  Wed Nov  5 13:09:10 2008
From: andrewfenn at gmail.com (Andrew Fenn)
Date: Wed, 5 Nov 2008 12:09:10 +0000
Subject: [Linux-uvc-devel] Any plans to support Logitech Quickcam Messenger?
Message-ID: <b594ca9d0811050409v6c789905rba6c02d1a9b6d70@mail.gmail.com>

Hi,

I was wondering if you have any plans of supporting the QuickCam
Messenger ( 046d:08f0 Logitech, Inc. ) as it isn't in your list of
supported devices.

There is a Linux driver ( http://home.mag.cx/messenger/ ) however
there seem to always be problems including it in distributions such as
Ubuntu ( https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.15/+bug/22070
).

Is there any reason this can not be supported in UVC? (camera too old, etc)

Thanks,
Andrew


From palmax at gmail.com  Wed Nov  5 20:49:32 2008
From: palmax at gmail.com (palmax at gmail.com)
Date: Wed, 5 Nov 2008 20:49:32 +0100
Subject: [Linux-uvc-devel] Rwd:  Webcam driver
In-Reply-To: <209499a0811030828g38b5d48ex65d1aeeb39f6f5ca@mail.gmail.com>
References: <209499a0811030828g38b5d48ex65d1aeeb39f6f5ca@mail.gmail.com>
Message-ID: <209499a0811051149w6420846bib57a44615d477b97@mail.gmail.com>

Hello

I don't know if you have a lot of work or my mail didn't send good.
For this reason, I preffer to resend it.

Thank you
Palmax

2008/11/3  <palmax at gmail.com>:
> I am thinking about be a developer of your project for do my final
> academic work. If you like that, you could bring me a TODO list with
> some tasks that I can do as parallel as possible.
>
> I will study all task of this TODO list with my mentor, because he has
> to approve it. Like a final academic work, my time and resources are
> limited.
>
> Thank you for your collaboration
> Palmax
>
> 2008/10/15  <palmax at gmail.com>:
>> My project is for learning only of course. I don't know nothing about
>> writting a linux driver, but I'm reading LDD 3rd edition.
>>
>> I want to have a list of unimplemented features in linux uvc driver,
>> because it may be interesting for know the possibilities of "get" this
>> knowledges.
>>
>> Bye
>> Palmax
>>
>> 2008/10/15 Laurent Pinchart <laurent.pinchart at skynet.be>:
>>> Hi,
>>>
>>> On Tuesday 14 October 2008, palmax at gmail.com wrote:
>>>> Hello
>>>>
>>>> I want to do a webcam driver from scratch.
>>>
>>> Can I ask you why ? Do you have a webcam that is currently unsupported in
>>> Linux, or is your project for learning purpose only ?
>>>
>>>> Your driver may be interesting in my "academy" intention because I know that
>>>> a lot of cameras are compatible UVC (usb video class).
>>>
>>> Most new webcams are UVC compatible as Microsoft made it a requirement for the
>>> Vista compatibility logo.
>>>
>>>> Can you tell me what is the most interesting "papers" for me?
>>>
>>> You can find a few documents about the Linux side of things at
>>> http://www.linuxtv.org/docs.php. You will need to understand the V4L2 API.
>>>
>>> A good understanding of the Linux driver model will be required too. "Linux
>>> Device Drivers", 3rd edition, is a good book and can be downloaded at
>>> http://lwn.net/Kernel/LDD3/ (or better for the authors, bought from
>>> O'Reilly).
>>>
>>> Regarding UVC itself, the specification can be downloaded from the USB
>>> Implementers Forum at
>>> http://www.usb.org/developers/devclass_docs/USB_Video_Class_1_1.zip. There's
>>> not much other source of information (although the USB-IF forums could be
>>> useful).
>>>
>>>> If I would enter in "UVC driver team", what will I do?
>>>
>>> That's up to you :-) If you write a UVC driver from scratch it will be a
>>> separate project, unrelated to the current Linux UVC driver. If you want to
>>> join the "team", pick up something you'd like to improve in the driver and
>>> send a patch. I can provide a sample list of unimplemented features.
>>>
>>>> What will I need know knowledges?
>>>
>>> C programming (obviously) and Linux kernel development, although the later can
>>> be learnt as you go.
>>>
>>> Best regards,
>>>
>>> Laurent Pinchart
>>>
>>
>


From laurent.pinchart at skynet.be  Thu Nov  6 00:58:53 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 6 Nov 2008 00:58:53 +0100
Subject: [Linux-uvc-devel] Rwd:  Webcam driver
In-Reply-To: <209499a0811030828g38b5d48ex65d1aeeb39f6f5ca@mail.gmail.com>
References: <209499a0811030828g38b5d48ex65d1aeeb39f6f5ca@mail.gmail.com>
Message-ID: <200811060058.53270.laurent.pinchart@skynet.be>

Hi Palmax,

On Monday 03 November 2008, palmax at gmail.com wrote:
> I am thinking about be a developer of your project for do my final
> academic work. If you like that, you could bring me a TODO list with
> some tasks that I can do as parallel as possible.
>
> I will study all task of this TODO list with my mentor, because he has
> to approve it. Like a final academic work, my time and resources are
> limited.

I've sent you a todo list on October the 15th as a reply in this mail thread. 
You can find it in the mailing list archive.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov  6 01:13:16 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 6 Nov 2008 01:13:16 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811040113.19655.amy@ameliezapf.com>
References: <200811022355.20272.amy@ameliezapf.com>
	<200811040023.36274.laurent.pinchart@skynet.be>
	<200811040113.19655.amy@ameliezapf.com>
Message-ID: <200811060113.16981.laurent.pinchart@skynet.be>

Hi Amelie,

On Tuesday 04 November 2008, Amelie Zapf wrote:
> Dear Laurent,
>
> > > This is weird. Upon rmmodding and re-modprobing the driver, the device
> > > file /dev/video0 is deleted and not recreated (why, I don't know).
> >
> > This is indeed weird. Could you check the kernel log (dmesg) when this
> > happens to see if the driver prints any error message ?
>
> Here's the whole shebang:
>
> schlepptop:/home/amelie # lsmod | grep uvc
> uvcvideo               75912  0
> compat_ioctl32         25984  1 uvcvideo
> videodev               52096  2 uvcvideo,compat_ioctl32
> v4l1_compat            29444  2 uvcvideo,videodev
> usbcore               188248  7
> uvcvideo,snd_usb_audio,snd_usb_lib,usbhid,ehci_hcd,ohci_hcd
> schlepptop:/home/amelie # rmmod uvcvideo
> schlepptop:/home/amelie # lsmod | grep uvc
> schlepptop:/home/amelie # modprobe uvcvideo
> schlepptop:/home/amelie # lsmod | grep uvc
> uvcvideo               75912  0
> compat_ioctl32         25984  1 uvcvideo
> videodev               52096  2 uvcvideo,compat_ioctl32
> v4l1_compat            29444  2 uvcvideo,videodev
> usbcore               188248  7
> uvcvideo,snd_usb_audio,snd_usb_lib,usbhid,ehci_hcd,ohci_hcd
> schlepptop:/home/amelie # dmesg
> [...]
> uvcvideo: Found UVC 1.00 device USB 2.0 Camera (174f:5a31)
> uvcvideo: Forcing device quirks 0x4 by module parameter for testing
> purpose. uvcvideo: Please report required quirks to the linux-uvc-devel
> mailing list. [...]
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> [...]
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> usbcore: deregistering interface driver uvcvideo
> uvcvideo: Found UVC 1.00 device USB 2.0 Camera (174f:5a31)
> uvcvideo: Forcing device quirks 0x4 by module parameter for testing
> purpose. uvcvideo: Please report required quirks to the linux-uvc-devel
> mailing list. uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110
> (exp. 26). uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110
> (exp. 26). uvcvideo: Failed to initialize the device (-5).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (SVN r200)
> schlepptop:/home/amelie # ls /dev/video*
> ls: Zugriff auf /dev/video* nicht m?glich: Datei oder Verzeichnis nicht
> gefunden
>
> > What about '-f yuv' ? :-)
>
> No better, I'm afraid:
>
> amelie at schlepptop:~> luvcview -f yuv
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 5.
>  Init v4L2 failed !! exit fatal
>
> Hope this helps,

No really unfortunately :-( From what you report the camera seems to 
completely crash.

All error messages report a -110 error, which indicates a timeout 
(-ETIMEDOUT). Timeouts are usually caused by firmware errors, as bad requests 
should be answered with an error and not ignored by the device.

When loaded, the driver queries the video probe control (control 1, unit 0) 
for it's default value (GET_DEF, 135) or, if this fails, for its current 
value (GET_CUR, 129). As you can see in the log, no such error is reported 
the first time the driver is loaded.

When an application sets the video format the driver will set (SET_CUR, 1) the 
video probe control value. The driver reports timeouts, which means that 
either the first SET_CUR request or the request right before made the device 
crash. This can be confirmed by the module unloading and reloading, as the 
device then fails to respond to the initial GET_DEF and GET_CUR.

My guess would be that the SET_CUR request makes the device crash. This could 
be caused by unexpected values (from the device's point of view) in the 
request data. If you have access to a Windows box, it would be interesting to 
try the camera there and, if it works properly, capture a USB trace.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov  6 01:17:42 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 6 Nov 2008 01:17:42 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <200811041418.46098.palo@bielyvlk.sk>
References: <200811041131.23108.palo@bielyvlk.sk> <491044F9.3070106@kolmann.at>
	<200811041418.46098.palo@bielyvlk.sk>
Message-ID: <200811060117.43019.laurent.pinchart@skynet.be>

On Tuesday 04 November 2008, Pavel Revak wrote:
> Hi Philipp
> very nice, this solved my problem :)
> thanks.
>
> also I do some tests with luvcview and any other grabbed resolution than
> 640x480 is broken ...

How broken ? Can you post screenshots ?

As a side note, make sure you check the kernel log (dmesg) for uvcvideo error 
messages when performing your tests.

> is here possible to disable, these resolutions for this camera

The resolutions are reported by the camera itself. The UVC driver merely pass 
the data to userspace without any modification.

> or make software image resize ? 

The driver doesn't resize or process the image in any way. This kind of 
function belongs to userspace.

> luvcview reports the following resolutions:
> $ lucview -L
> luvcview 0.2.4
> SDL information:
>   Video driver: x11
>   A window manager is available
> Device information:
>   Device path:  /dev/video0
> /dev/video0 does not support read i/o
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
>         Time interval between frame: 1/15,
> { discrete: width = 320, height = 240 }
>         Time interval between frame: 1/15,
> { discrete: width = 176, height = 144 }
>         Time interval between frame: 1/15,
> { discrete: width = 160, height = 120 }
>         Time interval between frame: 1/15,

Please note that the r5u870 chipset is not completely UVC compliant and is 
currently not officially supported by the UVC driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov  6 01:19:27 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 6 Nov 2008 01:19:27 +0100
Subject: [Linux-uvc-devel] Any plans to support Logitech Quickcam
	Messenger?
In-Reply-To: <b594ca9d0811050409v6c789905rba6c02d1a9b6d70@mail.gmail.com>
References: <b594ca9d0811050409v6c789905rba6c02d1a9b6d70@mail.gmail.com>
Message-ID: <200811060119.27699.laurent.pinchart@skynet.be>

Hi Andrew,

On Wednesday 05 November 2008, Andrew Fenn wrote:
> Hi,
>
> I was wondering if you have any plans of supporting the QuickCam
> Messenger ( 046d:08f0 Logitech, Inc. ) as it isn't in your list of
> supported devices.

No I don't.

> There is a Linux driver ( http://home.mag.cx/messenger/ ) however
> there seem to always be problems including it in distributions such as
> Ubuntu (
> https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.15/+bug/22070 ).
>
> Is there any reason this can not be supported in UVC? (camera too old, etc)

The camera is not UVC compliant, and the scope of the Linux UVC driver is 
limited to supporting UVC devices. For devices using another (proprietary) 
protocol you will need another driver.

Best regards,

Laurent Pinchart


From michael.the.drummer at gmail.com  Thu Nov  6 13:59:22 2008
From: michael.the.drummer at gmail.com (Michael)
Date: Thu, 6 Nov 2008 23:29:22 +1030
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
Message-ID: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>

Hey

I'm trying to use video4linux2 to control a Logitech QuickCam Pro 9000. The
camera supports UVC and I can get the image just fine. However, I'm having
issues with the controls.

Luvcview reports the following controls:

V4L2_CID_BASE         (predefined controls):
 index:9963776    name:Brightness                       type:1 min:0
max:255   step:1     def:128   now:128
 index:9963777    name:Contrast                         type:1 min:0
max:255   step:1     def:32    now:32
 index:9963778    name:Saturation                       type:1 min:0
max:255   step:1     def:32    now:32
 index:9963788    name:White Balance Temperature, Auto  type:2 min:0
max:1     step:1     def:1     now:1
 index:9963795    name:Gain                             type:1 min:0
max:255   step:1     def:0     now:0


There are no driver specific controls. The problem is that there are some
missing. There should also be Auto Exposure on/off, manual exposure,
autofocus on/off and manual focus.

The strange thing is that luvcview will let me turn off auto exposure
(strangely by pressing the on button), and will also let me set the exposure
manually.

I would like to know if there is a way to access these controls using
video4linux?

Cheers
Michael

-- 
http://www.nicedrums.net
The forum for drummers
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081106/6b7ecdfe/attachment.html>

From fargiolas at gnome.org  Fri Nov  7 10:14:26 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Fri, 7 Nov 2008 10:14:26 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
Message-ID: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>

Hi,
I'm a Cheese developer, recently many users (mainly from ubuntu
intrepid) reported us several issues with uvcvideo drivers.
Actually they reported many issues with the other webcam drivers too,
probably related to the changes in webcam drivers with 2.27 kernels
(gspca v2, uvcvideo included into mainline, strange formats decoding
moved to userspace, apps switching to libv4l..). Probably some
regression went in too with so much changes, but I'm just guessing.

This particular issue with uvcvideo seems to happen both with cheese
and gstreamer alone, some ioctl call locks the webcam making it
unusable anymore without reloading the module.
I'm personally experiencing the issue only if use my microdia (I don't
have access to my laptop now, will provide the exact id later) webcam
at the maximum supported resolution (1280x1024) , it works just fine
with the other ones.
But as soon as I try to access it with
gst-launch-0.10 v4l2src ! video/x-raw-yuv, width=1280, height=1024 ! xvimagesink
the light turns off and the webcam is no more usable.

Other users reported slightly different behaviours but all end up with
a webcam lock. You can find more info at the correspondent bugzilla
and launchpad bugs:

https://bugs.launchpad.net/bugs/290506
http://bugzilla.gnome.org/show_bug.cgi?id=559057

It seems the driver works fine with other software so maybe it is a
gstreamer only issue but other drivers work nicely so I think it's
still a driver issue.
Could you give me some little help to better triage this thing and fix
it in the right place?

Thanks
Filippo

-- 
Filippo Argiolas
Jabber: filippo.argiolas at jabber.no
Web: http://fargiolas.netsons.org
Irc: fargiolas (GimpNET, Freenode)


From tom at dbservice.com  Fri Nov  7 09:49:46 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Fri, 07 Nov 2008 09:49:46 +0100
Subject: [Linux-uvc-devel] Capturing still images vs. video
Message-ID: <4914012A.1050006@dbservice.com>

I'm looking at a webcam that can do 960x720 at 30fps and also can capture 
still images at 1600x1200. 960x720 is a little low for our project, 
1600x1200 would be much better. We also don't need 30 fps, it is enough 
if the camera can capture at 5-7 fps. Is it reasonable to expect the 
camera to capture still images at that framerate? The webcam in question 
is 'QuickCam Pro for Notebooks' from Logitech. I've seen the 2007 Model 
is well supported by the uvc driver.

thanks
tom



From barsnick at gmx.net  Sat Nov  8 23:00:57 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Sat, 8 Nov 2008 23:00:57 +0100
Subject: [Linux-uvc-devel] Capturing still images vs. video
In-Reply-To: <4914012A.1050006@dbservice.com>
References: <4914012A.1050006@dbservice.com>
Message-ID: <20081108220057.GA30140@sunshine.barsnick.net>

Hi Tomas,

On Fri, Nov 07, 2008 at 09:49:46 +0100, Tomas Carnecky wrote:
> I'm looking at a webcam that can do 960x720 at 30fps and also can capture 
> still images at 1600x1200. 960x720 is a little low for our project, 
> 1600x1200 would be much better. We also don't need 30 fps, it is enough 
> if the camera can capture at 5-7 fps. Is it reasonable to expect the 
> camera to capture still images at that framerate?

The linux-uvc driver doesn't actually support still image capture. It
only supports the stream mode, at whatever frame rates the hardware
provides.  (The difference shouldn't matter in your case though.)

luvcview and guvcview will show you the detected rates and resolutions
with the flag "-L".

> The webcam in question is 'QuickCam Pro for Notebooks' from Logitech. 
> I've seen the 2007 Model is well supported by the uvc driver.

Check out this (official Logitech) page and the linked Excel (:-P)
files:
http://www.quickcamteam.net/hcl/frame-format-matrix

And indeed, you're lucky, your camera is listed with 5 fps at
1600x1200.

Hope this helps,
Moritz


From laurent.pinchart at skynet.be  Sun Nov  9 13:55:04 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 9 Nov 2008 13:55:04 +0100
Subject: [Linux-uvc-devel] [PATCH] Video/UVC: Fix unaligned exceptions
	in uvc video driver.
In-Reply-To: <1225963052-6657-1-git-send-email-cooloney@kernel.org>
References: <1225963052-6657-1-git-send-email-cooloney@kernel.org>
Message-ID: <200811091355.05074.laurent.pinchart@skynet.be>

Hi Bryan, Michael,

Thanks for the patch.

On Thursday 06 November 2008, Bryan Wu wrote:
> From: Michael Hennerich <michael.hennerich at analog.com>
>
> buffer can be odd aligned on some NOMMU machine such as Blackfin

The comment is a bit misleading. Buffers can be odd-aligned independently off 
the machine type. The issue comes from machines that can't access unaligned 
memory. Something like "Fix access to unaligned memory" would be better.

> Signed-off-by: Michael Hennerich <michael.hennerich at analog.com>
> Signed-off-by: Bryan Wu <cooloney at kernel.org>
> ---
>  drivers/media/video/uvc/uvc_driver.c |   37
> +++++++++++++++++---------------- 1 files changed, 19 insertions(+), 18
> deletions(-)
>
> diff --git a/drivers/media/video/uvc/uvc_driver.c
> b/drivers/media/video/uvc/uvc_driver.c index d7ad060..9b4f469 100644
> --- a/drivers/media/video/uvc/uvc_driver.c
> +++ b/drivers/media/video/uvc/uvc_driver.c
> @@ -31,6 +31,7 @@
>  #include <linux/videodev2.h>
>  #include <linux/vmalloc.h>
>  #include <linux/wait.h>
> +#include <asm/unaligned.h>
>  #include <asm/atomic.h>
>
>  #include <media/v4l2-common.h>
> @@ -432,20 +433,20 @@ static int uvc_parse_format(struct uvc_device *dev,
>
>  		frame->bFrameIndex = buffer[3];
>  		frame->bmCapabilities = buffer[4];
> -		frame->wWidth = le16_to_cpup((__le16 *)&buffer[5]);
> -		frame->wHeight = le16_to_cpup((__le16 *)&buffer[7]);
> -		frame->dwMinBitRate = le32_to_cpup((__le32 *)&buffer[9]);
> -		frame->dwMaxBitRate = le32_to_cpup((__le32 *)&buffer[13]);
> +		frame->wWidth = le16_to_cpu(get_unaligned((__le16 *) &buffer[5]));

What about using get_unaligned_le16 and get_unaligned_le32 directly ? Lines 
would be shorter and could be kept behind the 80 columns limit more easily.

Tell me if you want to resubmit or if I should make the modification myself 
(including the patch description).

> +		frame->wHeight = le16_to_cpu(get_unaligned((__le16 *) &buffer[7]));
> +		frame->dwMinBitRate = le32_to_cpu(get_unaligned((__le32 *) &buffer[9]));
> +		frame->dwMaxBitRate = le32_to_cpu(get_unaligned((__le32 *)
> &buffer[13])); if (ftype != VS_FRAME_FRAME_BASED) {
>  			frame->dwMaxVideoFrameBufferSize =
> -				le32_to_cpup((__le32 *)&buffer[17]);
> +				le32_to_cpu(get_unaligned((__le32 *) &buffer[17]));
>  			frame->dwDefaultFrameInterval =
> -				le32_to_cpup((__le32 *)&buffer[21]);
> +				le32_to_cpu(get_unaligned((__le32 *) &buffer[21]));
>  			frame->bFrameIntervalType = buffer[25];
>  		} else {
>  			frame->dwMaxVideoFrameBufferSize = 0;
>  			frame->dwDefaultFrameInterval =
> -				le32_to_cpup((__le32 *)&buffer[17]);
> +				le32_to_cpu(get_unaligned((__le32 *) &buffer[17]));
>  			frame->bFrameIntervalType = buffer[21];
>  		}
>  		frame->dwFrameInterval = *intervals;
> @@ -468,7 +469,7 @@ static int uvc_parse_format(struct uvc_device *dev,
>  		 * some other divisions by zero which could happen.
>  		 */
>  		for (i = 0; i < n; ++i) {
> -			interval = le32_to_cpup((__le32 *)&buffer[26+4*i]);
> +			interval = le32_to_cpu(get_unaligned((__le32 *) &buffer[26+4*i]));
>  			*(*intervals)++ = interval ? interval : 1;
>  		}
>
> @@ -814,7 +815,7 @@ static int uvc_parse_vendor_control(struct uvc_device
> *dev, memcpy(unit->extension.guidExtensionCode, &buffer[4], 16);
>  		unit->extension.bNumControls = buffer[20];
>  		unit->extension.bNrInPins =
> -			le16_to_cpup((__le16 *)&buffer[21]);
> +			le16_to_cpu(get_unaligned((__le16 *) &buffer[21]));
>  		unit->extension.baSourceID = (__u8 *)unit + sizeof *unit;
>  		memcpy(unit->extension.baSourceID, &buffer[22], p);
>  		unit->extension.bControlSize = buffer[22+p];
> @@ -858,8 +859,8 @@ static int uvc_parse_standard_control(struct uvc_device
> *dev, return -EINVAL;
>  		}
>
> -		dev->uvc_version = le16_to_cpup((__le16 *)&buffer[3]);
> -		dev->clock_frequency = le32_to_cpup((__le32 *)&buffer[7]);
> +		dev->uvc_version = le16_to_cpu(get_unaligned((__le16 *) &buffer[3]));
> +		dev->clock_frequency = le32_to_cpu(get_unaligned((__le32 *)
> &buffer[7]));
>
>  		/* Parse all USB Video Streaming interfaces. */
>  		for (i = 0; i < n; ++i) {
> @@ -886,7 +887,7 @@ static int uvc_parse_standard_control(struct uvc_device
> *dev, /* Make sure the terminal type MSB is not null, otherwise it
>  		 * could be confused with a unit.
>  		 */
> -		type = le16_to_cpup((__le16 *)&buffer[4]);
> +		type = le16_to_cpu(get_unaligned((__le16 *) &buffer[4]));
>  		if ((type & 0xff00) == 0) {
>  			uvc_trace(UVC_TRACE_DESCR, "device %d videocontrol "
>  				"interface %d INPUT_TERMINAL %d has invalid "
> @@ -928,11 +929,11 @@ static int uvc_parse_standard_control(struct
> uvc_device *dev, term->camera.bControlSize = n;
>  			term->camera.bmControls = (__u8 *)term + sizeof *term;
>  			term->camera.wObjectiveFocalLengthMin =
> -				le16_to_cpup((__le16 *)&buffer[8]);
> +				le16_to_cpu(get_unaligned((__le16 *) &buffer[8]));
>  			term->camera.wObjectiveFocalLengthMax =
> -				le16_to_cpup((__le16 *)&buffer[10]);
> +				le16_to_cpu(get_unaligned((__le16 *) &buffer[10]));
>  			term->camera.wOcularFocalLength =
> -				le16_to_cpup((__le16 *)&buffer[12]);
> +				le16_to_cpu(get_unaligned((__le16 *) &buffer[12]));
>  			memcpy(term->camera.bmControls, &buffer[15], n);
>  		} else if (UVC_ENTITY_TYPE(term) == ITT_MEDIA_TRANSPORT_INPUT) {
>  			term->media.bControlSize = n;
> @@ -968,7 +969,7 @@ static int uvc_parse_standard_control(struct uvc_device
> *dev, /* Make sure the terminal type MSB is not null, otherwise it
>  		 * could be confused with a unit.
>  		 */
> -		type = le16_to_cpup((__le16 *)&buffer[4]);
> +		type = le16_to_cpu(get_unaligned((__le16 *) &buffer[4]));
>  		if ((type & 0xff00) == 0) {
>  			uvc_trace(UVC_TRACE_DESCR, "device %d videocontrol "
>  				"interface %d OUTPUT_TERMINAL %d has invalid "
> @@ -1042,7 +1043,7 @@ static int uvc_parse_standard_control(struct
> uvc_device *dev, unit->type = buffer[2];
>  		unit->processing.bSourceID = buffer[4];
>  		unit->processing.wMaxMultiplier =
> -			le16_to_cpup((__le16 *)&buffer[5]);
> +			le16_to_cpu(get_unaligned((__le16 *) &buffer[5]));
>  		unit->processing.bControlSize = buffer[7];
>  		unit->processing.bmControls = (__u8 *)unit + sizeof *unit;
>  		memcpy(unit->processing.bmControls, &buffer[8], n);
> @@ -1078,7 +1079,7 @@ static int uvc_parse_standard_control(struct
> uvc_device *dev, memcpy(unit->extension.guidExtensionCode, &buffer[4], 16);
>  		unit->extension.bNumControls = buffer[20];
>  		unit->extension.bNrInPins =
> -			le16_to_cpup((__le16 *)&buffer[21]);
> +			le16_to_cpu(get_unaligned((__le16 *) &buffer[21]));
>  		unit->extension.baSourceID = (__u8 *)unit + sizeof *unit;
>  		memcpy(unit->extension.baSourceID, &buffer[22], p);
>  		unit->extension.bControlSize = buffer[22+p];

Cheers,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Nov  9 13:58:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 9 Nov 2008 13:58:11 +0100
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
Message-ID: <200811091358.11152.laurent.pinchart@skynet.be>

Hi Michael,

On Thursday 06 November 2008, Michael wrote:
> Hey
>
> I'm trying to use video4linux2 to control a Logitech QuickCam Pro 9000. The
> camera supports UVC and I can get the image just fine. However, I'm having
> issues with the controls.
>
> Luvcview reports the following controls:
>
> V4L2_CID_BASE         (predefined controls):
>  index:9963776    name:Brightness                       type:1 min:0
> max:255   step:1     def:128   now:128
>  index:9963777    name:Contrast                         type:1 min:0
> max:255   step:1     def:32    now:32
>  index:9963778    name:Saturation                       type:1 min:0
> max:255   step:1     def:32    now:32
>  index:9963788    name:White Balance Temperature, Auto  type:2 min:0
> max:1     step:1     def:1     now:1
>  index:9963795    name:Gain                             type:1 min:0
> max:255   step:1     def:0     now:0
>
>
> There are no driver specific controls. The problem is that there are some
> missing. There should also be Auto Exposure on/off, manual exposure,
> autofocus on/off and manual focus.
>
> The strange thing is that luvcview will let me turn off auto exposure
> (strangely by pressing the on button), and will also let me set the
> exposure manually.
>
> I would like to know if there is a way to access these controls using
> video4linux?

Yes there is. luvcview uses an old control enumeration method that results in 
controls being missed. It should instead use the V4L2_CTRL_FLAG_NEXT_CTRL 
flag as explained in the V4L2 specification.

Regardless of enumeration issues, controls can be accessed through 
VIDIOC_G_CTRL and VIDIOC_S_CTRL.

Best regards,

Laurent Pinchart


From pihhan at cipis.net  Sun Nov  9 14:15:16 2008
From: pihhan at cipis.net (Petr =?UTF-8?Q?Men=C5=A1=C3=ADk?=)
Date: Sun, 09 Nov 2008 14:15:16 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <200811060117.43019.laurent.pinchart@skynet.be>
References: <200811041131.23108.palo@bielyvlk.sk>
	<491044F9.3070106@kolmann.at> <200811041418.46098.palo@bielyvlk.sk>
	<200811060117.43019.laurent.pinchart@skynet.be>
Message-ID: <1226236516.21482.24.camel@mentalek>

I think i can reply here also, as i have 05ca:183b that is very similar.
It is integrated in Sony Vaio VGN-FZ21 series.

I made some tests at http://www.pihhan.info/sony/webcam/webcam-tests
There are also scripts i used and lsusb verbose output for camera.

Laurent Pinchart p??e v ?t 06. 11. 2008 v 01:17 +0100:
> On Tuesday 04 November 2008, Pavel Revak wrote:
> > Hi Philipp
> > very nice, this solved my problem :)
> > thanks.
> >
> > also I do some tests with luvcview and any other grabbed resolution than
> > 640x480 is broken ...
> 
> How broken ? Can you post screenshots ?
See http://www.pihhan.info/sony/webcam/webcam-tests/160/00000012.png as
example. After simpel transformation of buffer to width 640, you will se
camera never changed its resolution. Only software thinks it did. See
http://www.pihhan.info/sony/webcam/webcam-tests/160/00000012-mod.png to
get upper part of original image.
> 
> As a side note, make sure you check the kernel log (dmesg) for uvcvideo error 
> messages when performing your tests.
No errors in kernel for my model. I made some debug info with controls
and stuff using:
options uvcvideo trace=0x307

Output is at http://www.pihhan.info/sony/webcam/uvcload.txt
it is somehow bigger to paste it into mail i think. Only strange warning is

Nov  9 14:02:17 mentalek kernel: [23909.937596] uvcvideo: Control 0x00980909 not found.

It does so when i play it using mplayer tv:///, i dont know what does that mean.
> 
> > is here possible to disable, these resolutions for this camera
> 
> The resolutions are reported by the camera itself. The UVC driver merely pass 
> the data to userspace without any modification.
They are reported but not working. R5u870 driver seems to be not
developed now, as work is put to upload firmware and then handle camera
using uvcvideo.
> 
> > or make software image resize ? 
> 
> The driver doesn't resize or process the image in any way. This kind of 
> function belongs to userspace.
> 
> > luvcview reports the following resolutions:
> > $ lucview -L
> > luvcview 0.2.4
> > SDL information:
> >   Video driver: x11
> >   A window manager is available
> > Device information:
> >   Device path:  /dev/video0
> > /dev/video0 does not support read i/o
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 640, height = 480 }
> >         Time interval between frame: 1/15,
> > { discrete: width = 320, height = 240 }
> >         Time interval between frame: 1/15,
> > { discrete: width = 176, height = 144 }
> >         Time interval between frame: 1/15,
> > { discrete: width = 160, height = 120 }
> >         Time interval between frame: 1/15,
> 
My output:
luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/30, 
{ discrete: width = 1280, height = 1024 }
	Time interval between frame: 2/15, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/30, 
{ discrete: width = 176, height = 144 }
	Time interval between frame: 1/30, 
{ discrete: width = 160, height = 120 }
	Time interval between frame: 1/30, 

Where can i get newer version? i found this most recent one at
http://mxhaard.free.fr/spca50x/Investigation/uvc/ but i have older
version it seems. Also, my luvcview will not show anything to me, it
fails with:

luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
Unable to set format: 22.
 Init v4L2 failed !! exit fatal 

Do you where it could fail or how could i fix this? I tried different
formats and sizes, but i never saw image from luvcview.

Mplayer tv:/// will work (1.0rc2-4.2.3), as is cheese 2.22.3. xawtv will
choose wrong resolution and i dont know how to change it. It worked with
r5u870 driver. But Mplayer has somehow strange colors, image from cheese
is better in quality. 

> Please note that the r5u870 chipset is not completely UVC compliant and is 
> currently not officially supported by the UVC driver.
Do you know about anything exactly that this camera does not support as
it should? I would like to get it working with uvcvideo module and i may
try to create patch, but i dont understand well how is resolution
switching done in UVC video module. Would it be fixed with some custom
quirk for example? iSight has some special, why not this?
> 
> Best regards,
> 
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



From amy at ameliezapf.com  Sun Nov  9 14:17:00 2008
From: amy at ameliezapf.com (Amelie Zapf)
Date: Sun, 9 Nov 2008 14:17:00 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811060113.16981.laurent.pinchart@skynet.be>
References: <200811022355.20272.amy@ameliezapf.com>
	<200811040113.19655.amy@ameliezapf.com>
	<200811060113.16981.laurent.pinchart@skynet.be>
Message-ID: <200811091417.00593.amy@ameliezapf.com>

Dear Laurent,

> My guess would be that the SET_CUR request makes the device crash. This
> could be caused by unexpected values (from the device's point of view) in
> the request data. If you have access to a Windows box, it would be
> interesting to try the camera there and, if it works properly, capture a
> USB trace.

My configuration is as follows: Camera is firmly installed into a notebook 
computer, this means, I can't unplug/replug, there is no cable. The notebook 
computer is dual-boot, Open Suse 11.0 as default and Windows Vista (actually, 
for one single application).

Now I've installed a 14-day trial version of a USB trace program. How do I go 
about to capture the trace in this case?

Regards,

Amy

-- 
Amelie Zapf (amy at ameliezapf.com)
Jazz Pianist, Bassist, Composer, Weichselstr. 17, 12045 Berlin, Germany
Don't forget to check out http://www.ameliezapf.com/

"When the power of love overcomes the love of power, the world will know 
peace." - Jimi Hendrix


From michael.the.drummer at gmail.com  Sun Nov  9 14:44:46 2008
From: michael.the.drummer at gmail.com (Michael)
Date: Mon, 10 Nov 2008 00:14:46 +1030
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <200811091358.11152.laurent.pinchart@skynet.be>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
	<200811091358.11152.laurent.pinchart@skynet.be>
Message-ID: <58b40ca10811090544q6957e288g252847c6005d9e45@mail.gmail.com>

On Sun, Nov 9, 2008 at 11:28 PM, Laurent Pinchart <
laurent.pinchart at skynet.be> wrote:

> Hi Michael,
>
> On Thursday 06 November 2008, Michael wrote:
> > Hey
> >
> > I'm trying to use video4linux2 to control a Logitech QuickCam Pro 9000.
> The
> > camera supports UVC and I can get the image just fine. However, I'm
> having
> > issues with the controls.
> >
> > Luvcview reports the following controls:
> >
> > V4L2_CID_BASE         (predefined controls):
> >  index:9963776    name:Brightness                       type:1 min:0
> > max:255   step:1     def:128   now:128
> >  index:9963777    name:Contrast                         type:1 min:0
> > max:255   step:1     def:32    now:32
> >  index:9963778    name:Saturation                       type:1 min:0
> > max:255   step:1     def:32    now:32
> >  index:9963788    name:White Balance Temperature, Auto  type:2 min:0
> > max:1     step:1     def:1     now:1
> >  index:9963795    name:Gain                             type:1 min:0
> > max:255   step:1     def:0     now:0
> >
> >
> > There are no driver specific controls. The problem is that there are some
> > missing. There should also be Auto Exposure on/off, manual exposure,
> > autofocus on/off and manual focus.
> >
> > The strange thing is that luvcview will let me turn off auto exposure
> > (strangely by pressing the on button), and will also let me set the
> > exposure manually.
> >
> > I would like to know if there is a way to access these controls using
> > video4linux?
>
> Yes there is. luvcview uses an old control enumeration method that results
> in
> controls being missed. It should instead use the V4L2_CTRL_FLAG_NEXT_CTRL
> flag as explained in the V4L2 specification.
>
> Regardless of enumeration issues, controls can be accessed through
> VIDIOC_G_CTRL and VIDIOC_S_CTRL.
>
> Best regards,
>
> Laurent Pinchart


Hi Laurent

Thanks for that. After looking through the code, I am enumerating the
controls in the same way luvcview does. I was just following a code example
from the V4L2 api documentation (perhaps I was looking at an old version of
the docs).

Anyway I'll have a look at the V4L2_CTRL_FLAG_NEXT_CTRL tomorrow.

Cheers
Michael
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081110/bf48e88a/attachment.html>

From laurent.pinchart at skynet.be  Sun Nov  9 22:22:17 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 9 Nov 2008 22:22:17 +0100
Subject: [Linux-uvc-devel] [PATCH] Video/UVC: Port mainlined uvc video
	driver to NOMMU
In-Reply-To: <1225963130-6784-1-git-send-email-cooloney@kernel.org>
References: <1225963130-6784-1-git-send-email-cooloney@kernel.org>
Message-ID: <200811092222.18047.laurent.pinchart@skynet.be>

Hi Bryan, Michael,

On Thursday 06 November 2008, Bryan Wu wrote:
> From: Michael Hennerich <michael.hennerich at analog.com>
>
> Add NOMMU mmap support.
>
> Signed-off-by: Michael Hennerich <michael.hennerich at analog.com>
> Signed-off-by: Bryan Wu <cooloney at kernel.org>
> ---
>  drivers/media/video/uvc/uvc_v4l2.c |   14 ++++++++++++++
>  1 files changed, 14 insertions(+), 0 deletions(-)
>
> diff --git a/drivers/media/video/uvc/uvc_v4l2.c
> b/drivers/media/video/uvc/uvc_v4l2.c index 758dfef..2237f5e 100644
> --- a/drivers/media/video/uvc/uvc_v4l2.c
> +++ b/drivers/media/video/uvc/uvc_v4l2.c
> @@ -1050,6 +1050,7 @@ static int uvc_v4l2_mmap(struct file *file, struct
> vm_area_struct *vma) break;
>  	}
>
> +#ifdef CONFIG_MMU
>  	if (i == video->queue.count || size != video->queue.buf_size) {
>  		ret = -EINVAL;
>  		goto done;
> @@ -1071,7 +1072,20 @@ static int uvc_v4l2_mmap(struct file *file, struct
> vm_area_struct *vma) addr += PAGE_SIZE;
>  		size -= PAGE_SIZE;
>  	}
> +#else
> +	if (i == video->queue.count ||
> +		PAGE_ALIGN(size) != video->queue.buf_size) {

Just out of curiosity, why do you need to PAGE_ALIGN size for non-MMU 
platforms ?

> +		ret = -EINVAL;
> +		goto done;
> +	}
> +
> +	vma->vm_flags |= VM_IO | VM_MAYSHARE; /* documentation/nommu-mmap.txt */

VM_MAYSHARE is not documented anywhere in Documentation/ in Linux 2.6.28-rc3. 
Why is it needed for non-MMU architectures only ?

> +
> +	addr = (unsigned long)video->queue.mem + buffer->buf.m.offset;
>
> +	vma->vm_start = addr;
> +	vma->vm_end = addr +  video->queue.buf_size;
> +#endif
>  	vma->vm_ops = &uvc_vm_ops;
>  	vma->vm_private_data = buffer;
>  	uvc_vm_open(vma);

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Nov  9 23:00:17 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 9 Nov 2008 23:00:17 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <1226236516.21482.24.camel@mentalek>
References: <200811041131.23108.palo@bielyvlk.sk>
	<200811060117.43019.laurent.pinchart@skynet.be>
	<1226236516.21482.24.camel@mentalek>
Message-ID: <200811092300.18076.laurent.pinchart@skynet.be>

Hi Petr, hi Pavel,

On Sunday 09 November 2008, Petr Men??k wrote:
> I think i can reply here also, as i have 05ca:183b that is very similar.
> It is integrated in Sony Vaio VGN-FZ21 series.
>
> I made some tests at http://www.pihhan.info/sony/webcam/webcam-tests
> There are also scripts i used and lsusb verbose output for camera.
>
> Laurent Pinchart p??e v ?t 06. 11. 2008 v 01:17 +0100:
> > On Tuesday 04 November 2008, Pavel Revak wrote:
> > > Hi Philipp
> > > very nice, this solved my problem :)
> > > thanks.
> > >
> > > also I do some tests with luvcview and any other grabbed resolution
> > > than 640x480 is broken ...
> >
> > How broken ? Can you post screenshots ?
>
> See http://www.pihhan.info/sony/webcam/webcam-tests/160/00000012.png as
> example. After simpel transformation of buffer to width 640, you will se
> camera never changed its resolution. Only software thinks it did. See
> http://www.pihhan.info/sony/webcam/webcam-tests/160/00000012-mod.png to
> get upper part of original image.

Thanks for the analysis. I agree with your conclusion, the camera hasn't 
changed its capture resolution.

> > As a side note, make sure you check the kernel log (dmesg) for uvcvideo
> > error messages when performing your tests.
>
> No errors in kernel for my model. I made some debug info with controls
> and stuff using:
> options uvcvideo trace=0x307
>
> Output is at http://www.pihhan.info/sony/webcam/uvcload.txt
> it is somehow bigger to paste it into mail i think. Only strange warning is
>
> Nov  9 14:02:17 mentalek kernel: [23909.937596] uvcvideo: Control
> 0x00980909 not found.
>
> It does so when i play it using mplayer tv:///, i dont know what does that
> mean.

Nothing to worry about. 0x00980909 is V4L2_CID_AUDIO_MUTE and is not supported 
by UVC devices.

> > > is here possible to disable, these resolutions for this camera
> >
> > The resolutions are reported by the camera itself. The UVC driver merely
> > pass the data to userspace without any modification.
>
> They are reported but not working. R5u870 driver seems to be not
> developed now, as work is put to upload firmware and then handle camera
> using uvcvideo.

Did resolutions other than 640x480 ever worked with the r5u870 driver ?

> > > or make software image resize ?
> >
> > The driver doesn't resize or process the image in any way. This kind of
> > function belongs to userspace.
> >
> > > luvcview reports the following resolutions:
> > > $ lucview -L
> > > luvcview 0.2.4
> > > SDL information:
> > >   Video driver: x11
> > >   A window manager is available
> > > Device information:
> > >   Device path:  /dev/video0
> > > /dev/video0 does not support read i/o
> > > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > > { discrete: width = 640, height = 480 }
> > >         Time interval between frame: 1/15,
> > > { discrete: width = 320, height = 240 }
> > >         Time interval between frame: 1/15,
> > > { discrete: width = 176, height = 144 }
> > >         Time interval between frame: 1/15,
> > > { discrete: width = 160, height = 120 }
> > >         Time interval between frame: 1/15,
>
> My output:
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> /dev/video0 does not support read i/o
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
> 	Time interval between frame: 1/30,
> { discrete: width = 1280, height = 1024 }
> 	Time interval between frame: 2/15,
> { discrete: width = 320, height = 240 }
> 	Time interval between frame: 1/30,
> { discrete: width = 176, height = 144 }
> 	Time interval between frame: 1/30,
> { discrete: width = 160, height = 120 }
> 	Time interval between frame: 1/30,
>
> Where can i get newer version? i found this most recent one at
> http://mxhaard.free.fr/spca50x/Investigation/uvc/ but i have older
> version it seems.

You can grab the latest version from the quickcamteam.net SVN repository at 
http://svn.quickcamteam.net/svn/luvcview/

> Also, my luvcview will not show anything to me, it fails with:
>
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 22.
>  Init v4L2 failed !! exit fatal
>
> Do you where it could fail or how could i fix this? I tried different
> formats and sizes, but i never saw image from luvcview.

luvcview (at least its old versions) defaulted to MJPEG even if the camera 
doesn't support that format. You can force YUYV with

luvcview -f yuv

> Mplayer tv:/// will work (1.0rc2-4.2.3), as is cheese 2.22.3. xawtv will
> choose wrong resolution and i dont know how to change it. It worked with
> r5u870 driver.

What resolution did xawtv pick with the r5u870 driver ?

> But Mplayer has somehow strange colors, image from cheese is better in
> quality.

That might be caused by default control values chosen by mplayer and cheese, 
especially the hue control.

> > Please note that the r5u870 chipset is not completely UVC compliant and
> > is currently not officially supported by the UVC driver.
>
> Do you know about anything exactly that this camera does not support as
> it should?

There are a number of UVC non compliance issues with the r5u870 chipset:

- The chipset advertises UVC descriptors when no firmware is loaded. It won't 
re-enumerate or change its descriptors after firmware loading. This makes 
initialisation quite difficult.

- Some proprietary controls supported by the camera are not advertised in its 
descriptors and are only accessible through a proprietary protocol. The UVC 
driver has no way to access those controls.

- As you reported, resolutions other than 640x480 seem to be broken. More 
investigation is probably required.

> I would like to get it working with uvcvideo module and i may 
> try to create patch, but i dont understand well how is resolution
> switching done in UVC video module. Would it be fixed with some custom
> quirk for example? iSight has some special, why not this?

The uvcvideo driver supports some non-standard cameras using device-specific 
quirks. The iSight is the worst example of such devices. Still, it only 
overrides very specific portion of the driver's logic. Supporting r5u870 
chipsets in the uvcvideo driver would require introducing hooks pretty much 
all over the place and I'm not happy with that. r5u870-based cameras are far 
from being UVC compliant, and for the time being they are better served by a 
separate driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Nov  9 23:05:43 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 9 Nov 2008 23:05:43 +0100
Subject: [Linux-uvc-devel] Capturing still images vs. video
In-Reply-To: <20081108220057.GA30140@sunshine.barsnick.net>
References: <4914012A.1050006@dbservice.com>
	<20081108220057.GA30140@sunshine.barsnick.net>
Message-ID: <200811092305.43450.laurent.pinchart@skynet.be>

Hi Moritz, hi Tomas,

On Saturday 08 November 2008, Moritz Barsnick wrote:
> Hi Tomas,
>
> On Fri, Nov 07, 2008 at 09:49:46 +0100, Tomas Carnecky wrote:
> > I'm looking at a webcam that can do 960x720 at 30fps and also can capture
> > still images at 1600x1200. 960x720 is a little low for our project,
> > 1600x1200 would be much better. We also don't need 30 fps, it is enough
> > if the camera can capture at 5-7 fps. Is it reasonable to expect the
> > camera to capture still images at that framerate?
>
> The linux-uvc driver doesn't actually support still image capture. It
> only supports the stream mode, at whatever frame rates the hardware
> provides.  (The difference shouldn't matter in your case though.)

That's right. Support for still image capture is planned (well, it's at least 
on my TODO list) but the V4L2 API doesn't provide a still image capture API 
yet, so I'll have to sort that out first.

> luvcview and guvcview will show you the detected rates and resolutions
> with the flag "-L".
>
> > The webcam in question is 'QuickCam Pro for Notebooks' from Logitech.
> > I've seen the 2007 Model is well supported by the uvc driver.
>
> Check out this (official Logitech) page and the linked Excel (:-P)
> files:
> http://www.quickcamteam.net/hcl/frame-format-matrix
>
> And indeed, you're lucky, your camera is listed with 5 fps at
> 1600x1200.

Luckily there's a workaround, so I'll have some more time to implement still 
image capture in the driver :-) As a side note, I don't think you can expect 
5fps when capturing still images.

Best regards,

Laurent Pinchart


From tom at dbservice.com  Mon Nov 10 00:02:36 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Mon, 10 Nov 2008 00:02:36 +0100
Subject: [Linux-uvc-devel] Capturing still images vs. video
In-Reply-To: <200811092305.43450.laurent.pinchart@skynet.be>
References: <4914012A.1050006@dbservice.com>
	<20081108220057.GA30140@sunshine.barsnick.net>
	<200811092305.43450.laurent.pinchart@skynet.be>
Message-ID: <49176C0C.4080809@dbservice.com>

On 11/09/2008 11:05 PM, Laurent Pinchart wrote:
> Hi Moritz, hi Tomas,
>
> On Saturday 08 November 2008, Moritz Barsnick wrote:
>>> The webcam in question is 'QuickCam Pro for Notebooks' from Logitech.
>>> I've seen the 2007 Model is well supported by the uvc driver.
>> Check out this (official Logitech) page and the linked Excel (:-P)
>> files:
>> http://www.quickcamteam.net/hcl/frame-format-matrix
>>
>> And indeed, you're lucky, your camera is listed with 5 fps at
>> 1600x1200.
>
> Luckily there's a workaround, so I'll have some more time to implement still
> image capture in the driver :-) As a side note, I don't think you can expect
> 5fps when capturing still images.

Even if the vendor says so in the documentation?

tom



From pihhan at cipis.net  Mon Nov 10 00:47:14 2008
From: pihhan at cipis.net (Petr =?UTF-8?Q?Men=C5=A1=C3=ADk?=)
Date: Mon, 10 Nov 2008 00:47:14 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <200811092300.18076.laurent.pinchart@skynet.be>
References: <200811041131.23108.palo@bielyvlk.sk>
	<200811060117.43019.laurent.pinchart@skynet.be>
	<1226236516.21482.24.camel@mentalek>
	<200811092300.18076.laurent.pinchart@skynet.be>
Message-ID: <1226274434.21482.47.camel@mentalek>

hi,

i found interesting news. my camera will change its resolution, but only
to 640x480 and 1280x1024 correctly. I was astonished when high
resolution worked, i did not expect that. I got working svn version of
luvcview, but really lower resolutions are still wrong in that also.

Yes, lower resolutions worked fine in ekiga before, i believe it is
using lowest one, 160x120. Really firmware loading is a bit problem, as
you have to reload module if you did not load before usb subsystem.
Camera cannot be unpluged, because is built-in.

What is for input layer for webcamera by the way? I have one pretty old
Genius GE111 with button on it, yet driver did not support button when i
tested it (and i doubt it will ever do, as image quality from camera is
very low).

It might be useful to direct owners of r5u870 to web page about it, tell
them it needs firmware and maybe refuse to handle them without special
parameters. Maybe print some warning at least for usb vendor id for
these cameras. 

Oh and i forget to note interesting feature. In mplayer, it started to
show anything always after 10th frame on lower resolutions. There is
black first ten frames when resolution is lower than 640x480.

When i see usage of UVC standard for my camera, is that reliable to buy
some camera claiming to support standard? Is it unusual having camera
like mine, working only after firmware loading? I hoped that with
adoption of uvc webcams will be finally plug&play without messing with
strage drivers from strange place. Is it again more about marketing than
engineering?

Best Regards,

Petr

Laurent Pinchart p??e v Ne 09. 11. 2008 v 23:00 +0100:
> Hi Petr, hi Pavel,
> 
> On Sunday 09 November 2008, Petr Men??k wrote:
> > I think i can reply here also, as i have 05ca:183b that is very similar.
> > It is integrated in Sony Vaio VGN-FZ21 series.
> >
> > I made some tests at http://www.pihhan.info/sony/webcam/webcam-tests
> > There are also scripts i used and lsusb verbose output for camera.
> >
> > Laurent Pinchart p??e v ?t 06. 11. 2008 v 01:17 +0100:
> > > On Tuesday 04 November 2008, Pavel Revak wrote:
> > > > Hi Philipp
> > > > very nice, this solved my problem :)
> > > > thanks.
> > > >
> > > > also I do some tests with luvcview and any other grabbed resolution
> > > > than 640x480 is broken ...
> > >
> > > How broken ? Can you post screenshots ?
> >
> > See http://www.pihhan.info/sony/webcam/webcam-tests/160/00000012.png as
> > example. After simpel transformation of buffer to width 640, you will se
> > camera never changed its resolution. Only software thinks it did. See
> > http://www.pihhan.info/sony/webcam/webcam-tests/160/00000012-mod.png to
> > get upper part of original image.
> 
> Thanks for the analysis. I agree with your conclusion, the camera hasn't 
> changed its capture resolution.
> 
> > > As a side note, make sure you check the kernel log (dmesg) for uvcvideo
> > > error messages when performing your tests.
> >
> > No errors in kernel for my model. I made some debug info with controls
> > and stuff using:
> > options uvcvideo trace=0x307
> >
> > Output is at http://www.pihhan.info/sony/webcam/uvcload.txt
> > it is somehow bigger to paste it into mail i think. Only strange warning is
> >
> > Nov  9 14:02:17 mentalek kernel: [23909.937596] uvcvideo: Control
> > 0x00980909 not found.
> >
> > It does so when i play it using mplayer tv:///, i dont know what does that
> > mean.
> 
> Nothing to worry about. 0x00980909 is V4L2_CID_AUDIO_MUTE and is not supported 
> by UVC devices.
> 
> > > > is here possible to disable, these resolutions for this camera
> > >
> > > The resolutions are reported by the camera itself. The UVC driver merely
> > > pass the data to userspace without any modification.
> >
> > They are reported but not working. R5u870 driver seems to be not
> > developed now, as work is put to upload firmware and then handle camera
> > using uvcvideo.
> 
> Did resolutions other than 640x480 ever worked with the r5u870 driver ?
> 
> > > > or make software image resize ?
> > >
> > > The driver doesn't resize or process the image in any way. This kind of
> > > function belongs to userspace.
> > >
> > > > luvcview reports the following resolutions:
> > > > $ lucview -L
> > > > luvcview 0.2.4
> > > > SDL information:
> > > >   Video driver: x11
> > > >   A window manager is available
> > > > Device information:
> > > >   Device path:  /dev/video0
> > > > /dev/video0 does not support read i/o
> > > > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > > > { discrete: width = 640, height = 480 }
> > > >         Time interval between frame: 1/15,
> > > > { discrete: width = 320, height = 240 }
> > > >         Time interval between frame: 1/15,
> > > > { discrete: width = 176, height = 144 }
> > > >         Time interval between frame: 1/15,
> > > > { discrete: width = 160, height = 120 }
> > > >         Time interval between frame: 1/15,
> >
> > My output:
> > luvcview version 0.2.1
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> > /dev/video0 does not support read i/o
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 640, height = 480 }
> > 	Time interval between frame: 1/30,
> > { discrete: width = 1280, height = 1024 }
> > 	Time interval between frame: 2/15,
> > { discrete: width = 320, height = 240 }
> > 	Time interval between frame: 1/30,
> > { discrete: width = 176, height = 144 }
> > 	Time interval between frame: 1/30,
> > { discrete: width = 160, height = 120 }
> > 	Time interval between frame: 1/30,
> >
> > Where can i get newer version? i found this most recent one at
> > http://mxhaard.free.fr/spca50x/Investigation/uvc/ but i have older
> > version it seems.
> 
> You can grab the latest version from the quickcamteam.net SVN repository at 
> http://svn.quickcamteam.net/svn/luvcview/
> 
> > Also, my luvcview will not show anything to me, it fails with:
> >
> > luvcview version 0.2.1
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> > Unable to set format: 22.
> >  Init v4L2 failed !! exit fatal
> >
> > Do you where it could fail or how could i fix this? I tried different
> > formats and sizes, but i never saw image from luvcview.
> 
> luvcview (at least its old versions) defaulted to MJPEG even if the camera 
> doesn't support that format. You can force YUYV with
> 
> luvcview -f yuv
> 
> > Mplayer tv:/// will work (1.0rc2-4.2.3), as is cheese 2.22.3. xawtv will
> > choose wrong resolution and i dont know how to change it. It worked with
> > r5u870 driver.
> 
> What resolution did xawtv pick with the r5u870 driver ?
> 
> > But Mplayer has somehow strange colors, image from cheese is better in
> > quality.
> 
> That might be caused by default control values chosen by mplayer and cheese, 
> especially the hue control.
> 
> > > Please note that the r5u870 chipset is not completely UVC compliant and
> > > is currently not officially supported by the UVC driver.
> >
> > Do you know about anything exactly that this camera does not support as
> > it should?
> 
> There are a number of UVC non compliance issues with the r5u870 chipset:
> 
> - The chipset advertises UVC descriptors when no firmware is loaded. It won't 
> re-enumerate or change its descriptors after firmware loading. This makes 
> initialisation quite difficult.
> 
> - Some proprietary controls supported by the camera are not advertised in its 
> descriptors and are only accessible through a proprietary protocol. The UVC 
> driver has no way to access those controls.
> 
> - As you reported, resolutions other than 640x480 seem to be broken. More 
> investigation is probably required.
> 
> > I would like to get it working with uvcvideo module and i may 
> > try to create patch, but i dont understand well how is resolution
> > switching done in UVC video module. Would it be fixed with some custom
> > quirk for example? iSight has some special, why not this?
> 
> The uvcvideo driver supports some non-standard cameras using device-specific 
> quirks. The iSight is the worst example of such devices. Still, it only 
> overrides very specific portion of the driver's logic. Supporting r5u870 
> chipsets in the uvcvideo driver would require introducing hooks pretty much 
> all over the place and I'm not happy with that. r5u870-based cameras are far 
> from being UVC compliant, and for the time being they are better served by a 
> separate driver.
> 
> Best regards,
> 
> Laurent Pinchart



From palmax at gmail.com  Tue Nov 11 15:49:25 2008
From: palmax at gmail.com (palmax at gmail.com)
Date: Tue, 11 Nov 2008 15:49:25 +0100
Subject: [Linux-uvc-devel] [linux-uvc] Still Image
Message-ID: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>

Dear Laurent and other developers of linux-uvc:

I was talking with my mentor. We are interesting in:
? Still Image capture: method 2 and method 3, but we don't know which
camera can use method 3.
? Clock: I can see an example in documentation of UVC 1.1 (Class and
FAQ)  with clock reference, but it's only a unique (and duplicated)
example with stream payload.
? UVC stub: My mentor is thinking about have a software UVC (like
mac80211 for wifi devices) that show you usb trams. It can be
interesting for learning and for debugging.

Can you help us?

Thank you for your help
Palmax

From laurent.pinchart at skynet.be  Tue Nov 11 18:11:34 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 11 Nov 2008 18:11:34 +0100
Subject: [Linux-uvc-devel] [PATCH] Video/UVC: Fix unaligned exceptions
	in uvc video driver.
In-Reply-To: <8A42379416420646B9BFAC9682273B6D065BA534@limkexm3.ad.analog.com>
References: <1225963052-6657-1-git-send-email-cooloney@kernel.org>
	<200811091355.05074.laurent.pinchart@skynet.be>
	<8A42379416420646B9BFAC9682273B6D065BA534@limkexm3.ad.analog.com>
Message-ID: <200811111811.35098.laurent.pinchart@skynet.be>

On Monday 10 November 2008, Hennerich, Michael wrote:
> > -----Original Message-----
> > From: Laurent Pinchart [mailto:laurent.pinchart at skynet.be]
> > Sent: Sunday, November 09, 2008 1:55 PM
> > To: Bryan Wu
> > Cc: linux-uvc-devel at lists.berlios.de; video4linux-list at redhat.com;
> > linux-kernel at vger.kernel.org; Michael Hennerich
> > Subject: Re: [PATCH] Video/UVC: Fix unaligned exceptions in uvc video
> > driver.
> >
> > Hi Bryan, Michael,
> >
> > Thanks for the patch.
> >
> > On Thursday 06 November 2008, Bryan Wu wrote:
> > > From: Michael Hennerich <michael.hennerich at analog.com>
> > >
> > > buffer can be odd aligned on some NOMMU machine such as Blackfin
> >
> > The comment is a bit misleading. Buffers can be odd-aligned independently
> > off the machine type. The issue comes from machines that can't access
> > unaligned memory. Something like "Fix access to unaligned memory" would be
> > better.
[snip]

> > What about using get_unaligned_le16 and get_unaligned_le32 directly ?
> > Lines would be shorter and could be kept behind the 80 columns limit more
> > easily.
> > Tell me if you want to resubmit or if I should make the modification
> > myself (including the patch description).
>
> Laurent,
>
> Well - I just used the same style already used in various other places
> in the uvc driver. - Just wanted to be consistent.

No worries. get_unaligned_le{16|32} has been introduced in the kernel recently 
and I haven't updated the uvcvideo driver like I should have. I'll fix that.

> If you don't mind doing the changes (including the patch description),
> please go ahead.

Ok I'll fix and submit the patch.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 11 18:31:54 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 11 Nov 2008 18:31:54 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
Message-ID: <200811111831.54185.laurent.pinchart@skynet.be>

Hi Filippo,

On Friday 07 November 2008, Filippo Argiolas wrote:
> Hi,
> I'm a Cheese developer, recently many users (mainly from ubuntu
> intrepid) reported us several issues with uvcvideo drivers.
> Actually they reported many issues with the other webcam drivers too,
> probably related to the changes in webcam drivers with 2.27 kernels
> (gspca v2, uvcvideo included into mainline, strange formats decoding
> moved to userspace, apps switching to libv4l..). Probably some
> regression went in too with so much changes, but I'm just guessing.
>
> This particular issue with uvcvideo seems to happen both with cheese
> and gstreamer alone, some ioctl call locks the webcam making it
> unusable anymore without reloading the module.
> I'm personally experiencing the issue only if use my microdia (I don't
> have access to my laptop now, will provide the exact id later) webcam
> at the maximum supported resolution (1280x1024) , it works just fine
> with the other ones.
> But as soon as I try to access it with
> gst-launch-0.10 v4l2src ! video/x-raw-yuv, width=1280, height=1024 !
> xvimagesink the light turns off and the webcam is no more usable.
>
> Other users reported slightly different behaviours but all end up with
> a webcam lock. You can find more info at the correspondent bugzilla
> and launchpad bugs:
>
> https://bugs.launchpad.net/bugs/290506
> http://bugzilla.gnome.org/show_bug.cgi?id=559057
>
> It seems the driver works fine with other software so maybe it is a
> gstreamer only issue but other drivers work nicely so I think it's
> still a driver issue.
> Could you give me some little help to better triage this thing and fix
> it in the right place?

Could you please check the kernel log (dmesg) for error messages printed by 
the uvcvideo driver after locking the camera/driver ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 11 19:26:29 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 11 Nov 2008 19:26:29 +0100
Subject: [Linux-uvc-devel] Problem with 174f:5a31
In-Reply-To: <200811091417.00593.amy@ameliezapf.com>
References: <200811022355.20272.amy@ameliezapf.com>
	<200811060113.16981.laurent.pinchart@skynet.be>
	<200811091417.00593.amy@ameliezapf.com>
Message-ID: <200811111926.29213.laurent.pinchart@skynet.be>

Hi Amy,

On Sunday 09 November 2008, Amelie Zapf wrote:
> Dear Laurent,
>
> > My guess would be that the SET_CUR request makes the device crash. This
> > could be caused by unexpected values (from the device's point of view) in
> > the request data. If you have access to a Windows box, it would be
> > interesting to try the camera there and, if it works properly, capture a
> > USB trace.
>
> My configuration is as follows: Camera is firmly installed into a notebook
> computer, this means, I can't unplug/replug, there is no cable. The
> notebook computer is dual-boot, Open Suse 11.0 as default and Windows Vista
> (actually, for one single application).
>
> Now I've installed a 14-day trial version of a USB trace program. How do I
> go about to capture the trace in this case?

You will need a video capture application. It shouldn't be too difficult to 
find a free one if none is installed on your computer (I suppose the MSN 
messenger client or Skype would do). Start USB capture, open the video 
application, wait until you get the first video frame on screen and stop the 
capture. Don't wait too long before stopping capture otherwise the USB trace 
will get quite big. Just export the USB trace as text and mail it to me.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 11 19:29:33 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 11 Nov 2008 19:29:33 +0100
Subject: [Linux-uvc-devel] Capturing still images vs. video
In-Reply-To: <49176C0C.4080809@dbservice.com>
References: <4914012A.1050006@dbservice.com>
	<200811092305.43450.laurent.pinchart@skynet.be>
	<49176C0C.4080809@dbservice.com>
Message-ID: <200811111929.33848.laurent.pinchart@skynet.be>

Hi Tomas,

On Monday 10 November 2008, Tomas Carnecky wrote:
> On 11/09/2008 11:05 PM, Laurent Pinchart wrote:
> > Hi Moritz, hi Tomas,
> >
> > On Saturday 08 November 2008, Moritz Barsnick wrote:
> >>> The webcam in question is 'QuickCam Pro for Notebooks' from Logitech.
> >>> I've seen the 2007 Model is well supported by the uvc driver.
> >>
> >> Check out this (official Logitech) page and the linked Excel (:-P)
> >> files:
> >> http://www.quickcamteam.net/hcl/frame-format-matrix
> >>
> >> And indeed, you're lucky, your camera is listed with 5 fps at
> >> 1600x1200.
> >
> > Luckily there's a workaround, so I'll have some more time to implement
> > still image capture in the driver :-) As a side note, I don't think you
> > can expect 5fps when capturing still images.
>
> Even if the vendor says so in the documentation?

Some Philips webcam are marketed as being 90fps capable. This is blatantly 
false. Vendor documentation can't always be relied on.

I'd be surprised if vendors advertised a frame rate for *still images*. Still 
images are supposed to be, well, still :-) The advertised frame rate for 
video capture is usually correct but often depends on lightning conditions.

Best regards,

Laurent Pinchart


From fargiolas at gnome.org  Tue Nov 11 19:17:48 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Tue, 11 Nov 2008 19:17:48 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <200811111831.54185.laurent.pinchart@skynet.be>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
Message-ID: <1226427468.27764.8.camel@tux>

On mar, 2008-11-11 at 18:31 +0100, Laurent Pinchart wrote:
> Could you please check the kernel log (dmesg) for error messages printed by 
> the uvcvideo driver after locking the camera/driver ?

Hi Laurent, I have no error message in the kernel log when the camera
locks. Anyway I'm attaching here some trace obtained with modprobe
uvcvideo trace=255.

dmesg-gst-1.log 
Trace obtained running gst-launch-0.10 v4l2src ! video/x-raw-yuv, width=1280, height=1024 ! xvimagesink
The webcam works nice, I can see the video but something happens and
after I close it I'm not able to use the webcam anymore

dmesg-gst-2.log
Trace obtained with the gst-launch pipeline ran afterwards the previous.
I cannot see any video and the trace outputs tons of messages like
"uvcvideo: Dropping payload (out of sync)."

Note that I'm using uvcvideo from a v4l-dvb checkout about a week old.
Hope it helps, tell me if you need further information.

Best Regards

Filippo Argiolas

-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg-gst-1.log.bz2
Type: application/x-bzip
Size: 9451 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081111/0c7c6389/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg-gst-2.log.bz2
Type: application/x-bzip
Size: 32458 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081111/0c7c6389/attachment-0001.bin>

From witzjean at gmail.com  Tue Nov 11 19:47:32 2008
From: witzjean at gmail.com (jeff witz)
Date: Tue, 11 Nov 2008 19:47:32 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226427468.27764.8.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
	<1226427468.27764.8.camel@tux>
Message-ID: <bb7789710811111047m1e85b5bp5061db0b3b8fd3e3@mail.gmail.com>

salut Laurent,

We have exactely the same problem on the last ubuntu in our laboratory.

there is no kernel log except a number.

Rapha?l Pasquier works on it but he has some troubles to identify where is
the bug ...
It seems that every set up dependig on the flag V4L2_CID fail.
I remember an similar issue when we switch from a version to a svn one in
July due to a change in the API.
For now we can't control the time exposure, switch from auto to manual, on
our webcam.
If you have some ideas about a test to perform, feel free to ask us.

Best regards.



2008/11/11 Filippo Argiolas <fargiolas at gnome.org>

> On mar, 2008-11-11 at 18:31 +0100, Laurent Pinchart wrote:
> > Could you please check the kernel log (dmesg) for error messages printed
> by
> > the uvcvideo driver after locking the camera/driver ?
>
> Hi Laurent, I have no error message in the kernel log when the camera
> locks. Anyway I'm attaching here some trace obtained with modprobe
> uvcvideo trace=255.
>
> dmesg-gst-1.log
> Trace obtained running gst-launch-0.10 v4l2src ! video/x-raw-yuv,
> width=1280, height=1024 ! xvimagesink
> The webcam works nice, I can see the video but something happens and
> after I close it I'm not able to use the webcam anymore
>
> dmesg-gst-2.log
> Trace obtained with the gst-launch pipeline ran afterwards the previous.
> I cannot see any video and the trace outputs tons of messages like
> "uvcvideo: Dropping payload (out of sync)."
>
> Note that I'm using uvcvideo from a v4l-dvb checkout about a week old.
> Hope it helps, tell me if you need further information.
>
> Best Regards
>
> Filippo Argiolas
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>


-- 
Jean-Fran?ois WITZ
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081111/47f4da92/attachment.html>

From laurent.pinchart at skynet.be  Wed Nov 12 01:37:57 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 01:37:57 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
In-Reply-To: <1226274434.21482.47.camel@mentalek>
References: <200811041131.23108.palo@bielyvlk.sk>
	<200811092300.18076.laurent.pinchart@skynet.be>
	<1226274434.21482.47.camel@mentalek>
Message-ID: <200811120137.57439.laurent.pinchart@skynet.be>

Hi Petr,

On Monday 10 November 2008, Petr Men??k wrote:
> hi,
>
> i found interesting news. my camera will change its resolution, but only
> to 640x480 and 1280x1024 correctly. I was astonished when high
> resolution worked, i did not expect that. I got working svn version of
> luvcview, but really lower resolutions are still wrong in that also.

Could you please send me the USB descriptors of your camera ? You can retrieve 
them with 'lsusb -v'.

> Yes, lower resolutions worked fine in ekiga before, i believe it is
> using lowest one, 160x120.

So there's probably a problem on the host side (or at least in the host <-> 
device communication). Your tests seem to point to the resolution change not 
being understood by the camera.

To confirm that, I'd like you to check the kernel log with the uvcvideo trace 
parameter set to 128 (either when loading the driver, or later with 'echo 128 
> /sys/modules/uvcvideo/parameters/trace').

Clear the kernel log (dmesg -c), run a video application in 640x480 for a 
second or two (longer would write too much messages to the log), close the 
application and capture the kernel log. Rerun the same test procedure in a 
lower, faulty resolution such as 320x240.

If, as I suspect, the camera doesn't understand the resolution change 
properly, it should send a whole 640x480 frame even when the driver expects a 
lower resolution. Excess video data should be dropped and logged by the 
driver with a "Dropping payload (out of sync)" message. Those messages should 
not occur in 640x480 (or at least be way less frequent than in 320x240).

> Really firmware loading is a bit problem, as you have to reload module if
> you did not load before usb subsystem. Camera cannot be unpluged, because is
> built-in.

This is indeed a problem. Unfortunately the camera doesn't re-enumerate with a 
different product ID after firmware loading. Let's try to find a solution for 
that problem after fixing the lower resolutions issue.

> What is for input layer for webcamera by the way? I have one pretty old
> Genius GE111 with button on it, yet driver did not support button when i
> tested it (and i doubt it will ever do, as image quality from camera is
> very low).

The uvcvideo driver creates an input device to report button events for 
cameras that have driver-accessible buttons.

> It might be useful to direct owners of r5u870 to web page about it, tell
> them it needs firmware and maybe refuse to handle them without special
> parameters. Maybe print some warning at least for usb vendor id for
> these cameras.

Good point. I'd like to see if we can solve the lower resolutions problem 
first, then I'll make a list of the remaining issues and report them on the 
driver's website.

> Oh and i forget to note interesting feature. In mplayer, it started to
> show anything always after 10th frame on lower resolutions. There is
> black first ten frames when resolution is lower than 640x480.
>
> When i see usage of UVC standard for my camera, is that reliable to buy
> some camera claiming to support standard? Is it unusual having camera
> like mine, working only after firmware loading?

Yes it's very unusual, and even not allowed by the UVC standard. The camera 
should enumerate with a different PID and not advertise UVC capabilities 
before the firmware is loaded, and re-enumerate with UVC descriptors after 
firmware loading. This is what the iSight does. In addition to the firmware 
issue, there are also other UVC non-compliance problems with the r5u870 
chipset that make it far from being UVC compliant.

> I hoped that with adoption of uvc webcams will be finally plug&play without
> messing with strage drivers from strange place.

We're getting there. Some cameras (early Logitech models for instance) have 
bugs that make them quite unreliable, others claim to be UVC compliant while 
they really are not (Ricoh and Apple iSight come to mind). Fortunately most 
UVC webcams work out of the box with the Linux UVC driver, otherwise 
maintaining the driver would become a full-time job :-)

> Is it again more about marketing than engineering?

In case of Ricoh, I'd say yes.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Nov 12 02:03:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 02:03:11 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226427468.27764.8.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
	<1226427468.27764.8.camel@tux>
Message-ID: <200811120203.11678.laurent.pinchart@skynet.be>

Hi Filippo,

On Tuesday 11 November 2008, Filippo Argiolas wrote:
> On mar, 2008-11-11 at 18:31 +0100, Laurent Pinchart wrote:
> > Could you please check the kernel log (dmesg) for error messages printed
> > by the uvcvideo driver after locking the camera/driver ?
>
> Hi Laurent, I have no error message in the kernel log when the camera
> locks. Anyway I'm attaching here some trace obtained with modprobe
> uvcvideo trace=255.

Thanks.

> dmesg-gst-1.log
> Trace obtained running gst-launch-0.10 v4l2src ! video/x-raw-yuv,
> width=1280, height=1024 ! xvimagesink The webcam works nice, I can see the
> video but something happens and after I close it I'm not able to use the
> webcam anymore

What do you mean by "something happens" ? Did the camera stop streaming ? I 
can't see any hint in the log.

> dmesg-gst-2.log
> Trace obtained with the gst-launch pipeline ran afterwards the previous.
> I cannot see any video and the trace outputs tons of messages like
> "uvcvideo: Dropping payload (out of sync)."
>
> Note that I'm using uvcvideo from a v4l-dvb checkout about a week old.
> Hope it helps, tell me if you need further information.

Could you please apply the attached patch and recapture kernel log traces for 
the above two use cases ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvcvideo.patch
Type: text/x-diff
Size: 603 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081112/8d610718/attachment.patch>

From laurent.pinchart at skynet.be  Wed Nov 12 02:07:09 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 02:07:09 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <bb7789710811111047m1e85b5bp5061db0b3b8fd3e3@mail.gmail.com>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<1226427468.27764.8.camel@tux>
	<bb7789710811111047m1e85b5bp5061db0b3b8fd3e3@mail.gmail.com>
Message-ID: <200811120207.09224.laurent.pinchart@skynet.be>

Hi Jeff,

On Tuesday 11 November 2008, jeff witz wrote:
> salut Laurent,
>
> We have exactely the same problem on the last ubuntu in our laboratory.

What camera are you using ?

> there is no kernel log except a number.
>
> Rapha?l Pasquier works on it but he has some troubles to identify where is
> the bug ...
> It seems that every set up dependig on the flag V4L2_CID fail.
> I remember an similar issue when we switch from a version to a svn one in
> July due to a change in the API.
> For now we can't control the time exposure, switch from auto to manual, on
> our webcam.

The problem reported by Filippo is completely different. Are you experiencing 
two different issues ?

> If you have some ideas about a test to perform, feel free to ask us.

Best regards,

Laurent Pinchart


From fargiolas at gnome.org  Wed Nov 12 08:18:44 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Wed, 12 Nov 2008 08:18:44 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <200811120203.11678.laurent.pinchart@skynet.be>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
	<1226427468.27764.8.camel@tux>
	<200811120203.11678.laurent.pinchart@skynet.be>
Message-ID: <1226474324.17549.7.camel@tux>

On mer, 2008-11-12 at 02:03 +0100, Laurent Pinchart wrote:
> What do you mean by "something happens" ? Did the camera stop streaming ? I 
> can't see any hint in the log.

I mean that something not noticeable happens with the camera: everything
seems fine, I can see the video stream but any subsequent run of that
gst-launch command fails, hence I believe something happened in the
first run.

I applied your patch in current svn (r262) and did the same test again.
Note that the second gst-launch run doesn't exit cleanly, I have to
press Ctrl+C 2 times, the first one tries to correctly stop the pipeline
but hangs, the second actually forces quit. The webcam light never turns
on, maybe something is failing with webcam initialization.

Another thing, I'm a bit confused about the place uvcvideo development
is going on at the moment. I see you sent me a patch against svn but I
believed uvc was included upstream so development was going on on
linuxtv mercurial repos.. isn't it so?

Best Regards,

Filippo Argiolas



From fargiolas at gnome.org  Wed Nov 12 10:12:19 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Wed, 12 Nov 2008 10:12:19 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226474382.17549.8.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
	<1226427468.27764.8.camel@tux>
	<200811120203.11678.laurent.pinchart@skynet.be>
	<1226474324.17549.7.camel@tux>  <1226474382.17549.8.camel@tux>
Message-ID: <1226481139.17549.28.camel@tux>

On mer, 2008-11-12 at 08:20 +0100, Filippo Argiolas wrote:
> On mer, 2008-11-12 at 08:18 +0100, Filippo Argiolas wrote:
> > On mer, 2008-11-12 at 02:03 +0100, Laurent Pinchart wrote:
> > > What do you mean by "something happens" ? Did the camera stop streaming ? I 
> > > can't see any hint in the log.
> > 
> > I mean that something not noticeable happens with the camera: everything
> > seems fine, I can see the video stream but any subsequent run of that
> > gst-launch command fails, hence I believe something happened in the
> > first run.
> > 
> > I applied your patch in current svn (r262) and did the same test again.
> > Note that the second gst-launch run doesn't exit cleanly, I have to
> > press Ctrl+C 2 times, the first one tries to correctly stop the pipeline
> > but hangs, the second actually forces quit. The webcam light never turns
> > on, maybe something is failing with webcam initialization.
> > 
> > Another thing, I'm a bit confused about the place uvcvideo development
> > is going on at the moment. I see you sent me a patch against svn but I
> > believed uvc was included upstream so development was going on on
> > linuxtv mercurial repos.. isn't it so?
> > 

Since I'm not so sure gstreamer is not involved with this issue I looked
in gst-plugins-good for recent changes on v4l2src. The only notable
change was its switch to libv4l2 (see bug
http://bugzilla.gnome.org/show_bug.cgi?id=545033 ).
Hans had some doubt a behavior like this could be caused by libv4l when
I asked him in http://bugzilla.gnome.org/show_bug.cgi?id=545033 but I
wouldn't exclude it, so I'm attaching a libv4l2 log. If not else, it
does contain a log of all the ioctl calls.. maybe it can be useful.
First one done with the first gst-launch run, second one with the
second.

Thanks again,

Filippo Argiolas


-------------- next part --------------
A non-text attachment was scrubbed...
Name: libv4l2-1.log.bz2
Type: application/x-bzip
Size: 550 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081112/fcac3019/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: libv4l2-2.log.bz2
Type: application/x-bzip
Size: 502 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081112/fcac3019/attachment-0001.bin>

From fargiolas at gnome.org  Wed Nov 12 10:19:11 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Wed, 12 Nov 2008 10:19:11 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226481139.17549.28.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
	<1226427468.27764.8.camel@tux>
	<200811120203.11678.laurent.pinchart@skynet.be>
	<1226474324.17549.7.camel@tux>  <1226474382.17549.8.camel@tux>
	<1226481139.17549.28.camel@tux>
Message-ID: <1226481551.17549.30.camel@tux>

> Hans had some doubt a behavior like this could be caused by libv4l when
> I asked him in http://bugzilla.gnome.org/show_bug.cgi?id=545033 but I

Wrong bug number, it was in
http://bugzilla.gnome.org/show_bug.cgi?id=559057

Best Regards,

Filippo



From fargiolas at gnome.org  Wed Nov 12 08:19:42 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Wed, 12 Nov 2008 08:19:42 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226474324.17549.7.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811111831.54185.laurent.pinchart@skynet.be>
	<1226427468.27764.8.camel@tux>
	<200811120203.11678.laurent.pinchart@skynet.be>
	<1226474324.17549.7.camel@tux>
Message-ID: <1226474382.17549.8.camel@tux>

On mer, 2008-11-12 at 08:18 +0100, Filippo Argiolas wrote:
> On mer, 2008-11-12 at 02:03 +0100, Laurent Pinchart wrote:
> > What do you mean by "something happens" ? Did the camera stop streaming ? I 
> > can't see any hint in the log.
> 
> I mean that something not noticeable happens with the camera: everything
> seems fine, I can see the video stream but any subsequent run of that
> gst-launch command fails, hence I believe something happened in the
> first run.
> 
> I applied your patch in current svn (r262) and did the same test again.
> Note that the second gst-launch run doesn't exit cleanly, I have to
> press Ctrl+C 2 times, the first one tries to correctly stop the pipeline
> but hangs, the second actually forces quit. The webcam light never turns
> on, maybe something is failing with webcam initialization.
> 
> Another thing, I'm a bit confused about the place uvcvideo development
> is going on at the moment. I see you sent me a patch against svn but I
> believed uvc was included upstream so development was going on on
> linuxtv mercurial repos.. isn't it so?
> 
> Best Regards,
> 
> Filippo Argiolas

Forgot the attachments, sorry :P
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg-better-trace-1.log.bz2
Type: application/x-bzip
Size: 14458 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081112/1c20e345/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg-better-trace-2.log.bz2
Type: application/x-bzip
Size: 18921 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081112/1c20e345/attachment-0001.bin>

From pj.assis at gmail.com  Wed Nov 12 10:58:16 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 12 Nov 2008 09:58:16 +0000
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226481551.17549.30.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>	<200811111831.54185.laurent.pinchart@skynet.be>	<1226427468.27764.8.camel@tux>	<200811120203.11678.laurent.pinchart@skynet.be>	<1226474324.17549.7.camel@tux>
	<1226474382.17549.8.camel@tux>	<1226481139.17549.28.camel@tux>
	<1226481551.17549.30.camel@tux>
Message-ID: <491AA8B8.7080100@gmail.com>

Hi,
I've notice a similar problem with my sphere AF,
The camera is working OK, but then the controls stop responding, video
streaming is unaffected until I restart the app,
after this it just fails to start, and I need to rmmod/modprobe  the
driver  to get the camera working again.
The problem is a bit random (very similar to the one caused by the
firmware bug on my pro 5000, but not so severe),
It seems to be triggered more easily when doing intensive control
operations, like pan/tilt, or using the manual focus control,
I don't use other controls that much, so I'm not sure if they also
trigger the described error.

Best regards,
Paulo

Filippo Argiolas escreveu:
>> Hans had some doubt a behavior like this could be caused by libv4l when
>> I asked him in http://bugzilla.gnome.org/show_bug.cgi?id=545033 but I
>>     
>
> Wrong bug number, it was in
> http://bugzilla.gnome.org/show_bug.cgi?id=559057
>
> Best Regards,
>
> Filippo
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>   



From laurent.pinchart at skynet.be  Wed Nov 12 11:38:03 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 11:38:03 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226474324.17549.7.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811120203.11678.laurent.pinchart@skynet.be>
	<1226474324.17549.7.camel@tux>
Message-ID: <200811121138.03764.laurent.pinchart@skynet.be>

Hi Filippo,

On Wednesday 12 November 2008, Filippo Argiolas wrote:
> On mer, 2008-11-12 at 02:03 +0100, Laurent Pinchart wrote:
> > What do you mean by "something happens" ? Did the camera stop streaming ?
> > I can't see any hint in the log.
>
> I mean that something not noticeable happens with the camera: everything
> seems fine, I can see the video stream but any subsequent run of that
> gst-launch command fails, hence I believe something happened in the
> first run.

Or something doesn't happen in the second run.

> I applied your patch in current svn (r262) and did the same test again.
> Note that the second gst-launch run doesn't exit cleanly, I have to
> press Ctrl+C 2 times, the first one tries to correctly stop the pipeline
> but hangs, the second actually forces quit.

Not really surprising, the driver waits in VIDIOC_DQBUF for a video buffer to 
be ready. This is supposed to be interruptible though.

> The webcam light never turns on, maybe something is failing with webcam
> initialization.

I've compared the two traces (both kernel log messages and libv4l) and they 
are identical for the initialisation part.

Two things bother me. First of all, libv4l spams the the driver (and thus the 
camera) with VIDIOC_TRY_FMT requests. Given the fragile state of many webcam 
firmwares, I wouldn't be surprised if some of them would simply crash.

Then, and this might be the real issue here, the application calls 
VIDIOC_S_FMT but libv4l doesn't relay that to the driver. I suppose there's a 
check in the library that compares the requested format with the current 
format and returns immediately if they are identical. This means the camera 
doesn't receive any set format request between the two runs. I wouldn't be 
surprised if camera developers never expected that.

As a quick workaround, could you please try the attached patch ? It modifies 
device initialisation to make sure a set format request is send right before 
starting the video stream.

> Another thing, I'm a bit confused about the place uvcvideo development
> is going on at the moment. I see you sent me a patch against svn but I
> believed uvc was included upstream so development was going on on
> linuxtv mercurial repos.. isn't it so?

I'm moving from the SVN repository on Berlios to Mercurial on linuxtv.org. It 
was easier for me yesterday to generate the patch against SVN.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uc20-commit.diff
Type: text/x-diff
Size: 1423 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081112/08fa9405/attachment.diff>

From laurent.pinchart at skynet.be  Wed Nov 12 11:39:41 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 11:39:41 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <491AA8B8.7080100@gmail.com>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<1226481551.17549.30.camel@tux> <491AA8B8.7080100@gmail.com>
Message-ID: <200811121139.42023.laurent.pinchart@skynet.be>

Hi Paulo,

On Wednesday 12 November 2008, Paulo Assis wrote:
> Hi,
> I've notice a similar problem with my sphere AF,
> The camera is working OK, but then the controls stop responding, video
> streaming is unaffected until I restart the app,
> after this it just fails to start, and I need to rmmod/modprobe  the
> driver  to get the camera working again.
> The problem is a bit random (very similar to the one caused by the
> firmware bug on my pro 5000, but not so severe),
> It seems to be triggered more easily when doing intensive control
> operations, like pan/tilt, or using the manual focus control,
> I don't use other controls that much, so I'm not sure if they also
> trigger the described error.

Could you please check the kernel log after the problem occurred (both when 
you notice that controls stop responding, and after the application failed to 
restart) and report any message printed by the driver ?

Best regards,

Laurent Pinchart


From fargiolas at gnome.org  Wed Nov 12 12:07:30 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Wed, 12 Nov 2008 12:07:30 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <200811121138.03764.laurent.pinchart@skynet.be>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811120203.11678.laurent.pinchart@skynet.be>
	<1226474324.17549.7.camel@tux>
	<200811121138.03764.laurent.pinchart@skynet.be>
Message-ID: <1226488050.32356.10.camel@tux>

On mer, 2008-11-12 at 11:38 +0100, Laurent Pinchart wrote:
> Hi Filippo,

Hi Laurent,
(Hi Hans too)

> Then, and this might be the real issue here, the application calls 
> VIDIOC_S_FMT but libv4l doesn't relay that to the driver. I suppose there's a 
> check in the library that compares the requested format with the current 
> format and returns immediately if they are identical. This means the camera 
> doesn't receive any set format request between the two runs. I wouldn't be 
> surprised if camera developers never expected that.
> 
> As a quick workaround, could you please try the attached patch ? It modifies 
> device initialisation to make sure a set format request is send right before 
> starting the video stream.

It seems you are right, with this patch applied I can run the gst-launch
pipeline plenty of times without any lock. Cheese seems fixed too
(webcam startup is a bit slow when the maximum resolution is set but itd
did always behave this way).
So where is the right place to fix this?

> I'm moving from the SVN repository on Berlios to Mercurial on linuxtv.org. It 
> was easier for me yesterday to generate the patch against SVN.

Thanks for making it clear.

Best Regards,

Filippo Argiolas



From laurent.pinchart at skynet.be  Wed Nov 12 14:13:05 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 14:13:05 +0100
Subject: [Linux-uvc-devel] [INFO] Source code repository has been moved to
	linuxtv.org
Message-ID: <200811121413.05851.laurent.pinchart@skynet.be>

Hi everybody,

this had to happen at some point for maintenance reasons, the uvcvideo source 
code is now hosted on linuxtv.org. You're all invited to visit 
http://linuxtv.org/hg/~pinchartl/uvcvideo/ for a tour of the new host (I'm 
afraid I can't provide champagne and appetisers yet).

The switch comes with its share of benefits, such as a nice web interface or 
automatic tarballs generation (and, last but not least, at least for me, an 
easier way to manage compatibility with older kernel versions).

A bit more disturbing for those of you who were used to SVN, it also comes 
with a disruption in your work habits, as linuxtv.org uses Mercurial as its 
revision control system. Documentation about Mercurial is available from the 
linuxtv.org wiki (http://linuxtv.org/v4lwiki) and of course the Mercurial web 
site (http://www.selenic.com/mercurial/wiki/). The linux-uvc web site has 
been updated with instructions to quickly retrieve the driver sources.

The SVN repository on Berlios has been deprecated. It still contains the 
uvcvideo history but will print an informational message instead of compiling 
when you invoke make without specifying a target.

I hope the switch will be beneficial for all of us. Feel free to report issues 
and concerns on the linux-uvc-devel mailing list where I'll try to provide 
assistance.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Nov 12 15:09:47 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 15:09:47 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <491AB5CB.8030206@redhat.com>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811121138.03764.laurent.pinchart@skynet.be>
	<491AB5CB.8030206@redhat.com>
Message-ID: <200811121509.47478.laurent.pinchart@skynet.be>

Hi Hans,

On Wednesday 12 November 2008, Hans de Goede wrote:
> Laurent Pinchart wrote:
> > Hi Filippo,
> >
> > On Wednesday 12 November 2008, Filippo Argiolas wrote:
>
> <snip>
>
> >> The webcam light never turns on, maybe something is failing with webcam
> >> initialization.
> >
> > I've compared the two traces (both kernel log messages and libv4l) and
> > they are identical for the initialisation part.
> >
> > Two things bother me. First of all, libv4l spams the the driver (and thus
> > the camera) with VIDIOC_TRY_FMT requests. Given the fragile state of many
> > webcam firmwares, I wouldn't be surprised if some of them would simply
> > crash.
>
> Hmm, uvcvideo is sort of unique here in that TRY_FMT actually generates io
> (I know this is not something uvcvideo can help). What libv4l does, it
> finds out which formats the cam can support using ENUM_FMT (it does this
> only once), and then when a TRY_FMT is emulated by libv4l, and the app
> requested format is something libv4l can convert too, it will do a try_fmt
> with the app requested settings for all formats returned by enum_fmt to see
> using which format comes closes to what the app has requested. This is done
> because quite a few apps support different resolutions at different formats
> (including some uvc cams).
>
> If this really turns out to be a problem we need to look into this. Would
> using ENUM_FRAMESIZE for all formats once be better?

If the driver supports it, ENUM_FRAMESIZE is much better. This is exactly what 
is was designed for after all. TRY_FMT should then be used after the format 
and size has been selected from the enumerated list as the last step in 
format negotiation.

In this specific case I don't think the tsunami of TRY_FMT requests annoyed 
the camera, so there's no hurry. It could even be a good hardware stress 
test :-)

> > Then, and this might be the real issue here, the application calls
> > VIDIOC_S_FMT but libv4l doesn't relay that to the driver. I suppose
> > there's a check in the library that compares the requested format with
> > the current format and returns immediately if they are identical. This
> > means the camera doesn't receive any set format request between the two
> > runs. I wouldn't be surprised if camera developers never expected that.
>
> Correct, libv4l tries to cause as little IO as possible.

Regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Nov 12 15:12:30 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 15:12:30 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <1226488050.32356.10.camel@tux>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811121138.03764.laurent.pinchart@skynet.be>
	<1226488050.32356.10.camel@tux>
Message-ID: <200811121512.30959.laurent.pinchart@skynet.be>

Hi Filippo,

On Wednesday 12 November 2008, Filippo Argiolas wrote:
> On mer, 2008-11-12 at 11:38 +0100, Laurent Pinchart wrote:
> > Then, and this might be the real issue here, the application calls
> > VIDIOC_S_FMT but libv4l doesn't relay that to the driver. I suppose
> > there's a check in the library that compares the requested format with
> > the current format and returns immediately if they are identical. This
> > means the camera doesn't receive any set format request between the two
> > runs. I wouldn't be surprised if camera developers never expected that.
> >
> > As a quick workaround, could you please try the attached patch ? It
> > modifies device initialisation to make sure a set format request is send
> > right before starting the video stream.
>
> It seems you are right, with this patch applied I can run the gst-launch
> pipeline plenty of times without any lock. Cheese seems fixed too
> (webcam startup is a bit slow when the maximum resolution is set but itd
> did always behave this way).
> So where is the right place to fix this?

Probably in the driver, as what libv4l does is valid according the the V4L2 
specification. I'll commit the patch (to the uvcvideo hg repository on 
linuxtv.org, the switch from SVN is not complete) and hope it won't disturb 
other cameras.

I suppose the change should be pushed to Ubuntu 8.10 as well. Do you have 
contacts with the Ubuntu kernel maintainers ?

> > I'm moving from the SVN repository on Berlios to Mercurial on
> > linuxtv.org. It was easier for me yesterday to generate the patch against
> > SVN.
>
> Thanks for making it clear.

You're welcome.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Nov 12 17:31:38 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 12 Nov 2008 17:31:38 +0100
Subject: [Linux-uvc-devel] [linux-uvc] Still Image
In-Reply-To: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>
References: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>
Message-ID: <200811121731.38340.laurent.pinchart@skynet.be>

Hi,

On Tuesday 11 November 2008, palmax at gmail.com wrote:
> Dear Laurent and other developers of linux-uvc:
>
> I was talking with my mentor. We are interesting in:
> ? Still Image capture: method 2 and method 3, but we don't know which
> camera can use method 3.

Here's a non exhaustive list of webcams that support (or at least claim to 
support) still capture method 2.

0402:5606 ALi Corp.
0408:030c Quanta Computer, Inc.
046d:0994 Logitech, Inc.
046d:09a1 Logitech, Inc.
046d:09b2 Logitech, Inc.
0471:0332 Philips
04f2:b016 Chicony Electronics Co., Ltd
05ac:8502 Apple Computer, Inc.
064e:a110 Suyin Corp.
0ac8:332d Z-Star Microelectronics Corp.
0ac8:3343 Z-Star Microelectronics Corp.
0ad2:933d Service & Quality Technology Co., Ltd
0c45:62e0 Microdia
0c45:63e0 Microdia
145f:013e Unknown
145f:013f
174f:5931 Syntek
174f:5a31
174f:8a33
1871:0306
1c4f:3000
1cac:a332
1cac:b288
5986:0104 Bison
5986:0200
5986:0202 Bison
5986:0240 Bison
5986:0300
5986:0303 Bison

I don't know of any camera supporting still image capture method 3.

> ? Clock: I can see an example in documentation of UVC 1.1 (Class and
> FAQ)  with clock reference, but it's only a unique (and duplicated)
> example with stream payload.

See section 2.4.3.4 in the UVC 1.1 specification.

> ? UVC stub: My mentor is thinking about have a software UVC (like
> mac80211 for wifi devices) that show you usb trams. It can be
> interesting for learning and for debugging.

I'm not sure to understand. Could you please elaborate ?

Best regards,

Laurent Pinchart


From fargiolas at gnome.org  Wed Nov 12 17:42:10 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Wed, 12 Nov 2008 17:42:10 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <200811121512.30959.laurent.pinchart@skynet.be>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811121138.03764.laurent.pinchart@skynet.be>
	<1226488050.32356.10.camel@tux>
	<200811121512.30959.laurent.pinchart@skynet.be>
Message-ID: <8ceb98f20811120842x90118fp24406346fe66a694@mail.gmail.com>

On Wed, Nov 12, 2008 at 3:12 PM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi Filippo,
Hi Laurent,

> Probably in the driver, as what libv4l does is valid according the the V4L2
> specification. I'll commit the patch (to the uvcvideo hg repository on
> linuxtv.org, the switch from SVN is not complete) and hope it won't disturb
> other cameras.
>
> I suppose the change should be pushed to Ubuntu 8.10 as well. Do you have
> contacts with the Ubuntu kernel maintainers ?

Thank you for this fix, unfortunately I don't have contacts with the
ubuntu kernel team. I added a reference to your commit and to the hg
repository in the launchpad bug so that other users can confirm it
fixes their issue too. People from the kernel team should be already
subscribed to that bug so they should be aware of it by now.

Thanks again,
Best regards

Filippo Argiolas


From pj.assis at gmail.com  Thu Nov 13 00:18:45 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 12 Nov 2008 23:18:45 +0000
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <200811121139.42023.laurent.pinchart@skynet.be>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<1226481551.17549.30.camel@tux> <491AA8B8.7080100@gmail.com>
	<200811121139.42023.laurent.pinchart@skynet.be>
Message-ID: <59cf47a80811121518v3943f1e5w5a2236e5e35041cf@mail.gmail.com>

Laurent,
Here is the request dmesg output when controls start to fail:

[  152.923415] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-32 (exp. 4).
[  153.588159] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  154.185036] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  154.484165] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  154.784035] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  155.084039] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  155.384161] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  155.685037] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  155.984162] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  156.285167] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).
[  156.584167] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
-110 (exp. 4).

I was just paning left and right and after a while the camera just
stopped responding, video is still streaming ok.
all other controls also stopped responding (see brightness control below):

[  500.896084] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
-110 (exp. 2).
[  501.197589] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
-110 (exp. 2).
[  501.496091] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
-110 (exp. 2).
[  501.796591] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
-110 (exp. 2).
[  502.096092] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
-110 (exp. 2).
[  502.396094] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
-110 (exp. 2).

The funny thing is that this only seems to occur after a kernel update.
I didn't seem to be able to replicate the problem before, but then I
run an update
and it installed kernel 2.6.27.8, after booting with the new kernel It
just failed almost
immediately (I had the camera connected).

When I try to restart guvcview I get the following in dmesg:

[  913.960151] uvcvideo: Failed to query (1) UVC control 1 (unit 0) :
-110 (exp. 26).
[  914.960146] uvcvideo: Failed to query (1) UVC control 1 (unit 0) :
-110 (exp. 26).

guvcview fails with  "Unable to set format: 5."

After replugging the camera everything seems to be working fine and I
can no longer
replicate this issue.

This is consistent with previous kernel updates (I always have to
disconnect the camera
after the update).

In my case it's not a big problem, I just don't understand why is this
necessary.

Best regards,
Paulo





2008/11/12 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi Paulo,
>
> On Wednesday 12 November 2008, Paulo Assis wrote:
>> Hi,
>> I've notice a similar problem with my sphere AF,
>> The camera is working OK, but then the controls stop responding, video
>> streaming is unaffected until I restart the app,
>> after this it just fails to start, and I need to rmmod/modprobe  the
>> driver  to get the camera working again.
>> The problem is a bit random (very similar to the one caused by the
>> firmware bug on my pro 5000, but not so severe),
>> It seems to be triggered more easily when doing intensive control
>> operations, like pan/tilt, or using the manual focus control,
>> I don't use other controls that much, so I'm not sure if they also
>> trigger the described error.
>
> Could you please check the kernel log after the problem occurred (both when
> you notice that controls stop responding, and after the application failed to
> restart) and report any message printed by the driver ?
>
> Best regards,
>
> Laurent Pinchart
>


From laurent.pinchart at skynet.be  Thu Nov 13 16:25:08 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 13 Nov 2008 16:25:08 +0100
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <59cf47a80811121518v3943f1e5w5a2236e5e35041cf@mail.gmail.com>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811121139.42023.laurent.pinchart@skynet.be>
	<59cf47a80811121518v3943f1e5w5a2236e5e35041cf@mail.gmail.com>
Message-ID: <200811131625.08492.laurent.pinchart@skynet.be>

Hi Paulo,

On Thursday 13 November 2008, Paulo Assis wrote:
> Laurent,
> Here is the request dmesg output when controls start to fail:

You probably won't like the outcome of my analysis... *sigh*

> [  152.923415] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -32 (exp. 4).

The camera crashes here.

> [  153.588159] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).

It doesn't recover there.

> [  154.185036] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).

Stays unresponsive.

> [  154.484165] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).

Death confirmed.

> [  154.784035] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).

RIP.

> [  155.084039] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).
> [  155.384161] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).
> [  155.685037] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).
> [  155.984162] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).
> [  156.285167] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).
> [  156.584167] uvcvideo: Failed to query (1) UVC control 1 (unit 9) :
> -110 (exp. 4).

I think you got the point :-)

Timing issues make the camera crash from a hardware/firmware bug. There's 
unfortunately not much I can do about it.

> I was just paning left and right and after a while the camera just
> stopped responding, video is still streaming ok.
> all other controls also stopped responding (see brightness control below):
>
> [  500.896084] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
> -110 (exp. 2).
> [  501.197589] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
> -110 (exp. 2).
> [  501.496091] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
> -110 (exp. 2).
> [  501.796591] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
> -110 (exp. 2).
> [  502.096092] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
> -110 (exp. 2).
> [  502.396094] uvcvideo: Failed to query (1) UVC control 2 (unit 2) :
> -110 (exp. 2).
>
> The funny thing is that this only seems to occur after a kernel update.
> I didn't seem to be able to replicate the problem before, but then I
> run an update and it installed kernel 2.6.27.8, after booting with the new
> kernel It just failed almost immediately (I had the camera connected).
>
> When I try to restart guvcview I get the following in dmesg:
>
> [  913.960151] uvcvideo: Failed to query (1) UVC control 1 (unit 0) :
> -110 (exp. 26).
> [  914.960146] uvcvideo: Failed to query (1) UVC control 1 (unit 0) :
> -110 (exp. 26).
>
> guvcview fails with  "Unable to set format: 5."
>
> After replugging the camera everything seems to be working fine and I
> can no longer replicate this issue.
>
> This is consistent with previous kernel updates (I always have to
> disconnect the camera after the update).

This is weird. I would understand breakage introduce by a kernel update, but I 
would have assumed they wouldn't be limited to the first boot after the 
kernel upgrade.

> In my case it's not a big problem, I just don't understand why is this
> necessary.

Best regards,

Laurent Pinchart


From pj.assis at gmail.com  Thu Nov 13 16:51:26 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 13 Nov 2008 15:51:26 +0000
Subject: [Linux-uvc-devel] Issue with recent uvcvideo
In-Reply-To: <200811131625.08492.laurent.pinchart@skynet.be>
References: <8ceb98f20811070114l389160c3xaaf8d335cc439439@mail.gmail.com>
	<200811121139.42023.laurent.pinchart@skynet.be>
	<59cf47a80811121518v3943f1e5w5a2236e5e35041cf@mail.gmail.com>
	<200811131625.08492.laurent.pinchart@skynet.be>
Message-ID: <491C4CFE.6020309@gmail.com>

Laurent,
>
> I think you got the point :-)
>
> Timing issues make the camera crash from a hardware/firmware bug. There's 
> unfortunately not much I can do about it.
>
>   
:'(  I thought this type of bug was limited to older models like my pro
5000, that was one of the reasons
 I bought the sphere, as its not listed as suffering  from this type of
problems.

> This is weird. I would understand breakage introduce by a kernel update, but I 
> would have assumed they wouldn't be limited to the first boot after the 
> kernel upgrade.
>
>   

If I keep the camera connected I can reboot several times and I still
have the same issue.
I need to power off the camera, in order to get it stable.
Has I remember in older Ubuntu kernels, upgrading the  driver also
fixed  it,
maybe because I needed to rmmod/modprobe to get the new driver loaded. ;-)

Best regards,
Paulo


From laurent.pinchart at skynet.be  Fri Nov 14 00:52:10 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 14 Nov 2008 00:52:10 +0100
Subject: [Linux-uvc-devel] [PATCH] Video/UVC: Port mainlined uvc video
	driver to NOMMU
In-Reply-To: <8A42379416420646B9BFAC9682273B6D065BA718@limkexm3.ad.analog.com>
References: <1225963130-6784-1-git-send-email-cooloney@kernel.org>
	<200811092222.18047.laurent.pinchart@skynet.be>
	<8A42379416420646B9BFAC9682273B6D065BA718@limkexm3.ad.analog.com>
Message-ID: <200811140052.10520.laurent.pinchart@skynet.be>

Hi Michael,

On Monday 10 November 2008, Hennerich, Michael wrote:
> >On Thursday 06 November 2008, Bryan Wu wrote:
> > > @@ -1071,7 +1072,20 @@ static int uvc_v4l2_mmap(struct file *file,
> > > struct vm_area_struct *vma) addr += PAGE_SIZE;
> > >  		size -= PAGE_SIZE;
> > >  	}
> > > +#else
> > > +	if (i == video->queue.count ||
> > > +		PAGE_ALIGN(size) != video->queue.buf_size) {
> >
> > Just out of curiosity, why do you need to PAGE_ALIGN size for non-MMU
> > platforms ?
>
> Size and video->queue.buf_size is not the 100% same size (off by a few
> bytes < pagesize), I think it's because on NOMMU the kernel calls
> kmalloc() to allocate the buffer, not get_free_page().

That's right, but only for private mappings. It makes little sense to create a 
private mapping on a V4L2 device as the kernel will read() device data into 
the buffer when mapping the device (at least on NOMMU platforms). Only shared 
mappings make sense in this case.

> > > +		ret = -EINVAL;
> > > +		goto done;
> > > +	}
> > > +
> > > +	vma->vm_flags |= VM_IO | VM_MAYSHARE; /* documentation/nommu-mmap.txt
> >
> > VM_MAYSHARE is not documented anywhere in Documentation/ in Linux
> > 2.6.28-rc3. Why is it needed for non-MMU architectures only ?
>
> mmap on NOMMU is a bit tricky and very restricted.
> In case user does a MAP_SHARED with some combination of the PROT_###
> Flags the mmap fails. What's allowed and what's not is documented in
> documentation/nommu-mmap.txt
> Setting VM_MAYSHARE allows user MAP_PRIVATE mappings.

There's something I don't understand. I've had a quick look at NOMMU mmap 
(mm/nommu.c) and it seems neither MAP_SHARED nor MAP_PRIVATE can succeed with 
UVC devices.

The uvcvideo driver doesn't implements the read and get_unmapped_area file 
operations. validate_mmap_request will thus clear the BDI_CAP_MAP_DIRECT and 
BDI_CAP_MAP_COPY from the device mapping capabilities. As shared mappings 
require BDI_CAP_MAP_DIRECT and private mappings require BDI_CAP_MAP_COPY 
validate_mmap_request will return an error and mmap will fail.

I might be wrong in my analysis, but if mapping a UVC device is impossible on 
a NOMMU platform the patch doesn't make much sense. Feel free to prove me 
wrong and send me back to mm/ if you've been able to map a UVC device on a 
NOMMU platform :-)

Laurent Pinchart


From michael.the.drummer at gmail.com  Fri Nov 14 03:34:43 2008
From: michael.the.drummer at gmail.com (Michael)
Date: Fri, 14 Nov 2008 13:04:43 +1030
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <58b40ca10811090544q6957e288g252847c6005d9e45@mail.gmail.com>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
	<200811091358.11152.laurent.pinchart@skynet.be>
	<58b40ca10811090544q6957e288g252847c6005d9e45@mail.gmail.com>
Message-ID: <58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>

On Mon, Nov 10, 2008 at 12:14 AM, Michael <michael.the.drummer at gmail.com>wrote:

> On Sun, Nov 9, 2008 at 11:28 PM, Laurent Pinchart <
> laurent.pinchart at skynet.be> wrote:
>
>> Hi Michael,
>>
>> On Thursday 06 November 2008, Michael wrote:
>> > Hey
>> >
>> > I'm trying to use video4linux2 to control a Logitech QuickCam Pro 9000.
>> The
>> > camera supports UVC and I can get the image just fine. However, I'm
>> having
>> > issues with the controls.
>> >
>> > Luvcview reports the following controls:
>> >
>> > V4L2_CID_BASE         (predefined controls):
>> >  index:9963776    name:Brightness                       type:1 min:0
>> > max:255   step:1     def:128   now:128
>> >  index:9963777    name:Contrast                         type:1 min:0
>> > max:255   step:1     def:32    now:32
>> >  index:9963778    name:Saturation                       type:1 min:0
>> > max:255   step:1     def:32    now:32
>> >  index:9963788    name:White Balance Temperature, Auto  type:2 min:0
>> > max:1     step:1     def:1     now:1
>> >  index:9963795    name:Gain                             type:1 min:0
>> > max:255   step:1     def:0     now:0
>> >
>> >
>> > There are no driver specific controls. The problem is that there are
>> some
>> > missing. There should also be Auto Exposure on/off, manual exposure,
>> > autofocus on/off and manual focus.
>> >
>> > The strange thing is that luvcview will let me turn off auto exposure
>> > (strangely by pressing the on button), and will also let me set the
>> > exposure manually.
>> >
>> > I would like to know if there is a way to access these controls using
>> > video4linux?
>>
>> Yes there is. luvcview uses an old control enumeration method that results
>> in
>> controls being missed. It should instead use the V4L2_CTRL_FLAG_NEXT_CTRL
>> flag as explained in the V4L2 specification.
>>
>> Regardless of enumeration issues, controls can be accessed through
>> VIDIOC_G_CTRL and VIDIOC_S_CTRL.
>>
>> Best regards,
>>
>> Laurent Pinchart
>
>
> Hi Laurent
>
> Thanks for that. After looking through the code, I am enumerating the
> controls in the same way luvcview does. I was just following a code example
> from the V4L2 api documentation (perhaps I was looking at an old version of
> the docs).
>
> Anyway I'll have a look at the V4L2_CTRL_FLAG_NEXT_CTRL tomorrow.
>
> Cheers
> Michael


Hi

I've modified how my code enumerates the controls for the camera.
Auto/manual exposure controls are now appearing, but manual focus is not. A
quick Google only finds mailing list posts from about a year ago dealing
with focus issues:


> - If I want to change the focus manually, than I have to do it by my own
> in a userspace program, as mentioned in some previous posts.

Right.

> Is the a code snippet available?

Not yet but soon :-) A userspace tool to handle vendor-specific controls is on
the way. It will be announced on the mailing list.

Best regards,

Laurent Pinchart


I would like to know if this is still the case? Am I able to set the
focus of the camera using Video4Linux2?

Thanks
Michael
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081114/db61618f/attachment.html>

From pj.assis at gmail.com  Fri Nov 14 10:29:09 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 14 Nov 2008 09:29:09 +0000
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>	<200811091358.11152.laurent.pinchart@skynet.be>	<58b40ca10811090544q6957e288g252847c6005d9e45@mail.gmail.com>
	<58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
Message-ID: <491D44E5.2040807@gmail.com>

Michael,

Dynamic controls need to be added to the driver first, and you will
require admin rights for that.
You can see examples of this on libwebcam:
http://www.quickcamteam.net/software/libwebcam
and guvcview: http://guvcview.berlios.de
you will need to run them as root (sudo) once in order to add dynamic
controls, like focus control.

Also newer models of the pro 9000 (2008 model) use gspca driver and are
not uvc compatible.

Best regards.
Paulo

> On Mon, Nov 10, 2008 at 12:14 AM, Michael
> <michael.the.drummer at gmail.com <mailto:michael.the.drummer at gmail.com>>
> wrote:
>
>     On Sun, Nov 9, 2008 at 11:28 PM, Laurent Pinchart
>     <laurent.pinchart at skynet.be <mailto:laurent.pinchart at skynet.be>>
>     wrote:
>
>         Hi Michael,
>
>         On Thursday 06 November 2008, Michael wrote:
>         > Hey
>         >
>         > I'm trying to use video4linux2 to control a Logitech
>         QuickCam Pro 9000. The
>         > camera supports UVC and I can get the image just fine.
>         However, I'm having
>         > issues with the controls.
>         >
>         > Luvcview reports the following controls:
>         >
>         > V4L2_CID_BASE         (predefined controls):
>         >  index:9963776    name:Brightness                      
>         type:1 min:0
>         > max:255   step:1     def:128   now:128
>         >  index:9963777    name:Contrast                        
>         type:1 min:0
>         > max:255   step:1     def:32    now:32
>         >  index:9963778    name:Saturation                      
>         type:1 min:0
>         > max:255   step:1     def:32    now:32
>         >  index:9963788    name:White Balance Temperature, Auto
>          type:2 min:0
>         > max:1     step:1     def:1     now:1
>         >  index:9963795    name:Gain                            
>         type:1 min:0
>         > max:255   step:1     def:0     now:0
>         >
>         >
>         > There are no driver specific controls. The problem is that
>         there are some
>         > missing. There should also be Auto Exposure on/off, manual
>         exposure,
>         > autofocus on/off and manual focus.
>         >
>         > The strange thing is that luvcview will let me turn off auto
>         exposure
>         > (strangely by pressing the on button), and will also let me
>         set the
>         > exposure manually.
>         >
>         > I would like to know if there is a way to access these
>         controls using
>         > video4linux?
>
>         Yes there is. luvcview uses an old control enumeration method
>         that results in
>         controls being missed. It should instead use the
>         V4L2_CTRL_FLAG_NEXT_CTRL
>         flag as explained in the V4L2 specification.
>
>         Regardless of enumeration issues, controls can be accessed through
>         VIDIOC_G_CTRL and VIDIOC_S_CTRL.
>
>         Best regards,
>
>         Laurent Pinchart
>
>      
>     Hi Laurent
>
>     Thanks for that. After looking through the code, I am enumerating
>     the controls in the same way luvcview does. I was just following a
>     code example from the V4L2 api documentation (perhaps I was
>     looking at an old version of the docs).
>
>     Anyway I'll have a look at the V4L2_CTRL_FLAG_NEXT_CTRL tomorrow.
>
>     Cheers
>     Michael 
>
>  
> Hi
>
> I've modified how my code enumerates the controls for the camera.
> Auto/manual exposure controls are now appearing, but manual focus is
> not. A quick Google only finds mailing list posts from about a year
> ago dealing with focus issues:
>
>
> > - If I want to change the focus manually, than I have to do it by my own
> > in a userspace program, as mentioned in some previous posts.
>
>
> Right.
>
> > Is the a code snippet available?
>
> Not yet but soon :-) A userspace tool to handle vendor-specific controls is on 
> the way. It will be announced on the mailing list.
>
> Best regards,
>
>
> Laurent Pinchart
>
>
> I would like to know if this is still the case? Am I able to set the focus of the camera using Video4Linux2?
>
> Thanks
> Michael
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>   



From laurent.pinchart at skynet.be  Fri Nov 14 10:49:08 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 14 Nov 2008 10:49:08 +0100
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <491D44E5.2040807@gmail.com>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
	<58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
	<491D44E5.2040807@gmail.com>
Message-ID: <200811141049.08973.laurent.pinchart@skynet.be>

On Friday 14 November 2008, Paulo Assis wrote:
> Michael,
>
> Dynamic controls need to be added to the driver first, and you will
> require admin rights for that.
> You can see examples of this on libwebcam:
> http://www.quickcamteam.net/software/libwebcam
> and guvcview: http://guvcview.berlios.de
> you will need to run them as root (sudo) once in order to add dynamic
> controls, like focus control.

I'd like to add that libwebcam comes with a userspace application (uvcdynctrl) 
to should be udev and/or hal pluggable.

> Also newer models of the pro 9000 (2008 model) use gspca driver and are
> not uvc compatible.

Are you sure about that ?

Best regards,

Laurent Pinchart


From pj.assis at gmail.com  Fri Nov 14 10:48:46 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 14 Nov 2008 09:48:46 +0000
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>	<200811091358.11152.laurent.pinchart@skynet.be>	<58b40ca10811090544q6957e288g252847c6005d9e45@mail.gmail.com>
	<58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
Message-ID: <491D497E.8050004@gmail.com>

Michael,

I had a better look and it seems that 3 generation (2008 model) pro 9000
cameras are still uvc compliant,
but unfortunately suffer from several firmware/hardware bugs, that make
them almost unusable under linux.

http://www.quickcamteam.net/hcl/linux/logitech_device_list_v2.pdf

Sorry, :-P

The good news is that this issues are solved in 4 generation cameras, to
be released around December.

Best regards,
Paulo



From pj.assis at gmail.com  Fri Nov 14 12:34:55 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 14 Nov 2008 11:34:55 +0000
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <200811141049.08973.laurent.pinchart@skynet.be>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
	<58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
	<491D44E5.2040807@gmail.com>
	<200811141049.08973.laurent.pinchart@skynet.be>
Message-ID: <491D625F.7070709@gmail.com>

Laurent Pinchart escreveu:
> On Friday 14 November 2008, Paulo Assis wrote:
>   
>> Michael,
>>
>> Dynamic controls need to be added to the driver first, and you will
>> require admin rights for that.
>> You can see examples of this on libwebcam:
>> http://www.quickcamteam.net/software/libwebcam
>> and guvcview: http://guvcview.berlios.de
>> you will need to run them as root (sudo) once in order to add dynamic
>> controls, like focus control.
>>     
>
> I'd like to add that libwebcam comes with a userspace application (uvcdynctrl) 
> to should be udev and/or hal pluggable.
>
>   

At least for Ubuntu some modifications on the udev script and rules are
required, see Trevor Post:

http://forums.quickcamteam.net/showthread.php?tid=392

(And even with these changes I still can't get cold plug to work, only
hot plug)

>> Also newer models of the pro 9000 (2008 model) use gspca driver and are
>> not uvc compatible.
>>     
> Are you sure about that ?
>
> Best regards,
>
> Laurent Pinchart
>
>   

Yes, I was wrong about this (see previous post), I knew there were
problems with 3 generation cameras,
and for some reason  I  had the impression that  they weren't  uvc
compliant, but apparently the problems
are caused by faulty firmware (the  ASIC is different from the 2007
model), also some functionality like
Raw Bayer was lost in these new models.

Best Regards,
Paulo


From palmax at gmail.com  Fri Nov 14 15:23:03 2008
From: palmax at gmail.com (palmax at gmail.com)
Date: Fri, 14 Nov 2008 15:23:03 +0100
Subject: [Linux-uvc-devel] [linux-uvc] Still Image
In-Reply-To: <200811121731.38340.laurent.pinchart@skynet.be>
References: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>
	<200811121731.38340.laurent.pinchart@skynet.be>
Message-ID: <209499a0811140623g7d563f56gd5829cf7806286f9@mail.gmail.com>

Hello

2008/11/12 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi,
>
> On Tuesday 11 November 2008, palmax at gmail.com wrote:
>> Dear Laurent and other developers of linux-uvc:
>>
>> I was talking with my mentor. We are interesting in:
>> ? Still Image capture: method 2 and method 3, but we don't know which
>> camera can use method 3.
>
> Here's a non exhaustive list of webcams that support (or at least claim to
> support) still capture method 2.
>
> 0402:5606 ALi Corp.
> 0408:030c Quanta Computer, Inc.
> 046d:0994 Logitech, Inc.
> 046d:09a1 Logitech, Inc.
> 046d:09b2 Logitech, Inc.
> 0471:0332 Philips
> 04f2:b016 Chicony Electronics Co., Ltd
> 05ac:8502 Apple Computer, Inc.
> 064e:a110 Suyin Corp.
> 0ac8:332d Z-Star Microelectronics Corp.
> 0ac8:3343 Z-Star Microelectronics Corp.
> 0ad2:933d Service & Quality Technology Co., Ltd
> 0c45:62e0 Microdia
> 0c45:63e0 Microdia
> 145f:013e Unknown
> 145f:013f
> 174f:5931 Syntek
> 174f:5a31
> 174f:8a33
> 1871:0306
> 1c4f:3000
> 1cac:a332
> 1cac:b288
> 5986:0104 Bison
> 5986:0200
> 5986:0202 Bison
> 5986:0240 Bison
> 5986:0300
> 5986:0303 Bison
> I don't know of any camera supporting still image capture method 3.

I want to know what is method 0. I think that it's when webcam hasn't
any button => no interruption point. Is it true?

I will use this list for buy a good webcam for do this work. How can I
be the developer of "Still Image" methods? The most interesting for me
is the method 2.

>> ? Clock: I can see an example in documentation of UVC 1.1 (Class and
>> FAQ)  with clock reference, but it's only a unique (and duplicated)
>> example with stream payload.
>
> See section 2.4.3.4 in the UVC 1.1 specification.

I'll read this section in this weekend.

>> ? UVC stub: My mentor is thinking about have a software UVC (like
>> mac80211 for wifi devices) that show you usb trams. It can be
>> interesting for learning and for debugging.
>
> I'm not sure to understand. Could you please elaborate ?

My mentor is interesting in get a "software" USB device for get the
information of USB trams (USB controller <-> USB device). Like
mac80211 Test Driver (
http://kernelnewbies.org/KernelProjects/Mac80211TestDriver ) but for
UVC.

> Best regards,
>
> Laurent Pinchart

Good bye
Palmax

From zarrabeitia at gmail.com  Fri Nov 14 18:48:31 2008
From: zarrabeitia at gmail.com (zarrabeitia at gmail.com)
Date: Fri, 14 Nov 2008 12:48:31 -0500
Subject: [Linux-uvc-devel] Acer Crystal Eye WebCam (064e:a101 Suyin Corp.):
	Now it works, now it doesn't
Message-ID: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>

I have a crystal eye webcam (064e:a101 Suyin Corp.) with my Acer
Aspire 5920 webcam. I'm experiencing the problem mentioned in this
thread:

https://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003568.html

(first time it doesn't work, but turns on the light, second time it
works, then it doesn't, then it works...)

Applying that patch to my ubuntu's 8.10 kernel (2.6.27) made the
webcam work everytime, at least with luvcview. (I still get some
freezes with 'cheese', though). But there is no mention on the thread
if that patch is going to be integrated with the trunk, or if it is
harmful. So, this mail is to ask, what's the status of that patch? It
seems to work for me.

Or, how can I help with the testing at least?

(we have three acer laptops of the same model, with 'crystal eye'
webcams. Only one is having this problem).


From sparks.m at gmail.com  Fri Nov 14 21:37:12 2008
From: sparks.m at gmail.com (Michael Sparks)
Date: Fri, 14 Nov 2008 20:37:12 +0000
Subject: [Linux-uvc-devel] Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.): Now it works, now it doesn't
In-Reply-To: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>
References: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>
Message-ID: <200811142037.13808.sparks.m@gmail.com>

On Friday 14 November 2008 17:48:31 zarrabeitia at gmail.com wrote:
> I have a crystal eye webcam (064e:a101 Suyin Corp.) with my Acer
> Aspire 5920 webcam. I'm experiencing the problem mentioned in this
> thread:
>
> https://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003568.html
>
> (first time it doesn't work, but turns on the light, second time it
> works, then it doesn't, then it works...)
>
> Applying that patch to my ubuntu's 8.10 kernel (2.6.27) made the
> webcam work everytime, at least with luvcview. (I still get some
> freezes with 'cheese', though). But there is no mention on the thread
> if that patch is going to be integrated with the trunk, or if it is
> harmful. So, this mail is to ask, what's the status of that patch? It
> seems to work for me.
>
> Or, how can I help with the testing at least?

You already have done - I've been using this with 2.6.22.18-vendorpatched 
since I made my original post, but I have not had a chance to test with a 
recent kernel. (Life's been crazy busy...)

I've been using this happily however in:
   * Skype
   * luvcview
   * Pygame's experimental camera support

As noted though, I haven't been able to test with a more recent kernel due to 
a lack of sufficient time, but I think your experience above matches mine. 
(I've not got the "cheese" application, so I don't know if that's an issue 
localised to you or not)

Regards,


Michael.
-- 
http://yeoldeclue.com/blog
http://www.kamaelia.org/Home


From kharris at stoic.net  Sat Nov 15 02:24:34 2008
From: kharris at stoic.net (kharris at stoic.net)
Date: 15 Nov 2008 01:24:34 -0000
Subject: [Linux-uvc-devel] MJPEG capture on QC 9000
Message-ID: <20081115012434.11488.qmail@stoic.net>


	People:

	I need to record video from a Logitech 9000 to a file.  Can you recommend some software that does this?

	I'd like to record MJPEG format.

	I have 2 projects that need this.  One would benefit from recording sound as well.  The other would benefit from being able to record from 2 or 3 cameras at the same time (without sound).

	Thanks.



From mathew at jm.cahaya.com.au  Sat Nov 15 12:18:59 2008
From: mathew at jm.cahaya.com.au (Mathew Pole)
Date: Sat, 15 Nov 2008 21:48:59 +1030
Subject: [Linux-uvc-devel] 04f2:b106 Chicony Electronics Co., Ltd
Message-ID: <491EB023.7010604@jm.cahaya.com.au>

Hi ,

This web cam wasn't listed on http://linux-uvc.berlios.de/, so as
requested I'm emailing details to the list:

lsusb reports it as 04f2:b106 Chicony Electronics Co., Ltd
It is a 2MP laptop integrated into the Asus G71V laptop.

This is the (hopefully) relevant sections of output from dmesg:
[   13.909428] sdhci: Secure Digital Host Controller Interface driver
[   13.909430] sdhci: Copyright(c) Pierre Ossman
[   13.928972] Linux video capture interface: v2.00
[   13.932054] sdhci-pci 0000:09:01.1: SDHCI controller found
[1180:0822] (rev 22)
[   13.932072] sdhci-pci 0000:09:01.1: PCI INT B -> GSI 17 (level, low)
-> IRQ 17
[   13.933079] sdhci-pci 0000:09:01.1: Will use DMA mode even though HW
doesn't fully claim to support it.
[   13.935122] mmc0: SDHCI controller on PCI [0000:09:01.1] using DMA
[   14.038731] iwlagn: Intel(R) Wireless WiFi Link AGN driver for Linux,
1.3.27ks
[   14.038733] iwlagn: Copyright(c) 2003-2008 Intel Corporation
[   14.038867] iwlagn 0000:03:00.0: PCI INT A -> GSI 17 (level, low) ->
IRQ 17
[   14.038895] iwlagn 0000:03:00.0: setting latency timer to 64
[   14.038957] iwlagn: Detected Intel Wireless WiFi Link 5100AGN REV=0x54
[   14.071478] iwlagn: Tunable channels: 13 802.11bg, 24 802.11a channels
[   14.071812] iwlagn 0000:03:00.0: PCI INT A disabled
[   14.072125] phy0: Selected rate control algorithm 'iwl-agn-rs'
[   14.090059] uvcvideo: Found UVC 1.00 device CNF7246 (04f2:b106)
[   14.097154] input: CNF7246 as
/devices/pci0000:00/0000:00:1d.7/usb8/8-5/8-5:1.0/input/input10
[   14.112651] usbcore: registered new interface driver uvcvideo
[   14.112655] USB Video Class driver (v0.1.0)
[   14.530694] Synaptics Touchpad, model: 1, fw: 6.5, id: 0x1c0b1, caps:
0xa04711/0xa00000


I was able to make the web cam work with the following command line in
Ubuntu 8.10
luvcview -f yuv

Please note that this laptop also has an integrated DVB tuner. The
relevant id for that is 1164:1f08 YUAN High-Tech Development Co., Ltd.

Regards,
    Mathew



From laurent.pinchart at skynet.be  Sat Nov 15 13:32:40 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 15 Nov 2008 13:32:40 +0100
Subject: [Linux-uvc-devel] 04f2:b106 Chicony Electronics Co., Ltd
In-Reply-To: <491EB023.7010604@jm.cahaya.com.au>
References: <491EB023.7010604@jm.cahaya.com.au>
Message-ID: <200811151332.40426.laurent.pinchart@skynet.be>

Hi Mathew,

On Saturday 15 November 2008, Mathew Pole wrote:
> Hi ,
>
> This web cam wasn't listed on http://linux-uvc.berlios.de/, so as
> requested I'm emailing details to the list:

Thanks for the report.

> lsusb reports it as 04f2:b106 Chicony Electronics Co., Ltd
> It is a 2MP laptop integrated into the Asus G71V laptop.

Could you please send me the output of lsusb -v ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Nov 15 13:40:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 15 Nov 2008 13:40:11 +0100
Subject: [Linux-uvc-devel] MJPEG capture on QC 9000
In-Reply-To: <20081115012434.11488.qmail@stoic.net>
References: <20081115012434.11488.qmail@stoic.net>
Message-ID: <200811151340.12033.laurent.pinchart@skynet.be>

Hi,

On Saturday 15 November 2008, kharris at stoic.net wrote:
> People:
>
> I need to record video from a Logitech 9000 to a file.  Can you recommend
> some software that does this?

uvccapture comes to mind. See 
http://www.quickcamteam.net/software/linux/v4l2-software/ for a non 
exhaustive list of V4L2 software.

> I'd like to record MJPEG format.
>
> I have 2 projects that need this.  One would benefit from recording sound
> as well.  The other would benefit from being able to record from 2 or 3
> cameras at the same time (without sound).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Nov 15 13:47:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 15 Nov 2008 13:47:11 +0100
Subject: [Linux-uvc-devel] Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.): Now it works, now it doesn't
In-Reply-To: <200811142037.13808.sparks.m@gmail.com>
References: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>
	<200811142037.13808.sparks.m@gmail.com>
Message-ID: <200811151347.11770.laurent.pinchart@skynet.be>

On Friday 14 November 2008, Michael Sparks wrote:
> On Friday 14 November 2008 17:48:31 zarrabeitia at gmail.com wrote:
> > I have a crystal eye webcam (064e:a101 Suyin Corp.) with my Acer
> > Aspire 5920 webcam. I'm experiencing the problem mentioned in this
> > thread:
> >
> > https://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003568.html
> >
> > (first time it doesn't work, but turns on the light, second time it
> > works, then it doesn't, then it works...)
> >
> > Applying that patch to my ubuntu's 8.10 kernel (2.6.27) made the
> > webcam work everytime, at least with luvcview. (I still get some
> > freezes with 'cheese', though). But there is no mention on the thread
> > if that patch is going to be integrated with the trunk, or if it is
> > harmful. So, this mail is to ask, what's the status of that patch? It
> > seems to work for me.
> >
> > Or, how can I help with the testing at least?
>
> You already have done - I've been using this with 2.6.22.18-vendorpatched
> since I made my original post, but I have not had a chance to test with a
> recent kernel. (Life's been crazy busy...)
>
> I've been using this happily however in:
>    * Skype
>    * luvcview
>    * Pygame's experimental camera support
>
> As noted though, I haven't been able to test with a more recent kernel due
> to a lack of sufficient time, but I think your experience above matches
> mine. (I've not got the "cheese" application, so I don't know if that's an
> issue localised to you or not)

I've recently committed a patch that might fix this issue. Would one of you be 
able to test the last version of the driver (available on linuxtv.org, see 
linux-uvc.berlios.de for download instructions) ?

Best regards,

Laurent Pinchart


From mathew at jm.cahaya.com.au  Sat Nov 15 14:34:11 2008
From: mathew at jm.cahaya.com.au (Mathew Pole)
Date: Sun, 16 Nov 2008 00:04:11 +1030
Subject: [Linux-uvc-devel] 04f2:b106 Chicony Electronics Co., Ltd
In-Reply-To: <200811151332.40426.laurent.pinchart@skynet.be>
References: <491EB023.7010604@jm.cahaya.com.au>
	<200811151332.40426.laurent.pinchart@skynet.be>
Message-ID: <491ECFD3.3050707@jm.cahaya.com.au>

Hi Laurent,

Laurent Pinchart wrote:
> Hi Mathew,
>
> On Saturday 15 November 2008, Mathew Pole wrote:
>   
>> Hi ,
>>
>> This web cam wasn't listed on http://linux-uvc.berlios.de/, so as
>> requested I'm emailing details to the list:
>>     
>
> Thanks for the report.
>   
>> lsusb reports it as 04f2:b106 Chicony Electronics Co., Ltd
>> It is a 2MP laptop integrated into the Asus G71V laptop.
>>     
>
> Could you please send me the output of lsusb -v ?
>
>   
As requested, this is the output of sudo lsusb -vd 04f2:b106
If I can be of any further assistance, please let me know.

Regards,
    Mathew


Bus 008 Device 003: ID 04f2:b106 Chicony Electronics Co., Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04f2 Chicony Electronics Co., Ltd
  idProduct          0xb106
  bcdDevice           18.07
  iManufacturer           2 Chicony Electronics Co., Ltd
  iProduct                1 CNF7246
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          829
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              168mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               5 USB2.0 2.0M UVC WebCam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              5 USB2.0 2.0M UVC WebCam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000177f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      583
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 0
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                8
        guidFormat                           
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  6144000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  2027520
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  1536000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   506880
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   384000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                  9600000
        dwMaxBitRate                 19200000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         500000
        bFrameIntervalType                  2
        dwFrameInterval( 0)            500000
        dwFrameInterval( 1)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                 19660800
        dwMaxBitRate                 19660800
        dwMaxVideoFrameBufferSize     2457600
        dwDefaultFrameInterval        1250000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1250000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                 19200000
        dwMaxBitRate                 19200000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        2
        bNumFrameDescriptors                8
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  2304000
        dwMaxBitRate                  2304000
        dwMaxVideoFrameBufferSize       76800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   760320
        dwMaxBitRate                   760320
        dwMaxVideoFrameBufferSize       25344
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   576000
        dwMaxBitRate                   576000
        dwMaxVideoFrameBufferSize       19200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   190080
        dwMaxBitRate                   190080
        dwMaxVideoFrameBufferSize        6336
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   144000
        dwMaxBitRate                   144000
        dwMaxVideoFrameBufferSize        4800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                  3600000
        dwMaxBitRate                  3600000
        dwMaxVideoFrameBufferSize      120000
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                  4608000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                  7200000
        dwMaxBitRate                  7200000
        dwMaxVideoFrameBufferSize      480000
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled



From juhovh at iki.fi  Sat Nov 15 15:57:02 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Sat, 15 Nov 2008 22:57:02 +0800
Subject: [Linux-uvc-devel] About compiling the driver from repository
Message-ID: <C7DAA12F-CB8C-46E8-BA07-605A5BE1C085@iki.fi>

Hi,

I hope I'm not disturbing too much, but I tried to compile the driver  
after a break again, since I wanted to also port my one patch to the  
latest repository. However I have a slight problem with  
dependencies... I can load v4l2-common.ko just fine, but trying to  
load v4l2-compat-ioctl32.ko or videodev.ko both end up with error  
about "Unknown symbol v4l_printk_ioctl" and I therefore can't get  
uvcvideo loaded either.

The kernel I'm using is from Ubuntu repositories 2.6.24-21-generic  
and if I install and run depmod and stuff it doesn't help at all  
either. I can see the function defined in v4l2-ioctl.c but I just  
can't find a module that would included it. Since compiling from the  
new repository was supposed to be relatively easy and now I'm unable  
to compile uvcvideo at all, I'm just here to ask does someone have  
some hints what I am doing wrong... Naturally last time I compiled  
uvcvideo it worked out-of-the-box without any extra modules, but  
things have changed.


Juho


-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081115/9dfbb98f/attachment.pgp>

From barsnick at gmx.net  Sat Nov 15 21:41:14 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Sat, 15 Nov 2008 21:41:14 +0100
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <491D497E.8050004@gmail.com>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
	<200811091358.11152.laurent.pinchart@skynet.be>
	<58b40ca10811090544q6957e288g252847c6005d9e45@mail.gmail.com>
	<58b40ca10811131834s90e4b37lb449741bccd2aff1@mail.gmail.com>
	<491D497E.8050004@gmail.com>
Message-ID: <20081115204114.GA29005@sunshine.barsnick.net>

Paulo, list,

On Fri, Nov 14, 2008 at 09:48:46 +0000, Paulo Assis wrote:

> http://www.quickcamteam.net/hcl/linux/logitech_device_list_v2.pdf

Wow, thanks for the great link! This is the summary I've always been
missing.

Perhaps the linux-uvc driver website should reference this document for
Logitech cams?

(I own one of the old Fusions and wish I knew exactly what to
buy to have a UVC webcam which works perfectly under Linux.)

Moritz


From zarrabeitia at gmail.com  Sun Nov 16 00:37:29 2008
From: zarrabeitia at gmail.com (zarrabeitia at gmail.com)
Date: Sat, 15 Nov 2008 18:37:29 -0500
Subject: [Linux-uvc-devel] Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.): Now it works, now it doesn't
In-Reply-To: <200811151347.11770.laurent.pinchart@skynet.be>
References: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>
	<200811142037.13808.sparks.m@gmail.com>
	<200811151347.11770.laurent.pinchart@skynet.be>
Message-ID: <44e44e510811151537k75146a81kf4cdc2c0f7b99b17@mail.gmail.com>

On 11/15/08, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> I've recently committed a patch that might fix this issue. Would one of you
> be
> able to test the last version of the driver (available on linuxtv.org, see
> linux-uvc.berlios.de for download instructions) ?

I'll do it, however... I can't find the download link (blush). The
linux-uvc.berlios.de suggest to download a mercurial clone [for
developers] or to grab a .tgz from
http://linuxtv.org/hg/~pinchartl/uvcvideo/. There is one .tgz and one
.tar.bz2 over there, but they are amazingly big... after 5 hours of
download (and 7 megabytes downloaded), I had to cancel. ??How do I
checkout the head only? (I've never used mercurial before).

Saludos, y gracias!

Luis Zarrabeitia.


From laurent.pinchart at skynet.be  Sun Nov 16 12:34:30 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 16 Nov 2008 12:34:30 +0100
Subject: [Linux-uvc-devel] Controls on Logitech QuickCam Pro 9000
In-Reply-To: <20081115204114.GA29005@sunshine.barsnick.net>
References: <58b40ca10811060459r5bec5c7dvaeea5e35b7f00c48@mail.gmail.com>
	<491D497E.8050004@gmail.com>
	<20081115204114.GA29005@sunshine.barsnick.net>
Message-ID: <200811161234.31038.laurent.pinchart@skynet.be>

Hi Moritz,

On Saturday 15 November 2008, Moritz Barsnick wrote:
> Paulo, list,
>
> On Fri, Nov 14, 2008 at 09:48:46 +0000, Paulo Assis wrote:
> > http://www.quickcamteam.net/hcl/linux/logitech_device_list_v2.pdf
>
> Wow, thanks for the great link! This is the summary I've always been
> missing.
>
> Perhaps the linux-uvc driver website should reference this document for
> Logitech cams?

Thanks for the suggestion. I've updated the website.

> (I own one of the old Fusions and wish I knew exactly what to
> buy to have a UVC webcam which works perfectly under Linux.)

Best regards,

Laurent Pinchart


From maurograuso at gmail.com  Sun Nov 16 12:45:58 2008
From: maurograuso at gmail.com (Mauro Grauso)
Date: Sun, 16 Nov 2008 12:45:58 +0100
Subject: [Linux-uvc-devel] Quickam E 3500 plus and auto exposure
Message-ID: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>

Hi,

I've just got a Logitech QuickCam E 3500 Plus (046d:09a4) that is an
UVC device and is supported by the UVC kernel module. I'm under
Kubuntu 8.10, kernel 2.6.27-8-generic #1 SMP.

The problem is about the framerate, and specifically with the auto
exposure feature of the camera. Basically when there's not enough
light the camera is compensating (very well actually) and the
framerate drops to 3fps, when there's daylight it still compensate and
the framerate is about 15/20fps (@640x480).

The odd thing is that sometimes (but I haven't been able to reproduce
it) the camera just doesn't use the auto exposure feature when I plug
it in and, even if the image is darker, I get constant 30fps.

Now I would really like to know how to turn off and on the auto
exposure and white balance feature of the camera from the driver. If I
try to turn off the auto exposure from the luvcview interface, I get
"Set Auto Exposure off error" in the standard error.

For the record, when I plug the camera, syslog says:
Nov 15 14:28:27 greywolf kernel: [11314.937051] usb 1-2: new high
speed USB device using ehci_hcd and address 7
Nov 15 14:28:28 greywolf kernel: [11315.178592] usb 1-2: configuration
#1 chosen from 1 choice
Nov 15 14:28:28 greywolf kernel: [11315.178862] uvcvideo: Found UVC
1.00 device <unnamed> (046d:09a4)
Nov 15 14:28:28 greywolf kernel: [11315.209087] input: UVC Camera
(046d:09a4) as /devices/pci0000:00/0000:00:02.1/usb1/1-2/1-2:1.0/input/input9
Nov 15 14:28:29 greywolf kernel: [11316.213276] 7:3:1: cannot get freq
at ep 0x86

Notice the last line!

Sometimes the last line is slightly different, as follows:
Nov 15 14:39:34 greywolf kernel: [11981.793172] 9:3:1: cannot set freq
16000 to ep 0x86

And sometimes (often, but not always!) I also get the following in
syslog when I plug the cam, but the error doesn't stop the cam from
working:
Nov 15 14:39:34 greywolf kernel: [11981.960176] uvcvideo: Failed to
query (1) UVC control 1 (unit 0) : -110 (exp. 26).

Maybe the last line is about the snapshot button that is on the
camera? Anyways the camera works even if I get these "soft" errors in
syslog.

Help would be really appreciated. Thanks a lot to everybody.

Mauro


From laurent.pinchart at skynet.be  Sun Nov 16 12:50:08 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 16 Nov 2008 12:50:08 +0100
Subject: [Linux-uvc-devel] Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.): Now it works, now it doesn't
In-Reply-To: <44e44e510811151537k75146a81kf4cdc2c0f7b99b17@mail.gmail.com>
References: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>
	<200811151347.11770.laurent.pinchart@skynet.be>
	<44e44e510811151537k75146a81kf4cdc2c0f7b99b17@mail.gmail.com>
Message-ID: <200811161250.08748.laurent.pinchart@skynet.be>

Hi Luis,

On Sunday 16 November 2008, zarrabeitia at gmail.com wrote:
> On 11/15/08, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > I've recently committed a patch that might fix this issue. Would one of
> > you be able to test the last version of the driver (available on
> > linuxtv.org, see linux-uvc.berlios.de for download instructions) ?
>
> I'll do it, however... I can't find the download link (blush). The
> linux-uvc.berlios.de suggest to download a mercurial clone [for
> developers] or to grab a .tgz from
> http://linuxtv.org/hg/~pinchartl/uvcvideo/. There is one .tgz and one
> .tar.bz2 over there, but they are amazingly big... after 5 hours of
> download (and 7 megabytes downloaded), I had to cancel. ??How do I
> checkout the head only? (I've never used mercurial before).

I'm not sure how you managed to download 7 MBs. The tarball generation script 
might have had an issue. Here's what I get today:

tip.tar.bz2	2,954,254	71.1K/s  in 39s
tip.tar.gz	3,664,438	114K/s   in 38s

If you want to clone the Mercurial repository, you will need to install 
Mercurial and run

hg clone http://linuxtv.org/hg/~pinchartl/uvcvideo/

Please note that this will download a copy of the whole repository and will 
definitely not save space or bandwidth. You will save bandwidth only when 
updating to the latest driver, as Mercurial will then only download 
incremental changes.

Best regards,

Laurent Pinchart


From lists at brachttal.net  Sun Nov 16 12:55:32 2008
From: lists at brachttal.net (Andreas Volz)
Date: Sun, 16 Nov 2008 12:55:32 +0100
Subject: [Linux-uvc-devel] Audio slow
Message-ID: <20081116125532.6a22a691@frodo.mittelerde>

Hello,

my brother has a "Bus 001 Device 002: ID 046d:0992 Logitech, Inc."
webcam. According to the website it's fully compatible with uvcvideo.
The webcam works well and also skype is showing a (slow) video. It's
not that fast but anyway it works.

More a problem is that the audio is not fluid and so not really
usable. It sounds a little broken and sometime I hear only half words.

He has a 800 Mzh PC running Ubuntu Linux. Graphic card is a Nvidia TNT
2 with driver "nv". So my question is if you think that PC is fast
enough for realtime audio and video? Or is it maybe a performance
problem? The computers CPU while using skype is around 70%.

Any ideas how to find the problem?

regards
Andreas


From laurent.pinchart at skynet.be  Sun Nov 16 13:15:03 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 16 Nov 2008 13:15:03 +0100
Subject: [Linux-uvc-devel] About compiling the driver from repository
In-Reply-To: <C7DAA12F-CB8C-46E8-BA07-605A5BE1C085@iki.fi>
References: <C7DAA12F-CB8C-46E8-BA07-605A5BE1C085@iki.fi>
Message-ID: <200811161315.04026.laurent.pinchart@skynet.be>

Hi Juho,

On Saturday 15 November 2008, Juho V?h?-Herttua wrote:
> Hi,
>
> I hope I'm not disturbing too much, but I tried to compile the driver
> after a break again, since I wanted to also port my one patch to the
> latest repository. However I have a slight problem with
> dependencies... I can load v4l2-common.ko just fine, but trying to
> load v4l2-compat-ioctl32.ko or videodev.ko both end up with error
> about "Unknown symbol v4l_printk_ioctl" and I therefore can't get
> uvcvideo loaded either.
>
> The kernel I'm using is from Ubuntu repositories 2.6.24-21-generic
> and if I install and run depmod and stuff it doesn't help at all
> either. I can see the function defined in v4l2-ioctl.c but I just
> can't find a module that would included it.

v4l2-ioctl.c is compiled into the videodev.ko module.

> Since compiling from the new repository was supposed to be relatively easy
> and now I'm unable to compile uvcvideo at all, I'm just here to ask does
> someone have some hints what I am doing wrong... Naturally last time I
> compiled uvcvideo it worked out-of-the-box without any extra modules, but
> things have changed.

I sense some bitterness here ;-) I'll try to help you (please remember I'm 
quite new to v4l trees as well, so this might require a few iterations).

The most usual source of dependency errors when installing v4l from sources is 
old modules lying around in /lib/modules/`uname -r`/. Could you try to 
manually move them out of the way ? If I remember well Ubuntu installs 
in-tree modules in /lib/modules/`uname -r`/kernel and out-of-tree modules 
in /lib/modules/`uname -r`/ubuntu, so make sure you look into both locations 
for v4l modules.

You could also try to load the new modules with insmod. You will have to 
resolve dependencies yourself (i.e. load the modules in the correct order), 
but you will be able to make sure the new modules are loaded and not some old 
ones lying around in a corner. This might give you some interesting hints.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Nov 16 15:07:47 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 16 Nov 2008 15:07:47 +0100
Subject: [Linux-uvc-devel] Quickam E 3500 plus and auto exposure
In-Reply-To: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
Message-ID: <200811161507.47643.laurent.pinchart@skynet.be>

Hi Mauro,

On Sunday 16 November 2008, Mauro Grauso wrote:
> Hi,
>
> I've just got a Logitech QuickCam E 3500 Plus (046d:09a4) that is an
> UVC device and is supported by the UVC kernel module. I'm under
> Kubuntu 8.10, kernel 2.6.27-8-generic #1 SMP.
>
> The problem is about the framerate, and specifically with the auto
> exposure feature of the camera. Basically when there's not enough
> light the camera is compensating (very well actually) and the
> framerate drops to 3fps, when there's daylight it still compensate and
> the framerate is about 15/20fps (@640x480).

That's quite usual with webcams. Cheap mass market CMOS sensors are not very 
light sensitive and perform quite bad under low light conditions. Increasing 
the exposure time automatically helps but at the cost of image quality (more 
noise, blurry images, ...).

> The odd thing is that sometimes (but I haven't been able to reproduce
> it) the camera just doesn't use the auto exposure feature when I plug
> it in and, even if the image is darker, I get constant 30fps.

That's indeed weird. Auto-exposure should be enabled. How many times have you 
encountered the issue ?

> Now I would really like to know how to turn off and on the auto
> exposure and white balance feature of the camera from the driver. If I
> try to turn off the auto exposure from the luvcview interface, I get
> "Set Auto Exposure off error" in the standard error.

Your luvcview version might be outdated. Could you try the latest one 
(available from quickcamteam.net) or the uvcdynctrl command line tool (from 
the libwebcam package available on the same website) ?

> For the record, when I plug the camera, syslog says:
> Nov 15 14:28:27 greywolf kernel: [11314.937051] usb 1-2: new high
> speed USB device using ehci_hcd and address 7
> Nov 15 14:28:28 greywolf kernel: [11315.178592] usb 1-2: configuration
> #1 chosen from 1 choice
> Nov 15 14:28:28 greywolf kernel: [11315.178862] uvcvideo: Found UVC
> 1.00 device <unnamed> (046d:09a4)
> Nov 15 14:28:28 greywolf kernel: [11315.209087] input: UVC Camera
> (046d:09a4) as
> /devices/pci0000:00/0000:00:02.1/usb1/1-2/1-2:1.0/input/input9 Nov 15
> 14:28:29 greywolf kernel: [11316.213276] 7:3:1: cannot get freq at ep 0x86
>
> Notice the last line!
>
> Sometimes the last line is slightly different, as follows:
> Nov 15 14:39:34 greywolf kernel: [11981.793172] 9:3:1: cannot set freq
> 16000 to ep 0x86

That's a usbaudio issue. Although not directly related to the video part, a 
problem in the webcam audio implementation can of course influence video. I 
wouldn't worry about it too much for now.

> And sometimes (often, but not always!) I also get the following in
> syslog when I plug the cam, but the error doesn't stop the cam from
> working:
> Nov 15 14:39:34 greywolf kernel: [11981.960176] uvcvideo: Failed to
> query (1) UVC control 1 (unit 0) : -110 (exp. 26).

I don't like that one, it reminds me of the Logitech firmware bug that is not 
supposed to happen with that camera :-/

> Maybe the last line is about the snapshot button that is on the
> camera?

No, they are unrelated.

> Anyways the camera works even if I get these "soft" errors in syslog.

I would have thought the last error ("Failed to query...") would prevent the 
driver from initialising the camera properly. Could you please show me all 
messages printed by the driver to the kernel log when the problem occurs ?

> Help would be really appreciated. Thanks a lot to everybody.

Best regards,

Laurent Pinchart


From maurograuso at gmail.com  Sun Nov 16 16:25:02 2008
From: maurograuso at gmail.com (Mauro Grauso)
Date: Sun, 16 Nov 2008 16:25:02 +0100
Subject: [Linux-uvc-devel] Quickam E 3500 plus and auto exposure
In-Reply-To: <200811161507.47643.laurent.pinchart@skynet.be>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<200811161507.47643.laurent.pinchart@skynet.be>
Message-ID: <bc6dd08a0811160725t5cae9f4atf3fb07e54ac5601e@mail.gmail.com>

Hi Laurent,

First of all thanks for the reply and the support.

>> Basically when there's not enough
>> light the camera is compensating (very well actually) and the
>> framerate drops to 3fps, when there's daylight it still compensate and
>> the framerate is about 15/20fps (@640x480).
>
> That's quite usual with webcams. Cheap mass market CMOS sensors are not very
> light sensitive and perform quite bad under low light conditions. Increasing
> the exposure time automatically helps but at the cost of image quality (more
> noise, blurry images, ...).

I can confirm that to you. With low light I still get a very good
picture, but the framerate is terribly low (the light compensation
doesn't seem to affect image quality that is always quite good).

>> The odd thing is that sometimes (but I haven't been able to reproduce
>> it) the camera just doesn't use the auto exposure feature when I plug
>> it in and, even if the image is darker, I get constant 30fps.
>
> That's indeed weird. Auto-exposure should be enabled. How many times have you
> encountered the issue ?

I've had this camera for only a few days, but this inconsistent
behaviour showed up only once or twice. Do you know if this camera has
any eprom to save settings? Is it possible that softwares (I tried
skype, mplayer and luvcview) overwrite camera's defaults to put their
settings? This would explain the unconsistent behaviour.

>> Now I would really like to know how to turn off and on the auto
>> exposure and white balance feature of the camera from the driver. If I
>> try to turn off the auto exposure from the luvcview interface, I get
>> "Set Auto Exposure off error" in the standard error.
>
> Your luvcview version might be outdated. Could you try the latest one
> (available from quickcamteam.net) or the uvcdynctrl command line tool (from
> the libwebcam package available on the same website) ?

I'm using luvcview 0.2.4 (latest luvcview ubuntu package).

I compiled the latest uvcdynctrl (0.2) and here is some output:
./uvcdynctrl-0.2 -l
[libwebcam] Unknown V4L2 control ID encountered: 10094849
[libwebcam] Unknown V4L2 control ID encountered: 10094850
[libwebcam] Unknown V4L2 control ID encountered: 10094851
Listing available devices:
  video0   UVC Camera (046d:09a4)


./uvcdynctrl-0.2 -c
[libwebcam] Unknown V4L2 control ID encountered: 10094849
[libwebcam] Unknown V4L2 control ID encountered: 10094850
[libwebcam] Unknown V4L2 control ID encountered: 10094851
Listing available controls for device video0:
  Exposure, Auto Priority
  Exposure (Absolute)
  Exposure, Auto
  Backlight Compensation
  Sharpness
  White Balance Temperature
  Power Line Frequency
  Gain
  White Balance Temperature, Auto
  Saturation
  Contrast
  Brightness


./uvcdynctrl-0.2 -cv
[libwebcam] Unknown V4L2 control ID encountered: 10094849
[libwebcam] Unknown V4L2 control ID encountered: 10094850
[libwebcam] Unknown V4L2 control ID encountered: 10094851
Listing available controls for device video0:
  Exposure, Auto Priority
    ID      : 0x00000000,
    Type    : Boolean,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 1, step size: 1 ],
    Default : 0
  Exposure (Absolute)
    ID      : 0x00000000,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 1 .. 10000, step size: 1 ],
    Default : 166
  Exposure, Auto
    ID      : 0x00000000,
    Type    : Choice,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : { 'Auto Mode'[0], 'Manual Mode'[1], 'Shutter Priority
Mode'[2], 'Aperture Priority Mode'[3] },
    Default : 3
  Backlight Compensation
    ID      : 0x0000101c,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 2, step size: 1 ],
    Default : 1
  Sharpness
    ID      : 0x0000101b,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 255, step size: 1 ],
    Default : 240
  White Balance Temperature
    ID      : 0x0000101a,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 10000, step size: 10 ],
    Default : 4000
  Power Line Frequency
    ID      : 0x00001018,
    Type    : Choice,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : { 'Disabled'[0], '50 Hz'[1], '60 Hz'[2] },
    Default : 2
  Gain
    ID      : 0x00000003,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 255, step size: 1 ],
    Default : 0
  White Balance Temperature, Auto
    ID      : 0x00000009,
    Type    : Boolean,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 1, step size: 1 ],
    Default : 1
  Saturation
    ID      : 0x00000004,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 255, step size: 1 ],
    Default : 32
  Contrast
    ID      : 0x00000002,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 255, step size: 1 ],
    Default : 32
  Brightness
    ID      : 0x00000001,
    Type    : Dword,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : [ 0 .. 255, step size: 1 ],
    Default : 128

>> And sometimes (often, but not always!) I also get the following in
>> syslog when I plug the cam, but the error doesn't stop the cam from
>> working:
>> Nov 15 14:39:34 greywolf kernel: [11981.960176] uvcvideo: Failed to
>> query (1) UVC control 1 (unit 0) : -110 (exp. 26).
>
> I don't like that one, it reminds me of the Logitech firmware bug that is not
> supposed to happen with that camera :-/

The strange thing is that I usually get this line in syslog only if I
unplug and then replug the camera. the first time I plug it on a clean
boot it doesn't show up.

>> Anyways the camera works even if I get these "soft" errors in syslog.
>
> I would have thought the last error ("Failed to query...") would prevent the
> driver from initialising the camera properly. Could you please show me all
> messages printed by the driver to the kernel log when the problem occurs ?

Ok let's assume that the problem is always present, as the auto
exposure is usually default to on. I made a clean boot of my pc and on
first connection of the camera I get the following syslog:

Nov 16 15:53:10 greywolf kernel: [19593.956048] usb 2-1: new high
speed USB device using ehci_hcd and address 6
Nov 16 15:53:10 greywolf kernel: [19594.199827] usb 2-1: configuration
#1 chosen from 1 choice
Nov 16 15:53:11 greywolf kernel: [19594.799199] Linux video capture
interface: v2.00
Nov 16 15:53:11 greywolf kernel: [19594.877731] uvcvideo: Found UVC
1.00 device <unnamed> (046d:09a4)
Nov 16 15:53:11 greywolf kernel: [19594.892850] input: UVC Camera
(046d:09a4) as /devices/pci0000:00/0000:00:02.1/usb2/2-1/2-1:1.0/input/input7
Nov 16 15:53:11 greywolf kernel: [19594.895354] usbcore: registered
new interface driver snd-usb-audio
Nov 16 15:53:11 greywolf kernel: [19594.896082] usbcore: registered
new interface driver uvcvideo
Nov 16 15:53:11 greywolf kernel: [19594.896089] USB Video Class driver (v0.1.0)

now if I launch luvcview I get a good picture but low framerate (auto
exposure on). Important: I can also confirm that the settings are
saved somewhere because last time I plugged the webcam I tried it with
kopete, and it did screw all the settings giving an awful picture.
Plugging the cam now I got the same crappy output (till I clicked on
"reset to defaults" switch in luvcview).

If I click on "auto exposure off" I still get "Set Auto Exposure off
error" in stderr.

If I unplug and replug the camera I get the following syslog:

Nov 16 16:00:26 greywolf kernel: [20030.102631] usb 2-1: USB
disconnect, address 6

Nov 16 16:00:40 greywolf kernel: [20043.553039] usb 2-1: new high
speed USB device using ehci_hcd and address 7
Nov 16 16:00:40 greywolf kernel: [20043.794369] usb 2-1: configuration
#1 chosen from 1 choice
Nov 16 16:00:40 greywolf kernel: [20043.794860] uvcvideo: Found UVC
1.00 device <unnamed> (046d:09a4)
Nov 16 16:00:40 greywolf kernel: [20043.828903] input: UVC Camera
(046d:09a4) as /devices/pci0000:00/0000:00:02.1/usb2/2-1/2-1:1.0/input/input8
Nov 16 16:00:41 greywolf kernel: [20044.857100] 7:3:1: cannot set freq
16000 to ep 0x86
Nov 16 16:00:41 greywolf kernel: [20045.072108] uvcvideo: Failed to
query (1) UVC control 1 (unit 0) : -110 (exp. 26).
Nov 16 16:00:42 greywolf kernel: [20045.521117] uvcvideo: Failed to
query (1) UVC control 1 (unit 0) : -32 (exp. 26).
Nov 16 16:00:43 greywolf kernel: [20046.521233] uvcvideo: Failed to
query (1) UVC control 1 (unit 0) : -110 (exp. 26).
Nov 16 16:00:44 greywolf kernel: [20047.520218] uvcvideo: Failed to
query (1) UVC control 1 (unit 0) : -110 (exp. 26).

when luvcview runs it uses the following files (I can't see and config
file accessed unfortunately):

COMMAND     PID       USER   FD      TYPE     DEVICE     SIZE     NODE NAME
luvcview  13660      chrom  cwd       DIR        8,3      440    16997
/home/chrom/Desktop/libwebcam-0.1.1
luvcview  13660      chrom  rtd       DIR        8,2      632        2
/
luvcview  13660      chrom  txt       REG        8,2    76856   166590
/usr/bin/luvcview
luvcview  13660      chrom  DEL       REG        0,9          51216433
/SYSV00000000
luvcview  13660      chrom  DEL       REG        0,9          51183660
/SYSV00000000
luvcview  13660      chrom  mem       CHR       81,0            279320
/dev/video0
luvcview  13660      chrom  mem       REG        8,2    33152   164822
/usr/lib/libXcursor.so.1.0.2
luvcview  13660      chrom  mem       REG        8,2   254076   168440
/usr/lib/locale/en_US.utf8/LC_CTYPE
luvcview  13660      chrom  mem       REG        8,2   921214   168439
/usr/lib/locale/en_US.utf8/LC_COLLATE
luvcview  13660      chrom  mem       REG        8,2    25912   164848
/usr/lib/libXrandr.so.2.1.0
luvcview  13660      chrom  mem       REG        8,2    55772   164828
/usr/lib/libXext.so.6.4.0
luvcview  13660      chrom  mem       REG        8,2    95676   165979
/usr/lib/libxcb.so.1.0.0
luvcview  13660      chrom  mem       REG        8,2   971436   164811
/usr/lib/libX11.so.6.2.0
luvcview  13660      chrom  mem       REG        8,2    14128   164830
/usr/lib/libXfixes.so.3.1.0
luvcview  13660      chrom  mem       REG        8,2       54   168445
/usr/lib/locale/en_US.utf8/LC_NUMERIC
luvcview  13660      chrom  mem       REG        8,2     2451   168448
/usr/lib/locale/en_US.utf8/LC_TIME
luvcview  13660      chrom  mem       REG        8,2      286   168443
/usr/lib/locale/en_US.utf8/LC_MONETARY
luvcview  13660      chrom  mem       REG        8,2       52   168449
/usr/lib/locale/en_US.utf8/LC_MESSAGES/SYS_LC_MESSAGES
luvcview  13660      chrom  mem       REG        8,2       34   168446
/usr/lib/locale/en_US.utf8/LC_PAPER
luvcview  13660      chrom  mem       REG        8,2       77   168444
/usr/lib/locale/en_US.utf8/LC_NAME
luvcview  13660      chrom  mem       REG        8,2      155   168438
/usr/lib/locale/en_US.utf8/LC_ADDRESS
luvcview  13660      chrom  mem       REG        8,2       59   168447
/usr/lib/locale/en_US.utf8/LC_TELEPHONE
luvcview  13660      chrom  mem       REG        8,2       23   168442
/usr/lib/locale/en_US.utf8/LC_MEASUREMENT
luvcview  13660      chrom  mem       REG        8,2    26040   167059
/usr/lib/gconv/gconv-modules.cache
luvcview  13660      chrom  mem       REG        8,2      373   168441
/usr/lib/locale/en_US.utf8/LC_IDENTIFICATION
luvcview  13660      chrom  mem       REG        8,2    34720   162017
/lib/tls/i686/cmov/librt-2.8.90.so
luvcview  13660      chrom  mem       REG        8,2   116457   162013
/lib/tls/i686/cmov/libpthread-2.8.90.so
luvcview  13660      chrom  mem       REG        8,2    79736   165024
/usr/lib/libdirect-1.0.so.0.1.0
luvcview  13660      chrom  mem       REG        8,2    30020   165086
/usr/lib/libfusion-1.0.so.0.1.0
luvcview  13660      chrom  mem       REG        8,2   412840   165026
/usr/lib/libdirectfb-1.0.so.0.1.0
luvcview  13660      chrom  mem       REG        8,2     9676   161993
/lib/tls/i686/cmov/libdl-2.8.90.so
luvcview  13660      chrom  mem       REG        8,2   149332   161995
/lib/tls/i686/cmov/libm-2.8.90.so
luvcview  13660      chrom  mem       REG        8,2   813216   164926
/usr/lib/libasound.so.2.0.0
luvcview  13660      chrom  mem       REG        8,2  1425800   161987
/lib/tls/i686/cmov/libc-2.8.90.so
luvcview  13660      chrom  mem       REG        8,2   426488   164805
/usr/lib/libSDL-1.2.so.0.11.1
luvcview  13660      chrom  mem       REG        8,2    34352   164850
/usr/lib/libXrender.so.1.3.0
luvcview  13660      chrom  mem       REG        8,2    16628   164826
/usr/lib/libXdmcp.so.6.0.0
luvcview  13660      chrom  mem       REG        8,2     7408   164815
/usr/lib/libXau.so.6.0.0
luvcview  13660      chrom  mem       REG        8,2     5364   165975
/usr/lib/libxcb-xlib.so.0.0.0
luvcview  13660      chrom  mem       REG        8,2   113252     2342
/lib/ld-2.8.90.so
luvcview  13660      chrom    0u      CHR      136,2                 4
/dev/pts/2
luvcview  13660      chrom    1u      CHR      136,2                 4
/dev/pts/2
luvcview  13660      chrom    2u      CHR      136,2                 4
/dev/pts/2
luvcview  13660      chrom    3u     unix 0xc6ac7180            283571 socket
luvcview  13660      chrom    4u     unix 0xf568f500             17323 socket
luvcview  13660      chrom    5u     unix 0xc6ac6fc0            283573 socket
luvcview  13660      chrom    6u      CHR       81,0            279320
/dev/video0
luvcview  13660      chrom    9u     unix 0xf50fe380             17376
/tmp/ksocket-chrom/kdeinit4__0
luvcview  13660      chrom   10u     unix 0xf568f500             17323 socket
luvcview  13660      chrom   14u     unix 0xf568f500             17323 socket
luvcview  13660      chrom   17u     unix 0xf568f500             17323 socket
luvcview  13660      chrom   21u     unix 0xf568f500             17323 socket


I'm almost sure turning off auto exposure is a matter of finding out
how the cam saves its settings. It's possible that I got the smooth
output just the first time I plugged the cam in (with factory
defaults). the driver can't correctly set back the exposure value, so
the factory setting can't be restored. Also other settings that some
software changes become the default when the cam is plugged back in.

Looking forward to read your impressions.


Mauro


From laurent.pinchart at skynet.be  Sun Nov 16 16:57:58 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 16 Nov 2008 16:57:58 +0100
Subject: [Linux-uvc-devel] Quickam E 3500 plus and auto exposure
In-Reply-To: <bc6dd08a0811160725t5cae9f4atf3fb07e54ac5601e@mail.gmail.com>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<200811161507.47643.laurent.pinchart@skynet.be>
	<bc6dd08a0811160725t5cae9f4atf3fb07e54ac5601e@mail.gmail.com>
Message-ID: <200811161657.58495.laurent.pinchart@skynet.be>

Hi Mauro,

On Sunday 16 November 2008, Mauro Grauso wrote:
> Hi Laurent,
>
> First of all thanks for the reply and the support.

You're welcome.

> >> Basically when there's not enough
> >> light the camera is compensating (very well actually) and the
> >> framerate drops to 3fps, when there's daylight it still compensate and
> >> the framerate is about 15/20fps (@640x480).
> >
> > That's quite usual with webcams. Cheap mass market CMOS sensors are not
> > very light sensitive and perform quite bad under low light conditions.
> > Increasing the exposure time automatically helps but at the cost of image
> > quality (more noise, blurry images, ...).
>
> I can confirm that to you. With low light I still get a very good
> picture, but the framerate is terribly low (the light compensation
> doesn't seem to affect image quality that is always quite good).
>
> >> The odd thing is that sometimes (but I haven't been able to reproduce
> >> it) the camera just doesn't use the auto exposure feature when I plug
> >> it in and, even if the image is darker, I get constant 30fps.
> >
> > That's indeed weird. Auto-exposure should be enabled. How many times have
> > you encountered the issue ?
>
> I've had this camera for only a few days, but this inconsistent
> behaviour showed up only once or twice. Do you know if this camera has
> any eprom to save settings? Is it possible that softwares (I tried
> skype, mplayer and luvcview) overwrite camera's defaults to put their
> settings? This would explain the unconsistent behaviour.

Not that I know of. That would be too expensive.

> >> Now I would really like to know how to turn off and on the auto
> >> exposure and white balance feature of the camera from the driver. If I
> >> try to turn off the auto exposure from the luvcview interface, I get
> >> "Set Auto Exposure off error" in the standard error.
> >
> > Your luvcview version might be outdated. Could you try the latest one
> > (available from quickcamteam.net) or the uvcdynctrl command line tool
> > (from the libwebcam package available on the same website) ?
>
> I'm using luvcview 0.2.4 (latest luvcview ubuntu package).
>
> I compiled the latest uvcdynctrl (0.2) and here is some output:

I'm afraid that's outdated :-/ Could you please check the last version out 
from the SVN repository ?

> ./uvcdynctrl-0.2 -l
> [libwebcam] Unknown V4L2 control ID encountered: 10094849
> [libwebcam] Unknown V4L2 control ID encountered: 10094850
> [libwebcam] Unknown V4L2 control ID encountered: 10094851

Those warnings should disappear with the last version.

> Listing available devices:
>   video0   UVC Camera (046d:09a4)
>
>
> ./uvcdynctrl-0.2 -c
> [libwebcam] Unknown V4L2 control ID encountered: 10094849
> [libwebcam] Unknown V4L2 control ID encountered: 10094850
> [libwebcam] Unknown V4L2 control ID encountered: 10094851
> Listing available controls for device video0:
>   Exposure, Auto Priority
>   Exposure (Absolute)
>   Exposure, Auto

The controls are properly detected.

>   Backlight Compensation
>   Sharpness
>   White Balance Temperature
>   Power Line Frequency
>   Gain
>   White Balance Temperature, Auto
>   Saturation
>   Contrast
>   Brightness

[snip]

Please try to modify the exposure controls using the -s option to uvcdynctrl.

> >> And sometimes (often, but not always!) I also get the following in
> >> syslog when I plug the cam, but the error doesn't stop the cam from
> >> working:
> >> Nov 15 14:39:34 greywolf kernel: [11981.960176] uvcvideo: Failed to
> >> query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> >
> > I don't like that one, it reminds me of the Logitech firmware bug that is
> > not supposed to happen with that camera :-/
>
> The strange thing is that I usually get this line in syslog only if I
> unplug and then replug the camera. the first time I plug it on a clean
> boot it doesn't show up.
>
> >> Anyways the camera works even if I get these "soft" errors in syslog.
> >
> > I would have thought the last error ("Failed to query...") would prevent
> > the driver from initialising the camera properly. Could you please show
> > me all messages printed by the driver to the kernel log when the problem
> > occurs ?
>
> Ok let's assume that the problem is always present, as the auto
> exposure is usually default to on. I made a clean boot of my pc and on
> first connection of the camera I get the following syslog:

By problem I meant the "Failed to query..." message.

[snip ]

> now if I launch luvcview I get a good picture but low framerate (auto
> exposure on). Important: I can also confirm that the settings are
> saved somewhere because last time I plugged the webcam I tried it with
> kopete, and it did screw all the settings giving an awful picture.
> Plugging the cam now I got the same crappy output (till I clicked on
> "reset to defaults" switch in luvcview).

Set the driver trace parameter to 64 before plugging the camera (echo 64 
> /sys/modules/uvcvideo/parameters/trace). The driver will then log a message 
when an ioctl is called. Plug the camera and check if a userspace application 
invokes VIDIOC_S_CTRL to restore controls.

> If I click on "auto exposure off" I still get "Set Auto Exposure off
> error" in stderr.

Please try to set the auto exposure control with uvcdynctrl.

> If I unplug and replug the camera I get the following syslog:
>
> Nov 16 16:00:26 greywolf kernel: [20030.102631] usb 2-1: USB
> disconnect, address 6
>
> Nov 16 16:00:40 greywolf kernel: [20043.553039] usb 2-1: new high
> speed USB device using ehci_hcd and address 7
> Nov 16 16:00:40 greywolf kernel: [20043.794369] usb 2-1: configuration
> #1 chosen from 1 choice
> Nov 16 16:00:40 greywolf kernel: [20043.794860] uvcvideo: Found UVC
> 1.00 device <unnamed> (046d:09a4)
> Nov 16 16:00:40 greywolf kernel: [20043.828903] input: UVC Camera
> (046d:09a4) as
> /devices/pci0000:00/0000:00:02.1/usb2/2-1/2-1:1.0/input/input8 Nov 16
> 16:00:41 greywolf kernel: [20044.857100] 7:3:1: cannot set freq 16000 to ep
> 0x86
> Nov 16 16:00:41 greywolf kernel: [20045.072108] uvcvideo: Failed to
> query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> Nov 16 16:00:42 greywolf kernel: [20045.521117] uvcvideo: Failed to
> query (1) UVC control 1 (unit 0) : -32 (exp. 26).
> Nov 16 16:00:43 greywolf kernel: [20046.521233] uvcvideo: Failed to
> query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> Nov 16 16:00:44 greywolf kernel: [20047.520218] uvcvideo: Failed to
> query (1) UVC control 1 (unit 0) : -110 (exp. 26).

If those messages were generated from actions taken by the driver during 
device initialisation the errors would be fatal. This seems to indicate that 
a userspace application tries to access the device. Setting trace to 64 will 
confirm that.

[snip]

> I'm almost sure turning off auto exposure is a matter of finding out
> how the cam saves its settings. It's possible that I got the smooth
> output just the first time I plugged the cam in (with factory
> defaults). the driver can't correctly set back the exposure value, so
> the factory setting can't be restored. Also other settings that some
> software changes become the default when the cam is plugged back in.

I really doubt the camera includes an EEPROM to store control values (but I 
might of course be wrong). Please try to set auto-exposure off with 
uvcdynctrl. If it works the problem is probably in luvcview. If it doesn't 
we'll have a look somewhere else.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Nov 16 16:58:52 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 16 Nov 2008 16:58:52 +0100
Subject: [Linux-uvc-devel] 04f2:b106 Chicony Electronics Co., Ltd
In-Reply-To: <491ECFD3.3050707@jm.cahaya.com.au>
References: <491EB023.7010604@jm.cahaya.com.au>
	<200811151332.40426.laurent.pinchart@skynet.be>
	<491ECFD3.3050707@jm.cahaya.com.au>
Message-ID: <200811161658.53026.laurent.pinchart@skynet.be>

Hi Mathew,

On Saturday 15 November 2008, Mathew Pole wrote:
> Laurent Pinchart wrote:
> > On Saturday 15 November 2008, Mathew Pole wrote:
> >> Hi ,
> >>
> >> This web cam wasn't listed on http://linux-uvc.berlios.de/, so as
> >> requested I'm emailing details to the list:
> >
> > Thanks for the report.
> >
> >> lsusb reports it as 04f2:b106 Chicony Electronics Co., Ltd
> >> It is a 2MP laptop integrated into the Asus G71V laptop.
> >
> > Could you please send me the output of lsusb -v ?
>
> As requested, this is the output of sudo lsusb -vd 04f2:b106
> If I can be of any further assistance, please let me know.

Thanks a lot. I've updated the supported devices list on the website.

Best regards,

Laurent Pinchart


From zarrabeitia at gmail.com  Sun Nov 16 17:11:16 2008
From: zarrabeitia at gmail.com (zarrabeitia at gmail.com)
Date: Sun, 16 Nov 2008 11:11:16 -0500
Subject: [Linux-uvc-devel] Acer Crystal Eye WebCam (064e:a101 Suyin
	Corp.): Now it works, now it doesn't
In-Reply-To: <200811161250.08748.laurent.pinchart@skynet.be>
References: <44e44e510811140948r2f6a8a23o422d37a0e524bb33@mail.gmail.com>
	<200811151347.11770.laurent.pinchart@skynet.be>
	<44e44e510811151537k75146a81kf4cdc2c0f7b99b17@mail.gmail.com>
	<200811161250.08748.laurent.pinchart@skynet.be>
Message-ID: <44e44e510811160811t76361a4dl25fe2811506753b0@mail.gmail.com>

> I'm not sure how you managed to download 7 MBs. The tarball generation script
> might have had an issue. Here's what I get today:
>
> tip.tar.bz2     2,954,254       71.1K/s  in 39s
> tip.tar.gz      3,664,438       114K/s   in 38s

Weird bug, then. Well, I managed to download it this time. I removed
the previous driver (both the original and the patched), just the
uvcvideo.ko file. Then, I did a 'make && make install' on the tarball,
and rebooted...

The "now it works, now it doesn't" behaviour returned:

===
kyrie at gwaihir:~/webcam/uvcvideo-62c88b326ecd$ luvcview
luvcview 0.2.4

SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
Stream settings:
  Frame format: YUYV (MJPG is not supported by device)
  Frame size:   640x480
  Frame rate:   30 fps
Unable to start capture: Protocol error
Error grabbing
Cleanup done. Exiting ...
===

So I guess it isn't fixed yet.

(tell me what else to try... I'll do it)

Gracias,

Luis


From maurograuso at gmail.com  Sun Nov 16 17:29:14 2008
From: maurograuso at gmail.com (Mauro Grauso)
Date: Sun, 16 Nov 2008 17:29:14 +0100
Subject: [Linux-uvc-devel] Quickam E 3500 plus and auto exposure
In-Reply-To: <200811161657.58495.laurent.pinchart@skynet.be>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<200811161507.47643.laurent.pinchart@skynet.be>
	<bc6dd08a0811160725t5cae9f4atf3fb07e54ac5601e@mail.gmail.com>
	<200811161657.58495.laurent.pinchart@skynet.be>
Message-ID: <bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>

Hi again Laurent,

Right after writing to you I started playing with uvcdynctrl controls
and I've found out that setting  'Exposure (Absolute)' to a lower
value solves my problem.

Now what remains to understand is how come the settings are changed.

>> I compiled the latest uvcdynctrl (0.2) and here is some output:
>
> I'm afraid that's outdated :-/ Could you please check the last version out
> from the SVN repository ?

As I wrote before I identified the setting that gave me problems, but
on your request I tried also the SVN version and I can confirm you
that the 0.20 is the latest.

> Please try to modify the exposure controls using the -s option to uvcdynctrl.

That's exactly what I did and got me a smooth stream (the 'Exposure
(Absolute)' control).

> Set the driver trace parameter to 64 before plugging the camera (echo 64
>> /sys/modules/uvcvideo/parameters/trace). The driver will then log a message
> when an ioctl is called. Plug the camera and check if a userspace application
> invokes VIDIOC_S_CTRL to restore controls.

This is the syslog after enabling the trace when I plug the camera:
Nov 16 17:22:02 greywolf kernel: [24925.857046] usb 2-1: new high
speed USB device using ehci_hcd and address 10
Nov 16 17:22:02 greywolf kernel: [24926.102991] usb 2-1: configuration
#1 chosen from 1 choice
Nov 16 17:22:02 greywolf kernel: [24926.103473] uvcvideo: Found UVC
1.00 device <unnamed> (046d:09a4)
Nov 16 17:22:02 greywolf kernel: [24926.135418] input: UVC Camera
(046d:09a4) as /devices/pci0000:00/0000:00:02.1/usb2/2-1/2-1:1.0/input/input11
Nov 16 17:22:03 greywolf kernel: [24926.397739]
VIDIOC_QUERYCAPVIDIOCGCAPVIDIOC_QUERYCAPVIDIOC_ENUMINPUTVIDIOC_ENUMINPUTVIDIOC_ENUM_FMTVIDIOC_TRY_FMT<3>10:3:1:
cannot set freq 16000 to ep 0x86
Nov 16 17:22:03 greywolf kernel: [24927.400217] uvcvideo: Failed to
query (1) UVC control 1 (unit 0) : -110 (exp. 26).
Nov 16 17:22:04 greywolf kernel: [24927.515251]
VIDIOC_QUERYCAPVIDIOC_G_FMTVIDIOC_S_FMT<3>uvcvideo: Failed to query
(1) UVC control 1 (unit 0) : -32 (exp. 26).
Nov 16 17:22:05 greywolf kernel: [24927.849383]
VIDIOC_G_FMTVIDIOC_S_FMT<3>uvcvideo: Failed to query (1) UVC control 1
(unit 0) : -110 (exp. 26).
Nov 16 17:22:05 greywolf kernel: [24928.848506]
VIDIOC_ENUMINPUTVIDIOC_G_INPUTVIDIOC_ENUMINPUTVIDIOC_ENUMSTD<7>uvcvideo:
Unsupported ioctl 0xc0405619
Nov 16 17:22:06 greywolf kernel: [24928.848769]
VIDIOC_ENUMINPUTVIDIOC_ENUM_FMTVIDIOC_ENUM_FMTVIDIOC_ENUM_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMT<3>uvcvideo:
Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
Nov 16 17:22:07 greywolf kernel: [24929.849271]
VIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMT<3>uvcvideo:
Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).

>> If I click on "auto exposure off" I still get "Set Auto Exposure off
>> error" in stderr.
>
> Please try to set the auto exposure control with uvcdynctrl.

Setting auto exposure fails even with uvcdynctrl. It's on by default
and doesn't seen to be changable (Even if the control is correcrly
identified).

  Exposure, Auto
    ID      : 0x00000000,
    Type    : Choice,
    Flags   : { CAN_READ, CAN_WRITE },
    Values  : { 'Auto Mode'[0], 'Manual Mode'[1], 'Shutter Priority
Mode'[2], 'Aperture Priority Mode'[3] },
    Default : 3

but:
/uvcdynctrl-0.2 --get='Exposure, Auto'
[libwebcam] Unknown V4L2 control ID encountered: 10094849
[libwebcam] Unknown V4L2 control ID encountered: 10094850
[libwebcam] Unknown V4L2 control ID encountered: 10094851
ERROR: Unknown control specified.

and:
./uvcdynctrl-0.2 --set='Exposure, Auto' 0
[libwebcam] Unknown V4L2 control ID encountered: 10094849
[libwebcam] Unknown V4L2 control ID encountered: 10094850
[libwebcam] Unknown V4L2 control ID encountered: 10094851
ERROR: Unknown control specified.

When I do that the syslog shows:
Nov 16 17:24:46 greywolf kernel: [24930.848233]
VIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_CROPCAPVIDIOC_S_CROPVIDIOC_S_INPUTVIDIOC_QUERYCTRLVIDIOC_S_CTRLVIDIOC_QUERYCTRLVIDIOC_S_CTRLVIDIOC_QUERYCTRLVIDIOC_S_CTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_STREAMOFFVIDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYC
Nov 16 17:25:29 greywolf kernel:
RLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDI


> I really doubt the camera includes an EEPROM to store control values (but I
> might of course be wrong). Please try to set auto-exposure off with
> uvcdynctrl. If it works the problem is probably in luvcview. If it doesn't
> we'll have a look somewhere else.

As told, the auto exposure can't be set with any software. Maybe I
open the camera to see if there's an EPROM?

Thanks

Ciao,
Mauro


From juhovh at iki.fi  Mon Nov 17 06:02:06 2008
From: juhovh at iki.fi (=?UTF-8?B?SnVobyBWw6Row6QtSGVydHR1YQ==?=)
Date: Mon, 17 Nov 2008 13:02:06 +0800
Subject: [Linux-uvc-devel] About compiling the driver from repository
In-Reply-To: <200811161315.04026.laurent.pinchart@skynet.be>
References: <C7DAA12F-CB8C-46E8-BA07-605A5BE1C085@iki.fi>
	<200811161315.04026.laurent.pinchart@skynet.be>
Message-ID: <4920FACE.5040604@iki.fi>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Laurent Pinchart wrote:
> I sense some bitterness here ;-) I'll try to help you (please remember I'm 
> quite new to v4l trees as well, so this might require a few iterations).

Damn, I tried to hide it since I'm not really entitled to, but it seems
I failed. :p

> The most usual source of dependency errors when installing v4l from sources is 
> old modules lying around in /lib/modules/`uname -r`/. Could you try to 
> manually move them out of the way ? If I remember well Ubuntu installs 
> in-tree modules in /lib/modules/`uname -r`/kernel and out-of-tree modules 
> in /lib/modules/`uname -r`/ubuntu, so make sure you look into both locations 
> for v4l modules.

Yes, I think this probably had something to do with the modprobe
failing, I should try to hunt down all outdated versions.

> You could also try to load the new modules with insmod. You will have to 
> resolve dependencies yourself (i.e. load the modules in the correct order), 
> but you will be able to make sure the new modules are loaded and not some old 
> ones lying around in a corner. This might give you some interesting hints.

In fact, what I tried to do first, was to remove all v4l related modules
and start to insmod them one by one. Now that I tried again, I think it
was my fault (naturally) and I think I had wrong version of
v4l1_compat.ko loaded. It's a bit funny that videodev.ko depends on
v4l1_compat.ko, but that's another issue.

Just for documentation if someone else has similar problems, the correct
order to load modules is:

insmod v4l1-compat.ko
insmod videodev.ko
insmod v4l2-compat-ioctl32.ko
insmod uvcvideo.ko

And apparently the v4l2_common.ko I mentioned before is not used at
all... I'm not sure if the ioctl32 compat is required because I'm
running on x86-64, but anyway at least I needed it.

Thank you again a lot for your help, I hope this information is helpful
for someone, at least now I know the dependencies. Stupid mistake in the
beginning again, but I had just missed the v4l1 when grepping for v4l2...


Juho
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFJIPrOVj38o8sTDc4RAuRDAJ9WPYZrmcHA8CRUAaU4NbNPi0G6TgCfdjJX
AkySz+HQH2adnZ036i/I5Sk=
=XNsh
-----END PGP SIGNATURE-----


From barsnick at gmx.net  Mon Nov 17 12:51:37 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Mon, 17 Nov 2008 12:51:37 +0100
Subject: [Linux-uvc-devel] Kernel messages (Was: Re: Quickam E 3500 plus and
	auto exposure)
In-Reply-To: <bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<200811161507.47643.laurent.pinchart@skynet.be>
	<bc6dd08a0811160725t5cae9f4atf3fb07e54ac5601e@mail.gmail.com>
	<200811161657.58495.laurent.pinchart@skynet.be>
	<bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>
Message-ID: <20081117115137.GA16490@sunshine.barsnick.net>

Hi Laurent, list

On Sun, Nov 16, 2008 at 17:29:14 +0100, Mauro Grauso wrote:

> Nov 16 17:22:05 greywolf kernel: [24928.848506]
> VIDIOC_ENUMINPUTVIDIOC_G_INPUTVIDIOC_ENUMINPUTVIDIOC_ENUMSTD<7>uvcvideo:

This is the third or fourth time I've seen this annoying printk()
phenomenon on this list.  I know the "VIDIOC_G_INPUT" messages don't
come from linux-uvc (V4L perhaps?).  Yet they look very like printk()s
missing a trailing '\n'.  (That's why syslog doesn't push them until a
subsequent log message with a proper carriage return.)

Laurent, could you check with upstream? I don't have access to those
developers, but you might know them.

Thanks,
Moritz


From juhovh at iki.fi  Mon Nov 17 15:04:14 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Mon, 17 Nov 2008 22:04:14 +0800
Subject: [Linux-uvc-devel] Fix to the auto white balance temperature problem
Message-ID: <D286D7C6-938D-4740-AC69-16EC8A8D2073@iki.fi>

Hi,

Now that I'm back in business with the latest repository, let's get  
back to the reason why I need to be able to keep up to date... My  
SiGma Micro camera still doesn't work with gstreamer or mplayer. The  
issue is pretty well described in the earlier post:

http://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003587.html

Also there is the earlier mail by Laurent that suggest a fix to the  
problem:

http://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003617.html

However up until today there's still no fix and my camera is still  
not fully working. Therefore I took the time to write and test a  
patch that is attached in this email. The problem of course is that  
the order of the control units is not known, so I have to do two  
scans through the list, it makes it look a bit messy. However it  
works again for me and that's what matters now. I hope to get this  
thing resolved some day in the official version too though. :)


Juho

-------------- next part --------------
A non-text attachment was scrubbed...
Name: auto_control_fixup.diff
Type: application/octet-stream
Size: 2746 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081117/89438cd9/attachment.obj>

From fargiolas at gnome.org  Mon Nov 17 18:28:23 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Mon, 17 Nov 2008 18:28:23 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
Message-ID: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>

Hi Laurent,

A couple of users reported me a little issue with Cheese after
upgrading uvcvideo to the last changeset (62c88b326ecd).
As soon as they start cheese they get this error:

libv4l2: error converting / decoding frame data: v4l-convert: error
parsing JPEG header: Not a JPG file ?

It only happens once and doesn't seem anything fatal since cheese runs
fine with no noticeable issue.
Both users have a dell xps (m13xx?) with a " 05a9:2640 OmniVision
Technologies, Inc." webcam.
I forwarded their mails to Hans de Goede, thinking it may be something
related to libv4l, but he said, and I believe he's right, it probably
is a driver or an hardware fault.
He said that most likely the first frame sent by the webcam doesn't
have a valid jpeg header, maybe because it starts sending in the
middle of  a frame.
Any idea about it?

Best Regards

Filippo Argiolas


From palmax at gmail.com  Mon Nov 17 19:06:34 2008
From: palmax at gmail.com (palmax at gmail.com)
Date: Mon, 17 Nov 2008 19:06:34 +0100
Subject: [Linux-uvc-devel] [linux-uvc] Still Image
In-Reply-To: <209499a0811140623g7d563f56gd5829cf7806286f9@mail.gmail.com>
References: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>
	<200811121731.38340.laurent.pinchart@skynet.be>
	<209499a0811140623g7d563f56gd5829cf7806286f9@mail.gmail.com>
Message-ID: <209499a0811171006w3c4b2618k8ed357787191feee@mail.gmail.com>

Hello

2008/11/14  <palmax at gmail.com>:
> Hello
>
> 2008/11/12 Laurent Pinchart <laurent.pinchart at skynet.be>:
>> Hi,
>>
>> On Tuesday 11 November 2008, palmax at gmail.com wrote:
>>> Dear Laurent and other developers of linux-uvc:
>>>
>>> I was talking with my mentor. We are interesting in:
>>> ? Still Image capture: method 2 and method 3, but we don't know which
>>> camera can use method 3.
>>
>> Here's a non exhaustive list of webcams that support (or at least claim to
>> support) still capture method 2.
>>
>> 0402:5606 ALi Corp.
>> 0408:030c Quanta Computer, Inc.
>> 046d:0994 Logitech, Inc.
>> 046d:09a1 Logitech, Inc.
>> 046d:09b2 Logitech, Inc.
>> 0471:0332 Philips
>> 04f2:b016 Chicony Electronics Co., Ltd
>> 05ac:8502 Apple Computer, Inc.
>> 064e:a110 Suyin Corp.
>> 0ac8:332d Z-Star Microelectronics Corp.
>> 0ac8:3343 Z-Star Microelectronics Corp.
>> 0ad2:933d Service & Quality Technology Co., Ltd
>> 0c45:62e0 Microdia
>> 0c45:63e0 Microdia
>> 145f:013e Unknown
>> 145f:013f
>> 174f:5931 Syntek
>> 174f:5a31
>> 174f:8a33
>> 1871:0306
>> 1c4f:3000
>> 1cac:a332
>> 1cac:b288
>> 5986:0104 Bison
>> 5986:0200
>> 5986:0202 Bison
>> 5986:0240 Bison
>> 5986:0300
>> 5986:0303 Bison
>> I don't know of any camera supporting still image capture method 3.
>
> I want to know what is method 0. I think that it's when webcam hasn't
> any button => no interruption point. Is it true?
>
> I will use this list for buy a good webcam for do this work. How can I
> be the developer of "Still Image" methods? The most interesting for me
> is the method 2.
I think that method 0, 1 and 2 can be interesting for us. But the most
interesting is method 2.

>>> ? Clock: I can see an example in documentation of UVC 1.1 (Class and
>>> FAQ)  with clock reference, but it's only a unique (and duplicated)
>>> example with stream payload.
>>
>> See section 2.4.3.4 in the UVC 1.1 specification.
>
> I'll read this section in this weekend.
In addition of delay+SCR+PTS, I see more problems of synchronization
in FAQ document at 2.12, but I have to read it more detailed.  In this
part of the document, LPF and PLL are presented but I didn't know
nothing about it before.

>>> ? UVC stub: My mentor is thinking about have a software UVC (like
>>> mac80211 for wifi devices) that show you usb trams. It can be
>>> interesting for learning and for debugging.
>>
>> I'm not sure to understand. Could you please elaborate ?
>
> My mentor is interesting in get a "software" USB device for get the
> information of USB trams (USB controller <-> USB device). Like
> mac80211 Test Driver (
> http://kernelnewbies.org/KernelProjects/Mac80211TestDriver ) but for
> UVC.
>
>> Best regards,
>>
>> Laurent Pinchart
>
> Good bye
> Palmax
>

Good bye
Palmax

From laurent.pinchart at skynet.be  Mon Nov 17 22:12:41 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 17 Nov 2008 22:12:41 +0100
Subject: [Linux-uvc-devel] About compiling the driver from repository
In-Reply-To: <4920FACE.5040604@iki.fi>
References: <C7DAA12F-CB8C-46E8-BA07-605A5BE1C085@iki.fi>
	<200811161315.04026.laurent.pinchart@skynet.be>
	<4920FACE.5040604@iki.fi>
Message-ID: <200811172212.42116.laurent.pinchart@skynet.be>

Hi Juho,

On Monday 17 November 2008, Juho V?h?-Herttua wrote:
> Laurent Pinchart wrote:
> > I sense some bitterness here ;-) I'll try to help you (please remember
> > I'm quite new to v4l trees as well, so this might require a few
> > iterations).
>
> Damn, I tried to hide it since I'm not really entitled to, but it seems
> I failed. :p
>
> > The most usual source of dependency errors when installing v4l from
> > sources is old modules lying around in /lib/modules/`uname -r`/. Could
> > you try to manually move them out of the way ? If I remember well Ubuntu
> > installs in-tree modules in /lib/modules/`uname -r`/kernel and
> > out-of-tree modules in /lib/modules/`uname -r`/ubuntu, so make sure you
> > look into both locations for v4l modules.
>
> Yes, I think this probably had something to do with the modprobe
> failing, I should try to hunt down all outdated versions.
>
> > You could also try to load the new modules with insmod. You will have to
> > resolve dependencies yourself (i.e. load the modules in the correct
> > order), but you will be able to make sure the new modules are loaded and
> > not some old ones lying around in a corner. This might give you some
> > interesting hints.
>
> In fact, what I tried to do first, was to remove all v4l related modules
> and start to insmod them one by one. Now that I tried again, I think it
> was my fault (naturally) and I think I had wrong version of
> v4l1_compat.ko loaded. It's a bit funny that videodev.ko depends on
> v4l1_compat.ko, but that's another issue.
>
> Just for documentation if someone else has similar problems, the correct
> order to load modules is:
>
> insmod v4l1-compat.ko
> insmod videodev.ko
> insmod v4l2-compat-ioctl32.ko
> insmod uvcvideo.ko

Thanks for the tip.

> And apparently the v4l2_common.ko I mentioned before is not used at
> all... I'm not sure if the ioctl32 compat is required because I'm
> running on x86-64, but anyway at least I needed it.
>
> Thank you again a lot for your help, I hope this information is helpful
> for someone, at least now I know the dependencies. Stupid mistake in the
> beginning again, but I had just missed the v4l1 when grepping for v4l2...

You're welcome. I'm glad you fixed your problem, as I'm still a bit worried 
that the move to Mercurial might not be easy for some users.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Nov 17 23:29:24 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 17 Nov 2008 23:29:24 +0100
Subject: [Linux-uvc-devel] Kernel messages (Was: Re: Quickam E 3500 plus
	and auto exposure)
In-Reply-To: <20081117115137.GA16490@sunshine.barsnick.net>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>
	<20081117115137.GA16490@sunshine.barsnick.net>
Message-ID: <200811172329.25124.laurent.pinchart@skynet.be>

Hi Moritz,

On Monday 17 November 2008, Moritz Barsnick wrote:
> Hi Laurent, list
>
> On Sun, Nov 16, 2008 at 17:29:14 +0100, Mauro Grauso wrote:
> > Nov 16 17:22:05 greywolf kernel: [24928.848506]
> > VIDIOC_ENUMINPUTVIDIOC_G_INPUTVIDIOC_ENUMINPUTVIDIOC_ENUMSTD<7>uvcvideo:
>
> This is the third or fourth time I've seen this annoying printk()
> phenomenon on this list.  I know the "VIDIOC_G_INPUT" messages don't
> come from linux-uvc (V4L perhaps?).  Yet they look very like printk()s
> missing a trailing '\n'.  (That's why syslog doesn't push them until a
> subsequent log message with a proper carriage return.)
>
> Laurent, could you check with upstream? I don't have access to those
> developers, but you might know them.

This was a problem with the uvcvideo driver. It's now fixed in the source code 
repository.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 18 00:30:35 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 18 Nov 2008 00:30:35 +0100
Subject: [Linux-uvc-devel] Quickam E 3500 plus and auto exposure
In-Reply-To: <bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<200811161657.58495.laurent.pinchart@skynet.be>
	<bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>
Message-ID: <200811180030.35529.laurent.pinchart@skynet.be>

Hi Mauro,

On Sunday 16 November 2008, Mauro Grauso wrote:
> Hi again Laurent,
>
> Right after writing to you I started playing with uvcdynctrl controls
> and I've found out that setting  'Exposure (Absolute)' to a lower
> value solves my problem.
>
> Now what remains to understand is how come the settings are changed.
>
> > > I compiled the latest uvcdynctrl (0.2) and here is some output:
> >
> > I'm afraid that's outdated :-/ Could you please check the last version
> > out from the SVN repository ?
>
> As I wrote before I identified the setting that gave me problems, but
> on your request I tried also the SVN version and I can confirm you
> that the 0.20 is the latest.

Don't rely on the version number, it hasn't been updated in SVN. Please use 
the SVN version.

> > Please try to modify the exposure controls using the -s option to
> > uvcdynctrl.
>
> That's exactly what I did and got me a smooth stream (the 'Exposure
> (Absolute)' control).
>
> > Set the driver trace parameter to 64 before plugging the camera (echo 64
> >
> >> /sys/modules/uvcvideo/parameters/trace). The driver will then log a
> >> message
> >
> > when an ioctl is called. Plug the camera and check if a userspace
> > application invokes VIDIOC_S_CTRL to restore controls.
>
> This is the syslog after enabling the trace when I plug the camera:
> Nov 16 17:22:02 greywolf kernel: [24925.857046] usb 2-1: new high
> speed USB device using ehci_hcd and address 10
> Nov 16 17:22:02 greywolf kernel: [24926.102991] usb 2-1: configuration
> #1 chosen from 1 choice
> Nov 16 17:22:02 greywolf kernel: [24926.103473] uvcvideo: Found UVC
> 1.00 device <unnamed> (046d:09a4)
> Nov 16 17:22:02 greywolf kernel: [24926.135418] input: UVC Camera
> (046d:09a4) as
> /devices/pci0000:00/0000:00:02.1/usb2/2-1/2-1:1.0/input/input11 Nov 16
> 17:22:03 greywolf kernel: [24926.397739]
> VIDIOC_QUERYCAPVIDIOCGCAPVIDIOC_QUERYCAPVIDIOC_ENUMINPUTVIDIOC_ENUMINPUTVID
>IOC_ENUM_FMTVIDIOC_TRY_FMT<3>10:3:1: cannot set freq 16000 to ep 0x86
> Nov 16 17:22:03 greywolf kernel: [24927.400217] uvcvideo: Failed to
> query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> Nov 16 17:22:04 greywolf kernel: [24927.515251]
> VIDIOC_QUERYCAPVIDIOC_G_FMTVIDIOC_S_FMT<3>uvcvideo: Failed to query
> (1) UVC control 1 (unit 0) : -32 (exp. 26).
> Nov 16 17:22:05 greywolf kernel: [24927.849383]
> VIDIOC_G_FMTVIDIOC_S_FMT<3>uvcvideo: Failed to query (1) UVC control 1
> (unit 0) : -110 (exp. 26).
> Nov 16 17:22:05 greywolf kernel: [24928.848506]
> VIDIOC_ENUMINPUTVIDIOC_G_INPUTVIDIOC_ENUMINPUTVIDIOC_ENUMSTD<7>uvcvideo:
> Unsupported ioctl 0xc0405619
> Nov 16 17:22:06 greywolf kernel: [24928.848769]
> VIDIOC_ENUMINPUTVIDIOC_ENUM_FMTVIDIOC_ENUM_FMTVIDIOC_ENUM_FMTVIDIOC_G_FMTVI
>DIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC
>_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_F
>MTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVI
>DIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMT<3>uvc
>video: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
> Nov 16 17:22:07 greywolf kernel: [24929.849271]
> VIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVID
>IOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_
>G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FM
>TVIDIOC_S_FMT<3>uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110
> (exp. 26).

Sorry for the garbage in the kernel log. I've fixed the uvcvideo driver and 
pushed the patch to the repository.

Anyway, the log clearly shows that a userspace process plays with VIDIOC_G_FMT 
and VIDIOC_S_FMT. Could you please apply the attached patch (on top of the 
latest driver source from the Mercurial tree) ? It prints the task name in 
kernel log messages.

> >> If I click on "auto exposure off" I still get "Set Auto Exposure off
> >> error" in stderr.
> >
> > Please try to set the auto exposure control with uvcdynctrl.
>
> Setting auto exposure fails even with uvcdynctrl. It's on by default
> and doesn't seen to be changable (Even if the control is correcrly
> identified).
>
>   Exposure, Auto
>     ID      : 0x00000000,
>     Type    : Choice,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : { 'Auto Mode'[0], 'Manual Mode'[1], 'Shutter Priority
> Mode'[2], 'Aperture Priority Mode'[3] },
>     Default : 3
>
> but:
> /uvcdynctrl-0.2 --get='Exposure, Auto'
> [libwebcam] Unknown V4L2 control ID encountered: 10094849
> [libwebcam] Unknown V4L2 control ID encountered: 10094850
> [libwebcam] Unknown V4L2 control ID encountered: 10094851
> ERROR: Unknown control specified.
>
> and:
> ./uvcdynctrl-0.2 --set='Exposure, Auto' 0
> [libwebcam] Unknown V4L2 control ID encountered: 10094849
> [libwebcam] Unknown V4L2 control ID encountered: 10094850
> [libwebcam] Unknown V4L2 control ID encountered: 10094851
> ERROR: Unknown control specified.

Please use the SVN version. It should fix the problem.

> When I do that the syslog shows:
> Nov 16 17:24:46 greywolf kernel: [24930.848233]
> VIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVID
>IOC_G_FMTVIDIOC_S_FMTVIDIOC_G_FMTVIDIOC_S_FMTVIDIOC_QUERYCTRLVIDIOC_QUERYCTR
>LVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUER
>YCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_
>QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVID
>IOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTR
>LVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUER
>YMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_
>QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVID
>IOC_CROPCAPVIDIOC_S_CROPVIDIOC_S_INPUTVIDIOC_QUERYCTRLVIDIOC_S_CTRLVIDIOC_QU
>ERYCTRLVIDIOC_S_CTRLVIDIOC_QUERYCTRLVIDIOC_S_CTRLVIDIOC_QUERYCTRLVIDIOC_QUER
>YCTRLVIDIOC_STREAMOFFVIDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_Q
>UERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYC Nov 16
> 17:25:29 greywolf kernel:
> RLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QU
>ERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIO
>C_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLV
>IDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCT
>RLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUE
>RYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC
>_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVI
>DIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCAPVIDIOC_QUERYCTR
>LVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUER
>YCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_
>QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERYMENUVID
>IOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYMENUVIDIOC_QUERYCTRLVIDIOC_QUERYCTR
>LVIDIOC_QUERYCTRLVIDIOC_QUERYCAPVIDIOC_QUERYCTRLVIDIOC_QUERYCTRLVIDIOC_QUERY
>CTR LVIDI
>
> > I really doubt the camera includes an EEPROM to store control values (but
> > I might of course be wrong). Please try to set auto-exposure off with
> > uvcdynctrl. If it works the problem is probably in luvcview. If it
> > doesn't we'll have a look somewhere else.
>
> As told, the auto exposure can't be set with any software. Maybe I
> open the camera to see if there's an EPROM?

Start by trying the attached patch and let's see what task accesses the 
device.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: task-comm.patch
Type: text/x-diff
Size: 771 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081118/32154417/attachment.patch>

From laurent.pinchart at skynet.be  Tue Nov 18 00:36:31 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 18 Nov 2008 00:36:31 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
In-Reply-To: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
References: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
Message-ID: <200811180036.31352.laurent.pinchart@skynet.be>

Hi Filippo,

On Monday 17 November 2008, Filippo Argiolas wrote:
> Hi Laurent,
>
> A couple of users reported me a little issue with Cheese after
> upgrading uvcvideo to the last changeset (62c88b326ecd).
> As soon as they start cheese they get this error:
>
> libv4l2: error converting / decoding frame data: v4l-convert: error
> parsing JPEG header: Not a JPG file ?
>
> It only happens once and doesn't seem anything fatal since cheese runs
> fine with no noticeable issue.
> Both users have a dell xps (m13xx?) with a " 05a9:2640 OmniVision
> Technologies, Inc." webcam.
> I forwarded their mails to Hans de Goede, thinking it may be something
> related to libv4l, but he said, and I believe he's right, it probably
> is a driver or an hardware fault.
> He said that most likely the first frame sent by the webcam doesn't
> have a valid jpeg header, maybe because it starts sending in the
> middle of  a frame.
> Any idea about it?

That would be my guess too. Would it be possible to dump the first frame to a 
file for analysis ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 18 00:43:10 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 18 Nov 2008 00:43:10 +0100
Subject: [Linux-uvc-devel] Audio slow
In-Reply-To: <20081116125532.6a22a691@frodo.mittelerde>
References: <20081116125532.6a22a691@frodo.mittelerde>
Message-ID: <200811180043.10501.laurent.pinchart@skynet.be>

Hi Andreas,

On Sunday 16 November 2008, Andreas Volz wrote:
> Hello,
>
> my brother has a "Bus 001 Device 002: ID 046d:0992 Logitech, Inc."
> webcam. According to the website it's fully compatible with uvcvideo.
> The webcam works well and also skype is showing a (slow) video. It's
> not that fast but anyway it works.
>
> More a problem is that the audio is not fluid and so not really
> usable. It sounds a little broken and sometime I hear only half words.
>
> He has a 800 Mzh PC running Ubuntu Linux. Graphic card is a Nvidia TNT
> 2 with driver "nv". So my question is if you think that PC is fast
> enough for realtime audio and video? Or is it maybe a performance
> problem? The computers CPU while using skype is around 70%.

Good question. 70% of CPU time is really a lot. I don't know which of the 
processor or Skype (or both) is to blame. Could you measure the CPU time with 
audio only and video only ?

> Any ideas how to find the problem?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 18 01:17:13 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 18 Nov 2008 01:17:13 +0100
Subject: [Linux-uvc-devel] [linux-uvc] Still Image
In-Reply-To: <209499a0811140623g7d563f56gd5829cf7806286f9@mail.gmail.com>
References: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>
	<200811121731.38340.laurent.pinchart@skynet.be>
	<209499a0811140623g7d563f56gd5829cf7806286f9@mail.gmail.com>
Message-ID: <200811180117.13217.laurent.pinchart@skynet.be>

Hi,

On Friday 14 November 2008, palmax at gmail.com wrote:
> 2008/11/12 Laurent Pinchart <laurent.pinchart at skynet.be>:
> > On Tuesday 11 November 2008, palmax at gmail.com wrote:
> >> Dear Laurent and other developers of linux-uvc:
> >>
> >> I was talking with my mentor. We are interesting in:
> >> ? Still Image capture: method 2 and method 3, but we don't know which
> >> camera can use method 3.
> >
> > Here's a non exhaustive list of webcams that support (or at least claim
> > to support) still capture method 2.
> >
> > 0402:5606 ALi Corp.
> > 0408:030c Quanta Computer, Inc.
> > 046d:0994 Logitech, Inc.
> > 046d:09a1 Logitech, Inc.
> > 046d:09b2 Logitech, Inc.
> > 0471:0332 Philips
> > 04f2:b016 Chicony Electronics Co., Ltd
> > 05ac:8502 Apple Computer, Inc.
> > 064e:a110 Suyin Corp.
> > 0ac8:332d Z-Star Microelectronics Corp.
> > 0ac8:3343 Z-Star Microelectronics Corp.
> > 0ad2:933d Service & Quality Technology Co., Ltd
> > 0c45:62e0 Microdia
> > 0c45:63e0 Microdia
> > 145f:013e Unknown
> > 145f:013f
> > 174f:5931 Syntek
> > 174f:5a31
> > 174f:8a33
> > 1871:0306
> > 1c4f:3000
> > 1cac:a332
> > 1cac:b288
> > 5986:0104 Bison
> > 5986:0200
> > 5986:0202 Bison
> > 5986:0240 Bison
> > 5986:0300
> > 5986:0303 Bison
> > I don't know of any camera supporting still image capture method 3.
>
> I want to know what is method 0. I think that it's when webcam hasn't
> any button => no interruption point. Is it true?

Not really. Snapshot functionality is not related to hardware triggers. The 
host can decide to take a snapshot at any time. All devices "support" method 
1 even if they claim not to, as that method doesn't require any support from 
the device.

> I will use this list for buy a good webcam for do this work. How can I
> be the developer of "Still Image" methods? The most interesting for me
> is the method 2.

Just implement the function and submit a patch. To make sure your patch will 
be accepted you should submit intermediate versions and discuss 
implementation details on the linux-uvc-devel mailing list.

> >> ? Clock: I can see an example in documentation of UVC 1.1 (Class and
> >> FAQ)  with clock reference, but it's only a unique (and duplicated)
> >> example with stream payload.
> >
> > See section 2.4.3.4 in the UVC 1.1 specification.
>
> I'll read this section in this weekend.
>
> >> ? UVC stub: My mentor is thinking about have a software UVC (like
> >> mac80211 for wifi devices) that show you usb trams. It can be
> >> interesting for learning and for debugging.
> >
> > I'm not sure to understand. Could you please elaborate ?
>
> My mentor is interesting in get a "software" USB device for get the
> information of USB trams (USB controller <-> USB device). Like
> mac80211 Test Driver (
> http://kernelnewbies.org/KernelProjects/Mac80211TestDriver ) but for
> UVC.

I'm not sure that would really be interesting. The purpose of the 802.11 test 
driver is to provide a virtual base to test the whole 802.11 stack (kernel 
space and user space). There's already an available V4L2 test driver (called 
vivi) that can be used for userspace testing.

It would be much more interesting to implement a UVC gadget driver. See this 
thread for instance 
http://lists.berlios.de/pipermail/linux-uvc-devel/2006-September/000816.html.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Nov 18 01:23:48 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 18 Nov 2008 01:23:48 +0100
Subject: [Linux-uvc-devel] [linux-uvc] Still Image
In-Reply-To: <209499a0811171006w3c4b2618k8ed357787191feee@mail.gmail.com>
References: <209499a0811110649x2e114dfawbefe4aaf45f9bf5b@mail.gmail.com>
	<209499a0811140623g7d563f56gd5829cf7806286f9@mail.gmail.com>
	<209499a0811171006w3c4b2618k8ed357787191feee@mail.gmail.com>
Message-ID: <200811180123.48626.laurent.pinchart@skynet.be>

Hi,

On Monday 17 November 2008, palmax at gmail.com wrote:
> 2008/11/14  <palmax at gmail.com>:
> > 2008/11/12 Laurent Pinchart <laurent.pinchart at skynet.be>:
> >> On Tuesday 11 November 2008, palmax at gmail.com wrote:
> >>> Dear Laurent and other developers of linux-uvc:
> >>>
> >>> I was talking with my mentor. We are interesting in:
> >>> ? Still Image capture: method 2 and method 3, but we don't know which
> >>> camera can use method 3.
> >>
> >> Here's a non exhaustive list of webcams that support (or at least claim
> >> to support) still capture method 2.
> >>
> >> 0402:5606 ALi Corp.
> >> 0408:030c Quanta Computer, Inc.
> >> 046d:0994 Logitech, Inc.
> >> 046d:09a1 Logitech, Inc.
> >> 046d:09b2 Logitech, Inc.
> >> 0471:0332 Philips
> >> 04f2:b016 Chicony Electronics Co., Ltd
> >> 05ac:8502 Apple Computer, Inc.
> >> 064e:a110 Suyin Corp.
> >> 0ac8:332d Z-Star Microelectronics Corp.
> >> 0ac8:3343 Z-Star Microelectronics Corp.
> >> 0ad2:933d Service & Quality Technology Co., Ltd
> >> 0c45:62e0 Microdia
> >> 0c45:63e0 Microdia
> >> 145f:013e Unknown
> >> 145f:013f
> >> 174f:5931 Syntek
> >> 174f:5a31
> >> 174f:8a33
> >> 1871:0306
> >> 1c4f:3000
> >> 1cac:a332
> >> 1cac:b288
> >> 5986:0104 Bison
> >> 5986:0200
> >> 5986:0202 Bison
> >> 5986:0240 Bison
> >> 5986:0300
> >> 5986:0303 Bison
> >> I don't know of any camera supporting still image capture method 3.
> >
> > I want to know what is method 0. I think that it's when webcam hasn't
> > any button => no interruption point. Is it true?
> >
> > I will use this list for buy a good webcam for do this work. How can I
> > be the developer of "Still Image" methods? The most interesting for me
> > is the method 2.
>
> I think that method 0, 1 and 2 can be interesting for us. But the most
> interesting is method 2.

Method 1 is quite straightforward and could be used to implement the userspace 
interface. Methid 2 is a bit more complex and could be implemented once 
method 1 works.

> >>> ? Clock: I can see an example in documentation of UVC 1.1 (Class and
> >>> FAQ)  with clock reference, but it's only a unique (and duplicated)
> >>> example with stream payload.
> >>
> >> See section 2.4.3.4 in the UVC 1.1 specification.
> >
> > I'll read this section in this weekend.
>
> In addition of delay+SCR+PTS, I see more problems of synchronization
> in FAQ document at 2.12, but I have to read it more detailed.  In this
> part of the document, LPF and PLL are presented but I didn't know
> nothing about it before.

I've never said it was straightforward :-) PLL stands for Phase-Locked Loop. 
See http://en.wikipedia.org/wiki/PLL.

> >>> ? UVC stub: My mentor is thinking about have a software UVC (like
> >>> mac80211 for wifi devices) that show you usb trams. It can be
> >>> interesting for learning and for debugging.
> >>
> >> I'm not sure to understand. Could you please elaborate ?
> >
> > My mentor is interesting in get a "software" USB device for get the
> > information of USB trams (USB controller <-> USB device). Like
> > mac80211 Test Driver (
> > http://kernelnewbies.org/KernelProjects/Mac80211TestDriver ) but for
> > UVC.

Best regards,

Laurent Pinchart


From barsnick at gmx.net  Tue Nov 18 17:08:46 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Tue, 18 Nov 2008 17:08:46 +0100
Subject: [Linux-uvc-devel] Kernel messages (Was: Re: Quickam E 3500	plus
	and auto exposure)
In-Reply-To: <200811172329.25124.laurent.pinchart@skynet.be>
References: <bc6dd08a0811160345g4446a7dap717c38940102c634@mail.gmail.com>
	<bc6dd08a0811160829p1b7566a7y75c3d89ec329b5c5@mail.gmail.com>
	<20081117115137.GA16490@sunshine.barsnick.net>
	<200811172329.25124.laurent.pinchart@skynet.be>
Message-ID: <20081118160846.GB24600@sunshine.barsnick.net>

Bon soir Laurent,

On Mon, Nov 17, 2008 at 23:29:24 +0100, Laurent Pinchart wrote:

> This was a problem with the uvcvideo driver. It's now fixed in the source code 
> repository.

Thanks. I truely had problems debugging and finding that troubled code.
Glad you got it figured out.  :)

Moritz


From lists at brachttal.net  Tue Nov 18 20:03:25 2008
From: lists at brachttal.net (Andreas Volz)
Date: Tue, 18 Nov 2008 20:03:25 +0100
Subject: [Linux-uvc-devel] Audio slow
In-Reply-To: <200811180043.10501.laurent.pinchart@skynet.be>
References: <20081116125532.6a22a691@frodo.mittelerde>
	<200811180043.10501.laurent.pinchart@skynet.be>
Message-ID: <20081118200325.2f98690d@frodo.mittelerde>

Am Tue, 18 Nov 2008 00:43:10 +0100 schrieb Laurent Pinchart:

> Hi Andreas,
> 
> On Sunday 16 November 2008, Andreas Volz wrote:
> > Hello,
> >
> > my brother has a "Bus 001 Device 002: ID 046d:0992 Logitech, Inc."
> > webcam. According to the website it's fully compatible with
> > uvcvideo. The webcam works well and also skype is showing a (slow)
> > video. It's not that fast but anyway it works.
> >
> > More a problem is that the audio is not fluid and so not really
> > usable. It sounds a little broken and sometime I hear only half
> > words.
> >
> > He has a 800 Mzh PC running Ubuntu Linux. Graphic card is a Nvidia
> > TNT 2 with driver "nv". So my question is if you think that PC is
> > fast enough for realtime audio and video? Or is it maybe a
> > performance problem? The computers CPU while using skype is around
> > 70%.
> 
> Good question. 70% of CPU time is really a lot. I don't know which of
> the processor or Skype (or both) is to blame. Could you measure the
> CPU time with audio only and video only ?

I'll try to measure this in the next days. I'm planing to try an
alternative video chat application to see if it's skype or uvcvideo
itself. I know only ekiga. Do you know alternatives?

regards
Andreas


From lists at brachttal.net  Tue Nov 18 20:04:47 2008
From: lists at brachttal.net (Andreas Volz)
Date: Tue, 18 Nov 2008 20:04:47 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam E3500
In-Reply-To: <20080830100925.461f036a@frodo.mittelerde>
References: <20080807210112.2fc3f6c4@frodo.mittelerde>
	<200808172220.20581.laurent.pinchart@skynet.be>
	<20080830100925.461f036a@frodo.mittelerde>
Message-ID: <20081118200447.4df20e8a@frodo.mittelerde>

Am Sat, 30 Aug 2008 10:09:25 +0200 schrieb Andreas Volz:

> Am Sun, 17 Aug 2008 22:20:20 +0200 schrieb Laurent Pinchart:
> 
> > Hi Andreas,
> > 
> > On Thursday 07 August 2008, Andreas Volz wrote:
> > > Hello,
> > >
> > > I got a Logitech Quickcam E3500 instead of my old not supported
> > > camera. This one works really great.
> > >
> > > luvcview: OK
> > > guvcview: OK
> > > ekiga: OK
> > > Skype: OK
> > > video quality: OK
> > >
> > > But now I noticed that if one of these applications start the
> > > video then my USB mouse goes crazy. Some basic functions work, but
> > > sometimes mouse clicks are emitted when they shouldn't. Also the
> > > cursor jumps sometimes about some pixels. It's not really possible
> > > to work with the mouse if the camera is active.
> > >
> > > Any ideas what's the problem or how to go deeper into it?
> > 
> > I really got no idea. Does it happen with all applications ? If so
> 
> Yeds.
> 
> > you should probably contact the linux-usb mailing list, this seems
> > to be a more generic issue. It would also be interesting to test a
> > non-USB mouse if you can connect one to the computer.
> 
> I plugged another USB PCI card into my computer and connected the
> webcam to one of this ports. Now it works without influence to the
> USB mouse. Seems to be a more generic USB problem. However, it
> works now! :-)

I was to early. After some time the problem came back, even with a
second USB card. :-(

regards
Andreas


From fargiolas at gnome.org  Tue Nov 18 21:39:13 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Tue, 18 Nov 2008 21:39:13 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
In-Reply-To: <200811180036.31352.laurent.pinchart@skynet.be>
References: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
	<200811180036.31352.laurent.pinchart@skynet.be>
Message-ID: <8ceb98f20811181239j51b30896j3d894403a2c7ece1@mail.gmail.com>

On Tue, Nov 18, 2008 at 12:36 AM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi Filippo,
Hi Laurent,

>> He said that most likely the first frame sent by the webcam doesn't
>> have a valid jpeg header, maybe because it starts sending in the
>> middle of  a frame.
>> Any idea about it?
>
> That would be my guess too. Would it be possible to dump the first frame to a
> file for analysis ?

Ok attached you can find the first frame from one of the two users
(Juan Pablo could you attach a first frame dump too? Thank you)

It's been created with "luvcvideo -f mjpg -c", is it ok? The webcam
seems to support  yuv too but since that error is jpeg related this
should be the right command.

Thanks,

Filippo Argiolas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: frame000.raw
Type: application/octet-stream
Size: 30132 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081118/2752c452/attachment.obj>

From unnati.sapre at nokia.com  Wed Nov 19 00:37:36 2008
From: unnati.sapre at nokia.com (unnati.sapre at nokia.com)
Date: Tue, 18 Nov 2008 17:37:36 -0600
Subject: [Linux-uvc-devel] Luvcview error in scratchbox
Message-ID: <C7EA9BA2FF739043AB84C42449D887A159134B@daebe102.NOE.Nokia.com>

	
Hi

I have a logitech quickcam deluxe which works perfectly on my red hat
environment but when I try to run it in scratchbox for armel target I
get an error as follows

luvcview version 0.2.1
 size width: 960 height: 720
Video driver: x11
A window manager is available
video /dev/video0
Unsupported ioctl: cmd=0x80685600
Error opening device /dev/video0: unable to query device.
 Init v4L2 failed !! exit fatal

Can anyone please help me figure out this problem?? Am I missing any
library or anything like that??

Thanks
unnati
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081118/f79aaa85/attachment.html>

From laurent.pinchart at skynet.be  Thu Nov 20 00:06:39 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 20 Nov 2008 00:06:39 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
In-Reply-To: <8ceb98f20811181239j51b30896j3d894403a2c7ece1@mail.gmail.com>
References: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
	<200811180036.31352.laurent.pinchart@skynet.be>
	<8ceb98f20811181239j51b30896j3d894403a2c7ece1@mail.gmail.com>
Message-ID: <200811200006.40081.laurent.pinchart@skynet.be>

Hi Filippo,

On Tuesday 18 November 2008, Filippo Argiolas wrote:
> On Tue, Nov 18, 2008 at 12:36 AM, Laurent Pinchart wrote:
> > > He said that most likely the first frame sent by the webcam doesn't
> > > have a valid jpeg header, maybe because it starts sending in the
> > > middle of  a frame.
> > > Any idea about it?
> >
> > That would be my guess too. Would it be possible to dump the first frame
> > to a file for analysis ?
>
> Ok attached you can find the first frame from one of the two users
> (Juan Pablo could you attach a first frame dump too? Thank you)
>
> It's been created with "luvcvideo -f mjpg -c", is it ok? The webcam
> seems to support  yuv too but since that error is jpeg related this
> should be the right command.

The frame starts with garbage followed by valid JPEG data. Either the device 
sends invalid data with valid UVC headers, in which case the uvcvideo driver 
rightfully stores the data in the frame buffer, or the garbage is marked as 
such by the device but is wrongly processed by the driver.

Could you please set the trace level to 255 (echo 255 
> /sys/modules/uvcvideo/parameters/trace), capture one frame 
with 'luvcview -f mjpg -c' and send me both the captured frame and the 
messages printed by the driver to the kernel log (dmesg) ? Make sure you 
close luvcview as soon as it displays video on screen, otherwise you will 
overflow your kernel log.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov 20 00:11:01 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 20 Nov 2008 00:11:01 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
In-Reply-To: <19cd33fa0811190528w18a2ee4m799fd3ffa4a3daf6@mail.gmail.com>
References: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
	<8ceb98f20811181239j51b30896j3d894403a2c7ece1@mail.gmail.com>
	<19cd33fa0811190528w18a2ee4m799fd3ffa4a3daf6@mail.gmail.com>
Message-ID: <200811200011.01685.laurent.pinchart@skynet.be>

Hi Juan,

On Wednesday 19 November 2008, Juan Pablo Garbarino wrote:
> On Tue, Nov 18, 2008 at 6:39 PM, Filippo Argiolas wrote:
> > On Tue, Nov 18, 2008 at 12:36 AM, Laurent Pinchart wrote:
> >> > He said that most likely the first frame sent by the webcam doesn't
> >> > have a valid jpeg header, maybe because it starts sending in the
> >> > middle of  a frame.
> >> > Any idea about it?
> > >
> > > That would be my guess too. Would it be possible to dump the first frame
> > > to a file for analysis ?
> >
> > Ok attached you can find the first frame from one of the two users
> > (Juan Pablo could you attach a first frame dump too? Thank you)
> > It's been created with "luvcvideo -f mjpg -c", is it ok? The webcam
> > seems to support  yuv too but since that error is jpeg related this
> > should be the right command.
> >
> Here is my dump, I did it as Filipo ( luvcview -f mjpg -c ).
> Hope it helps. Anything else, just ask.

Thanks for the data. Your frame starts with valid JPEG data but seems 
incomplete. This isn't the same issue Filippo reported at first. I'll first 
work with him to see if we can solve his problem, and I'll then come back to 
you if you still experience problems with the uvcvideo driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov 20 00:34:31 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 20 Nov 2008 00:34:31 +0100
Subject: [Linux-uvc-devel] Luvcview error in scratchbox
In-Reply-To: <C7EA9BA2FF739043AB84C42449D887A159134B@daebe102.NOE.Nokia.com>
References: <C7EA9BA2FF739043AB84C42449D887A159134B@daebe102.NOE.Nokia.com>
Message-ID: <200811200034.31428.laurent.pinchart@skynet.be>

On Wednesday 19 November 2008, unnati.sapre at nokia.com wrote:
> Hi
>
> I have a logitech quickcam deluxe which works perfectly on my red hat
> environment but when I try to run it in scratchbox for armel target I
> get an error as follows
>
> luvcview version 0.2.1

This is quite outdated. You can find a newer version in the quickcamteam.net 
SVN repository (http://svn.quickcamteam.net/svn/luvcview/) where luvcview 
sources are now maintained.

>  size width: 960 height: 720
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unsupported ioctl: cmd=0x80685600

I'm a bit puzzled by this error message. I can't see it in any source file 
I've checked (luvcview, libv4l, Linux kernel, ...).

> Error opening device /dev/video0: unable to query device.
>  Init v4L2 failed !! exit fatal
>
> Can anyone please help me figure out this problem?? Am I missing any
> library or anything like that??

The unsupported ioctl number corresponds to VIDIOC_QUERYCAP which the uvcvideo 
driver supports.

Could you please set the driver's trace parameter to 255 (echo 255 
> /sys/modules/uvcvideo/parameters/trace), rerun luvcview and check the 
kernel log for any error message ?

Best regards,

Laurent Pinchart


From fargiolas at gnome.org  Thu Nov 20 08:02:54 2008
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Thu, 20 Nov 2008 08:02:54 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
In-Reply-To: <200811200006.40081.laurent.pinchart@skynet.be>
References: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
	<200811180036.31352.laurent.pinchart@skynet.be>
	<8ceb98f20811181239j51b30896j3d894403a2c7ece1@mail.gmail.com>
	<200811200006.40081.laurent.pinchart@skynet.be>
Message-ID: <8ceb98f20811192302r4a74e537ye7064d5991feddc4@mail.gmail.com>

On Thu, Nov 20, 2008 at 12:06 AM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi Filippo,
Hi Laurent,

> Could you please set the trace level to 255 (echo 255
>> /sys/modules/uvcvideo/parameters/trace), capture one frame
> with 'luvcview -f mjpg -c' and send me both the captured frame and the
> messages printed by the driver to the kernel log (dmesg) ? Make sure you
> close luvcview as soon as it displays video on screen, otherwise you will
> overflow your kernel log.

Ok, I'm forwarding your request to the user. Unfortunately I don't
have that webcam to do it myself. I'll keep you updated or tell him to
directly post the results here.
Anyway, please note that both this user and Juan Pablo have the very
same webcam, the same laptop, both are using latest uvcvideo video
from your mercurial repository and both have Ubuntu Intrepid
installed.
So, I think the issue is the same and the first frame can be either
partial or contain garbage data. I'd suggest to repeat the first frame
capture several times to have a better view of the problem.

Best Regards,

Filippo Argiolas


From laurent.pinchart at skynet.be  Fri Nov 21 01:20:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 21 Nov 2008 01:20:11 +0100
Subject: [Linux-uvc-devel] libv4l2 jpeg error with 05a9:2640 webcams
In-Reply-To: <8ceb98f20811200212o1fec0f89yba5cada7a5dd11e8@mail.gmail.com>
References: <8ceb98f20811170928j52a824ecw4e207eff598b9166@mail.gmail.com>
	<200811200006.40081.laurent.pinchart@skynet.be>
	<8ceb98f20811200212o1fec0f89yba5cada7a5dd11e8@mail.gmail.com>
Message-ID: <200811210120.11529.laurent.pinchart@skynet.be>

Hi Filippo,

On Thursday 20 November 2008, Filippo Argiolas wrote:
> On Thu, Nov 20, 2008 at 12:06 AM, Laurent Pinchart wrote:
> > Could you please set the trace level to 255 (echo 255 >
> > /sys/modules/uvcvideo/parameters/trace), capture one frame
> > with 'luvcview -f mjpg -c' and send me both the captured frame and the 
> > messages printed by the driver to the kernel log (dmesg) ? Make sure you
>
> Forwarding you the logs I just received from Felix Kaser (the other user).
> I asked him several logs since I noticed the first frame size was
> always different so I thought it could be useful to have some more
> frame to compare.

Data look like they come from the middle of a JPEG frame. The second sample 
ends with a JPEG End Of Image marker, but the other two don't, which is a bit 
puzzling.

The kernel logs don't show any error. My guess is that the camera starts 
streaming somewhere in the middle of a JPEG frame. The problem probably 
occurs with YUV too, but the driver drops incomplete YUV frames so 
applications don't notice anything.

It shouldn't be too difficult to add a quirk to skip the first video frame. 
I'll try to work on that tomorrow.

Best regards,

Laurent Pinchart


From micuintus at gmx.de  Tue Nov 25 01:16:25 2008
From: micuintus at gmx.de (micu)
Date: Tue, 25 Nov 2008 01:16:25 +0100
Subject: [Linux-uvc-devel] Bug @ 046d:09a4 / Logitech Quickcam E 3500 driver?
Message-ID: <200811250116.28951.micuintus@gmx.de>



Hello there,

I've got a Logitech Quickcam E 3500 and I am running Kubuntu hardy (8.04). The 
camera works pretty well together with Skype and some other programs. 

But recently, I tried out some FOSS voip clients and I had some major problems 
with it. First I thought, this is an issue of the voip programs. But since 
the error reports seem to be very similar to me, I am starting to wonder, 
whether it can be a bug in the (ubuntu) uvc driver:

* http://trac.qutecom.org/ticket/18
* https://sip-communicator.dev.java.net/issues/show_bug.cgi?id=487

The cam doesn't work with camorama either. A friend of mine, who runs Kubuntu 
(8.10) intrepid, has got the same problems with that camera.

Today another friend of mine took that camera, sticked it into his Gentoo 
machine and captured a video with "mplayer tv://" seamlessly. If I issue this 
command, I get:

> MPlayer 1.0rc2-4.2.3 (C) 2000-2007 MPlayer Team
> CPU: Intel(R) Core(TM)2 Duo CPU     T7500  @ 2.20GHz (Family: 6, Model: 15,
> Stepping: 11) CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
> Compiled with runtime CPU detection.
> mplayer: could not connect to socket
> mplayer: No such file or directory
> Failed to open LIRC support. You will not be able to use your remote
> control.
>
> Playing tv://.
> TV file format detected.
> Selected driver: v4l2
>  name: Video 4 Linux 2 input
>  author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
>  comment: first try, more to come ;-)
> v4l2: ioctl get standard failed: Invalid argument
> Selected device: UVC Camera (046d:09a4)
>  Capabilites:  video capture  streaming
>  supported norms:
>  inputs: 0 = Camera 1;
>  Current input: 0
>  Current format: YUYV
> v4l2: ioctl set format failed: Invalid argument
> v4l2: ioctl set format failed: Invalid argument
> v4l2: ioctl set format failed: Invalid argument
> tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
> v4l2: ioctl enum norm failed: Invalid argument
> Error: Cannot set norm!
> Selected input hasn't got a tuner!
> v4l2: ioctl set mute failed: Invalid argument
> v4l2: ioctl query control failed: Invalid argument
> FPS not specified in the header or invalid, use the -fps option.
> No stream found.
>
> v4l2: ioctl set mute failed: Invalid argument
> v4l2: 0 frames successfully processed, 0 frames dropped.
>
> Exiting... (End of file)

Do you have an idea, what can be the reason for all of this? I'd appreciate 
any comment or advice.

Thanks in advance.

Kind regards, micu
-- 
GnuPG:		https://www1.inf.tu-dresden.de/~s3418892/micuintus.asc
Fingerprint:	1A15 A480 1F8B 07F6 9D12 3426 CEFE 7455 E4CB 4E80

<<</>>

https://wiki.c3d2.de/Benutzer:Micuintus
https://wiki.vorratsdatenspeicherung.de/Benutzer:Micuintus


From g9612753 at yuntech.edu.tw  Tue Nov 25 11:22:24 2008
From: g9612753 at yuntech.edu.tw (g9612753)
Date: Tue, 25 Nov 2008 18:22:24 +0800 (CST)
Subject: [Linux-uvc-devel] Problem with luvcview and uvccapture
Message-ID: <1227608543.17980.g9612753@yuntech.edu.tw>

Hi,

I'm trying to make the "Logitech quickcam pro for notebooks"(046d:0991) work on the Openmoko Neo FreeRunner. After cross-compiling the uvcvideo driver, luvcview and uvccapture, I copied them from my PC into the FreeRunner and then plugged in the webcam. But I got a "Segmentation fault" when executing luvcview. The terminal shows: 

   Video driver: x11
   A window manager is available
   video /dev/video0
   Segmentation fault

Any ideas?

Thanks,
centuries


From laurent.pinchart at skynet.be  Tue Nov 25 22:21:13 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 25 Nov 2008 22:21:13 +0100
Subject: [Linux-uvc-devel] Fix to the auto white balance temperature
	problem
In-Reply-To: <D286D7C6-938D-4740-AC69-16EC8A8D2073@iki.fi>
References: <D286D7C6-938D-4740-AC69-16EC8A8D2073@iki.fi>
Message-ID: <200811252221.14840.laurent.pinchart@skynet.be>

Hi Juho,

On Monday 17 November 2008, Juho V?h?-Herttua wrote:
> Hi,
>
> Now that I'm back in business with the latest repository, let's get
> back to the reason why I need to be able to keep up to date... My
> SiGma Micro camera still doesn't work with gstreamer or mplayer. The
> issue is pretty well described in the earlier post:
>
> http://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003587.html
>
> Also there is the earlier mail by Laurent that suggest a fix to the
> problem:
>
> http://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003617.html
>
> However up until today there's still no fix and my camera is still
> not fully working. Therefore I took the time to write and test a
> patch that is attached in this email. The problem of course is that
> the order of the control units is not known, so I have to do two
> scans through the list, it makes it look a bit messy.

This is not completely true. Controls are added to the entity controls list in 
ascending index order, so manual controls will always come before auto 
controls (at least for the processing unit).

> However it works again for me and that's what matters now. I hope to get
> this thing resolved some day in the official version too though. :)

Let's work on this then :-)

The patch indeed looked a bit messy at first. I've been trying to rework it 
for the past hour but ran into various issues and I now understand 
implementing a clean solution is not as easy as it might seem.

There are several places where control blacklisting can be implemented. If we 
want to use information taken from uvc_control_info (such as the control 
selector) the location you picked is the right one. However, the driver then 
needs to walk the entities and controls lists over again and free data 
allocated during the initialisation process.

Another solution would be to blacklist controls before they are allocated. We 
would then process the bmControls bitmask instead of the controls list. This 
approach is more efficient, but probably less generic as it won't allow the 
driver to blacklist controls based on advanced information taken from 
uvc_control_info.

As both solutions have advantages and drawbacks let's remember Linus Torvald 
and his famous quote about overdesign. Here's a simplified version of the 
patch that optionally (based on a device quirk) removes processing unit auto 
controls when no corresponding manual control is available.

Could you please test the patch and report the results ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: auto_control_fixup.diff
Type: text/x-diff
Size: 3496 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081125/9e41dbd3/attachment.diff>

From laurent.pinchart at skynet.be  Tue Nov 25 22:56:18 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 25 Nov 2008 22:56:18 +0100
Subject: [Linux-uvc-devel] Problem with luvcview and uvccapture
In-Reply-To: <1227608543.17980.g9612753@yuntech.edu.tw>
References: <1227608543.17980.g9612753@yuntech.edu.tw>
Message-ID: <200811252256.18816.laurent.pinchart@skynet.be>

Hi,

On Tuesday 25 November 2008, g9612753 wrote:
> Hi,
>
> I'm trying to make the "Logitech quickcam pro for notebooks"(046d:0991)
> work on the Openmoko Neo FreeRunner. After cross-compiling the uvcvideo
> driver, luvcview and uvccapture, I copied them from my PC into the
> FreeRunner and then plugged in the webcam. But I got a "Segmentation fault"
> when executing luvcview. The terminal shows:
>
>    Video driver: x11
>    A window manager is available
>    video /dev/video0
>    Segmentation fault
>
> Any ideas?

Check the kernel log to see if the driver crashed. If so please post the oops 
report. If not you will need to fire gdb and debug luvcview.

Best regards,

Laurent Pinchart


From pj.assis at gmail.com  Tue Nov 25 23:48:09 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 25 Nov 2008 22:48:09 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
Message-ID: <59cf47a80811251448s5fb39a27rd9a3b58ba955f8bd@mail.gmail.com>

Hi,
While performing some tests on the latest svn revision of guvcview
I've notice some strange behaviour from the uvc driver dispatched
with Ubuntu latest kernel (2.6.27-8).
After starting guvcview in MJPEG mode everything is working fine, I then
proceed into changing the imput mode to yuv, also everything is working OK.
But now if I set it back to MJPEG mode, I get a select timeout, meaning
that no frames are available.
With luvcview, that doesn't implement a select prior to the VIDIOC_DQBUF
ioctl, it just hangs waiting for a frame.

If I had to guess I would say that after geting into yuv (uncompressed) mode
incomplete frame drop gets activated, but after getting back into MJPEG mode
it doesn't get deactivated, and since MJPEG data is smaller in size than yuv
then the driver just confuses the MJPEG frame with a incomplete yuv frame.

Like I said it's just a wild guess based on the driver behaviour :-).
I will only have time to debug this properly in the next weekend.

Best regards,
Paulo


From laurent.pinchart at skynet.be  Wed Nov 26 00:15:24 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 26 Nov 2008 00:15:24 +0100
Subject: [Linux-uvc-devel] Bug @ 046d:09a4 / Logitech Quickcam E 3500
	driver?
In-Reply-To: <200811250116.28951.micuintus@gmx.de>
References: <200811250116.28951.micuintus@gmx.de>
Message-ID: <200811260015.24964.laurent.pinchart@skynet.be>

Hi,

On Tuesday 25 November 2008, micu wrote:
> Hello there,
>
> I've got a Logitech Quickcam E 3500 and I am running Kubuntu hardy (8.04).
> The camera works pretty well together with Skype and some other programs.
>
> But recently, I tried out some FOSS voip clients and I had some major
> problems with it. First I thought, this is an issue of the voip programs.
> But since the error reports seem to be very similar to me, I am starting to
> wonder, whether it can be a bug in the (ubuntu) uvc driver:
>
> * http://trac.qutecom.org/ticket/18

Could you please check the kernel log for messages printed by the uvcvideo 
driver after you get that error message from QuteCom ?

> * https://sip-communicator.dev.java.net/issues/show_bug.cgi?id=487

SIP communicator probably doesn't support the YUYV format. That's an 
application-level issue.

> The cam doesn't work with camorama either.

That's to be expected, camorama only supports the deprecated V4L1 API.

> A friend of mine, who runs Kubuntu (8.10) intrepid, has got the same
> problems with that camera. 

Ubuntu 8.10 uses the new libv4l2 library (included in the libv4l-0 package), 
and with brand new code comes brand new issues :-) Upgrading to libv4l2 0.5.6 
should help, but no package seem to be available yet.

> Today another friend of mine took that camera, sticked it into his Gentoo
> machine and captured a video with "mplayer tv://" seamlessly. If I issue
> this command, I get:
> > MPlayer 1.0rc2-4.2.3 (C) 2000-2007 MPlayer Team
> > CPU: Intel(R) Core(TM)2 Duo CPU     T7500  @ 2.20GHz (Family: 6, Model:
> > 15, Stepping: 11) CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1
> > SSE2: 1 Compiled with runtime CPU detection.
> > mplayer: could not connect to socket
> > mplayer: No such file or directory
> > Failed to open LIRC support. You will not be able to use your remote
> > control.
> >
> > Playing tv://.
> > TV file format detected.
> > Selected driver: v4l2
> >  name: Video 4 Linux 2 input
> >  author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
> >  comment: first try, more to come ;-)
> > v4l2: ioctl get standard failed: Invalid argument
> > Selected device: UVC Camera (046d:09a4)
> >  Capabilites:  video capture  streaming
> >  supported norms:
> >  inputs: 0 = Camera 1;
> >  Current input: 0
> >  Current format: YUYV
> > v4l2: ioctl set format failed: Invalid argument
> > v4l2: ioctl set format failed: Invalid argument
> > v4l2: ioctl set format failed: Invalid argument
> > tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
> > v4l2: ioctl enum norm failed: Invalid argument
> > Error: Cannot set norm!
> > Selected input hasn't got a tuner!
> > v4l2: ioctl set mute failed: Invalid argument
> > v4l2: ioctl query control failed: Invalid argument
> > FPS not specified in the header or invalid, use the -fps option.
> > No stream found.
> >
> > v4l2: ioctl set mute failed: Invalid argument
> > v4l2: 0 frames successfully processed, 0 frames dropped.
> >
> > Exiting... (End of file)
>
> Do you have an idea, what can be the reason for all of this? I'd appreciate
> any comment or advice.

There are/were known issues with mplayer. Try

mplayer tv:// -tv driver=v4l2:fps=25

Best regards,

Laurent Pinchart


From pj.assis at gmail.com  Wed Nov 26 00:15:10 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 25 Nov 2008 23:15:10 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
Message-ID: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>

Just an update,
I've now upgraded to kernel 2.6.27-10 and I still get the same behaviour.

Also I forgot to unplug the camera (Sphere AF) during the upgrade process
and once again the camera just died after first boot, I had to unplug it and
rmmod/ modprobe uvcvideo in order to get it working.

Best regards,
Paulo


From bnc at astronomicalresearchaustralia.org  Wed Nov 26 03:41:02 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Wed, 26 Nov 2008 12:41:02 +1000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
Message-ID: <492CB73E.4070709@astronomicalresearchaustralia.org>

All,

Paulo Assis wrote:

> > Also I forgot to unplug the camera (Sphere AF) during the upgrade
process
> > and once again the camera just died after first boot, I had to
unplug it and
> > rmmod/ modprobe uvcvideo in order to get it working.

I can confirm this problem, except in my case I do not have to unplug
the camera I just have to do a rmmod and modprobe after every boot.

During startup I get

 8.877539] Linux video capture interface: v2.00
<6>[    8.962671] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
<7>[    9.078689] uvcvideo 1-1.1:1.0: usb_probe_interface
<7>[    9.078694] uvcvideo 1-1.1:1.0: usb_probe_interface - got id
<6>[    9.078717] uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
<6>[    9.264254] shpchp: Standard Hot Plug PCI Controller Driver
version: 0.4
<7>[   10.087158] usb 1-1.1: modprobe timed out on ep0in len=0/26
<3>[   10.087165] uvcvideo: Failed to query (135) UVC control 1 (unit 0)
: -110 (exp. 26).
<6>[   10.351115] input: PC Speaker as /devices/platform/pcspkr/input/input7

snip

11.343947] usb 1-1.1: modprobe timed out on ep0in len=0/26
<3>[   11.343952] uvcvideo: Failed to query (129) UVC control 1 (unit 0)
: -110 (exp. 26).
<3>[   11.352475] uvcvideo: Failed to initialize the device (-5).
<6>[   11.361480] usbcore: registered new interface driver uvcvideo
<6>[   11.371461] USB Video Class driver (v0.1.0)


This is on SUSE 11.0 with 2.6.28-rc6, but it was happening on 10.3 as well.

HTH
Brian





From sopho at alum.wpi.edu  Wed Nov 26 07:20:53 2008
From: sopho at alum.wpi.edu (Sophocles Metsis)
Date: Wed, 26 Nov 2008 01:20:53 -0500
Subject: [Linux-uvc-devel] Help debugging HP Webcam 5986:0137
Message-ID: <758a15a30811252220q5c46554fr7f50a415a0b43e7a@mail.gmail.com>

Hello,

I'm having an odd problem with uvcvideo and the HP webcam on my HP
Pavilion dv5 (dv5-1125nr).  If I boot with the Fedora 10 (both 686 and
x86_64) live cd and start cheese it works great. The little light goes
on and I can see my face very clearly. If I install the x86_64 version
from the live CD on the HD and boot from the HD the webcam no longer
works.

Now on the x86-64 live CD if I rmmod uvcvideo and then modprobe it
again, the camera stops working and I get a similar error to the one I
get when I boot from the HD in /var/log/messages:

Nov 26 00:42:58 localhost kernel: uvcvideo: Failed to query (135) UVC
control 2 (unit 2) : -110 (exp. 2).

(Every time I start cheese. I get the same message. )

Note that I can also use the webcam with ekiga and the Mandriva live
CD although I didn't try screwing around with rmmod there.

Uname -a on the Fedora system produces this.
Linux ovelix 2.6.27.5-117.fc10.x86_64 #1 SMP Tue Nov 18 11:58:53 EST
2008 x86_64 x86_64 x86_64 GNU/Linux

I did try downloading uvcvideo-283b73ee3b3a.tar.bz2 and then make,
make install.  I still got the same results.

Can someone give me ideas on how to debug this further?

Thanks in advance,

Sopho

PS.

When I actually do lsusb on the device, on occasion the output pauses
and also displays some lines like the following:

can't get device qualifier: Connection timed out
can't get debug descriptor: Connection timed out
cannot read device status, Connection timed out (110)

When it works, lsusb produces the following (Yes I do see a number of
"14 Video" lines):

[ovelix ~]$ lsusb -v -d 5986:0137

Bus 001 Device 002: ID 5986:0137 Acer, Inc
Device Descriptor:
 bLength                18
 bDescriptorType         1
 bcdUSB               2.00
 bDeviceClass          239 Miscellaneous Device
 bDeviceSubClass         2 ?
 bDeviceProtocol         1 Interface Association
 bMaxPacketSize0        64
 idVendor           0x5986 Acer, Inc
 idProduct          0x0137
 bcdDevice            0.05
 iManufacturer           1
 iProduct                2
 iSerial                 0
 bNumConfigurations      1
 Configuration Descriptor:
   bLength                 9
   bDescriptorType         2
   wTotalLength          439
   bNumInterfaces          2
   bConfigurationValue     1
   iConfiguration          0
   bmAttributes         0x80
     (Bus Powered)
   MaxPower              500mA
   Interface Association:
     bLength                 8
     bDescriptorType        11
     bFirstInterface         0
     bInterfaceCount         2
     bFunctionClass         14 Video
     bFunctionSubClass       3 Video Interface Collection
     bFunctionProtocol       0
     iFunction               2
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        0
     bAlternateSetting       0
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      1 Video Control
     bInterfaceProtocol      0
     iInterface              2
     VideoControl Interface Descriptor:
       bLength                13
       bDescriptorType        36
       bDescriptorSubtype      1 (HEADER)
       bcdUVC               1.00
       wTotalLength           79
       dwClockFrequency       24.000000MHz
       bInCollection           1
       baInterfaceNr( 0)       1
     VideoControl Interface Descriptor:
       bLength                18
       bDescriptorType        36
       bDescriptorSubtype      2 (INPUT_TERMINAL)
       bTerminalID             1
       wTerminalType      0x0201 Camera Sensor
       bAssocTerminal          0
       iTerminal               0
       wObjectiveFocalLengthMin      0
       wObjectiveFocalLengthMax      0
       wOcularFocalLength            0
       bControlSize                  3
       bmControls           0x00040002
         Auto-Exposure Mode
         Privacy
     VideoControl Interface Descriptor:
       bLength                11
       bDescriptorType        36
       bDescriptorSubtype      5 (PROCESSING_UNIT)
     Warning: Descriptor too short
       bUnitID                 2
       bSourceID               1
       wMaxMultiplier          0
       bControlSize            2
       bmControls     0x0000043f
         Brightness
         Contrast
         Hue
         Saturation
         Sharpness
         Gamma
         Power Line Frequency
       iProcessing             0
       bmVideoStandards     0x 9
         None
         SECAM - 625/50
     VideoControl Interface Descriptor:
       bLength                 9
       bDescriptorType        36
       bDescriptorSubtype      3 (OUTPUT_TERMINAL)
       bTerminalID             3
       wTerminalType      0x0101 USB Streaming
       bAssocTerminal          0
       bSourceID               2
       iTerminal               0
     VideoControl Interface Descriptor:
       bLength                28
       bDescriptorType        36
       bDescriptorSubtype      6 (EXTENSION_UNIT)
       bUnitID                 4
       guidExtensionCode         {5dc717a9-1941-da11-ae0e-000d56ac7b4c}
       bNumControl            14
       bNrPins                 1
       baSourceID( 0)          1
       bControlSize            3
       bmControls( 0)       0xf9
       bmControls( 1)       0x1f
       bmControls( 2)       0x80
       iExtension              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x81  EP 1 IN
       bmAttributes            3
         Transfer Type            Interrupt
         Synch Type               None
         Usage Type               Data
       wMaxPacketSize     0x000a  1x 10 bytes
       bInterval               5
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       0
     bNumEndpoints           0
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     VideoStreaming Interface Descriptor:
       bLength                            14
       bDescriptorType                    36
       bDescriptorSubtype                  1 (INPUT_HEADER)
       bNumFormats                        1
       wTotalLength                      201
       bEndPointAddress                  130
       bmInfo                              0
       bTerminalLink                       3
       bStillCaptureMethod                 0
       bTriggerSupport                     1
       bTriggerUsage                       1
       bControlSize                        1
       bmaControls( 0)                    27
     VideoStreaming Interface Descriptor:
       bLength                            27
       bDescriptorType                    36
       bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
       bFormatIndex                        1
       bNumFrameDescriptors                5
       guidFormat
{59555932-0000-1000-8000-00aa00389b71}
       bBitsPerPixel                      16
       bDefaultFrameIndex                  1
       bAspectRatioX                       0
       bAspectRatioY                       0
       bmInterlaceFlags                 0x00
         Interlaced stream or variable: No
         Fields per frame: 1 fields
         Field 1 first: No
         Field pattern: Field 1 only
         bCopyProtect                      0
     VideoStreaming Interface Descriptor:
       bLength                            34
       bDescriptorType                    36
       bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
       bFrameIndex                         1
       bmCapabilities                   0x00
         Still image unsupported
       wWidth                            640
       wHeight                           480
       dwMinBitRate                 73728000
       dwMaxBitRate                147456000
       dwMaxVideoFrameBufferSize      614400
       dwDefaultFrameInterval         333333
       bFrameIntervalType                  2
       dwFrameInterval( 0)            333333
       dwFrameInterval( 1)            666667
     VideoStreaming Interface Descriptor:
       bLength                            30
       bDescriptorType                    36
       bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
       bFrameIndex                         2
       bmCapabilities                   0x00
         Still image unsupported
       wWidth                            352
       wHeight                           288
       dwMinBitRate                 48660480
       dwMaxBitRate                 48660480
       dwMaxVideoFrameBufferSize      202752
       dwDefaultFrameInterval         333333
       bFrameIntervalType                  1
       dwFrameInterval( 0)            333333
     VideoStreaming Interface Descriptor:
       bLength                            30
       bDescriptorType                    36
       bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
       bFrameIndex                         3
       bmCapabilities                   0x00
         Still image unsupported
       wWidth                            320
       wHeight                           240
       dwMinBitRate                 36864000
       dwMaxBitRate                 36864000
       dwMaxVideoFrameBufferSize      153600
       dwDefaultFrameInterval         333333
       bFrameIntervalType                  1
       dwFrameInterval( 0)            333333
     VideoStreaming Interface Descriptor:
       bLength                            30
       bDescriptorType                    36
       bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
       bFrameIndex                         4
       bmCapabilities                   0x00
         Still image unsupported
       wWidth                            176
       wHeight                           144
       dwMinBitRate                 12165120
       dwMaxBitRate                 12165120
       dwMaxVideoFrameBufferSize       50688
       dwDefaultFrameInterval         333333
       bFrameIntervalType                  1
       dwFrameInterval( 0)            333333
     VideoStreaming Interface Descriptor:
       bLength                            30
       bDescriptorType                    36
       bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
       bFrameIndex                         5
       bmCapabilities                   0x00
         Still image unsupported
       wWidth                            160
       wHeight                           120
       dwMinBitRate                  9216000
       dwMaxBitRate                  9216000
       dwMaxVideoFrameBufferSize       38400
       dwDefaultFrameInterval         333333
       bFrameIntervalType                  1
       dwFrameInterval( 0)            333333
     VideoStreaming Interface Descriptor:
       bLength                             6
       bDescriptorType                    36
       bDescriptorSubtype                 13 (COLORFORMAT)
       bColorPrimaries                     0 (Unspecified)
       bTransferCharacteristics            0 (Unspecified)
       bMatrixCoefficients                 0 (Unspecified)
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       1
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x0080  1x 128 bytes
       bInterval               1
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       2
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x0200  1x 512 bytes
       bInterval               1
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       3
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x0400  1x 1024 bytes
       bInterval               1
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       4
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x0b00  2x 768 bytes
       bInterval               1
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       5
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x0c00  2x 1024 bytes
       bInterval               1
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       6
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x1380  3x 896 bytes
       bInterval               1
   Interface Descriptor:
     bLength                 9
     bDescriptorType         4
     bInterfaceNumber        1
     bAlternateSetting       7
     bNumEndpoints           1
     bInterfaceClass        14 Video
     bInterfaceSubClass      2 Video Streaming
     bInterfaceProtocol      0
     iInterface              0
     Endpoint Descriptor:
       bLength                 7
       bDescriptorType         5
       bEndpointAddress     0x82  EP 2 IN
       bmAttributes            5
         Transfer Type            Isochronous
         Synch Type               Asynchronous
         Usage Type               Data
       wMaxPacketSize     0x1400  3x 1024 bytes
       bInterval               1
can't get device qualifier: Operation not permitted
can't get debug descriptor: Operation not permitted
cannot read device status, Operation not permitted (1)


From laurent.pinchart at skynet.be  Wed Nov 26 10:44:07 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 26 Nov 2008 10:44:07 +0100
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <59cf47a80811251448s5fb39a27rd9a3b58ba955f8bd@mail.gmail.com>
References: <59cf47a80811251448s5fb39a27rd9a3b58ba955f8bd@mail.gmail.com>
Message-ID: <200811261044.07348.laurent.pinchart@skynet.be>

Hi Paulo,

On Tuesday 25 November 2008, Paulo Assis wrote:
> Hi,
> While performing some tests on the latest svn revision of guvcview
> I've notice some strange behaviour from the uvc driver dispatched
> with Ubuntu latest kernel (2.6.27-8).
> After starting guvcview in MJPEG mode everything is working fine, I then
> proceed into changing the imput mode to yuv, also everything is working OK.
> But now if I set it back to MJPEG mode, I get a select timeout, meaning
> that no frames are available.
> With luvcview, that doesn't implement a select prior to the VIDIOC_DQBUF
> ioctl, it just hangs waiting for a frame.
>
> If I had to guess I would say that after geting into yuv (uncompressed)
> mode incomplete frame drop gets activated, but after getting back into
> MJPEG mode it doesn't get deactivated, and since MJPEG data is smaller in
> size than yuv then the driver just confuses the MJPEG frame with a
> incomplete yuv frame.
>
> Like I said it's just a wild guess based on the driver behaviour :-).
> I will only have time to debug this properly in the next weekend.

And that's a good guess :-) The problem is fixed in 2.6.28. In the meantime 
you can download, build and install the latest driver source (see 
http://linux-uvc.berlios.de/ for instructions).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Wed Nov 26 10:50:07 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 26 Nov 2008 10:50:07 +0100
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <492CB73E.4070709@astronomicalresearchaustralia.org>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
Message-ID: <200811261050.07407.laurent.pinchart@skynet.be>

Hi Paulo, hi Brian,

On Wednesday 26 November 2008, Brian wrote:
> All,
>
> Paulo Assis wrote:
> > > Also I forgot to unplug the camera (Sphere AF) during the upgrade
> > > process and once again the camera just died after first boot, I had to
> > > unplug it and rmmod/ modprobe uvcvideo in order to get it working.
>
> I can confirm this problem, except in my case I do not have to unplug
> the camera I just have to do a rmmod and modprobe after every boot.
>
> During startup I get
>
> [    8.877539] Linux video capture interface: v2.00
> [    8.962671] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
> [    9.078689] uvcvideo 1-1.1:1.0: usb_probe_interface
> [    9.078694] uvcvideo 1-1.1:1.0: usb_probe_interface - got id
> [    9.078717] uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> [    9.264254] shpchp: Standard Hot Plug PCI Controller Driver version: 0.4
> [   10.087158] usb 1-1.1: modprobe timed out on ep0in len=0/26
> [   10.087165] uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110
> (exp. 26). 
> [   10.351115] input: PC Speaker as /devices/platform/pcspkr/input/input7
>
> snip
>
> [   11.343947] usb 1-1.1: modprobe timed out on ep0in len=0/26
> [   11.343952] uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110
> (exp. 26). 
> [   11.352475] uvcvideo: Failed to initialize the device (-5).
> [   11.361480] usbcore: registered new interface driver uvcvideo
> [   11.371461] USB Video Class driver (v0.1.0)
>
>
> This is on SUSE 11.0 with 2.6.28-rc6, but it was happening on 10.3 as well.

Just to summarise the issue, the camera works fine when plugged in at bootup 
*except* on the first boot after a kernel upgrade ? Is that right ?

Best regards,

Laurent Pinchart


From pj.assis at gmail.com  Wed Nov 26 10:50:35 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 26 Nov 2008 09:50:35 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <492CB6D5.4040906@astronomicalresearchaustralia.org>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB6D5.4040906@astronomicalresearchaustralia.org>
Message-ID: <492D1BEB.5060308@gmail.com>

Brian escreveu:
> All,
>
> Paulo Assis wrote:
>
>   
>> Also I forgot to unplug the camera (Sphere AF) during the upgrade process
>> and once again the camera just died after first boot, I had to unplug it and
>> rmmod/ modprobe uvcvideo in order to get it working.
>>     
>
> I can confirm this problem, except in my case I do not have to unplug
> the camera I just have to do a rmmod and modprobe after every boot.
>
>   

Yes, unplugging the camera didn't work this time I had to rmmod and
modprobe the driver.
I have to say that I'm a bit confused.
If this was a hardware issue by unplugging the camera, it should get 
fixed ( at least it has worked
in previous occasions), but this time I unplugged the camera several
times and it didn't help.
Also in previous upgrades the camera would still work for a little wile,
this time it failed immediately.

> During startup I get
>
>  8.877539] Linux video capture interface: v2.00
> <6>[    8.962671] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
> <7>[    9.078689] uvcvideo 1-1.1:1.0: usb_probe_interface
> <7>[    9.078694] uvcvideo 1-1.1:1.0: usb_probe_interface - got id
> <6>[    9.078717] uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> <6>[    9.264254] shpchp: Standard Hot Plug PCI Controller Driver
> version: 0.4
> <7>[   10.087158] usb 1-1.1: modprobe timed out on ep0in len=0/26
> <3>[   10.087165] uvcvideo: Failed to query (135) UVC control 1 (unit 0)
> : -110 (exp. 26).
> <6>[   10.351115] input: PC Speaker as /devices/platform/pcspkr/input/input7
>
> snip
>
> 11.343947] usb 1-1.1: modprobe timed out on ep0in len=0/26
> <3>[   11.343952] uvcvideo: Failed to query (129) UVC control 1 (unit 0)
> : -110 (exp. 26).
> <3>[   11.352475] uvcvideo: Failed to initialize the device (-5).
> <6>[   11.361480] usbcore: registered new interface driver uvcvideo
> <6>[   11.371461] USB Video Class driver (v0.1.0)
>
>
> This is on SUSE 11.0 with 2.6.28-rc6, but it was happening on 10.3 as well.
>
> HTH
> Brian
>
>
>   
It looks pretty much like what I'm getting.

Best regards,
Paulo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081126/ddae8b35/attachment.html>

From pj.assis at gmail.com  Wed Nov 26 11:01:13 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 26 Nov 2008 10:01:13 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <200811261050.07407.laurent.pinchart@skynet.be>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
Message-ID: <492D1E69.3050708@gmail.com>

Laurent Pinchart escreveu:
> Hi Paulo, hi Brian,
>
> On Wednesday 26 November 2008, Brian wrote:
>   
>> All,
>>
>> Paulo Assis wrote:
>>     
>>>> Also I forgot to unplug the camera (Sphere AF) during the upgrade
>>>> process and once again the camera just died after first boot, I had to
>>>> unplug it and rmmod/ modprobe uvcvideo in order to get it working.
>>>>         
>> I can confirm this problem, except in my case I do not have to unplug
>> the camera I just have to do a rmmod and modprobe after every boot.
>>
>> During startup I get
>>
>> [    8.877539] Linux video capture interface: v2.00
>> [    8.962671] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
>> [    9.078689] uvcvideo 1-1.1:1.0: usb_probe_interface
>> [    9.078694] uvcvideo 1-1.1:1.0: usb_probe_interface - got id
>> [    9.078717] uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
>> [    9.264254] shpchp: Standard Hot Plug PCI Controller Driver version: 0.4
>> [   10.087158] usb 1-1.1: modprobe timed out on ep0in len=0/26
>> [   10.087165] uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -110
>> (exp. 26). 
>> [   10.351115] input: PC Speaker as /devices/platform/pcspkr/input/input7
>>
>> snip
>>
>> [   11.343947] usb 1-1.1: modprobe timed out on ep0in len=0/26
>> [   11.343952] uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -110
>> (exp. 26). 
>> [   11.352475] uvcvideo: Failed to initialize the device (-5).
>> [   11.361480] usbcore: registered new interface driver uvcvideo
>> [   11.371461] USB Video Class driver (v0.1.0)
>>
>>
>> This is on SUSE 11.0 with 2.6.28-rc6, but it was happening on 10.3 as well.
>>     
>
> Just to summarise the issue, the camera works fine when plugged in at bootup 
> *except* on the first boot after a kernel upgrade ? Is that right ?
>
> Best regards,
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>   
That is correct,

In this latest case, I was working with the camera in kernel 2.6.27-8, I
then upgrade to 2.6.27-10 and rebooted.
After booting the camera was dead, it didn't even start.
Like I said in the previous post, unplugging didn't work, I had to rmmod
and modprobe to get it to work.
I actually rmmod / modprobe with the camera unplugged, don't know if it
makes a difference.
I haven't tried booting with different kernels, but I think that could
be a good debug test, just to make sure this is
caused the upgrade process and not by changing kernels with the camera
connected.

Best regards,
Paulo



From bnc at astronomicalresearchaustralia.org  Wed Nov 26 11:20:30 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Wed, 26 Nov 2008 20:20:30 +1000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <200811261050.07407.laurent.pinchart@skynet.be>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
Message-ID: <492D22EE.3090705@astronomicalresearchaustralia.org>



Laurent Pinchart wrote:

> 
> Just to summarise the issue, the camera works fine when plugged in at bootup 
> *except* on the first boot after a kernel upgrade ? Is that right ?
> 
Laurent,
Not in my case.
I have to do an rmmod/modprobe after EVERY boot.

I noticed you also said it was fixed in 2.6.28.
Well I am doing something a bit different, I have installed SUSE 11.0
which normally runs 2.6.25, but I have replaced the kernel with
2.6.28-rc6. To be clear I am running a logitech PRO 5000 (046d:08c1).

However, I have just checked and I think I am running an older version
of uvcvideo. Do you want me to get the latest and try that?

Brian


From pj.assis at gmail.com  Wed Nov 26 11:47:44 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 26 Nov 2008 10:47:44 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <492D2910.8040108@gmail.com>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>	<200811261050.07407.laurent.pinchart@skynet.be>
	<492D22EE.3090705@astronomicalresearchaustralia.org>
	<492D2910.8040108@gmail.com>
Message-ID: <492D2950.700@gmail.com>

Paulo Assis escreveu:
> Brian escreveu:
>   
>> Laurent Pinchart wrote:
>>
>>   
>>     
>>> Just to summarise the issue, the camera works fine when plugged in at bootup 
>>> *except* on the first boot after a kernel upgrade ? Is that right ?
>>>
>>>     
>>>       
>> Laurent,
>> Not in my case.
>> I have to do an rmmod/modprobe after EVERY boot.
>>
>>     
The first boot error was concerned to previous kernel versions up until
2.6.27-8, in this cases
I still was able to use the camera for a little while.
In 2.6.27-10 the behaviour was different since it failed immediately and
unplugging didn't solve it
In this later case I'm not sure if I rebooted a second time, it was very
late and I was almost asleep :),
I will have to try it later today.

Best regards,
Paulo



From bnc at astronomicalresearchaustralia.org  Wed Nov 26 13:01:59 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Wed, 26 Nov 2008 22:01:59 +1000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <200811261050.07407.laurent.pinchart@skynet.be>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
Message-ID: <492D3AB7.4080105@astronomicalresearchaustralia.org>



Laurent,
Thought I would have a go at compiling a new version.

Downloaded from the new site, rmmod uvcvideo, did a make, make install.

Did not see a single error come up.

Did a,
modprobe uvcvideo
FATAL: Error inserting uvcvideo
(/lib/modules/2.6.28-rc6-wl-W/kernel/drivers/media/video/uvc/uvcvideo.ko):
Unknown symbol in module, or unknown parameter (see dmesg)


Which gave me,
[23585.961367] uvcvideo: disagrees about version of symbol video_usercopy
[23585.961378] uvcvideo: Unknown symbol video_usercopy

I am now stuck because I do not know where to find video_usercopy

Brian



From barsnick at gmx.net  Wed Nov 26 13:32:50 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 26 Nov 2008 13:32:50 +0100
Subject: [Linux-uvc-devel] Bug @ 046d:09a4 / Logitech Quickcam E
	3500	driver?
In-Reply-To: <200811260015.24964.laurent.pinchart@skynet.be>
References: <200811250116.28951.micuintus@gmx.de>
	<200811260015.24964.laurent.pinchart@skynet.be>
Message-ID: <20081126123250.GB25348@sunshine.barsnick.net>

Hi,

On Wed, Nov 26, 2008 at 00:15:24 +0100, Laurent Pinchart wrote:
> On Tuesday 25 November 2008, micu wrote:
> > > FPS not specified in the header or invalid, use the -fps option.

> There are/were known issues with mplayer. Try
> mplayer tv:// -tv driver=v4l2:fps=25

The obvious issue is that mplayer's output messages do not properly
differentiate between fatal and non-fatal errors - as you can observe
above, the hint was within the multitude of messages. :-/

This should probably be highlighted more clearly in the Wiki (and the
Wiki should be updated, and there should be more pointers to the Wiki,
and and and ...).

Moritz


From pj.assis at gmail.com  Wed Nov 26 21:25:26 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 26 Nov 2008 20:25:26 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <492D2910.8040108@gmail.com>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
	<492D22EE.3090705@astronomicalresearchaustralia.org>
	<492D2910.8040108@gmail.com>
Message-ID: <59cf47a80811261225n59d6d86fid61388a71d132e52@mail.gmail.com>

Hi,
I've tested this again, and I can confirm that in my case the problem
only occurs
after the first boot folowing a kernel upgrade.

Best regards
Paulo

2008/11/26 Paulo Assis <pj.assis at gmail.com>:
> Brian escreveu:
>> Laurent Pinchart wrote:
>>
>>
>>> Just to summarise the issue, the camera works fine when plugged in at bootup
>>> *except* on the first boot after a kernel upgrade ? Is that right ?
>>>
>>>
>> Laurent,
>> Not in my case.
>> I have to do an rmmod/modprobe after EVERY boot.
>>
>>
> The first boot error was concerned to previous kernel versions up until
> 2.6.27-8, in this cases
> I still was able to use the camera for a little while.
> In 2.6.27-10 the behaviour was different since it failed immediately and
> unplugging didn't solve it
> In this later case I'm not sure if I rebooted a second time, it was very
> late and I was almost asleep :),
> I will have to try it later today.
>
> Best regards,
> Paulo
>
>


From pj.assis at gmail.com  Wed Nov 26 23:32:09 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 26 Nov 2008 22:32:09 +0000
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <59cf47a80811261225n59d6d86fid61388a71d132e52@mail.gmail.com>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
	<492D22EE.3090705@astronomicalresearchaustralia.org>
	<492D2910.8040108@gmail.com>
	<59cf47a80811261225n59d6d86fid61388a71d132e52@mail.gmail.com>
Message-ID: <59cf47a80811261432s4ff2019cmf0156c674597938@mail.gmail.com>

Hi,
I've tested booting with different kernels
and everything worked just fine.
I believe now this is definitely related to
the kernel upgrade process in Ubuntu.

Something I also noticed with my camera
(Sphere AF) is that after booting, the first time
I start the camera it takes at least seven seconds
before any data is actually available (I get seven
select time-outs - 1s each).
After this first call to the camera, data is available
almost immediately.
Maybe is some driver initializations ?
Although seven seconds seems a bit to much :-!

Best regards
Paulo

2008/11/26 Paulo Assis <pj.assis at gmail.com>:
> Hi,
> I've tested this again, and I can confirm that in my case the problem
> only occurs
> after the first boot folowing a kernel upgrade.
>
> Best regards
> Paulo
>
> 2008/11/26 Paulo Assis <pj.assis at gmail.com>:
>> Brian escreveu:
>>> Laurent Pinchart wrote:
>>>
>>>
>>>> Just to summarise the issue, the camera works fine when plugged in at bootup
>>>> *except* on the first boot after a kernel upgrade ? Is that right ?
>>>>
>>>>
>>> Laurent,
>>> Not in my case.
>>> I have to do an rmmod/modprobe after EVERY boot.
>>>
>>>
>> The first boot error was concerned to previous kernel versions up until
>> 2.6.27-8, in this cases
>> I still was able to use the camera for a little while.
>> In 2.6.27-10 the behaviour was different since it failed immediately and
>> unplugging didn't solve it
>> In this later case I'm not sure if I rebooted a second time, it was very
>> late and I was almost asleep :),
>> I will have to try it later today.
>>
>> Best regards,
>> Paulo
>>
>>
>


From bnc at astronomicalresearchaustralia.org  Thu Nov 27 09:30:44 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Thu, 27 Nov 2008 18:30:44 +1000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <200811261050.07407.laurent.pinchart@skynet.be>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
Message-ID: <492E5AB4.8090901@astronomicalresearchaustralia.org>



Laurent,
As mentioned in my last email I cannot load uvcvideo

 modprobe uvcvideo
FATAL: Error inserting uvcvideo
(/lib/modules/2.6.28-rc6-wl-W/kernel/drivers/media/video/uvc/uvcvideo.ko):
Unknown symbol in module, or unknown parameter (see dmesg)

Any thoughts on what I can try, else I will have to put the old one back.

Thanks,
Brian







From pj.assis at gmail.com  Thu Nov 27 10:25:12 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 27 Nov 2008 09:25:12 +0000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <492E5AB4.8090901@astronomicalresearchaustralia.org>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>	<200811261050.07407.laurent.pinchart@skynet.be>
	<492E5AB4.8090901@astronomicalresearchaustralia.org>
Message-ID: <492E6778.5040205@gmail.com>

Brian,
I also had this message when trying to load uvcvideo,
I compiled and installed the entire mercurial  tree, since now uvcvideo has
some dependencies on other modules like v4l2-compat-ioctl32.ko at least.

I the remember a message from Juho, below is the relevant transcript:
---//---
Just for documentation if someone else has similar problems, the correct
order to load modules is:

insmod v4l1-compat.ko
insmod videodev.ko
insmod v4l2-compat-ioctl32.ko
insmod uvcvideo.ko
---//---

I just remove the modules in the reverse order as described and then
inserted them in specified order. I still got a similar message but
uvcvideo got loaded.
I then rebooted the computer and the new modules were loaded without any
problems.

Best regards,
Paulo

Brian escreveu:
> Laurent,
> As mentioned in my last email I cannot load uvcvideo
>
>  modprobe uvcvideo
> FATAL: Error inserting uvcvideo
> (/lib/modules/2.6.28-rc6-wl-W/kernel/drivers/media/video/uvc/uvcvideo.ko):
> Unknown symbol in module, or unknown parameter (see dmesg)
>
> Any thoughts on what I can try, else I will have to put the old one back.
>
> Thanks,
> Brian
>
>
>
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>   



From pj.assis at gmail.com  Thu Nov 27 12:33:37 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 27 Nov 2008 11:33:37 +0000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <492E7FC0.8080707@astronomicalresearchaustralia.org>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>	<200811261050.07407.laurent.pinchart@skynet.be>	<492E5AB4.8090901@astronomicalresearchaustralia.org>
	<492E6778.5040205@gmail.com>
	<492E7FC0.8080707@astronomicalresearchaustralia.org>
Message-ID: <492E8591.3010503@gmail.com>

Brian,
I didn't use the tar file.
I installed mercurial from the repos. and used the following command:

hg clone http://linuxtv.org/hg/~pinchartl/uvcvideo/


then from inside the newly created directory I just did:
(note: an alternative to sudo is running this commands as root):

make
sudo make install

(If you reboot the computer now, maybe you can skip the following
procedures,
In may case I did the following before rebooting)

remove any existing old modules:

sudo rmmod  uvcvideo
sudo rmmod v4l2-compat-ioctl32
sudo rmmod videodev
sudo rmmod v4l1-compat

and load the new ones:

sudo modprobe v4l1-compat
sudo modprobe videodev
sudo modprobe v4l2-compat-ioctl32
sudo modprobe uvcvideo
 
There were still some error messages but somehow
the uvc module was loaded.

Best regards,
Paulo


Brian escreveu:
> Paulo,
> Thanks for the reponse I was getting desperate
> I did an rmmod of all four but v4l2-compat-ioctl32.ko
> was missing.
> I then did the first two insmods ok but the third
>
> insmod v4l2-compat-ioctl32.ko
> insmod: error inserting 'v4l2-compat-ioctl32.ko': -1 Invalid module format
>
> did not work.
> I have found this file in the ~/uvcvideo-0280330fd4a0/v4l directoy.
> I am just using the supplied module.
> I am not aware of compiling this module.
> By that I mean I just expanded the .gz file, went into that dir and did
> a make/make install.
>
> Should I have done something else?
>
> Thansk,
> Brian
>
>
>
>
> Paulo Assis wrote:
>   
>> Brian,
>> I also had this message when trying to load uvcvideo,
>> I compiled and installed the entire mercurial  tree, since now uvcvideo has
>> some dependencies on other modules like v4l2-compat-ioctl32.ko at least.
>>
>> I the remember a message from Juho, below is the relevant transcript:
>> ---//---
>> Just for documentation if someone else has similar problems, the correct
>> order to load modules is:
>>
>> insmod v4l1-compat.ko
>> insmod videodev.ko
>> insmod v4l2-compat-ioctl32.ko
>> insmod uvcvideo.ko
>> ---//---
>>
>> I just remove the modules in the reverse order as described and then
>> inserted them in specified order. I still got a similar message but
>> uvcvideo got loaded.
>> I then rebooted the computer and the new modules were loaded without any
>> problems.
>>
>> Best regards,
>> Paulo
>>
>> Brian escreveu:
>>     
>>> Laurent,
>>> As mentioned in my last email I cannot load uvcvideo
>>>
>>>  modprobe uvcvideo
>>> FATAL: Error inserting uvcvideo
>>> (/lib/modules/2.6.28-rc6-wl-W/kernel/drivers/media/video/uvc/uvcvideo.ko):
>>> Unknown symbol in module, or unknown parameter (see dmesg)
>>>
>>> Any thoughts on what I can try, else I will have to put the old one back.
>>>
>>> Thanks,
>>> Brian
>>>
>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Linux-uvc-devel mailing list
>>> Linux-uvc-devel at lists.berlios.de
>>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>>
>>>   
>>>       
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
>>     
>
>   



From barsnick at gmx.net  Thu Nov 27 15:19:11 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Thu, 27 Nov 2008 15:19:11 +0100
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <492E8591.3010503@gmail.com>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<492CB73E.4070709@astronomicalresearchaustralia.org>
	<200811261050.07407.laurent.pinchart@skynet.be>
	<492E5AB4.8090901@astronomicalresearchaustralia.org>
	<492E6778.5040205@gmail.com>
	<492E7FC0.8080707@astronomicalresearchaustralia.org>
	<492E8591.3010503@gmail.com>
Message-ID: <20081127141911.GA2108@sunshine.barsnick.net>

Hi Paulo,

On Thu, Nov 27, 2008 at 11:33:37 +0000, Paulo Assis wrote:
> then from inside the newly created directory I just did:
> (note: an alternative to sudo is running this commands as root):

I believe your instruction is concise and correct.


> sudo modprobe v4l1-compat
> sudo modprobe videodev
> sudo modprobe v4l2-compat-ioctl32
> sudo modprobe uvcvideo

If you did a "make install" previously, you should do a
# depmod -a
then modprobe will resolve the dependencies automatically.
If you don't have any conflicting files from the previous kernel
install (the above commands show that you don't), a simple
# modprobe uvcvideo
will then be enough.

> (If you reboot the computer now, maybe you can skip the following
> procedures, In may case I did the following before rebooting)

On some distributions, "depmod -a" is called at boot, so a reboot may
or may not resolve this for you. But just do it manually without a
reboot, that should always work.

> There were still some error messages but somehow
> the uvc module was loaded.

Be sure to report them here....

HTH,
Moritz


From pj.assis at gmail.com  Thu Nov 27 15:42:09 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 27 Nov 2008 14:42:09 +0000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <20081127141911.GA2108@sunshine.barsnick.net>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>	<200811261050.07407.laurent.pinchart@skynet.be>	<492E5AB4.8090901@astronomicalresearchaustralia.org>	<492E6778.5040205@gmail.com>	<492E7FC0.8080707@astronomicalresearchaustralia.org>	<492E8591.3010503@gmail.com>
	<20081127141911.GA2108@sunshine.barsnick.net>
Message-ID: <492EB1C1.7090703@gmail.com>

Moritz,
> If you did a "make install" previously, you should do a
> # depmod -a
> then modprobe will resolve the dependencies automatically.
> If you don't have any conflicting files from the previous kernel
> install (the above commands show that you don't), a simple
> # modprobe uvcvideo
> will then be enough.
>   
I was pretty sure the make install command did  "depmod -a" , guess I
was wrong then. :-!

>> There were still some error messages but somehow
>> the uvc module was loaded.
>>     
>
> Be sure to report them here....
>   
The errors were very similar to the ones Brian described:

'v4l2-compat-ioctl32.ko': -1 Invalid module format


At first I thought the uvcvideo module didn't get loaded but then I
fired up guvcview
and it worked (no dmesg warnings or errors).
Also like Laurent said, the reported bug concerning changing from yuv to
mjpeg 
format is now solved.

Best regards,
Paulo


From laurent.pinchart at skynet.be  Thu Nov 27 15:55:12 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 27 Nov 2008 15:55:12 +0100
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <492E5AB4.8090901@astronomicalresearchaustralia.org>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<200811261050.07407.laurent.pinchart@skynet.be>
	<492E5AB4.8090901@astronomicalresearchaustralia.org>
Message-ID: <200811271555.12775.laurent.pinchart@skynet.be>

Hi Brian,

On Thursday 27 November 2008, Brian wrote:
> Laurent,
> As mentioned in my last email I cannot load uvcvideo
>
>  modprobe uvcvideo
> FATAL: Error inserting uvcvideo
> (/lib/modules/2.6.28-rc6-wl-W/kernel/drivers/media/video/uvc/uvcvideo.ko):
> Unknown symbol in module, or unknown parameter (see dmesg)
>
> Any thoughts on what I can try, else I will have to put the old one back.

Did Moritz's message in this thread help ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov 27 15:57:40 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 27 Nov 2008 15:57:40 +0100
Subject: [Linux-uvc-devel] linux uvc: Ubuntu YUV->MJPEG bug
In-Reply-To: <59cf47a80811261432s4ff2019cmf0156c674597938@mail.gmail.com>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<59cf47a80811261225n59d6d86fid61388a71d132e52@mail.gmail.com>
	<59cf47a80811261432s4ff2019cmf0156c674597938@mail.gmail.com>
Message-ID: <200811271557.40651.laurent.pinchart@skynet.be>

Hi Paulo,

On Wednesday 26 November 2008, Paulo Assis wrote:
> Hi,
> I've tested booting with different kernels and everything worked just fine.
> I believe now this is definitely related to the kernel upgrade process in
> Ubuntu.

It sounds weird, but I can't rule that out.

> Something I also noticed with my camera (Sphere AF) is that after booting,
> the first time I start the camera it takes at least seven seconds before any
> data is actually available (I get seven select time-outs - 1s each).
> After this first call to the camera, data is available almost immediately.
> Maybe is some driver initializations ?
> Although seven seconds seems a bit to much :-!

I think that's actually the time taken by the camera to initialise. I haven't 
tested the Sphere AF but the new QuickCam Pro for Notebooks models need a few 
seconds to initialise, so the problem is probably similar.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov 27 16:40:58 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 27 Nov 2008 16:40:58 +0100
Subject: [Linux-uvc-devel]
	=?iso-8859-1?q?Bug_=40_046d=3A09a4_/_Logitech_Q?=
	=?iso-8859-1?q?uickcam_E_3500=09driver=3F?=
In-Reply-To: <20081126123250.GB25348@sunshine.barsnick.net>
References: <200811250116.28951.micuintus@gmx.de>
	<200811260015.24964.laurent.pinchart@skynet.be>
	<20081126123250.GB25348@sunshine.barsnick.net>
Message-ID: <200811271640.58656.laurent.pinchart@skynet.be>

Hi Moritz,

On Wednesday 26 November 2008, Moritz Barsnick wrote:
> Hi,
>
> On Wed, Nov 26, 2008 at 00:15:24 +0100, Laurent Pinchart wrote:
> > On Tuesday 25 November 2008, micu wrote:
> > > > FPS not specified in the header or invalid, use the -fps option.
> >
> > There are/were known issues with mplayer. Try
> > mplayer tv:// -tv driver=v4l2:fps=25
>
> The obvious issue is that mplayer's output messages do not properly
> differentiate between fatal and non-fatal errors - as you can observe
> above, the hint was within the multitude of messages. :-/
>
> This should probably be highlighted more clearly in the Wiki (and the
> Wiki should be updated, and there should be more pointers to the Wiki,
> and and and ...).

Ok, I've turned documentation mode on (whoever said that would only happen 
when hell will freeze over, apologise now :-)) and updated the FAQ on 
linux-uvc.berlios.de. A small website issue is currently preventing me from 
uploading the updated version but it should be solved soon.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Nov 27 17:02:36 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 27 Nov 2008 17:02:36 +0100
Subject: [Linux-uvc-devel] Help debugging HP Webcam 5986:0137
In-Reply-To: <758a15a30811252220q5c46554fr7f50a415a0b43e7a@mail.gmail.com>
References: <758a15a30811252220q5c46554fr7f50a415a0b43e7a@mail.gmail.com>
Message-ID: <200811271702.36698.laurent.pinchart@skynet.be>

Hi,

On Wednesday 26 November 2008, Sophocles Metsis wrote:
> Hello,
>
> I'm having an odd problem with uvcvideo and the HP webcam on my HP
> Pavilion dv5 (dv5-1125nr).  If I boot with the Fedora 10 (both 686 and
> x86_64) live cd and start cheese it works great. The little light goes
> on and I can see my face very clearly. If I install the x86_64 version
> from the live CD on the HD and boot from the HD the webcam no longer
> works.
>
> Now on the x86-64 live CD if I rmmod uvcvideo and then modprobe it
> again, the camera stops working and I get a similar error to the one I
> get when I boot from the HD in /var/log/messages:
>
> Nov 26 00:42:58 localhost kernel: uvcvideo: Failed to query (135) UVC
> control 2 (unit 2) : -110 (exp. 2).
>
> (Every time I start cheese. I get the same message. )
>
> Note that I can also use the webcam with ekiga and the Mandriva live
> CD although I didn't try screwing around with rmmod there.
>
> Uname -a on the Fedora system produces this.
> Linux ovelix 2.6.27.5-117.fc10.x86_64 #1 SMP Tue Nov 18 11:58:53 EST
> 2008 x86_64 x86_64 x86_64 GNU/Linux
>
> I did try downloading uvcvideo-283b73ee3b3a.tar.bz2 and then make,
> make install.  I still got the same results.
>
> Can someone give me ideas on how to debug this further?
>
> Thanks in advance,
>
> Sopho
>
> PS.
>
> When I actually do lsusb on the device, on occasion the output pauses
> and also displays some lines like the following:
>
> can't get device qualifier: Connection timed out
> can't get debug descriptor: Connection timed out
> cannot read device status, Connection timed out (110)

That's quite bad. Does it also happen after a cold boot without loading the 
uvcvideo driver ?

> When it works, lsusb produces the following (Yes I do see a number of
> "14 Video" lines):
>
> [ovelix ~]$ lsusb -v -d 5986:0137
>
> Bus 001 Device 002: ID 5986:0137 Acer, Inc
> Device Descriptor:
>  bLength                18
>  bDescriptorType         1
>  bcdUSB               2.00
>  bDeviceClass          239 Miscellaneous Device
>  bDeviceSubClass         2 ?
>  bDeviceProtocol         1 Interface Association
>  bMaxPacketSize0        64
>  idVendor           0x5986 Acer, Inc
>  idProduct          0x0137
>  bcdDevice            0.05
>  iManufacturer           1
>  iProduct                2
>  iSerial                 0
>  bNumConfigurations      1
>  Configuration Descriptor:
>    bLength                 9
>    bDescriptorType         2
>    wTotalLength          439
>    bNumInterfaces          2
>    bConfigurationValue     1
>    iConfiguration          0
>    bmAttributes         0x80
>      (Bus Powered)
>    MaxPower              500mA
>    Interface Association:
>      bLength                 8
>      bDescriptorType        11
>      bFirstInterface         0
>      bInterfaceCount         2
>      bFunctionClass         14 Video
>      bFunctionSubClass       3 Video Interface Collection
>      bFunctionProtocol       0
>      iFunction               2
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        0
>      bAlternateSetting       0
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      1 Video Control
>      bInterfaceProtocol      0
>      iInterface              2
>      VideoControl Interface Descriptor:
>        bLength                13
>        bDescriptorType        36
>        bDescriptorSubtype      1 (HEADER)
>        bcdUVC               1.00
>        wTotalLength           79
>        dwClockFrequency       24.000000MHz
>        bInCollection           1
>        baInterfaceNr( 0)       1
>      VideoControl Interface Descriptor:
>        bLength                18
>        bDescriptorType        36
>        bDescriptorSubtype      2 (INPUT_TERMINAL)
>        bTerminalID             1
>        wTerminalType      0x0201 Camera Sensor
>        bAssocTerminal          0
>        iTerminal               0
>        wObjectiveFocalLengthMin      0
>        wObjectiveFocalLengthMax      0
>        wOcularFocalLength            0
>        bControlSize                  3
>        bmControls           0x00040002
>          Auto-Exposure Mode
>          Privacy
>      VideoControl Interface Descriptor:
>        bLength                11
>        bDescriptorType        36
>        bDescriptorSubtype      5 (PROCESSING_UNIT)
>      Warning: Descriptor too short
>        bUnitID                 2
>        bSourceID               1
>        wMaxMultiplier          0
>        bControlSize            2
>        bmControls     0x0000043f
>          Brightness
>          Contrast
>          Hue
>          Saturation
>          Sharpness
>          Gamma
>          Power Line Frequency
>        iProcessing             0
>        bmVideoStandards     0x 9
>          None
>          SECAM - 625/50
>      VideoControl Interface Descriptor:
>        bLength                 9
>        bDescriptorType        36
>        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>        bTerminalID             3
>        wTerminalType      0x0101 USB Streaming
>        bAssocTerminal          0
>        bSourceID               2
>        iTerminal               0
>      VideoControl Interface Descriptor:
>        bLength                28
>        bDescriptorType        36
>        bDescriptorSubtype      6 (EXTENSION_UNIT)
>        bUnitID                 4
>        guidExtensionCode         {5dc717a9-1941-da11-ae0e-000d56ac7b4c}
>        bNumControl            14
>        bNrPins                 1
>        baSourceID( 0)          1
>        bControlSize            3
>        bmControls( 0)       0xf9
>        bmControls( 1)       0x1f
>        bmControls( 2)       0x80
>        iExtension              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            3
>          Transfer Type            Interrupt
>          Synch Type               None
>          Usage Type               Data
>        wMaxPacketSize     0x000a  1x 10 bytes
>        bInterval               5
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       0
>      bNumEndpoints           0
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      VideoStreaming Interface Descriptor:
>        bLength                            14
>        bDescriptorType                    36
>        bDescriptorSubtype                  1 (INPUT_HEADER)
>        bNumFormats                        1
>        wTotalLength                      201
>        bEndPointAddress                  130
>        bmInfo                              0
>        bTerminalLink                       3
>        bStillCaptureMethod                 0
>        bTriggerSupport                     1
>        bTriggerUsage                       1
>        bControlSize                        1
>        bmaControls( 0)                    27
>      VideoStreaming Interface Descriptor:
>        bLength                            27
>        bDescriptorType                    36
>        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>        bFormatIndex                        1
>        bNumFrameDescriptors                5
>        guidFormat
> {59555932-0000-1000-8000-00aa00389b71}
>        bBitsPerPixel                      16
>        bDefaultFrameIndex                  1
>        bAspectRatioX                       0
>        bAspectRatioY                       0
>        bmInterlaceFlags                 0x00
>          Interlaced stream or variable: No
>          Fields per frame: 1 fields
>          Field 1 first: No
>          Field pattern: Field 1 only
>          bCopyProtect                      0
>      VideoStreaming Interface Descriptor:
>        bLength                            34
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         1
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            640
>        wHeight                           480
>        dwMinBitRate                 73728000
>        dwMaxBitRate                147456000
>        dwMaxVideoFrameBufferSize      614400
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  2
>        dwFrameInterval( 0)            333333
>        dwFrameInterval( 1)            666667
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         2
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            352
>        wHeight                           288
>        dwMinBitRate                 48660480
>        dwMaxBitRate                 48660480
>        dwMaxVideoFrameBufferSize      202752
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         3
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            320
>        wHeight                           240
>        dwMinBitRate                 36864000
>        dwMaxBitRate                 36864000
>        dwMaxVideoFrameBufferSize      153600
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         4
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            176
>        wHeight                           144
>        dwMinBitRate                 12165120
>        dwMaxBitRate                 12165120
>        dwMaxVideoFrameBufferSize       50688
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         5
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            160
>        wHeight                           120
>        dwMinBitRate                  9216000
>        dwMaxBitRate                  9216000
>        dwMaxVideoFrameBufferSize       38400
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)            333333
>      VideoStreaming Interface Descriptor:
>        bLength                             6
>        bDescriptorType                    36
>        bDescriptorSubtype                 13 (COLORFORMAT)
>        bColorPrimaries                     0 (Unspecified)
>        bTransferCharacteristics            0 (Unspecified)
>        bMatrixCoefficients                 0 (Unspecified)
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       1
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0080  1x 128 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       2
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0200  1x 512 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       3
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0400  1x 1024 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       4
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0b00  2x 768 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       5
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0c00  2x 1024 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       6
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x1380  3x 896 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       7
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x82  EP 2 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x1400  3x 1024 bytes
>        bInterval               1
> can't get device qualifier: Operation not permitted
> can't get debug descriptor: Operation not permitted
> cannot read device status, Operation not permitted (1)

Best regards,

Laurent Pinchart


From bnc at astronomicalresearchaustralia.org  Fri Nov 28 00:15:30 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Fri, 28 Nov 2008 09:15:30 +1000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <200811271555.12775.laurent.pinchart@skynet.be>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>
	<200811261050.07407.laurent.pinchart@skynet.be>
	<492E5AB4.8090901@astronomicalresearchaustralia.org>
	<200811271555.12775.laurent.pinchart@skynet.be>
Message-ID: <492F2A12.7020904@astronomicalresearchaustralia.org>



Laurent,
> 
> Did Moritz's message in this thread help ?
> 
I think it will but I have only just got up(there is obviously a
significant

time difference between us) so I will give it a go shortly.

However, at the moment I cannot even try to install it because I cannot
download the files using HG, I keep getting disconnected from the web
site. Given your comment in the other thread I will try the website again.
Back in a bit,
Brian


From bnc at astronomicalresearchaustralia.org  Fri Nov 28 00:55:53 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Fri, 28 Nov 2008 09:55:53 +1000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <20081127141911.GA2108@sunshine.barsnick.net>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>	<200811261050.07407.laurent.pinchart@skynet.be>	<492E5AB4.8090901@astronomicalresearchaustralia.org>	<492E6778.5040205@gmail.com>	<492E7FC0.8080707@astronomicalresearchaustralia.org>	<492E8591.3010503@gmail.com>
	<20081127141911.GA2108@sunshine.barsnick.net>
Message-ID: <492F3389.2010702@astronomicalresearchaustralia.org>

Moritz,
I had all sorts of problems trying to download the source from the
website last night but this morning it came down no problem.

Did a make, then a make install.
Then a modprobe uvcvideo and everything came up fine.
So I will store your depmod tip for later.

The difference this time was that I took Paulo's advice and
compiled/installed by downloading with hg rather than the tarball I
tried to use yesterday.
Is there a difference between the two?
Also does hg(I normally use svn) have an update command or do I always
download the lot?

Ok, I am off to fire up aMSN to see if that works.

Thanks,
Brian


Moritz Barsnick wrote:
> Hi Paulo,
> 
> On Thu, Nov 27, 2008 at 11:33:37 +0000, Paulo Assis wrote:
>> then from inside the newly created directory I just did:
>> (note: an alternative to sudo is running this commands as root):
> 
> I believe your instruction is concise and correct.
> 
> 
>> sudo modprobe v4l1-compat
>> sudo modprobe videodev
>> sudo modprobe v4l2-compat-ioctl32
>> sudo modprobe uvcvideo
> 
> If you did a "make install" previously, you should do a
> # depmod -a
> then modprobe will resolve the dependencies automatically.
> If you don't have any conflicting files from the previous kernel
> install (the above commands show that you don't), a simple
> # modprobe uvcvideo
> will then be enough.
> 
>> (If you reboot the computer now, maybe you can skip the following
>> procedures, In may case I did the following before rebooting)
> 
> On some distributions, "depmod -a" is called at boot, so a reboot may
> or may not resolve this for you. But just do it manually without a
> reboot, that should always work.
> 
>> There were still some error messages but somehow
>> the uvc module was loaded.
> 
> Be sure to report them here....
> 
> HTH,
> Moritz
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 


From sopho at alum.wpi.edu  Fri Nov 28 02:48:19 2008
From: sopho at alum.wpi.edu (Sophocles Metsis)
Date: Thu, 27 Nov 2008 20:48:19 -0500
Subject: [Linux-uvc-devel] Help debugging HP Webcam 5986:0137
In-Reply-To: <200811271702.36698.laurent.pinchart@skynet.be>
References: <758a15a30811252220q5c46554fr7f50a415a0b43e7a@mail.gmail.com>
	<200811271702.36698.laurent.pinchart@skynet.be>
Message-ID: <758a15a30811271748l27724e99p9e3882d61901bb07@mail.gmail.com>

Hello,

On Thu, Nov 27, 2008 at 11:02 AM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi,
>
> On Wednesday 26 November 2008, Sophocles Metsis wrote:
>> Hello,
>>
>> I'm having an odd problem with uvcvideo and the HP webcam on my HP
>> Pavilion dv5 (dv5-1125nr).  If I boot with the Fedora 10 (both 686 and
>> x86_64) live cd and start cheese it works great. The little light goes
>> on and I can see my face very clearly. If I install the x86_64 version
>> from the live CD on the HD and boot from the HD the webcam no longer
>> works.
>>
>> Now on the x86-64 live CD if I rmmod uvcvideo and then modprobe it
>> again, the camera stops working and I get a similar error to the one I
>> get when I boot from the HD in /var/log/messages:
>>
>> Nov 26 00:42:58 localhost kernel: uvcvideo: Failed to query (135) UVC
>> control 2 (unit 2) : -110 (exp. 2).
>>
>> (Every time I start cheese. I get the same message. )
>>
>> Note that I can also use the webcam with ekiga and the Mandriva live
>> CD although I didn't try screwing around with rmmod there.
>>
>> Uname -a on the Fedora system produces this.
>> Linux ovelix 2.6.27.5-117.fc10.x86_64 #1 SMP Tue Nov 18 11:58:53 EST
>> 2008 x86_64 x86_64 x86_64 GNU/Linux
>>
>> I did try downloading uvcvideo-283b73ee3b3a.tar.bz2 and then make,
>> make install.  I still got the same results.
>>
>> Can someone give me ideas on how to debug this further?
>>
>> Thanks in advance,
>>
>> Sopho
>>
>> PS.
>>
>> When I actually do lsusb on the device, on occasion the output pauses
>> and also displays some lines like the following:
>>
>> can't get device qualifier: Connection timed out
>> can't get debug descriptor: Connection timed out
>> cannot read device status, Connection timed out (110)
>
> That's quite bad. Does it also happen after a cold boot without loading the
> uvcvideo driver ?

I never looked before I loaded uvcvideo. If I unload it, it doesn't
happen afterwards, but then again I'm not doing anything else with any
USB devices. I suspect it has something to do with the 64 bit build of
Fedora 10 ... It works almost perfectly if I install the 32 bit
version of Fedora 10 on the HD! I can modprobe and rmmod the driver
tens of times with now errors and then when I reload it the last time
it works just like it did after I first booted. Should presume that
other folks have run uvcvideo on a 64 bit version of another
distribution? I can only imagine that the 64 bit kernel build in
Fedora doesn't work well with my laptop (HP dv5 with AMD)

So now I have a different problem with the 32 bit Fedora 10. Ekiga
3.0.1 (which is the secondary purpose of this laptop) is stuck in a
very low resolution namely 160x120.  Now what is odd is that this
resolution isn't even available in ekiga. I set it with cheese and now
I can't change it with either of the two. If I change it in ekiga, it
stays the same size (160x120) but with a black border around it to
fill in the rest of the new size. If I change the resolution in cheese
to anything other that 160x120 I get a completely black image. In
guvcview I can set any resolution I want from 160x120 to 640x480 and
they all work as they are suppose to but changing it in guvcview has
no effect on ekiga or cheese. This still happens after a cold boot and
with a different user. If I boot from the live CD it works at any
resolution I set it to. Is there some file shared between cheese and
ekiga that stores the webcam resolution?

Thanks in advance,

Sopho

>
> Best regards,
>
> Laurent Pinchart
>


From hgkamath at hotmail.com  Fri Nov 28 08:10:20 2008
From: hgkamath at hotmail.com (Ganapathi Kamath)
Date: Fri, 28 Nov 2008 02:10:20 -0500
Subject: [Linux-uvc-devel] 04f2:b103 Chicony Electronics Co., Ltd
Message-ID: <COL0-F64A978EFBBBE0565EDD2DDA040@phx.gbl>


Hi

I saw emails related to Chicony CNF7045 (ID 04f2:b062) and Chicony CNF7246 
(ID 04f2:b106). This is yet another Chicony webcam (ID 04f2:b106) present on 
HP tx2510us. It may be present on all HP tx2500z series as well. I have 
included below the lsusb information. Let me know if you need any more 
information or any driver tested.

# uname -a
Linux localhost 2.6.27.5-117.fc10.x86_64 #1 SMP Tue Nov 18 11:58:53 EST 2008 
x86_64 x86_64 x86_64 GNU/Linux

# dmesg | egrep -i uvc
uvcvideo: Found UVC 1.00 device CKF7073 (04f2:b103)
usbcore: registered new interface driver uvcvideo
uvcvideo: Failed to query (1) UVC control 1 (unit 0) : -110 (exp. 26).
uvcvideo: Failed to query (135) UVC control 2 (unit 3) : -110 (exp. 2).
# The last message may be due to starting the 'cheese' application

# lsusb | egrep -i chico
Bus 002 Device 002: ID 04f2:b103 Chicony Electronics Co., Ltd

# lsusb -v -d 04f2:b103
Bus 002 Device 002: ID 04f2:b103 Chicony Electronics Co., Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04f2 Chicony Electronics Co., Ltd
  idProduct          0xb103
  bcdDevice           36.04
  iManufacturer           2
  iProduct                1
  iSerial                 3
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          523
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower               98mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              5
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000157f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      277
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 0
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat                            
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  3072000
        dwMaxBitRate                 14745600
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  5
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  1013760
        dwMaxBitRate                  4866048
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  5
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   768000
        dwMaxBitRate                  3686400
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  5
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   253440
        dwMaxBitRate                  1216512
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  5
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   192000
        dwMaxBitRate                   921600
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  5
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
can't get device qualifier: Connection timed out
can't get debug descriptor: Connection timed out
cannot read device status, Connection timed out (110)




From juhovh at iki.fi  Fri Nov 28 15:10:14 2008
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Fri, 28 Nov 2008 22:10:14 +0800
Subject: [Linux-uvc-devel] Fix to the auto white balance temperature
	problem
In-Reply-To: <200811252221.14840.laurent.pinchart@skynet.be>
References: <D286D7C6-938D-4740-AC69-16EC8A8D2073@iki.fi>
	<200811252221.14840.laurent.pinchart@skynet.be>
Message-ID: <33555F7B-9153-454F-99A0-0DD27569471D@iki.fi>

Hi,

First I have to say I'm sorry for a bit slow reply, the patch didn't  
work out of the box and I had to check out where the problem was...

On 26.11.2008, at 5.21, Laurent Pinchart wrote:
> This is not completely true. Controls are added to the entity  
> controls list in
> ascending index order, so manual controls will always come before auto
> controls (at least for the processing unit).

Ah, in that case it is true because of how they are sorted. I didn't  
dare to count on it though...

>> However it works again for me and that's what matters now. I hope  
>> to get
>> this thing resolved some day in the official version too though. :)
>
> Let's work on this then :-)
>
> The patch indeed looked a bit messy at first. I've been trying to  
> rework it
> for the past hour but ran into various issues and I now understand
> implementing a clean solution is not as easy as it might seem.
>
> There are several places where control blacklisting can be  
> implemented. If we
> want to use information taken from uvc_control_info (such as the  
> control
> selector) the location you picked is the right one. However, the  
> driver then
> needs to walk the entities and controls lists over again and free data
> allocated during the initialisation process.
>
> Another solution would be to blacklist controls before they are  
> allocated. We
> would then process the bmControls bitmask instead of the controls  
> list. This
> approach is more efficient, but probably less generic as it won't  
> allow the
> driver to blacklist controls based on advanced information taken from
> uvc_control_info.
>
> As both solutions have advantages and drawbacks let's remember  
> Linus Torvald
> and his famous quote about overdesign. Here's a simplified version  
> of the
> patch that optionally (based on a device quirk) removes processing  
> unit auto
> controls when no corresponding manual control is available.
>
> Could you please test the patch and report the results ?

I agree that this version is cleaner than mine, at least it doesn't  
free memory blocks and hold the mutex while doing it. :) Also adding  
the device quirk was something that I was thinking should be added  
but wanted to ask for comments first.

The latest patch had a small thinko though, you wrote "entity- 
 >extension" in the controls and size getting when it should be  
"entity->processing" in this case. I'll attach a new tested version  
of the patch where that is fixed, it should have no other changes.  
Thanks again and tell let me know if there's something else I could/ 
should do. :)


Juho

-------------- next part --------------
A non-text attachment was scrubbed...
Name: auto_control_fixup.diff
Type: application/octet-stream
Size: 3691 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081128/a542f65c/attachment.obj>
-------------- next part --------------




From rsclison at cosmosbay-vectis.com  Fri Nov 28 22:51:26 2008
From: rsclison at cosmosbay-vectis.com (sclison)
Date: Fri, 28 Nov 2008 22:51:26 +0100
Subject: [Linux-uvc-devel] Problem with Hercules Dualpix Infinite (guvcview
	ko, cheese ok)
Message-ID: <1227909086.15559.0.camel@rsclison-laptop.cbv>

Hi,

I have some strange results with a Hercules Dualpix Infinite webcam
As you can yee with the image I join a great part of the frame is green.
This image has been captured with guvcview. The result is the same with
luvcview and aMsn.
BUT CHEESE display a perfect image !

Please could someone help me.


dmesg display this :
[  179.692048] usb 5-4: new high speed USB device using ehci_hcd and
address 3
[  179.850365] usb 5-4: configuration #1 chosen from 1 choice
[  179.998529] Linux video capture interface: v2.00
[  180.032966] uvcvideo: Found UVC 1.00 device Hercules Dualpix Infinite
(06f8:300a)
[  180.042686] input: Hercules Dualpix Infinite
as /devices/pci0000:00/0000:00:1d.7/usb5/5-4/5-4:1.0/input/input11
[  180.052158] usbcore: registered new interface driver uvcvideo
[  180.053071] USB Video Class driver (v0.1.0)
[  180.100288] 3:3:1: cannot get freq at ep 0x84
[  180.117753] usbcore: registered new interface driver snd-usb-audio
[  180.805554] 3:3:1: cannot get freq at ep 0x84

And lsusb -v is :

Bus 005 Device 003: ID 06f8:300a Guillemot Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x06f8 Guillemot Corp.
  idProduct          0x300a 
  bcdDevice            1.00
  iManufacturer           2 Guillemot Corporation
  iProduct                1 Hercules Dualpix Infinite
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          766
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              168mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 Hercules Dualpix Infinite
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 Hercules Dualpix Infinite
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x7f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0x00
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000a0e
          Auto-Exposure Mode
          Auto-Exposure Priority
          Exposure Time (Absolute)
          Zoom (Absolute)
          PanTilt (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000177f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      407
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   768000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   192000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   253440
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  1013760
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  3072000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            42
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                  4800000
        dwMaxBitRate                 19200000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         500000
        bFrameIntervalType                  4
        dwFrameInterval( 0)            500000
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
        dwFrameInterval( 3)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                 19200000
        dwMaxBitRate                 19200000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               8
        wWidth( 0)                        320
        wHeight( 0)                       240
        wWidth( 1)                       1600
        wHeight( 1)                      1200
        wWidth( 2)                       1280
        wHeight( 2)                       960
        wWidth( 3)                        800
        wHeight( 3)                       600
        wWidth( 4)                        640
        wHeight( 4)                       480
        wWidth( 5)                        352
        wHeight( 5)                       288
        wWidth( 6)                        176
        wHeight( 6)                       144
        wWidth( 7)                        160
        wHeight( 7)                       120
        bNumCompressionPatterns             8
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       0 
      bFunctionProtocol       0 
      iFunction               4 Hercules Dualpix Infinite Mic
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              4 Hercules Dualpix Infinite Mic
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           41
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            2
        bmaControls( 0)      0x01
        bmaControls( 0)      0x00
          Mute
        bmaControls( 1)      0x02
        bmaControls( 1)      0x00
          Volume
        iFeature                0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                14
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            2 Discrete
        tSamFreq[ 0]         8000
        tSamFreq[ 1]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0190  1x 400 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined



-------------- next part --------------
A non-text attachment was scrubbed...
Name: Image.jpg
Type: image/jpeg
Size: 11513 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20081128/60fd2e5d/attachment.jpg>

From pj.assis at gmail.com  Fri Nov 28 23:47:37 2008
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 28 Nov 2008 22:47:37 +0000
Subject: [Linux-uvc-devel] Problem with Hercules Dualpix Infinite
	(guvcview ko, cheese ok)
In-Reply-To: <1227909086.15559.0.camel@rsclison-laptop.cbv>
References: <1227909086.15559.0.camel@rsclison-laptop.cbv>
Message-ID: <59cf47a80811281447h2481846fq30dc48a6904040ec@mail.gmail.com>

Please, can you send me the console output of:

guvcview --verbose

If you could use the last svn revision it would be best.

Also please grab a RAW frame (just select RAW from the image format combobox)
and post it back.

PS: I have a similar problem in yuv mode with my quickcam 5000 pro at
low framerates.
Maybe you could try changing the frame rate (and resolution) just to
check if it makes any diference.

Best regards,
Paulo

2008/11/28 sclison <rsclison at cosmosbay-vectis.com>:
> Hi,
>
> I have some strange results with a Hercules Dualpix Infinite webcam
> As you can yee with the image I join a great part of the frame is green.
> This image has been captured with guvcview. The result is the same with
> luvcview and aMsn.
> BUT CHEESE display a perfect image !
>
> Please could someone help me.
>
>
> dmesg display this :
> [  179.692048] usb 5-4: new high speed USB device using ehci_hcd and
> address 3
> [  179.850365] usb 5-4: configuration #1 chosen from 1 choice
> [  179.998529] Linux video capture interface: v2.00
> [  180.032966] uvcvideo: Found UVC 1.00 device Hercules Dualpix Infinite
> (06f8:300a)
> [  180.042686] input: Hercules Dualpix Infinite
> as /devices/pci0000:00/0000:00:1d.7/usb5/5-4/5-4:1.0/input/input11
> [  180.052158] usbcore: registered new interface driver uvcvideo
> [  180.053071] USB Video Class driver (v0.1.0)
> [  180.100288] 3:3:1: cannot get freq at ep 0x84
> [  180.117753] usbcore: registered new interface driver snd-usb-audio
> [  180.805554] 3:3:1: cannot get freq at ep 0x84
>
> And lsusb -v is :
>
> Bus 005 Device 003: ID 06f8:300a Guillemot Corp.
> Device Descriptor:
>  bLength                18
>  bDescriptorType         1
>  bcdUSB               2.00
>  bDeviceClass          239 Miscellaneous Device
>  bDeviceSubClass         2 ?
>  bDeviceProtocol         1 Interface Association
>  bMaxPacketSize0        64
>  idVendor           0x06f8 Guillemot Corp.
>  idProduct          0x300a
>  bcdDevice            1.00
>  iManufacturer           2 Guillemot Corporation
>  iProduct                1 Hercules Dualpix Infinite
>  iSerial                 0
>  bNumConfigurations      1
>  Configuration Descriptor:
>    bLength                 9
>    bDescriptorType         2
>    wTotalLength          766
>    bNumInterfaces          4
>    bConfigurationValue     1
>    iConfiguration          0
>    bmAttributes         0x80
>      (Bus Powered)
>    MaxPower              168mA
>    Interface Association:
>      bLength                 8
>      bDescriptorType        11
>      bFirstInterface         0
>      bInterfaceCount         2
>      bFunctionClass         14 Video
>      bFunctionSubClass       3 Video Interface Collection
>      bFunctionProtocol       0
>      iFunction               5 Hercules Dualpix Infinite
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        0
>      bAlternateSetting       0
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      1 Video Control
>      bInterfaceProtocol      0
>      iInterface              5 Hercules Dualpix Infinite
>      VideoControl Interface Descriptor:
>        bLength                13
>        bDescriptorType        36
>        bDescriptorSubtype      1 (HEADER)
>        bcdUVC               1.00
>        wTotalLength          103
>        dwClockFrequency       15.000000MHz
>        bInCollection           1
>        baInterfaceNr( 0)       1
>      VideoControl Interface Descriptor:
>        bLength                 9
>        bDescriptorType        36
>        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>        bTerminalID             2
>        wTerminalType      0x0101 USB Streaming
>        bAssocTerminal          0
>        bSourceID               5
>        iTerminal               0
>      VideoControl Interface Descriptor:
>        bLength                26
>        bDescriptorType        36
>        bDescriptorSubtype      6 (EXTENSION_UNIT)
>        bUnitID                 4
>        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
>        bNumControl             8
>        bNrPins                 1
>        baSourceID( 0)          3
>        bControlSize            1
>        bmControls( 0)       0x7f
>        iExtension              0
>      VideoControl Interface Descriptor:
>        bLength                26
>        bDescriptorType        36
>        bDescriptorSubtype      6 (EXTENSION_UNIT)
>        bUnitID                 5
>        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
>        bNumControl             8
>        bNrPins                 1
>        baSourceID( 0)          4
>        bControlSize            1
>        bmControls( 0)       0x00
>        iExtension              0
>      VideoControl Interface Descriptor:
>        bLength                18
>        bDescriptorType        36
>        bDescriptorSubtype      2 (INPUT_TERMINAL)
>        bTerminalID             1
>        wTerminalType      0x0201 Camera Sensor
>        bAssocTerminal          0
>        iTerminal               0
>        wObjectiveFocalLengthMin      0
>        wObjectiveFocalLengthMax      0
>        wOcularFocalLength            0
>        bControlSize                  3
>        bmControls           0x00000a0e
>          Auto-Exposure Mode
>          Auto-Exposure Priority
>          Exposure Time (Absolute)
>          Zoom (Absolute)
>          PanTilt (Absolute)
>      VideoControl Interface Descriptor:
>        bLength                11
>        bDescriptorType        36
>        bDescriptorSubtype      5 (PROCESSING_UNIT)
>      Warning: Descriptor too short
>        bUnitID                 3
>        bSourceID               1
>        wMaxMultiplier          0
>        bControlSize            2
>        bmControls     0x0000177f
>          Brightness
>          Contrast
>          Hue
>          Saturation
>          Sharpness
>          Gamma
>          White Balance Temperature
>          Backlight Compensation
>          Gain
>          Power Line Frequency
>          White Balance Temperature, Auto
>        iProcessing             0
>        bmVideoStandards     0x 0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x83  EP 3 IN
>        bmAttributes            3
>          Transfer Type            Interrupt
>          Synch Type               None
>          Usage Type               Data
>        wMaxPacketSize     0x0010  1x 16 bytes
>        bInterval               6
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       0
>      bNumEndpoints           0
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      VideoStreaming Interface Descriptor:
>        bLength                            14
>        bDescriptorType                    36
>        bDescriptorSubtype                  1 (INPUT_HEADER)
>        bNumFormats                        1
>        wTotalLength                      407
>        bEndPointAddress                  129
>        bmInfo                              0
>        bTerminalLink                       2
>        bStillCaptureMethod                 2
>        bTriggerSupport                     0
>        bTriggerUsage                       0
>        bControlSize                        1
>        bmaControls( 0)                    27
>      VideoStreaming Interface Descriptor:
>        bLength                            27
>        bDescriptorType                    36
>        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>        bFormatIndex                        1
>        bNumFrameDescriptors                7
>        guidFormat
> {59555932-0000-1000-8000-00aa00389b71}
>        bBitsPerPixel                      16
>        bDefaultFrameIndex                  1
>        bAspectRatioX                       0
>        bAspectRatioY                       0
>        bmInterlaceFlags                 0x00
>          Interlaced stream or variable: No
>          Fields per frame: 1 fields
>          Field 1 first: No
>          Field pattern: Field 1 only
>          bCopyProtect                      0
>      VideoStreaming Interface Descriptor:
>        bLength                            50
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         3
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            320
>        wHeight                           240
>        dwMinBitRate                   768000
>        dwMaxBitRate                  4608000
>        dwMaxVideoFrameBufferSize      153600
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  6
>        dwFrameInterval( 0)            333333
>        dwFrameInterval( 1)            400000
>        dwFrameInterval( 2)            500000
>        dwFrameInterval( 3)            666666
>        dwFrameInterval( 4)           1000000
>        dwFrameInterval( 5)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            50
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         5
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            160
>        wHeight                           120
>        dwMinBitRate                   192000
>        dwMaxBitRate                  1152000
>        dwMaxVideoFrameBufferSize       38400
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  6
>        dwFrameInterval( 0)            333333
>        dwFrameInterval( 1)            400000
>        dwFrameInterval( 2)            500000
>        dwFrameInterval( 3)            666666
>        dwFrameInterval( 4)           1000000
>        dwFrameInterval( 5)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            50
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         4
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            176
>        wHeight                           144
>        dwMinBitRate                   253440
>        dwMaxBitRate                  1520640
>        dwMaxVideoFrameBufferSize       50688
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  6
>        dwFrameInterval( 0)            333333
>        dwFrameInterval( 1)            400000
>        dwFrameInterval( 2)            500000
>        dwFrameInterval( 3)            666666
>        dwFrameInterval( 4)           1000000
>        dwFrameInterval( 5)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            50
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         2
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            352
>        wHeight                           288
>        dwMinBitRate                  1013760
>        dwMaxBitRate                  6082560
>        dwMaxVideoFrameBufferSize      202752
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  6
>        dwFrameInterval( 0)            333333
>        dwFrameInterval( 1)            400000
>        dwFrameInterval( 2)            500000
>        dwFrameInterval( 3)            666666
>        dwFrameInterval( 4)           1000000
>        dwFrameInterval( 5)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            50
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         1
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            640
>        wHeight                           480
>        dwMinBitRate                  3072000
>        dwMaxBitRate                 18432000
>        dwMaxVideoFrameBufferSize      614400
>        dwDefaultFrameInterval         333333
>        bFrameIntervalType                  6
>        dwFrameInterval( 0)            333333
>        dwFrameInterval( 1)            400000
>        dwFrameInterval( 2)            500000
>        dwFrameInterval( 3)            666666
>        dwFrameInterval( 4)           1000000
>        dwFrameInterval( 5)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            42
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         6
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                            800
>        wHeight                           600
>        dwMinBitRate                  4800000
>        dwMaxBitRate                 19200000
>        dwMaxVideoFrameBufferSize      960000
>        dwDefaultFrameInterval         500000
>        bFrameIntervalType                  4
>        dwFrameInterval( 0)            500000
>        dwFrameInterval( 1)            666666
>        dwFrameInterval( 2)           1000000
>        dwFrameInterval( 3)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            30
>        bDescriptorType                    36
>        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>        bFrameIndex                         8
>        bmCapabilities                   0x00
>          Still image unsupported
>        wWidth                           1600
>        wHeight                          1200
>        dwMinBitRate                 19200000
>        dwMaxBitRate                 19200000
>        dwMaxVideoFrameBufferSize     3840000
>        dwDefaultFrameInterval        2000000
>        bFrameIntervalType                  1
>        dwFrameInterval( 0)           2000000
>      VideoStreaming Interface Descriptor:
>        bLength                            38
>        bDescriptorType                    36
>        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>        bEndpointAddress                    0
>        bNumImageSizePatterns               8
>        wWidth( 0)                        320
>        wHeight( 0)                       240
>        wWidth( 1)                       1600
>        wHeight( 1)                      1200
>        wWidth( 2)                       1280
>        wHeight( 2)                       960
>        wWidth( 3)                        800
>        wHeight( 3)                       600
>        wWidth( 4)                        640
>        wHeight( 4)                       480
>        wWidth( 5)                        352
>        wHeight( 5)                       288
>        wWidth( 6)                        176
>        wHeight( 6)                       144
>        wWidth( 7)                        160
>        wHeight( 7)                       120
>        bNumCompressionPatterns             8
>      VideoStreaming Interface Descriptor:
>        bLength                             6
>        bDescriptorType                    36
>        bDescriptorSubtype                 13 (COLORFORMAT)
>        bColorPrimaries                     1 (BT.709,sRGB)
>        bTransferCharacteristics            1 (BT.709)
>        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       1
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0080  1x 128 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       2
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0100  1x 256 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       3
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0320  1x 800 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       4
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0b20  2x 800 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       5
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x1320  3x 800 bytes
>        bInterval               1
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        1
>      bAlternateSetting       6
>      bNumEndpoints           1
>      bInterfaceClass        14 Video
>      bInterfaceSubClass      2 Video Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      Endpoint Descriptor:
>        bLength                 7
>        bDescriptorType         5
>        bEndpointAddress     0x81  EP 1 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x1400  3x 1024 bytes
>        bInterval               1
>    Interface Association:
>      bLength                 8
>      bDescriptorType        11
>      bFirstInterface         2
>      bInterfaceCount         2
>      bFunctionClass          1 Audio
>      bFunctionSubClass       0
>      bFunctionProtocol       0
>      iFunction               4 Hercules Dualpix Infinite Mic
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        2
>      bAlternateSetting       0
>      bNumEndpoints           0
>      bInterfaceClass         1 Audio
>      bInterfaceSubClass      1 Control Device
>      bInterfaceProtocol      0
>      iInterface              4 Hercules Dualpix Infinite Mic
>      AudioControl Interface Descriptor:
>        bLength                 9
>        bDescriptorType        36
>        bDescriptorSubtype      1 (HEADER)
>        bcdADC               1.00
>        wTotalLength           41
>        bInCollection           1
>        baInterfaceNr( 0)       3
>      AudioControl Interface Descriptor:
>        bLength                12
>        bDescriptorType        36
>        bDescriptorSubtype      2 (INPUT_TERMINAL)
>        bTerminalID             1
>        wTerminalType      0x0201 Microphone
>        bAssocTerminal          0
>        bNrChannels             1
>        wChannelConfig     0x0000
>        iChannelNames           0
>        iTerminal               0
>      AudioControl Interface Descriptor:
>        bLength                11
>        bDescriptorType        36
>        bDescriptorSubtype      6 (FEATURE_UNIT)
>        bUnitID                 2
>        bSourceID               1
>        bControlSize            2
>        bmaControls( 0)      0x01
>        bmaControls( 0)      0x00
>          Mute
>        bmaControls( 1)      0x02
>        bmaControls( 1)      0x00
>          Volume
>        iFeature                0
>      AudioControl Interface Descriptor:
>        bLength                 9
>        bDescriptorType        36
>        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>        bTerminalID             3
>        wTerminalType      0x0101 USB Streaming
>        bAssocTerminal          0
>        bSourceID               2
>        iTerminal               0
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        3
>      bAlternateSetting       0
>      bNumEndpoints           0
>      bInterfaceClass         1 Audio
>      bInterfaceSubClass      2 Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>    Interface Descriptor:
>      bLength                 9
>      bDescriptorType         4
>      bInterfaceNumber        3
>      bAlternateSetting       1
>      bNumEndpoints           1
>      bInterfaceClass         1 Audio
>      bInterfaceSubClass      2 Streaming
>      bInterfaceProtocol      0
>      iInterface              0
>      AudioStreaming Interface Descriptor:
>        bLength                 7
>        bDescriptorType        36
>        bDescriptorSubtype      1 (AS_GENERAL)
>        bTerminalLink           3
>        bDelay                  1 frames
>        wFormatTag              1 PCM
>      AudioStreaming Interface Descriptor:
>        bLength                14
>        bDescriptorType        36
>        bDescriptorSubtype      2 (FORMAT_TYPE)
>        bFormatType             1 (FORMAT_TYPE_I)
>        bNrChannels             1
>        bSubframeSize           2
>        bBitResolution         16
>        bSamFreqType            2 Discrete
>        tSamFreq[ 0]         8000
>        tSamFreq[ 1]        16000
>      Endpoint Descriptor:
>        bLength                 9
>        bDescriptorType         5
>        bEndpointAddress     0x84  EP 4 IN
>        bmAttributes            5
>          Transfer Type            Isochronous
>          Synch Type               Asynchronous
>          Usage Type               Data
>        wMaxPacketSize     0x0190  1x 400 bytes
>        bInterval               4
>        bRefresh                0
>        bSynchAddress           0
>        AudioControl Endpoint Descriptor:
>          bLength                 7
>          bDescriptorType        37
>          bDescriptorSubtype      1 (EP_GENERAL)
>          bmAttributes         0x01
>            Sampling Frequency
>          bLockDelayUnits         0 Undefined
>          wLockDelay              0 Undefined
>
>
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>


From laurent.pinchart at skynet.be  Sat Nov 29 00:41:58 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 29 Nov 2008 00:41:58 +0100
Subject: [Linux-uvc-devel] Problem with Hercules Dualpix Infinite
	(guvcview ko, cheese ok)
In-Reply-To: <1227909086.15559.0.camel@rsclison-laptop.cbv>
References: <1227909086.15559.0.camel@rsclison-laptop.cbv>
Message-ID: <200811290041.58297.laurent.pinchart@skynet.be>

Hi,

On Friday 28 November 2008, sclison wrote:
> Hi,
>
> I have some strange results with a Hercules Dualpix Infinite webcam
> As you can yee with the image I join a great part of the frame is green.
> This image has been captured with guvcview. The result is the same with
> luvcview and aMsn.
> BUT CHEESE display a perfect image !
>
> Please could someone help me.

Do luvcview and cheese use the exact same resolution ? The camera might have 
trouble at some resolutions and work correctly at others.

Best regards,

Laurent Pinchart


From micuintus at gmx.de  Sat Nov 29 00:59:00 2008
From: micuintus at gmx.de (micu)
Date: Sat, 29 Nov 2008 00:59:00 +0100
Subject: [Linux-uvc-devel] Bug @ 046d:09a4 / Logitech Quickcam E 3500
	driver?
In-Reply-To: <200811260015.24964.laurent.pinchart@skynet.be>
References: <200811250116.28951.micuintus@gmx.de>
	<200811260015.24964.laurent.pinchart@skynet.be>
Message-ID: <200811290059.02855.micuintus@gmx.de>


Hey Laurent et al.,


thanks a lot for your answer!



Am Mittwoch, 26. November 2008 00:15:24 schrieb Laurent Pinchart:
> > * http://trac.qutecom.org/ticket/18
>
> Could you please check the kernel log for messages printed by the uvcvideo
> driver after you get that error message from QuteCom ?

When I *connect* my camera to my computer, most of the time I get something 
like this:

> usb 6-3: new high speed USB device using ehci_hcd and address 5
> usb 6-3: configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:09a4)
> uvcvideo: UVC non compliance - GET_DEF(PROBE) not supported. Enabling
> workaround. input: UVC Camera (046d:09a4) as
> /devices/pci0000:00/0000:00:1a.7/usb6/6-3/6-3:1.0/input/input13

Sometimes I get:

> ALSA
> /build/buildd/linux-ubuntu-modules-2.6.24-2.6.24/debian/build/build-generic
>/sound/alsa-driver/usb/usbaudio.c:1296: 10:3:1: cannot get freq at ep 0x86
> uvcvideo: Failed to set UVC probe control : -110 (exp. 26).

*Don't* get a kernel log message when Qutecom crashes at all.


> That's to be expected, camorama only supports the deprecated V4L1 API.

Ahh.. good to know, thx! ;)


> There are/were known issues with mplayer. Try
>
> mplayer tv:// -tv driver=v4l2:fps=25

AAAAAhhh.... works pretty well, thanks a lot! (Oh that cleverness of me: not 
able to read the mplayer output correctly... :/)


Kind regards, 

micu
-- 
GnuPG:		https://www1.inf.tu-dresden.de/~s3418892/micuintus.asc
Fingerprint:	1A15 A480 1F8B 07F6 9D12 3426 CEFE 7455 E4CB 4E80

<<</>>

https://wiki.c3d2.de/Benutzer:Micuintus
https://wiki.vorratsdatenspeicherung.de/Benutzer:Micuintus


From bnc at astronomicalresearchaustralia.org  Sat Nov 29 15:27:26 2008
From: bnc at astronomicalresearchaustralia.org (Brian)
Date: Sun, 30 Nov 2008 00:27:26 +1000
Subject: [Linux-uvc-devel] uvcvideo load problem
In-Reply-To: <492F3389.2010702@astronomicalresearchaustralia.org>
References: <59cf47a80811251515k2cf2df42k6d7fdb851ec5b5c6@mail.gmail.com>	<492CB73E.4070709@astronomicalresearchaustralia.org>	<200811261050.07407.laurent.pinchart@skynet.be>	<492E5AB4.8090901@astronomicalresearchaustralia.org>	<492E6778.5040205@gmail.com>	<492E7FC0.8080707@astronomicalresearchaustralia.org>	<492E8591.3010503@gmail.com>	<20081127141911.GA2108@sunshine.barsnick.net>
	<492F3389.2010702@astronomicalresearchaustralia.org>
Message-ID: <4931514E.7020409@astronomicalresearchaustralia.org>

All,
A further update.
I have switched back to the default kernel for suse 11.0

I still have the problem where uvcvideo gets loaded but it does not work.

1) At startup I get
<6>uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
<6>uvcvideo: UVC non compliance - GET_DEF(PROBE) not supported. Enabling
workaround.
<3>uvcvideo: Failed to query (129) UVC probe control : -110 (exp. 26).
<3>uvcvideo: Failed to initialize the device (-5).
<6>usbcore: registered new interface driver snd-usb-audio
<6>usbcore: registered new interface driver uvcvideo

As a result I do not get the /dev/video device being started.
There is obviously a lot happening at this time so maybe it is a timing
thing.
Also I am not sure if the /dev/video has been built at this point.
As I put these three lines in boot.local
mknod /dev/video c 81 0
chmod 777 /dev/video*
chown root.video /dev/video*




2) The rmmod/modprobe gives me this.
ov 29 23:52:28 L2 kernel: usbcore: deregistering interface driver uvcvideo
Nov 29 23:52:34 L2 kernel: uvcvideo: Found UVC 1.00 device <unnamed>
(046d:08c1)
Nov 29 23:52:35 L2 kernel: uvcvideo: UVC non compliance - GET_DEF(PROBE)
not supported. Enabling workaround.
Nov 29 23:52:35 L2 kernel: input: UVC Camera (046d:08c1) as
/devices/pci0000:00/0000:00:1d.7/usb2/2-1/2-1.1/2-1.1:1.0/input/input8
Nov 29 23:52:35 L2 kernel: usbcore: registered new interface driver uvcvideo

So I still get the same error GET_DEF error but it does not seem to
effect anything.


HTH,
Brian


