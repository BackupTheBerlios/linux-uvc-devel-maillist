From suamor at web.de  Fri May  1 13:01:27 2009
From: suamor at web.de (Reinhard Katzmann)
Date: Fri, 01 May 2009 13:01:27 +0200
Subject: [Linux-uvc-devel] VAD Laplace webcam not in list
Message-ID: <49FAD687.5070309@web.de>

Hi,

I recently bought the Speedlink VAD Laplace webcam. Unfortunately
there is no Linux support up to now (I've seen at least 4 questions
on that topic). It's a 2 MP (Photo, Video 1.3 MP) with some unique
features over other webcams I've come across by now.
Speedlink does neither offer Linux nor MAC support (not even older
Win* versions).

For a sound card I once downloaded USB utilities to analyze some
behaviour of the card (communication with driver) on Windows but
didn't need it after all. I'd be willing to help you in this regard
to get it running.
My (white) webcam has ID 9003 (vendor ID 1ae7) and I've read that the
black version has ID 9004. Complete output from lsusb (based on
/proc/bus/usb/devices) is in attachment. The sound part of the cam
seems to be recognized by the alsa snd-usb-audio driver.
A german ubuntu thread is here: 
http://forum.ubuntuusers.de/topic/webcam:-speedlink-vad-laplace/

I checked other webcam drivers before but this card does not seem
to be supported by any of these (mainly easycam sources).
The documentation just states how to download current sources
and build them but is there some more documentation as starting
point for a developer ? (like simply how do I get to recognize
my card by the driver).

Please also CC me if you have any more questions/suggestions.

Regards,

Reinhard
-- 
Software-Engineer, Developer of User Interfaces
Project: Canorus - the next generation music score editor - 
http://canorus.berlios.de
GnuPG Public Key available on request


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: laplace-lsusb-v.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090501/18c21d28/attachment.txt>

From Eugen.Dedu at pu-pm.univ-fcomte.fr  Sun May  3 22:14:03 2009
From: Eugen.Dedu at pu-pm.univ-fcomte.fr (Eugen Dedu)
Date: Sun, 03 May 2009 22:14:03 +0200
Subject: [Linux-uvc-devel] Camera name - what encoding?
In-Reply-To: <200904141650.08169.laurent.pinchart@skynet.be>
References: <49D0E4B9.3040005@pu-pm.univ-fcomte.fr>
	<200903302311.36239.laurent.pinchart@skynet.be>
	<49D1387F.4040000@pu-pm.univ-fcomte.fr>
	<200904141650.08169.laurent.pinchart@skynet.be>
Message-ID: <49FDFB0B.8040204@pu-pm.univ-fcomte.fr>

Laurent Pinchart wrote:
> Hi Eugen,
>> - Why the kernel usb subsystem transcode them to latin-1 and not to utf-8?
> 
> You will have to ask the USB subsystem developers.
> 
>> - Do the linux kernel transcodes to latin-1 or it depends on how it was
>> configured?  Is it the same for linux, windows and macos?  It's because
>> I want to retranscode it to utf-8, and I need to know its current encoding.
> 
> The USB subsystem transcodes the UTF-16 strings to Latin-1 regardless of 
> configuration options. I have no idea how Windows and MacOS handle that.

Hi Laurent,

For info, starting from 2.6.31 (normally) the usb sub-system will return 
device names in utf-8, see e-mail attached.

Thanks!
-- 
Eugen
-------------- next part --------------
An embedded message was scrubbed...
From: Greg KH <greg at kroah.com>
Subject: Re: [PATCH 0/3] use UTF-8 encoding
Date: Fri, 24 Apr 2009 15:49:28 -0700
Size: 3807
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090503/e10a9ad4/attachment.mht>

From laurent.pinchart at skynet.be  Tue May  5 14:14:08 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 5 May 2009 14:14:08 +0200
Subject: [Linux-uvc-devel] Camera name - what encoding?
In-Reply-To: <49FDFB0B.8040204@pu-pm.univ-fcomte.fr>
References: <49D0E4B9.3040005@pu-pm.univ-fcomte.fr>
	<200904141650.08169.laurent.pinchart@skynet.be>
	<49FDFB0B.8040204@pu-pm.univ-fcomte.fr>
Message-ID: <200905051414.08336.laurent.pinchart@skynet.be>

Hi Eugen,

On Sunday 03 May 2009 22:14:03 Eugen Dedu wrote:
> Laurent Pinchart wrote:
> > Hi Eugen,
> >
> >> - Why the kernel usb subsystem transcode them to latin-1 and not to
> >> utf-8?
> >
> > You will have to ask the USB subsystem developers.
> >
> >> - Do the linux kernel transcodes to latin-1 or it depends on how it was
> >> configured?  Is it the same for linux, windows and macos?  It's because
> >> I want to retranscode it to utf-8, and I need to know its current
> >> encoding.
> >
> > The USB subsystem transcodes the UTF-16 strings to Latin-1 regardless of
> > configuration options. I have no idea how Windows and MacOS handle that.
>
> Hi Laurent,
>
> For info, starting from 2.6.31 (normally) the usb sub-system will return
> device names in utf-8, see e-mail attached.

I've seen the mails on the linux-usb mailing list. If 2.6.31 breaks the 
uvcvideo driver I'll hold you as personally responsible then ;-)

Thanks for reporting the problem and pushing for a fix.

Regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue May  5 14:29:30 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 5 May 2009 14:29:30 +0200
Subject: [Linux-uvc-devel] VAD Laplace webcam not in list
In-Reply-To: <49FAD687.5070309@web.de>
References: <49FAD687.5070309@web.de>
Message-ID: <200905051429.30358.laurent.pinchart@skynet.be>

Hi Reinhard,

On Friday 01 May 2009 13:01:27 Reinhard Katzmann wrote:
> Hi,
>
> I recently bought the Speedlink VAD Laplace webcam. Unfortunately
> there is no Linux support up to now (I've seen at least 4 questions
> on that topic). It's a 2 MP (Photo, Video 1.3 MP) with some unique
> features over other webcams I've come across by now.
> Speedlink does neither offer Linux nor MAC support (not even older
> Win* versions).
>
> For a sound card I once downloaded USB utilities to analyze some
> behaviour of the card (communication with driver) on Windows but
> didn't need it after all. I'd be willing to help you in this regard
> to get it running.
> My (white) webcam has ID 9003 (vendor ID 1ae7) and I've read that the
> black version has ID 9004. Complete output from lsusb (based on
> /proc/bus/usb/devices) is in attachment. The sound part of the cam
> seems to be recognized by the alsa snd-usb-audio driver.
> A german ubuntu thread is here:
> http://forum.ubuntuusers.de/topic/webcam:-speedlink-vad-laplace/
>
> I checked other webcam drivers before but this card does not seem
> to be supported by any of these (mainly easycam sources).
> The documentation just states how to download current sources
> and build them but is there some more documentation as starting
> point for a developer ? (like simply how do I get to recognize
> my card by the driver).
>
> Please also CC me if you have any more questions/suggestions.

The uvcvideo driver only supports devices compatible with the USB Video Class 
(UVC) specification. Your camera isn't UVC compatible, so it will not be 
supported by the uvcvideo driver.

Your best bet is to check the gspca driver and contact its developers. The 
driver supports many different webcam models, and the developers seem quite 
active.

Best regards and good luck,

Laurent Pinchart



From brucembeach at gmail.com  Wed May  6 01:24:25 2009
From: brucembeach at gmail.com (bruce m beach)
Date: Tue, 5 May 2009 16:24:25 -0700
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
Message-ID: <ebff8ece0905051624g585a19f3s5bd0a2f401bab39e@mail.gmail.com>

 Hello

 I have a Suyin crystal eye webcam that lsusb give as

    Bus 004 Device 002: ID 064e:a103 Suyin Corp

 that I have been trying to make work for the last week
 to no avail. From what I've read this device
 should be no problem.  What I am getting is as follows:

Luvcview
--------
1) sh-4.0# luvcview -f yuv
              luvcview version 0.2.1
              Video driver: x11
              A window manager is available
              video /dev/video0
              Unable to set format: 22.
              Init v4L2 failed !! exit fatal
2) sh-4.0# luvcview
              luvcview version 0.2.1
              Video driver: x11
              A window manager is available
              video /dev/video0
The green light is  on and I have  a green screen. The application
is alive until Play with some of the buttons and I messages like

         ioctl querycontrol error 22
         Set Sharpness down error
         ioctl querycontrol error 22
         Set Sharpness down error
and then it  dies. I have  to use kill -9 to terminate it.

Xawtv
-----
sh-4.0# xawtv -v
          This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
          /dev/video0 [v4l2]: no overlay support
          v4l-conf had some trouble, trying to continue anyway
          Warning: Cannot convert string "-*-ledfixed-medium-r-*--39-*-
.....
          ioctl: VIDIOC_G_STD(std=0xbffca810b7d4e000
[NTSC_M_JP,?,?,SECAM_G,SECAM_K,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null)]):
Invalid argumen

when I click "Grab image (ppm) or "Grab Image (jpeg)" I get:

    no way to get: 384x288 16 bit TrueColor (LE)
    no way to get: 2048x1572 24 bit TrueColor (BE: rgb)

Uvccapture
----------
sh-4.0# uvccapture -v
           Using videodevice: /dev/video0
           Saving images to: snap.jpg
           Image size: 320x240
           Taking snapshot every 0 seconds
           Taking images using mmap
           Resetting camera settings
           ioctl querycontrol error 22
           Camera brightness level is -20
           Camera contrast level is 0
           Camera saturation level is 60
           ioctl querycontrol error 22
           Camera gain level is -1
           Saving image to: snap.jpg

the  green light goes on and off momentarily and gives me the picture
snap.jpg
but nothing (xv, gimp, mplayer) seems  to understand what it is. The first
group of hex chars is

    0d 7c 0c 7f 0d 7b 0f 7d

uname -a gives

Linux lapsystemx 2.6.29.2 #15 PREEMPT Sun May 3 08:09:40 PDT 2009 i686
GNU/Linux

dmesg gives:

  usb 4-1: Product: Crystal Eye webcam
  usb 4-1: Manufacturer: SuYin
  usb 4-1: SerialNumber: CN0314-SN30-OV032-VA-R01.00.00
and
  uvcvideo: Found UVC 1.00 device Crystal Eye webcam (064e:a103)
  input: Crystal Eye webcam as /class/input/input6
  usb 4-1: adding 4-1:1.1 (config #1, interface 1)

One thing that puzzles me is that in a letter to Linux-uvc-devel Tue Feb 17
19:26:30 CET 2009, thread titled: [Linux-uvc-devel] Device ID of my UVC
WebCam
Martin Koller gives lsusb -v as

Bus 004 Device 002: ID 064e:a103 Suyin Corp

which is the same as my webcam but the devices are not the same. Below I
includea diff of the two listings.

Any help to get this thing working is appreciated.

Regards
bruce

0a1
>
14,15c15,16
<   iProduct                1 Acer Crystal Eye webcam
<   iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02
---
>   iProduct                1 Crystal Eye webcam
>   iSerial                 3 CN0314-SN30-OV032-VA-R01.00.00
20c21
<     wTotalLength          544
---
>     wTotalLength          528
35c36
<       iFunction               5 Acer Crystal Eye webcam
---
>       iFunction               5 Crystal Eye webcam
45c46
<       iInterface              5 Acer Crystal Eye webcam
---
>       iInterface              5 Crystal Eye webcam
147,148c148,149
<         bNumFormats                        1
<         wTotalLength                      297
---
>         bNumFormats                         1
>         wTotalLength                      281
156c157
<         bmaControls( 0)                    27
---
>         bmaControls( 0)                    11
158c159
<         bLength                            27
---
>         bLength                            11
160c161
<         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
---
>         bDescriptorSubtype                  6 (FORMAT_MJPEG)
163,164c164,165
<         guidFormat
{59555932-0000-1000-8000-00aa00389b71}
<         bBitsPerPixel                      16
---
>         bFlags                              0
>           Fixed-size samples: No
177c178
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
183,185c184,186
<         dwMinBitRate                  3072000
<         dwMaxBitRate                 18432000
<         dwMaxVideoFrameBufferSize      614400
---
>         dwMinBitRate                   153600
>         dwMaxBitRate                   921600
>         dwMaxVideoFrameBufferSize       30720
197c198
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
203,205c204,206
<         dwMinBitRate                  1013760
<         dwMaxBitRate                  6082560
<         dwMaxVideoFrameBufferSize      202752
---
>         dwMinBitRate                    50685
>         dwMaxBitRate                   304110
>         dwMaxVideoFrameBufferSize       10137
217c218
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
223,225c224,226
<         dwMinBitRate                   768000
<         dwMaxBitRate                  4608000
<         dwMaxVideoFrameBufferSize      153600
---
>         dwMinBitRate                    38400
>         dwMaxBitRate                   230400
>         dwMaxVideoFrameBufferSize        7680
237c238
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
243,245c244,246
<         dwMinBitRate                   253440
<         dwMaxBitRate                  1520640
<         dwMaxVideoFrameBufferSize       50688
---
>         dwMinBitRate                    12670
>         dwMaxBitRate                    76020
>         dwMaxVideoFrameBufferSize        2534
257c258
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
263,265c264,266
<         dwMinBitRate                   192000
<         dwMaxBitRate                  1152000
<         dwMaxVideoFrameBufferSize       38400
---
>         dwMinBitRate                     9600
>         dwMaxBitRate                    57600
>         dwMaxVideoFrameBufferSize        1920
339c340
<         wMaxPacketSize     0x0320  1x 800 bytes
---
>         wMaxPacketSize     0x0200  1x 512 bytes
359c360
<         wMaxPacketSize     0x0b20  2x 800 bytes
---
>         wMaxPacketSize     0x0258  1x 600 bytes
379c380
<         wMaxPacketSize     0x1320  3x 800 bytes
---
>         wMaxPacketSize     0x0320  1x 800 bytes
399c400
<         wMaxPacketSize     0x1400  3x 1024 bytes
---
>         wMaxPacketSize     0x03bc  1x 956 bytes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090505/eb6c5c3d/attachment.html>

From legrain at crans.org  Wed May  6 08:08:50 2009
From: legrain at crans.org (Gregory LEGRAIN)
Date: Wed, 6 May 2009 08:08:50 +0200
Subject: [Linux-uvc-devel] Strange issue with Hercules Dualpix Infinite
In-Reply-To: <200904301726.13693.laurent.pinchart@skynet.be>
References: <200904300800.04057.legrain@crans.org>
	<200904301726.13693.laurent.pinchart@skynet.be>
Message-ID: <200905060808.51553.legrain@crans.org>

Hi Laurent,
It works !
I had troubles to recompile uvc trunk against my kernel (a bit too old !), but 
with the archives you provide, it is ok.

Thank you very much !

However, I have a couple of questions :-) :
* Did you recently modified the way you treat the frame descriptor ? (as the 
webcam worked with old versions of uvc)
* I assume that this workaround will not be integrated in the trunk, which 
means that I'll have to apply the patch for every kernel update (not really a 
problem). But I was wondering if you often modify uvc_driver.c ? (to have an 
expected lifetime of the patch, and so how often I will have to bother you ;-) 
(only if I cannot modify the source by myself!)  )

Thanks a lot,
Gregory

Le jeudi 30 avril 2009 17:26:13, Laurent Pinchart a ?crit :
> Hi Gregory,
>
> On Thursday 30 April 2009 08:00:03 Gregory LEGRAIN wrote:
> > Hi Laurent,
> > it seems that my previous mail was buried under tons of other mails
> > during your holidays :-)
>
> Seems my attempt to escape from your attention didn't went unnoticed :-)
>
> > You asked me to set the trace parameter to 255 when loading the driver. I
> > did it, and attached the output with this mail.
>
> Thanks. I see what's wrong. Your device is not UVC compliant :-S
>
> There's a small error in the UVC descriptors that prevent the driver from
> detecting the device correctly. The uncompressed frame descriptors should
> be numbered from 1 to 7, but they are instead numbered from 1 to 8 with
> number 7 missing.
>
> According to the UVC specification, the bFrameIndex field "selects the
> video frame resolution from the array of resolutions supported by the
> selected stream. The index value ranges from 1 to the number of Frame
> descriptors following a particular Format descriptor." The device is thus
> not UVC compliant.
>
> Here's a patch that should fix the issue. It hasn't been stress-tested, so
> it might crash your kernel. Please let me know if it helps.
>
> Best regards,
>
> Laurent Pinchart



From ospite at studenti.unina.it  Wed May  6 16:43:54 2009
From: ospite at studenti.unina.it (Antonio Ospite)
Date: Wed, 6 May 2009 16:43:54 +0200
Subject: [Linux-uvc-devel] Fw: UVC gadget driver for linux.
Message-ID: <20090506164354.5a1b4903.ospite@studenti.unina.it>

Subscribed now.

Begin forwarded message:

Date: Wed, 6 May 2009 16:15:42 +0200
From: Antonio Ospite <ospite at studenti.unina.it>
To: linux-uvc-devel at lists.berlios.de, Linux Media Mailing List
<linux-media at vger.kernel.org> Subject: UVC gadget driver for linux.


Hi,

(I am not subscribed to linux-uvc-devel, so please CC me on reply)

I found this UVC gadget driver for linux developed by Motorola for the
EzX platform, it should be the very same driver which makes the Motorola
ROCKR E6[1,1a] show up as a UVC webcam. It's for linux-2.4, I haven't
looked at it very deeply and I can't comment on its status, but I just
thought to report about it because someone might want to port it to 2.6
and v4l2.

The original tarball is at opensource.motorola.com[2].

You can find a browsable copy of it at git.openezx.org[3].

the relevant filenames are:
  ./drivers/media/video/camera4uvc.c
  ./drivers/media/video/camera4uvc.h
  ./drivers/usbd/UVC_fd
  ./drivers/usbd/UVC_fd/uvc.c
  ./drivers/usbd/UVC_fd/uvc.h

Regards,
   Antonio Ospite

[1]
http://www.motorola.com/motoinfo/product/details.jsp?globalObjectId=175

[1a]
http://lists.berlios.de/pipermail/linux-uvc-devel/2007-October/002305.html

[2]
https://opensource.motorola.com/sf/frs/do/downloadFile/projects.a1200/frs.a1200e_latam.r541l7_g_11_10_11r/frs6837?dl=1

[3]
http://git.openezx.org/?p=motorola-2.4.git;a=tree;h=1627c6705140336fdd043af3141b57e752fbbdd2;hb=53e66c3b1448c5679cb34d64e18cca65830a25b3

-- 
A: Because it messes up the order in which people normally read text.
Q: Why is top-posting such a bad thing?
A: Top-posting.
Q: What is the most annoying thing in e-mail?

  Web site: http://www.studenti.unina.it/~ospite
Public key: http://www.studenti.unina.it/~ospite/aopubkey.asc
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090506/9facb7ed/attachment.pgp>

From ma2412ma at hotmail.com  Thu May  7 09:00:22 2009
From: ma2412ma at hotmail.com (Hans Meier)
Date: Thu, 7 May 2009 07:00:22 +0000
Subject: [Linux-uvc-devel] Lenovo EasyCamera (5986:0205)
Message-ID: <BLU140-W3697926FBC2FB4C26929E6CA670@phx.gbl>


Hi,
I have a Lenovo N500 with integrated webcam. The device ID is 5986:0205, and the camera works with quirks=2. Can you please add support for this cam?
Best,Hans
_________________________________________________________________
http://redirect.gimas.net/?n=M0905xIE8_MSN4
Internet Explorer 8 jetzt f?r MSN  - kostenlos!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090507/d4162b8f/attachment.html>

From brucembeach at gmail.com  Fri May  8 03:38:51 2009
From: brucembeach at gmail.com (bruce m beach)
Date: Thu, 7 May 2009 18:38:51 -0700
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
Message-ID: <ebff8ece0905071838g36acf047qaf850464de0fc1a8@mail.gmail.com>

(I already sent this message but I don't think it made it to the list.
If you have
 already recieved it my apologies)

 Hello

 I have a Suyin crystal eye webcam that lsusb give as

    Bus 004 Device 002: ID 064e:a103 Suyin Corp

 that I have been trying to make work for the last week
 to no avail. From what I've read this device
 should be no problem.  What I am getting is as follows:

Luvcview
--------
1) sh-4.0# luvcview -f yuv
              luvcview version 0.2.1
              Video driver: x11
              A window manager is available
              video /dev/video0
              Unable to set format: 22.
              Init v4L2 failed !! exit fatal
2) sh-4.0# luvcview
              luvcview version 0.2.1
              Video driver: x11
              A window manager is available
              video /dev/video0
The green light is  on and I have  a green screen. The application
is alive until Play with some of the buttons and I messages like

         ioctl querycontrol error 22
         Set Sharpness down error
         ioctl querycontrol error 22
         Set Sharpness down error
and then it  dies. I have  to use kill -9 to terminate it.

Xawtv
-----
sh-4.0# xawtv -v
          This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
          /dev/video0 [v4l2]: no overlay support
          v4l-conf had some trouble, trying to continue anyway
          Warning: Cannot convert string "-*-ledfixed-medium-r-*--39-*- .....
          ioctl: VIDIOC_G_STD(std=0xbffca810b7d4e000
[NTSC_M_JP,?,?,SECAM_G,SECAM_K,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null)]):
Invalid argumen

when I click "Grab image (ppm) or "Grab Image (jpeg)" I get:

    no way to get: 384x288 16 bit TrueColor (LE)
    no way to get: 2048x1572 24 bit TrueColor (BE: rgb)

Uvccapture
----------
sh-4.0# uvccapture -v
           Using videodevice: /dev/video0
           Saving images to: snap.jpg
           Image size: 320x240
           Taking snapshot every 0 seconds
           Taking images using mmap
           Resetting camera settings
           ioctl querycontrol error 22
           Camera brightness level is -20
           Camera contrast level is 0
           Camera saturation level is 60
           ioctl querycontrol error 22
           Camera gain level is -1
           Saving image to: snap.jpg

the  green light goes on and off momentarily and gives me the picture snap.jpg
but nothing (xv, gimp, mplayer) seems  to understand what it is. The first
group of hex chars is

    0d 7c 0c 7f 0d 7b 0f 7d

uname -a gives

Linux lapsystemx 2.6.29.2 #15 PREEMPT Sun May 3 08:09:40 PDT 2009 i686 GNU/Linux

dmesg gives:

  usb 4-1: Product: Crystal Eye webcam
  usb 4-1: Manufacturer: SuYin
  usb 4-1: SerialNumber: CN0314-SN30-OV032-VA-R01.00.00
and
  uvcvideo: Found UVC 1.00 device Crystal Eye webcam (064e:a103)
  input: Crystal Eye webcam as /class/input/input6
  usb 4-1: adding 4-1:1.1 (config #1, interface 1)

One thing that puzzles me is that in a letter to Linux-uvc-devel Tue Feb 17
19:26:30 CET 2009, thread titled: [Linux-uvc-devel] Device ID of my UVC WebCam
Martin Koller gives lsusb -v as

Bus 004 Device 002: ID 064e:a103 Suyin Corp

which is the same as my webcam but the devices are not the same. Below I
includea diff of the two listings.

Any help to get this thing working is appreciated.

Regards
bruce

0a1
>
14,15c15,16
<   iProduct                1 Acer Crystal Eye webcam
<   iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02
---
>   iProduct                1 Crystal Eye webcam
>   iSerial                 3 CN0314-SN30-OV032-VA-R01.00.00
20c21
<     wTotalLength          544
---
>     wTotalLength          528
35c36
<       iFunction               5 Acer Crystal Eye webcam
---
>       iFunction               5 Crystal Eye webcam
45c46
<       iInterface              5 Acer Crystal Eye webcam
---
>       iInterface              5 Crystal Eye webcam
147,148c148,149
<         bNumFormats                        1
<         wTotalLength                      297
---
>         bNumFormats                         1
>         wTotalLength                      281
156c157
<         bmaControls( 0)                    27
---
>         bmaControls( 0)                    11
158c159
<         bLength                            27
---
>         bLength                            11
160c161
<         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
---
>         bDescriptorSubtype                  6 (FORMAT_MJPEG)
163,164c164,165
<         guidFormat
{59555932-0000-1000-8000-00aa00389b71}
<         bBitsPerPixel                      16
---
>         bFlags                              0
>           Fixed-size samples: No
177c178
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
183,185c184,186
<         dwMinBitRate                  3072000
<         dwMaxBitRate                 18432000
<         dwMaxVideoFrameBufferSize      614400
---
>         dwMinBitRate                   153600
>         dwMaxBitRate                   921600
>         dwMaxVideoFrameBufferSize       30720
197c198
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
203,205c204,206
<         dwMinBitRate                  1013760
<         dwMaxBitRate                  6082560
<         dwMaxVideoFrameBufferSize      202752
---
>         dwMinBitRate                    50685
>         dwMaxBitRate                   304110
>         dwMaxVideoFrameBufferSize       10137
217c218
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
223,225c224,226
<         dwMinBitRate                   768000
<         dwMaxBitRate                  4608000
<         dwMaxVideoFrameBufferSize      153600
---
>         dwMinBitRate                    38400
>         dwMaxBitRate                   230400
>         dwMaxVideoFrameBufferSize        7680
237c238
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
243,245c244,246
<         dwMinBitRate                   253440
<         dwMaxBitRate                  1520640
<         dwMaxVideoFrameBufferSize       50688
---
>         dwMinBitRate                    12670
>         dwMaxBitRate                    76020
>         dwMaxVideoFrameBufferSize        2534
257c258
<         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
---
>         bDescriptorSubtype                  7 (FRAME_MJPEG)
263,265c264,266
<         dwMinBitRate                   192000
<         dwMaxBitRate                  1152000
<         dwMaxVideoFrameBufferSize       38400
---
>         dwMinBitRate                     9600
>         dwMaxBitRate                    57600
>         dwMaxVideoFrameBufferSize        1920
339c340
<         wMaxPacketSize     0x0320  1x 800 bytes
---
>         wMaxPacketSize     0x0200  1x 512 bytes
359c360
<         wMaxPacketSize     0x0b20  2x 800 bytes
---
>         wMaxPacketSize     0x0258  1x 600 bytes
379c380
<         wMaxPacketSize     0x1320  3x 800 bytes
---
>         wMaxPacketSize     0x0320  1x 800 bytes
399c400
<         wMaxPacketSize     0x1400  3x 1024 bytes
---
>         wMaxPacketSize     0x03bc  1x 956 bytes


From laurent.pinchart at skynet.be  Tue May 12 16:01:53 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 May 2009 16:01:53 +0200
Subject: [Linux-uvc-devel] Fw: UVC gadget driver for linux.
In-Reply-To: <20090506164354.5a1b4903.ospite@studenti.unina.it>
References: <20090506164354.5a1b4903.ospite@studenti.unina.it>
Message-ID: <200905121601.53482.laurent.pinchart@skynet.be>

Hi Antonio,

On Wednesday 06 May 2009 16:43:54 Antonio Ospite wrote:
> I found this UVC gadget driver for linux developed by Motorola for the
> EzX platform, it should be the very same driver which makes the Motorola
> ROCKR E6[1,1a] show up as a UVC webcam. It's for linux-2.4, I haven't
> looked at it very deeply and I can't comment on its status, but I just
> thought to report about it because someone might want to port it to 2.6
> and v4l2.
>
> The original tarball is at opensource.motorola.com[2].
>
> You can find a browsable copy of it at git.openezx.org[3].
>
> the relevant filenames are:
>   ./drivers/media/video/camera4uvc.c
>   ./drivers/media/video/camera4uvc.h
>   ./drivers/usbd/UVC_fd
>   ./drivers/usbd/UVC_fd/uvc.c
>   ./drivers/usbd/UVC_fd/uvc.h

Thanks for the information.

I had a quick look at the code, and it seems the driver is closely tied to the 
Motorola EzX platform. It interfaces directly to the on-board camera, making 
it difficult to reuse as a generic UVC driver.

A proper generic UVC gadget driver should expose a V4L2 interface. I have no 
such code to release for the moment, but if you're not in a hurry you can 
expect code to be released in the (still undetermined) future.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue May 12 16:04:43 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 May 2009 16:04:43 +0200
Subject: [Linux-uvc-devel] Lenovo EasyCamera (5986:0205)
In-Reply-To: <BLU140-W3697926FBC2FB4C26929E6CA670@phx.gbl>
References: <BLU140-W3697926FBC2FB4C26929E6CA670@phx.gbl>
Message-ID: <200905121604.44200.laurent.pinchart@skynet.be>

Hi Hans,

On Thursday 07 May 2009 09:00:22 Hans Meier wrote:
> Hi,
> I have a Lenovo N500 with integrated webcam. The device ID is 5986:0205,
> and the camera works with quirks=2. Can you please add support for this
> cam?

0x5986 devices should be supported by the latest driver without quirks=2. 
Could you please have a try and report success/failure ?

If you send me the complete lsusb -v output for your device (using usbutils 
0.72 or newer - 0.73+ preferred) I will update the supported devices list on 
the website.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue May 12 16:12:04 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 May 2009 16:12:04 +0200
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
In-Reply-To: <ebff8ece0905051624g585a19f3s5bd0a2f401bab39e@mail.gmail.com>
References: <ebff8ece0905051624g585a19f3s5bd0a2f401bab39e@mail.gmail.com>
Message-ID: <200905121612.06122.laurent.pinchart@skynet.be>

Hi Bruce,

On Wednesday 06 May 2009 01:24:25 bruce m beach wrote:
>  Hello
>
>  I have a Suyin crystal eye webcam that lsusb give as
>
>     Bus 004 Device 002: ID 064e:a103 Suyin Corp
>
>  that I have been trying to make work for the last week
>  to no avail. From what I've read this device
>  should be no problem.  What I am getting is as follows:
>
> Luvcview
> --------
> 1) sh-4.0# luvcview -f yuv
>               luvcview version 0.2.1
>               Video driver: x11
>               A window manager is available
>               video /dev/video0
>               Unable to set format: 22.
>               Init v4L2 failed !! exit fatal

Your device only supports MJPEG so this is expected.

> 2) sh-4.0# luvcview
>               luvcview version 0.2.1
>               Video driver: x11
>               A window manager is available
>               video /dev/video0
> The green light is  on and I have  a green screen.

This probably means that the driver doesn't receive enough data to fill a 
video frame. Are you running the latest driver ? There is a known bug in older 
versions that cause frames to be incorrectly dropped under specific 
circumstances.

> The application is alive until Play with some of the buttons and I messages
> like
>
>          ioctl querycontrol error 22
>          Set Sharpness down error
>          ioctl querycontrol error 22
>          Set Sharpness down error
> and then it  dies. I have  to use kill -9 to terminate it.
>
> Xawtv
> -----
> sh-4.0# xawtv -v
>           This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
>           /dev/video0 [v4l2]: no overlay support
>           v4l-conf had some trouble, trying to continue anyway
>           Warning: Cannot convert string "-*-ledfixed-medium-r-*--39-*-
> .....
>           ioctl: VIDIOC_G_STD(std=0xbffca810b7d4e000
> [NTSC_M_JP,?,?,SECAM_G,SECAM_K,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null
>),(null),(null),(null),(null),(null),(null),(null),(null),(null),(null),(nul
>l),(null),(null),(null),(null),(null),(null),(null),(null),(null)]): Invalid
> argumen
>
> when I click "Grab image (ppm) or "Grab Image (jpeg)" I get:
>
>     no way to get: 384x288 16 bit TrueColor (LE)
>     no way to get: 2048x1572 24 bit TrueColor (BE: rgb)
>
> Uvccapture
> ----------
> sh-4.0# uvccapture -v
>            Using videodevice: /dev/video0
>            Saving images to: snap.jpg
>            Image size: 320x240
>            Taking snapshot every 0 seconds
>            Taking images using mmap
>            Resetting camera settings
>            ioctl querycontrol error 22
>            Camera brightness level is -20
>            Camera contrast level is 0
>            Camera saturation level is 60
>            ioctl querycontrol error 22
>            Camera gain level is -1
>            Saving image to: snap.jpg
>
> the  green light goes on and off momentarily and gives me the picture
> snap.jpg
> but nothing (xv, gimp, mplayer) seems  to understand what it is. The first
> group of hex chars is
>
>     0d 7c 0c 7f 0d 7b 0f 7d
>
> uname -a gives
>
> Linux lapsystemx 2.6.29.2 #15 PREEMPT Sun May 3 08:09:40 PDT 2009 i686
> GNU/Linux
>
> dmesg gives:
>
>   usb 4-1: Product: Crystal Eye webcam
>   usb 4-1: Manufacturer: SuYin
>   usb 4-1: SerialNumber: CN0314-SN30-OV032-VA-R01.00.00
> and
>   uvcvideo: Found UVC 1.00 device Crystal Eye webcam (064e:a103)
>   input: Crystal Eye webcam as /class/input/input6
>   usb 4-1: adding 4-1:1.1 (config #1, interface 1)
>
> One thing that puzzles me is that in a letter to Linux-uvc-devel Tue Feb 17
> 19:26:30 CET 2009, thread titled: [Linux-uvc-devel] Device ID of my UVC
> WebCam
> Martin Koller gives lsusb -v as
>
> Bus 004 Device 002: ID 064e:a103 Suyin Corp
>
> which is the same as my webcam but the devices are not the same. Below I
> includea diff of the two listings.

That doesn't surprise me much, vendors often change devices without modifying 
the PID or the version.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue May 12 16:18:22 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 May 2009 16:18:22 +0200
Subject: [Linux-uvc-devel] Strange issue with Hercules Dualpix Infinite
In-Reply-To: <200905060808.51553.legrain@crans.org>
References: <200904300800.04057.legrain@crans.org>
	<200904301726.13693.laurent.pinchart@skynet.be>
	<200905060808.51553.legrain@crans.org>
Message-ID: <200905121618.22937.laurent.pinchart@skynet.be>

Hi Gregory,

On Wednesday 06 May 2009 08:08:50 Gregory LEGRAIN wrote:
> Hi Laurent,
> It works !
> I had troubles to recompile uvc trunk against my kernel (a bit too old !),
> but with the archives you provide, it is ok.
>
> Thank you very much !

You're welcome.

> However, I have a couple of questions :-) :
> * Did you recently modified the way you treat the frame descriptor ? (as
> the webcam worked with old versions of uvc)

Not sure about recently, but it has been modified in the past, yes.

> * I assume that this workaround will not be integrated in the trunk, which
> means that I'll have to apply the patch for every kernel update (not really
> a problem). But I was wondering if you often modify uvc_driver.c ? (to have
> an expected lifetime of the patch, and so how often I will have to bother
> you ;-) (only if I cannot modify the source by myself!)  )

You're wrong, sorry. Or actually not so sorry, as it means the patch will be 
included in the mainline driver :-)

Best regards,

Laurent Pinchart



From gmjlazzarini at bol.com.br  Tue May 12 21:32:11 2009
From: gmjlazzarini at bol.com.br (gmjlazzarini at bol.com.br)
Date: Tue, 12 May 2009 16:32:11 -0300
Subject: [Linux-uvc-devel] ID 0402:5602 ALi Corp
Message-ID: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>

An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090512/da82d17e/attachment.html>

From enr.dilello at gmail.com  Tue May 12 22:44:29 2009
From: enr.dilello at gmail.com (Enrico Di Lello)
Date: Tue, 12 May 2009 22:44:29 +0200
Subject: [Linux-uvc-devel] Compile UVC for embedded system
Message-ID: <9ad1ec5d0905121344j5ee2ff09m6d7c21701fd8674f@mail.gmail.com>

Hi everybody,

I am developing a vision system for a mobile robot equipped with a FOX
board, running an embedded linux system based on openWRT.

In older version of the openWRT trunk it was possible to compile thto
wore uvcvideo.ko as an external module. I managed to find an old
makefile to compile the UVCdriver from the SVN (r263) . Unfortunately,
with this driver I did not get my UVC camera (a Creative Optia Pro) to
work properly.

In particular, mi code fails when trying to set YUYV format for the
camera, which instea goes fine with my ubuntu PC. I know that the SVN
is deprecated, so I downloaded a proper UVC version from linuxTV.org

Everything goes fine after compiling the driver under Ubuntu.

The problem is that is kinda hard to compile the driver for my
embedded system, since now, the uvcvideo package contains almost a
zilliion different drivers with 10 nested makefiles and so on..

I just need to compile uvcvideo.ko using as less files as possible and
a proper Makefile..

Any Ideas?? Thank you in advance for your help.


From laurent.pinchart at skynet.be  Thu May 14 01:06:45 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 14 May 2009 01:06:45 +0200
Subject: [Linux-uvc-devel] ID 0402:5602 ALi Corp
In-Reply-To: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>
References: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>
Message-ID: <200905140106.46145.laurent.pinchart@skynet.be>

Hi Gustavo,

On Tuesday 12 May 2009 21:32:11 gmjlazzarini at bol.com.br wrote:
> My UVC device is not in your list. It is ID 0402:5602 ALi Corp. Video
> Camera Controller
>
> Can you help me?

Please post the output of

lsusb -v -d 0402:5602

using usbutils 0.72 or newer (0.73+ preferred).

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Thu May 14 01:25:17 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 14 May 2009 01:25:17 +0200
Subject: [Linux-uvc-devel] Compile UVC for embedded system
In-Reply-To: <9ad1ec5d0905121344j5ee2ff09m6d7c21701fd8674f@mail.gmail.com>
References: <9ad1ec5d0905121344j5ee2ff09m6d7c21701fd8674f@mail.gmail.com>
Message-ID: <200905140125.17801.laurent.pinchart@skynet.be>

Hi Enrico,

On Tuesday 12 May 2009 22:44:29 Enrico Di Lello wrote:
> Hi everybody,
>
> I am developing a vision system for a mobile robot equipped with a FOX
> board, running an embedded linux system based on openWRT.
>
> In older version of the openWRT trunk it was possible to compile thto
> wore uvcvideo.ko as an external module. I managed to find an old
> makefile to compile the UVCdriver from the SVN (r263) . Unfortunately,
> with this driver I did not get my UVC camera (a Creative Optia Pro) to
> work properly.
>
> In particular, mi code fails when trying to set YUYV format for the
> camera, which instea goes fine with my ubuntu PC. I know that the SVN
> is deprecated, so I downloaded a proper UVC version from linuxTV.org
>
> Everything goes fine after compiling the driver under Ubuntu.
>
> The problem is that is kinda hard to compile the driver for my
> embedded system, since now, the uvcvideo package contains almost a
> zilliion different drivers with 10 nested makefiles and so on..
>
> I just need to compile uvcvideo.ko using as less files as possible and
> a proper Makefile..
>
> Any Ideas?? Thank you in advance for your help.

Following the move to linuxtv.org and its mercurial repositories, the uvcvideo 
can't be compiled alone anymore. I understand that this can be an additional 
burden for some users, especially when working with embedded systems, but 
maintaining compatibility with older kernels was becoming a real pain.

Fortunately, it shouldn't be too difficult to compile the whole V4L subsystem 
for the openWRT platform. The Mercurial tree comes with a top-level Makefile. 
If you point it to the location of your kernel sources (using the SRCDIR 
variable), it should compile all the V4L modules. Don't forget to disable V4L 
support (or at least configure it as modules) in your kernel.

Best regards,

Laurent Pinchart



From gmjlazzarini at bol.com.br  Thu May 14 13:36:48 2009
From: gmjlazzarini at bol.com.br (gmjlazzarini at bol.com.br)
Date: Thu, 14 May 2009 08:36:48 -0300
Subject: [Linux-uvc-devel] ID 0402:5602 ALi Corp
In-Reply-To: <200905140106.46145.laurent.pinchart@skynet.be>
References: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>
	<200905140106.46145.laurent.pinchart@skynet.be>
Message-ID: <4a0c02501e1f4_15cf1555555879b41579@winter22.tmail>

An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090514/5522a182/attachment.html>

From laurent.pinchart at skynet.be  Thu May 14 13:46:54 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 14 May 2009 13:46:54 +0200
Subject: [Linux-uvc-devel] ID 0402:5602 ALi Corp
In-Reply-To: <4a0c02501e1f4_15cf1555555879b41579@winter22.tmail>
References: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>
	<200905140106.46145.laurent.pinchart@skynet.be>
	<4a0c02501e1f4_15cf1555555879b41579@winter22.tmail>
Message-ID: <200905141346.54509.laurent.pinchart@skynet.be>

Hi Gustavo,

On Thursday 14 May 2009 13:36:48 gmjlazzarini at bol.com.br wrote:
> Hi Laurent
>  
> The output of 0402-5602 (from usbutils 0.73)

Next time please use plain-text rather than HTML, the formatting is completely 
messed up.
  
Anyway, your camera is not UVC compatible so it will never be supported by the 
uvcvideo driver. You might have more luck contacting the gspca driver 
developers.

Good luck and best regards,

Laurent Pinchart



From P at draigBrady.com  Thu May 14 14:04:52 2009
From: P at draigBrady.com (=?UTF-8?B?UMOhZHJhaWcgQnJhZHk=?=)
Date: Thu, 14 May 2009 13:04:52 +0100
Subject: [Linux-uvc-devel] ID 0402:5602 ALi Corp
In-Reply-To: <4a0c02501e1f4_15cf1555555879b41579@winter22.tmail>
References: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>	<200905140106.46145.laurent.pinchart@skynet.be>
	<4a0c02501e1f4_15cf1555555879b41579@winter22.tmail>
Message-ID: <4A0C08E4.5020104@draigBrady.com>

gmjlazzarini at bol.com.br wrote:
> Hi Laurent
> 
>  
> 
> The output of 0402-5602 (from usbutils 0.73)
> 
>  
> 
> Bus 006 Device 002: ID 0402:5602 ALi Corp. Video Camera Controller

We use the "pwc" driver with that


From gmjlazzarini at bol.com.br  Thu May 14 22:01:33 2009
From: gmjlazzarini at bol.com.br (gmjlazzarini at bol.com.br)
Date: Thu, 14 May 2009 17:01:33 -0300
Subject: [Linux-uvc-devel] ID 0402:5602 ALi Corp
In-Reply-To: <4A0C08E4.5020104@draigBrady.com>
References: <4a09cebbf35bd_51d11555555879b41b8@winter16.tmail>
	<200905140106.46145.laurent.pinchart@skynet.be>
	<4a0c02501e1f4_15cf1555555879b41579@winter22.tmail>
	<4A0C08E4.5020104@draigBrady.com>
Message-ID: <4a0c789de1974_15f11555555879b426@winter11.tmail>

An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090514/d2c04883/attachment.html>

From brucembeach at gmail.com  Fri May 15 04:46:16 2009
From: brucembeach at gmail.com (bruce m beach)
Date: Thu, 14 May 2009 19:46:16 -0700
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
Message-ID: <ebff8ece0905141946r67c21dbtd0d9a653df082cf3@mail.gmail.com>

 Hello Laurent

>>  On Wednesday 06 May 2009 01:24:25 bruce m beach wrote:
>>  I have a Suyin crystal eye webcam that lsusb give as
>>  Bus 004 Device 002: ID 064e:a103 Suyin Corp ....

>> 1) sh-4.0# luvcview -f yuv
>>               Init v4L2 failed !! exit fatal

> Your device only supports MJPEG so this is expected.

  Given that if this webcam was working  should I expect the command

     >luvcview

  to then work?

>> 2) sh-4.0# luvcview
>> The green light is  on and I have  a green screen.

> This probably means that the driver doesn't receive enough
> data to fill a video frame. Are you running the latest
> driver ? There is a known bug in older versions that cause frames to be
> incorrectly dropped under specific circumstances.

  Okay. I did a:

      hg clone http://linuxtv.org/hg/~pinchartl/uvcvideo/

 Then I did

 mv /lib/modules /lib/modules.HIDE
 make modules (from the kernel tree)
 etc.

to get rid of any modules.  I don't use modules if I can help it and a
a search for *.ko gave a dummy.ko and some scsi_something_or_other.ko
I then built the  tree and installed it.
   make
   make install

and after booting:

  modprobe  uvcvideo

dmesg gives

   uvcvideo 4-1:1.0: usb_probe_interface
   uvcvideo 4-1:1.0: usb_probe_interface - got id
   uvcvideo: Found UVC 1.00 device Crystal Eye webcam (064e:a103)
   input: Crystal Eye webcam as /class/input/input7
   usbcore: registered new interface driver uvcvideo
   USB Video Class driver (v0.1.0)

   (Begin: lsusb stuff)
>> which is the same as my webcam but the devices are not the same. Below I
>> includea diff of the two listings.

>     That doesn't surprise me much, vendors often change devices
>     without modifying the PID or the version.

Okay. I then assume even though the USB listing is different
the webcam should function. If you do want a complete lsusb
listing for your records let me know.
   (End: lsusb stuff)

I have been looking at this frontwards, backwards,
upsidedown and around and still haven't got it working. At
this point my feeling is that there is nothing wrong with
the uvcvideo driver ( at least in terms of getting crystal
eye webcam basic functionality ) but that there is
something wrong with my system. Somehow the webcam driver
is not getting something that it needs. Supporting this is
another webcam ( 0c45:6009 Microdia VideoCAM ExpressII) that
I have been using for testing giving the same results as the
crystal eye which is puzzling to me:

  >xawtv
sh-4.0# xawtv
        This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
        xinerama 0: 1280x800+0+0
        /dev/video0 [v4l2]: no overlay support
        v4l-conf had some trouble, trying to continue anyway
        Warning: Cannot convert string
               "-*-ledfixed-medium-r-*--39-*-*-*-c-*-*-*" to type FontStruct
        ioctl: VIDIOC_G_STD(std=0xafcbe0d0a7d612b0
        [PAL_I,PAL_D,PAL_K,PAL_N,NTSC_M,
        SECAM_D,SECAM_G,SECAM_K,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,
        (null),(null),(null),(null),(null),(null),(null),(null),(null),(null),
        (null),(null),(null),(null),(null),(null),(null),(null),(null),(null),
        (null)]): Invalid argument
        ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument

and then on an attempt  to grab (ppm) (jpeg)

    (no cut and paste here because the webcam just died with :
        sh-4.0# xawtv
        This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
        xinerama 0: 1280x800+0+0
        X Error of failed request:  XF86DGANoDirectVideoMode
        Major opcode of failed request:  136 (XFree86-DGA)
        Minor opcode of failed request:  1 (XF86DGAGetVideoLL)
        Serial number of failed request:  67
        Current serial number in output stream:  67
     )

why is the ioctl call failing and why does it keep telling me
     no way to get: 384x288 16 bit TrueColor (LE)
     no way to get: 2048x1572 24 bit TrueColor (BE: rgb)

I have a "Logitech, Inc. QuickCam Pro 4000" that uses
   the pwc.ko module and it works fine.

One issue could be that the ATI RS690M X1200 Series chip
doesn't have enough support. As of the  last time I wrote I
was looking for a source of  the problem and I notice to my
horror that  the XFree86 driver was "vesa"
 (from XFree86 -configure)
and that XFree didn't have any support whatsoever for the
video chip. There was one of those horrific proprietory
drivers that I tried to build but soon realized that even
Knuth would never get the thing built.  Fortunately Xorg has
good support for the chip so I rebuilt the x-system using
Xorg code.

Anyway any ideas as to how to proceed are appreciated.

Bruce


From enr.dilello at gmail.com  Fri May 15 10:58:52 2009
From: enr.dilello at gmail.com (Enrico Di Lello)
Date: Fri, 15 May 2009 10:58:52 +0200
Subject: [Linux-uvc-devel] Still trying to use uvcvideo in an embedded system
Message-ID: <9ad1ec5d0905150158u27c6decak8594d0a3376faddc@mail.gmail.com>

Hi Laurent,

thank for your early reply. I don't know if I should send this mail in
the mailing list or directly to you.
I think that my problem is pretty simple, and since your name is on
the comments of the uvc_video source code, I think you're the best
person I could ask for help .

I did not manage, for now to compile the mercurial package for my
system, but I managed to compile the r261 version from the berlios
repository. I wrote a simple application to grab a frame from a camera
in YUV422 format.

The problem is: this application I wrote works just fine on my ubuntu
laptop with uvcvideo (Mercurial repository). Camera recognized, YUV422
format set, frame grabbing runs just fine.

When I connect the same webcam ( Creative Optia ) on my FoxBoard, the
system does recognize the camera, because I can see it in dmesg.

When I run the same application, I receive an error when trying to set
the YUV422 format. More precisely, the VIDIOC_S_FMT fails when
requiring this format.

Surprisingly, it successfully sets the format if I choose the MJPEG format.


From pj.assis at gmail.com  Fri May 15 19:08:34 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 15 May 2009 18:08:34 +0100
Subject: [Linux-uvc-devel] Still trying to use uvcvideo in an embedded
	system
In-Reply-To: <9ad1ec5d0905150158u27c6decak8594d0a3376faddc@mail.gmail.com>
References: <9ad1ec5d0905150158u27c6decak8594d0a3376faddc@mail.gmail.com>
Message-ID: <59cf47a80905151008r501e55a4lfb0e1c12c5f7b4f8@mail.gmail.com>

Enrico,
Does the  FoxBoard supports usb 2.0 or 1.1 ports?
Some cameras only enable yuv format when connected to a usb 2 port.

Best regards,
Paulo

2009/5/15 Enrico Di Lello <enr.dilello at gmail.com>

> Hi Laurent,
>
> thank for your early reply. I don't know if I should send this mail in
> the mailing list or directly to you.
> I think that my problem is pretty simple, and since your name is on
> the comments of the uvc_video source code, I think you're the best
> person I could ask for help .
>
> I did not manage, for now to compile the mercurial package for my
> system, but I managed to compile the r261 version from the berlios
> repository. I wrote a simple application to grab a frame from a camera
> in YUV422 format.
>
> The problem is: this application I wrote works just fine on my ubuntu
> laptop with uvcvideo (Mercurial repository). Camera recognized, YUV422
> format set, frame grabbing runs just fine.
>
> When I connect the same webcam ( Creative Optia ) on my FoxBoard, the
> system does recognize the camera, because I can see it in dmesg.
>
> When I run the same application, I receive an error when trying to set
> the YUV422 format. More precisely, the VIDIOC_S_FMT fails when
> requiring this format.
>
> Surprisingly, it successfully sets the format if I choose the MJPEG format.
>
> From the source code (of r261) I can see that the YUYV is supported,
> so I dont'understand why my application should'n work with the same
> camera on a different architecture. Another application (uvcstreamer)
> that grabs frames in MJPEG format just works fine on FoxBoard...
>
> Why should I disable the V4L support from my kernel? I did so, and
> compiled everything again, but now I actually get the error msg when
> launching VIDIOC_REQBUFS the ioctl. Again, same code and same camera
> work fine on Ubuntu with kernel 2.6.24, while on my FoxBoard I have
> the 2.6.25.
>
> Many thanks to anyone who will help me with this.
>
> Enrico
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090515/7bf3f0b2/attachment.html>

From pj.assis at gmail.com  Sat May 16 10:50:35 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sat, 16 May 2009 09:50:35 +0100
Subject: [Linux-uvc-devel] Still trying to use uvcvideo in an embedded system
In-Reply-To: <59cf47a80905151558m27fe0291qa0c4009f2ed39731@mail.gmail.com>
References: <9ad1ec5d0905150158u27c6decak8594d0a3376faddc@mail.gmail.com>
	<59cf47a80905151008r501e55a4lfb0e1c12c5f7b4f8@mail.gmail.com>
	<9ad1ec5d0905151238y1cf7d9ccrf762340da3f75933@mail.gmail.com>
	<59cf47a80905151558m27fe0291qa0c4009f2ed39731@mail.gmail.com>
Message-ID: <59cf47a80905160150o6544839fu340b7c8bd14cff47@mail.gmail.com>

Enrico,
Most logitech uvc cameras support yuv on usb1.1 but only for very low
resolutions.
This is a bandwidth issue, usb1.1 just doesn't have the necessary bandwidth
needed by yuv format on any usable resolution.


Best regards,
Paulo


2009/5/15 Enrico Di Lello <enr.dilello at gmail.com>

> Paolo, thank you very much for your advice, I never thought about this
> before.
> The FoxBoard has only 2 usb 1.1 ports, so this could actually be the
> problem.
> So this seems to be a camera related issue, ans I don't know if I
> should relieved or just sadder.
>
> I don't have particular problems in changing camera, the question is
> that is hard to find a recent camera supported by a driver different
> than uvc. The FoxBoard has native support for pwc and cpia, but this
> drivers only support old cameras.
>
> If the problem is USB related, how could I try to fix it? Is it
> possible to trace somehow the handshaking process between the camera
> and the driver? I found something like UVC_TRACE in the driver code...
> maybe this could be a way.
>
> Do you know any uvcvideo camera that support YUV and usb 1.1??
>
> Thank you again!
>
> Enrico
>
>
> 2009/5/15 Paulo Assis <pj.assis at gmail.com>:
> > Enrico,
> > Does the  FoxBoard supports usb 2.0 or 1.1 ports?
> > Some cameras only enable yuv format when connected to a usb 2 port.
> >
> > Best regards,
> > Paulo
> >
> > 2009/5/15 Enrico Di Lello <enr.dilello at gmail.com>
> >>
> >> Hi Laurent,
> >>
> >> thank for your early reply. I don't know if I should send this mail in
> >> the mailing list or directly to you.
> >> I think that my problem is pretty simple, and since your name is on
> >> the comments of the uvc_video source code, I think you're the best
> >> person I could ask for help .
> >>
> >> I did not manage, for now to compile the mercurial package for my
> >> system, but I managed to compile the r261 version from the berlios
> >> repository. I wrote a simple application to grab a frame from a camera
> >> in YUV422 format.
> >>
> >> The problem is: this application I wrote works just fine on my ubuntu
> >> laptop with uvcvideo (Mercurial repository). Camera recognized, YUV422
> >> format set, frame grabbing runs just fine.
> >>
> >> When I connect the same webcam ( Creative Optia ) on my FoxBoard, the
> >> system does recognize the camera, because I can see it in dmesg.
> >>
> >> When I run the same application, I receive an error when trying to set
> >> the YUV422 format. More precisely, the VIDIOC_S_FMT fails when
> >> requiring this format.
> >>
> >> Surprisingly, it successfully sets the format if I choose the MJPEG
> >> format.
> >>
> >> From the source code (of r261) I can see that the YUYV is supported,
> >> so I dont'understand why my application should'n work with the same
> >> camera on a different architecture. Another application (uvcstreamer)
> >> that grabs frames in MJPEG format just works fine on FoxBoard...
> >>
> >> Why should I disable the V4L support from my kernel? I did so, and
> >> compiled everything again, but now I actually get the error msg when
> >> launching VIDIOC_REQBUFS the ioctl. Again, same code and same camera
> >> work fine on Ubuntu with kernel 2.6.24, while on my FoxBoard I have
> >> the 2.6.25.
> >>
> >> Many thanks to anyone who will help me with this.
> >>
> >> Enrico
> >> _______________________________________________
> >> Linux-uvc-devel mailing list
> >> Linux-uvc-devel at lists.berlios.de
> >> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090516/33ab8f66/attachment.html>

From roberto.riggio at create-net.org  Mon May 18 10:16:17 2009
From: roberto.riggio at create-net.org (roberto.riggio at create-net.org)
Date: Mon, 18 May 2009 10:16:17 +0200 (CEST)
Subject: [Linux-uvc-devel] Hotplug event
In-Reply-To: <27755756.207321242634509461.JavaMail.root@aurora>
Message-ID: <20534143.207341242634577360.JavaMail.root@aurora>

Hi,

i'm trying to write an hotplug event for an uvc device. Basically i need
to start a streaming server (mjpg-streamet) when an uvc device is plugged.

So far the only way i could figure it out was to have a list of VID:PID
anche check if the $PRODUCT variable is in that list. This is ok, but since
I'm using this software with OpenWRT on an embedded platform i would like
to avoid using this device list file.

Is there a way to understand that an uvc device has been plugged from with
an hotplug event?

If there is no way, where can I find an always updated list of supported
devices. I know about the one in the home page but i was wondering if there 
is a similar list in the official distribution.

Thanks.

-- 
--------------------------------------------------------
Roberto Riggio, PhD 
CREATE-NET, Pervasive
Researcher
Via alla Cascata 56/D - 38100 Povo Trento (Italy)
e-mail: roberto.riggio at create-net.org
Tel: (+39) 0461 408400 - interno/extension 708
Fax: (+39) 0461 421157
http://www.create-net.org/
--------------------------------------------------------

Le informazioni contenute in questo messaggio email e negli allegati sono 
strettamente riservate. Il loro utilizzo e' consentito esclusivamente al 
destinatario del messaggio, per le finalita' indicate nello stesso.

The information transmitted is intended only for the person/entity whom it is 
addressed to, and may contain confidential material. Any review, retransmission, 
dissemination or other use of this information by persons/entities other than 
the intended recipient is prohibited as per Italian Law 196/2003. If you 
received this in error, contact the sender and delete it from any pc.


From pj.assis at gmail.com  Mon May 18 11:29:20 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 18 May 2009 10:29:20 +0100
Subject: [Linux-uvc-devel] Hotplug event
In-Reply-To: <20534143.207341242634577360.JavaMail.root@aurora>
References: <27755756.207321242634509461.JavaMail.root@aurora>
	<20534143.207341242634577360.JavaMail.root@aurora>
Message-ID: <59cf47a80905180229x7c839408x1119d8a0ae95b7f7@mail.gmail.com>

Roberto,
You can use udev to start a small application and use v4l2_capability struct
to determine the device driver, if it is uvcvideo then it's a uvc device
(just check libwebcam, it uses the same aproach).

Best regards,
Paulo

2009/5/18 <roberto.riggio at create-net.org>

> Hi,
>
> i'm trying to write an hotplug event for an uvc device. Basically i need
> to start a streaming server (mjpg-streamet) when an uvc device is plugged.
>
> So far the only way i could figure it out was to have a list of VID:PID
> anche check if the $PRODUCT variable is in that list. This is ok, but since
> I'm using this software with OpenWRT on an embedded platform i would like
> to avoid using this device list file.
>
> Is there a way to understand that an uvc device has been plugged from with
> an hotplug event?
>
> If there is no way, where can I find an always updated list of supported
> devices. I know about the one in the home page but i was wondering if there
> is a similar list in the official distribution.
>
> Thanks.
>
> --
> --------------------------------------------------------
> Roberto Riggio, PhD
> CREATE-NET, Pervasive
> Researcher
> Via alla Cascata 56/D - 38100 Povo Trento (Italy)
> e-mail: roberto.riggio at create-net.org
> Tel: (+39) 0461 408400 - interno/extension 708
> Fax: (+39) 0461 421157
> http://www.create-net.org/
> --------------------------------------------------------
>
> Le informazioni contenute in questo messaggio email e negli allegati sono
> strettamente riservate. Il loro utilizzo e' consentito esclusivamente al
> destinatario del messaggio, per le finalita' indicate nello stesso.
>
> The information transmitted is intended only for the person/entity whom it
> is
> addressed to, and may contain confidential material. Any review,
> retransmission,
> dissemination or other use of this information by persons/entities other
> than
> the intended recipient is prohibited as per Italian Law 196/2003. If you
> received this in error, contact the sender and delete it from any pc.
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090518/61e52295/attachment.html>

From roberto.riggio at create-net.org  Mon May 18 11:50:03 2009
From: roberto.riggio at create-net.org (roberto.riggio at create-net.org)
Date: Mon, 18 May 2009 11:50:03 +0200 (CEST)
Subject: [Linux-uvc-devel] R: Re:  Hotplug event
In-Reply-To: <3660092.208211242640111898.JavaMail.root@aurora>
Message-ID: <26110130.208231242640203304.JavaMail.root@aurora>

Paulo,

thanks for the answer. I will try this approach.

I'm not sure on one point however, I've quickly checked v4l2_capability
struct and some sample code. It looks like i need to know the device name
(e.g. /dev/video0). If this is correct how do I know that /dev/video0 is
the device that was just plugged?

Bye
R.

----- "Paulo Assis" <pj.assis at gmail.com> ha scritto:

> Roberto,
> You can use udev to start a small application and use v4l2_capability
> struct
> to determine the device driver, if it is uvcvideo then it's a uvc
> device
> (just check libwebcam, it uses the same aproach).
> 
> Best regards,
> Paulo
> 
> 2009/5/18 <roberto.riggio at create-net.org>
> 
> > Hi,
> >
> > i'm trying to write an hotplug event for an uvc device. Basically i
> need
> > to start a streaming server (mjpg-streamet) when an uvc device is
> plugged.
> >
> > So far the only way i could figure it out was to have a list of
> VID:PID
> > anche check if the $PRODUCT variable is in that list. This is ok,
> but since
> > I'm using this software with OpenWRT on an embedded platform i would
> like
> > to avoid using this device list file.
> >
> > Is there a way to understand that an uvc device has been plugged
> from with
> > an hotplug event?
> >
> > If there is no way, where can I find an always updated list of
> supported
> > devices. I know about the one in the home page but i was wondering
> if there
> > is a similar list in the official distribution.
> >
> > Thanks.
> >
> > --
> > --------------------------------------------------------
> > Roberto Riggio, PhD
> > CREATE-NET, Pervasive
> > Researcher
> > Via alla Cascata 56/D - 38100 Povo Trento (Italy)
> > e-mail: roberto.riggio at create-net.org
> > Tel: (+39) 0461 408400 - interno/extension 708
> > Fax: (+39) 0461 421157
> > http://www.create-net.org/
> > --------------------------------------------------------
> >
> > Le informazioni contenute in questo messaggio email e negli allegati
> sono
> > strettamente riservate. Il loro utilizzo e' consentito
> esclusivamente al
> > destinatario del messaggio, per le finalita' indicate nello stesso.
> >
> > The information transmitted is intended only for the person/entity
> whom it
> > is
> > addressed to, and may contain confidential material. Any review,
> > retransmission,
> > dissemination or other use of this information by persons/entities
> other
> > than
> > the intended recipient is prohibited as per Italian Law 196/2003. If
> you
> > received this in error, contact the sender and delete it from any
> pc.
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >


-- 
--------------------------------------------------------
Roberto Riggio, PhD 
CREATE-NET, Pervasive
Researcher
Via alla Cascata 56/D - 38100 Povo Trento (Italy)
e-mail: roberto.riggio at create-net.org
Tel: (+39) 0461 408400 - interno/extension 708
Fax: (+39) 0461 421157
http://www.create-net.org/
--------------------------------------------------------

Le informazioni contenute in questo messaggio email e negli allegati sono 
strettamente riservate. Il loro utilizzo e' consentito esclusivamente al 
destinatario del messaggio, per le finalita' indicate nello stesso.

The information transmitted is intended only for the person/entity whom it is 
addressed to, and may contain confidential material. Any review, retransmission, 
dissemination or other use of this information by persons/entities other than 
the intended recipient is prohibited as per Italian Law 196/2003. If you 
received this in error, contact the sender and delete it from any pc.


From pj.assis at gmail.com  Mon May 18 12:13:43 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 18 May 2009 11:13:43 +0100
Subject: [Linux-uvc-devel] Hotplug event
Message-ID: <59cf47a80905180313s2a2b45a1oc40a6363b7fa228f@mail.gmail.com>

Roberto,
I think you can get/set the device index from udev (also the driver name)
and pass it to the application through some environment variable (
http://www.reactivated.net/writing_udev_rules.html#env), anyway if you want
to start a streaming server on the plugged device, you will always need the
device name to open it, I'm I correct ?

Best regards,
Paulo



2009/5/18 <roberto.riggio at create-net.org>

> Paulo,
>
> thanks for the answer. I will try this approach.
>
> I'm not sure on one point however, I've quickly checked v4l2_capability
> struct and some sample code. It looks like i need to know the device name
> (e.g. /dev/video0). If this is correct how do I know that /dev/video0 is
> the device that was just plugged?
>
> Bye
> R.
>
> ----- "Paulo Assis" <pj.assis at gmail.com> ha scritto:
>
> > Roberto,
> > You can use udev to start a small application and use v4l2_capability
> > struct
> > to determine the device driver, if it is uvcvideo then it's a uvc
> > device
> > (just check libwebcam, it uses the same aproach).
> >
> > Best regards,
> > Paulo
> >
> > 2009/5/18 <roberto.riggio at create-net.org>
> >
> > > Hi,
> > >
> > > i'm trying to write an hotplug event for an uvc device. Basically i
> > need
> > > to start a streaming server (mjpg-streamet) when an uvc device is
> > plugged.
> > >
> > > So far the only way i could figure it out was to have a list of
> > VID:PID
> > > anche check if the $PRODUCT variable is in that list. This is ok,
> > but since
> > > I'm using this software with OpenWRT on an embedded platform i would
> > like
> > > to avoid using this device list file.
> > >
> > > Is there a way to understand that an uvc device has been plugged
> > from with
> > > an hotplug event?
> > >
> > > If there is no way, where can I find an always updated list of
> > supported
> > > devices. I know about the one in the home page but i was wondering
> > if there
> > > is a similar list in the official distribution.
> > >
> > > Thanks.
> > >
> > > --
> > > --------------------------------------------------------
> > > Roberto Riggio, PhD
> > > CREATE-NET, Pervasive
> > > Researcher
> > > Via alla Cascata 56/D - 38100 Povo Trento (Italy)
> > > e-mail: roberto.riggio at create-net.org
> > > Tel: (+39) 0461 408400 - interno/extension 708
> > > Fax: (+39) 0461 421157
> > > http://www.create-net.org/
> > > --------------------------------------------------------
> > >
> > > Le informazioni contenute in questo messaggio email e negli allegati
> > sono
> > > strettamente riservate. Il loro utilizzo e' consentito
> > esclusivamente al
> > > destinatario del messaggio, per le finalita' indicate nello stesso.
> > >
> > > The information transmitted is intended only for the person/entity
> > whom it
> > > is
> > > addressed to, and may contain confidential material. Any review,
> > > retransmission,
> > > dissemination or other use of this information by persons/entities
> > other
> > > than
> > > the intended recipient is prohibited as per Italian Law 196/2003. If
> > you
> > > received this in error, contact the sender and delete it from any
> > pc.
> > > _______________________________________________
> > > Linux-uvc-devel mailing list
> > > Linux-uvc-devel at lists.berlios.de
> > > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> > >
>
>
> --
> --------------------------------------------------------
> Roberto Riggio, PhD
> CREATE-NET, Pervasive
> Researcher
> Via alla Cascata 56/D - 38100 Povo Trento (Italy)
> e-mail: roberto.riggio at create-net.org
> Tel: (+39) 0461 408400 - interno/extension 708
> Fax: (+39) 0461 421157
> http://www.create-net.org/
> --------------------------------------------------------
>
> Le informazioni contenute in questo messaggio email e negli allegati sono
> strettamente riservate. Il loro utilizzo e' consentito esclusivamente al
> destinatario del messaggio, per le finalita' indicate nello stesso.
>
> The information transmitted is intended only for the person/entity whom it
> is
> addressed to, and may contain confidential material. Any review,
> retransmission,
> dissemination or other use of this information by persons/entities other
> than
> the intended recipient is prohibited as per Italian Law 196/2003. If you
> received this in error, contact the sender and delete it from any pc.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090518/d5bfda06/attachment.html>

From roberto.riggio at create-net.org  Mon May 18 12:24:22 2009
From: roberto.riggio at create-net.org (Roberto Riggio)
Date: Mon, 18 May 2009 12:24:22 +0200 (CEST)
Subject: [Linux-uvc-devel] R: Re:  Hotplug event
In-Reply-To: <59cf47a80905180313s2a2b45a1oc40a6363b7fa228f@mail.gmail.com>
Message-ID: <25712792.208431242642262805.JavaMail.root@aurora>

Paulo,

yes i still need the device name for the streaming server. I asked
just to understand if I was missing some step in the whole process.
I'll write the small app to check the device caps. Thanks for 
the help.

Best
R.

----- "Paulo Assis" <pj.assis at gmail.com> ha scritto:

> Roberto,
> I think you can get/set the device index from udev (also the driver
> name)
> and pass it to the application through some environment variable (
> http://www.reactivated.net/writing_udev_rules.html#env), anyway if you
> want
> to start a streaming server on the plugged device, you will always
> need the
> device name to open it, I'm I correct ?
> 
> Best regards,
> Paulo
> 
> 
> 
> 2009/5/18 <roberto.riggio at create-net.org>
> 
> > Paulo,
> >
> > thanks for the answer. I will try this approach.
> >
> > I'm not sure on one point however, I've quickly checked
> v4l2_capability
> > struct and some sample code. It looks like i need to know the device
> name
> > (e.g. /dev/video0). If this is correct how do I know that
> /dev/video0 is
> > the device that was just plugged?
> >
> > Bye
> > R.
> >
> > ----- "Paulo Assis" <pj.assis at gmail.com> ha scritto:
> >
> > > Roberto,
> > > You can use udev to start a small application and use
> v4l2_capability
> > > struct
> > > to determine the device driver, if it is uvcvideo then it's a uvc
> > > device
> > > (just check libwebcam, it uses the same aproach).
> > >
> > > Best regards,
> > > Paulo
> > >
> > > 2009/5/18 <roberto.riggio at create-net.org>
> > >
> > > > Hi,
> > > >
> > > > i'm trying to write an hotplug event for an uvc device.
> Basically i
> > > need
> > > > to start a streaming server (mjpg-streamet) when an uvc device
> is
> > > plugged.
> > > >
> > > > So far the only way i could figure it out was to have a list of
> > > VID:PID
> > > > anche check if the $PRODUCT variable is in that list. This is
> ok,
> > > but since
> > > > I'm using this software with OpenWRT on an embedded platform i
> would
> > > like
> > > > to avoid using this device list file.
> > > >
> > > > Is there a way to understand that an uvc device has been
> plugged
> > > from with
> > > > an hotplug event?
> > > >
> > > > If there is no way, where can I find an always updated list of
> > > supported
> > > > devices. I know about the one in the home page but i was
> wondering
> > > if there
> > > > is a similar list in the official distribution.
> > > >
> > > > Thanks.
> > > >
> > > > --
> > > > --------------------------------------------------------
> > > > Roberto Riggio, PhD
> > > > CREATE-NET, Pervasive
> > > > Researcher
> > > > Via alla Cascata 56/D - 38100 Povo Trento (Italy)
> > > > e-mail: roberto.riggio at create-net.org
> > > > Tel: (+39) 0461 408400 - interno/extension 708
> > > > Fax: (+39) 0461 421157
> > > > http://www.create-net.org/
> > > > --------------------------------------------------------
> > > >
> > > > Le informazioni contenute in questo messaggio email e negli
> allegati
> > > sono
> > > > strettamente riservate. Il loro utilizzo e' consentito
> > > esclusivamente al
> > > > destinatario del messaggio, per le finalita' indicate nello
> stesso.
> > > >
> > > > The information transmitted is intended only for the
> person/entity
> > > whom it
> > > > is
> > > > addressed to, and may contain confidential material. Any
> review,
> > > > retransmission,
> > > > dissemination or other use of this information by
> persons/entities
> > > other
> > > > than
> > > > the intended recipient is prohibited as per Italian Law
> 196/2003. If
> > > you
> > > > received this in error, contact the sender and delete it from
> any
> > > pc.
> > > > _______________________________________________
> > > > Linux-uvc-devel mailing list
> > > > Linux-uvc-devel at lists.berlios.de
> > > > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> > > >
> >
> >
> > --
> > --------------------------------------------------------
> > Roberto Riggio, PhD
> > CREATE-NET, Pervasive
> > Researcher
> > Via alla Cascata 56/D - 38100 Povo Trento (Italy)
> > e-mail: roberto.riggio at create-net.org
> > Tel: (+39) 0461 408400 - interno/extension 708
> > Fax: (+39) 0461 421157
> > http://www.create-net.org/
> > --------------------------------------------------------
> >
> > Le informazioni contenute in questo messaggio email e negli allegati
> sono
> > strettamente riservate. Il loro utilizzo e' consentito
> esclusivamente al
> > destinatario del messaggio, per le finalita' indicate nello stesso.
> >
> > The information transmitted is intended only for the person/entity
> whom it
> > is
> > addressed to, and may contain confidential material. Any review,
> > retransmission,
> > dissemination or other use of this information by persons/entities
> other
> > than
> > the intended recipient is prohibited as per Italian Law 196/2003. If
> you
> > received this in error, contact the sender and delete it from any
> pc.
> >
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel


-- 
--------------------------------------------------------
Roberto Riggio, PhD 
CREATE-NET, Pervasive
Researcher
Via alla Cascata 56/D - 38100 Povo Trento (Italy)
e-mail: roberto.riggio at create-net.org
Tel: (+39) 0461 408400 - interno/extension 708
Fax: (+39) 0461 421157
http://www.create-net.org/
--------------------------------------------------------

Le informazioni contenute in questo messaggio email e negli allegati sono 
strettamente riservate. Il loro utilizzo e' consentito esclusivamente al 
destinatario del messaggio, per le finalita' indicate nello stesso.

The information transmitted is intended only for the person/entity whom it is 
addressed to, and may contain confidential material. Any review, retransmission, 
dissemination or other use of this information by persons/entities other than 
the intended recipient is prohibited as per Italian Law 196/2003. If you 
received this in error, contact the sender and delete it from any pc.


From laurent.pinchart at skynet.be  Mon May 18 17:35:55 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 18 May 2009 17:35:55 +0200
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
In-Reply-To: <ebff8ece0905141946r67c21dbtd0d9a653df082cf3@mail.gmail.com>
References: <ebff8ece0905141946r67c21dbtd0d9a653df082cf3@mail.gmail.com>
Message-ID: <200905181735.56776.laurent.pinchart@skynet.be>

Hi Bruce,

On Friday 15 May 2009 04:46:16 bruce m beach wrote:
> > >  On Wednesday 06 May 2009 01:24:25 bruce m beach wrote:
> > >  I have a Suyin crystal eye webcam that lsusb give as
> > >  Bus 004 Device 002: ID 064e:a103 Suyin Corp ....
> > >
> > > 1) sh-4.0# luvcview -f yuv
> > >               Init v4L2 failed !! exit fatal
> >
> > Your device only supports MJPEG so this is expected.
>
> Given that if this webcam was working  should I expect the command
> luvcview to then work?

luvcview defaults to MJPEG, so 'luvcview' alone should work.

> > > 2) sh-4.0# luvcview
> > > The green light is  on and I have  a green screen.
> >
> > This probably means that the driver doesn't receive enough data to fill a
> > video frame. Are you running the latest driver ? There is a known bug in
> > older versions that cause frames to be incorrectly dropped under specific
> > circumstances.
>
> Okay. I did a:
>
> hg clone http://linuxtv.org/hg/~pinchartl/uvcvideo/
>
> Then I did
>
> mv /lib/modules /lib/modules.HIDE
> make modules (from the kernel tree)
> etc.
>
> to get rid of any modules.  I don't use modules if I can help it and a
> a search for *.ko gave a dummy.ko and some scsi_something_or_other.ko
> I then built the  tree and installed it.
>    make
>    make install
>
> and after booting:
>
>   modprobe  uvcvideo
>
> dmesg gives
>
>    uvcvideo 4-1:1.0: usb_probe_interface
>    uvcvideo 4-1:1.0: usb_probe_interface - got id
>    uvcvideo: Found UVC 1.00 device Crystal Eye webcam (064e:a103)
>    input: Crystal Eye webcam as /class/input/input7
>    usbcore: registered new interface driver uvcvideo
>    USB Video Class driver (v0.1.0)

That seems correct.

> (Begin: lsusb stuff)
>
> > > which is the same as my webcam but the devices are not the same. Below I
> > > includea diff of the two listings.
> >
> > That doesn't surprise me much, vendors often change devices
> > without modifying the PID or the version.
>
> Okay. I then assume even though the USB listing is different the webcam
> should function. If you do want a complete lsusb listing for your records
> let me know.

Yes it should.

> (End: lsusb stuff)
>
> I have been looking at this frontwards, backwards, upsidedown and around and
> still haven't got it working. At this point my feeling is that there is
> nothing wrong with the uvcvideo driver (at least in terms of getting
> crystal eye webcam basic functionality) but that there is something wrong
> with my system. Somehow the webcam driver is not getting something that it
> needs. Supporting this is another webcam (0c45:6009 Microdia VideoCAM 
> ExpressII) that I have been using for testing giving the same results as the
> crystal eye which is puzzling to me:
> >xawtv
>
> sh-4.0# xawtv
>         This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
>         xinerama 0: 1280x800+0+0
>         /dev/video0 [v4l2]: no overlay support
>         v4l-conf had some trouble, trying to continue anyway
>         Warning: Cannot convert string
>                "-*-ledfixed-medium-r-*--39-*-*-*-c-*-*-*" to type
> FontStruct ioctl: VIDIOC_G_STD(std=0xafcbe0d0a7d612b0
>         [PAL_I,PAL_D,PAL_K,PAL_N,NTSC_M,
>         SECAM_D,SECAM_G,SECAM_K,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,
>        
> (null),(null),(null),(null),(null),(null),(null),(null),(null),(null),
> (null),(null),(null),(null),(null),(null),(null),(null),(null),(null),
> (null)]): Invalid argument
>         ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument
>
> and then on an attempt  to grab (ppm) (jpeg)
>
>     (no cut and paste here because the webcam just died with :
>         sh-4.0# xawtv
>         This is xawtv-3.95, running on Linux/i686 (2.6.29.2)
>         xinerama 0: 1280x800+0+0
>         X Error of failed request:  XF86DGANoDirectVideoMode
>         Major opcode of failed request:  136 (XFree86-DGA)
>         Minor opcode of failed request:  1 (XF86DGAGetVideoLL)
>         Serial number of failed request:  67
>         Current serial number in output stream:  67
>      )
>
> why is the ioctl call failing

Because VIDIOC_S_STD isn't supported by webcam drivers (that ioctl only makes 
sense for analog video). xawtv should be able to cope with that. You might 
want to upgrade it.

> and why does it keep telling me
>      no way to get: 384x288 16 bit TrueColor (LE)
>      no way to get: 2048x1572 24 bit TrueColor (BE: rgb)

Is that related to the webcam or to the display ?

> I have a "Logitech, Inc. QuickCam Pro 4000" that uses the pwc.ko module and
> it works fine.
>
> One issue could be that the ATI RS690M X1200 Series chip
> doesn't have enough support. As of the  last time I wrote I
> was looking for a source of  the problem and I notice to my
> horror that  the XFree86 driver was "vesa"
>  (from XFree86 -configure)
> and that XFree didn't have any support whatsoever for the
> video chip. There was one of those horrific proprietory
> drivers that I tried to build but soon realized that even
> Knuth would never get the thing built.  Fortunately Xorg has
> good support for the chip so I rebuilt the x-system using
> Xorg code.
>
> Anyway any ideas as to how to proceed are appreciated.

Use luvcview for testing. If luvcview doesn't work xawtv will not work either.

Best regards,

Laurent Pinchart



From brucembeach at gmail.com  Wed May 20 05:29:27 2009
From: brucembeach at gmail.com (bruce m beach)
Date: Tue, 19 May 2009 20:29:27 -0700
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
Message-ID: <ebff8ece0905192029v5ed79fd6nee0e9162f2261ad5@mail.gmail.com>

Hello Laurent

> >    ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument
> >    why is the ioctl call failing?
> Because VIDIOC_S_STD isn't supported by webcam drivers (that ioctl only makes
> sense for analog video). xawtv should be able to cope with that. You might
> want to upgrade it.

I have xawtv-3.95 which is the latest stable release.

> >      and why does it keep telling me
> >      no way to get: 384x288 16 bit TrueColor (LE)
> >      no way to get: 2048x1572 32 bit TrueColor (BE: rgb)
>
> Is that related to the webcam or to the display ?

This I don't know. Xorg.0.log gives me

(==) RADEON(0): Depth 24, (==) framebuffer bpp 32
(II) RADEON(0): Pixel depth = 24 bits stored in 4 bytes (32 bpp pixmaps)
(==) RADEON(0): Default visual is TrueColor
(**) RADEON(0): Option "DRI"

so the message may be a side effect of something else especially if
it doesn't ring a bell for you. I think xawtv may not be working at all
since the webcam green light doesn't come on whereas with luvcview it
does. At this point I'm not going to bother with it.

> >     Anyway any ideas as to how to proceed are appreciated.
> Use luvcview for testing. If luvcview doesn't work xawtv will not work either.

Okay. Here's what I have done to the code in luvcview, (luvcview-20070512)
since it looks like it might take a long time to get this going.

1) added -g to the CFLAGS to add debugging support for gdb if it ever
   gets to that level.
2) set static int debug = 1; in v4l2uvc.c to get whatever error
   messages it has.
3) For starts added a perror message at the beginning of every function
   call like below:

int check_videoIn(struct vdIn *vd, char *device)
{
int ret;
perror("START init_v4l2");

Later on if needed I could add some kind of switch to turn them on
and off. This has tracked down the a problem with terminating the
program. Currently only kill -9 will work. Have a look at the following
output notice the last entry:

 ... ... ...
 ... ... ...
START dec_rec2: Success
START idct: Success
START idct: Success
START idct: Success
START idct: Success
START idct: Success
START idct: Success
START yuv420pto422: Success
START dec_readmarker: Success
START eventThread: Success
START uvcGrab: Success
START video_enable: Success
uvcGrab: memset(&vd->buf, 0, sizeof(struct v4l2_buffer));: Success
uvcGrab: vd->buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;));: Success
uvcGrab: vd->buf.memory = V4L2_MEMORY_MMAP;: Success
uvcGrab: ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf); (BEFORE THE CALL): Success
uvcGrab: ret = ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf (AFTER THE CALL);: Success
uvcGrab just before  Capture a single raw frame: Success
V4L2_PIX_FMT_MJPEG: Success
START jpeg_decode: Success
bytes in used 77389
END uvcGrab normal: Success
START uvcGrab: Success
uvcGrab: memset(&vd->buf, 0, sizeof(struct v4l2_buffer));: Success
uvcGrab: vd->buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;));: Success
uvcGrab: vd->buf.memory = V4L2_MEMORY_MMAP;: Success
uvcGrab: ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf); (BEFORE THE CALL): Success
                                                     ^^^^^^ ^^^ ^^^^
The program does all its initializations printing out lots of stuff (which
I don't show here) and eventually arrives at uvcGrab (Which I assume is the
routine entered at the frame rate to get the camera data by whatever method).
The call is completed once, some other stuff is executed, it is entered
again, calls

    ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf)

and never returns. (notice the message (BEFORE THE CALL). It stays
in the call until kill -9 luvcview(PID) is executed.

"ps x" gives:

2592 pts/3    Sl+    0:00 luvcview

indicating interruptible sleep (waiting for an event to complete) and
multi threaded. On question is why doesn't it time out?

I have another webcam (0c45:6009 Microdia VideoCAM ExpressII) that uses
"modprobe sn9c102" to work. If I run it with luvcview it is only gives
a green screen but the uvcGrab looping  works and it terminates normally.
I have another program (sn-webcam) where the ExpressII works okay.

By the way doing "make" on luvcview gives a lot of redefinitions like:

uvcvideo.h:31:1: warning: "V4L2_CID_WHITE_BALANCE_TEMPERATURE" redefined

I assume this is intentional. Anyway looking forward to you comments.

Bruce


From dave at davestechsupport.com  Thu May 21 01:45:56 2009
From: dave at davestechsupport.com (David Steinlage)
Date: Wed, 20 May 2009 18:45:56 -0500
Subject: [Linux-uvc-devel] Question reguarding motorized motion tracking on
 a Logitech Orbit/Sphere AF webcam
Message-ID: <1242863156.8057.0.camel@zeke-desktop>

To whom it may concern:

I am not a developer, but I am assisting someone with getting their
recently purchased Logitech Orbit/Sphere AF webcam working.  They have
successfully achieved getting video from the camera, but feel they were
mislead by the compatibility list (found at
http://linux-uvc.berlios.de/) showing a green check-mark next to their
model of camera with no footnote mentioning the apparent lack of support
for the cameras motorized motion tracking feature.  I explained to him
that it is likely Logitech has not released specs for the UVC developers
to use in order to create software/drivers to support this unique
feature, but I wanted to confirm with you guys that this feature is
indeed unsupported in Linux and if so if you could please add an
additional footnote on the site stating this so nobody gets the wrong
impression from the green check-mark.  However, if anyone does know of a
way to get this feature working under Linux, some added guidance on how
to do this would be spectacular.

Thanks for your time and assistance.  Please keep up the good work!

Sincerely,
David Steinlage
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090520/dfe2b4ec/attachment.html>

From pj.assis at gmail.com  Thu May 21 11:10:24 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 21 May 2009 10:10:24 +0100
Subject: [Linux-uvc-devel] Question reguarding motorized motion tracking
	on a Logitech Orbit/Sphere AF webcam
In-Reply-To: <1242863156.8057.0.camel@zeke-desktop>
References: <1242863156.8057.0.camel@zeke-desktop>
Message-ID: <59cf47a80905210210l7bce4701q5b0dd486ea34be41@mail.gmail.com>

Hi,
Motor controls (pan, tilt, focus), are extension controls and are supported
by the driver, logitech, in fact, provides specs for all extension controls
(see libwebcam).
However is up to the applications to use them (or not). From what I know
only libwebcam and guvcview have support for these, but maybe not in the way
you wan't (for motion tracking please see the motion application, although
I'm not sure about the implementation status for the sphere).
Linux drivers don't provide any type of data processing, this must allways
be done in application space, so don't expect to see the same functionality
provided by the windows logitech driver.
So the compatibility list is not misleading, the driver supports all camera
provided controls (as explained motion tracking and autofocus are software
driven in the sphere, they are not really hardware controls)

Best regards,
Paulo

2009/5/21 David Steinlage <dave at davestechsupport.com>

>  To whom it may concern:
>
> I am not a developer, but I am assisting someone with getting their
> recently purchased Logitech Orbit/Sphere AF webcam working.  They have
> successfully achieved getting video from the camera, but feel they were
> mislead by the compatibility list (found at http://linux-uvc.berlios.de/)<http://linux-uvc.berlios.de/%29>showing a green check-mark next to their model of camera with no footnote
> mentioning the apparent lack of support for the cameras motorized motion
> tracking feature.  I explained to him that it is likely Logitech has not
> released specs for the UVC developers to use in order to create
> software/drivers to support this unique feature, but I wanted to confirm
> with you guys that this feature is indeed unsupported in Linux and if so if
> you could please add an additional footnote on the site stating this so
> nobody gets the wrong impression from the green check-mark.  However, if
> anyone does know of a way to get this feature working under Linux, some
> added guidance on how to do this would be spectacular.
>
> Thanks for your time and assistance.  Please keep up the good work!
>
> Sincerely,
> David Steinlage
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090521/ddc2eee4/attachment.html>

From roberto.riggio at create-net.org  Thu May 21 11:18:37 2009
From: roberto.riggio at create-net.org (Roberto Riggio)
Date: Thu, 21 May 2009 11:18:37 +0200 (CEST)
Subject: [Linux-uvc-devel] R: Re: Question reguarding motorized motion
 tracking on a Logitech Orbit/Sphere AF webcam
In-Reply-To: <59cf47a80905210210l7bce4701q5b0dd486ea34be41@mail.gmail.com>
Message-ID: <17838600.220401242897517486.JavaMail.root@aurora>

Hi,

mjpg-streamer also supports the sphere controls and provides also
a web interface.

R.

----- "Paulo Assis" <pj.assis at gmail.com> ha scritto:

> Hi,
> Motor controls (pan, tilt, focus), are extension controls and are
> supported
> by the driver, logitech, in fact, provides specs for all extension
> controls
> (see libwebcam).
> However is up to the applications to use them (or not). From what I
> know
> only libwebcam and guvcview have support for these, but maybe not in
> the way
> you wan't (for motion tracking please see the motion application,
> although
> I'm not sure about the implementation status for the sphere).
> Linux drivers don't provide any type of data processing, this must
> allways
> be done in application space, so don't expect to see the same
> functionality
> provided by the windows logitech driver.
> So the compatibility list is not misleading, the driver supports all
> camera
> provided controls (as explained motion tracking and autofocus are
> software
> driven in the sphere, they are not really hardware controls)
> 
> Best regards,
> Paulo
> 
> 2009/5/21 David Steinlage <dave at davestechsupport.com>
> 
> >  To whom it may concern:
> >
> > I am not a developer, but I am assisting someone with getting their
> > recently purchased Logitech Orbit/Sphere AF webcam working.  They
> have
> > successfully achieved getting video from the camera, but feel they
> were
> > mislead by the compatibility list (found at
> http://linux-uvc.berlios.de/)<http://linux-uvc.berlios.de/%29>showing
> a green check-mark next to their model of camera with no footnote
> > mentioning the apparent lack of support for the cameras motorized
> motion
> > tracking feature.  I explained to him that it is likely Logitech has
> not
> > released specs for the UVC developers to use in order to create
> > software/drivers to support this unique feature, but I wanted to
> confirm
> > with you guys that this feature is indeed unsupported in Linux and
> if so if
> > you could please add an additional footnote on the site stating this
> so
> > nobody gets the wrong impression from the green check-mark. 
> However, if
> > anyone does know of a way to get this feature working under Linux,
> some
> > added guidance on how to do this would be spectacular.
> >
> > Thanks for your time and assistance.  Please keep up the good work!
> >
> > Sincerely,
> > David Steinlage
> >
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
> >
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel


-- 
--------------------------------------------------------
Roberto Riggio, PhD 
CREATE-NET, Pervasive
Researcher
Via alla Cascata 56/D - 38100 Povo Trento (Italy)
e-mail: roberto.riggio at create-net.org
Tel: (+39) 0461 408400 - interno/extension 708
Fax: (+39) 0461 421157
http://www.create-net.org/
--------------------------------------------------------

Le informazioni contenute in questo messaggio email e negli allegati sono 
strettamente riservate. Il loro utilizzo e' consentito esclusivamente al 
destinatario del messaggio, per le finalita' indicate nello stesso.

The information transmitted is intended only for the person/entity whom it is 
addressed to, and may contain confidential material. Any review, retransmission, 
dissemination or other use of this information by persons/entities other than 
the intended recipient is prohibited as per Italian Law 196/2003. If you 
received this in error, contact the sender and delete it from any pc.


From jbaena at decsai.ugr.es  Fri May 22 09:36:32 2009
From: jbaena at decsai.ugr.es (J. =?iso-8859-1?q?Mart=EDnez?= Baena)
Date: Fri, 22 May 2009 09:36:32 +0200
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
Message-ID: <200905220936.32981.jbaena@decsai.ugr.es>


Hello,

I have a problem with 2 webcams I'm trying to get work simultaneously. I have 
several models (Logitech P3000, Logitech P9000, Creative LiveCAM Optia AF, 
Philips). When I plug two of them on different USB ports, then everything works 
ok: I can see both simultaneously with, for example, luvcview.

The problem exists when I plug two of them on the same USB (for example on 
frontal USB or in a USB hub). I've got the problem for combinations in wich 
UVC driver is used by both cameras. I can get frames for one of them (the first 
that I try), but for the second one I get a "noisy/green" screen ... it seems 
as if the image is corrupted.

However, if I put the philips and the logitech P9000/Optia it works fine. The 
Philips (and logitech P3000) use a different driver than UVC. Also, I can plug 
two philips webcam and they works fine.

?Is this a bug or an unresolved problem of the UVC driver? ?Is it a USB 
problem?

Thanks in advance.

Javier



From laurent.pinchart at skynet.be  Sat May 23 16:21:50 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 23 May 2009 16:21:50 +0200
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
In-Reply-To: <ebff8ece0905192029v5ed79fd6nee0e9162f2261ad5@mail.gmail.com>
References: <ebff8ece0905192029v5ed79fd6nee0e9162f2261ad5@mail.gmail.com>
Message-ID: <200905231621.51068.laurent.pinchart@skynet.be>

Hi Bruce,

On Wednesday 20 May 2009 05:29:27 bruce m beach wrote:
> Hello Laurent
>
> > >    ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument
> > >    why is the ioctl call failing?
> >
> > Because VIDIOC_S_STD isn't supported by webcam drivers (that ioctl only
> > makes sense for analog video). xawtv should be able to cope with that.
> > You might want to upgrade it.
>
> I have xawtv-3.95 which is the latest stable release.

The latest stable release is buggy :-)

> > >      and why does it keep telling me
> > >      no way to get: 384x288 16 bit TrueColor (LE)
> > >      no way to get: 2048x1572 32 bit TrueColor (BE: rgb)
> >
> > Is that related to the webcam or to the display ?
>
> This I don't know. Xorg.0.log gives me
>
> (==) RADEON(0): Depth 24, (==) framebuffer bpp 32
> (II) RADEON(0): Pixel depth = 24 bits stored in 4 bytes (32 bpp pixmaps)
> (==) RADEON(0): Default visual is TrueColor
> (**) RADEON(0): Option "DRI"
>
> so the message may be a side effect of something else especially if
> it doesn't ring a bell for you. I think xawtv may not be working at all
> since the webcam green light doesn't come on whereas with luvcview it
> does. At this point I'm not going to bother with it.

Ok.

> > > Anyway any ideas as to how to proceed are appreciated.
> >
> > Use luvcview for testing. If luvcview doesn't work xawtv will not work
> > either.
>
> Okay. Here's what I have done to the code in luvcview, (luvcview-20070512)
> since it looks like it might take a long time to get this going.
>
> 1) added -g to the CFLAGS to add debugging support for gdb if it ever
>    gets to that level.
> 2) set static int debug = 1; in v4l2uvc.c to get whatever error
>    messages it has.
> 3) For starts added a perror message at the beginning of every function
>    call like below:
>
> int check_videoIn(struct vdIn *vd, char *device)
> {
> int ret;
> perror("START init_v4l2");
>
> Later on if needed I could add some kind of switch to turn them on
> and off. This has tracked down the a problem with terminating the
> program. Currently only kill -9 will work. Have a look at the following
> output notice the last entry:
>
>  ... ... ...
>  ... ... ...
> START dec_rec2: Success
> START idct: Success
> START idct: Success
> START idct: Success
> START idct: Success
> START idct: Success
> START idct: Success
> START yuv420pto422: Success
> START dec_readmarker: Success
> START eventThread: Success
> START uvcGrab: Success
> START video_enable: Success
> uvcGrab: memset(&vd->buf, 0, sizeof(struct v4l2_buffer));: Success
> uvcGrab: vd->buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;));: Success
> uvcGrab: vd->buf.memory = V4L2_MEMORY_MMAP;: Success
> uvcGrab: ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf); (BEFORE THE CALL):
> Success uvcGrab: ret = ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf (AFTER THE
> CALL);: Success uvcGrab just before  Capture a single raw frame: Success
> V4L2_PIX_FMT_MJPEG: Success
> START jpeg_decode: Success
> bytes in used 77389
> END uvcGrab normal: Success
> START uvcGrab: Success
> uvcGrab: memset(&vd->buf, 0, sizeof(struct v4l2_buffer));: Success
> uvcGrab: vd->buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;));: Success
> uvcGrab: vd->buf.memory = V4L2_MEMORY_MMAP;: Success
> uvcGrab: ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf); (BEFORE THE CALL):
> Success
>                                                     ^^^^^^ ^^^ ^^^^
> The program does all its initializations printing
> out lots of stuff (which I don't show here) and eventually arrives at
> uvcGrab (Which I assume is the routine entered at the frame rate to get the
> camera data by whatever method). The call is completed once, some other
> stuff is executed, it is entered again, calls
>
>     ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf)
>
> and never returns. (notice the message (BEFORE THE CALL). It stays
> in the call until kill -9 luvcview(PID) is executed.
>
> "ps x" gives:
>
> 2592 pts/3    Sl+    0:00 luvcview
>
> indicating interruptible sleep (waiting for an event to complete) and
> multi threaded. On question is why doesn't it time out?

The V4L2 specification doesn't specify if and when VIDIOC_DQBUF should 
timeout. Why would you like it to timeout ?

> I have another webcam (0c45:6009 Microdia VideoCAM ExpressII) that uses
> "modprobe sn9c102" to work. If I run it with luvcview it is only gives
> a green screen but the uvcGrab looping  works and it terminates normally.
> I have another program (sn-webcam) where the ExpressII works okay.

That's a completely different driver, and I'm not familiar with it, sorry.

> By the way doing "make" on luvcview gives a lot of redefinitions like:
>
> uvcvideo.h:31:1: warning: "V4L2_CID_WHITE_BALANCE_TEMPERATURE" redefined
>
> I assume this is intentional. Anyway looking forward to you comments.

I assume you get those warnings with the deprecated SVN version. Don't use it, 
it's really deprecated.

The reason why VIDIOC_DQBUF fails to return is probably that the driver 
doesn't get enough data from the camera to fill a frame (or that it believes 
it doesn't). Could you set the trace level to 255, run luvcview for a few 
seconds, kill it (ctrl-\ should do the job) and send me the messages printed 
by the uvcvideo driver to the kernel log ?

Best regards,

Laurent Pinchart



From jon.fairbairn at cl.cam.ac.uk  Sat May 23 19:42:09 2009
From: jon.fairbairn at cl.cam.ac.uk (Jon Fairbairn)
Date: Sat, 23 May 2009 18:42:09 +0100
Subject: [Linux-uvc-devel] [PATCH] VIDIOC_[GS]_JPEGCOMP support
References: <EFE3E62A-C489-45B7-A4B2-B0E53E953AB3@federated.com>
	<200704140303.14434.laurent.pinchart@skynet.be>
	<20080922140904.GA7809@bwwlx086.ibw.intel.com>
	<200810150131.33731.laurent.pinchart@skynet.be>
Message-ID: <wf4ovbhg26.fsf@calligramme.charmers>


Laurent Pinchart <laurent.pinchart at skynet.be> writes:
> Hi Moritz,
> On Monday 22 September 2008, Moritz Barsnick wrote:
>> On Sat, Apr 14, 2007 at 03:03:13 +0200, Laurent Pinchart wrote:
>> > > I had a sneaky suspicion my camera was stuck in top quality. Laurent
>> > > Pinchart's comments from March 25th confirmed and were a nice
>> > > blueprint for this patch.
>> > First of all, thanks for the patch.
>> [...]
>>
>> > Great :-) I'll have a look at the code after this weekend, and commit the
>> > changes to SVN.
[...]
>> Has this patch[*] been obsoleted, or forgotten, or perhaps even rejected?
>
> Mostly forgotten actually. I'm working on reviving it, but I first have to 
> implement proper workarounds for webcams that don't implement the 
> GET_MIN/GET_MAX requests on the video probe control properly (and there are 
> many of them). I'll soon post a patch for review/testing on the list, and 
> I'll then work on the JPEG quality patch.
>
>> The recent release of motion mentions this in its CHANGELOG (though I
>> think the patch is unrelated to the named issue):
>> http://www.lavrsen.dk/twiki/bin/view/Motion/UvcvideoMjpegPatch
>
> That's related. Thanks for the information. I'll contact
> the authors of motion after committing JPEG quality
> support to update their wiki.

How's this going? I recently got a Creative Live! Cam Optia
(ID 041e:4057) and am using it with motion. Although it's
connected to a USB2 port, I'm getting a problem (maybe
caused by a bug in the usb root driver, but that's not the
topic here?) that causes the device to disappear if I try to
use the full resolution of the camera. As a work-round for
that, I thought I could use MJPEG, but then I hit the
problem this thread is about.

I'm using the latest(?) fedora 9 kernel
(2.6.27.23-78.2.50.fc9.x86_64). F9 is a bit out of date now,
but looking at the uvcvideo repo I couldn't find signs of
the patch having been applied.

It would be useful to me if a patch for this did get
included. In the short term I suppose I could build a
patched version of the module (modulo some change to the
patch to make it apply to the present code), but it would be
much nicer if it made it into the tree.

(Mostly posting to indicate that there is other interest in
this issue).


[1] I can't address the USB root issue as I'm too far from
the camera to unplug it.

Thanks,
  J?n

-- 
J?n Fairbairn                                 Jon.Fairbairn at cl.cam.ac.uk



From gregg_a_g at yahoo.com  Mon May 25 04:52:32 2009
From: gregg_a_g at yahoo.com (Gregg Garza)
Date: Sun, 24 May 2009 19:52:32 -0700 (PDT)
Subject: [Linux-uvc-devel] Pixart Imaging
Message-ID: <395505.29334.qm@web84102.mail.mud.yahoo.com>




Hi, Peter & other developers!

???? Can you tell me if there is UVC support for this webcam?

ID 093a:2800 Pixart Imaging, Inc.

The vendor claims it is "UVC Driverless".? From dmesg when I do "modprobe uvcvideo" and plug in the webcam I get:

uvcvideo: Found UVC 1.00 device USB2.0_Camera (093a:2800)
videodev: "???" has no release callback. Please fix your driver for proper sysfs
?support, see http://lwn.net/Articles/36850/
input: USB2.0_Camera as /class/input/input4

I am running SliTaz with Kernel 2.6.25.5-slitaz.? Ekiga can't detect the camera, nor can MPlayer or anything else I can think of.? I have had other webcams that work on this system.

Any help is much appreciated!? Thanks for your work on Linux-UVC!

Gregg Garza



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090524/4410c654/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lsusb-pixart.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090524/4410c654/attachment.txt>

From laurent.pinchart at skynet.be  Mon May 25 12:00:44 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 25 May 2009 12:00:44 +0200
Subject: [Linux-uvc-devel] Pixart Imaging
In-Reply-To: <395505.29334.qm@web84102.mail.mud.yahoo.com>
References: <395505.29334.qm@web84102.mail.mud.yahoo.com>
Message-ID: <200905251200.45099.laurent.pinchart@skynet.be>

Hi Gregg,

On Monday 25 May 2009 04:52:32 Gregg Garza wrote:
> Hi, Peter & other developers!
>
>      Can you tell me if there is UVC support for this webcam?
>
> ID 093a:2800 Pixart Imaging, Inc.
>
> The vendor claims it is "UVC Driverless".  From dmesg when I do "modprobe
> uvcvideo" and plug in the webcam I get:
>
> uvcvideo: Found UVC 1.00 device USB2.0_Camera (093a:2800)
> videodev: "???" has no release callback. Please fix your driver for proper
> sysfs support, see http://lwn.net/Articles/36850/

This is definitely not normal. Looks like something is seriously corrupted in 
your kernel.

> input: USB2.0_Camera as /class/input/input4
>
> I am running SliTaz with Kernel 2.6.25.5-slitaz.

Can you try a vanilla kernel from www.kernel.org ?

> Ekiga can't detect the camera, nor can MPlayer or anything else I can think
> of. I have had other webcams that work on this system.
>
> Any help is much appreciated!  Thanks for your work on Linux-UVC!

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Mon May 25 12:16:25 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 25 May 2009 12:16:25 +0200
Subject: [Linux-uvc-devel] Trust Webcam that is not supported but very
	similar - I think
In-Reply-To: <1243184599.5992.3.camel@Main-home-workstation>
References: <mailman.9395.1243160414.5339.linux-uvc-devel@lists.berlios.de>
	<1243184599.5992.3.camel@Main-home-workstation>
Message-ID: <200905251216.26130.laurent.pinchart@skynet.be>

Hi Michael,

On Sunday 24 May 2009 19:03:19 Michael Sinclair wrote:
> Hi,
>
> I am turning to Linux (Ubuntu)and saw an article about the Drivers you
> do for Linux users.
>
> I looked down the list of your devices and I haven't found the exact
> matching device on your list.
>
> With lsusb I get this device: 145f:013d .  It is a Trust MB-3600R
> Hi-res usb2 wecam live.  The closest you have on your list is
> 145f:013e.
>
> Could you point me in the direction of where a driver may be?

The uvcvideo driver supports UVC compatible webcams only. In a nutshell, UVC 
(which stands for USB Video Class) is a standard that defines how USB cameras 
should communicate with computers. Before UVC webcams used proprietary 
communication protocols, and every webcam model needed a specific driver. Now, 
UVC compatible webcams should all work using a single driver, much like all 
USB flash sticks don't require a model-specific driver.

To check whether your camera is UVC compatible, please read http://linux-
uvc.berlios.de/faq/. If the Trust MB-3600R is UVC compatible it should work 
with the uvcvideo driver out of the box (not counting bugs in the driver, the 
camera, or both). If it isn't you will need another driver. In that case you 
should ask on the linux-media at vger.kernel.org mailing list.

If your camera is UVC compatible and works with the uvcvideo driver, please 
drop me a note so that I can update the supported devices list on the website. 
Please attach the output of

lsusb -v -d 145f:013d

to the e-mail (using usbutils 0.72 or newer - 0.73+ preferred).

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Mon May 25 12:20:13 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 25 May 2009 12:20:13 +0200
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
In-Reply-To: <200905220936.32981.jbaena@decsai.ugr.es>
References: <200905220936.32981.jbaena@decsai.ugr.es>
Message-ID: <200905251220.13583.laurent.pinchart@skynet.be>

Hi Javier,

On Friday 22 May 2009 09:36:32 J. Mart?nez Baena wrote:
> Hello,
>
> I have a problem with 2 webcams I'm trying to get work simultaneously. I
> have several models (Logitech P3000, Logitech P9000, Creative LiveCAM Optia
> AF, Philips). When I plug two of them on different USB ports, then
> everything works ok: I can see both simultaneously with, for example,
> luvcview.
>
> The problem exists when I plug two of them on the same USB (for example on
> frontal USB or in a USB hub). I've got the problem for combinations in wich
> UVC driver is used by both cameras. I can get frames for one of them (the
> first that I try), but for the second one I get a "noisy/green" screen ...
> it seems as if the image is corrupted.
>
> However, if I put the philips and the logitech P9000/Optia it works fine.
> The Philips (and logitech P3000) use a different driver than UVC. Also, I
> can plug two philips webcam and they works fine.
>
> ?Is this a bug or an unresolved problem of the UVC driver? ?Is it a USB
> problem?

My guess is that you're having USB bandwidth issues. As the uvcvideo driver 
starts capturing video on both cameras, you're not exceeding the theoretical 
USB bandwidth limit. However, bugs in the USB host controller, the USB host 
controller driver or the camera can result in corrupted data. Could you 
perform the same test on another computer ?

Best regards,

Laurent Pinchart



From jezz at sysmic.org  Tue May 26 17:49:14 2009
From: jezz at sysmic.org (=?iso-8859-1?q?J=E9r=F4me_Pouiller?=)
Date: Tue, 26 May 2009 17:49:14 +0200
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5986:0241)
Message-ID: <200905261749.15922.jezz@sysmic.org>

Hi,

I have some problems with "BisonCam, NB Pro" (5986:0241) with 
gstreamer/libv4l (while it works with luvcview). 

After some investigation, I found uvcvideo driver answers EIO when 
libv4l do VIDIOC_QUERYCTRL, with a particular id: 0x980903. This id 
seems correct and correspond to "Hue" control. Someone can confirm this?

Also, dmesg says:
  uvcvideo: Failed to query (135) UVC control 6 (unit 5) : -32 (exp. 2).

Error 32 corresponds to EPIPE ("Stalled endpoint"). 

I wrote a workaround in libv4l :

--- libv4l-0.5.8.orig/libv4l2/libv4l2.c
+++ libv4l-0.5.8/libv4l2/libv4l2.c
@@ -740,0 +740,6 @@
+    // Jezz: Fix bug with '5986:0241 BisonCam, NB Pro'
+    if (request == VIDIOC_QUERYCTRL && result != 0 && errno == EIO) {
+      struct v4l2_queryctrl *queryctrl = arg;
+      if (queryctrl->id == 0x980903)
+        errno = EINVAL;
+    }

This workaround work fine, so problem exists only with this id.

Nevertheless, it is not a perennial solution. So I am looking to correct 
problem in uvcvideo driver.

1. I currently work on kernel 2.6.28.9. Do you think it would be useful 
to test with 2.6.29 or 2.6.30?
2. It looks like a hardware bug, but how to prove it?
3. Should I add a "quirks" entry in uvcvideo to handle it?

Cheer,

-- 
J?r?me Pouiller (jezz AT sysmic DOT org)

-------------- next part --------------

Bus 002 Device 004: ID 5986:0241 Acer, Inc 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x5986 Acer, Inc
  idProduct          0x0241 
  bcdDevice            3.03
  iManufacturer           3 BISON Corporation
  iProduct                1 BisonCam, NB Pro
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          471
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               1 BisonCam, NB Pro
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              1 BisonCam, NB Pro
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           85
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               6
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               1
        baSource( 0)            1
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000043f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Power Line Frequency
        iProcessing             0 
        bmVideoStandards     0x1b
          None
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 6
        guidExtensionCode         {564c97a7-7ea7-904b-8cbf-1c71ec303000}
        bNumControl            16
        bNrPins                 1
        baSourceID( 0)          5
        bControlSize            2
        bmControls( 0)       0xff
        bmControls( 1)       0xff
        iExtension              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              15
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      291
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 12288000
        dwMaxBitRate                 12288000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  3072000
        dwMaxBitRate                  3072000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x01
          Still image supported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   768000
        dwMaxBitRate                   768000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x01
          Still image supported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  4055040
        dwMaxBitRate                  4055040
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x01
          Still image supported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1013760
        dwMaxBitRate                  1013760
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         416666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            416666
        dwFrameInterval( 1)            666666
        dwFrameInterval( 2)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 26214400
        dwMaxBitRate                 26214400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1250000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1250000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        320
        wHeight( 1)                       240
        wWidth( 2)                        160
        wHeight( 2)                       120
        wWidth( 3)                        352
        wHeight( 3)                       288
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                       1280
        wHeight( 5)                      1024
        bNumCompressionPatterns             6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

From phil.lemelin at gmail.com  Tue May 26 22:18:27 2009
From: phil.lemelin at gmail.com (phil lemelin)
Date: Tue, 26 May 2009 16:18:27 -0400
Subject: [Linux-uvc-devel] Compilation error
Message-ID: <efe037fe0905261318w7caf282ai16dbf6289c6b0018@mail.gmail.com>

Hi uvc-devel list,

I'm trying to get my usb camera to work ( 174f:8a34 Syntek ) on a older
system ( 2.6.18-6, debian etch ) and I am not able to compile the source
code found on the HG repository. The error I get is the following :

>
> *snip*
> CC [M]  /home/phil/uvcvideo-b7cdedd8e305/v4l/av7110_hw.o
> /home/phil/uvcvideo-b7cdedd8e305/v4l/av7110_hw.c:294: error: expected
> declaration specifiers or '...' before string constant
> /home/phil/uvcvideo-b7cdedd8e305/v4l/av7110_hw.c:294: warning: data
> definition has no type or storage class
> /home/phil/uvcvideo-b7cdedd8e305/v4l/av7110_hw.c:294: warning: type
> defaults to 'int' in declaration of 'MODULE_FIRMWARE'
> /home/phil/uvcvideo-b7cdedd8e305/v4l/av7110_hw.c:294: warning: function
> declaration isn't a prototype
> make[3]: *** [/home/phil/uvcvideo-b7cdedd8e305/v4l/av7110_hw.o] Error 1
> make[2]: *** [_module_/home/phil/uvcvideo-b7cdedd8e305/v4l] Error 2
> make[2]: Leaving directory `/usr/src/linux-headers-2.6.18-6-686'
> make[1]: *** [default] Error 2
> make[1]: Leaving directory `/home/phil/uvcvideo-b7cdedd8e305/v4l'
> make: *** [all] Error 2
>

The code compiles on my jaunty installation but I cant figure out what I'm
missing on the debian etch installation.

Thanks in advance for you time.

-- 
Philippe-Alexandre Lemelin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090526/8ba3ea99/attachment.html>

From laurent.pinchart at skynet.be  Wed May 27 01:50:18 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 27 May 2009 01:50:18 +0200
Subject: [Linux-uvc-devel] [PATCH] VIDIOC_[GS]_JPEGCOMP support
In-Reply-To: <wf4ovbhg26.fsf@calligramme.charmers>
References: <EFE3E62A-C489-45B7-A4B2-B0E53E953AB3@federated.com>
	<200810150131.33731.laurent.pinchart@skynet.be>
	<wf4ovbhg26.fsf@calligramme.charmers>
Message-ID: <200905270150.18955.laurent.pinchart@skynet.be>

Hi Jon,

On Saturday 23 May 2009 19:42:09 Jon Fairbairn wrote:
> Laurent Pinchart <laurent.pinchart at skynet.be> writes:
> > Hi Moritz,
> >
> > On Monday 22 September 2008, Moritz Barsnick wrote:
> >> On Sat, Apr 14, 2007 at 03:03:13 +0200, Laurent Pinchart wrote:
> >> > > I had a sneaky suspicion my camera was stuck in top quality. Laurent
> >> > > Pinchart's comments from March 25th confirmed and were a nice
> >> > > blueprint for this patch.
> >> >
> >> > First of all, thanks for the patch.
> >>
> >> [...]
> >>
> >> > Great :-) I'll have a look at the code after this weekend, and commit
> >> > the changes to SVN.
>
> [...]
>
> >> Has this patch[*] been obsoleted, or forgotten, or perhaps even
> >> rejected?
> >
> > Mostly forgotten actually. I'm working on reviving it, but I first have
> > to implement proper workarounds for webcams that don't implement the
> > GET_MIN/GET_MAX requests on the video probe control properly (and there
> > are many of them). I'll soon post a patch for review/testing on the list,
> > and I'll then work on the JPEG quality patch.
> >
> >> The recent release of motion mentions this in its CHANGELOG (though I
> >> think the patch is unrelated to the named issue):
> >> http://www.lavrsen.dk/twiki/bin/view/Motion/UvcvideoMjpegPatch
> >
> > That's related. Thanks for the information. I'll contact
> > the authors of motion after committing JPEG quality
> > support to update their wiki.
>
> How's this going? I recently got a Creative Live! Cam Optia
> (ID 041e:4057) and am using it with motion. Although it's
> connected to a USB2 port, I'm getting a problem (maybe
> caused by a bug in the usb root driver, but that's not the
> topic here?) that causes the device to disappear if I try to
> use the full resolution of the camera. As a work-round for
> that, I thought I could use MJPEG, but then I hit the
> problem this thread is about.
>
> I'm using the latest(?) fedora 9 kernel
> (2.6.27.23-78.2.50.fc9.x86_64). F9 is a bit out of date now,
> but looking at the uvcvideo repo I couldn't find signs of
> the patch having been applied.
>
> It would be useful to me if a patch for this did get
> included. In the short term I suppose I could build a
> patched version of the module (modulo some change to the
> patch to make it apply to the present code), but it would be
> much nicer if it made it into the tree.
>
> (Mostly posting to indicate that there is other interest in
> this issue).
>
> [1] I can't address the USB root issue as I'm too far from
> the camera to unplug it.

I guess I have no choice but to work on this then :-) I'll try to get a patch 
ready for the end of the week. If I don't feel free to (nicely) remind me.

Best regards,

Laurent Pinchart



From fargiolas at gnome.org  Thu May 28 10:27:20 2009
From: fargiolas at gnome.org (Filippo Argiolas)
Date: Thu, 28 May 2009 10:27:20 +0200
Subject: [Linux-uvc-devel] Hotplug event
In-Reply-To: <59cf47a80905180229x7c839408x1119d8a0ae95b7f7@mail.gmail.com>
References: <27755756.207321242634509461.JavaMail.root@aurora>
	<20534143.207341242634577360.JavaMail.root@aurora>
	<59cf47a80905180229x7c839408x1119d8a0ae95b7f7@mail.gmail.com>
Message-ID: <8ceb98f20905280127lb986271yaa2eeb882d021271@mail.gmail.com>

On Mon, May 18, 2009 at 11:29 AM, Paulo Assis <pj.assis at gmail.com> wrote:
> Roberto,
> You can use udev to start a small application and use v4l2_capability struct
> to determine the device driver, if it is uvcvideo then it's a uvc device
> (just check libwebcam, it uses the same aproach).
>
> Best regards,
> Paulo

I think you should consider using directly libudev in your
application. You can add a monitor for the video4linux system and
filter devices that match a particular property (like ID_MODEL_ID,
ID_VENDOR_ID, ID_USB_DRIVER), with latest udev-extras you can even get
capabilities through udev with no extra ioctl.

See http://marc.info/?l=linux-hotplug&m=124196393502336&w=2 for some
sample code.

Ciao,
Filippo


From jezz at sysmic.org  Thu May 28 15:21:52 2009
From: jezz at sysmic.org (=?iso-8859-15?q?J=E9r=F4me_Pouiller?=)
Date: Thu, 28 May 2009 15:21:52 +0200
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5986:0241)
In-Reply-To: <200905271711.03996.laurent.pinchart@ideasonboard.com>
References: <200905261749.15922.jezz@sysmic.org>
	<200905271711.03996.laurent.pinchart@ideasonboard.com>
Message-ID: <200905281521.53139.jezz@sysmic.org>

Hi Laurent, 

On Wednesday 27 May 2009 17:11:03 Laurent Pinchart wrote:
[...]
> On Tuesday 26 May 2009 17:49:14 J?r?me Pouiller wrote:
[...]
> > 2. It looks like a hardware bug, but how to prove it?
>
> The camera stalls a GET_DEF request  on the hue control. First of all,
> does the problem occur every time  the hue control is queried, or only
> from times to times ?
100% reproducible.

> If the problem is 100% reproducible, I'd like to try other requests to
> see if the camera stalls GET_DEF(hue)  only or all GET requests on the
> hue control.
Only happens with HUE (see test-BisonCam.c and test-output).

> Could you try to read the value (VIDIOC_G_CTRL) of the hue control ?
It   return  EIO   and   uvcvideo  driver   print   same  message   (see
test-BisonCam.c and test-output).

> If  it doesn't  work, could  you  modify the  PU_HUE_CONTROL entry  in
> uvc_ctrls (uvc_ctrl.c) and retest VIDIOC_QUERYCTRL ?
>
> Set the flags field to
>
> UVC_CONTROL_GET_DEF |
> UVC_CONTROL_GET_MIN |
> UVC_CONTROL_GET_MAX |
> UVC_CONTROL_GET_RES |
> UVC_CONTROL_GET_CUR | 
> UVC_CONTROL_SET_CUR |
> UVC_CONTROL_RESTORE |
> UVC_CONTROL_AUTO_UPDATE
>
> at first  and remove the  GET_DEF, GET_MIN, GET_MAX and  GET_RES flags
> one by one, trying VIDIOC_QUERYCTRL at each step. The driver will only
> perform the listed requests in  the GET_DEF, GET_MIN, GET_MAX, GET_RES
> order. I'd like to know which of those work or fail.
VIDIOC_QUERYCTRL  success only  if  I remove  GET_DEF, GET_MIN,  GET_MAX
and  GET_RES flags.  In  all  other cases,  my  test  program give  same
output as  in test-output. (Except:  if I remove UVC_CONTROL_GET* flags,
VIDIOC_G_CTRL return EINVAL).


Best regards,

-- 
J?r?me Pouiller (jezz AT sysmic DOT org)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test-BisonCam.c
Type: text/x-csrc
Size: 1170 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090528/f9bee26f/attachment.c>
-------------- next part --------------
Enumerate all controls:
  id:0x980900, ret:0, flags:0x0, name:Brightness
  id:0x980901, ret:0, flags:0x0, name:Contrast
  id:0x980902, ret:0, flags:0x0, name:Saturation
  id:0x980903, ret:-1, flags:0x0, err:5 (Input/output error)
  id:0x980904, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980905, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980906, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980907, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980908, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980909, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x98090A, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x98090B, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x98090C, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x98090D, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x98090E, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x98090F, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980910, ret:0, flags:0x0, name:Gamma
  id:0x980911, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980912, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980913, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980914, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980915, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980916, ret:-1, flags:0x0, err:22 (Invalid argument)
  id:0x980917, ret:-1, flags:0x0, err:22 (Invalid argument)
Try to control Hue:
  id:0x980903, ret:-1, value:-1208459276, err:5 (Input/output error)


From laurent.pinchart at skynet.be  Thu May 28 15:59:58 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 28 May 2009 15:59:58 +0200
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5986:0241)
In-Reply-To: <200905281521.53139.jezz@sysmic.org>
References: <200905261749.15922.jezz@sysmic.org>
	<200905271711.03996.laurent.pinchart@ideasonboard.com>
	<200905281521.53139.jezz@sysmic.org>
Message-ID: <200905281559.59161.laurent.pinchart@skynet.be>

Hi J?r?me,

On Thursday 28 May 2009 15:21:52 J?r?me Pouiller wrote:
> Hi Laurent,
>
> On Wednesday 27 May 2009 17:11:03 Laurent Pinchart wrote:
> [...]
>
> > On Tuesday 26 May 2009 17:49:14 J?r?me Pouiller wrote:
>
> [...]
>
> > > 2. It looks like a hardware bug, but how to prove it?
> >
> > The camera stalls a GET_DEF request  on the hue control. First of all,
> > does the problem occur every time  the hue control is queried, or only
> > from times to times ?
>
> 100% reproducible.
>
> > If the problem is 100% reproducible, I'd like to try other requests to
> > see if the camera stalls GET_DEF(hue)  only or all GET requests on the
> > hue control.
>
> Only happens with HUE (see test-BisonCam.c and test-output).
>
> > Could you try to read the value (VIDIOC_G_CTRL) of the hue control ?
>
> It   return  EIO   and   uvcvideo  driver   print   same  message   (see
> test-BisonCam.c and test-output).

I expected the uvcvideo driver to print a slightly different message (129 
instead of 135). I'm pretty sure it did, you might have missed that.

> > If  it doesn't  work, could  you  modify the  PU_HUE_CONTROL entry  in
> > uvc_ctrls (uvc_ctrl.c) and retest VIDIOC_QUERYCTRL ?
> >
> > Set the flags field to
> >
> > UVC_CONTROL_GET_DEF |
> > UVC_CONTROL_GET_MIN |
> > UVC_CONTROL_GET_MAX |
> > UVC_CONTROL_GET_RES |
> > UVC_CONTROL_GET_CUR |
> > UVC_CONTROL_SET_CUR |
> > UVC_CONTROL_RESTORE |
> > UVC_CONTROL_AUTO_UPDATE
> >
> > at first  and remove the  GET_DEF, GET_MIN, GET_MAX and  GET_RES flags
> > one by one, trying VIDIOC_QUERYCTRL at each step. The driver will only
> > perform the listed requests in  the GET_DEF, GET_MIN, GET_MAX, GET_RES
> > order. I'd like to know which of those work or fail.
>
> VIDIOC_QUERYCTRL  success only  if  I remove  GET_DEF, GET_MIN,  GET_MAX
> and  GET_RES flags.  In  all  other cases,  my  test  program give  same
> output as  in test-output. (Except:  if I remove UVC_CONTROL_GET* flags,
> VIDIOC_G_CTRL return EINVAL).

It seems that the camera doesn't support the hue control at all, even though 
it reports it does.

The proper way to fix this is to blacklist the hue control for your model. 
Setting the UVC_QUIRK_PRUNE_CONTROLS and modifying uvc_ctrl_prune_controls() 
should do the job. Could you please try the attached patch ?

Best regards,

Laurent Pinchart

-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc-ctrl-blacklist.diff
Type: text/x-patch
Size: 2317 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090528/78778b32/attachment.bin>

From brucembeach at gmail.com  Thu May 28 20:21:38 2009
From: brucembeach at gmail.com (bruce m beach)
Date: Thu, 28 May 2009 11:21:38 -0700
Subject: [Linux-uvc-devel]  suyin crystal eye webcam 064e:a103 not working
Message-ID: <ebff8ece0905281121s258a7f67v25fca34e206d13b@mail.gmail.com>

Hello Laurent

> On Wednesday 20 May 2009 05:29:27 bruce m beach wrote:
 >
> > Okay. Here's what I have done to the code in luvcview ...
> > ... ...
> > ... ...
> > uvcGrab: ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf); (BEFORE THE CALL):
> > ... ...                                              ^^^^^^ ^^^ ^^^^
> > camera data by whatever method). The call is completed once, some other
> > stuff is executed, it is entered again, calls
> >
> >     ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf)
> >
> > and never returns. It stays in the call until kill -9 luvcview(PID)
> > is executed.
> > ... ... One question is why doesn't it time out?
>
> The V4L2 specification doesn't specify if and when VIDIOC_DQBUF should
> timeout. Why would you like it to timeout ?
>
  Maybe it shouldn't timeout, but some kind of check should be made
  in userland. A common complaint on the web is that programs (including
  luvcview) do not respond to normal program exit or "cntrl-C". The
  only way to terminate is "kill -9 pid". I believe that if something
  goes wrong and the camera doesn't start streaming then it gets stuck
  in this ioctl(VIDIOC_DQBUF) and waits forerever. The capture example
  from the uvc api uses "select" to monitor buffers and dies with

  sh-4.0# capture_example
             select timeout

  and I believe mplayer also uses the same mechanism

  sh-4.0# mplayer tv://
        Starting playback...
        v4l2: select timeout
        v4l2: select timeout ??% ??,?% 0 0
        v4l2: select timeout ??% ??,?% 0 0
        v4l2: select timeout ??% ??,?% 0 0
        v4l2: 1 frames successfully processed, 0 frames dropped.
        Exiting... (Quit)



> > I have another webcam (0c45:6009 Microdia VideoCAM ExpressII) that uses
> > "modprobe sn9c102" to work. If I run it with luvcview it is only gives
> > a green screen but the uvcGrab looping  works and it terminates normally.
> > I have another program (sn-webcam) where the ExpressII works okay.

> That's a completely different driver, and I'm not familiar with it, sorry.

  My interest in it was that it wasn't getting stalled int the VIDIOC_DQBUF
  ioctl call. I'm not clear what should work and what shouldn't work with
  luvcview. Given that everything was working properly and I used a camera
  using the sn9c102 driver which of the 3 possiblilities would you pick

   1) Definitely should work
   2) Not in a million years.
   3) Might work depending on whatever it depends on.

> > By the way doing "make" on luvcview gives a lot of redefinitions like: ...
> I assume you get those warnings with the deprecated SVN version.
> Don't use it, it's really deprecated.

  Good thing I mentioned it then. I went to

  http://svn.quickcamteam.net/svn/luvcview/trunk/luvcview/

  which I assume is the current version. It compiles without the warnings
  and seems to work a little bit better.

> The reason why VIDIOC_DQBUF fails to return is probably that the driver
> doesn't get enough data from the camera to fill a frame (or that it believes
> it doesn't).

  One question is after the first frame does it get any data at all
  and is ioctl(VIDIOC_STREAMON) really happening.

>Could you set the trace level to 255, run luvcview for a few
> seconds, kill it
>   (ctrl-\ should do the job)

  Never saw this one before but it works. Live and learn.

> and send me the messages printed by the uvcvideo driver to the kernel log ?

  Okay. I insert the following messages in the kernel log at the
approprate times

        MESSAGE modprobe uvcvideo trace=255
        MESSAGE starting luvcvideo
        MESSAGE cntrl backslash
        MESSAGE done

  here is the output from luvcview

            sh-4.0# luvcview
                       luvcview 0.2.5
                       SDL information:
                       Video driver: x11
                       A window manager is available
                       Device information:
                       Device path:  /dev/video0
                       Stream settings:
                       Frame format: MJPG
                       Frame size:   640x480
                       Frame rate:   30 fps
                       ^\Quit

   and below is the output  from the kernel log.


  Bruce

MESSAGE modprobe uvcvideo trace=255
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Brightness
to control 00000000-0000-0000-0000-000000000101/2.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Contrast
to control 00000000-0000-0000-0000-000000000101/3.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Hue to
control 00000000-0000-0000-0000-000000000101/6.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Saturation
to control 00000000-0000-0000-0000-000000000101/7.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Sharpness
to control 00000000-0000-0000-0000-000000000101/8.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Gamma to
control 00000000-0000-0000-0000-000000000101/9.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Backlight
Compensation to control 00000000-0000-0000-0000-000000000101/1.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Gain to
control 00000000-0000-0000-0000-000000000101/4.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Power Line
Frequency to control 00000000-0000-0000-0000-000000000101/5.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Hue, Auto
to control 00000000-0000-0000-0000-000000000101/16.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Exposure,
Auto to control 00000000-0000-0000-0000-000000000001/2.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Exposure,
Auto Priority to control 00000000-0000-0000-0000-000000000001/3.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Exposure
(Absolute) to control 00000000-0000-0000-0000-000000000001/4.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping White
Balance Temperature, Auto to control
00000000-0000-0000-0000-000000000101/11.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping White
Balance Temperature to control
00000000-0000-0000-0000-000000000101/10.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping White
Balance Component, Auto to control
00000000-0000-0000-0000-000000000101/13.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping White
Balance Blue Component to control
00000000-0000-0000-0000-000000000101/12.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping White
Balance Red Component to control
00000000-0000-0000-0000-000000000101/12.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Focus
(absolute) to control 00000000-0000-0000-0000-000000000001/6.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Focus,
Auto to control 00000000-0000-0000-0000-000000000001/8.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Zoom,
Absolute to control 00000000-0000-0000-0000-000000000001/11.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Zoom,
Continuous to control 00000000-0000-0000-0000-000000000001/12.
May 28 10:52:28 lapsystemx kernel: uvcvideo: Adding mapping Privacy to
control 00000000-0000-0000-0000-000000000001/17.
May 28 10:52:28 lapsystemx kernel: uvcvideo 4-1:1.0: usb_probe_interface
May 28 10:52:28 lapsystemx kernel: uvcvideo 4-1:1.0:
usb_probe_interface - got id
May 28 10:52:28 lapsystemx kernel: uvcvideo: Probing generic UVC device 1
May 28 10:52:28 lapsystemx kernel: uvcvideo: Found format MJPEG.
May 28 10:52:28 lapsystemx kernel: uvcvideo: - 640x480 (30.0 fps)
May 28 10:52:28 lapsystemx kernel: uvcvideo: - 352x288 (30.0 fps)
May 28 10:52:28 lapsystemx kernel: uvcvideo: - 320x240 (30.0 fps)
May 28 10:52:28 lapsystemx kernel: uvcvideo: - 176x144 (30.0 fps)
May 28 10:52:28 lapsystemx kernel: uvcvideo: - 160x120 (30.0 fps)
May 28 10:52:28 lapsystemx kernel: uvcvideo: Found a Status endpoint (addr 83).
May 28 10:52:28 lapsystemx kernel: uvcvideo: Found UVC 1.00 device
Crystal Eye webcam (064e:a103)
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/2 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/3 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/6 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/7 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/8 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/9 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/12 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/1 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/5 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Added control
00000000-0000-0000-0000-000000000101/13 to device 1 entity 3
May 28 10:52:28 lapsystemx kernel: uvcvideo: Scanning UVC chain: OT 2
<- XU 5 <- XU 4 <- PU 3 <- IT 1
May 28 10:52:28 lapsystemx kernel: uvcvideo: Found a valid video chain (1 -> 2).
May 28 10:52:28 lapsystemx kernel: input: Crystal Eye webcam as
/class/input/input8
May 28 10:52:28 lapsystemx kernel: uvcvideo: UVC device initialized.
May 28 10:52:28 lapsystemx kernel: usbcore: registered new interface
driver uvcvideo
May 28 10:52:28 lapsystemx kernel: USB Video Class driver (v0.1.0)
MESSAGE starting luvcvideo
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_open
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYCAP)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_ENUM_FMT)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_ENUM_FMT)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_S_FMT)
May 28 10:53:23 lapsystemx kernel: uvcvideo: Trying format 0x47504a4d
(MJPG): 640x480.
May 28 10:53:23 lapsystemx kernel: uvcvideo: Using default frame
interval 33333.3 us (30.0 fps).
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_S_PARM)
May 28 10:53:23 lapsystemx kernel: uvcvideo: Setting frame interval to
1/30 (333333).
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_G_PARM)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_REQBUFS)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_mmap
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_mmap
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_mmap
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_mmap
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: Queuing buffer 0.
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: Queuing buffer 1.
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: Queuing buffer 2.
May 28 10:53:23 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
May 28 10:53:23 lapsystemx kernel: uvcvideo: Queuing buffer 3.
May 28 10:53:26 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_STREAMON)
May 28 10:53:26 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
May 28 10:53:28 lapsystemx kernel: uvcvideo: Frame complete (overflow).
May 28 10:53:28 lapsystemx kernel: uvcvideo: Dropping payload (out of sync).
May 28 10:53:28 lapsystemx last message repeated 18 times
May 28 10:53:28 lapsystemx kernel: uvcvideo: Dequeuing buffer 0 (3,
307789 bytes).
May 28 10:53:28 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
May 28 10:53:28 lapsystemx kernel: uvcvideo: Queuing buffer 0.
May 28 10:53:28 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
May 28 10:53:28 lapsystemx kernel: uvcvideo: Dropping payload (out of sync).
May 28 10:53:59 lapsystemx last message repeated 30784 times
May 28 10:55:00 lapsystemx last message repeated 60992 times
MESSAGE cntrl backslash
May 28 10:55:24 lapsystemx last message repeated 24351 times
May 28 10:55:24 lapsystemx kernel: uvcvideo: uvc_v4l2_release
MESSAGE done


From jbaena at decsai.ugr.es  Fri May 29 12:18:11 2009
From: jbaena at decsai.ugr.es (Javier =?iso-8859-1?q?Mart=EDnez_Baena?=)
Date: Fri, 29 May 2009 12:18:11 +0200
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
Message-ID: <200905291218.11561.jbaena@decsai.ugr.es>

>Hi Javier,
>
>On Friday 22 May 2009 09:36:32 J. Mart?nez Baena wrote:
>> Hello,
>
>> I have a problem with 2 webcams I'm trying to get work simultaneously. I
>> have several models (Logitech P3000, Logitech P9000, Creative LiveCAM Optia
>> AF, Philips). When I plug two of them on different USB ports, then
>> everything works ok: I can see both simultaneously with, for example,
>> luvcview.
>>
>> The problem exists when I plug two of them on the same USB (for example on
>> frontal USB or in a USB hub). I've got the problem for combinations in wich
>> UVC driver is used by both cameras. I can get frames for one of them (the
>> first that I try), but for the second one I get a "noisy/green" screen ...
>> it seems as if the image is corrupted.
>>
>> However, if I put the philips and the logitech P9000/Optia it works fine.
>> The Philips (and logitech P3000) use a different driver than UVC. Also, I
>> can plug two philips webcam and they works fine.
>>
>> ?Is this a bug or an unresolved problem of the UVC driver? ?Is it a USB
>> problem?
>
>My guess is that you're having USB bandwidth issues. As the uvcvideo driver 
>starts capturing video on both cameras, you're not exceeding the theoretical 
>USB bandwidth limit. However, bugs in the USB host controller, the USB host 
>controller driver or the camera can result in corrupted data. Could you 
>perform the same test on another computer ?
>
>Best regards,
>
>Laurent Pinchart


Hi Laurent, 

Sorry for the delay ... I make some tests on several computers and the problem 
persists. My guess is that is a problem of UVC driver (but I'm not an expert 
... so it's only a guess!). When I connect different webcams (using other 
driver than UVC) it works.

I tried with different resolutions (320x240, 640x480, ...) and different 
framerates.

Sometimes, when a cam is running (capturing), I can't even initialice the 
other one (neither consult for allowed resolutions, etc).

But I don't know how USB driver works, so, maybe an USB problem.

Best regards




From jezz at sysmic.org  Fri May 29 12:30:36 2009
From: jezz at sysmic.org (=?iso-8859-15?q?J=E9r=F4me_Pouiller?=)
Date: Fri, 29 May 2009 12:30:36 +0200
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5986:0241)
In-Reply-To: <200905281559.59161.laurent.pinchart@skynet.be>
References: <200905261749.15922.jezz@sysmic.org>
	<200905281521.53139.jezz@sysmic.org>
	<200905281559.59161.laurent.pinchart@skynet.be>
Message-ID: <200905291230.37392.jezz@sysmic.org>

Hi Laurent,

On Thursday 28 May 2009 15:59:58 Laurent Pinchart wrote:
> Hi J?r?me,
>
> On Thursday 28 May 2009 15:21:52 J?r?me Pouiller wrote:
> > On Wednesday 27 May 2009 17:11:03 Laurent Pinchart wrote:
> > > On Tuesday 26 May 2009 17:49:14 J?r?me Pouiller wrote:
[...]
> > > Could you try to read the value (VIDIOC_G_CTRL) of the hue
> > > control ?
> >
> > It   return  EIO   and   uvcvideo  driver   print   same  message  
> > (see test-BisonCam.c and test-output).
>
> I expected the uvcvideo driver to print a slightly different message
> (129 instead of 135). I'm pretty sure it did, you might have missed
> that.
Yes, you're right.

[...]
> > VIDIOC_QUERYCTRL  success only  if  I remove  GET_DEF, GET_MIN, 
> > GET_MAX and  GET_RES flags.  In  all  other cases,  my  test 
> > program give  same output as  in test-output. (Except:  if I remove
> > UVC_CONTROL_GET* flags, VIDIOC_G_CTRL return EINVAL).
>
> It seems that the camera doesn't support the hue control at all, even
> though it reports it does.
>
> The proper way to fix this is to blacklist the hue control for your
> model. Setting the UVC_QUIRK_PRUNE_CONTROLS and modifying
> uvc_ctrl_prune_controls() should do the job. Could you please try the
> attached patch ?
Your patch apply right on 2.6.29. Nevertheless, with 2.6.28, I had to 
do some changes in order to use it. I also add UVC_QUIRK_PRUNE_CONTROLS 
flag to 5986:0241 in uvc_ids to automatically apply the quirk.

Else, this patch works very well. Thank you.

Best regards,

-- 
J?r?me Pouiller (jezz AT sysmic DOT org)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc-ctrl-blacklist-2.6.28.9.patch
Type: text/x-patch
Size: 4003 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090529/7ea11cbc/attachment.bin>

From pj.assis at gmail.com  Fri May 29 14:49:55 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 29 May 2009 13:49:55 +0100
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
In-Reply-To: <200905291218.11561.jbaena@decsai.ugr.es>
References: <200905291218.11561.jbaena@decsai.ugr.es>
Message-ID: <59cf47a80905290549s131bbe73g4f6bbffe0aeb178b@mail.gmail.com>

Javier Hi,
You should know that at least logitech cameras don't handle well usb hubs,
logitech is very clear on this, if you want you can get more info on the
quickcamteam site and forums, it has something to do with the way data is
handled by most usb hubs.
Anyway I have been able to connect up to 3 uvc cameras simultaneously in my
pc, and I believe two of them were on the same host (I mounted the pc myself
so I should know this for sure, but my memory has seen better days :) ), all
of them use the ehci driver.
Some drivers are in fact buggy, just check the following link for a example
(in this case the musb driver):
http://forums.quickcamteam.net/showthread.php?tid=821

Best regards,
Paulo

2009/5/29 Javier Mart?nez Baena <jbaena at decsai.ugr.es>

> >Hi Javier,
> >
> >On Friday 22 May 2009 09:36:32 J. Mart?nez Baena wrote:
> >> Hello,
> >
> >> I have a problem with 2 webcams I'm trying to get work simultaneously. I
> >> have several models (Logitech P3000, Logitech P9000, Creative LiveCAM
> Optia
> >> AF, Philips). When I plug two of them on different USB ports, then
> >> everything works ok: I can see both simultaneously with, for example,
> >> luvcview.
> >>
> >> The problem exists when I plug two of them on the same USB (for example
> on
> >> frontal USB or in a USB hub). I've got the problem for combinations in
> wich
> >> UVC driver is used by both cameras. I can get frames for one of them
> (the
> >> first that I try), but for the second one I get a "noisy/green" screen
> ...
> >> it seems as if the image is corrupted.
> >>
> >> However, if I put the philips and the logitech P9000/Optia it works
> fine.
> >> The Philips (and logitech P3000) use a different driver than UVC. Also,
> I
> >> can plug two philips webcam and they works fine.
> >>
> >> ?Is this a bug or an unresolved problem of the UVC driver? ?Is it a USB
> >> problem?
> >
> >My guess is that you're having USB bandwidth issues. As the uvcvideo
> driver
> >starts capturing video on both cameras, you're not exceeding the
> theoretical
> >USB bandwidth limit. However, bugs in the USB host controller, the USB
> host
> >controller driver or the camera can result in corrupted data. Could you
> >perform the same test on another computer ?
> >
> >Best regards,
> >
> >Laurent Pinchart
>
>
> Hi Laurent,
>
> Sorry for the delay ... I make some tests on several computers and the
> problem
> persists. My guess is that is a problem of UVC driver (but I'm not an
> expert
> ... so it's only a guess!). When I connect different webcams (using other
> driver than UVC) it works.
>
> I tried with different resolutions (320x240, 640x480, ...) and different
> framerates.
>
> Sometimes, when a cam is running (capturing), I can't even initialice the
> other one (neither consult for allowed resolutions, etc).
>
> But I don't know how USB driver works, so, maybe an USB problem.
>
> Best regards
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090529/e6f8defd/attachment.html>

From jbaena at decsai.ugr.es  Fri May 29 17:39:40 2009
From: jbaena at decsai.ugr.es (Javier Martinez Baena)
Date: Fri, 29 May 2009 17:39:40 +0200
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
In-Reply-To: <59cf47a80905290549s131bbe73g4f6bbffe0aeb178b@mail.gmail.com>
References: <200905291218.11561.jbaena@decsai.ugr.es>
	<59cf47a80905290549s131bbe73g4f6bbffe0aeb178b@mail.gmail.com>
Message-ID: <20090529153347.M86876@decsai.ugr.es>


Thanks Paulo, not only Logitech fails, but also Creative (Optia AF at least).
I will get a new Philips soon ... I hope this will work better.


On Fri, 29 May 2009 13:49:55 +0100, Paulo Assis wrote
> Javier Hi,
> You should know that at least logitech cameras don't handle well usb 
> hubs, logitech is very clear on this, if you want you can get more 
> info on the quickcamteam site and forums, it has something to do 
> with the way data is handled by most usb hubs. Anyway I have been 
> able to connect up to 3 uvc cameras simultaneously in my pc, and I 
> believe two of them were on the same host (I mounted the pc myself 
> so I should know this for sure, but my memory has seen better days :)
>  ), all of them use the ehci driver. Some drivers are in fact buggy, 
> just check the following link for a example
> (in this case the musb driver):
http://forums.quickcamteam.net/showthread.php?tid=821
> 
> Best regards,
> Paulo
> 
> 2009/5/29 Javier Mart?nez Baena <jbaena at decsai.ugr.es>
> 
> > >Hi Javier,
> > >
> > >On Friday 22 May 2009 09:36:32 J. Mart?nez Baena wrote:
> > >> Hello,
> > >
> > >> I have a problem with 2 webcams I'm trying to get work simultaneously. I
> > >> have several models (Logitech P3000, Logitech P9000, Creative LiveCAM
> > Optia
> > >> AF, Philips). When I plug two of them on different USB ports, then
> > >> everything works ok: I can see both simultaneously with, for example,
> > >> luvcview.
> > >>
> > >> The problem exists when I plug two of them on the same USB (for example
> > on
> > >> frontal USB or in a USB hub). I've got the problem for combinations in
> > wich
> > >> UVC driver is used by both cameras. I can get frames for one of them
> > (the
> > >> first that I try), but for the second one I get a "noisy/green" screen
> > ...
> > >> it seems as if the image is corrupted.
> > >>
> > >> However, if I put the philips and the logitech P9000/Optia it works
> > fine.
> > >> The Philips (and logitech P3000) use a different driver than UVC. Also,
> > I
> > >> can plug two philips webcam and they works fine.
> > >>
> > >> ?Is this a bug or an unresolved problem of the UVC driver? ?Is it a USB
> > >> problem?
> > >
> > >My guess is that you're having USB bandwidth issues. As the uvcvideo
> > driver
> > >starts capturing video on both cameras, you're not exceeding the
> > theoretical
> > >USB bandwidth limit. However, bugs in the USB host controller, the USB
> > host
> > >controller driver or the camera can result in corrupted data. Could you
> > >perform the same test on another computer ?
> > >
> > >Best regards,
> > >
> > >Laurent Pinchart
> >
> >
> > Hi Laurent,
> >
> > Sorry for the delay ... I make some tests on several computers and the
> > problem
> > persists. My guess is that is a problem of UVC driver (but I'm not an
> > expert
> > ... so it's only a guess!). When I connect different webcams (using other
> > driver than UVC) it works.
> >
> > I tried with different resolutions (320x240, 640x480, ...) and different
> > framerates.
> >
> > Sometimes, when a cam is running (capturing), I can't even initialice the
> > other one (neither consult for allowed resolutions, etc).
> >
> > But I don't know how USB driver works, so, maybe an USB problem.
> >
> > Best regards
> >
> >
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >


--
Dr. Javier Mart?nez Baena
Dpto. Ciencias de la Computaci?n e I. A.
E.T.S. de Ingenier?a Inform?tica
Universidad de Granada
Tlf: 958 240802
Fax: 958 243317
Email: jbaena at decsai.ugr.es

--
DEpartment of Computer Science and A.I. http://decsai.ugr.es



From pj.assis at gmail.com  Fri May 29 23:40:58 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 29 May 2009 22:40:58 +0100
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
In-Reply-To: <20090529153347.M86876@decsai.ugr.es>
References: <200905291218.11561.jbaena@decsai.ugr.es>
	<59cf47a80905290549s131bbe73g4f6bbffe0aeb178b@mail.gmail.com>
	<20090529153347.M86876@decsai.ugr.es>
Message-ID: <59cf47a80905291440o74440e2bm79f33b68aeae56b3@mail.gmail.com>

Javier,
I've done some more testing and this is what I found when capturing
640x480 at 25fps video from 2 uvc cameras on the same controler, both from
logitech a QC5000pro and another camera I've been testing:
- I can capture video from both of them when streaming MJPEG data on the two
cameras.
- I can capture video from both of them when streaming MJPEG data from one
and YUYV data from the other one.
- when using a YUYV stream on both I can only capture from the first camera,
from the second I get a error of no space left, basically the USB bandwith
is not enought.

Best regards,
Paulo

2009/5/29 Javier Martinez Baena <jbaena at decsai.ugr.es>

>
> Thanks Paulo, not only Logitech fails, but also Creative (Optia AF at
> least).
> I will get a new Philips soon ... I hope this will work better.
>
>
> On Fri, 29 May 2009 13:49:55 +0100, Paulo Assis wrote
> > Javier Hi,
> > You should know that at least logitech cameras don't handle well usb
> > hubs, logitech is very clear on this, if you want you can get more
> > info on the quickcamteam site and forums, it has something to do
> > with the way data is handled by most usb hubs. Anyway I have been
> > able to connect up to 3 uvc cameras simultaneously in my pc, and I
> > believe two of them were on the same host (I mounted the pc myself
> > so I should know this for sure, but my memory has seen better days :)
> >  ), all of them use the ehci driver. Some drivers are in fact buggy,
> > just check the following link for a example
> > (in this case the musb driver):
> http://forums.quickcamteam.net/showthread.php?tid=821
> >
> > Best regards,
> > Paulo
> >
> > 2009/5/29 Javier Mart?nez Baena <jbaena at decsai.ugr.es>
> >
> > > >Hi Javier,
> > > >
> > > >On Friday 22 May 2009 09:36:32 J. Mart?nez Baena wrote:
> > > >> Hello,
> > > >
> > > >> I have a problem with 2 webcams I'm trying to get work
> simultaneously. I
> > > >> have several models (Logitech P3000, Logitech P9000, Creative
> LiveCAM
> > > Optia
> > > >> AF, Philips). When I plug two of them on different USB ports, then
> > > >> everything works ok: I can see both simultaneously with, for
> example,
> > > >> luvcview.
> > > >>
> > > >> The problem exists when I plug two of them on the same USB (for
> example
> > > on
> > > >> frontal USB or in a USB hub). I've got the problem for combinations
> in
> > > wich
> > > >> UVC driver is used by both cameras. I can get frames for one of them
> > > (the
> > > >> first that I try), but for the second one I get a "noisy/green"
> screen
> > > ...
> > > >> it seems as if the image is corrupted.
> > > >>
> > > >> However, if I put the philips and the logitech P9000/Optia it works
> > > fine.
> > > >> The Philips (and logitech P3000) use a different driver than UVC.
> Also,
> > > I
> > > >> can plug two philips webcam and they works fine.
> > > >>
> > > >> ?Is this a bug or an unresolved problem of the UVC driver? ?Is it a
> USB
> > > >> problem?
> > > >
> > > >My guess is that you're having USB bandwidth issues. As the uvcvideo
> > > driver
> > > >starts capturing video on both cameras, you're not exceeding the
> > > theoretical
> > > >USB bandwidth limit. However, bugs in the USB host controller, the USB
> > > host
> > > >controller driver or the camera can result in corrupted data. Could
> you
> > > >perform the same test on another computer ?
> > > >
> > > >Best regards,
> > > >
> > > >Laurent Pinchart
> > >
> > >
> > > Hi Laurent,
> > >
> > > Sorry for the delay ... I make some tests on several computers and the
> > > problem
> > > persists. My guess is that is a problem of UVC driver (but I'm not an
> > > expert
> > > ... so it's only a guess!). When I connect different webcams (using
> other
> > > driver than UVC) it works.
> > >
> > > I tried with different resolutions (320x240, 640x480, ...) and
> different
> > > framerates.
> > >
> > > Sometimes, when a cam is running (capturing), I can't even initialice
> the
> > > other one (neither consult for allowed resolutions, etc).
> > >
> > > But I don't know how USB driver works, so, maybe an USB problem.
> > >
> > > Best regards
> > >
> > >
> > > _______________________________________________
> > > Linux-uvc-devel mailing list
> > > Linux-uvc-devel at lists.berlios.de
> > > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> > >
>
>
> --
> Dr. Javier Mart?nez Baena
> Dpto. Ciencias de la Computaci?n e I. A.
> E.T.S. de Ingenier?a Inform?tica
> Universidad de Granada
> Tlf: 958 240802
> Fax: 958 243317
> Email: jbaena at decsai.ugr.es
>
> --
> DEpartment of Computer Science and A.I. http://decsai.ugr.es
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090529/d03fba2d/attachment.html>

From jbaena at decsai.ugr.es  Sat May 30 00:07:56 2009
From: jbaena at decsai.ugr.es (Javier Martinez Baena)
Date: Sat, 30 May 2009 00:07:56 +0200
Subject: [Linux-uvc-devel] Two webcams simultaneously on the same USB
In-Reply-To: <59cf47a80905291440o74440e2bm79f33b68aeae56b3@mail.gmail.com>
References: <200905291218.11561.jbaena@decsai.ugr.es>
	<59cf47a80905290549s131bbe73g4f6bbffe0aeb178b@mail.gmail.com>
	<20090529153347.M86876@decsai.ugr.es>
	<59cf47a80905291440o74440e2bm79f33b68aeae56b3@mail.gmail.com>
Message-ID: <20090529220350.M65272@decsai.ugr.es>


Thanks Paulo, I've using only YUYV ... I don't use MJPEG because I have an own
library to capture and I have not yet implemented that. Probably I should work
on it now.

Thanks again and best wishes



On Fri, 29 May 2009 22:40:58 +0100, Paulo Assis wrote
> Javier,
> I've done some more testing and this is what I found when capturing
> 640x480 at 25fps video from 2 uvc cameras on the same controler, both from
> logitech a QC5000pro and another camera I've been testing:
> - I can capture video from both of them when streaming MJPEG data on 
> the two cameras. - I can capture video from both of them when 
> streaming MJPEG data from one and YUYV data from the other one. -
>  when using a YUYV stream on both I can only capture from the first 
> camera, from the second I get a error of no space left, basically 
> the USB bandwith is not enought.
> 
> Best regards,
> Paulo
> 
> 2009/5/29 Javier Martinez Baena <jbaena at decsai.ugr.es>
> 
> >
> > Thanks Paulo, not only Logitech fails, but also Creative (Optia AF at
> > least).
> > I will get a new Philips soon ... I hope this will work better.
> >
> >
> > On Fri, 29 May 2009 13:49:55 +0100, Paulo Assis wrote
> > > Javier Hi,
> > > You should know that at least logitech cameras don't handle well usb
> > > hubs, logitech is very clear on this, if you want you can get more
> > > info on the quickcamteam site and forums, it has something to do
> > > with the way data is handled by most usb hubs. Anyway I have been
> > > able to connect up to 3 uvc cameras simultaneously in my pc, and I
> > > believe two of them were on the same host (I mounted the pc myself
> > > so I should know this for sure, but my memory has seen better days :)
> > >  ), all of them use the ehci driver. Some drivers are in fact buggy,
> > > just check the following link for a example
> > > (in this case the musb driver):
> > http://forums.quickcamteam.net/showthread.php?tid=821
> > >
> > > Best regards,
> > > Paulo
> > >
> > > 2009/5/29 Javier Mart?nez Baena <jbaena at decsai.ugr.es>
> > >
> > > > >Hi Javier,
> > > > >
> > > > >On Friday 22 May 2009 09:36:32 J. Mart?nez Baena wrote:
> > > > >> Hello,
> > > > >
> > > > >> I have a problem with 2 webcams I'm trying to get work
> > simultaneously. I
> > > > >> have several models (Logitech P3000, Logitech P9000, Creative
> > LiveCAM
> > > > Optia
> > > > >> AF, Philips). When I plug two of them on different USB ports, then
> > > > >> everything works ok: I can see both simultaneously with, for
> > example,
> > > > >> luvcview.
> > > > >>
> > > > >> The problem exists when I plug two of them on the same USB (for
> > example
> > > > on
> > > > >> frontal USB or in a USB hub). I've got the problem for combinations
> > in
> > > > wich
> > > > >> UVC driver is used by both cameras. I can get frames for one of them
> > > > (the
> > > > >> first that I try), but for the second one I get a "noisy/green"
> > screen
> > > > ...
> > > > >> it seems as if the image is corrupted.
> > > > >>
> > > > >> However, if I put the philips and the logitech P9000/Optia it works
> > > > fine.
> > > > >> The Philips (and logitech P3000) use a different driver than UVC.
> > Also,
> > > > I
> > > > >> can plug two philips webcam and they works fine.
> > > > >>
> > > > >> ?Is this a bug or an unresolved problem of the UVC driver? ?Is it a
> > USB
> > > > >> problem?
> > > > >
> > > > >My guess is that you're having USB bandwidth issues. As the uvcvideo
> > > > driver
> > > > >starts capturing video on both cameras, you're not exceeding the
> > > > theoretical
> > > > >USB bandwidth limit. However, bugs in the USB host controller, the USB
> > > > host
> > > > >controller driver or the camera can result in corrupted data. Could
> > you
> > > > >perform the same test on another computer ?
> > > > >
> > > > >Best regards,
> > > > >
> > > > >Laurent Pinchart
> > > >
> > > >
> > > > Hi Laurent,
> > > >
> > > > Sorry for the delay ... I make some tests on several computers and the
> > > > problem
> > > > persists. My guess is that is a problem of UVC driver (but I'm not an
> > > > expert
> > > > ... so it's only a guess!). When I connect different webcams (using
> > other
> > > > driver than UVC) it works.
> > > >
> > > > I tried with different resolutions (320x240, 640x480, ...) and
> > different
> > > > framerates.
> > > >
> > > > Sometimes, when a cam is running (capturing), I can't even initialice
> > the
> > > > other one (neither consult for allowed resolutions, etc).
> > > >
> > > > But I don't know how USB driver works, so, maybe an USB problem.
> > > >
> > > > Best regards
> > > >
> > > >
> > > > _______________________________________________
> > > > Linux-uvc-devel mailing list
> > > > Linux-uvc-devel at lists.berlios.de
> > > > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> > > >

--
DEpartment of Computer Science and A.I. http://decsai.ugr.es



From jon.fairbairn at cl.cam.ac.uk  Sat May 30 10:27:19 2009
From: jon.fairbairn at cl.cam.ac.uk (Jon Fairbairn)
Date: Sat, 30 May 2009 09:27:19 +0100
Subject: [Linux-uvc-devel] [PATCH] VIDIOC_[GS]_JPEGCOMP support
References: <EFE3E62A-C489-45B7-A4B2-B0E53E953AB3@federated.com>
	<200810150131.33731.laurent.pinchart@skynet.be>
	<wf4ovbhg26.fsf@calligramme.charmers>
	<200905270150.18955.laurent.pinchart@skynet.be>
Message-ID: <wfeiu7f120.fsf@calligramme.charmers>

Laurent Pinchart <laurent.pinchart at skynet.be> writes:

> Hi Jon,

Greetings

> On Saturday 23 May 2009 19:42:09 Jon Fairbairn wrote:
>> (Mostly posting to indicate that there is other interest in
>> this issue).
>>
>> [1] I can't address the USB root issue as I'm too far from
>> the camera to unplug it.
>
> I guess I have no choice but to work on this then :-)

That would be appreciated.

> I'll try to get a patch ready for the end of the week. If
> I don't feel free to (nicely) remind me.

Before i can decide to remind you, I need to know whether
you regard the week as ending on Saturday or Sunday ;-)

-- 
J?n Fairbairn                                 Jon.Fairbairn at cl.cam.ac.uk



From laurent.pinchart at skynet.be  Sun May 31 22:09:25 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 31 May 2009 22:09:25 +0200
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5986:0241)
In-Reply-To: <200905291230.37392.jezz@sysmic.org>
References: <200905261749.15922.jezz@sysmic.org>
	<200905281559.59161.laurent.pinchart@skynet.be>
	<200905291230.37392.jezz@sysmic.org>
Message-ID: <200905312209.26101.laurent.pinchart@skynet.be>

Hi J?r?me,

On Friday 29 May 2009 12:30:36 J?r?me Pouiller wrote:
> Hi Laurent,
>
> On Thursday 28 May 2009 15:59:58 Laurent Pinchart wrote:
> > Hi J?r?me,
> >
> > On Thursday 28 May 2009 15:21:52 J?r?me Pouiller wrote:
> > > On Wednesday 27 May 2009 17:11:03 Laurent Pinchart wrote:
> > > > On Tuesday 26 May 2009 17:49:14 J?r?me Pouiller wrote:
>
> [...]
>
> > > > Could you try to read the value (VIDIOC_G_CTRL) of the hue
> > > > control ?
> > >
> > > It   return  EIO   and   uvcvideo  driver   print   same  message
> > > (see test-BisonCam.c and test-output).
> >
> > I expected the uvcvideo driver to print a slightly different message
> > (129 instead of 135). I'm pretty sure it did, you might have missed
> > that.
>
> Yes, you're right.
>
> [...]
>
> > > VIDIOC_QUERYCTRL  success only  if  I remove  GET_DEF, GET_MIN,
> > > GET_MAX and  GET_RES flags.  In  all  other cases,  my  test
> > > program give  same output as  in test-output. (Except:  if I remove
> > > UVC_CONTROL_GET* flags, VIDIOC_G_CTRL return EINVAL).
> >
> > It seems that the camera doesn't support the hue control at all, even
> > though it reports it does.
> >
> > The proper way to fix this is to blacklist the hue control for your
> > model. Setting the UVC_QUIRK_PRUNE_CONTROLS and modifying
> > uvc_ctrl_prune_controls() should do the job. Could you please try the
> > attached patch ?
>
> Your patch apply right on 2.6.29. Nevertheless, with 2.6.28, I had to
> do some changes in order to use it. I also add UVC_QUIRK_PRUNE_CONTROLS
> flag to 5986:0241 in uvc_ids to automatically apply the quirk.
>
> Else, this patch works very well. Thank you.

You're welcome. I've reworked the patch a bit and I'll submit it soon.

Could you please tell me in what monitor/laptop/whatever the 5986:0241 camera 
can be found ? I'll then update the supported devices list.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Sun May 31 22:49:29 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 31 May 2009 22:49:29 +0200
Subject: [Linux-uvc-devel] suyin crystal eye webcam 064e:a103 not working
In-Reply-To: <ebff8ece0905281121s258a7f67v25fca34e206d13b@mail.gmail.com>
References: <ebff8ece0905281121s258a7f67v25fca34e206d13b@mail.gmail.com>
Message-ID: <200905312249.29613.laurent.pinchart@skynet.be>

Hi Bruce,

On Thursday 28 May 2009 20:21:38 bruce m beach wrote:
> Hello Laurent
>
> > On Wednesday 20 May 2009 05:29:27 bruce m beach wrote:
> > > Okay. Here's what I have done to the code in luvcview ...
> > > ... ...
> > > ... ...
> > > uvcGrab: ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf); (BEFORE THE CALL):
> > > ... ...                                              ^^^^^^ ^^^ ^^^^
> > > camera data by whatever method). The call is completed once, some other
> > > stuff is executed, it is entered again, calls
> > >
> > >     ret=ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf)
> > >
> > > and never returns. It stays in the call until kill -9 luvcview(PID)
> > > is executed.
> > > ... ... One question is why doesn't it time out?
> >
> > The V4L2 specification doesn't specify if and when VIDIOC_DQBUF should
> > timeout. Why would you like it to timeout ?
>
>   Maybe it shouldn't timeout, but some kind of check should be made
>   in userland. A common complaint on the web is that programs (including
>   luvcview) do not respond to normal program exit or "cntrl-C". The
>   only way to terminate is "kill -9 pid".

kill -3 (ctrl-\) or -15 should work as well.

>   I believe that if something goes wrong and the camera doesn't start
>   streaming then it gets stuck in this ioctl(VIDIOC_DQBUF) and waits
>   forerever. The capture example from the uvc api uses "select" to monitor
>   buffers and dies with
>
>   sh-4.0# capture_example
>              select timeout
>
>   and I believe mplayer also uses the same mechanism
>
>   sh-4.0# mplayer tv://
>         Starting playback...
>         v4l2: select timeout
>         v4l2: select timeout ??% ??,?% 0 0
>         v4l2: select timeout ??% ??,?% 0 0
>         v4l2: select timeout ??% ??,?% 0 0
>         v4l2: 1 frames successfully processed, 0 frames dropped.
>         Exiting... (Quit)

select() is the right way to go if you need timeouts. When the application 
receives a SIGINT signal (ctrl-C) the uvcvideo driver will return from 
VIDIOC_DQBUF with -ERESTARTSYS. The ioctl is then called again immediately by 
the standard C library.

> > > I have another webcam (0c45:6009 Microdia VideoCAM ExpressII) that uses
> > > "modprobe sn9c102" to work. If I run it with luvcview it is only gives
> > > a green screen but the uvcGrab looping  works and it terminates
> > > normally. I have another program (sn-webcam) where the ExpressII works
> > > okay.
> >
> > That's a completely different driver, and I'm not familiar with it,
> > sorry.
>
>   My interest in it was that it wasn't getting stalled int the VIDIOC_DQBUF
>   ioctl call. I'm not clear what should work and what shouldn't work with
>   luvcview. Given that everything was working properly and I used a camera
>   using the sn9c102 driver which of the 3 possiblilities would you pick
>
>    1) Definitely should work
>    2) Not in a million years.
>    3) Might work depending on whatever it depends on.

I'd go for 3. luvcview still has bugs, and should use a select() main loop.

> > > By the way doing "make" on luvcview gives a lot of redefinitions like:
> > > ...
> >
> > I assume you get those warnings with the deprecated SVN version.
> > Don't use it, it's really deprecated.
>
>   Good thing I mentioned it then. I went to
>
>   http://svn.quickcamteam.net/svn/luvcview/trunk/luvcview/
>
>   which I assume is the current version. It compiles without the warnings
>   and seems to work a little bit better.

Oops, sorry, I spoke too fast. The uvcvideo SVN version is deprecated. 
luvcview isn't.

> > The reason why VIDIOC_DQBUF fails to return is probably that the driver
> > doesn't get enough data from the camera to fill a frame (or that it
> > believes it doesn't).
>
>   One question is after the first frame does it get any data at all
>   and is ioctl(VIDIOC_STREAMON) really happening.

As the green led on your camera turns on I suppose the video stream really 
starts.

> > Could you set the trace level to 255, run luvcview for a few
> > seconds, kill it(ctrl-\ should do the job)
>
>   Never saw this one before but it works. Live and learn.
>
> > and send me the messages printed by the uvcvideo driver to the kernel log
> > ?
>
>   Okay. I insert the following messages in the kernel log at the
> approprate times
>
>         MESSAGE modprobe uvcvideo trace=255
>         MESSAGE starting luvcvideo
>         MESSAGE cntrl backslash
>         MESSAGE done
>
>   here is the output from luvcview
>
>             sh-4.0# luvcview
>                        luvcview 0.2.5
>                        SDL information:
>                        Video driver: x11
>                        A window manager is available
>                        Device information:
>                        Device path:  /dev/video0
>                        Stream settings:
>                        Frame format: MJPG
>                        Frame size:   640x480
>                        Frame rate:   30 fps
>                        ^\Quit
>
>    and below is the output  from the kernel log.
>
> MESSAGE modprobe uvcvideo trace=255

[snip]

> May 28 10:53:26 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_STREAMON)
> May 28 10:53:26 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
> May 28 10:53:28 lapsystemx kernel: uvcvideo: Frame complete (overflow).
> May 28 10:53:28 lapsystemx kernel: uvcvideo: Dropping payload (out of sync).
> May 28 10:53:28 lapsystemx last message repeated 18 times
> May 28 10:53:28 lapsystemx kernel: uvcvideo: Dequeuing buffer 0 (3, 307789 
bytes).
> May 28 10:53:28 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
> May 28 10:53:28 lapsystemx kernel: uvcvideo: Queuing buffer 0.
> May 28 10:53:28 lapsystemx kernel: uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
> May 28 10:53:28 lapsystemx kernel: uvcvideo: Dropping payload (out of sync).
> May 28 10:53:59 lapsystemx last message repeated 30784 times
> May 28 10:55:00 lapsystemx last message repeated 60992 times
> MESSAGE cntrl backslash
> May 28 10:55:24 lapsystemx last message repeated 24351 times
> May 28 10:55:24 lapsystemx kernel: uvcvideo: uvc_v4l2_release
> MESSAGE done

It seems the device doesn't toggle the FID bit in the UVC packet header. Could 
you try loading the driver with quirks=16 ?

Best regards,

Laurent Pinchart



From cshorler at googlemail.com  Sun May 31 23:09:34 2009
From: cshorler at googlemail.com (Christopher HORLER)
Date: Sun, 31 May 2009 22:09:34 +0100
Subject: [Linux-uvc-devel] Audio Problem / USB disconnects
In-Reply-To: <3337c250905310410u35fc3bfaje1dba45a80fe7d48@mail.gmail.com>
References: <3337c250905310410u35fc3bfaje1dba45a80fe7d48@mail.gmail.com>
Message-ID: <3337c250905311409u490001b2rb89b30a7b97c593e@mail.gmail.com>

Hi,

I'm experiencing some difficulty with the Logitech Sphere AF. (I can
temporarily reset the camera by removing the uvcvideo and
snd_usb_audio modules from the kernel).
Details below:

Chris

I'm running openSuSE 11.1, SuSE kernel 2.6.27.21-0.1-default, if it
would help I can update the module to the latest version from the
project page.

I have added the following line to modprobe.conf.local - which
initially allows the video and audio to function:
install uvcvideo /sbin/modprobe snd_usb_audio; /sbin/modprobe
--ignore-install uvcvideo

The system is showing spontaneous 'USB disconnects' at random
intervals (e.g. the first disconnect below). ?I also notice 'Failed to
query ... control ...' from uvcvideo.

dmesg:
usb 4-4: new high speed USB device using ehci_hcd and address 2
usb 4-4: configuration #1 chosen from 1 choice
usb 4-4: New USB device found, idVendor=046d, idProduct=0994
usb 4-4: New USB device strings: Mfr=0, Product=0, SerialNumber=2
usb 4-4: SerialNumber: BB56BCEC
Linux video capture interface: v2.00
usbcore: registered new interface driver snd-usb-audio
uvcvideo: Found UVC 1.00 device <unnamed> (046d:0994)
input: UVC Camera (046d:0994) as
/devices/pci0000:00/0000:00:1d.7/usb4/4-4/4-4:1.0/input/input8
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)
uvcvideo: Failed to query (135) UVC control 2 (unit 2) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 7 (unit 2) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 3 (unit 2) : -110 (exp. 2).
usb 4-4: USB disconnect, address 2
ALSA sound/usb/usbaudio.c:351: frame 0 active: -71
ALSA sound/usb/usbaudio.c:696: cannot submit urb (err = -19)
ALSA sound/usb/usbaudio.c:868: cannot submit datapipe for urb 0, error
-19: no device

<repeated many times...>

ALSA sound/usb/usbaudio.c:868: cannot submit datapipe for urb 0, error
-19: no device


Subsequent physical replugging of the camera leads to events like these:


usb 4-4: new high speed USB device using ehci_hcd and address 3
usb 4-4: configuration #1 chosen from 1 choice
uvcvideo: Found UVC 1.00 device <unnamed> (046d:0994)
input: UVC Camera (046d:0994) as
/devices/pci0000:00/0000:00:1d.7/usb4/4-4/4-4:1.0/input/input9
usb 4-4: New USB device found, idVendor=046d, idProduct=0994
usb 4-4: New USB device strings: Mfr=0, Product=0, SerialNumber=2
usb 4-4: SerialNumber: BB56BCEC
uvcvideo: Failed to query (130) UVC control 2 (unit 2) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 7 (unit 2) : -110 (exp. 2).
uvcvideo: Failed to query (135) UVC control 3 (unit 2) : -110 (exp. 2).
ALSA sound/usb/usbmixer.c:803: cannot get current value for control 1
master ch: err = -22


