From bhuism at odee.net  Fri Sep  1 09:29:04 2006
From: bhuism at odee.net (Bas Huisman)
Date: Fri, 01 Sep 2006 09:29:04 +0200
Subject: [Linux-uvc-devel] problem with Orbit Sphere
In-Reply-To: <20060831144029.GA23458@apartia.fr>
References: <20060831144029.GA23458@apartia.fr>
Message-ID: <1157095745.17632.13.camel@localhost>

Same here, with the same camera (Bus 001 Device 021: ID 046d:08c2
Logitech, Inc.),

I get these errors when I 'ioctl(vd->fd, VIDIOC_S_FMT, &vd->fmt)', about
10% of the time,

Sep  1 09:04:01 merlin uvcvideo: Failed to query (135) UVC control 11
(unit 2) : -32.
Sep  1 09:06:01 merlin uvcvideo: Failed to query (131) UVC control 9
(unit 2) : -32.
Sep  1 09:06:01 merlin uvcvideo: Failed to query (135) UVC control 1
(unit 2) : -32.
Sep  1 09:07:01 merlin uvcvideo: Failed to query (131) UVC control 3
(unit 2) : -32.
Sep  1 09:09:01 merlin uvcvideo: Failed to query (131) UVC control 8
(unit 2) : -32.
Sep  1 09:12:02 merlin uvcvideo: Failed to query (130) UVC control 1
(unit 9) : -32.
Sep  1 09:13:01 merlin uvcvideo: Failed to query (130) UVC control 8
(unit 2) : -32.
Sep  1 09:14:01 merlin uvcvideo: Failed to query (131) UVC control 5
(unit 2) : -32.
Sep  1 09:18:02 merlin uvcvideo: Failed to query (130) UVC control 4
(unit 1) : -32.
Sep  1 09:19:01 merlin uvcvideo: Failed to query (132) UVC control 4
(unit 1) : -32.

I also increased UVC_CTRL_TIMEOUT in uvcvideo.c, so i don't get so much
-110 (ETIMEDOUT) errors. 

I can send you my client if you like,

greetings,

Bas


On Thu, 2006-08-31 at 16:40 +0200, Louis-David Mitterrand wrote:

> Hello,
> 
> I'm trying to get my Logitech Orbit (046d:08c2) to work with the latest 
> linux-uvc without success. 
> 
> uvccapture manages to get a snapshot but all other programs fail (ekiga, 
> camorama, camstream, etc.) with that syslog message:
> 
>  kernel: uvcvideo: Failed to query (1) UVC control 1
> 
> Is it a know problem?
> 
> Thanks
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 

-- 
Just jot me down on your to-do list under "put out like a fire"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060901/163f101f/attachment.html>

From carles at pina.cat  Fri Sep  1 21:33:50 2006
From: carles at pina.cat (Carles Pina i Estany)
Date: Fri, 1 Sep 2006 21:33:50 +0200
Subject: [Linux-uvc-devel] Logitech Notebook
Message-ID: <20060901193350.GA24502@pinux.info>


Hello!

I have a Logitech Notebook Pro camera:
Bus 005 Device 011: ID 046d:08c3 Logitech, Inc. 

I am using Kernel 2.6.17.6. I have downloaded linuv-uvc from subversion.

I've inserted the module using insmod ./uvcvideo.ko then appears it in kernel
log:

Sep  1 21:25:31 localhost kernel: uvcvideo: Found UVC 1.00 device
<unnamed> (046d:08c3)
Sep  1 21:25:31 localhost kernel: usbcore: registered new driver
uvcvideo
Sep  1 21:25:31 localhost kernel: USB Video Class driver (v0.1.0)

then I've tried to execute luvcview (luvcview-20060207) and I don't have
correct result:
---------
pinux:~/luvcview-20060207# ./luvcview 
uvcview verion 0.1.4 
Video driver: x11
A window manager is available
video /dev/video0 
X Error of failed request:  BadValue (integer parameter out of range for
operation)
Major opcode of failed request:  141 (XVideo)
Minor opcode of failed request:  19 ()
Value in failed request:  0x76
Serial number of failed request:  25
Current serial number in output stream:  26
pinux:~/luvcview-20060207# 
---------

Using camstream, I can select "USB Video and then" I have black screen
and error message: "device error: The device experienced an error -19
(device is not valid). The windows will be closed". On console:
---------
CVideoDevice::SetPalette picked palette 0 []
CVideoDevice::CreateImagesRGB()
 allocating space for RGB
 CVideoDevice::StartCapture() go!
 CVideoDevice::LoadImage() Error loading image; errorcode=-19

 EnableRGB: -
 CVideoDevice::ResetImagesRGB()
---------

(I am not sure that camstream should work... but in other cameras it
works)

I wonder if I should select or unselect any Kernel option. On
"Multimedia options" I have selected:
---------
  x x<M> Video For Linux                                                  x x  
  x x[*]   Enable Video For Linux API 1 (DEPRECATED)                      x x  
---------
I think that before I selected other API (non-Deprecated :-)  ) without good
results. I have tried again and same result.

Anybody is using this camera with good results? Have I to change something?

If you need more information, ask me.

PD: lsmod | grep -i video:
pinux:~# lsmod|grep -i video
uvcvideo               31620  0 
v4l1_compat            15108  1 uvcvideo
v4l2_common            15744  1 uvcvideo
videodev                8704  1 uvcvideo
usbcore               114944  6 uvcvideo,usbserial,ehci_hcd,usbhid,uhci_hcd
video                  13828  0 


-- 
Carles Pina i Estany		GPG id: 0x8CBDAE64
	http://pinux.info	Manresa - Barcelona


From martin_rubli at logitech.com  Fri Sep  1 22:19:35 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 01 Sep 2006 13:19:35 -0700
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <20060901193350.GA24502@pinux.info>
References: <20060901193350.GA24502@pinux.info>
Message-ID: <op.te7uqxn9sttmjo@maya>

Hi,

On Fri, 01 Sep 2006 12:33:50 -0700, Carles Pina i Estany <carles at pina.cat>  
wrote:

> I have a Logitech Notebook Pro camera:
> Bus 005 Device 011: ID 046d:08c3 Logitech, Inc.
>
> I am using Kernel 2.6.17.6. I have downloaded linuv-uvc from subversion.
>
> I've inserted the module using insmod ./uvcvideo.ko then appears it in  
> kernel
> log:
>
> Sep  1 21:25:31 localhost kernel: uvcvideo: Found UVC 1.00 device
> <unnamed> (046d:08c3)
> Sep  1 21:25:31 localhost kernel: usbcore: registered new driver
> uvcvideo
> Sep  1 21:25:31 localhost kernel: USB Video Class driver (v0.1.0)
>
> then I've tried to execute luvcview (luvcview-20060207) and I don't have
> correct result:
> ---------
> pinux:~/luvcview-20060207# ./luvcview
> uvcview verion 0.1.4
> Video driver: x11
> A window manager is available
> video /dev/video0
> X Error of failed request:  BadValue (integer parameter out of range for
> operation)
> Major opcode of failed request:  141 (XVideo)
> Minor opcode of failed request:  19 ()
> Value in failed request:  0x76
> Serial number of failed request:  25
> Current serial number in output stream:  26

These are errors from your X server, so my guess would be that something's  
wrong with either your X setup or the SDL library (which is used by  
luvcview). That also explains the black screen ...

> I wonder if I should select or unselect any Kernel option. On
> "Multimedia options" I have selected:
> ---------
>   x x<M> Video For  
> Linux                                                  x x
>   x x[*]   Enable Video For Linux API 1  
> (DEPRECATED)                      x x
> ---------
> I think that before I selected other API (non-Deprecated :-)  ) without  
> good
> results. I have tried again and same result.

The UVC driver only needs V4L2 support. Once the uvcvideo module loads  
(which is the case according to your syslog), you're good. So no need to  
change the kernel configuration.

> Anybody is using this camera with good results? Have I to change  
> something?

The camera works okay, yes. You could check your 'xvinfo' output and if  
that looks okay, try to locate the problem in SDL somewhere.

Cheers,
Martin


From carles at pina.cat  Fri Sep  1 23:41:58 2006
From: carles at pina.cat (Carles Pina i Estany)
Date: Fri, 1 Sep 2006 23:41:58 +0200
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <op.te7uqxn9sttmjo@maya>
References: <20060901193350.GA24502@pinux.info> <op.te7uqxn9sttmjo@maya>
Message-ID: <20060901214158.GA704@pinux.info>


Hi,

On Sep/01/2006, Martin Rubli wrote:

> >pinux:~/luvcview-20060207# ./luvcview
> >uvcview verion 0.1.4
> >Video driver: x11
> >A window manager is available
> >video /dev/video0
> >X Error of failed request:  BadValue (integer parameter out of range for
> >operation)
> >Major opcode of failed request:  141 (XVideo)
> >Minor opcode of failed request:  19 ()
> >Value in failed request:  0x76
> >Serial number of failed request:  25
> >Current serial number in output stream:  26
> 
> These are errors from your X server, so my guess would be that something's  
> wrong with either your X setup or the SDL library (which is used by  
> luvcview). That also explains the black screen ...

yes true! (keep reading)

> >Anybody is using this camera with good results? Have I to change  
> >something?
> 
> The camera works okay, yes. You could check your 'xvinfo' output and if  
> that looks okay, try to locate the problem in SDL somewhere.

yes, now is working fine... ekiga problem _i think_ (not complety sure)
that was a mix of:
a) miss-configuration (because i mixed Video4Linux 1 and 2)
b) permissions problems (my user was not in video group)

I have not solved luvcview problem. It seems something related with SDL,
I have not googled it (yet)

Ok, so it was a problem mainly between chair and computer. My blame,
a stupid problem.

Which programs (like camstream) people uses, to get "photos" from V4L2
devices? Any recomendation?

Thanks!

-- 
Carles Pina i Estany		GPG id: 0x8CBDAE64
	http://pinux.info	Manresa - Barcelona


From carles at pina.cat  Sat Sep  2 00:43:16 2006
From: carles at pina.cat (Carles Pina i Estany)
Date: Sat, 2 Sep 2006 00:43:16 +0200
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <op.te7uqxn9sttmjo@maya>
References: <20060901193350.GA24502@pinux.info> <op.te7uqxn9sttmjo@maya>
Message-ID: <20060901224316.GA1802@pinux.info>


Hola,

On Sep/01/2006, Martin Rubli wrote:

> >Major opcode of failed request:  141 (XVideo)
> >Minor opcode of failed request:  19 ()
> >Value in failed request:  0x76
> >Serial number of failed request:  25
> >Current serial number in output stream:  26
> 
> These are errors from your X server, so my guess would be that something's  
> wrong with either your X setup or the SDL library (which is used by  
> luvcview). That also explains the black screen ...

some weeks ago I had a problem using mplayer: default video output was
not very correct. It was a problem with fglrx driver (ATI non-free
driver).
I have used now vesa driver and it was working fine :-)
Ekiga with or without vesa, and luvcview with vesa only.

I know that is not a problem with lucview. But which program do you use
to get snapshots (if you get :-)  ). just for curiosity, to try other
one that is not lucview

-- 
Carles Pina i Estany		GPG id: 0x8CBDAE64
	http://pinux.info	Manresa - Barcelona


From ace at staticwave.ca  Sat Sep  2 02:09:51 2006
From: ace at staticwave.ca (Gabriel A. Devenyi)
Date: Fri, 1 Sep 2006 20:09:51 -0400
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <20060901214158.GA704@pinux.info>
References: <20060901193350.GA24502@pinux.info> <op.te7uqxn9sttmjo@maya>
	<20060901214158.GA704@pinux.info>
Message-ID: <200609012009.51660.ace@staticwave.ca>

On September 01, 2006 17:41, Carles Pina i Estany wrote:
> Which programs (like camstream) people uses, to get "photos" from V4L2
> devices? Any recomendation?

UVCCapture (http://staticwave.ca/source/uvccapture/) can be used to capture 
images (single shots), or at a specified interval, suitable forposting to a 
website periodically. Cheers :)

-- 
Gabriel A. Devenyi
ace at staticwave.ca


From martin_rubli at logitech.com  Sat Sep  2 02:29:19 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 01 Sep 2006 17:29:19 -0700
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <20060901214158.GA704@pinux.info>
References: <20060901193350.GA24502@pinux.info> <op.te7uqxn9sttmjo@maya>
	<20060901214158.GA704@pinux.info>
Message-ID: <op.te76a5d3sttmjo@maya>

Hi,

On Fri, 01 Sep 2006 14:41:58 -0700, Carles Pina i Estany <carles at pina.cat>  
wrote:

> I have not solved luvcview problem. It seems something related with SDL,
> I have not googled it (yet)

If you find the solution, please post it to the list. This would be a good  
candidate for the (upcoming) FAQ ...

> Which programs (like camstream) people uses, to get "photos" from V4L2
> devices? Any recomendation?

I don't take snapshots often but I've used the raw frame capturing  
capabilities (-c and -C arguments) of luvcview in the past. The problem  
with those is, however, that they're indeed raw, so you have to convert  
them to some useful format first. I've written a small tool that converts  
YUY2 to RGB (if anybody wants it, let me know and I'll post it), the RGB  
can then be processed with ImageMagick. MJPEG raw frames are generally a  
little easier to process.

That being said, unless you're doing development, Gabriel's UVCCapture is  
definitely the better choice. :-)

Cheers,
Martin


From carles at pina.cat  Sat Sep  2 09:23:25 2006
From: carles at pina.cat (Carles Pina i Estany)
Date: Sat, 2 Sep 2006 09:23:25 +0200
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <op.te76a5d3sttmjo@maya>
References: <20060901193350.GA24502@pinux.info> <op.te7uqxn9sttmjo@maya>
	<20060901214158.GA704@pinux.info> <op.te76a5d3sttmjo@maya>
Message-ID: <20060902072325.GA28401@pinux.info>


Hello,

On Sep/01/2006, Martin Rubli wrote:

> On Fri, 01 Sep 2006 14:41:58 -0700, Carles Pina i Estany <carles at pina.cat>  
> wrote:
> 
> >I have not solved luvcview problem. It seems something related with SDL,
> >I have not googled it (yet)
> 
> If you find the solution, please post it to the list. This would be a good  
> candidate for the (upcoming) FAQ ...

as I said yesterday night, using vesa driver for x org and not fglrx
driver works fine. I guess that is something related with ati non-free
driver :-(

> That being said, unless you're doing development, Gabriel's UVCCapture is  
> definitely the better choice. :-)

where I can find it?

Thanks!

PD: i tried to use cupid, but I have had some problems compiling it and
I haven't had time to fix...

-- 
Carles Pina i Estany		GPG id: 0x8CBDAE64
	http://pinux.info	Manresa - Barcelona


From carles at pina.cat  Sat Sep  2 17:30:41 2006
From: carles at pina.cat (Carles Pina i Estany)
Date: Sat, 2 Sep 2006 17:30:41 +0200
Subject: [Linux-uvc-devel] Logitech Notebook
In-Reply-To: <200609012009.51660.ace@staticwave.ca>
References: <20060901193350.GA24502@pinux.info> <op.te7uqxn9sttmjo@maya>
	<20060901214158.GA704@pinux.info>
	<200609012009.51660.ace@staticwave.ca>
Message-ID: <20060902153041.GA1095@pinux.info>


Hello,

On Sep/01/2006, Gabriel A. Devenyi wrote:
> On September 01, 2006 17:41, Carles Pina i Estany wrote:
> > Which programs (like camstream) people uses, to get "photos" from V4L2
> > devices? Any recomendation?
> 
> UVCCapture (http://staticwave.ca/source/uvccapture/) can be used to capture 
> images (single shots), or at a specified interval, suitable forposting to a 
> website periodically. Cheers :)

very interesting :-) and congratulations for the work :-) I am sure that
I will use it.

Anyway, is there any alternative with visual controls? Like camstream,
but for V4L 2. Just to play/show the camera (without ekiga or without
uvccapture).

Thank you!

-- 
Carles Pina i Estany		GPG id: 0x8CBDAE64
	http://pinux.info	Manresa - Barcelona


From carles at pina.cat  Sun Sep  3 10:29:30 2006
From: carles at pina.cat (Carles Pina i Estany)
Date: Sun, 3 Sep 2006 10:29:30 +0200
Subject: [Linux-uvc-devel] videocall with wengophone
Message-ID: <20060903082930.GA9673@pinux.info>


Hi,

I am trying to use our module with openwengo softphone. I can use in
ekiga, but anybody is using in OpenWengo?

I have this errors when i try to preview:
---------
(debug) 10:21:53 virtual void WebcamDriver::cleanup(): Cleaning up the
webcam driver
(debug) 10:21:53 virtual webcamerrorcode WebcamDriver::setDevice(const
std::string&): desired device: USB Video Class : video0, actual device:
USB Video Class : video0
(debug) 10:21:53 virtual webcamerrorcode
WebcamDriver::setResolution(unsigned int, unsigned int): try to change
resolution: (width, height) = 320,240
(debug) 10:21:54 virtual webcamerrorcode
WebcamDriver::setPalette(pixosi): This webcam does not support palette
#0
(debug) 10:21:54 virtual webcamerrorcode
WebcamDriver::setPalette(pixosi): Palette conversion will be forced
(debug) 10:21:54 virtual void WebcamDriver::startCapture(): Starting
capture 
----------

And when I try to call:
----------
debug) 10:24:51 void
PhoneCall::setState(EnumPhoneCallState::PhoneCallState): call state
changed callId=1 state=PhoneCallStateTalking
(debug) 10:24:51 virtual void PhoneLine::acceptCall(int): call accepted
callId=1
(debug) 10:24:52 virtual webcamerrorcode
WebcamDriver::setResolution(unsigned int, unsigned int): try to change
resolution: (width, height) = 320,240
(debug) 10:24:52 virtual webcamerrorcode
WebcamDriver::setPalette(pixosi): This webcam does not support palette
#0
(debug) 10:24:52 virtual webcamerrorcode
WebcamDriver::setPalette(pixosi): Palette conversion will be forced
(debug) 10:24:52 virtual void WebcamDriver::startCapture(): Starting
capture
video_bwcontrol: 128kbps
(info) 10:24:52 virtual webcamerrorcode WebcamDriver::setFPS(unsigned
int): WebcamDriver is running. Can't set FPS. 
------------
I wonder if is a module problem or openwengo problem. I ask here because
i can read "This webcam does not support palette #0". I haven't read
openwengo source code, so i don't know what is it trying to do.

Thank you very much,

-- 
Carles Pina i Estany		GPG id: 0x8CBDAE64
	http://pinux.info	Manresa - Barcelona


From aladdin at altern.org  Mon Sep  4 21:52:25 2006
From: aladdin at altern.org (aladdin at altern.org)
Date: Mon, 4 Sep 2006 21:52:25 +0200 (CEST)
Subject: [Linux-uvc-devel] Unknown symbol v4l2_ioctl_names ?
Message-ID: <47896.90.2.138.8.1157399545.squirrel@altern.org>

Hi everyone,

I try to install uvc modules on kernel 2.6.15-26-k7 #1 SMP PREEMPT Thu Aug
3 03:40:32 UTC 2006 i686 GNU/Linux using gcc 4.0.

Compilation is ok but when I try to modprobe, I have this message :

uvcvideo: Unknown symbol v4l2_ioctl_names

modinfo uvcvideo

filename:       /lib/modules/2.6.15-26-k7/usb/media/uvcvideo.ko
author:         Laurent Pinchart <laurent.pinchart at skynet.be>
description:    USB Video Class driver
license:        GPL
vermagic:       2.6.15-26-k7 SMP preempt K7 gcc-4.0
depends:        usbcore,videodev,v4l2-common,v4l1-compat
alias:          usb:v046Dp08C1d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C2d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C3d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C5d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C6d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C7d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v*p*d*dc*dsc*dp*ic0Eisc01ip00*
srcversion:     94C8222F703B3D4C291E4FC
parm:           trace:uint


I have  usbcore,videodev,v4l2-common,v4l1-compat already loaded when I try
to load uvcvideo. Any tips ?

Thank you very much, best regards.



From panemade at gmail.com  Thu Sep  7 14:07:36 2006
From: panemade at gmail.com (=?UTF-8?Q?Parag_N(=E0=A4=AA=E0=A4=B0=E0=A4=BE=E0=A5=9A)?=)
Date: Thu, 7 Sep 2006 17:37:36 +0530
Subject: [Linux-uvc-devel] cropcap ioctl is returning wrong info
Message-ID: <f4586a2e0609070507y7c0130c0h3a1df37b5e8fc0a3@mail.gmail.com>

Hi,
   here is code i used to print width and height from Logitech
Quickcam Pro 5000.

      memset(&ccap, 0, sizeof(ccap));
         ccap.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;

        res = ioctl(fd,  VIDIOC_CROPCAP, &ccap);
        if (res<0) {
                perror("VIDIOC_CROPCAP");
        }
        else
        {
         printf("       Width=%d\n",ccap.bounds.width);
         printf("       Height=%d\n",ccap.bounds.height);
        }

and this code returned me
 Width=160
 Height=120

why it failed to return 640 x 480 ? I have not used v4l2_enumfrmfmt.h .
Regards,
Parag.


From martin_rubli at logitech.com  Thu Sep  7 18:12:05 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Thu, 07 Sep 2006 09:12:05 -0700
Subject: [Linux-uvc-devel] cropcap ioctl is returning wrong info
In-Reply-To: <f4586a2e0609070507y7c0130c0h3a1df37b5e8fc0a3@mail.gmail.com>
References: <f4586a2e0609070507y7c0130c0h3a1df37b5e8fc0a3@mail.gmail.com>
Message-ID: <op.tfinafv8sttmjo@maya>

Hi,

The UVC driver returns the size of the currently set format. So if you do  
a S_FMT with 640x480 first, CROPCAP should indeed return 640x480.

The problem with CROPCAP is that for the most part it doesn't apply to  
digital devices. For a while, the call wasn't supported at all but it  
seems that it is mandatory, so we just tried to return _something_ that  
makes sense. If you have any suggestions as to the interpretation of the  
V4L2 spec, I'd be happy to hear your view.

What are you trying to do in this particular case?

Cheers,
Martin


On Thu, 07 Sep 2006 05:07:36 -0700, Parag N(????) <panemade at gmail.com>  
wrote:

> Hi,
>    here is code i used to print width and height from Logitech
> Quickcam Pro 5000.
>
>       memset(&ccap, 0, sizeof(ccap));
>          ccap.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;
>
>         res = ioctl(fd,  VIDIOC_CROPCAP, &ccap);
>         if (res<0) {
>                 perror("VIDIOC_CROPCAP");
>         }
>         else
>         {
>          printf("       Width=%d\n",ccap.bounds.width);
>          printf("       Height=%d\n",ccap.bounds.height);
>         }
>
> and this code returned me
>  Width=160
>  Height=120
>
> why it failed to return 640 x 480 ? I have not used v4l2_enumfrmfmt.h .
> Regards,
> Parag.
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From jonasbizi at t-online.hu  Wed Sep  6 22:58:28 2006
From: jonasbizi at t-online.hu (Hasznos =?iso-8859-1?q?P=E1l?=)
Date: Wed, 6 Sep 2006 22:58:28 +0200
Subject: [Linux-uvc-devel] Quickcam Go 046d:092f
Message-ID: <200609062258.28780.jonasbizi@t-online.hu>

Hi

I have a Logitech webcam: Quickcam Go

Device ID: 046d:092f

I can't wake it up under Linux (Suse10.0)

Do you have any idea which driver will OK? 


From panemade at gmail.com  Fri Sep  8 06:20:45 2006
From: panemade at gmail.com (=?UTF-8?Q?Parag_N(=E0=A4=AA=E0=A4=B0=E0=A4=BE=E0=A5=9A)?=)
Date: Fri, 8 Sep 2006 09:50:45 +0530
Subject: [Linux-uvc-devel] cropcap ioctl is returning wrong info
In-Reply-To: <op.tfinafv8sttmjo@maya>
References: <f4586a2e0609070507y7c0130c0h3a1df37b5e8fc0a3@mail.gmail.com>
	<op.tfinafv8sttmjo@maya>
Message-ID: <f4586a2e0609072120y2cae931dvd2c3c56a6e26c765@mail.gmail.com>

Hi,
On 9/7/06, Martin Rubli <martin_rubli at logitech.com> wrote:
> Hi,
>
> The UVC driver returns the size of the currently set format. So if you do
> a S_FMT with 640x480 first, CROPCAP should indeed return 640x480.
>
> The problem with CROPCAP is that for the most part it doesn't apply to
> digital devices. For a while, the call wasn't supported at all but it
> seems that it is mandatory, so we just tried to return _something_ that
> makes sense. If you have any suggestions as to the interpretation of the
> V4L2 spec, I'd be happy to hear your view.
Currently i think very less information is given by uvcvideo driver.
When i applied one by one ioctl's to get what my webcam can supports
and what not in terms of frame formats, various width and heights.
I found if i use  v4l2_enumfrmfmt.h  then i am getting various sizes.
Is not it possible ti include this header file in uvcviodeo.c and let
ioctl given in that header file give the various sizes supported by
webcam hardware. So is it possible to make that VIDIOC_ENUM_FMT be
included in uvcviudeo.c

OR / ALSO
in my example when i see this output
Device /dev/video0 opened: USB Video Class device.

Enumerating frame formats:

{ pixelformat = 'MJPG', description = 'MJPEG' }
  { discrete: width = 160, height = 120 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 176, height = 144 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 320, height = 240 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 352, height = 288 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 432, height = 240 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 480, height = 360 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 512, height = 288 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
  { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 640, height = 360 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 640, height = 480 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
{ pixelformat = 'YUYV', description = 'Uncompressed' }
  { discrete: width = 640, height = 360 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }
  { discrete: width = 640, height = 480 }
    { discrete: 1/30 }
    { discrete: 1/25 }
    { discrete: 1/20 }
    { discrete: 1/15 }
    { discrete: 1/10 }
    { discrete: 1/5 }

It clearly showed that as MJPG is default frame thru ioclt,s i am
getting therefore i am getting the first value in above output as
width=160 and height=120.
But same output showed max width=640 and height=480. So can it be
possible to modify ioctl code to return either max values for default
frame when applied VIDIOC_CROPCAP ??

Or can it be possible in uvcvideo to have max and min width and height
structure members and let them return max and min values. I know it
was case for V4l but not for V4l2.

All above are my thought for uvcvideo. This all i am thinking for if
anyone want to write a video viewer app then how come he will get that
info to show streaming video in various supported sizes( Me is also
trying to write video viewer but first to understand all v4l2 API
well)
>
> What are you trying to do in this particular case?
As said above trying to lean V4l2 APIs and checking ioctl's info.
>
> Cheers,
> Martin


From ripnetuk at gmail.com  Fri Sep  8 11:15:28 2006
From: ripnetuk at gmail.com (George Styles)
Date: Fri, 8 Sep 2006 10:15:28 +0100
Subject: [Linux-uvc-devel] UVC
Message-ID: <9398f0eb0609080215u57638442p3d9c268702893feb@mail.gmail.com>

Hi,

Thanks to everyone involved in this driver - its made my cam mostly
work under Linux :)

Im using a Logitech (Orbit I think - devid 046d:08c2) webcam. May I
ask 3 questions please?

1. Im using uvccapture - if I use it too many times to access the
camera, it starts failing to take shots. Its as if the camera has
'hung'.
I get
Unable to set format: 5.
 Init v4L2 failed !! exit fatal

This is AFTER ive had it working in the same session.
Re-plugging the camera fixes it (until next time).
(Is there a way of telling Linux to reset the USB connections - i
would like to be able to fix it remotely via ssh without having to
re-boot the box)

I saw a patch on the mailing list to 'reset the usb' if there is a
problem, but it didnt apply cleanly to the current cvs source. 1 of 5
hunks failed. I could manually work out what needs patching, but I
thought i would try this mailing list to see if its likely to help.

The camera works OK if I run uvccapture in -t 1 mode (ie, continious
shots). It has the cool facility of calling another script after
capture, and waiting for it to finish, so I can use the camera, but I
would rather it worked properly :)

2. The camera is motorised - it does pan and tilt. Ive tried using
setpwc to control it, but it fails.
My guess is that we are waiting for someone to implement the correct
IOCTL calls in the driver. Would I be right?

3. Can anyone reccomend any good motion detection software that works
with this driver? i believe it only supports v4l2, and i cannnot find
any good software that uses that API. I am after something that will
watch the camera, and take a series of stills or a movie when it
detects movement.

Thanks again

George


From l.schimmer at cgv.tugraz.at  Fri Sep  8 12:02:09 2006
From: l.schimmer at cgv.tugraz.at (Lars Schimmer)
Date: Fri, 08 Sep 2006 12:02:09 +0200
Subject: [Linux-uvc-devel] Still no luck with Logitech QuickCam Notebook
 Pro
In-Reply-To: <op.tesrn0fasttmjo@maya>
References: <44EDAAD9.9000001@cgv.tugraz.at> <op.tesrn0fasttmjo@maya>
Message-ID: <45013FA1.6000409@cgv.tugraz.at>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Martin Rubli wrote:
> On Thu, 24 Aug 2006 06:34:17 -0700, Lars Schimmer  
> <l.schimmer at cgv.tugraz.at> wrote:
> 
>> I was gone for some weeks in holiday.
>> But I see there is no new version for luvcview or the kernel driver in
>> debian.
>> The picture is still black :-/
> 
> It's definitely not luvcview's fault because it's known to work with the  
> Notebook Pro in general.
> 
> As far as the driver goes, I can't help you if you're using the Debian  
> driver because I'm simply not up-to-date as far as the package goes. I  
> know it was broken at least for a while. So you should use the driver from  
> the Berlios SVN repository and post uvcvideo's syslog output if you still  
> have problems.

Ok, I grabbed uvcvideo source from svn today, built it, insmod it and
tried uvccapture 0.4 on it.
usbview tells me about a found cam, so far so good, module is loaded.
But:
 /tmp/uvccapture-0.4/uvccapture -v
Using videodevice: /dev/video0
Saving images to: snap.jpg
Image size: 320x240
Taking snapshot every 0 seconds
Taking images using mmap
ERROR opening V4L interface
: No such device
 *WTF* ?!?

> Cheers,
> Martin


MfG,
Lars Schimmer
- --
- -------------------------------------------------------------
TU Graz, Institut f?r ComputerGraphik & WissensVisualisierung
Tel: +43 316 873-5405       E-Mail: l.schimmer at cgv.tugraz.at
Fax: +43 316 873-5402       PGP-Key-ID: 0x4A9B1723
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFFAT+hmWhuE0qbFyMRAimCAJ4269tZrfTaf/7VhPlVsLHlv7D5gwCfexR7
Jg4xX/AioYiEWHYWK+vfS1w=
=xUIX
-----END PGP SIGNATURE-----


From meschen at gmail.com  Mon Sep 11 21:19:38 2006
From: meschen at gmail.com (Martin Eschen)
Date: Mon, 11 Sep 2006 21:19:38 +0200
Subject: [Linux-uvc-devel] troubles with qc fusion
Message-ID: <af0222da0609111219j182d4368l2161dd2989bbb1e1@mail.gmail.com>

Hello,

I've already tried to get help on the following on the forum, but
until now no replies. Maybe that someone here can help me.

I am trying to get a quickcam fusion running on a fedora FC5 box.
$ uname-a
Linux myhost 2.6.17-1.2174_FC5 #1 Tue Aug 8 15:30:55 EDT 2006 i686
i686 i386 GNU/Linux
uvc-linux downloaded on 26-08-2006.

make and make install went without errors.

When manually modprobing uvcvideo I get:
# modprobe uvcvideo
FATAL: Error inserting uvcvideo
(/lib/modules/2.6.17-1.2174_FC5/usb/media/uvcvideo.ko): Unknown symbol
in module, or unknown parameter (see dmesg)

Added to my dmesg output is:

v4l2_common: no version for "struct_module" found: kernel tainted.
Linux video capture interface: v2.00
uvcvideo: disagrees about version of symbol video_devdata
uvcvideo: Unknown symbol video_devdata
uvcvideo: disagrees about version of symbol video_unregister_device
uvcvideo: Unknown symbol video_unregister_device
uvcvideo: disagrees about version of symbol video_device_alloc
uvcvideo: Unknown symbol video_device_alloc
uvcvideo: disagrees about version of symbol video_register_device
uvcvideo: Unknown symbol video_register_device
uvcvideo: disagrees about version of symbol video_device_release
uvcvideo: Unknown symbol video_device_release


When I insert the usb plug of my camera I get the following output in dmesg:

usb 5-2: new high speed USB device using ehci_hcd and address 2
usb 5-2: configuration #1 chosen from 1 choice
uvcvideo: disagrees about version of symbol video_devdata
uvcvideo: Unknown symbol video_devdata
uvcvideo: disagrees about version of symbol video_unregister_device
uvcvideo: Unknown symbol video_unregister_device
uvcvideo: disagrees about version of symbol video_device_alloc
uvcvideo: Unknown symbol video_device_alloc
uvcvideo: disagrees about version of symbol video_register_device
uvcvideo: Unknown symbol video_register_device
uvcvideo: disagrees about version of symbol video_device_release
uvcvideo: Unknown symbol video_device_release
2:3:1: cannot set freq 0 to ep 0x86
2:3:2: cannot set freq 0 to ep 0x86
usbcore: registered new driver snd-usb-audio


What is going wrong here? Suffice it to say that help is much appreciated.

Martin


From laurent.pinchart at skynet.be  Mon Sep 11 23:04:44 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 11 Sep 2006 23:04:44 +0200
Subject: [Linux-uvc-devel] Logitech Fusion
In-Reply-To: <44ECC027.9050009@gmx.de>
References: <44ECC027.9050009@gmx.de>
Message-ID: <200609112304.45849.laurent.pinchart@skynet.be>

Hi Robert,

> I`m did some surfing to find a nice webcam for using with Linux and
> Windows.
>
> I stumbled upon Logitech Fusion oder Notebook Pro.
>
> Amazon lists two different Fusions:
>
> http://www.amazon.de/gp/product/B000H2NG7U/028-2160492-3726126?v=glance&n=1
>1052861&s=gateway&v=glance
>
> with Modellnummer: 961403-3310
>
> and
>
> http://www.amazon.de/gp/product/B000AOIP7G/028-2160492-3726126?v=glance&n=1
>1052861&s=gateway&v=glance
>
> with Modellnummer: 961403-0914
>
> Does anybody know the differences ? Which one (or both) is working with
> the uvc-driver ?

The second one is working with the UVC driver. I don't know much about the 
first one, as there is no picture and I can't read German.

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Sep 11 23:14:47 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 11 Sep 2006 23:14:47 +0200
Subject: [Linux-uvc-devel] Fuji FinePix s5500
In-Reply-To: <20060826013422.c8eec8ee.fred@magiabyte.com>
References: <20060826013422.c8eec8ee.fred@magiabyte.com>
Message-ID: <200609112314.47325.laurent.pinchart@skynet.be>

Hi Fred,

> Is there a way to make it work with this camera?

The driver will not work out of the box with that camera, as it uses bulk 
transfers (as opposed to isochronous transfers). It would probably be easy to 
implement support for bulk transfers, but I have no bulk UVC device to test 
the code.

You have several options :

- Wait until someone implements bulk transfers support
- Try to do it yourself
- Send me a Fuji camera :-)

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Sep 11 23:29:38 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 11 Sep 2006 23:29:38 +0200
Subject: [Linux-uvc-devel] Image captured is not sharp enough!!
In-Reply-To: <ecfaf2a70608300409i37715fe1ndfdde079db88eba2@mail.gmail.com>
References: <ecfaf2a70608300409i37715fe1ndfdde079db88eba2@mail.gmail.com>
Message-ID: <200609112329.38606.laurent.pinchart@skynet.be>

Hi,

> I capture the image using uvccapture from Logitech Pro5000 camera. But
> quality of image is poor even at default resolution of 320x240. It
> definitely degrades further when I try the frame of size 640x480.
>
> I have attached the image file in case you want to assess the quality
> yourself. Please let me know if there is a way to make it sharp while
> capturing. Postprocessing is definitely a solution.

I find the image quality quite acceptable. Have you compared it to what you 
get in windows ? The image you posted has MJPEG artifacts. Have you tried YUV 
images (at 960x720 or higher) ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Sep 11 23:55:08 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 11 Sep 2006 23:55:08 +0200
Subject: [Linux-uvc-devel] Unknown symbol v4l2_ioctl_names ?
In-Reply-To: <47896.90.2.138.8.1157399545.squirrel@altern.org>
References: <47896.90.2.138.8.1157399545.squirrel@altern.org>
Message-ID: <200609112355.08554.laurent.pinchart@skynet.be>

Hi,

> Hi everyone,
>
> I try to install uvc modules on kernel 2.6.15-26-k7 #1 SMP PREEMPT Thu Aug
> 3 03:40:32 UTC 2006 i686 GNU/Linux using gcc 4.0.
>
> Compilation is ok but when I try to modprobe, I have this message :
>
> uvcvideo: Unknown symbol v4l2_ioctl_names
>
> modinfo uvcvideo
>
> filename:       /lib/modules/2.6.15-26-k7/usb/media/uvcvideo.ko
> author:         Laurent Pinchart <laurent.pinchart at skynet.be>
> description:    USB Video Class driver
> license:        GPL
> vermagic:       2.6.15-26-k7 SMP preempt K7 gcc-4.0
> depends:        usbcore,videodev,v4l2-common,v4l1-compat
> alias:          usb:v046Dp08C1d*dc*dsc*dp*icFFisc01ip00*
> alias:          usb:v046Dp08C2d*dc*dsc*dp*icFFisc01ip00*
> alias:          usb:v046Dp08C3d*dc*dsc*dp*icFFisc01ip00*
> alias:          usb:v046Dp08C5d*dc*dsc*dp*icFFisc01ip00*
> alias:          usb:v046Dp08C6d*dc*dsc*dp*icFFisc01ip00*
> alias:          usb:v046Dp08C7d*dc*dsc*dp*icFFisc01ip00*
> alias:          usb:v*p*d*dc*dsc*dp*ic0Eisc01ip00*
> srcversion:     94C8222F703B3D4C291E4FC
> parm:           trace:uint
>
>
> I have  usbcore,videodev,v4l2-common,v4l1-compat already loaded when I try
> to load uvcvideo. Any tips ?

You're using a kernel patched by your distribution. Some changes from 2.6.16 
made their way into your kernel, and one of them was to remove the symbol 
v4l2_ioctl_names. For 2.6.16 kernels the UVC driver handles that change 
gracefully, but not for 2.6.15.

I advice you to upgrade to 2.6.16 or newer, or patch the driver by changing 
the

#if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,16)

a few lines before v4l2_ioctl_names to

#if 0

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Sep 11 23:59:00 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 11 Sep 2006 23:59:00 +0200
Subject: [Linux-uvc-devel] Quickcam Go 046d:092f
In-Reply-To: <200609062258.28780.jonasbizi@t-online.hu>
References: <200609062258.28780.jonasbizi@t-online.hu>
Message-ID: <200609112359.00825.laurent.pinchart@skynet.be>

Hi,

> I have a Logitech webcam: Quickcam Go
>
> Device ID: 046d:092f
>
> I can't wake it up under Linux (Suse10.0)
>
> Do you have any idea which driver will OK?

Try the spca5xx and pwc drivers, one of them might work.

Laurent Pinchart


From martin_rubli at logitech.com  Tue Sep 12 00:36:16 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Mon, 11 Sep 2006 15:36:16 -0700
Subject: [Linux-uvc-devel] Logitech Fusion
In-Reply-To: <44ECC027.9050009@gmx.de>
References: <44ECC027.9050009@gmx.de>
Message-ID: <op.tfqjqqtssttmjo@maya>

Hi,

Sorry, I only noticed your post now that Laurent replied to it.

Basically, the one ending in 3310 is the 2006 model whereas the -0914 is  
the current one. I wouldn't bet on being able to order the 2006 one quite  
yet, though, judging from the looks of the Amazon page.

Anyway, both cameras support UVC and therefore work with the Linux UVC  
driver.

Cheers,
Martin


On Wed, 23 Aug 2006 13:52:55 -0700, Robert M. Albrecht <romal at gmx.de>  
wrote:

> Hi,
>
> I`m did some surfing to find a nice webcam for using with Linux and  
> Windows.
>
> I stumbled upon Logitech Fusion oder Notebook Pro.
>
> Amazon lists two different Fusions:
>
> http://www.amazon.de/gp/product/B000H2NG7U/028-2160492-3726126?v=glance&n=11052861&s=gateway&v=glance
>
> with Modellnummer: 961403-3310
>
> and
>
> http://www.amazon.de/gp/product/B000AOIP7G/028-2160492-3726126?v=glance&n=11052861&s=gateway&v=glance
>
> with Modellnummer: 961403-0914
>
> Does anybody know the differences ? Which one (or both) is working with
> the uvc-driver ?
>
> cu romal
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From martin_rubli at logitech.com  Tue Sep 12 00:39:16 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Mon, 11 Sep 2006 15:39:16 -0700
Subject: [Linux-uvc-devel] Quickcam Go 046d:092f
In-Reply-To: <200609112359.00825.laurent.pinchart@skynet.be>
References: <200609062258.28780.jonasbizi@t-online.hu>
	<200609112359.00825.laurent.pinchart@skynet.be>
Message-ID: <op.tfqjvqz8sttmjo@maya>

On Mon, 11 Sep 2006 14:59:00 -0700, Laurent Pinchart  
<laurent.pinchart at skynet.be> wrote:

> Hi,
>
>> I have a Logitech webcam: Quickcam Go
>>
>> Device ID: 046d:092f
>>
>> I can't wake it up under Linux (Suse10.0)
>>
>> Do you have any idea which driver will OK?
>
> Try the spca5xx and pwc drivers, one of them might work.

It should work with the spca5xx driver, although I haven't tested it  
myself.

If you get it to work, please drop Michel Xhaard an e-mail so he can add  
it to the list at:
http://mxhaard.free.fr/spca5xx.html

Cheers,
Martin


From laurent.pinchart at skynet.be  Tue Sep 12 01:08:59 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 Sep 2006 01:08:59 +0200
Subject: [Linux-uvc-devel] cropcap ioctl is returning wrong info
In-Reply-To: <f4586a2e0609072120y2cae931dvd2c3c56a6e26c765@mail.gmail.com>
References: <f4586a2e0609070507y7c0130c0h3a1df37b5e8fc0a3@mail.gmail.com>
	<op.tfinafv8sttmjo@maya>
	<f4586a2e0609072120y2cae931dvd2c3c56a6e26c765@mail.gmail.com>
Message-ID: <200609120109.00156.laurent.pinchart@skynet.be>

Hi,

> > The UVC driver returns the size of the currently set format. So if you do
> > a S_FMT with 640x480 first, CROPCAP should indeed return 640x480.
> >
> > The problem with CROPCAP is that for the most part it doesn't apply to
> > digital devices. For a while, the call wasn't supported at all but it
> > seems that it is mandatory, so we just tried to return _something_ that
> > makes sense. If you have any suggestions as to the interpretation of the
> > V4L2 spec, I'd be happy to hear your view.
>
> Currently i think very less information is given by uvcvideo driver.
> When i applied one by one ioctl's to get what my webcam can supports
> and what not in terms of frame formats, various width and heights.

Could you elaborate ? I don't understand what you mean.

> I found if i use  v4l2_enumfrmfmt.h  then i am getting various sizes.
> Is not it possible ti include this header file in uvcviodeo.c and let
> ioctl given in that header file give the various sizes supported by
> webcam hardware. So is it possible to make that VIDIOC_ENUM_FMT be
> included in uvcviudeo.c

You don't need to include v4l2_enumfrmfmt.h in uvcvideo.c. v4l2_enumfrmfmt.h 
defines a few new ioctls. Those ioctls will be submitted for inclusion to the 
V4L2 maintainer, so the v4l2_enumfrmfmt.h file is only needed until the 
ioctls will be included in the standard. In other words, if you want to use 
the new ioctls, just include the file v4l2_enumfrmfmt.h in your application 
until those ioctls are added to linux/videodev2.h.

> OR / ALSO
> in my example when i see this output
> Device /dev/video0 opened: USB Video Class device.
>
> Enumerating frame formats:
>
> { pixelformat = 'MJPG', description = 'MJPEG' }
>   { discrete: width = 160, height = 120 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 176, height = 144 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 320, height = 240 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 352, height = 288 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 432, height = 240 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 480, height = 360 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 512, height = 288 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>   { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 640, height = 360 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 640, height = 480 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
> { pixelformat = 'YUYV', description = 'Uncompressed' }
>   { discrete: width = 640, height = 360 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>   { discrete: width = 640, height = 480 }
>     { discrete: 1/30 }
>     { discrete: 1/25 }
>     { discrete: 1/20 }
>     { discrete: 1/15 }
>     { discrete: 1/10 }
>     { discrete: 1/5 }
>
> It clearly showed that as MJPG is default frame thru ioclt,s i am
> getting therefore i am getting the first value in above output as
> width=160 and height=120.
> But same output showed max width=640 and height=480. So can it be
> possible to modify ioctl code to return either max values for default
> frame when applied VIDIOC_CROPCAP ??

I understand what you mean. VIDIOC_CROPCAP should be changed to return the 
sensor size. But that leaves a question: how do we find out the sensor size ? 
It might not be the maximum resolution, as the camera could upscale the 
image. The biggest width/height could also not be available at the same time. 
Imagine a webcam with a 1024x768 sensor which could do 1024x512 and 800x756 
only ? (I know it sounds weird, but manufacturers sometimes come up with 
weirder things).

> Or can it be possible in uvcvideo to have max and min width and height
> structure members and let them return max and min values. I know it
> was case for V4l but not for V4l2.
>
> All above are my thought for uvcvideo. This all i am thinking for if
> anyone want to write a video viewer app then how come he will get that
> info to show streaming video in various supported sizes( Me is also
> trying to write video viewer but first to understand all v4l2 API
> well)

You should use the frame rate enumeration ioctls if you need information 
regarding all the supported formats and sizes. The UVC driver is currently 
the only driver supporting those ioctls, but other drivers will hopefully be 
migrated soon when the ioctls will be submitted for inclusion in the v4l2 
spec.

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Sep 12 01:44:07 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 Sep 2006 01:44:07 +0200
Subject: [Linux-uvc-devel] UVC
In-Reply-To: <9398f0eb0609080215u57638442p3d9c268702893feb@mail.gmail.com>
References: <9398f0eb0609080215u57638442p3d9c268702893feb@mail.gmail.com>
Message-ID: <200609120144.08331.laurent.pinchart@skynet.be>

> Thanks to everyone involved in this driver - its made my cam mostly
> work under Linux :)

In the name of all contributors, thank you :-)

> Im using a Logitech (Orbit I think - devid 046d:08c2) webcam. May I
> ask 3 questions please?
>
> 1. Im using uvccapture - if I use it too many times to access the
> camera, it starts failing to take shots. Its as if the camera has
> 'hung'.
> I get
> Unable to set format: 5.
>  Init v4L2 failed !! exit fatal
>
> This is AFTER ive had it working in the same session.
> Re-plugging the camera fixes it (until next time).
> (Is there a way of telling Linux to reset the USB connections - i
> would like to be able to fix it remotely via ssh without having to
> re-boot the box)

That's a known problem, for which there's no perfect solution today. 
Developers at Logitech are investigating it, but they have zillions of other 
problems to take care of as well.

> I saw a patch on the mailing list to 'reset the usb' if there is a
> problem, but it didnt apply cleanly to the current cvs source. 1 of 5
> hunks failed. I could manually work out what needs patching, but I
> thought i would try this mailing list to see if its likely to help.

The patch will definitely help. I hope to find a better fix with Logitech's 
help. In the meantime, you can apply it.

> The camera works OK if I run uvccapture in -t 1 mode (ie, continious
> shots). It has the cool facility of calling another script after
> capture, and waiting for it to finish, so I can use the camera, but I
> would rather it worked properly :)
>
> 2. The camera is motorised - it does pan and tilt. Ive tried using
> setpwc to control it, but it fails.
> My guess is that we are waiting for someone to implement the correct
> IOCTL calls in the driver. Would I be right?

Not exactly. The UVC driver already supports pan/tilt through a special 
control, but that will change soon with a new generic IOCTL. I'm working on 
that, stay tuned :-)

> 3. Can anyone reccomend any good motion detection software that works
> with this driver? i believe it only supports v4l2, and i cannnot find
> any good software that uses that API. I am after something that will
> watch the camera, and take a series of stills or a movie when it
> detects movement.

I heard motion is good, not sure if it supports v4l2 yet.

Laurent Pinchart


From panemade at gmail.com  Tue Sep 12 05:39:35 2006
From: panemade at gmail.com (=?UTF-8?Q?Parag_N(=E0=A4=AA=E0=A4=B0=E0=A4=BE=E0=A5=9A)?=)
Date: Tue, 12 Sep 2006 09:09:35 +0530
Subject: [Linux-uvc-devel] cropcap ioctl is returning wrong info
In-Reply-To: <200609120109.00156.laurent.pinchart@skynet.be>
References: <f4586a2e0609070507y7c0130c0h3a1df37b5e8fc0a3@mail.gmail.com>
	<op.tfinafv8sttmjo@maya>
	<f4586a2e0609072120y2cae931dvd2c3c56a6e26c765@mail.gmail.com>
	<200609120109.00156.laurent.pinchart@skynet.be>
Message-ID: <f4586a2e0609112039k1b0c4c00v71f2d8dd10c50d67@mail.gmail.com>

Hi,
On 9/12/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> Hi,
>
> > > The UVC driver returns the size of the currently set format. So if you do
> > > a S_FMT with 640x480 first, CROPCAP should indeed return 640x480.
> > >
> > > The problem with CROPCAP is that for the most part it doesn't apply to
> > > digital devices. For a while, the call wasn't supported at all but it
> > > seems that it is mandatory, so we just tried to return _something_ that
> > > makes sense. If you have any suggestions as to the interpretation of the
> > > V4L2 spec, I'd be happy to hear your view.
> >
> > Currently i think very less information is given by uvcvideo driver.
> > When i applied one by one ioctl's to get what my webcam can supports
> > and what not in terms of frame formats, various width and heights.
>
> Could you elaborate ? I don't understand what you mean.

  I mean i have written a v4l2-tool GUI application that will take
video device and apply all available ioctls under v4l2 API and get all
information of attached webcam and display it.
There when i apply CROPCAP ioctl i got 160x120 width and height which
must be 640x480( I am talking about Logitech Quickcam Pro 5000
webcam).

>
> > I found if i use  v4l2_enumfrmfmt.h  then i am getting various sizes.
> > Is not it possible ti include this header file in uvcviodeo.c and let
> > ioctl given in that header file give the various sizes supported by
> > webcam hardware. So is it possible to make that VIDIOC_ENUM_FMT be
> > included in uvcviudeo.c
>
> You don't need to include v4l2_enumfrmfmt.h in uvcvideo.c. v4l2_enumfrmfmt.h
> defines a few new ioctls. Those ioctls will be submitted for inclusion to the
> V4L2 maintainer, so the v4l2_enumfrmfmt.h file is only needed until the
> ioctls will be included in the standard. In other words, if you want to use
> the new ioctls, just include the file v4l2_enumfrmfmt.h in your application
> until those ioctls are added to linux/videodev2.h.

  That's very nice. Those ioctls must be included then in V4L2 APIs.

[snip]
> > It clearly showed that as MJPG is default frame thru ioclt,s i am
> > getting therefore i am getting the first value in above output as
> > width=160 and height=120.
> > But same output showed max width=640 and height=480. So can it be
> > possible to modify ioctl code to return either max values for default
> > frame when applied VIDIOC_CROPCAP ??
>
> I understand what you mean. VIDIOC_CROPCAP should be changed to return the
> sensor size. But that leaves a question: how do we find out the sensor size ?
> It might not be the maximum resolution, as the camera could upscale the
> image. The biggest width/height could also not be available at the same time.
> Imagine a webcam with a 1024x768 sensor which could do 1024x512 and 800x756
> only ? (I know it sounds weird, but manufacturers sometimes come up with
> weirder things).
>

So all problems should end in those ioctls which are waiting for their
inclusion in V4L2 API.

> > Or can it be possible in uvcvideo to have max and min width and height
> > structure members and let them return max and min values. I know it
> > was case for V4l but not for V4l2.
> >
> > All above are my thought for uvcvideo. This all i am thinking for if
> > anyone want to write a video viewer app then how come he will get that
> > info to show streaming video in various supported sizes( Me is also
> > trying to write video viewer but first to understand all v4l2 API
> > well)
>
> You should use the frame rate enumeration ioctls if you need information
> regarding all the supported formats and sizes. The UVC driver is currently
> the only driver supporting those ioctls, but other drivers will hopefully be
> migrated soon when the ioctls will be submitted for inclusion in the v4l2
> spec.

Thanks for explanation.
Regards,
Parag.


From panemade at gmail.com  Tue Sep 12 06:05:04 2006
From: panemade at gmail.com (=?UTF-8?Q?Parag_N(=E0=A4=AA=E0=A4=B0=E0=A4=BE=E0=A5=9A)?=)
Date: Tue, 12 Sep 2006 09:35:04 +0530
Subject: [Linux-uvc-devel] troubles with qc fusion
In-Reply-To: <af0222da0609111219j182d4368l2161dd2989bbb1e1@mail.gmail.com>
References: <af0222da0609111219j182d4368l2161dd2989bbb1e1@mail.gmail.com>
Message-ID: <f4586a2e0609112105i6bd51a09m9c57b0ca3463dd32@mail.gmail.com>

Hi,
On 9/12/06, Martin Eschen <meschen at gmail.com> wrote:
> Hello,
>
> I've already tried to get help on the following on the forum, but
> until now no replies. Maybe that someone here can help me.
>
> I am trying to get a quickcam fusion running on a fedora FC5 box.
> $ uname-a
> Linux myhost 2.6.17-1.2174_FC5 #1 Tue Aug 8 15:30:55 EDT 2006 i686
> i686 i386 GNU/Linux
> uvc-linux downloaded on 26-08-2006.
>
> make and make install went without errors.
>
> When manually modprobing uvcvideo I get:
> # modprobe uvcvideo
> FATAL: Error inserting uvcvideo
> (/lib/modules/2.6.17-1.2174_FC5/usb/media/uvcvideo.ko): Unknown symbol
> in module, or unknown parameter (see dmesg)
>
> Added to my dmesg output is:
>
> v4l2_common: no version for "struct_module" found: kernel tainted.
> Linux video capture interface: v2.00
> uvcvideo: disagrees about version of symbol video_devdata
> uvcvideo: Unknown symbol video_devdata
> uvcvideo: disagrees about version of symbol video_unregister_device
> uvcvideo: Unknown symbol video_unregister_device
> uvcvideo: disagrees about version of symbol video_device_alloc
> uvcvideo: Unknown symbol video_device_alloc
> uvcvideo: disagrees about version of symbol video_register_device
> uvcvideo: Unknown symbol video_register_device
> uvcvideo: disagrees about version of symbol video_device_release
> uvcvideo: Unknown symbol video_device_release
>
>
> When I insert the usb plug of my camera I get the following output in dmesg:
>
> usb 5-2: new high speed USB device using ehci_hcd and address 2
> usb 5-2: configuration #1 chosen from 1 choice
> uvcvideo: disagrees about version of symbol video_devdata
> uvcvideo: Unknown symbol video_devdata
> uvcvideo: disagrees about version of symbol video_unregister_device
> uvcvideo: Unknown symbol video_unregister_device
> uvcvideo: disagrees about version of symbol video_device_alloc
> uvcvideo: Unknown symbol video_device_alloc
> uvcvideo: disagrees about version of symbol video_register_device
> uvcvideo: Unknown symbol video_register_device
> uvcvideo: disagrees about version of symbol video_device_release
> uvcvideo: Unknown symbol video_device_release
> 2:3:1: cannot set freq 0 to ep 0x86
> 2:3:2: cannot set freq 0 to ep 0x86
> usbcore: registered new driver snd-usb-audio
>
>
> What is going wrong here? Suffice it to say that help is much appreciated.

  To use uvcvideo kernel module you need following modules to be
present in kernel before.
In my case see
lsmod | grep uvc
uvcvideo               32132   0
v4l1_compat          12164  1 uvcvideo
v4l2_common        14208  1 uvcvideo
videodev               9216    1 uvcvideo

So check your lsmod | grep uvc output first
Regards,
Parag.


From m.blizinski at wit.edu.pl  Tue Sep 12 09:49:49 2006
From: m.blizinski at wit.edu.pl (Maciej =?UTF-8?Q?Blizi=C5=84ski?=)
Date: Tue, 12 Sep 2006 09:49:49 +0200
Subject: [Linux-uvc-devel] UVC
In-Reply-To: <9398f0eb0609080215u57638442p3d9c268702893feb@mail.gmail.com>
References: <9398f0eb0609080215u57638442p3d9c268702893feb@mail.gmail.com>
Message-ID: <1158047389.5176.4.camel@localhost.localnet>

On Fri, 2006-09-08 at 10:15 +0100, George Styles wrote:
> I saw a patch on the mailing list to 'reset the usb' if there is a
> problem, but it didnt apply cleanly to the current cvs source. 1 of 5
> hunks failed.

CVS? I thought we had SVN out there. Nevermind.

I have applied the patch about 7 revisions ago and it works fine. The
new revisions also applied cleanly, co I happen to have current sources
and cleanly applied patch. Do you want my diff?

-- 
Maciej Blizi?ski <m.blizinski at wit.edu.pl>
http://automatthias.wordpress.com



From marcel at datkan.net  Tue Sep 12 10:02:47 2006
From: marcel at datkan.net (Marcel van Beurden)
Date: Tue, 12 Sep 2006 10:02:47 +0200
Subject: [Linux-uvc-devel] UVC
In-Reply-To: <200609120144.08331.laurent.pinchart@skynet.be>
References: <9398f0eb0609080215u57638442p3d9c268702893feb@mail.gmail.com>
	<200609120144.08331.laurent.pinchart@skynet.be>
Message-ID: <450669A7.1050003@datkan.net>

Hi,

Laurent Pinchart wrote:
>> 3. Can anyone reccomend any good motion detection software that works
>> with this driver? i believe it only supports v4l2, and i cannnot find
>> any good software that uses that API. I am after something that will
>> watch the camera, and take a series of stills or a movie when it
>> detects movement.
> 
> I heard motion is good, not sure if it supports v4l2 yet.

I asked this question on the motion-user mailinglist and I got this response 
from Kenneth Lavrsen:

> The status is that noone is working on it that I know of.
> 
> There are some patches. They make some cameras work and break all the 
> rest so they cannot be integrated into Motion yet.
> 
> V4L2 is on the top of my wishlist and I will be very happy to receive 
> contributions that adds V4L2 support to Motion but it must be in a 
> backwards compatible way so all my good old cameras do not stop working.

Regards,
Marcel


From avilella at gmail.com  Tue Sep 12 16:02:03 2006
From: avilella at gmail.com (Albert Vilella)
Date: Tue, 12 Sep 2006 15:02:03 +0100
Subject: [Linux-uvc-devel] Ricoh 5U870 webcam on Sony Vaio SZ laptops
Message-ID: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>

Hi,

Some of the new Vaio laptops (like the SZ series) come
with one of these cameras:

http://www.ricoh.com/LSI/product_pcif/usb/5u870_v001/
http://www.ricoh.com/LSI/product_pcif/usb/5u870_v002/

Apparently, the "U" stands for UVC, which I guess is
good news (compliant with Video Class 1.1 in USB Device
Class).

However, I tried to make the Linux UVC driver to work,
but it won't recognize the device.

I've only seen Logitech webcams in the list of
supported devices. Are these Ricoh devices supposed to
work with the Linux UVC driver? Is there anything in
particular I should try?

Thanks in advance,

    Albert.


From laurent.pinchart at skynet.be  Tue Sep 12 16:20:12 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 Sep 2006 16:20:12 +0200
Subject: [Linux-uvc-devel] Ricoh 5U870 webcam on Sony Vaio SZ laptops
In-Reply-To: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>
References: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>
Message-ID: <200609121620.12545.laurent.pinchart@skynet.be>

Hi Albert,
> Some of the new Vaio laptops (like the SZ series) come
> with one of these cameras:
>
> http://www.ricoh.com/LSI/product_pcif/usb/5u870_v001/
> http://www.ricoh.com/LSI/product_pcif/usb/5u870_v002/
>
> Apparently, the "U" stands for UVC, which I guess is
> good news (compliant with Video Class 1.1 in USB Device
> Class).

Yes, that's very good news indeed.

> However, I tried to make the Linux UVC driver to work,
> but it won't recognize the device.
>
> I've only seen Logitech webcams in the list of
> supported devices. Are these Ricoh devices supposed to
> work with the Linux UVC driver? Is there anything in
> particular I should try?

They probably are supposed to work with the Linux UVC driver. Of course, as I 
don't own any of those devices, I haven't tested them yet.

Could you send me the complete output of lsusb -v, using lsusb version 0.72 or 
newer (available as part of usbutils at 
http://sourceforge.net/project/showfiles.php?group_id=3581) ?

Laurent Pinchart


From avilella at gmail.com  Tue Sep 12 16:27:04 2006
From: avilella at gmail.com (Albert Vilella)
Date: Tue, 12 Sep 2006 15:27:04 +0100
Subject: [Linux-uvc-devel] Ricoh 5U870 webcam on Sony Vaio SZ laptops
In-Reply-To: <200609121620.12545.laurent.pinchart@skynet.be>
References: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>
	<200609121620.12545.laurent.pinchart@skynet.be>
Message-ID: <358f4d650609120727m523c58acs39adf7ecde08368a@mail.gmail.com>

Find attached,

Albert.

On 9/12/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> Hi Albert,
> > Some of the new Vaio laptops (like the SZ series) come
> > with one of these cameras:
> >
> > http://www.ricoh.com/LSI/product_pcif/usb/5u870_v001/
> > http://www.ricoh.com/LSI/product_pcif/usb/5u870_v002/
> >
> > Apparently, the "U" stands for UVC, which I guess is
> > good news (compliant with Video Class 1.1 in USB Device
> > Class).
>
> Yes, that's very good news indeed.
>
> > However, I tried to make the Linux UVC driver to work,
> > but it won't recognize the device.
> >
> > I've only seen Logitech webcams in the list of
> > supported devices. Are these Ricoh devices supposed to
> > work with the Linux UVC driver? Is there anything in
> > particular I should try?
>
> They probably are supposed to work with the Linux UVC driver. Of course, as I
> don't own any of those devices, I haven't tested them yet.
>
> Could you send me the complete output of lsusb -v, using lsusb version 0.72 or
> newer (available as part of usbutils at
> http://sourceforge.net/project/showfiles.php?group_id=3581) ?
>
> Laurent Pinchart
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.v.log
Type: text/x-log
Size: 25295 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060912/9f92c659/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.log
Type: text/x-log
Size: 406 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060912/9f92c659/attachment-0001.bin>

From laurent.pinchart at skynet.be  Tue Sep 12 16:43:15 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 Sep 2006 16:43:15 +0200
Subject: [Linux-uvc-devel] Ricoh 5U870 webcam on Sony Vaio SZ laptops
In-Reply-To: <358f4d650609120727m523c58acs39adf7ecde08368a@mail.gmail.com>
References: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>
	<200609121620.12545.laurent.pinchart@skynet.be>
	<358f4d650609120727m523c58acs39adf7ecde08368a@mail.gmail.com>
Message-ID: <200609121643.15392.laurent.pinchart@skynet.be>

Hi Albert,

thanks for the descriptors. Unfortunately, it seems that your device is not 
UVC compliant. The USB descriptors report an imaging class device (still 
image capture). Are you sure that the device is one of those you mentionned 
in your previous e-mail ? Could you try and see if gPhoto2 recognizes your 
camera ?

Laurent Pinchart


From avilella at gmail.com  Tue Sep 12 16:50:11 2006
From: avilella at gmail.com (Albert Vilella)
Date: Tue, 12 Sep 2006 15:50:11 +0100
Subject: [Linux-uvc-devel] Ricoh 5U870 webcam on Sony Vaio SZ laptops
In-Reply-To: <358f4d650609120749n2ebbd672oe6f20076e2139af8@mail.gmail.com>
References: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>
	<200609121620.12545.laurent.pinchart@skynet.be>
	<358f4d650609120727m523c58acs39adf7ecde08368a@mail.gmail.com>
	<200609121643.15392.laurent.pinchart@skynet.be>
	<358f4d650609120749n2ebbd672oe6f20076e2139af8@mail.gmail.com>
Message-ID: <358f4d650609120750q7cefa3dducfb0b0b42f6f5cd7@mail.gmail.com>

> Hi Albert,
>
> thanks for the descriptors. Unfortunately, it seems that your device is not
> UVC compliant. The USB descriptors report an imaging class device (still
> image capture). Are you sure that the device is one of those you mentionned
> in your previous e-mail ? Could you try and see if gPhoto2 recognizes your
> camera ?

The MS Windows drivers have the 5U870 id scattered in this file (attached):

./windows_drivers/Drivers/Camera/VGP-VCC2/Mvc25U870.inf

 and the device is advertised as UVC compliant in Ricoh's website. Not
sure it it is version 1 or 2, though.

I installed gphoto2 and did this:

avilella at magneto:~/sonyvaio/camera$ gphoto2 --auto-detect
Model                          Port
----------------------------------------------------------
USB PTP Class Camera           usb:
USB PTP Class Camera           usb:002,004

What would that mean?

Any ideas?

    Albert.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Mvc25U870.inf
Type: application/octet-stream
Size: 43646 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060912/672f9aa1/attachment.obj>

From laurent.pinchart at skynet.be  Tue Sep 12 17:14:16 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 12 Sep 2006 17:14:16 +0200
Subject: [Linux-uvc-devel] Ricoh 5U870 webcam on Sony Vaio SZ laptops
In-Reply-To: <358f4d650609120749n2ebbd672oe6f20076e2139af8@mail.gmail.com>
References: <358f4d650609120702v5829bd96w834799027de9ab95@mail.gmail.com>
	<200609121643.15392.laurent.pinchart@skynet.be>
	<358f4d650609120749n2ebbd672oe6f20076e2139af8@mail.gmail.com>
Message-ID: <200609121714.16470.laurent.pinchart@skynet.be>

> > thanks for the descriptors. Unfortunately, it seems that your device is
> > not UVC compliant. The USB descriptors report an imaging class device
> > (still image capture). Are you sure that the device is one of those you
> > mentionned in your previous e-mail ? Could you try and see if gPhoto2
> > recognizes your camera ?
>
> The MS Windows drivers have the 5U870 id scattered in this file (attached):
>
> ./windows_drivers/Drivers/Camera/VGP-VCC2/Mvc25U870.inf
>
>  and the device is advertised as UVC compliant in Ricoh's website. Not
> sure it it is version 1 or 2, though.

The RY5U870-VU is advertised as UVC compliant, but the RY5U870-VW is not. I'm 
afraid it seems your device is not UVC compliant.

> I installed gphoto2 and did this:
>
> avilella at magneto:~/sonyvaio/camera$ gphoto2 --auto-detect
> Model                          Port
> ----------------------------------------------------------
> USB PTP Class Camera           usb:
> USB PTP Class Camera           usb:002,004
>
> What would that mean?

That gPhoto was able to detect your device as a USB digital camera. This 
probably means that Ricoh, in their infinite wisdom, decided that a still 
image capture interface was the way to go for a webcam device, and wrote a 
Windows driver to emulate a video device from something that looks like a 
digital camera to the computer.

Try to play with gPhoto2 and see if you can take a picture. There are probably 
GUI applications based on libgphoto2, you might find that easier.

Laurent Pinchart


From meschen at gmail.com  Tue Sep 12 22:42:18 2006
From: meschen at gmail.com (Martin Eschen)
Date: Tue, 12 Sep 2006 22:42:18 +0200
Subject: [Linux-uvc-devel] troubles with qc fusion
In-Reply-To: <f4586a2e0609112105i6bd51a09m9c57b0ca3463dd32@mail.gmail.com>
References: <af0222da0609111219j182d4368l2161dd2989bbb1e1@mail.gmail.com>
	<f4586a2e0609112105i6bd51a09m9c57b0ca3463dd32@mail.gmail.com>
Message-ID: <af0222da0609121342ve180fbel1f6d351fd188ccf4@mail.gmail.com>

Hi Parag and others,

Thanks for your answer.
>   To use uvcvideo kernel module you need following modules to be
> present in kernel before.
> In my case see
> lsmod | grep uvc
> uvcvideo               32132   0
> v4l1_compat          12164  1 uvcvideo
> v4l2_common        14208  1 uvcvideo
> videodev               9216    1 uvcvideo

I manually insert them and they are there.

# modprobe videodev
# lsmod  less videodev
videodev               20992  0
v4l1_compat            11524  1 videodev
v4l2_common            20608  1 videodev

When I then insert the uvcvideo kernel mod I still get the same errors however.

# modprobe uvcvideo
FATAL: Error inserting uvcvideo
(/lib/modules/2.6.17-1.2174_FC5/usb/media/uvcvideo.ko): Unknown symbol
in module, or unknown parameter (see dmesg)

Dmesg output:
uvcvideo: disagrees about version of symbol video_devdata
uvcvideo: Unknown symbol video_devdata
uvcvideo: disagrees about version of symbol video_unregister_device
uvcvideo: Unknown symbol video_unregister_device
uvcvideo: disagrees about version of symbol video_device_alloc
uvcvideo: Unknown symbol video_device_alloc
uvcvideo: disagrees about version of symbol video_register_device
uvcvideo: Unknown symbol video_register_device
uvcvideo: disagrees about version of symbol video_device_release
uvcvideo: Unknown symbol video_device_release

I am not a programmer (just an enthousiast who would like to be able
to debug and help more) but could this be an incompatibility between
the Fedora v4l{12} or videodev kernel module and uvcvideo? I did a FC5
installation about a month ago and as far as i know I only installed
'safe' packages. After getting the above errors I just deinstalled the
ATrpm v4l packages and compiled v4l-dvb from source. I still get the
same errors however...


Also a thanks and cheers to the developers for all their work. My
brother advised me to get a qc fusion because of the good image and
video quality. On my laptop the uvcvideo driver is working great with
uvcview and ekiga. Just hope I can get this one solved for my desktop
box as well...

Regards,

Martin


From aidan at wires3.net  Fri Sep 15 12:41:18 2006
From: aidan at wires3.net (Aidan Walton)
Date: Fri, 15 Sep 2006 11:41:18 +0100
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
Message-ID: <1158316878.5478.14.camel@localhost>

Hello Everyone,

I've been trying to get my Logitech fusion cam up and running on debian.
However having followed all the threads I can see in the archives here I
still do not have success. Here is my setup

Kernel 2.6.15-1-686
linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised
source without the isight patch, ... apparently)

when I insert the camera i get:

usb 4-3: new high speed USB device using ehci_hcd and address 6
uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
6:3:1: cannot set freq 0 to ep 0x86
6:3:2: cannot set freq 0 to ep 0x86
6:3:3: cannot get freq at ep 0x86

This seems normal. If I then run webcam I get this:

reading config file: /root/.webcamrc
video4linux webcam v1.5 - (c) 1998-2002 Gerd Knorr
grabber config:
  size 1024x576 [16 bit YUV 4:2:2 (packed, YUYV)]
  input (null), norm (null), jpeg quality 75
  rotate=0, top=0, left=0, bottom=240, right=320
v4l2: oops: select timeout
capturing image failed

The following is the syslog output from the run of webcam:

Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
(VIDIOC_QUERYCAP)
Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
(VIDIOC_QUERYCAP)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
(VIDIOC_ENUMINPUT)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
(VIDIOC_ENUMINPUT)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
(VIDIOC_ENUMSTD)
Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
(VIDIOC_ENUM_FMT)
Sep 15 11:35:26 localhost last message repeated 2 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
(VIDIOC_G_PARM)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
(VIDIOC_QUERYCTRL)
Sep 15 11:35:26 localhost last message repeated 63 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
(VIDIOC_QUERYMENU)
Sep 15 11:35:26 localhost last message repeated 2 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
(VIDIOC_S_FMT)
Sep 15 11:35:26 localhost last message repeated 3 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
(VIDIOC_REQBUFS)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
(VIDIOC_QUERYBUF)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
(VIDIOC_QBUF)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
(VIDIOC_STREAMON)
Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
(VIDIOC_STREAMOFF)



Also I have tried luvcview and this is the output:

uvcview verion 0.1.6
Video driver: x11
A window manager is available
video /dev/video0

Stop asked


and the syslog output:

Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
(VIDIOC_QUERYCAP)
Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
(VIDIOC_QUERYCAP)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
(VIDIOC_ENUMINPUT)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
(VIDIOC_ENUMINPUT)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
(VIDIOC_ENUMSTD)
Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
(VIDIOC_ENUM_FMT)
Sep 15 11:35:26 localhost last message repeated 2 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
(VIDIOC_G_PARM)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
(VIDIOC_QUERYCTRL)
Sep 15 11:35:26 localhost last message repeated 63 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
(VIDIOC_QUERYMENU)
Sep 15 11:35:26 localhost last message repeated 2 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
(VIDIOC_S_FMT)
Sep 15 11:35:26 localhost last message repeated 3 times
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
(VIDIOC_REQBUFS)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
(VIDIOC_QUERYBUF)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
(VIDIOC_QBUF)
Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
(VIDIOC_STREAMON)
Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
(VIDIOC_STREAMOFF)
Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0x80685600
(VIDIOC_QUERYCAP)
Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0cc5605
(VIDIOC_S_FMT)
Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0145608
(VIDIOC_REQBUFS)
Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0445609
(VIDIOC_QUERYBUF)
Sep 15 11:36:27 localhost last message repeated 3 times
Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc044560f
(VIDIOC_QBUF)
Sep 15 11:36:27 localhost last message repeated 3 times
Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0x40045612
(VIDIOC_STREAMON)
Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0xc0445611
(VIDIOC_DQBUF)
Sep 15 11:36:52 localhost kernel: uvcvideo: ioctl 0xc0445611
(VIDIOC_DQBUF)


Basically I just get a black screen and the process hangs only killable
with a -9. 



Any ideas? Thanks for any help.
Aidan



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/73f15fff/attachment.html>

From marcel at datkan.net  Fri Sep 15 13:06:12 2006
From: marcel at datkan.net (Marcel van Beurden)
Date: Fri, 15 Sep 2006 13:06:12 +0200
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158316878.5478.14.camel@localhost>
References: <1158316878.5478.14.camel@localhost>
Message-ID: <450A8924.2040906@datkan.net>

Hi,

Aidan Walton wrote:
> Kernel 2.6.15-1-686
> linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised 
> source without the isight patch, ... apparently)

I think the official debian package is still broken. My problems with the QC 
Fusian and Debian got solved when I used Florent Rougon's version of the 
package. He posted instructions on this list a while ago which I will quote here:

> BTW: I made my own Debian package which builds and runs on sarge
>      (provided you're running a recent enough kernel) inspired from
>      lirc-modules-source. It contains the Linux UVC SVN code, with no
>      added patch. If people are interested, it's called linux-uvc-source
>      and can be downloaded here:
> 
>        deb http://people.via.ecp.fr/~flo/debian sarge main
>        deb-src http://people.via.ecp.fr/~flo/debian sarge main

Try that and see if it works. If this one works, I think there should be a new 
offical debian package which works.

Regards,
Marcel



From l.schimmer at cgv.tugraz.at  Fri Sep 15 15:50:48 2006
From: l.schimmer at cgv.tugraz.at (Lars Schimmer)
Date: Fri, 15 Sep 2006 15:50:48 +0200
Subject: [Linux-uvc-devel] QuickCam Pro success on amd64 debian
Message-ID: <450AAFB8.6080806@cgv.tugraz.at>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi!

I just want to tell you, I?ve got success to let the QuickCam Pro
Notebook get a picture under debian amd64 :-)
I used the uvc modules source from:
deb http://people.via.ecp.fr/~flo/debian sarge main
and lucuvcview.

MfG,
Lars Schimmer
- --
- -------------------------------------------------------------
TU Graz, Institut f?r ComputerGraphik & WissensVisualisierung
Tel: +43 316 873-5405       E-Mail: l.schimmer at cgv.tugraz.at
Fax: +43 316 873-5402       PGP-Key-ID: 0x4A9B1723
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFFCq+4mWhuE0qbFyMRAkOxAJ9xKxbLWw9wKbOK+gD4Egnem61CNgCeN00b
NiEfch8ck+44e60r43UPU60=
=fODb
-----END PGP SIGNATURE-----


From thomaand at zhwin.ch  Fri Sep 15 15:57:58 2006
From: thomaand at zhwin.ch (Thomann Andreas (thomaand))
Date: Fri, 15 Sep 2006 15:57:58 +0200
Subject: [Linux-uvc-devel] UVC-gadget driver
Message-ID: <382379B34D08914EB0BA03DE9DA40560078048@lobster.zhwin.ch>

Dear all,

I need an USB Video Class gadget driver. Upon making inquiries about if there is something existing
I think I've to write it by myself. Is this information correct?

At the moment I'm using a NET2280 PCI Card later I'll port the drivers to a TI Davinci-Chip.
I studied several usb gadget drivers. Even so I studied the USB Video Class Specification
and I had a look at your UVC driver.

Now I've got some questions,
a) What are the minimum settings in my driver that the uvc-driver (host) recognize my card as a UVC-Device?
b) Is it possible or does it make sense to use your uvc driver as a base-driver? Or do you think the 
gadegt driver is totally different?
c) Which points out of the specification does my driver has to cover at least to realize an elementary
video stream?

Thank you for your help,

best regards
andy


From evgeny at indent.ru  Fri Sep 15 15:58:49 2006
From: evgeny at indent.ru (Evgeny)
Date: Fri, 15 Sep 2006 17:58:49 +0400
Subject: [Linux-uvc-devel] QuickCam Pro success on amd64 debian
In-Reply-To: <450AAFB8.6080806@cgv.tugraz.at>
References: <450AAFB8.6080806@cgv.tugraz.at>
Message-ID: <20060915175849.34515110@localhost>

Congratulation!

Did you use usb reset patch? Can you get not a single picture but
streaming? Is the camera driver stable?

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Hi!
> 
> I just want to tell you, I?ve got success to let the QuickCam Pro
> Notebook get a picture under debian amd64 :-)
> I used the uvc modules source from:
> deb http://people.via.ecp.fr/~flo/debian sarge main
> and lucuvcview.
> 
> MfG,
> Lars Schimmer
> - --
> - -------------------------------------------------------------
> TU Graz, Institut f?r ComputerGraphik & WissensVisualisierung
> Tel: +43 316 873-5405       E-Mail: l.schimmer at cgv.tugraz.at
> Fax: +43 316 873-5402       PGP-Key-ID: 0x4A9B1723
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.1 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
> 
> iD8DBQFFCq+4mWhuE0qbFyMRAkOxAJ9xKxbLWw9wKbOK+gD4Egnem61CNgCeN00b
> NiEfch8ck+44e60r43UPU60=
> =fODb
> -----END PGP SIGNATURE-----
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel


From l.schimmer at cgv.tugraz.at  Fri Sep 15 16:05:53 2006
From: l.schimmer at cgv.tugraz.at (Lars Schimmer)
Date: Fri, 15 Sep 2006 16:05:53 +0200
Subject: [Linux-uvc-devel] QuickCam Pro success on amd64 debian
In-Reply-To: <20060915175849.34515110@localhost>
References: <450AAFB8.6080806@cgv.tugraz.at>
	<20060915175849.34515110@localhost>
Message-ID: <450AB341.3090903@cgv.tugraz.at>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Evgeny wrote:
> Congratulation!
> 
> Did you use usb reset patch? Can you get not a single picture but
> streaming? Is the camera driver stable?

I didn?t use the usb reset patch.
I get a stream about 15fps in small window (320x240) or round about.
I can?t tell if it?s stable, just tested it for 5 min to prove it is
working.

MfG,
Lars Schimmer
- --
- -------------------------------------------------------------
TU Graz, Institut f?r ComputerGraphik & WissensVisualisierung
Tel: +43 316 873-5405       E-Mail: l.schimmer at cgv.tugraz.at
Fax: +43 316 873-5402       PGP-Key-ID: 0x4A9B1723
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFFCrNBmWhuE0qbFyMRAswmAJwK484Hpsj9H7wHAeg9AhucNzuYzgCfVZi9
x28UE8GJb7fp8ENVYq2H6TE=
=qAir
-----END PGP SIGNATURE-----


From genstef at gentoo.org  Fri Sep 15 15:54:22 2006
From: genstef at gentoo.org (Stefan Schweizer)
Date: Fri, 15 Sep 2006 15:54:22 +0200
Subject: [Linux-uvc-devel] linux uvc and kernel 2.6.18
Message-ID: <eeebcn$f8p$1@sea.gmane.org>

Hi,

I am trying out linux-uvc with version 2.6.18-rc6-git3 and it reports
unknown symbols for video_get_drvdata and video_set_drvdata. Based on
another patch for this problem [1] I have fixed this for uvc. The fix works
for me but please bear in mind that I have little kernel programming
experience and thus it could be wrong.

Best regards,
Stefan

[1] http://www.linuxtv.org/downloads/video4linux/patches/2.6.14
/v4l_813_replaced_obsolete_video_get_drvdata_and_video_set_drvdata.patch
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc-2.6.18.diff
Type: text/x-diff
Size: 3244 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/4e138fd2/attachment.diff>

From aidan at wires3.net  Fri Sep 15 16:38:15 2006
From: aidan at wires3.net (Aidan Walton)
Date: Fri, 15 Sep 2006 15:38:15 +0100
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <450A8924.2040906@datkan.net>
References: <1158316878.5478.14.camel@localhost> <450A8924.2040906@datkan.net>
Message-ID: <1158331095.5478.38.camel@localhost>

Thanks Marcel,

I haven't tried using these packages below, but looking at his website I
don't see a .deb package with a binary, only a source .deb package.

Even if I check out the source direct and compile this I get an error
telling me:
FATAL: Error inserting uvcvideo
(/lib/modules/2.6.15-1-686/usb/media/uvcvideo.ko): Invalid module
format.

Why won't the SVN code compile against my kernel?
Aidan

On Fri, 2006-09-15 at 13:06 +0200, Marcel van Beurden wrote:

> Hi,
> 
> Aidan Walton wrote:
> > Kernel 2.6.15-1-686
> > linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised 
> > source without the isight patch, ... apparently)
> 
> I think the official debian package is still broken. My problems with the QC 
> Fusian and Debian got solved when I used Florent Rougon's version of the 
> package. He posted instructions on this list a while ago which I will quote here:
> 
> > BTW: I made my own Debian package which builds and runs on sarge
> >      (provided you're running a recent enough kernel) inspired from
> >      lirc-modules-source. It contains the Linux UVC SVN code, with no
> >      added patch. If people are interested, it's called linux-uvc-source
> >      and can be downloaded here:
> > 
> >        deb http://people.via.ecp.fr/~flo/debian sarge main
> >        deb-src http://people.via.ecp.fr/~flo/debian sarge main
> 
> Try that and see if it works. If this one works, I think there should be a new 
> offical debian package which works.
> 
> Regards,
> Marcel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/26756f51/attachment.html>

From aidan at wires3.net  Fri Sep 15 17:00:05 2006
From: aidan at wires3.net (Aidan Walton)
Date: Fri, 15 Sep 2006 16:00:05 +0100
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <450A8924.2040906@datkan.net>
References: <1158316878.5478.14.camel@localhost> <450A8924.2040906@datkan.net>
Message-ID: <1158332405.5340.2.camel@localhost>

Ok so I tried the package that Florent put together and before I even
managed to up-pack the tar ball,  update manager reported an available
update, it replaced Florent's package with the official debian source
package.

Hmmm, no further it seems.
Aidan

On Fri, 2006-09-15 at 13:06 +0200, Marcel van Beurden wrote:

> Hi,
> 
> Aidan Walton wrote:
> > Kernel 2.6.15-1-686
> > linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised 
> > source without the isight patch, ... apparently)
> 
> I think the official debian package is still broken. My problems with the QC 
> Fusian and Debian got solved when I used Florent Rougon's version of the 
> package. He posted instructions on this list a while ago which I will quote here:
> 
> > BTW: I made my own Debian package which builds and runs on sarge
> >      (provided you're running a recent enough kernel) inspired from
> >      lirc-modules-source. It contains the Linux UVC SVN code, with no
> >      added patch. If people are interested, it's called linux-uvc-source
> >      and can be downloaded here:
> > 
> >        deb http://people.via.ecp.fr/~flo/debian sarge main
> >        deb-src http://people.via.ecp.fr/~flo/debian sarge main
> 
> Try that and see if it works. If this one works, I think there should be a new 
> offical debian package which works.
> 
> Regards,
> Marcel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/940390b9/attachment.html>

From martin_rubli at logitech.com  Fri Sep 15 18:20:35 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 15 Sep 2006 09:20:35 -0700
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158316878.5478.14.camel@localhost>
References: <1158316878.5478.14.camel@localhost>
Message-ID: <op.tfxg0ln6sttmjo@maya>

Hi,

Last time I checked 'webcam' didn't properly work with the UVC driver  
because it tries to use some ioctls that don't make sense for digital  
cameras and are therefore not supported by the driver.

Does your camera work with luvcview?  
(http://mxhaard.free.fr/spca50x/Investigation/uvc/)

Cheers,
Martin


On Fri, 15 Sep 2006 03:41:18 -0700, Aidan Walton <aidan at wires3.net> wrote:

> Hello Everyone,
>
> I've been trying to get my Logitech fusion cam up and running on debian.
> However having followed all the threads I can see in the archives here I
> still do not have success. Here is my setup
>
> Kernel 2.6.15-1-686
> linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised
> source without the isight patch, ... apparently)
>
> when I insert the camera i get:
>
> usb 4-3: new high speed USB device using ehci_hcd and address 6
> uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> 6:3:1: cannot set freq 0 to ep 0x86
> 6:3:2: cannot set freq 0 to ep 0x86
> 6:3:3: cannot get freq at ep 0x86
>
> This seems normal. If I then run webcam I get this:
>
> reading config file: /root/.webcamrc
> video4linux webcam v1.5 - (c) 1998-2002 Gerd Knorr
> grabber config:
>   size 1024x576 [16 bit YUV 4:2:2 (packed, YUYV)]
>   input (null), norm (null), jpeg quality 75
>   rotate=0, top=0, left=0, bottom=240, right=320
> v4l2: oops: select timeout
> capturing image failed
>
> The following is the syslog output from the run of webcam:
>
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
> (VIDIOC_QUERYCAP)
> Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
> (VIDIOC_QUERYCAP)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> (VIDIOC_ENUMINPUT)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> (VIDIOC_ENUMINPUT)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
> (VIDIOC_ENUMSTD)
> Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
> (VIDIOC_ENUM_FMT)
> Sep 15 11:35:26 localhost last message repeated 2 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
> (VIDIOC_G_PARM)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
> (VIDIOC_QUERYCTRL)
> Sep 15 11:35:26 localhost last message repeated 63 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
> (VIDIOC_QUERYMENU)
> Sep 15 11:35:26 localhost last message repeated 2 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> (VIDIOC_S_FMT)
> Sep 15 11:35:26 localhost last message repeated 3 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
> (VIDIOC_REQBUFS)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
> (VIDIOC_QUERYBUF)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
> (VIDIOC_QBUF)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
> (VIDIOC_STREAMON)
> Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
> (VIDIOC_STREAMOFF)
>
>
>
> Also I have tried luvcview and this is the output:
>
> uvcview verion 0.1.6
> Video driver: x11
> A window manager is available
> video /dev/video0
>
> Stop asked
>
>
> and the syslog output:
>
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
> (VIDIOC_QUERYCAP)
> Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
> (VIDIOC_QUERYCAP)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> (VIDIOC_ENUMINPUT)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> (VIDIOC_ENUMINPUT)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
> (VIDIOC_ENUMSTD)
> Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
> (VIDIOC_ENUM_FMT)
> Sep 15 11:35:26 localhost last message repeated 2 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
> (VIDIOC_G_PARM)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
> (VIDIOC_QUERYCTRL)
> Sep 15 11:35:26 localhost last message repeated 63 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
> (VIDIOC_QUERYMENU)
> Sep 15 11:35:26 localhost last message repeated 2 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> (VIDIOC_S_FMT)
> Sep 15 11:35:26 localhost last message repeated 3 times
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
> (VIDIOC_REQBUFS)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
> (VIDIOC_QUERYBUF)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
> (VIDIOC_QBUF)
> Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
> (VIDIOC_STREAMON)
> Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
> (VIDIOC_STREAMOFF)
> Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0x80685600
> (VIDIOC_QUERYCAP)
> Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> (VIDIOC_S_FMT)
> Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0145608
> (VIDIOC_REQBUFS)
> Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0445609
> (VIDIOC_QUERYBUF)
> Sep 15 11:36:27 localhost last message repeated 3 times
> Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc044560f
> (VIDIOC_QBUF)
> Sep 15 11:36:27 localhost last message repeated 3 times
> Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0x40045612
> (VIDIOC_STREAMON)
> Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0xc0445611
> (VIDIOC_DQBUF)
> Sep 15 11:36:52 localhost kernel: uvcvideo: ioctl 0xc0445611
> (VIDIOC_DQBUF)
>
>
> Basically I just get a black screen and the process hangs only killable
> with a -9.
>
>
>
> Any ideas? Thanks for any help.
> Aidan
>
>
>




From martin_rubli at logitech.com  Fri Sep 15 18:22:42 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 15 Sep 2006 09:22:42 -0700
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158331095.5478.38.camel@localhost>
References: <1158316878.5478.14.camel@localhost> <450A8924.2040906@datkan.net>
	<1158331095.5478.38.camel@localhost>
Message-ID: <op.tfxg34w9sttmjo@maya>

On Fri, 15 Sep 2006 07:38:15 -0700, Aidan Walton <aidan at wires3.net> wrote:

> Thanks Marcel,
>
> I haven't tried using these packages below, but looking at his website I
> don't see a .deb package with a binary, only a source .deb package.
>
> Even if I check out the source direct and compile this I get an error
> telling me:
> FATAL: Error inserting uvcvideo
> (/lib/modules/2.6.15-1-686/usb/media/uvcvideo.ko): Invalid module
> format.
>
> Why won't the SVN code compile against my kernel?
> Aidan

Any chance you're running a kernel patched by your distribution? It should  
work with the one from kernel.org.

Cheers,
Martin


From f.rougon at free.fr  Fri Sep 15 18:25:50 2006
From: f.rougon at free.fr (Florent Rougon)
Date: Fri, 15 Sep 2006 18:25:50 +0200
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158331095.5478.38.camel@localhost> (Aidan Walton's message of
	"Fri, 15 Sep 2006 15:38:15 +0100")
References: <1158316878.5478.14.camel@localhost> <450A8924.2040906@datkan.net>
	<1158331095.5478.38.camel@localhost>
Message-ID: <87lkolf65t.fsf@florent.maison>

Aidan Walton <aidan at wires3.net> wrote:

> I haven't tried using these packages below, but looking at his website I don't
> see a .deb package with a binary, only a source .deb package.

A .deb file is a Debian *binary* package. But yes, this binary package
contains the *source* for the Linux UVC driver. After installing the
.deb (currently,
http://people.via.ecp.fr/~flo/debian/pool/main/linux-uvc-source/linux-uvc-source_0.0.0.svn20060803-1_all.deb),
you have to read the documentation in order to build binary packages for
your kernel that contain *binary modules* for the Linux UVC driver.

But this is not unusual: this works exactly the same when installing
lirc-modules-source or alsa-source.

-- 
Florent


From martin_rubli at logitech.com  Fri Sep 15 18:41:56 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 15 Sep 2006 09:41:56 -0700
Subject: [Linux-uvc-devel] QuickCam Pro success on amd64 debian
In-Reply-To: <450AB341.3090903@cgv.tugraz.at>
References: <450AAFB8.6080806@cgv.tugraz.at>
	<20060915175849.34515110@localhost>
	<450AB341.3090903@cgv.tugraz.at>
Message-ID: <op.tfxhz6hhsttmjo@maya>

Lars,

Thanks for the info, that's good news. :-)

Just wondering if you noticed any problems along the lines of receiving  
error 5 in an application when you try to start streaming and seeing  
errors -32, -110, -71, or -75 in the syslog?

We know that on some USB controllers this problem occurs with the Notebook  
Pro and it would be interesting to know if it happens on 64-bit, too.

Usually, the errors occur either when you try to start streaming  
(launching luvcview a few times in a row) or when you play around with the  
camera controls. If you have a few minutes to spare, could you let me know  
if you can reproduce that behavior? I hope one of these days I'll get  
around to setting up a 64-bit system here ...

As a general remark: Once the camera is streaming, I've never had any  
problems in terms of stability with the driver, even in higher resolutions.

Cheers,
Martin


On Fri, 15 Sep 2006 07:05:53 -0700, Lars Schimmer  
<l.schimmer at cgv.tugraz.at> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Evgeny wrote:
>> Congratulation!
>>
>> Did you use usb reset patch? Can you get not a single picture but
>> streaming? Is the camera driver stable?
>
> I didn?t use the usb reset patch.
> I get a stream about 15fps in small window (320x240) or round about.
> I can?t tell if it?s stable, just tested it for 5 min to prove it is
> working.
>
> MfG,
> Lars Schimmer
> - --
> - -------------------------------------------------------------
> TU Graz, Institut f?r ComputerGraphik & WissensVisualisierung
> Tel: +43 316 873-5405       E-Mail: l.schimmer at cgv.tugraz.at
> Fax: +43 316 873-5402       PGP-Key-ID: 0x4A9B1723
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.1 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
>
> iD8DBQFFCrNBmWhuE0qbFyMRAswmAJwK484Hpsj9H7wHAeg9AhucNzuYzgCfVZi9
> x28UE8GJb7fp8ENVYq2H6TE=
> =qAir
> -----END PGP SIGNATURE-----
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From f.rougon at free.fr  Fri Sep 15 18:46:02 2006
From: f.rougon at free.fr (Florent Rougon)
Date: Fri, 15 Sep 2006 18:46:02 +0200
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158332405.5340.2.camel@localhost> (Aidan Walton's message of
	"Fri, 15 Sep 2006 16:00:05 +0100")
References: <1158316878.5478.14.camel@localhost> <450A8924.2040906@datkan.net>
	<1158332405.5340.2.camel@localhost>
Message-ID: <87ejudf585.fsf@florent.maison>

Aidan Walton <aidan at wires3.net> wrote:

> Ok so I tried the package that Florent put together and before I even managed
> to up-pack the tar ball,? update manager reported an available update, it

What is "update manager"?...

> replaced Florent's package with the official debian source package.

Hmmm, you're using Linux 2.6.15, which is not in unstable (anymore),
neither in sarge. Your package manager is seeing the official
linux-uvc-source, which is only present in testing an unstable (not
sarge).

1) What are you using? sarge, testing, sid?

   My package was built for sarge, as you can guess from the apt lines
   Marcel quoted. If you put such lines on a sid system, you have to
   expect problems. Don't do that.

   If you're using sid, well, I could consider rebuilding the package
   and uploading it to my sid repository. I think a simple rebuild would
   be enough. But as a temporary measure, you can still manually install
   the .deb with dpkg.

2) I'm using a 2.6.17 kernel. uvcvideo.c says:

 * Although the driver compiles on 2.6.12, you should use a 2.6.15 or newer
 * kernel because of USB issues.

   but I have not tested anything else than 2.6.17.

3) Finally, there are two ways to avoid the package being replaced by the
   official one when using your favorite apt frontend:

     a) Put the package on hold (in dselect; don't know for the other
        apt frontends). Problem: you won't get *any* update for this
        package until you revert that.

     b) Use apt pinning (cf. howtos referenced by Google).

   I have currently no need for these methods, since I haven't used my
   package in sid so far; only in sarge, where there is no official
   linux-uvc-source package.

If you want more precise help, you'll have to provide more precise data.

-- 
Florent


From aidan at wires3.net  Fri Sep 15 19:31:33 2006
From: aidan at wires3.net (Aidan Walton)
Date: Fri, 15 Sep 2006 18:31:33 +0100
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <op.tfxg0ln6sttmjo@maya>
References: <1158316878.5478.14.camel@localhost>  <op.tfxg0ln6sttmjo@maya>
Message-ID: <1158341494.5340.38.camel@localhost>

Hi Martin, 
I have also tried luvcview and gnomemeeting. Both have exactly the same
result. The camera is detected, in gnomemeeting for example it becomes
visible in the drop down list. If I select it and then move to watch the
monitored output gnomemeeting hangs. luvcview simply displays a black
screen and must be kill -9 to escape..

????

Thanks
Aidan

On Fri, 2006-09-15 at 09:20 -0700, Martin Rubli wrote:
> Hi,
> 
> Last time I checked 'webcam' didn't properly work with the UVC driver  
> because it tries to use some ioctls that don't make sense for digital  
> cameras and are therefore not supported by the driver.
> 
> Does your camera work with luvcview?  
> (http://mxhaard.free.fr/spca50x/Investigation/uvc/)
> 
> Cheers,
> Martin
> 
> 
> On Fri, 15 Sep 2006 03:41:18 -0700, Aidan Walton <aidan at wires3.net> wrote:
> 
> > Hello Everyone,
> >
> > I've been trying to get my Logitech fusion cam up and running on debian.
> > However having followed all the threads I can see in the archives here I
> > still do not have success. Here is my setup
> >
> > Kernel 2.6.15-1-686
> > linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised
> > source without the isight patch, ... apparently)
> >
> > when I insert the camera i get:
> >
> > usb 4-3: new high speed USB device using ehci_hcd and address 6
> > uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> > 6:3:1: cannot set freq 0 to ep 0x86
> > 6:3:2: cannot set freq 0 to ep 0x86
> > 6:3:3: cannot get freq at ep 0x86
> >
> > This seems normal. If I then run webcam I get this:
> >
> > reading config file: /root/.webcamrc
> > video4linux webcam v1.5 - (c) 1998-2002 Gerd Knorr
> > grabber config:
> >   size 1024x576 [16 bit YUV 4:2:2 (packed, YUYV)]
> >   input (null), norm (null), jpeg quality 75
> >   rotate=0, top=0, left=0, bottom=240, right=320
> > v4l2: oops: select timeout
> > capturing image failed
> >
> > The following is the syslog output from the run of webcam:
> >
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
> > (VIDIOC_ENUMSTD)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
> > (VIDIOC_ENUM_FMT)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
> > (VIDIOC_G_PARM)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
> > (VIDIOC_QUERYCTRL)
> > Sep 15 11:35:26 localhost last message repeated 63 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
> > (VIDIOC_QUERYMENU)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> > (VIDIOC_S_FMT)
> > Sep 15 11:35:26 localhost last message repeated 3 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
> > (VIDIOC_REQBUFS)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
> > (VIDIOC_QUERYBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
> > (VIDIOC_QBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
> > (VIDIOC_STREAMON)
> > Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
> > (VIDIOC_STREAMOFF)
> >
> >
> >
> > Also I have tried luvcview and this is the output:
> >
> > uvcview verion 0.1.6
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> >
> > Stop asked
> >
> >
> > and the syslog output:
> >
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
> > (VIDIOC_ENUMSTD)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
> > (VIDIOC_ENUM_FMT)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
> > (VIDIOC_G_PARM)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
> > (VIDIOC_QUERYCTRL)
> > Sep 15 11:35:26 localhost last message repeated 63 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
> > (VIDIOC_QUERYMENU)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> > (VIDIOC_S_FMT)
> > Sep 15 11:35:26 localhost last message repeated 3 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
> > (VIDIOC_REQBUFS)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
> > (VIDIOC_QUERYBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
> > (VIDIOC_QBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
> > (VIDIOC_STREAMON)
> > Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
> > (VIDIOC_STREAMOFF)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0x80685600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> > (VIDIOC_S_FMT)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0145608
> > (VIDIOC_REQBUFS)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0445609
> > (VIDIOC_QUERYBUF)
> > Sep 15 11:36:27 localhost last message repeated 3 times
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc044560f
> > (VIDIOC_QBUF)
> > Sep 15 11:36:27 localhost last message repeated 3 times
> > Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0x40045612
> > (VIDIOC_STREAMON)
> > Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0xc0445611
> > (VIDIOC_DQBUF)
> > Sep 15 11:36:52 localhost kernel: uvcvideo: ioctl 0xc0445611
> > (VIDIOC_DQBUF)
> >
> >
> > Basically I just get a black screen and the process hangs only killable
> > with a -9.
> >
> >
> >
> > Any ideas? Thanks for any help.
> > Aidan
> >
> >
> >
> 
> 



From aidan at wires3.net  Fri Sep 15 19:35:06 2006
From: aidan at wires3.net (Aidan Walton)
Date: Fri, 15 Sep 2006 18:35:06 +0100
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <op.tfxg0ln6sttmjo@maya>
References: <1158316878.5478.14.camel@localhost>  <op.tfxg0ln6sttmjo@maya>
Message-ID: <1158341706.5340.39.camel@localhost>

Thanks folks for the thoughts so here is my situation in more detail.

I am, as you correctly surmised, using debian 'etch' not sarge. The
kernel is that packed by debian for this distro, I have done nothing
custom to it (I assure you I wouldn't know how :)). 

FYI Update Manager (not sure if that's the official name), is a neat
little add on for the apt utility that continuously checks for updates
to the installed packages and offers a download if you wish to do so. It
is completely under user control, so there is no need to lock down apt,
unless I wanted to keep a package back at current state over the long
run.

Anyway, regardless of the state of apt and the official packages, I'll
give you some history.

I initially used apt to install the official debian certified uvc-video
source. I then un-tarred this and compiled the kernel module. Then tried
to insert the module. It inserted but would not detect any changes on
the usb bus or load itself as needed. However a few days later, after a
reboot, I see that the driver was visible when I issued lsmod. So I
tried again, looking at dmesg, to see what happened as I plugged and
un-plugged the camera. Great it was seeing it and loading the driver
against it. When I used webcam to try to grab an image, the little blue
light on the camera comes on but webcam times out, see my original mail
for a dump at this stage. As webcam terminates the camera light goes
off. So it seems very close to working in many respects. i.e whatever
causes the timeout does not crash the module as it lets go of the camera
cleanly. Well I assume it does. If the light stayed on I would think the
module had bombed. 

However no images! So I tried ignoring the debain distro and used svn to
checkout the very latest code for the kernel module. I complied and
installed but when I try and use modprobe to load the module it
complains about the integrity of the module that has just been compiled:

FATAL: Error inserting uvcvideo
(/lib/modules/2.6.15-1-686/usb/media/uvcvideo.ko): Invalid module
format.

Now the only way to get module installed in the kernel is to compile
again using the source that the debian team have made available via the
official repositories. The big difference is that the debianised source
comes with a little extra 'debian' directory that explains the use of
module-assistant which when run creates a .deb from the module and using
dpkg -i <new package>.deb the module loads and runs fine, expect it does
not get images. I'm not sure what else module assistant does but now it
seems like the only way I can get a kernel module to install from this
code.

I hope this helps explain my situation better. please ask though and
I'll happily give you more details as its a little frustrating that this
kernel mod clearly works with this camera but not on my system. Isn't it
always so!

thanks all
Aidan
On Fri, 2006-09-15 at 09:20 -0700, Martin Rubli wrote:
> Hi,
> 
> Last time I checked 'webcam' didn't properly work with the UVC driver  
> because it tries to use some ioctls that don't make sense for digital  
> cameras and are therefore not supported by the driver.
> 
> Does your camera work with luvcview?  
> (http://mxhaard.free.fr/spca50x/Investigation/uvc/)
> 
> Cheers,
> Martin
> 
> 
> On Fri, 15 Sep 2006 03:41:18 -0700, Aidan Walton <aidan at wires3.net> wrote:
> 
> > Hello Everyone,
> >
> > I've been trying to get my Logitech fusion cam up and running on debian.
> > However having followed all the threads I can see in the archives here I
> > still do not have success. Here is my setup
> >
> > Kernel 2.6.15-1-686
> > linux-uvc-modules-2.6.15-1-686 ver 0.1.0-5.1  (Based on the debianised
> > source without the isight patch, ... apparently)
> >
> > when I insert the camera i get:
> >
> > usb 4-3: new high speed USB device using ehci_hcd and address 6
> > uvcvideo: Found UVC 1.00 device <unnamed> (046d:08c1)
> > 6:3:1: cannot set freq 0 to ep 0x86
> > 6:3:2: cannot set freq 0 to ep 0x86
> > 6:3:3: cannot get freq at ep 0x86
> >
> > This seems normal. If I then run webcam I get this:
> >
> > reading config file: /root/.webcamrc
> > video4linux webcam v1.5 - (c) 1998-2002 Gerd Knorr
> > grabber config:
> >   size 1024x576 [16 bit YUV 4:2:2 (packed, YUYV)]
> >   input (null), norm (null), jpeg quality 75
> >   rotate=0, top=0, left=0, bottom=240, right=320
> > v4l2: oops: select timeout
> > capturing image failed
> >
> > The following is the syslog output from the run of webcam:
> >
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
> > (VIDIOC_ENUMSTD)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
> > (VIDIOC_ENUM_FMT)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
> > (VIDIOC_G_PARM)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
> > (VIDIOC_QUERYCTRL)
> > Sep 15 11:35:26 localhost last message repeated 63 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
> > (VIDIOC_QUERYMENU)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> > (VIDIOC_S_FMT)
> > Sep 15 11:35:26 localhost last message repeated 3 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
> > (VIDIOC_REQBUFS)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
> > (VIDIOC_QUERYBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
> > (VIDIOC_QBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
> > (VIDIOC_STREAMON)
> > Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
> > (VIDIOC_STREAMOFF)
> >
> >
> >
> > Also I have tried luvcview and this is the output:
> >
> > uvcview verion 0.1.6
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> >
> > Stop asked
> >
> >
> > and the syslog output:
> >
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80585600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unknown ioctl 0x80585600
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x80685600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc04c561a
> > (VIDIOC_ENUMINPUT)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405619
> > (VIDIOC_ENUMSTD)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: Unsupported ioctl 0xc0405619
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0405602
> > (VIDIOC_ENUM_FMT)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5615
> > (VIDIOC_G_PARM)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445624
> > (VIDIOC_QUERYCTRL)
> > Sep 15 11:35:26 localhost last message repeated 63 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc02c5625
> > (VIDIOC_QUERYMENU)
> > Sep 15 11:35:26 localhost last message repeated 2 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> > (VIDIOC_S_FMT)
> > Sep 15 11:35:26 localhost last message repeated 3 times
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0145608
> > (VIDIOC_REQBUFS)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc0445609
> > (VIDIOC_QUERYBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0xc044560f
> > (VIDIOC_QBUF)
> > Sep 15 11:35:26 localhost kernel: uvcvideo: ioctl 0x40045612
> > (VIDIOC_STREAMON)
> > Sep 15 11:35:31 localhost kernel: uvcvideo: ioctl 0x40045613
> > (VIDIOC_STREAMOFF)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0x80685600
> > (VIDIOC_QUERYCAP)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0cc5605
> > (VIDIOC_S_FMT)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0145608
> > (VIDIOC_REQBUFS)
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc0445609
> > (VIDIOC_QUERYBUF)
> > Sep 15 11:36:27 localhost last message repeated 3 times
> > Sep 15 11:36:27 localhost kernel: uvcvideo: ioctl 0xc044560f
> > (VIDIOC_QBUF)
> > Sep 15 11:36:27 localhost last message repeated 3 times
> > Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0x40045612
> > (VIDIOC_STREAMON)
> > Sep 15 11:36:28 localhost kernel: uvcvideo: ioctl 0xc0445611
> > (VIDIOC_DQBUF)
> > Sep 15 11:36:52 localhost kernel: uvcvideo: ioctl 0xc0445611
> > (VIDIOC_DQBUF)
> >
> >
> > Basically I just get a black screen and the process hangs only killable
> > with a -9.
> >
> >
> >
> > Any ideas? Thanks for any help.
> > Aidan
> >
> >
> >
> 
> 



From martin_rubli at logitech.com  Fri Sep 15 19:39:26 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 15 Sep 2006 10:39:26 -0700
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158341494.5340.38.camel@localhost>
References: <1158316878.5478.14.camel@localhost> <op.tfxg0ln6sttmjo@maya>
	<1158341494.5340.38.camel@localhost>
Message-ID: <op.tfxkn014sttmjo@maya>

Hey Aidan,

Ekiga is known to have some problems, I'm compiling the latest version  
right now to see if I can get it to work.

If luvcview shows you a black picture, this usually means that something's  
wrong with the SDL output it uses and not the camera itself. Does the -w  
option change anything?

Cheers,
Martin


On Fri, 15 Sep 2006 10:31:33 -0700, Aidan Walton <aidan at wires3.net> wrote:

> Hi Martin,
> I have also tried luvcview and gnomemeeting. Both have exactly the same
> result. The camera is detected, in gnomemeeting for example it becomes
> visible in the drop down list. If I select it and then move to watch the
> monitored output gnomemeeting hangs. luvcview simply displays a black
> screen and must be kill -9 to escape..
>
> ????
>
> Thanks
> Aidan
>
> On Fri, 2006-09-15 at 09:20 -0700, Martin Rubli wrote:
>> Hi,
>>
>> Last time I checked 'webcam' didn't properly work with the UVC driver
>> because it tries to use some ioctls that don't make sense for digital
>> cameras and are therefore not supported by the driver.
>>
>> Does your camera work with luvcview?
>> (http://mxhaard.free.fr/spca50x/Investigation/uvc/)
>>
>> Cheers,
>> Martin


From diaxen at free.fr  Fri Sep 15 20:07:30 2006
From: diaxen at free.fr (Alexandre Becoulet)
Date: Fri, 15 Sep 2006 20:07:30 +0200
Subject: [Linux-uvc-devel] QuickCam Pro success on amd64 debian
In-Reply-To: <op.tfxhz6hhsttmjo@maya>
References: <450AAFB8.6080806@cgv.tugraz.at> <450AB341.3090903@cgv.tugraz.at>
	<op.tfxhz6hhsttmjo@maya>
Message-ID: <200609152007.30578.diaxen@free.fr>

On Friday 15 September 2006 18:41, Martin Rubli wrote:

> I hope one of these days I'll get
> around to setting up a 64-bit system here ...

Just to let you know, I originaly wrote the usb reset patch as a workaround 
for the QCPro 5000 hang on my gentoo amd64 box.

-- 
Alexandre


From f.rougon at free.fr  Sat Sep 16 12:32:52 2006
From: f.rougon at free.fr (Florent Rougon)
Date: Sat, 16 Sep 2006 12:32:52 +0200
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <1158340875.5340.33.camel@localhost> (Aidan Walton's message of
	"Fri, 15 Sep 2006 18:21:15 +0100")
References: <1158316878.5478.14.camel@localhost> <450A8924.2040906@datkan.net>
	<1158332405.5340.2.camel@localhost> <87ejudf585.fsf@florent.maison>
	<1158340875.5340.33.camel@localhost>
Message-ID: <874pv8f6ej.fsf@florent.maison>

Aidan Walton <aidan.walton at airnetic.net> wrote:

> FATAL: Error inserting uvcvideo
> (/lib/modules/2.6.15-1-686/usb/media/uvcvideo.ko): Invalid module
> format.

I don't know how you got that. In your place, I'd check that I have a
linux-headers package matching the kernel image package in use. Also,
Linux 2.6.17 is in testing. Why don't you try that?

What happens exactly (error messages, etc.) if you:

  1? Remove any UVC driver currently installed on your system.
  2? Install the kernel headers corresponding to the kernel image
     you are running.
  3? # dpkg -i $file.deb
     where $file is
     http://people.via.ecp.fr/~flo/debian/pool/main/linux-uvc-source/linux-uvc-source_0.0.0.svn20060803-1_all.deb
  4? Follow the instructions in
    /usr/share/doc/linux-uvc-source/README.Debian.
  5? Test with ekiga or luvcview (assuming things went fine so far).

-- 
Florent


From laurent.pinchart at skynet.be  Sat Sep 16 23:04:20 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 16 Sep 2006 23:04:20 +0200
Subject: [Linux-uvc-devel] troubles with qc fusion
In-Reply-To: <af0222da0609121342ve180fbel1f6d351fd188ccf4@mail.gmail.com>
References: <af0222da0609111219j182d4368l2161dd2989bbb1e1@mail.gmail.com>
	<f4586a2e0609112105i6bd51a09m9c57b0ca3463dd32@mail.gmail.com>
	<af0222da0609121342ve180fbel1f6d351fd188ccf4@mail.gmail.com>
Message-ID: <200609162304.21656.laurent.pinchart@skynet.be>

Hi

> >   To use uvcvideo kernel module you need following modules to be
> > present in kernel before.
> > In my case see
> > lsmod | grep uvc
> > uvcvideo               32132   0
> > v4l1_compat          12164  1 uvcvideo
> > v4l2_common        14208  1 uvcvideo
> > videodev               9216    1 uvcvideo
>
> I manually insert them and they are there.
>
> # modprobe videodev
> # lsmod  less videodev
> videodev               20992  0
> v4l1_compat            11524  1 videodev
> v4l2_common            20608  1 videodev
>
> When I then insert the uvcvideo kernel mod I still get the same errors
> however.
>
> # modprobe uvcvideo
> FATAL: Error inserting uvcvideo
> (/lib/modules/2.6.17-1.2174_FC5/usb/media/uvcvideo.ko): Unknown symbol
> in module, or unknown parameter (see dmesg)
>
> Dmesg output:
> uvcvideo: disagrees about version of symbol video_devdata
> uvcvideo: Unknown symbol video_devdata
> uvcvideo: disagrees about version of symbol video_unregister_device
> uvcvideo: Unknown symbol video_unregister_device
> uvcvideo: disagrees about version of symbol video_device_alloc
> uvcvideo: Unknown symbol video_device_alloc
> uvcvideo: disagrees about version of symbol video_register_device
> uvcvideo: Unknown symbol video_register_device
> uvcvideo: disagrees about version of symbol video_device_release
> uvcvideo: Unknown symbol video_device_release
>
> I am not a programmer (just an enthousiast who would like to be able
> to debug and help more) but could this be an incompatibility between
> the Fedora v4l{12} or videodev kernel module and uvcvideo? I did a FC5
> installation about a month ago and as far as i know I only installed
> 'safe' packages. After getting the above errors I just deinstalled the
> ATrpm v4l packages and compiled v4l-dvb from source. I still get the
> same errors however...
>
>
> Also a thanks and cheers to the developers for all their work. My
> brother advised me to get a qc fusion because of the good image and
> video quality. On my laptop the uvcvideo driver is working great with
> uvcview and ekiga. Just hope I can get this one solved for my desktop
> box as well...

It seems you compiled the uvcvideo module against a different kernel source 
than the one running on your system. This is a build issue, and probably 
distribution specific. I have no idea how to fix that, as I never used Fedora 
Core.

Laurent Pinchart


From laurent.pinchart at skynet.be  Sat Sep 16 23:27:12 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 16 Sep 2006 23:27:12 +0200
Subject: [Linux-uvc-devel] linux uvc and kernel 2.6.18
In-Reply-To: <eeebcn$f8p$1@sea.gmane.org>
References: <eeebcn$f8p$1@sea.gmane.org>
Message-ID: <200609162327.13322.laurent.pinchart@skynet.be>

Hi Stefan,

> I am trying out linux-uvc with version 2.6.18-rc6-git3 and it reports
> unknown symbols for video_get_drvdata and video_set_drvdata. Based on
> another patch for this problem [1] I have fixed this for uvc. The fix works
> for me but please bear in mind that I have little kernel programming
> experience and thus it could be wrong.

Thanks for the patch. It looks overly complicated to me, and it seems that 
video_get_drvdata/video_set_drvdata should not have been removed, but 
modified to use dev_get_drvdata/dev_set_drvdata instead.

Mauro, could you have a look at that ? Why have those been removed ? I know 
they were marked with OBSOLETE_OWNER, but that's becaused they accessed the 
video_device structure's priv field, marked for removal.

        /* dev->driver_data will be used instead some day.
         * Use the video_{get|set}_drvdata() helper functions,
         * so the switch over will be transparent for you.
         * Or use {pci|usb}_{get|set}_drvdata() directly. */
        void *priv;

Shouldn't video_{get|set}_drvdata() have been kept ?

Laurent Pinchart


From dancer at netfort.gr.jp  Sun Sep 17 05:06:41 2006
From: dancer at netfort.gr.jp (Junichi Uekawa)
Date: Sun, 17 Sep 2006 12:06:41 +0900
Subject: [Linux-uvc-devel] a temporary patch to work with iSight and Logitech
Message-ID: <87psdvqji6.dancerj%dancer@netfort.gr.jp>

Hi,

The following is the patch applied to Debian package in order to make
linux-uvc work on both iSight and Logitech stuff. It needs re-working
since it uses a global, but this is a start.

regards,
	junichi
-- 
dancer@{debian.org,netfort.gr.jp}   Debian Project
#! /bin/sh /usr/share/dpatch/dpatch-run
## 01_macbook_support.dpatch by Junichi Uekawa <dancer at debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Mactel Linux iSight support by rbultje, rediffed against trunk

@DPATCH@
diff -urNad trunk~/Makefile trunk/Makefile
--- trunk~/Makefile	2006-07-22 21:59:17.000000000 +0900
+++ trunk/Makefile	2006-07-23 08:39:33.000000000 +0900
@@ -1,7 +1,7 @@
 KERNEL_VERSION	:= `uname -r`
 KERNEL_DIR	:= /lib/modules/$(KERNEL_VERSION)/build
 INSTALL_MOD_DIR	:= usb/media
-
+DRIVER_VERSION	:= `grep DRIVER_VERSION uvcvideo.c | grep define | grep -v DRIVER_VERSION_NUMBER | cut -d"\"" -f2`
 PWD		:= $(shell pwd)
 
 obj-m		:= uvcvideo.o
@@ -9,7 +9,7 @@
 %.o : %.c
 	gcc $(TEST_CFLAGS) -c -o $@ $<
 
-all: uvcvideo
+all: uvcvideo extract
 
 uvcvideo:
 	@echo "Building USB Video Class driver..."
@@ -24,3 +24,12 @@
 	-rm -f *.o *.ko .*.cmd .*.flags *.mod.c Modules.symvers
 	-rm -rf .tmp_versions
 
+extract: extract.c
+	gcc -g `pkg-config --cflags --libs libusb` -o extract extract.c
+
+dist:
+	rm -fr linux-uvc-${DRIVER_VERSION}
+	mkdir linux-uvc-${DRIVER_VERSION}
+	cp uvcvideo.[ch] Makefile extract.c linux-uvc-${DRIVER_VERSION}/
+	tar -zcf linux-uvc-${DRIVER_VERSION}.tar.gz linux-uvc-${DRIVER_VERSION}
+	rm -fr linux-uvc-${DRIVER_VERSION}
diff -urNad trunk~/extract.c trunk/extract.c
--- trunk~/extract.c	1970-01-01 09:00:00.000000000 +0900
+++ trunk/extract.c	2006-07-23 08:39:33.000000000 +0900
@@ -0,0 +1,202 @@
+/*
+ * Apple iSight (the one built in the screen of Macbooks) firmware loader
+ * Copyright (C) 2006 Ronald S. Bultje <rbultje at ronald.bitfreak.net>
+ *
+ * Special thanks to Johannes Berg <johannes at sipsolutions.net> for helping
+ * to find out how to load the firmware; see his website on
+ * http://johannes.sipsolutions.net/MacBook/iSight for details.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
+ * MA 02110-1301, USA
+ */
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <fcntl.h>
+#include <errno.h>
+
+#include <usb.h>
+#define TIMEOUT 300
+
+static int
+read_fw (struct usb_dev_handle *dev, char *filename)
+{
+	long long int pos;
+	int fd, rd, len, req, llen, res, ret = -1;
+	unsigned char data[4], rdata[1024], *ptr;
+
+	if ((fd = open (filename, O_RDONLY)) == -1) {
+		perror ("Opening file");
+		return -1;
+	} else if (lseek (fd, 5172, SEEK_SET) != 5172) {
+		perror ("Seeking");
+		close (fd);
+		return -1;
+	}
+
+	if ((res = usb_control_msg (dev, 0x40, 0xA0, 0xe600, 0,
+				    "\1", 1, TIMEOUT)) != 1) {
+		perror ("Firmware load init failed");
+		close (fd);
+		return -1;
+	}
+	while (1) {
+		if ((len = read (fd, data, 4)) != 4) {
+			if (len == 0) {
+				fprintf (stderr,
+					 "Unexpected eos - corrupt driver?\n");
+				goto end;
+			} else {
+				perror("Reading firmware header chunk failed");
+				goto end;
+			}
+		}
+		len = (data[0] << 8) | data[1];
+		req = (data[2] << 8) | data[3];
+		if (len == 0x8001)
+			break; /* success */
+		else if (len == 0)
+			continue;
+		else if (len < 0 || len >= 1024) {
+			fprintf (stderr,
+				 "Invalid firmware length %d, load aborted\n",
+				 len);
+			goto end;
+		} else if (read (fd, rdata, len) != len) {
+			perror ("Error reading firmware data");
+			goto end;
+		}
+
+		/* upload to usb bus */
+		for (ptr = rdata; len > 0; req += 50, ptr += 50) {
+			llen = len > 50 ? 50 : len;
+			len -= llen;
+
+			if ((res = usb_control_msg (dev, 0x40, 0xA0, req, 0,
+						    (char *) ptr, llen,
+						    TIMEOUT)) != llen) {
+				fprintf (stderr,
+					 "firmware load req=0x%x failed: %s\n",
+					 req, strerror (errno));
+				goto end;
+			}
+		}
+	}
+
+	ret = 0;
+end:
+	if ((res = usb_control_msg (dev, 0x40, 0xA0, 0xe600, 0,
+				    "\0", 1, TIMEOUT)) != 1) {
+		perror ("Firmware finish-up failed");
+		ret = -1;
+	}
+
+	close (fd);
+
+	return ret;
+}
+
+static int
+probe_dev (struct usb_device *dev, char *fw_filename)
+{
+	int n, total = 0;
+
+	if (dev->descriptor.idVendor == 0x05ac &&
+	    dev->descriptor.idProduct == 0x8300 &&
+	    dev->descriptor.bDeviceClass == 0xff &&
+	    dev->descriptor.bDeviceSubClass == 0xff &&
+	    dev->descriptor.bDeviceProtocol == 0xff) {
+		usb_dev_handle *h;
+
+		/* load firmware */
+		if (!(h = usb_open (dev))) {
+			perror ("Opening iSight");
+			return;
+		}
+		printf ("Loading firmware for iSight...\n");
+		if (read_fw (h, fw_filename) == 0) {
+			printf ("done\n");
+			total++;
+		}
+		usb_close (h);
+	} else if (dev->descriptor.idVendor == 0x05ac &&
+		   dev->descriptor.idProduct == 0x8501) {
+		printf ("Apple iSight with firmware already loaded found\n");
+		total++;
+	}
+
+	for (n = 0; n < dev->num_children; n++)
+		total += probe_dev (dev->children[n], fw_filename);
+
+	return total;
+}
+
+int
+main (int argc, char *argv[])
+{
+	int n, m, found = 0;
+	char command[1024];
+	struct usb_bus *bus;
+	struct usb_device *dev;
+
+	if (argc != 2) {
+		fprintf(stderr, "Usage: %s <firmware file>\n", argv[0]);
+		fprintf(stderr, "Firmware can usually be found on your Mac "
+			"partition in /System/Library/Extensions/"
+			"IOUSBFamily.kext/Contents/PlugIns/"
+			"AppleUSBVideoSupport.kext/Contents/MacOS/"
+			"AppleUSBVideoSupport\n");
+		return -1;
+	}
+	
+	/* check sha1sum on firmware, to prevent loading crap into the
+	 * iSight and thus possibly damaging it. */
+	snprintf (command, sizeof (command) - 1,
+		  "test \"x`sha1sum %s`\" == \"x%s  %s\" &> /dev/null",
+		  argv[1], "86430c04f9b67c5c3d84409138a7679827025ec2",
+		  argv[1]);
+	if (system (command) != 0) {
+		fprintf (stderr, "Sha1sum check on firmware file failed\n");
+		return -1;
+	}
+
+	/* init usb */
+	usb_init ();
+	if (usb_find_busses () == 0) {
+		fprintf (stderr, "No USB busses found\n");
+		return -1;
+	} else if (usb_find_devices () == 0) {
+		fprintf (stderr, "No USB devices found\n");
+		return -1;
+	}
+
+	/* find iSight */
+	for (bus = usb_busses; bus != NULL; bus = bus->next) {
+		if (bus->devices != NULL) {
+			for (dev = bus->devices; dev != NULL;
+			     dev = dev->next) {
+				found += probe_dev (dev, argv[1]);
+			}
+		}
+	}
+	if (found == 0) {
+		fprintf (stderr, "No Apple iSight found!\n");
+		return -1;
+	}
+
+	return 0;
+}
diff -urNad trunk~/uvcvideo.c trunk/uvcvideo.c
--- trunk~/uvcvideo.c	2006-07-22 21:59:17.000000000 +0900
+++ trunk/uvcvideo.c	2006-07-23 08:39:33.000000000 +0900
@@ -53,7 +53,7 @@
 
 #define DRIVER_AUTHOR		"Laurent Pinchart <laurent.pinchart at skynet.be>"
 #define DRIVER_DESC		"USB Video Class driver"
-#define DRIVER_VERSION		"0.1.0"
+#define DRIVER_VERSION		"0.1.0-b"
 #define DRIVER_VERSION_NUMBER	KERNEL_VERSION(0, 1, 0)
 
 #define UVC_CTRL_TIMEOUT	300
@@ -77,6 +77,8 @@
 				 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
 #define UVC_GUID_FORMAT_YUY2	{0x59, 0x55, 0x59, 0x32, 0x00, 0x00, 0x10, 0x00, \
 				 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
+#define UVC_GUID_FORMAT_YUY2A	{0x59, 0x55, 0x59, 0x32, 0x00, 0x00, 0x10, 0x00, \
+				 0x00, 0x80, 0x71, 0x9b, 0x38, 0x00, 0xaa, 0x00}
 #define UVC_GUID_FORMAT_NV12	{0x4e, 0x56, 0x31, 0x32, 0x00, 0x00, 0x10, 0x00, \
 				 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71}
 
@@ -568,8 +570,8 @@
 		.fcc		= V4L2_PIX_FMT_YUYV,
 	},
 	{
-		.guid		= UVC_GUID_FORMAT_YUY2,
-		.fcc		= V4L2_PIX_FMT_YUYV,
+		.guid		= UVC_GUID_FORMAT_YUY2A,
+		.fcc		= V4L2_PIX_FMT_UYVY,
 	},
 	{
 		.guid		= UVC_GUID_FORMAT_NV12,
@@ -1275,24 +1277,38 @@
 		struct uvc_buffer *buf, const __u8 *data, unsigned int len)
 {
 	unsigned int maxlen, nbytes;
-	void *mem;
-	__u8 fid;
+	__u8 *mem;
+	__u8 fid = queue->last_fid;
+	int hlen = 0, flags = 0, is_header = 0;
+	static const __u8 hdr[] = { 0x11, 0x22, 0x33, 0x44,
+				    0xde, 0xad, 0xbe, 0xef,
+				    0xde, 0xad, 0xfa, 0xce };
 
 	/* Sanity checks:
 	 * - packet must be at least 2 bytes long
 	 * - bHeaderLength value must be at least 2 bytes (see above)
 	 * - bHeaderLength value can't be larger than the packet size.
 	 */
-	if (len < 2 || data[0] < 2 || data[0] > len)
-		return -EINVAL;
+	if ((len >= 14 && memcmp (&data[3], hdr, 12) == 0) ||
+	    (len >= 13 && memcmp (&data[2], hdr, 12) == 0)) {
+		uvc_trace(UVC_TRACE_FRAME, "Detecting new header");
+		hlen = (data[3] == 0x11) ? data[1] : data[0];
+		if (hlen > len - 1 || hlen < 2)
+			return -EINVAL;
+		flags = (data[3] == 0x11) ? data[2] : data[1];
+		is_header = 1;
+	}
 
 	/* Skip payloads marked with the error bit ("error frames"). */
-	if (data[1] & UVC_STREAM_ERR) {
+	if (hlen != 0 && flags & UVC_STREAM_ERR) {
 		uvc_trace(UVC_TRACE_FRAME, "Dropping packet (error bit set).\n");
-		return 0;
+
+		//return 0;
 	}
 
-	fid = data[1] & UVC_STREAM_FID;
+	if (hlen != 0) {
+		fid = flags & UVC_STREAM_FID;
+	}
 
 	/* Store the packet FID bit and return immediately when the buffer is
 	 * NULL.
@@ -1338,28 +1354,33 @@
 				"toggled).\n");
 		buf->state = UVC_BUF_STATE_DONE;
 		return -EAGAIN;
+	} else if (is_header && buf->buf.bytesused > 0) {
+		buf->state = UVC_BUF_STATE_DONE;
+		return -EAGAIN;
 	}
 
 	queue->last_fid = fid;
 
 	/* Copy the video data to the buffer. */
-	len -= data[0];
+	len -= hlen;
 	maxlen = buf->buf.length - buf->buf.bytesused;
-	mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
-	nbytes = min(len, maxlen);
-	memcpy(mem, data + data[0], nbytes);
-	buf->buf.bytesused += nbytes;
+	if (!is_header) { /* we skip headers, they do not contain data */
+		mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
+		nbytes = min(len - hlen, maxlen);
+		memmove(mem, data + hlen, nbytes);
+		buf->buf.bytesused += nbytes;
+	}
 
 	/* Drop the current frame if the buffer size was exceeded. */
-	if (len > maxlen) {
+	if (len - hlen > maxlen || buf->buf.bytesused == buf->buf.length) {
 		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
 		buf->state = UVC_BUF_STATE_DONE;
 	}
 
 	/* Mark the buffer as done if the EOF marker is set. */
-	if (data[1] & UVC_STREAM_EOF && buf->buf.bytesused != 0) {
+	if (hlen != 0 && (flags & UVC_STREAM_EOF && buf->buf.bytesused != 0)) {
 		uvc_trace(UVC_TRACE_FRAME, "Frame complete (EOF found).\n");
-		if (data[0] == len)
+		if (hlen != 0 && hlen == len)
 			printk("EOF in empty packet.\n");
 		buf->state = UVC_BUF_STATE_DONE;
 	}
@@ -1597,7 +1618,7 @@
 
 	if (ret != size) {
 		uvc_printk(KERN_ERR, "Failed to query (%u) UVC control %u "
-			"(unit %u) : %d.\n", query, cs, unit, ret);
+			"(unit %u) : %d (exp: %u).\n", query, cs, unit, ret, size);
 		return -EIO;
 	}
 
@@ -1887,8 +1908,10 @@
 
 	/* Get the minimum and maximum values for compression settings. */
 	if ((ret = uvc_get_video_ctrl(video, &probe_min, 1, GET_MIN)) < 0 ||
-	    (ret = uvc_get_video_ctrl(video, &probe_max, 1, GET_MAX)) < 0)
+	    (ret = uvc_get_video_ctrl(video, &probe_max, 1, GET_MAX)) < 0) {
+		ret = 0;
 		goto done;
+	}
 
 	probe->wCompQuality = probe_max.wCompQuality;
 
@@ -1946,7 +1969,7 @@
 		return ret;
 
 	/* Retrieve the default format and commit it. */
-	if ((ret = uvc_get_video_ctrl(video, probe, 1, GET_DEF)) < 0)
+	if ((ret = uvc_get_video_ctrl(video, probe, 1, GET_CUR)) < 0)
 		return ret;
 	if ((ret = uvc_set_video_ctrl(video, probe, 0)) < 0)
 		return ret;
@@ -2218,6 +2241,11 @@
 	if ((ret = uvc_set_video_ctrl(video, &probe, 0)) < 0)
 		return ret;
 
+	if (probe.dwMaxVideoFrameSize == 0)
+		probe.dwMaxVideoFrameSize =
+			video->streaming->format[probe.bFormatIndex - 1].
+				frame[probe.bFrameIndex - 1].dwMaxVideoFrameBufferSize;
+
 	memcpy(&video->streaming->ctrl, &probe, sizeof probe);
 	video->streaming->cur_format = format;
 	video->streaming->cur_frame = frame;
@@ -3590,6 +3618,13 @@
 
 	if (!found) {
 		uvc_printk(KERN_INFO, "No valid video chain found.\n");
+		if (dev->udev->descriptor.idVendor == 0x05ac &&
+		    dev->udev->descriptor.idProduct == 0x8300) {
+			uvc_printk (KERN_ERR, "Possible an Apple iSight "
+				    "without firmware loaded; please read "
+				    "the documentation, load the firmware "
+				    "and re-load the driver.");
+		}
 		return -1;
 	}
 
@@ -3841,6 +3876,19 @@
 	  .bInterfaceClass	= USB_CLASS_VENDOR_SPEC,
 	  .bInterfaceSubClass	= 1,
 	  .bInterfaceProtocol	= 0 },
+	/* Apple iSight (built-in in Macintels) */
+	{ .match_flags		= USB_DEVICE_ID_MATCH_DEVICE,
+	  .idVendor		= 0x05ac,
+	  .idProduct		= 0x8501 },
+	/* same, but without firmware loaded (will give useful warning)
+	 * when the firmware is not loaded in the pre-instal step). */
+	{ .match_flags		= USB_DEVICE_ID_MATCH_DEVICE
+				| USB_DEVICE_ID_MATCH_INT_INFO,
+	  .idVendor		= 0x05ac,
+	  .idProduct		= 0x8300,
+	  .bInterfaceClass	= USB_CLASS_VENDOR_SPEC,
+	  .bInterfaceSubClass	= 0xff,
+	  .bInterfaceProtocol	= 0xff },
 	/* Generic USB Video Class */
 	{ USB_INTERFACE_INFO(USB_CLASS_VIDEO, 1, 0) },
 	{}



#! /bin/sh /usr/share/dpatch/dpatch-run
## 07_with_isight.dpatch Nobuhiro Iwamatsu <hemamu at t-base.ne.jp>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Workaround to get iSight and normal UVC devices function.

@DPATCH@
diff -urN trunk~/uvcvideo.c trunk/uvcvideo.c
--- trunk~/uvcvideo.c	2006-09-10 23:09:20.000000000 +0900
+++ trunk/uvcvideo.c	2006-09-10 23:17:08.000000000 +0900
@@ -288,6 +288,11 @@
 	UVC_BUF_STATE_ERROR      = 4,
 };
 
+enum uvc_dev_type{
+	UVC_DEV_ISIGHT          = 0 ,   /* Apple iSight */
+	UVC_DEV_QCAM_FUSION     = 1 ,   /* Qcam Fusion  */
+};
+
 struct uvc_buffer {
 	unsigned int size;
 	unsigned long vma_use_count;
@@ -379,6 +384,7 @@
 
 static void uvc_delete(struct kref *kref);
 
+static int dev_type ;/* device type */
 /* ------------------------------------------------------------------------
  * Control, formats, ...
  */
@@ -1289,14 +1295,23 @@
 	 * - bHeaderLength value must be at least 2 bytes (see above)
 	 * - bHeaderLength value can't be larger than the packet size.
 	 */
-	if ((len >= 14 && memcmp (&data[3], hdr, 12) == 0) ||
-	    (len >= 13 && memcmp (&data[2], hdr, 12) == 0)) {
-		uvc_trace(UVC_TRACE_FRAME, "Detecting new header");
-		hlen = (data[3] == 0x11) ? data[1] : data[0];
-		if (hlen > len - 1 || hlen < 2)
+	if( dev_type != UVC_DEV_ISIGHT ){
+		if (len < 2 || data[0] < 2 || data[0] > len){
 			return -EINVAL;
-		flags = (data[3] == 0x11) ? data[2] : data[1];
-		is_header = 1;
+		}
+
+		hlen  = data[0];
+		flags = data[1];
+	}else{
+		if ((len >= 14 && memcmp (&data[3], hdr, 12) == 0) ||
+	    	(len >= 13 && memcmp (&data[2], hdr, 12) == 0)) {
+			uvc_trace(UVC_TRACE_FRAME, "Detecting new header");
+			hlen = (data[3] == 0x11) ? data[1] : data[0];
+			if (hlen > len - 1 || hlen < 2)
+				return -EINVAL;
+			flags = (data[3] == 0x11) ? data[2] : data[1];
+			is_header = 1;
+		}
 	}
 
 	/* Skip payloads marked with the error bit ("error frames"). */
@@ -1364,7 +1379,14 @@
 	/* Copy the video data to the buffer. */
 	len -= hlen;
 	maxlen = buf->buf.length - buf->buf.bytesused;
-	if (!is_header) { /* we skip headers, they do not contain data */
+
+	if(dev_type != UVC_DEV_ISIGHT){
+		mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
+		nbytes = min(len, maxlen);
+		memcpy(mem, data + hlen, nbytes);
+		buf->buf.bytesused += nbytes;
+	}else if((dev_type == UVC_DEV_ISIGHT)&& (!is_header)) {
+		/* we skip headers, they do not contain data */
 		mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
 		nbytes = min(len - hlen, maxlen);
 		memmove(mem, data + hlen, nbytes);
@@ -1372,11 +1394,19 @@
 	}
 
 	/* Drop the current frame if the buffer size was exceeded. */
-	if (len - hlen > maxlen || buf->buf.bytesused == buf->buf.length) {
-		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
-		buf->state = UVC_BUF_STATE_DONE;
+	if ( dev_type != UVC_DEV_ISIGHT ){
+		if (len > maxlen) {
+			uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
+			buf->state = UVC_BUF_STATE_DONE;
+		}
+	}else{
+		if (len - hlen > maxlen || buf->buf.bytesused == buf->buf.length) {
+			uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
+			buf->state = UVC_BUF_STATE_DONE;
+		}
 	}
 
+
 	/* Mark the buffer as done if the EOF marker is set. */
 	if (hlen != 0 && (flags & UVC_STREAM_EOF && buf->buf.bytesused != 0)) {
 		uvc_trace(UVC_TRACE_FRAME, "Frame complete (EOF found).\n");
@@ -3628,8 +3658,15 @@
 			}
 		}
 
-		if (found)
+		if (found){
+			if (dev->udev->descriptor.idVendor == 0x05ac &&
+				dev->udev->descriptor.idProduct == 0x8300) {
+				dev_type = UVC_DEV_ISIGHT ;
+			}else{
+				dev_type = UVC_DEV_QCAM_FUSION ;
+			}
 			break;
+		}
 	}
 
 	if (!found) {




From martin_rubli at logitech.com  Sun Sep 17 05:55:06 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Sat, 16 Sep 2006 20:55:06 -0700
Subject: [Linux-uvc-devel] QuickCam Pro success on amd64 debian
In-Reply-To: <200609152007.30578.diaxen@free.fr>
References: <450AAFB8.6080806@cgv.tugraz.at> <450AB341.3090903@cgv.tugraz.at>
	<op.tfxhz6hhsttmjo@maya> <200609152007.30578.diaxen@free.fr>
Message-ID: <op.tfz7t4d8sttmjo@maya>

On Fri, 15 Sep 2006 11:07:30 -0700, Alexandre Becoulet <diaxen at free.fr>  
wrote:

> On Friday 15 September 2006 18:41, Martin Rubli wrote:
>
>> I hope one of these days I'll get
>> around to setting up a 64-bit system here ...
>
> Just to let you know, I originaly wrote the usb reset patch as a  
> workaround for the QCPro 5000 hang on my gentoo amd64 box.

Ok, I was thinking the 64-bit version of the USB stack might have a  
different timing that doesn't trigger the bug. Good to know anyway, thx!

Cheers,
Martin


From aidan at wires3.net  Mon Sep 18 08:59:11 2006
From: aidan at wires3.net (Aidan Walton)
Date: Mon, 18 Sep 2006 07:59:11 +0100
Subject: [Linux-uvc-devel] Logitech Fusion still no go.
In-Reply-To: <874pv8f6ej.fsf@florent.maison>
References: <1158316878.5478.14.camel@localhost>
	<450A8924.2040906@datkan.net> <1158332405.5340.2.camel@localhost>
	<87ejudf585.fsf@florent.maison> <1158340875.5340.33.camel@localhost>
	<874pv8f6ej.fsf@florent.maison>
Message-ID: <1158562751.5243.12.camel@localhost>

Thanks Florent,

As it turns out the problems have been solved as soon as I upgraded my
kernel to 2.6.16. I would have gone to 17 but I needed to mess with
nvidia drivers before I even get into X again and only the 2.6.16
versions of the nvidia drivers are readily available for the kernel
version I needed. That took me that best part of Sunday evening to get
sorted. 

When I finally had everything working under the new kernel, I found that
the packages available directly from the debian apt archive work just
fine. I down-loaded the source, compiled, inserted the module and off we
go.

Well, saying that, luvcview works just as expected. gnomemeeting works
if you fiddle with it long enough but the colour palette is way off.

The app that I really wanted to have working, wengo, does not seem to
work at all. 

Maybe someone has a view on this?

thanks for your advise. 
Aidan

On Sat, 2006-09-16 at 12:32 +0200, Florent Rougon wrote: 
> Aidan Walton <aidan.walton at airnetic.net> wrote:
> 
> > FATAL: Error inserting uvcvideo
> > (/lib/modules/2.6.15-1-686/usb/media/uvcvideo.ko): Invalid module
> > format.
> 
> I don't know how you got that. In your place, I'd check that I have a
> linux-headers package matching the kernel image package in use. Also,
> Linux 2.6.17 is in testing. Why don't you try that?
> 
> What happens exactly (error messages, etc.) if you:
> 
>   1? Remove any UVC driver currently installed on your system.
>   2? Install the kernel headers corresponding to the kernel image
>      you are running.
>   3? # dpkg -i $file.deb
>      where $file is
>      http://people.via.ecp.fr/~flo/debian/pool/main/linux-uvc-source/linux-uvc-source_0.0.0.svn20060803-1_all.deb
>   4? Follow the instructions in
>     /usr/share/doc/linux-uvc-source/README.Debian.
>   5? Test with ekiga or luvcview (assuming things went fine so far).
> 



From mchehab at infradead.org  Sun Sep 17 15:06:41 2006
From: mchehab at infradead.org (Mauro Carvalho Chehab)
Date: Sun, 17 Sep 2006 10:06:41 -0300
Subject: [Linux-uvc-devel] linux uvc and kernel 2.6.18
In-Reply-To: <200609162327.13322.laurent.pinchart@skynet.be>
References: <eeebcn$f8p$1@sea.gmane.org>
	<200609162327.13322.laurent.pinchart@skynet.be>
Message-ID: <1158498402.15120.184.camel@praia>

Hi, Laurent,

Em S?b, 2006-09-16 ?s 23:27 +0200, Laurent Pinchart escreveu:
> Hi Stefan,
> 
> > I am trying out linux-uvc with version 2.6.18-rc6-git3 and it reports
> > unknown symbols for video_get_drvdata and video_set_drvdata. Based on
> > another patch for this problem [1] I have fixed this for uvc. The fix works
> > for me but please bear in mind that I have little kernel programming
> > experience and thus it could be wrong.
> 
> Thanks for the patch. It looks overly complicated to me, and it seems that 
> video_get_drvdata/video_set_drvdata should not have been removed, but 
> modified to use dev_get_drvdata/dev_set_drvdata instead.
> 
> Mauro, could you have a look at that ?
Sure! Can you email it to me? I'm not subscribed on linux-uvc-devel.
> Why have those been removed ? I know 
> they were marked with OBSOLETE_OWNER, but that's becaused they accessed the 
> video_device structure's priv field, marked for removal.
> 
>         /* dev->driver_data will be used instead some day.
>          * Use the video_{get|set}_drvdata() helper functions,
>          * so the switch over will be transparent for you.
>          * Or use {pci|usb}_{get|set}_drvdata() directly. */
>         void *priv;
> 
> Shouldn't video_{get|set}_drvdata() have been kept ?
This stuff just add more complexity and makes the code more opaque, and
adds this additional pointer...

For most cases, it will just turn on something like this (from
cx88-video.c):

static ssize_t
video_read(struct file *file, char __user *data, size_t count, loff_t
*ppos)
{
        struct cx8800_fh *fh = file->private_data;


> Laurent Pinchart
Cheers, 
Mauro.



From laurent.pinchart at skynet.be  Mon Sep 18 14:50:00 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 18 Sep 2006 14:50:00 +0200
Subject: [Linux-uvc-devel] linux uvc and kernel 2.6.18
In-Reply-To: <1158498402.15120.184.camel@praia>
References: <eeebcn$f8p$1@sea.gmane.org>
	<200609162327.13322.laurent.pinchart@skynet.be>
	<1158498402.15120.184.camel@praia>
Message-ID: <200609181450.01070.laurent.pinchart@skynet.be>

Hi Mauro,

> > > I am trying out linux-uvc with version 2.6.18-rc6-git3 and it reports
> > > unknown symbols for video_get_drvdata and video_set_drvdata. Based on
> > > another patch for this problem [1] I have fixed this for uvc. The fix
> > > works for me but please bear in mind that I have little kernel
> > > programming experience and thus it could be wrong.
> >
> > Thanks for the patch. It looks overly complicated to me, and it seems
> > that video_get_drvdata/video_set_drvdata should not have been removed,
> > but modified to use dev_get_drvdata/dev_set_drvdata instead.
> >
> > Mauro, could you have a look at that ?
>
> Sure! Can you email it to me? I'm not subscribed on linux-uvc-devel.

You can find it at

https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/4e138fd2/attachment-0001.bin

> > Why have those been removed ? I know
> > they were marked with OBSOLETE_OWNER, but that's becaused they accessed
> > the video_device structure's priv field, marked for removal.
> >
> >         /* dev->driver_data will be used instead some day.
> >          * Use the video_{get|set}_drvdata() helper functions,
> >          * so the switch over will be transparent for you.
> >          * Or use {pci|usb}_{get|set}_drvdata() directly. */
> >         void *priv;
> >
> > Shouldn't video_{get|set}_drvdata() have been kept ?
>
> This stuff just add more complexity and makes the code more opaque, and
> adds this additional pointer...

I agree that video_device->priv should go. But it should be replaced by 
something else, namely dev->driver_data.

> For most cases, it will just turn on something like this (from
> cx88-video.c):
>
> static ssize_t
> video_read(struct file *file, char __user *data, size_t count, loff_t
> *ppos)
> {
>         struct cx8800_fh *fh = file->private_data;

This is an entirely different thing. file->private_data contains a *per-open* 
pointer to private data. video_{get|set}_drvdata was used to retrieve private 
data global to the device.

Have a look at the changes to em2820_v4l2_open in

http://www.linuxtv.org/downloads/video4linux/patches/2.6.14/v4l_813_replaced_obsolete_video_get_drvdata_and_video_set_drvdata.patch

Do you really want to require *every* video driver to maintain a global list 
of devices ? Think about overhead, locking issues, ...

Drivers should use file->private_data to point to *per-open* private data, not 
per-device data. per-device data should be stored in device->driver_data 
instead of video_device->priv (device->driver_data was made for exactly that 
purpose), and the helper functions video_{get|set}_drvdata should be kept, 
calling dev_{get|set}_drvdata instead of accessing video_device->priv.

Things are quite simple. Video devices are class devices, so per-device 
driver-private data is stored in device->driver_data, and per-open 
driver-private data is stored in file->file_private. That's how the driver 
model has been designed since the beginning of Linux 2.6. I can't imagine 
requiring *every* driver to maintain a global list of devices just to store 
private data.

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Sep 18 15:03:38 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 18 Sep 2006 15:03:38 +0200
Subject: [Linux-uvc-devel] UVC-gadget driver
In-Reply-To: <382379B34D08914EB0BA03DE9DA40560078048@lobster.zhwin.ch>
References: <382379B34D08914EB0BA03DE9DA40560078048@lobster.zhwin.ch>
Message-ID: <200609181503.39269.laurent.pinchart@skynet.be>

Hi Andy,

> I need an USB Video Class gadget driver. Upon making inquiries about if
> there is something existing I think I've to write it by myself. Is this
> information correct?

I think so. I haven't heard of any open-source gadget UVC driver before.

> At the moment I'm using a NET2280 PCI Card later I'll port the drivers to a
> TI Davinci-Chip. I studied several usb gadget drivers. Even so I studied
> the USB Video Class Specification and I had a look at your UVC driver.
>
> Now I've got some questions,
> a) What are the minimum settings in my driver that the uvc-driver (host)
> recognize my card as a UVC-Device?

You need the following features:

- UVC descriptors (obviously). A minimal device should have a camera input 
terminal and an streaming output terminal. You must have either an 
isochronous or bulk endpoint for data transfer.

- Streaming parameters probe/commit. You must implement the probe/commit 
negotiation as described in the UVC standard.

- Video data transfer. Your device must be able to stream video data, either 
in an uncompressed form (YUYV and NV12 are specified by the standard) or a 
compressed form (MJPEG, MPEG2, ...).

That's about it. The Linux UVC driver doesn't require anything else. You don't 
need an interrupt endpoint, you don't need a processing unit.

> b) Is it possible or does it make sense 
> to use your uvc driver as a base-driver? Or do you think the gadegt driver
> is totally different?

The gadget driver is totally different. You can use the Linux UVC driver to 
test the gadget device, but you won't be able to reuse much code, if any. The 
Linux UVC driver reads the UVC descriptors and sends requests to the device, 
while your driver must provide the descriptors (which can be hardcoded, at 
least partially), and respond to requests.

> c) Which points out of the specification does my driver has to cover at
> least to realize an elementary video stream?

See answer to point a) above.

> Thank you for your help,

You're welcome.

Best regards,

Laurent Pinchart


From mchehab at infradead.org  Mon Sep 18 16:05:35 2006
From: mchehab at infradead.org (Mauro Carvalho Chehab)
Date: Mon, 18 Sep 2006 11:05:35 -0300
Subject: [Linux-uvc-devel] linux uvc and kernel 2.6.18
In-Reply-To: <200609181450.01070.laurent.pinchart@skynet.be>
References: <eeebcn$f8p$1@sea.gmane.org>
	<200609162327.13322.laurent.pinchart@skynet.be>
	<1158498402.15120.184.camel@praia>
	<200609181450.01070.laurent.pinchart@skynet.be>
Message-ID: <1158588335.10211.9.camel@praia>

Em Seg, 2006-09-18 ?s 14:50 +0200, Laurent Pinchart escreveu:
> Hi Mauro,
> 
> > > > I am trying out linux-uvc with version 2.6.18-rc6-git3 and it reports
> > > > unknown symbols for video_get_drvdata and video_set_drvdata. Based on
> > > > another patch for this problem [1] I have fixed this for uvc. The fix
> > > > works for me but please bear in mind that I have little kernel
> > > > programming experience and thus it could be wrong.
> > >
> > > Thanks for the patch. It looks overly complicated to me, and it seems
> > > that video_get_drvdata/video_set_drvdata should not have been removed,
> > > but modified to use dev_get_drvdata/dev_set_drvdata instead.
> > >
> > > Mauro, could you have a look at that ?
> >
> > Sure! Can you email it to me? I'm not subscribed on linux-uvc-devel.
> 
> You can find it at
> 
> https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/4e138fd2/attachment-0001.bin
The patch looks sane to me.
> 
> > > Why have those been removed ? I know
> > > they were marked with OBSOLETE_OWNER, but that's becaused they accessed
> > > the video_device structure's priv field, marked for removal.
> > >
> > >         /* dev->driver_data will be used instead some day.
> > >          * Use the video_{get|set}_drvdata() helper functions,
> > >          * so the switch over will be transparent for you.
> > >          * Or use {pci|usb}_{get|set}_drvdata() directly. */
> > >         void *priv;
> > >
> > > Shouldn't video_{get|set}_drvdata() have been kept ?
> >
> > This stuff just add more complexity and makes the code more opaque, and
> > adds this additional pointer...
> 
> I agree that video_device->priv should go. But it should be replaced by 
> something else, namely dev->driver_data.
> 
> > For most cases, it will just turn on something like this (from
> > cx88-video.c):
> >
> > static ssize_t
> > video_read(struct file *file, char __user *data, size_t count, loff_t
> > *ppos)
> > {
> >         struct cx8800_fh *fh = file->private_data;
> 
> This is an entirely different thing. file->private_data contains a *per-open* 
> pointer to private data. video_{get|set}_drvdata was used to retrieve private 
> data global to the device.
> 
> Have a look at the changes to em2820_v4l2_open in
> 
> http://www.linuxtv.org/downloads/video4linux/patches/2.6.14/v4l_813_replaced_obsolete_video_get_drvdata_and_video_set_drvdata.patch
> 
> Do you really want to require *every* video driver to maintain a global list 
> of devices ? Think about overhead, locking issues, ...
> 
> Drivers should use file->private_data to point to *per-open* private data, not 
> per-device data. per-device data should be stored in device->driver_data 
> instead of video_device->priv (device->driver_data was made for exactly that 
> purpose), and the helper functions video_{get|set}_drvdata should be kept, 
> calling dev_{get|set}_drvdata instead of accessing video_device->priv.
> 
> Things are quite simple. Video devices are class devices, so per-device 
> driver-private data is stored in device->driver_data, and per-open 
> driver-private data is stored in file->file_private. That's how the driver 
> model has been designed since the beginning of Linux 2.6. I can't imagine 
> requiring *every* driver to maintain a global list of devices just to store 
> private data.
The obsolete get/set_drvdata were from the V4L1 time, where you cannot
open a device more than once. V4L2 API does require multiple opens, in
order that you can have one open to retrieve the streams, and another to
control the device. 

There is even more complex cases (probably not very useful for USB
devices, due to USB traffic, but already supported by the core PCI
drivers), where you are retrieving an stream to show at the screen, and
another to store at disks (maybe with even different parameters).

With such complex cases, you can't avoid having locks and per-open
driver data.

We might eventually replace this to a different model, but it would
require redesigning videodev.c and all other drivers. I don't intend to
do such core changes until we have all V4L1 drivers migrated to V4L2.
Then, we may re-discuss this and propose a better model.

Cheers, 
Mauro.



From laurent.pinchart at skynet.be  Mon Sep 18 16:53:37 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 18 Sep 2006 16:53:37 +0200
Subject: [Linux-uvc-devel] linux uvc and kernel 2.6.18
In-Reply-To: <1158588335.10211.9.camel@praia>
References: <eeebcn$f8p$1@sea.gmane.org>
	<200609181450.01070.laurent.pinchart@skynet.be>
	<1158588335.10211.9.camel@praia>
Message-ID: <200609181653.38282.laurent.pinchart@skynet.be>

> > > > > I am trying out linux-uvc with version 2.6.18-rc6-git3 and it
> > > > > reports unknown symbols for video_get_drvdata and
> > > > > video_set_drvdata. Based on another patch for this problem [1] I
> > > > > have fixed this for uvc. The fix works for me but please bear in
> > > > > mind that I have little kernel programming experience and thus it
> > > > > could be wrong.
> > > >
> > > > Thanks for the patch. It looks overly complicated to me, and it seems
> > > > that video_get_drvdata/video_set_drvdata should not have been
> > > > removed, but modified to use dev_get_drvdata/dev_set_drvdata instead.
> > > >
> > > > Mauro, could you have a look at that ?
> > >
> > > Sure! Can you email it to me? I'm not subscribed on linux-uvc-devel.
> >
> > You can find it at
> >
> > https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060915/4
> >e138fd2/attachment-0001.bin
>
> The patch looks sane to me.

Sane ? You must be kidding. Look at the overhead added to the open function. 
Do you expect all drivers to implement that ? Compare it to this, which 
doesn't require *any* change to the video drivers:

static inline void *video_get_drvdata(struct video_device *vdev)
{
        return dev_get_drvdata(vdev->dev);
}

static inline void video_set_drvdata(struct video_device *vdev, void *data)
{
        dev_set_drvdata(vdev->dev, data);
}

Doesn't that look saner ? Now, have a look at this:

static inline void *pci_get_drvdata (struct pci_dev *pdev)
{
        return dev_get_drvdata(&pdev->dev);
}

static inline void pci_set_drvdata (struct pci_dev *pdev, void *data)
{
        dev_set_drvdata(&pdev->dev, data);
}

Can't you see a similarity ?

[...]

> > > For most cases, it will just turn on something like this (from
> > > cx88-video.c):
> > >
> > > static ssize_t
> > > video_read(struct file *file, char __user *data, size_t count, loff_t
> > > *ppos)
> > > {
> > >         struct cx8800_fh *fh = file->private_data;
> >
> > This is an entirely different thing. file->private_data contains a
> > *per-open* pointer to private data. video_{get|set}_drvdata was used to
> > retrieve private data global to the device.
> >
> > Have a look at the changes to em2820_v4l2_open in
> >
> > http://www.linuxtv.org/downloads/video4linux/patches/2.6.14/v4l_813_repla
> >ced_obsolete_video_get_drvdata_and_video_set_drvdata.patch
> >
> > Do you really want to require *every* video driver to maintain a global
> > list of devices ? Think about overhead, locking issues, ...
> >
> > Drivers should use file->private_data to point to *per-open* private
> > data, not per-device data. per-device data should be stored in
> > device->driver_data instead of video_device->priv (device->driver_data
> > was made for exactly that purpose), and the helper functions
> > video_{get|set}_drvdata should be kept, calling dev_{get|set}_drvdata
> > instead of accessing video_device->priv.
> >
> > Things are quite simple. Video devices are class devices, so per-device
> > driver-private data is stored in device->driver_data, and per-open
> > driver-private data is stored in file->file_private. That's how the
> > driver model has been designed since the beginning of Linux 2.6. I can't
> > imagine requiring *every* driver to maintain a global list of devices
> > just to store private data.
>
> The obsolete get/set_drvdata were from the V4L1 time, where you cannot
> open a device more than once. V4L2 API does require multiple opens, in
> order that you can have one open to retrieve the streams, and another to
> control the device.

That's wrong. The video_device->priv field was from Linux 2.4 (and probably 
earlier), where there were no proper kernel objects implementation and where 
the device model we know today didn't exist. In 2.6 the device structures 
includes a driver_data field which is intended to replace all priv field in 
device structures (video_device and others). That's why the priv field in 
video_device was removed. Instead of dirty hacks forcing all drivers to keep 
a global list of private data for all the devices they handle, we must use 
dev_{get|set}_drvdata. This function should be encapsulated in video_{get|
set}_drvdata to make transition easier.

> There is even more complex cases (probably not very useful for USB
> devices, due to USB traffic, but already supported by the core PCI
> drivers), where you are retrieving an stream to show at the screen, and
> another to store at disks (maybe with even different parameters).
>
> With such complex cases, you can't avoid having locks and per-open
> driver data.

That doesn't matter. per-open data will go in file->private_data, per-device 
data in device->driver_data.

> We might eventually replace this to a different model, but it would
> require redesigning videodev.c and all other drivers. I don't intend to
> do such core changes until we have all V4L1 drivers migrated to V4L2.
> Then, we may re-discuss this and propose a better model.

I've never advocated nor mentioned any complete redesign of the video API. You 
doesn't seem to understand me.

Best regards,

Laurent Pinchart


From ripnetuk at gmail.com  Tue Sep 19 13:43:38 2006
From: ripnetuk at gmail.com (George Styles)
Date: Tue, 19 Sep 2006 12:43:38 +0100
Subject: [Linux-uvc-devel] Motion using UVC?
Message-ID: <9398f0eb0609190443w46248ccr309224c513938ee3@mail.gmail.com>

Hi,

Ive applied the usb-reset patch, and am currently testing if it fixes
the freezing issues.

Now im trying to get motion working.

It seems that Motion doesnt support v4l2 by default.

So I svn'ed out the latest sources, and applied the patch found at
http://www.lavrsen.dk/twiki/bin/view/Motion/VideoForLinuxTwoDiscussion

(I used the motion-v42L-svn.diff file - i couldnt get the last one to
apply, and the others seem older).

Now motion sees the camera :) but it segfaults :(

Has anyone got motion to work with linux-uvc? gdb seems able to tell
me where in the source the segfault occurrs, but I thought someone on
this list might already have it working.

thanks

George


From ripnetuk at gmail.com  Tue Sep 19 13:56:02 2006
From: ripnetuk at gmail.com (George Styles)
Date: Tue, 19 Sep 2006 12:56:02 +0100
Subject: [Linux-uvc-devel] Motion using UVC?
In-Reply-To: <9398f0eb0609190443w46248ccr309224c513938ee3@mail.gmail.com>
References: <9398f0eb0609190443w46248ccr309224c513938ee3@mail.gmail.com>
Message-ID: <9398f0eb0609190456o1b07613ds7b68ceb44e6877aa@mail.gmail.com>

Hi,

I got a little further... looking at the code in video.c (as pointed
to by gdb), it seems that when converting from one yuv format to
another, the buffer isnt big enough.

im guessing that it is because it was set in the .conf file to be
320x240 which my cam doesnt do, so the camera was taking much larger
pictures, but motion was expecting a 320x240...

will let u know progress
thx

g


On 9/19/06, George Styles <ripnetuk at gmail.com> wrote:
> Hi,
>
> Ive applied the usb-reset patch, and am currently testing if it fixes
> the freezing issues.
>
> Now im trying to get motion working.
>
> It seems that Motion doesnt support v4l2 by default.
>
> So I svn'ed out the latest sources, and applied the patch found at
> http://www.lavrsen.dk/twiki/bin/view/Motion/VideoForLinuxTwoDiscussion
>
> (I used the motion-v42L-svn.diff file - i couldnt get the last one to
> apply, and the others seem older).
>
> Now motion sees the camera :) but it segfaults :(
>
> Has anyone got motion to work with linux-uvc? gdb seems able to tell
> me where in the source the segfault occurrs, but I thought someone on
> this list might already have it working.
>
> thanks
>
> George
>


From luca.risolia at studio.unibo.it  Tue Sep 19 21:32:04 2006
From: luca.risolia at studio.unibo.it (Luca Risolia)
Date: Tue, 19 Sep 2006 21:32:04 +0200
Subject: [Linux-uvc-devel] Videoview,
	an application working with the UVC driver
Message-ID: <200609192132.05316.luca.risolia@studio.unibo.it>

Hello,

Here you can find "videoview", an application working with the UVC driver:

http://www.linux-projects.org

It's available as a binary-only program. The basic version can be downloaded
for free. The full-featured version, supporting audio/video recording and playback,
is available under payment (send an email to the author for details).

Best regards.


From martin_rubli at logitech.com  Wed Sep 20 05:27:38 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Tue, 19 Sep 2006 20:27:38 -0700
Subject: [Linux-uvc-devel] Videoview,
	an application working with the UVC driver
In-Reply-To: <200609192132.05316.luca.risolia@studio.unibo.it>
References: <200609192132.05316.luca.risolia@studio.unibo.it>
Message-ID: <op.tf5qkcj5sttmjo@maya>

Or, you could just wait a few weeks and use the open source software  
package I'm about to wrap up. Free, GPL, and can do at least as much. In  
the meantime, there's other ways to capture audio and video for free, one  
of them being GStreamer.

Luca's software has a history of not being compatible with all drivers and  
his drivers have a history of only working with his own application. So I  
suggest using other software.

Also, I don't think a developer list like this one is the right place to  
announce commercial software.

Cheers,
Martin


On Tue, 19 Sep 2006 12:32:04 -0700, Luca Risolia  
<luca.risolia at studio.unibo.it> wrote:

> Hello,
>
> Here you can find "videoview", an application working with the UVC  
> driver:
>
> http://www.linux-projects.org
>
> It's available as a binary-only program. The basic version can be  
> downloaded
> for free. The full-featured version, supporting audio/video recording  
> and playback,
> is available under payment (send an email to the author for details).
>
> Best regards.
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From diaxen at free.fr  Wed Sep 20 12:53:19 2006
From: diaxen at free.fr (Alexandre Becoulet)
Date: Wed, 20 Sep 2006 12:53:19 +0200
Subject: [Linux-uvc-devel] Videoview,
	an application working with the UVC driver
In-Reply-To: <op.tf5qkcj5sttmjo@maya>
References: <200609192132.05316.luca.risolia@studio.unibo.it>
	<op.tf5qkcj5sttmjo@maya>
Message-ID: <200609201253.19731.diaxen@free.fr>

On Wednesday 20 September 2006 05:27, Martin Rubli wrote:

> Also, I don't think a developer list like this one is the right place to
> announce commercial software.

I totally agree with you.

-- 
Alexandre


From luca.risolia at studio.unibo.it  Wed Sep 20 13:08:40 2006
From: luca.risolia at studio.unibo.it (Luca Risolia)
Date: Wed, 20 Sep 2006 13:08:40 +0200
Subject: [Linux-uvc-devel] Videoview,
	an application working with the UVC driver
In-Reply-To: <op.tf5qkcj5sttmjo@maya>
References: <200609192132.05316.luca.risolia@studio.unibo.it>
	<op.tf5qkcj5sttmjo@maya>
Message-ID: <200609201308.41208.luca.risolia@studio.unibo.it>

> Luca's software has a history of not being compatible with all drivers and  
> his drivers have a history of only working with his own application. So I  
> suggest using other software.

False. Many of Luca's V4L2 drivers have been being present in the Linux
kernel for years.
This implies that they are open source and you can develop your own
application as well.

> Also, I don't think a developer list like this one is the right place to  
> announce commercial software.

I only mentioned one application for testing the driver. I do not see
anything bad in doing this in a developer list. If you do not like
the fact that the full-featured version is commercial, I'd like to only
say that that is usually available for a fee and the incoming is also
used to maintain the site or to buy new hardware I need to test
the open source drivers that I release to the community.

Regards


> On Tue, 19 Sep 2006 12:32:04 -0700, Luca Risolia  
> <luca.risolia at studio.unibo.it> wrote:
> 
> > Hello,
> >
> > Here you can find "videoview", an application working with the UVC  
> > driver:
> >
> > http://www.linux-projects.org
> >
> > It's available as a binary-only program. The basic version can be  
> > downloaded
> > for free. The full-featured version, supporting audio/video recording  
> > and playback,
> > is available under payment (send an email to the author for details).
> >
> > Best regards.
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
> 


From dancer at netfort.gr.jp  Sun Sep 24 05:07:44 2006
From: dancer at netfort.gr.jp (Junichi Uekawa)
Date: Sun, 24 Sep 2006 12:07:44 +0900
Subject: [Linux-uvc-devel] iSight / logitech co-existing patch
In-Reply-To: <87fyeidrcw.dancerj%dancer@netfort.gr.jp>
References: <4511FED3.4090004@rsbs.anu.edu.au>
	<87fyeidrcw.dancerj%dancer@netfort.gr.jp>
Message-ID: <8764fedksf.dancerj%dancer@netfort.gr.jp>

Hi,

The following is the patch applied to the Debian version to make logitech and iSight to co-exist.

For the firmware loading, I'm thinking of using extract.c to extract
the firmware data to /usr/lib/firmware, and then using firmware loader
infrastructure afterwards to load the firmware, but I have not yet
gotten around to doing it, yet.



-------------- next part --------------
#! /bin/sh /usr/share/dpatch/dpatch-run
## 07_with_isight.dpatch Nobuhiro Iwamatsu <hemamu at t-base.ne.jp>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Workaround to get iSight and normal UVC devices function.

@DPATCH@
diff -urNad linux-uvc~/uvcvideo.c linux-uvc/uvcvideo.c
--- linux-uvc~/uvcvideo.c	2006-09-24 11:56:16.401464775 +0900
+++ linux-uvc/uvcvideo.c	2006-09-24 11:56:27.654754015 +0900
@@ -290,6 +290,11 @@
 	UVC_BUF_STATE_ERROR      = 4,
 };
 
+enum uvc_dev_type{
+	UVC_DEV_ISIGHT          = 0 ,   /* Apple iSight */
+	UVC_DEV_QCAM_FUSION     = 1 ,   /* Qcam Fusion  */
+};
+
 struct uvc_buffer {
 	unsigned int size;
 	unsigned long vma_use_count;
@@ -381,6 +386,7 @@
 
 static void uvc_delete(struct kref *kref);
 
+static int dev_type ;/* device type */
 /* ------------------------------------------------------------------------
  * Control, formats, ...
  */
@@ -1295,14 +1301,23 @@
 	 * - bHeaderLength value must be at least 2 bytes (see above)
 	 * - bHeaderLength value can't be larger than the packet size.
 	 */
-	if ((len >= 14 && memcmp (&data[3], hdr, 12) == 0) ||
-	    (len >= 13 && memcmp (&data[2], hdr, 12) == 0)) {
-		uvc_trace(UVC_TRACE_FRAME, "Detecting new header");
-		hlen = (data[3] == 0x11) ? data[1] : data[0];
-		if (hlen > len - 1 || hlen < 2)
+	if( dev_type != UVC_DEV_ISIGHT ){
+		if (len < 2 || data[0] < 2 || data[0] > len){
 			return -EINVAL;
-		flags = (data[3] == 0x11) ? data[2] : data[1];
-		is_header = 1;
+		}
+
+		hlen  = data[0];
+		flags = data[1];
+	}else{
+		if ((len >= 14 && memcmp (&data[3], hdr, 12) == 0) ||
+	    	(len >= 13 && memcmp (&data[2], hdr, 12) == 0)) {
+			uvc_trace(UVC_TRACE_FRAME, "Detecting new header");
+			hlen = (data[3] == 0x11) ? data[1] : data[0];
+			if (hlen > len - 1 || hlen < 2)
+				return -EINVAL;
+			flags = (data[3] == 0x11) ? data[2] : data[1];
+			is_header = 1;
+		}
 	}
 
 	/* Skip payloads marked with the error bit ("error frames"). */
@@ -1370,7 +1385,14 @@
 	/* Copy the video data to the buffer. */
 	len -= hlen;
 	maxlen = buf->buf.length - buf->buf.bytesused;
-	if (!is_header) { /* we skip headers, they do not contain data */
+
+	if(dev_type != UVC_DEV_ISIGHT){
+		mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
+		nbytes = min(len, maxlen);
+		memcpy(mem, data + hlen, nbytes);
+		buf->buf.bytesused += nbytes;
+	}else if((dev_type == UVC_DEV_ISIGHT)&& (!is_header)) {
+		/* we skip headers, they do not contain data */
 		mem = queue->mem + buf->buf.m.offset + buf->buf.bytesused;
 		nbytes = min(len - hlen, maxlen);
 		memmove(mem, data + hlen, nbytes);
@@ -1378,11 +1400,19 @@
 	}
 
 	/* Drop the current frame if the buffer size was exceeded. */
-	if (len - hlen > maxlen || buf->buf.bytesused == buf->buf.length) {
-		uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
-		buf->state = UVC_BUF_STATE_DONE;
+	if ( dev_type != UVC_DEV_ISIGHT ){
+		if (len > maxlen) {
+			uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
+			buf->state = UVC_BUF_STATE_DONE;
+		}
+	}else{
+		if (len - hlen > maxlen || buf->buf.bytesused == buf->buf.length) {
+			uvc_trace(UVC_TRACE_FRAME, "Frame complete (overflow).\n");
+			buf->state = UVC_BUF_STATE_DONE;
+		}
 	}
 
+
 	/* Mark the buffer as done if the EOF marker is set. */
 	if (hlen != 0 && (flags & UVC_STREAM_EOF && buf->buf.bytesused != 0)) {
 		uvc_trace(UVC_TRACE_FRAME, "Frame complete (EOF found).\n");
@@ -3649,8 +3679,15 @@
 			}
 		}
 
-		if (found)
+		if (found){
+			if (dev->udev->descriptor.idVendor == 0x05ac &&
+				dev->udev->descriptor.idProduct == 0x8501) {
+				dev_type = UVC_DEV_ISIGHT ;
+			}else{
+				dev_type = UVC_DEV_QCAM_FUSION ;
+			}
 			break;
+		}
 	}
 
 	if (!found) {

From mxhaard at magic.fr  Mon Sep 25 18:19:36 2006
From: mxhaard at magic.fr (Michel Xhaard)
Date: Mon, 25 Sep 2006 18:19:36 +0200
Subject: [Linux-uvc-devel] luvcview update :)
Message-ID: <200609251819.36727.mxhaard@magic.fr>

Hi all :)
Luvcview now support:
	uvc Sonix webcam ( only YUYV tested MJPEG should)
	50 60Hz Noflicker control
	record avi file
and the v4l2 API enhancements from Martin Rubli :)
http://www.linuxtv.org/v4lwiki/index.php/Discussion_of_API_enhancements
the package is here:
http://mxhaard.free.fr/spca50x/Investigation/uvc/luvcview-20060920.tar.gz
Best regards
Michel Xhaard
http://mxhaard.free.fr


From gem at rellim.com  Mon Sep 25 19:13:30 2006
From: gem at rellim.com (Gary E. Miller)
Date: Mon, 25 Sep 2006 10:13:30 -0700 (PDT)
Subject: [Linux-uvc-devel] luvcview update :)
In-Reply-To: <200609251819.36727.mxhaard@magic.fr>
References: <200609251819.36727.mxhaard@magic.fr>
Message-ID: <Pine.LNX.4.64.0609251004120.12879@catbert.rellim.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Yo Michel!

On Mon, 25 Sep 2006, Michel Xhaard wrote:

> Luvcview now support:

The update is good news.

But when I try to compile on kernel 2.6.18 I get this:

gcc -DUSE_SDL -O2 -DLINUX -DVERSION=\"0.1.7\" -I/usr/src/modules/linux-uvc -I/usr/local/include/SDL -D_GNU_SOURCE=1 -D_REENTRANT  -DUSE_SDL -O2 -DLINUX -DVERSION=\"0.1.7\" -I/usr/src/modules/linux-uvc -I/usr/local/include/SDL -D_GNU_SOURCE=1 -D_REENTRANT   -c -o luvcview.o luvcview.c
In file included from luvcview.c:46:
v4l2uvc.h:54: error: field `cap' has incomplete type
v4l2uvc.h:55: error: field `fmt' has incomplete type
v4l2uvc.h:56: error: field `buf' has incomplete type
v4l2uvc.h:57: error: field `rb' has incomplete type
luvcview.c: In function `main':
luvcview.c:216: error: `V4L2_PIX_FMT_MJPEG' undeclared (first use in this function)
luvcview.c:216: error: (Each undeclared identifier is reported only once
luvcview.c:216: error: for each function it appears in.)
luvcview.c:261: error: `V4L2_PIX_FMT_YUYV' undeclared (first use in this function)

[...]

Not sure what I did wrong, but if I add this:

#include <linux/videodev2.h>

To v4l2uvc.h and v4l2_enumfrmfmt.h then it compiles and runs.  Surely you
will want a different solution.

Love the -L option!


RGDS
GARY
- ---------------------------------------------------------------------------
Gary E. Miller Rellim 20340 Empire Blvd, Suite E-3, Bend, OR 97701
	gem at rellim.com  Tel:+1(541)382-8588

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)

iD4DBQFFGA498KZibdeR3qURAjKxAJY7hEYYmdDfnt4fiyPBtcFFHkQ4AJsHSFUl
tzC8Ejutv/c2HQCy/3L6cw==
=1ga9
-----END PGP SIGNATURE-----



From laurent.pinchart at skynet.be  Mon Sep 25 20:42:41 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 25 Sep 2006 20:42:41 +0200
Subject: [Linux-uvc-devel] Motion using UVC?
In-Reply-To: <9398f0eb0609190456o1b07613ds7b68ceb44e6877aa@mail.gmail.com>
References: <9398f0eb0609190443w46248ccr309224c513938ee3@mail.gmail.com>
	<9398f0eb0609190456o1b07613ds7b68ceb44e6877aa@mail.gmail.com>
Message-ID: <200609252042.42175.laurent.pinchart@skynet.be>

Hi George,

> Hi,
>
> I got a little further... looking at the code in video.c (as pointed
> to by gdb), it seems that when converting from one yuv format to
> another, the buffer isnt big enough.
>
> im guessing that it is because it was set in the .conf file to be
> 320x240 which my cam doesnt do, so the camera was taking much larger
> pictures, but motion was expecting a 320x240...
>
> will let u know progress
> thx

Any progress ? :-)

Laurent Pinchart


From ripnetuk at gmail.com  Mon Sep 25 21:04:38 2006
From: ripnetuk at gmail.com (George Styles)
Date: Mon, 25 Sep 2006 20:04:38 +0100
Subject: [Linux-uvc-devel] Motion using UVC?
In-Reply-To: <200609252042.42175.laurent.pinchart@skynet.be>
References: <9398f0eb0609190443w46248ccr309224c513938ee3@mail.gmail.com>
	<9398f0eb0609190456o1b07613ds7b68ceb44e6877aa@mail.gmail.com>
	<200609252042.42175.laurent.pinchart@skynet.be>
Message-ID: <9398f0eb0609251204s771934efq3b22abeaf5e712ff@mail.gmail.com>

On 9/25/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> Hi George,
>
> > Hi,
> >
> > I got a little further... looking at the code in video.c (as pointed
> > to by gdb), it seems that when converting from one yuv format to
> > another, the buffer isnt big enough.
> >
> > im guessing that it is because it was set in the .conf file to be
> > 320x240 which my cam doesnt do, so the camera was taking much larger
> > pictures, but motion was expecting a 320x240...
> >
> > will let u know progress
> > thx
>
> Any progress ? :-)
>
> Laurent Pinchart
>

Yes, it all works nicely. There is some 'wierdness' with broken
pictures on occasions (eg, bottom 5% shifted a few 10's of pixels to
the right), but its a vast improvement on just saving pictures every
0.5s

thanks

g


From tante at emptiness.de  Tue Sep 26 13:34:35 2006
From: tante at emptiness.de (=?ISO-8859-1?Q?J=FCrgen_Geuter?=)
Date: Tue, 26 Sep 2006 13:34:35 +0200
Subject: [Linux-uvc-devel] luvcview update :)
In-Reply-To: <200609251819.36727.mxhaard@magic.fr>
References: <200609251819.36727.mxhaard@magic.fr>
Message-ID: <4519104B.4030402@emptiness.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Michel Xhaard wrote:

> Luvcview now support:
> 	uvc Sonix webcam ( only YUYV tested MJPEG should)
> 	50 60Hz Noflicker control
> 	record avi file
> and the v4l2 API enhancements from Martin Rubli :)
> http://www.linuxtv.org/v4lwiki/index.php/Discussion_of_API_enhancements

Ebuild for the Gentoo folks can be found at
http://www.the-gay-bar.com/ebuilds/media-video/luvcview/

J?rgen Geuter
- --
ICQ #81510866 - http://the-gay-bar.com - MSN thanatos at gambit.ath.cx
"Governments can be useful to the governed only so long as inherent
tendencies toward tyranny are restrained."
Frank Herbert, 'God Emperor Of Dune'
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFFGRBLrAehKXTNZasRAs9cAJ9m4QHTc5kHYNVp/GjYrKvUv+44HACfTyKo
Yz/vLDLc2q4219P6VfrVyUM=
=XzjG
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Tue Sep 26 23:45:43 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 26 Sep 2006 23:45:43 +0200
Subject: [Linux-uvc-devel] iSight / logitech co-existing patch
In-Reply-To: <8764fedksf.dancerj%dancer@netfort.gr.jp>
References: <4511FED3.4090004@rsbs.anu.edu.au>
	<87fyeidrcw.dancerj%dancer@netfort.gr.jp>
	<8764fedksf.dancerj%dancer@netfort.gr.jp>
Message-ID: <200609262345.46628.laurent.pinchart@skynet.be>

Hi Junichi,

> The following is the patch applied to the Debian version to make logitech
> and iSight to co-exist.
>
> For the firmware loading, I'm thinking of using extract.c to extract
> the firmware data to /usr/lib/firmware, and then using firmware loader
> infrastructure afterwards to load the firmware, but I have not yet
> gotten around to doing it, yet.

Thanks for the patch. I can't apply it now, as the driver is going under 
fundamental changes, but I'll look at it in a week or two.

What bothers me is that the Mac firmware is very buggy. I'd like to address 
the issue with Apple first, to see if they can't fix it.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Sep 29 16:12:52 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 29 Sep 2006 16:12:52 +0200
Subject: [Linux-uvc-devel] [SVN] Branch announcement
Message-ID: <200609291612.52643.laurent.pinchart@skynet.be>

Hi everybody,

I'm happy to announce that the new development branch, called 'split', is 
available in the linux-uvc repository.

- What's new in there ?

The driver has been split into multiple files, making it easier to develop, 
debug and maintain the code.

Control handling has been cleaned up, and the basic infrastructure to support 
more device private controls (defined through extension units) is there. The 
number of UVC compatible devices is expected to grow, and each new device 
might come with some private controls. Modifying the driver every time a new 
control is added might become quite an issue, so I'm working on a way to add 
support for new controls at runtime.

Multiple open is now supported. The first application to call a 
streaming-related ioctl (VIDIOC_S_INPUT, VIDIOC_S_FMT, VIDIOC_TRY_FMT, 
VIDIOC_S_PARM, VIDIOC_REQBUFS) will have exclusive access to streaming 
functions until the device handle is closed. Other applications will still be 
able to query the driver and set controls.

The new extended control API has been implemented. You can now get and/or set 
multiple controls at once. Please remember that the driver is still in a beta 
stage, which means the control IDs might change without notice.

- How to get it ?

Checkout the split branch

svn co svn://svn.berlios.de/linux-uvc/linux-uvc/branches/split

The driver should compile against kernels up to 2.6.18.

Please don't report the warning about uvc_status_complete being defined 
multiple times, I will fix that :-)

- Who should try it ?

Everybody ! I'd like to get as much feedback as possible before merging the 
split branch into the trunk, and submitting the driver to the kernel tree.

Before submitting bug reports, make sure you recompile applications which 
depends on private control IDs and/or private ioctls against the split 
branch.

The driver includes its own version of the extended control ioctls. If you are 
running a kernel in which those ioctls are already included (v4l git tree), 
you will have to remove them from uvc_compat.h.

Happy testing !

Laurent Pinchart


From mxhaard at magic.fr  Fri Sep 29 18:18:56 2006
From: mxhaard at magic.fr (Michel Xhaard)
Date: Fri, 29 Sep 2006 18:18:56 +0200
Subject: [Linux-uvc-devel] [SVN] Branch announcement
In-Reply-To: <200609291612.52643.laurent.pinchart@skynet.be>
References: <200609291612.52643.laurent.pinchart@skynet.be>
Message-ID: <200609291818.56603.mxhaard@magic.fr>

Le Vendredi 29 Septembre 2006 16:12, Laurent Pinchart a ?crit?:
> Hi everybody,
>
> I'm happy to announce that the new development branch, called 'split', is
> available in the linux-uvc repository.
>
> - What's new in there ?
>
> The driver has been split into multiple files, making it easier to develop,
> debug and maintain the code.
>
> Control handling has been cleaned up, and the basic infrastructure to
> support more device private controls (defined through extension units) is
> there. The number of UVC compatible devices is expected to grow, and each
> new device might come with some private controls. Modifying the driver
> every time a new control is added might become quite an issue, so I'm
> working on a way to add support for new controls at runtime.
>
> Multiple open is now supported. The first application to call a
> streaming-related ioctl (VIDIOC_S_INPUT, VIDIOC_S_FMT, VIDIOC_TRY_FMT,
> VIDIOC_S_PARM, VIDIOC_REQBUFS) will have exclusive access to streaming
> functions until the device handle is closed. Other applications will still
> be able to query the driver and set controls.
>
> The new extended control API has been implemented. You can now get and/or
> set multiple controls at once. Please remember that the driver is still in
> a beta stage, which means the control IDs might change without notice.
>
> - How to get it ?
>
> Checkout the split branch
>
> svn co svn://svn.berlios.de/linux-uvc/linux-uvc/branches/split
>
> The driver should compile against kernels up to 2.6.18.
>
> Please don't report the warning about uvc_status_complete being defined
> multiple times, I will fix that :-)
>
> - Who should try it ?
>
> Everybody ! I'd like to get as much feedback as possible before merging the
> split branch into the trunk, and submitting the driver to the kernel tree.
>
> Before submitting bug reports, make sure you recompile applications which
> depends on private control IDs and/or private ioctls against the split
> branch.
>
> The driver includes its own version of the extended control ioctls. If you
> are running a kernel in which those ioctls are already included (v4l git
> tree), you will have to remove them from uvc_compat.h.
>
> Happy testing !
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
Laurent, 
In attachement a patch from /split rev 58 adding 5 logitech webcams :) the usb 
id and logitech code name was find in a windoze .inf file. If you need it 
tell me. Martin can you double check :)
Best regards
-- 
Michel Xhaard
http://mxhaard.free.fr
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc_driver.patch
Type: text/x-diff
Size: 1717 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060929/a73d7631/attachment.patch>

From martin_rubli at logitech.com  Fri Sep 29 18:51:44 2006
From: martin_rubli at logitech.com (Martin Rubli)
Date: Fri, 29 Sep 2006 09:51:44 -0700
Subject: [Linux-uvc-devel] [SVN] Branch announcement
In-Reply-To: <200609291818.56603.mxhaard@magic.fr>
References: <200609291612.52643.laurent.pinchart@skynet.be>
	<200609291818.56603.mxhaard@magic.fr>
Message-ID: <op.tgnfsi1vsttmjo@maya>

Michel,

That patch is not really necessary since all these devices are generic UVC  
devices and are recognized by the driver right away. That's the beauty of  
UVC. :-) The IDs currently hardcoded are only there because _those_  
devices do not identify themselves as UVC devices but vendor-specific  
devices by default.

Cheers,
Martin


On Fri, 29 Sep 2006 09:18:56 -0700, Michel Xhaard <mxhaard at magic.fr> wrote:

> Le Vendredi 29 Septembre 2006 16:12, Laurent Pinchart a ?crit?:
>> Hi everybody,
>>
>> I'm happy to announce that the new development branch, called 'split',  
>> is
>> available in the linux-uvc repository.
>>
>> - What's new in there ?
>>
>> The driver has been split into multiple files, making it easier to  
>> develop,
>> debug and maintain the code.
>>
>> Control handling has been cleaned up, and the basic infrastructure to
>> support more device private controls (defined through extension units)  
>> is
>> there. The number of UVC compatible devices is expected to grow, and  
>> each
>> new device might come with some private controls. Modifying the driver
>> every time a new control is added might become quite an issue, so I'm
>> working on a way to add support for new controls at runtime.
>>
>> Multiple open is now supported. The first application to call a
>> streaming-related ioctl (VIDIOC_S_INPUT, VIDIOC_S_FMT, VIDIOC_TRY_FMT,
>> VIDIOC_S_PARM, VIDIOC_REQBUFS) will have exclusive access to streaming
>> functions until the device handle is closed. Other applications will  
>> still
>> be able to query the driver and set controls.
>>
>> The new extended control API has been implemented. You can now get  
>> and/or
>> set multiple controls at once. Please remember that the driver is still  
>> in
>> a beta stage, which means the control IDs might change without notice.
>>
>> - How to get it ?
>>
>> Checkout the split branch
>>
>> svn co svn://svn.berlios.de/linux-uvc/linux-uvc/branches/split
>>
>> The driver should compile against kernels up to 2.6.18.
>>
>> Please don't report the warning about uvc_status_complete being defined
>> multiple times, I will fix that :-)
>>
>> - Who should try it ?
>>
>> Everybody ! I'd like to get as much feedback as possible before merging  
>> the
>> split branch into the trunk, and submitting the driver to the kernel  
>> tree.
>>
>> Before submitting bug reports, make sure you recompile applications  
>> which
>> depends on private control IDs and/or private ioctls against the split
>> branch.
>>
>> The driver includes its own version of the extended control ioctls. If  
>> you
>> are running a kernel in which those ioctls are already included (v4l git
>> tree), you will have to remove them from uvc_compat.h.
>>
>> Happy testing !
>>
>> Laurent Pinchart
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> Laurent,
> In attachement a patch from /split rev 58 adding 5 logitech webcams :)  
> the usb
> id and logitech code name was find in a windoze .inf file. If you need it
> tell me. Martin can you double check :)
> Best regards




From mxhaard at magic.fr  Fri Sep 29 18:51:49 2006
From: mxhaard at magic.fr (Michel Xhaard)
Date: Fri, 29 Sep 2006 18:51:49 +0200
Subject: [Linux-uvc-devel] [SVN] Branch announcement
In-Reply-To: <op.tgnfsi1vsttmjo@maya>
References: <200609291612.52643.laurent.pinchart@skynet.be>
	<200609291818.56603.mxhaard@magic.fr> <op.tgnfsi1vsttmjo@maya>
Message-ID: <200609291851.49169.mxhaard@magic.fr>

Le Vendredi 29 Septembre 2006 18:51, Martin Rubli a ?crit?:
> Michel,
>
> That patch is not really necessary since all these devices are generic UVC
> devices and are recognized by the driver right away. That's the beauty of
> UVC. :-) The IDs currently hardcoded are only there because _those_
> devices do not identify themselves as UVC devices but vendor-specific
> devices by default.
>
> Cheers,
> Martin

Well a good new. Just for my knowledge what is the commercial name of "Wonder 
Woman" :)

> On Fri, 29 Sep 2006 09:18:56 -0700, Michel Xhaard <mxhaard at magic.fr> wrote:
> > Le Vendredi 29 Septembre 2006 16:12, Laurent Pinchart a ?crit?:
> >> Hi everybody,
> >>
> >> I'm happy to announce that the new development branch, called 'split',
> >> is
> >> available in the linux-uvc repository.
> >>
> >> - What's new in there ?
> >>
> >> The driver has been split into multiple files, making it easier to
> >> develop,
> >> debug and maintain the code.
> >>
> >> Control handling has been cleaned up, and the basic infrastructure to
> >> support more device private controls (defined through extension units)
> >> is
> >> there. The number of UVC compatible devices is expected to grow, and
> >> each
> >> new device might come with some private controls. Modifying the driver
> >> every time a new control is added might become quite an issue, so I'm
> >> working on a way to add support for new controls at runtime.
> >>
> >> Multiple open is now supported. The first application to call a
> >> streaming-related ioctl (VIDIOC_S_INPUT, VIDIOC_S_FMT, VIDIOC_TRY_FMT,
> >> VIDIOC_S_PARM, VIDIOC_REQBUFS) will have exclusive access to streaming
> >> functions until the device handle is closed. Other applications will
> >> still
> >> be able to query the driver and set controls.
> >>
> >> The new extended control API has been implemented. You can now get
> >> and/or
> >> set multiple controls at once. Please remember that the driver is still
> >> in
> >> a beta stage, which means the control IDs might change without notice.
> >>
> >> - How to get it ?
> >>
> >> Checkout the split branch
> >>
> >> svn co svn://svn.berlios.de/linux-uvc/linux-uvc/branches/split
> >>
> >> The driver should compile against kernels up to 2.6.18.
> >>
> >> Please don't report the warning about uvc_status_complete being defined
> >> multiple times, I will fix that :-)
> >>
> >> - Who should try it ?
> >>
> >> Everybody ! I'd like to get as much feedback as possible before merging
> >> the
> >> split branch into the trunk, and submitting the driver to the kernel
> >> tree.
> >>
> >> Before submitting bug reports, make sure you recompile applications
> >> which
> >> depends on private control IDs and/or private ioctls against the split
> >> branch.
> >>
> >> The driver includes its own version of the extended control ioctls. If
> >> you
> >> are running a kernel in which those ioctls are already included (v4l git
> >> tree), you will have to remove them from uvc_compat.h.
> >>
> >> Happy testing !
> >>
> >> Laurent Pinchart
> >> _______________________________________________
> >> Linux-uvc-devel mailing list
> >> Linux-uvc-devel at lists.berlios.de
> >> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
> > Laurent,
> > In attachement a patch from /split rev 58 adding 5 logitech webcams :)
> > the usb
> > id and logitech code name was find in a windoze .inf file. If you need it
> > tell me. Martin can you double check :)
> > Best regards
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel

-- 
Michel Xhaard
http://mxhaard.free.fr


From f.rougon at free.fr  Sat Sep 30 14:20:40 2006
From: f.rougon at free.fr (Florent Rougon)
Date: Sat, 30 Sep 2006 14:20:40 +0200
Subject: [Linux-uvc-devel] [SVN] Branch announcement
In-Reply-To: <200609291612.52643.laurent.pinchart@skynet.be> (Laurent
	Pinchart's message of "Fri, 29 Sep 2006 16:12:52 +0200")
References: <200609291612.52643.laurent.pinchart@skynet.be>
Message-ID: <878xk1y293.fsf@florent.maison>

Hi,

Laurent Pinchart <laurent.pinchart at skynet.be> wrote:

> I'm happy to announce that the new development branch, called 'split', is 
> available in the linux-uvc repository.

[...]

> - Who should try it ?
>
> Everybody ! I'd like to get as much feedback as possible before merging the 
> split branch into the trunk, and submitting the driver to the kernel tree.

OK, I tested the new branch with ekiga and luvcview (both 20060207 and
20060920) and haven't encountered any problem so far (but these tests
were relatively short; no occasion to experience the problem with the
USB reset). This was with a Logitech QuickCam Pro 5000.

BTW: I made the "split" branch of this driver available as a Debian
     package, called linux-uvc-split-source and found at:

     deb http://people.via.ecp.fr/~flo/debian sarge main contrib non-free
     deb-src http://people.via.ecp.fr/~flo/debian sarge main contrib non-free

so other people can test easily.

Thanks for your work!

-- 
Florent


