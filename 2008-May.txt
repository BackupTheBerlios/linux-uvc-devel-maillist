From expose at luftgetrock.net  Thu May  1 10:41:01 2008
From: expose at luftgetrock.net (Daniel Herzog)
Date: Thu, 1 May 2008 10:41:01 +0200
Subject: [Linux-uvc-devel] Questions on Makefile
Message-ID: <200805011041.01088.expose@luftgetrock.net>

Hi Everybody,

First of all, I'm new to Makefiles, so the following might be all wrong :-)
The makefile contains
	"depmod -ae $(KERNEL_VERSION)"
My "man depmod" says:
	-a --all		Probe all modules.
				This option is enabled by default,
				if no file names are given in command-line.
	-e --errsyms	When combined with the -F option, [...]

So one could leave out the -e option, and if all depmod versions behave the 
same here also the -a option. Right?

Is it needed to manually run depmod anyway if using a recent kernels 
modules_install?

Same thing above where it says
	cd $(KERNEL_DIR) && MAKE -C $(KERNEL_DIR)
Why go to KERNEL_DIR twice?

The SUBDIRS variable is used. In the Makefile of kernel version 2.6.25 it says 
that it would be old syntax - i don't know how old and wether it is still 
needed to support previous kernel versions, though.



Sincerely,

Daniel


From laurent.pinchart at skynet.be  Thu May  1 23:29:34 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 1 May 2008 23:29:34 +0200
Subject: [Linux-uvc-devel] creative live! cam optia AF at 30 fps?
In-Reply-To: <1209218016.13944.113.camel@achille>
References: <1209134740.13944.30.camel@achille>
	<1209218016.13944.113.camel@achille>
Message-ID: <200805012329.34695.laurent.pinchart@skynet.be>

Hi Yannick,

On Saturday 26 April 2008, yannick wrote:
> I did more testing:
> $ modinfo uvcvideo
> filename:      
> /lib/modules/2.6.24-16-generic/ubuntu/media/usbvideo/uvcvideo.ko version:  
>      SVN r205
>
> $ uvcdynctrl -V
> uvcdynctrl 0.2 (SVN Revision : 21)
>
> $ uvcdynctrl -cv
> Listing available controls for device video0:
>   Focus, Auto
>     ID      : 0x00000013,
>     Type    : Boolean,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 70 .. 2875, step size: 187 ],
>     Default : 1
>   Focus (absolute)
>     ID      : 0x00000014,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 70 .. 2875, step size: 187 ],
>     Default : 70
>   Exposure (Absolute)
>     ID      : 0x00000011,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 100 .. 2400, step size: 100 ],
>     Default : 300
>   Exposure, Auto
>     ID      : 0x0000000f,
>     Type    : Choice,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : { 'Manual Mode'[0], 'Auto Mode'[1], 'Shutter Priority
> Mode'[2], 'Aperture Priority Mode'[3] },
>     Default : 3
>   Backlight Compensation
>     ID      : 0x0000000c,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 0 .. 1, step size: 1 ],
>     Default : 0
>   Sharpness
>     ID      : 0x00000007,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 0 .. 9, step size: 1 ],
>     Default : 0
>   White Balance Temperature
>     ID      : 0x00000008,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 2800 .. 6500, step size: 1850 ],
>     Default : 6500
>   Power Line Frequency
>     ID      : 0x0000000d,
>     Type    : Choice,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : { 'Disabled'[0], '50 Hz'[1], '60 Hz'[2] },
>     Default : 2
>   Gamma
>     ID      : 0x00000006,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 25 .. 125, step size: 25 ],
>     Default : 50
>   White Balance Temperature, Auto
>     ID      : 0x00000009,
>     Type    : Boolean,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ -30 .. 30, step size: 1 ],
>     Default : 1
>   Hue
>     ID      : 0x00000005,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ -30 .. 30, step size: 1 ],
>     Default : 0
>   Saturation
>     ID      : 0x00000004,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 0 .. 19, step size: 1 ],
>     Default : 5
>   Contrast
>     ID      : 0x00000002,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 0 .. 3, step size: 1 ],
>     Default : 1
>   Brightness
>     ID      : 0x00000001,
>     Type    : Dword,
>     Flags   : { CAN_READ, CAN_WRITE },
>     Values  : [ 0 .. 31, step size: 1 ],
>     Default : 0
>
> $ uvcdynctrl -g 'Exposure, Auto'
> 3
>
> $ uvcdynctrl -s 'Exposure, Auto' -- 0
>
> $ uvcdynctrl -g 'Exposure, Auto'
> 0
>
> $ uvcdynctrl -g 'Exposure (Absolute)'
> 1500
>
> /usr/local/bin/luvcview -i 30 -f yuv
> There I get 10~15fps
>
>
> The weird thing is I *must* follow this order to be able to set
> 'Exposure (Absolute)' and 'Focus (absolute)':
> 1- get the Auto value,
> 2- set the auto value,
> 3- get the absolute value
> 4- set the absolute value
>
> or I get this error:
> $ uvcdynctrl -s 'Exposure (Absolute)' 2400
> ERROR: Unable to set new control value: A Video4Linux2 API call returned
> an unexpected error 5. (Code: 12)

Does it work when you skip steps 1 and 3 ? The UVC specification makes it 
mandatory to disable auto-exposure before setting the absolute exposure 
value. If you don't the device ignores the absolute exposure request.

> This works:
> $ uvcdynctrl -g 'Exposure, Auto'
> 0
> $ uvcdynctrl -s 'Exposure, Auto' -- 0
> $ uvcdynctrl -g 'Exposure (Absolute)'
> 300
> $ uvcdynctrl -s 'Exposure (Absolute)' 100
> $ uvcdynctrl -g 'Exposure (Absolute)'
> 100
>
> This works too:
> $ uvcdynctrl -g 'Focus, Auto'
> 0
> $ uvcdynctrl -s 'Focus, Auto' 0
> $ uvcdynctrl -g 'Focus (absolute)'
> 1566
> $ uvcdynctrl -s 'Focus (absolute)' 70
> $ uvcdynctrl -g 'Focus (absolute)'
> 70

The focus control shouldn't have any influence on the frame rate.

> But what ever I tried, I'm not able to have 30fps :(
>
> It seems if there is more light in the room, the fps increase a bit.

I played a bit with my Creative Live! Cam Optia (non AF version, as I don't 
own an AF one). With auto exposure on, the frame rate decreases with ambient 
light. After disabling auto exposure off, the frame rate stays around 30fps 
even if I obscure the lens.

Now, if I change the absolute exposure time after disabling auto-exposure, the 
image will become completely saturated, no matter what absolute exposure time 
value I set.

I tried the same operations on a Logitech Quickcam Pro for Notebooks. The 
absolute exposure time can be changed when auto-exposure is off, and the 
effect on the image is immediately visible (although the image gets darker 
when I increase the exposure time, I would have expected the opposite).

This seems to mean that the absolute exposure time issue I encountered is not 
caused by the driver but by the Creative Live! Cam Optia.

Have you seen a similar issue ? Does the image change when you modify the 
absolute exposure time control after disabling auto-exposure ? You can use 
uvcdynctrl to modify the controls while luvcview is running.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May  1 23:38:33 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 1 May 2008 23:38:33 +0200
Subject: [Linux-uvc-devel] Only get black screen with Logitech QuickCam
	Pro 5000
In-Reply-To: <48131498.9020104@freenet.de>
References: <4809C351.80803@freenet.de>
	<200804212126.36365.laurent.pinchart@skynet.be>
	<48131498.9020104@freenet.de>
Message-ID: <200805012338.33819.laurent.pinchart@skynet.be>

Hi Christopher,

On Saturday 26 April 2008, Christopher Reimer wrote:
> Laurent Pinchart wrote:
> > Could you please try luvcview ? xawtv 3.95 has a known bug and I've never
> > tested aMsn myself (although other people reported it to work some time
> > ago).
>
> Thanks for the hint with luvcview. This program is able to get a nice
> picture from my cam. For some reason after first getting a connection
> with luvcview, aMSN is also able to get picture from my webcam. Did
> luvcview some type of "configuration" which made aMSN work well now?

luvcview probably modifies a few standard controls (brightness, contrast, hue, 
saturation, ...).

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May  1 23:53:05 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 1 May 2008 23:53:05 +0200
Subject: [Linux-uvc-devel] Building under latest 2.6.25-git kernels
In-Reply-To: <20080429022355.GC25683@plankton.ifup.org>
References: <48146823.3040405@blueyonder.co.uk>
	<20080429022355.GC25683@plankton.ifup.org>
Message-ID: <200805012353.05895.laurent.pinchart@skynet.be>

On Tuesday 29 April 2008, Brandon Philips wrote:
> On 12:48 Sun 27 Apr 2008, Sid Boyce wrote:
> > I've seen some references to the driver being included in the mainline
> > kernel as part of v4l2, but I am not clear on the present situation with
> > the merge. I have gone back as far as rev 190 and I get these errors on
> > all up to latest rev 205. The mainline kernel doesn't build uvcvideo.ko
> > either.
>
> The Makefile SUBLEVEL doesn't change to .26 until the first release
> candidate and the conflicts you are seeing are protected by:
>
>  #if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,26)
>
> But, hopefully the UVC driver will be merged by the first rc :D

I'm working on that. I submitted the driver for comments on both the 
video4linux and linux-usb mailing lists. There hasn't been tremendous amount 
of feedback so far, so I'll try to ping the lists.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri May  2 00:00:30 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 00:00:30 +0200
Subject: [Linux-uvc-devel] asus x55 video upside down
In-Reply-To: <c49cf9640804280331p1050f160l3eaeebc9f94665b5@mail.gmail.com>
References: <c49cf9640804280331p1050f160l3eaeebc9f94665b5@mail.gmail.com>
Message-ID: <200805020000.30589.laurent.pinchart@skynet.be>

Hi Claudiu,

On Monday 28 April 2008, Claudiu Constantinescu wrote:
> Dear All,
>
>      I have the problem of a camera mounted upside-down in an Asus x55
> (Bus 007 Device 003: ID 04f2:b012 Chicony Electronics Co., Ltd).
> luvcview -f yuv works and displays the image bottom side up. I think
> there is no way that the uvc driver can vertically flip the image
> (correct me if I'm wrong).

That's right. The driver doesn't perform any image processing task, and the 
hardware doesn't export any image rotation/mirroring functionnality.

>      I don't know if this is the correct place to ask for this, but
> does anyone know of any userspace or kernel implementations, or a
> patch to the uvc driver, that would duplicate the video device and
> flip it upside down?

As Brandon mentioned, the solution has to be implemented in userspace. There 
is currently no generic framework to handle such issues. Several projects 
have been started, but until they deliver useful results you will probably 
have to implement image flipping in your favourite application(s).

Best regards,

Laurent Pinchart


From dawessels at telkomsa.net  Fri May  2 00:06:53 2008
From: dawessels at telkomsa.net (Danie)
Date: Fri, 02 May 2008 00:06:53 +0200
Subject: [Linux-uvc-devel] Logitech QuickCam Go not listed
Message-ID: <1209679613.11010.15.camel@donderweer.zwartkop.co.za>

My Logitech QuickCam Go is not listed at
http://linux-uvc.berlios.de/#devices
>From lsusb:
Bus 002 Device 006: ID 046d:092f Logitech, Inc. QuickCam Express Plus
Note: Box says "QuickCam Go" and not "QuickCam Express Plus"!

Even after
http://liquidat.wordpress.com/2007/12/07/howto-logitech-quickcam-pro-9000-with-fedora-8/
I had no luck. trunck r205
(only thus:)
localhost kernel: usb 2-2: new full speed USB device using uhci_hcd and
address 8
localhost kernel: usb 2-2: configuration #1 chosen from 1 choice

I am not sure how to confirm that uvcvideo.ko is properly installed.
/lib/modules/2.6.24.4-64.fc8/kernel/drivers/media/video/uvcvideo/uvcvideo.ko (57.8KB 29 Mar)
/lib/modules/2.6.24.5-85.fc8/kernel/drivers/media/video/uvcvideo/uvcvideo.ko (57.8KB 19 Apr)
/linux-uvc/trunk/uvcvideo.ko (size=880.8KB 30 Apr)

[... linux-uvc]# lsmod >pre_uvc.txt
[... linux-uvc]# modprobe uvcvideo
[... linux-uvc]# lsmod >uvc.txt
[... linux-uvc]# diff uvc.txt pre_uvc.txt
2,6d1
< uvcvideo               49349  0
< compat_ioctl32          5185  1 uvcvideo
< videodev               27713  1 uvcvideo
< v4l1_compat            15813  2 uvcvideo,videodev
< v4l2_common            18497  2 uvcvideo,videodev

After modprobe uvcvideo I get
... kernel: Linux video capture interface: v2.00
... kernel: usbcore: registered new interface driver uvcvideo
... kernel: USB Video Class driver (v0.1.0)

but still I only get upon usb insertion:
... kernel: usb 2-2: new full speed USB device using uhci_hcd and
address 4
... kernel: usb 2-2: configuration #1 chosen from 1 choice
and no /dev/video

Specifications: (as per box)
Quality CiF (352x288) webcam
Video Capture: 640x480 pixels (software enhanced {I suppose windows
driver})
Up to 30 frames per second live video
USB 1.1/2.0
Barcode: for QC Go 961468-0914: 5 099206 988019

This is on Fedora 8 with current updates on 2008-04-30

How can I help?

Best regards
Danie 



From laurent.pinchart at skynet.be  Fri May  2 00:28:40 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 00:28:40 +0200
Subject: [Linux-uvc-devel] success: Chicony Electronics USB2.0 1.3M UVC
	WebCam (Asus F6S)
In-Reply-To: <4815B76A.5090907@willies.info>
References: <47FE54A2.1020401@willies.info> <47FE5F27.10805@willies.info>
	<4815B76A.5090907@willies.info>
Message-ID: <200805020028.41040.laurent.pinchart@skynet.be>

Hi Jan,

On Monday 28 April 2008, Jan Willies wrote:
> Jan Willies wrote:
> > Laurent Pinchart wrote:
>  >> Thanks for the report. Could you please send me the output of
> >>
> >> lsusb -v -d 04f2:b029
> >>
> >> with usbutils 0.72 or newer (0.73+ preferred) ?
> >
> > root at jan ~ # lsusb -V
> > lsusb (usbutils) 0.73
> > root at jan ~ # lsusb -v -d 04f2:b029
> >
> > Bus 002 Device 002: ID 04f2:b029 Chicony Electronics Co., Ltd
> > Device Descriptor:
> >   bLength                18
> >   bDescriptorType         1
> >   bcdUSB               2.00
> >   bDeviceClass          239 Miscellaneous Device
> >   bDeviceSubClass         2 ?
> >   bDeviceProtocol         1 Interface Association
> >   bMaxPacketSize0        64
> >   idVendor           0x04f2 Chicony Electronics Co., Ltd
> >   idProduct          0xb029
> >   bcdDevice           51.66
> >   iManufacturer           2 Chicony Electronics Co., Ltd.
> >   iProduct                1 USB2.0 1.3M UVC WebCam
> >   iSerial                 3 SN0001
> >   bNumConfigurations      1
> >   Configuration Descriptor:
> >     bLength                 9
> >     bDescriptorType         2
> >     wTotalLength          591
> >     bNumInterfaces          2
> >     bConfigurationValue     1
> >     iConfiguration          0
> >     bmAttributes         0x80
> >       (Bus Powered)
> >     MaxPower               98mA
> >     Interface Association:
> >       bLength                 8
> >       bDescriptorType        11
> >       bFirstInterface         0
> >       bInterfaceCount         2
> >       bFunctionClass         14 Video
> >       bFunctionSubClass       3 Video Interface Collection
> >       bFunctionProtocol       0
> >       iFunction               1 USB2.0 1.3M UVC WebCam
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        0
> >       bAlternateSetting       0
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      1 Video Control
> >       bInterfaceProtocol      0
> >       iInterface              1 USB2.0 1.3M UVC WebCam
> >       VideoControl Interface Descriptor:
> >         bLength                13
> >         bDescriptorType        36
> >         bDescriptorSubtype      1 (HEADER)
> >         bcdUVC               1.00
> >         wTotalLength          103
> >         dwClockFrequency       15.000000MHz
> >         bInCollection           1
> >         baInterfaceNr( 0)       1
> >       VideoControl Interface Descriptor:
> >         bLength                 9
> >         bDescriptorType        36
> >         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
> >         bTerminalID             2
> >         wTerminalType      0x0101 USB Streaming
> >         bAssocTerminal          0
> >         bSourceID               5
> >         iTerminal               0
> >       VideoControl Interface Descriptor:
> >         bLength                26
> >         bDescriptorType        36
> >         bDescriptorSubtype      6 (EXTENSION_UNIT)
> >         bUnitID                 4
> >         guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
> >         bNumControl             8
> >         bNrPins                 1
> >         baSourceID( 0)          3
> >         bControlSize            1
> >         bmControls( 0)       0x0f
> >         iExtension              0
> >       VideoControl Interface Descriptor:
> >         bLength                26
> >         bDescriptorType        36
> >         bDescriptorSubtype      6 (EXTENSION_UNIT)
> >         bUnitID                 5
> >         guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
> >         bNumControl             8
> >         bNrPins                 1
> >         baSourceID( 0)          4
> >         bControlSize            1
> >         bmControls( 0)       0x00
> >         iExtension              0
> >       VideoControl Interface Descriptor:
> >         bLength                18
> >         bDescriptorType        36
> >         bDescriptorSubtype      2 (INPUT_TERMINAL)
> >         bTerminalID             1
> >         wTerminalType      0x0201 Camera Sensor
> >         bAssocTerminal          0
> >         iTerminal               0
> >         wObjectiveFocalLengthMin      0
> >         wObjectiveFocalLengthMax      0
> >         wOcularFocalLength            0
> >         bControlSize                  3
> >         bmControls           0x00000000
> >       VideoControl Interface Descriptor:
> >         bLength                11
> >         bDescriptorType        36
> >         bDescriptorSubtype      5 (PROCESSING_UNIT)
> >       Warning: Descriptor too short
> >         bUnitID                 3
> >         bSourceID               1
> >         wMaxMultiplier          0
> >         bControlSize            2
> >         bmControls     0x0000053f
> >           Brightness
> >           Contrast
> >           Hue
> >           Saturation
> >           Sharpness
> >           Gamma
> >           Backlight Compensation
> >           Power Line Frequency
> >         iProcessing             0
> >         bmVideoStandards     0x 0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x83  EP 3 IN
> >         bmAttributes            3
> >           Transfer Type            Interrupt
> >           Synch Type               None
> >           Usage Type               Data
> >         wMaxPacketSize     0x0010  1x 16 bytes
> >         bInterval               6
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       0
> >       bNumEndpoints           0
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       VideoStreaming Interface Descriptor:
> >         bLength                            14
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  1 (INPUT_HEADER)
> >         bNumFormats                        1
> >         wTotalLength                      345
> >         bEndPointAddress                  129
> >         bmInfo                              0
> >         bTerminalLink                       2
> >         bStillCaptureMethod                 0
> >         bTriggerSupport                     1
> >         bTriggerUsage                       0
> >         bControlSize                        1
> >         bmaControls( 0)                    27
> >       VideoStreaming Interface Descriptor:
> >         bLength                            27
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
> >         bFormatIndex                        1
> >         bNumFrameDescriptors                7
> >         guidFormat
> > {59555932-0000-1000-8000-00aa00389b71}
> >         bBitsPerPixel                      16
> >         bDefaultFrameIndex                  1
> >         bAspectRatioX                       0
> >         bAspectRatioY                       0
> >         bmInterlaceFlags                 0x00
> >           Interlaced stream or variable: No
> >           Fields per frame: 1 fields
> >           Field 1 first: No
> >           Field pattern: Field 1 only
> >           bCopyProtect                      0
> >       VideoStreaming Interface Descriptor:
> >         bLength                            46
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         1
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                            640
> >         wHeight                           480
> >         dwMinBitRate                   614400
> >         dwMaxBitRate                 18432000
> >         dwMaxVideoFrameBufferSize      614400
> >         dwDefaultFrameInterval         333333
> >         bFrameIntervalType                  5
> >         dwFrameInterval( 0)            333333
> >         dwFrameInterval( 1)            500000
> >         dwFrameInterval( 2)            666666
> >         dwFrameInterval( 3)           1000000
> >         dwFrameInterval( 4)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                            46
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         2
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                            352
> >         wHeight                           288
> >         dwMinBitRate                   202752
> >         dwMaxBitRate                  6082560
> >         dwMaxVideoFrameBufferSize      202752
> >         dwDefaultFrameInterval         333333
> >         bFrameIntervalType                  5
> >         dwFrameInterval( 0)            333333
> >         dwFrameInterval( 1)            500000
> >         dwFrameInterval( 2)            666666
> >         dwFrameInterval( 3)           1000000
> >         dwFrameInterval( 4)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                            46
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         3
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                            320
> >         wHeight                           240
> >         dwMinBitRate                   153600
> >         dwMaxBitRate                  4608000
> >         dwMaxVideoFrameBufferSize      153600
> >         dwDefaultFrameInterval         333333
> >         bFrameIntervalType                  5
> >         dwFrameInterval( 0)            333333
> >         dwFrameInterval( 1)            500000
> >         dwFrameInterval( 2)            666666
> >         dwFrameInterval( 3)           1000000
> >         dwFrameInterval( 4)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                            46
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         4
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                            176
> >         wHeight                           144
> >         dwMinBitRate                    50688
> >         dwMaxBitRate                  1520640
> >         dwMaxVideoFrameBufferSize       50688
> >         dwDefaultFrameInterval         333333
> >         bFrameIntervalType                  5
> >         dwFrameInterval( 0)            333333
> >         dwFrameInterval( 1)            500000
> >         dwFrameInterval( 2)            666666
> >         dwFrameInterval( 3)           1000000
> >         dwFrameInterval( 4)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                            46
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         5
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                            160
> >         wHeight                           120
> >         dwMinBitRate                    38400
> >         dwMaxBitRate                  1152000
> >         dwMaxVideoFrameBufferSize       38400
> >         dwDefaultFrameInterval         333333
> >         bFrameIntervalType                  5
> >         dwFrameInterval( 0)            333333
> >         dwFrameInterval( 1)            500000
> >         dwFrameInterval( 2)            666666
> >         dwFrameInterval( 3)           1000000
> >         dwFrameInterval( 4)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                            34
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         6
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                           1280
> >         wHeight                           960
> >         dwMinBitRate                  2457600
> >         dwMaxBitRate                 19660800
> >         dwMaxVideoFrameBufferSize     2457600
> >         dwDefaultFrameInterval        1333333
> >         bFrameIntervalType                  2
> >         dwFrameInterval( 0)           1333333
> >         dwFrameInterval( 1)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                            34
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         7
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                           1280
> >         wHeight                          1024
> >         dwMinBitRate                  2621440
> >         dwMaxBitRate                 19660800
> >         dwMaxVideoFrameBufferSize     2621440
> >         dwDefaultFrameInterval        1333333
> >         bFrameIntervalType                  2
> >         dwFrameInterval( 0)           1333333
> >         dwFrameInterval( 1)           2000000
> >       VideoStreaming Interface Descriptor:
> >         bLength                             6
> >         bDescriptorType                    36
> >         bDescriptorSubtype                 13 (COLORFORMAT)
> >         bColorPrimaries                     1 (BT.709,sRGB)
> >         bTransferCharacteristics            1 (BT.709)
> >         bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       1
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x81  EP 1 IN
> >         bmAttributes            5
> >           Transfer Type            Isochronous
> >           Synch Type               Asynchronous
> >           Usage Type               Data
> >         wMaxPacketSize     0x0080  1x 128 bytes
> >         bInterval               1
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       2
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x81  EP 1 IN
> >         bmAttributes            5
> >           Transfer Type            Isochronous
> >           Synch Type               Asynchronous
> >           Usage Type               Data
> >         wMaxPacketSize     0x0100  1x 256 bytes
> >         bInterval               1
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       3
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x81  EP 1 IN
> >         bmAttributes            5
> >           Transfer Type            Isochronous
> >           Synch Type               Asynchronous
> >           Usage Type               Data
> >         wMaxPacketSize     0x0320  1x 800 bytes
> >         bInterval               1
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       4
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x81  EP 1 IN
> >         bmAttributes            5
> >           Transfer Type            Isochronous
> >           Synch Type               Asynchronous
> >           Usage Type               Data
> >         wMaxPacketSize     0x0b20  2x 800 bytes
> >         bInterval               1
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       5
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x81  EP 1 IN
> >         bmAttributes            5
> >           Transfer Type            Isochronous
> >           Synch Type               Asynchronous
> >           Usage Type               Data
> >         wMaxPacketSize     0x1320  3x 800 bytes
> >         bInterval               1
> >     Interface Descriptor:
> >       bLength                 9
> >       bDescriptorType         4
> >       bInterfaceNumber        1
> >       bAlternateSetting       6
> >       bNumEndpoints           1
> >       bInterfaceClass        14 Video
> >       bInterfaceSubClass      2 Video Streaming
> >       bInterfaceProtocol      0
> >       iInterface              0
> >       Endpoint Descriptor:
> >         bLength                 7
> >         bDescriptorType         5
> >         bEndpointAddress     0x81  EP 1 IN
> >         bmAttributes            5
> >           Transfer Type            Isochronous
> >           Synch Type               Asynchronous
> >           Usage Type               Data
> >         wMaxPacketSize     0x1400  3x 1024 bytes
> >         bInterval               1
> > Device Qualifier (for other device speed):
> >   bLength                10
> >   bDescriptorType         6
> >   bcdUSB               2.00
> >   bDeviceClass          239 Miscellaneous Device
> >   bDeviceSubClass         2 ?
> >   bDeviceProtocol         1 Interface Association
> >   bMaxPacketSize0        64
> >   bNumConfigurations      1
> > Device Status:     0x0000
> >   (Bus Powered)
> >
> >>> Is there a chance to get the full 1.3MP sometime? The quick test with
> >>> mplayer just reports 640x480:
> >>
> >> I'd like to see the lsusb output to answer that :-)
>
> Did the lsusb-output help?

The highest resolution supported by the camera is 1280x1024. After a quick 
test mplayer seems to have trouble honouring the width and height options. 
Could you try luvcview and see if it works ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri May  2 00:46:52 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 00:46:52 +0200
Subject: [Linux-uvc-devel] eeepc webcam noise
In-Reply-To: <7371.80.254.146.4.1209473749.squirrel@hare.demon.co.uk>
References: <7371.80.254.146.4.1209473749.squirrel@hare.demon.co.uk>
Message-ID: <200805020046.53052.laurent.pinchart@skynet.be>

Hi Les,

On Tuesday 29 April 2008, Les Smithson wrote:
> I'm trying to use motion
> (http://www.lavrsen.dk/twiki/bin/view/Motion/WebHome) with a uvcvideo
> driver on an Asus eeepc. The webcam is USB ID eb1a:2761 eMPIA Technology,
> Inc. It mostly works, but every now and then motion captures a noise
> frame. These look as though a green/yellow is missing, and have the
> picture offset in both the X+Y positions. The problem is noticeably worse
> under the strip lighting at work. I think the problem is also present on
> uvcview as every now and then the picture flashes for no reason.
>
> I've tried with both the stock driver and the latest svn (r205) and it
> behaves the same way. Is this a driver bug? Is there anything I can do to
> try and debug it?

The artifact you noticed are due to a missing USB data packet. This can be 
caused by bus contention, bad cables, noisy electrical environment, ...

The UVC protocol doesn't provide a way to detect missing data packets. When 
using video formats with a fixed number of bytes per frame the driver could 
drop incomplete frames, but this isn't possible when frames have a variable 
number of bytes (when using MJPEG compression for instance).

I still have to implement that in the driver. I'll push the task up on my TODO 
list :-)

Best regards,

Laurent Pinchart


From dawessels at telkomsa.net  Fri May  2 01:10:31 2008
From: dawessels at telkomsa.net (Danie)
Date: Fri, 02 May 2008 01:10:31 +0200
Subject: [Linux-uvc-devel] Logitech QuickCam Go not listed
In-Reply-To: <mailman.545.1209680448.5404.linux-uvc-devel@lists.berlios.de>
References: <mailman.545.1209680448.5404.linux-uvc-devel@lists.berlios.de>
Message-ID: <1209683431.11010.22.camel@donderweer.zwartkop.co.za>

No, Sorry, it is! I don't know why I missed that
> Subject: [Linux-uvc-devel] Logitech QuickCam Go not listed
> To: linux-uvc-devel at lists.berlios.de
> Message-ID: <1209679613.11010.15.camel at donderweer.zwartkop.co.za>

> My Logitech QuickCam Go is not listed at
> http://linux-uvc.berlios.de/#devices
> >From lsusb:
> Bus 002 Device 006: ID 046d:092f Logitech, Inc. QuickCam Express Plus
> Note: Box says "QuickCam Go" and not "QuickCam Express Plus"!

It is under:
Logitech 
QuickCam Express Plus 
gspca 
Yes 
Yes 
v7.10 (Gutsy Gibbon) 
USB ID 046d:092f (Same ID as previous entry, but since name on the box
is different, I'm adding it here.) 
2007-Dec-23 

I have now installed v4l2-tool and have just to figure out how to get
gspca going.

> Best regards
> Danie 




From laurent.pinchart at skynet.be  Fri May  2 13:49:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 13:49:11 +0200
Subject: [Linux-uvc-devel] Questions on Makefile
In-Reply-To: <200805011041.01088.expose@luftgetrock.net>
References: <200805011041.01088.expose@luftgetrock.net>
Message-ID: <200805021349.11743.laurent.pinchart@skynet.be>

Hi Daniel,

On Thursday 01 May 2008, Daniel Herzog wrote:
> Hi Everybody,
>
> First of all, I'm new to Makefiles, so the following might be all wrong :-)
> The makefile contains
> 	"depmod -ae $(KERNEL_VERSION)"
> My "man depmod" says:
> 	-a --all		Probe all modules.
> 				This option is enabled by default,
> 				if no file names are given in command-line.
> 	-e --errsyms	When combined with the -F option, [...]
>
> So one could leave out the -e option, and if all depmod versions behave the
> same here also the -a option. Right?

It seems you're right, yes.

> Is it needed to manually run depmod anyway if using a recent kernels
> modules_install?

Seems not, you're right there as well.

> Same thing above where it says
> 	cd $(KERNEL_DIR) && MAKE -C $(KERNEL_DIR)
> Why go to KERNEL_DIR twice?

Good question. I seem to remember there was a reason, but I can't find it now. 
Maybe something to do with older kernels ?

> The SUBDIRS variable is used. In the Makefile of kernel version 2.6.25 it
> says that it would be old syntax - i don't know how old and wether it is
> still needed to support previous kernel versions, though.

Seems it's been deprecated since at least 2.6.12-rc2.

Thanks for the comments. I updated the Makefile, tested it against 2.6.15, and 
found no issue. I've committed the changes.

Best regards,

Laurent Pinchart


From jan at willies.info  Fri May  2 13:49:02 2008
From: jan at willies.info (Jan Willies)
Date: Fri, 02 May 2008 13:49:02 +0200
Subject: [Linux-uvc-devel] success: Chicony Electronics USB2.0 1.3M UVC
 WebCam (Asus F6S)
In-Reply-To: <200805020028.41040.laurent.pinchart@skynet.be>
References: <47FE54A2.1020401@willies.info> <47FE5F27.10805@willies.info>
	<4815B76A.5090907@willies.info>
	<200805020028.41040.laurent.pinchart@skynet.be>
Message-ID: <481AFFAE.40604@willies.info>

Laurent Pinchart wrote:
> On Monday 28 April 2008, Jan Willies wrote:
>> Jan Willies wrote:
>>>>> Is there a chance to get the full 1.3MP sometime? The quick test with
>>>>> mplayer just reports 640x480:
>>>> I'd like to see the lsusb output to answer that :-)
>> Did the lsusb-output help?
> 
> The highest resolution supported by the camera is 1280x1024. After a quick 
> test mplayer seems to have trouble honouring the width and height options. 
> Could you try luvcview and see if it works ?

Yup, you were right. It works with latest luvcview and 1280x1024, nice!

I tried with the latest mplayer-svn but got again only 640x480. Do you think I should report it to the mplayer guys?


Thanks

- Jan


From laurent.pinchart at skynet.be  Fri May  2 15:01:20 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 15:01:20 +0200
Subject: [Linux-uvc-devel] success: Chicony Electronics USB2.0 1.3M UVC
	WebCam (Asus F6S)
In-Reply-To: <481AFFAE.40604@willies.info>
References: <47FE54A2.1020401@willies.info>
	<200805020028.41040.laurent.pinchart@skynet.be>
	<481AFFAE.40604@willies.info>
Message-ID: <200805021501.20362.laurent.pinchart@skynet.be>

On Friday 02 May 2008, Jan Willies wrote:
> Laurent Pinchart wrote:
> > On Monday 28 April 2008, Jan Willies wrote:
> >> Jan Willies wrote:
> >>>>> Is there a chance to get the full 1.3MP sometime? The quick test with
> >>>>> mplayer just reports 640x480:
> >>>>
> >>>> I'd like to see the lsusb output to answer that :-)
> >>
> >> Did the lsusb-output help?
> >
> > The highest resolution supported by the camera is 1280x1024. After a
> > quick test mplayer seems to have trouble honouring the width and height
> > options. Could you try luvcview and see if it works ?
>
> Yup, you were right. It works with latest luvcview and 1280x1024, nice!
>
> I tried with the latest mplayer-svn but got again only 640x480. Do you
> think I should report it to the mplayer guys?

Yes you should. Include the UVC kernel messages with trace set to 15 in your 
report.

Best regards,

Laurent Pinchart


From jan at willies.info  Fri May  2 15:21:31 2008
From: jan at willies.info (Jan Willies)
Date: Fri, 02 May 2008 15:21:31 +0200
Subject: [Linux-uvc-devel] success: Chicony Electronics USB2.0 1.3M UVC
 WebCam (Asus F6S)
In-Reply-To: <200805021501.20362.laurent.pinchart@skynet.be>
References: <47FE54A2.1020401@willies.info>
	<200805020028.41040.laurent.pinchart@skynet.be>
	<481AFFAE.40604@willies.info>
	<200805021501.20362.laurent.pinchart@skynet.be>
Message-ID: <481B155B.9050909@willies.info>

Laurent Pinchart wrote:
> On Friday 02 May 2008, Jan Willies wrote:
>> Laurent Pinchart wrote:
>>> On Monday 28 April 2008, Jan Willies wrote:
>>>> Jan Willies wrote:
>>>>>>> Is there a chance to get the full 1.3MP sometime? The quick test with
>>>>>>> mplayer just reports 640x480:
>>>>>> I'd like to see the lsusb output to answer that :-)
>>>> Did the lsusb-output help?
>>> The highest resolution supported by the camera is 1280x1024. After a
>>> quick test mplayer seems to have trouble honouring the width and height
>>> options. Could you try luvcview and see if it works ?
>> Yup, you were right. It works with latest luvcview and 1280x1024, nice!
>>
>> I tried with the latest mplayer-svn but got again only 640x480. Do you
>> think I should report it to the mplayer guys?
> 
> Yes you should. Include the UVC kernel messages with trace set to 15 in your 
> report.

done: http://bugzilla.mplayerhq.hu/show_bug.cgi?id=1074

Thanks for your help Laurent!


- Jan


From laurent.pinchart at skynet.be  Fri May  2 15:52:58 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 15:52:58 +0200
Subject: [Linux-uvc-devel] Syntek UvcVideo
In-Reply-To: <652321.97721.qm@web27706.mail.ukl.yahoo.com>
References: <652321.97721.qm@web27706.mail.ukl.yahoo.com>
Message-ID: <200805021552.59029.laurent.pinchart@skynet.be>

Hi Adrian,

please keep the list CC'ed.

On Friday 25 April 2008, Adrian Sergiu Darabant wrote:
> > Bus 005 Device 009: ID 174f:8a51
> >
> > Iguess it is made by syntek ?!?! but not covered by their drivers ? Itis
> > a 2 MP camera. It works perfectly with Windows XP without driversbut not
> > in Linux. Are there any hopes to make it work ? No device is created as
> > it is not recognized correctly
> > usb 5-5: USB disconnect, address 9
> > usb 5-5: new high speed USB device using ehci_hcd and address 10
> > usb 5-5: new device found, idVendor=174f, idProduct=8a51
> > usb 5-5: new device strings: Mfr=2, Product=3, SerialNumber=4
> > usb 5-5: Product: USB2.0 UVC PC Camera Apr 23 01:24:35 core2
> > usb 5-5: Manufacturer: Syntek
> > usb 5-5: SerialNumber: 0001
> > usb 5-5: configuration #1 chosen from 1
> > uvcvideo: Found UVC 1.00 device USB2.0 UVC PC Camera (174f:8a51)
> > uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
>
> This error is not fatal and can probably be ignored.
>
> > uvcvideo: Failed to query (1) UVC control 2 (unit 0) : -110 (exp. 26).
>
> For some reason the device didn't answer a request and the driver timed
> out. Either the device got confused or crashed from a previous request, or
> the request comes too fast after the previous one.
>
> > uvcvideo: Failed to initialize the device (-5).
> >
> > can't get device qualifier: Connection timed out
> > can't get debug descriptor: Connection timed out
> > cannot read device status, Connection timed out (110)
> >
> >This is quite interesting as well. Even standard requests to read the
> >descriptors time out.
>
> Your camera seems really buggy. It might be possible to work around the
> problem by adding delays. Could you please add a msleep(1000) at the end of
> __uvc_query_ctrl in uvc_ctrl.c and see if it helps (you will have to
> include linux/delay.h) ? If it doesn't try to increase the sleep time up to
> 5000 by 1000 steps.
>
> Ok so here is what I've done :
>
> static int __uvc_query_ctrl(struct uvc_device *dev, __u8 query, __u8 unit,
>             __u8 intfnum, __u8 cs, void *data, __u16 size,
>             int timeout)
> {
>     __u8 type = USB_TYPE_CLASS | USB_RECIP_INTERFACE;
>     unsigned int pipe;
>     int ret;
>
>     pipe = (query & 0x80) ? usb_rcvctrlpipe(dev->udev, 0)
>
>                   : usb_sndctrlpipe(dev->udev, 0);
>
>     type |= (query & 0x80) ? USB_DIR_IN : USB_DIR_OUT;
>
>     ret = usb_control_msg(dev->udev, pipe, query, type, cs << 8,
>             unit << 8 | intfnum, data, size, timeout);
>     msleep(1000); /* trough 5000 tested */
>     if (ret != size) {
>         uvc_printk(KERN_ERR, "Failed to query (%u) UVC control %u "
>             "(unit %u) : %d (exp. %u).\n", query, cs, unit, ret,
>             size);
>         return -EIO;
>     }
>     return 0;
> }
>
> The problem is that I get in the logs the same messages - of course with
> the added pauses in between. Methodology:
> 1) compiled  SVN r205
> 2) rmmod uvcvideo
> 3) insmod uvcvideo.ko
> 4) plug in camera
> ...modifiefied code + repeat steps 1)-4)
>
> Any other suggestions ?
> I am ready to send somebody that could help me one camera for testing as I
> have 9 pieces left (I broke one) :) I have only the electronic and the
> cable (it has no enclosure)

Just a wild guess: maybe the first failing request that I described as non 
fatal confuses the camera. Could you please try the attached patch ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: syntek.patch
Type: text/x-diff
Size: 568 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080502/fa160c9a/attachment.patch>

From laurent.pinchart at skynet.be  Fri May  2 16:30:01 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 2 May 2008 16:30:01 +0200
Subject: [Linux-uvc-devel] Logitech Quickcame deluxe for notebooks
	(046d:09c1) UNSTABLE error -84
In-Reply-To: <d59b0cd40804250106mf5a16e3j1f2f2218ba084574@mail.gmail.com>
References: <d59b0cd40804220415m3cf8242bjfea6c7a990e4c51f@mail.gmail.com>
	<200804250050.36500.laurent.pinchart@skynet.be>
	<d59b0cd40804250106mf5a16e3j1f2f2218ba084574@mail.gmail.com>
Message-ID: <200805021630.02152.laurent.pinchart@skynet.be>

Hi Daniel,

On Friday 25 April 2008, Daniel CABRERA wrote:
> Laurent,
>
> I am not sure if the issue is 10% related to the -84 error, because as
> you can see on the following log msgs. the interval is kind of high,
> which made me think that this is only part of the issue. This log was
> dumped during the execution of luvcview (2007/05/12).
>
> Thx again for your support and in the name of some lost souls like me thx
> ;).
>
> Please let me know if you need me to test or evaluate anything else.

Can you describe your performance issue in more details ?

Best regards,

Laurent Pinchart


From barsnick at gmx.net  Fri May  2 22:29:07 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Fri, 2 May 2008 22:29:07 +0200
Subject: [Linux-uvc-devel] asus x55 video upside down
In-Reply-To: <200805020000.30589.laurent.pinchart@skynet.be>
References: <c49cf9640804280331p1050f160l3eaeebc9f94665b5@mail.gmail.com>
	<200805020000.30589.laurent.pinchart@skynet.be>
Message-ID: <20080502202907.GA28531@sunshine.barsnick.net>

Hi,

On Fri, May 02, 2008 at 00:00:30 +0200, Laurent Pinchart wrote:
> As Brandon mentioned, the solution has to be implemented in userspace. There 
> is currently no generic framework to handle such issues. Several projects 
> have been started, but until they deliver useful results you will probably 
> have to implement image flipping in your favourite application(s).

If your favorite application doesn't support 180? rotation (e.g. with
motion, wxcam, mplayer/mencoder it's easy to rotate), you might want to
try a little hack:

http://www.lavrsen.dk/twiki/bin/view/Motion/VideoFourLinuxLoopbackDevice

This allows a userspace app to push a video stream back to the kernel,
which in turn outputs it again via V4L. Or something like that. :-)

HTH,
Moritz


From mattlbaker at gmail.com  Tue May  6 17:13:12 2008
From: mattlbaker at gmail.com (matt baker)
Date: Tue, 6 May 2008 08:13:12 -0700
Subject: [Linux-uvc-devel] take a picture from command line
Message-ID: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>

With luvcview I can  start it up, and then click the take a picture
button.  It works great.  Does anyone know of a way to take a picture
with the command line?  I'd like to make it part of a script.

Thank you all!
Matt


From iain at lazygnome.net  Tue May  6 17:33:57 2008
From: iain at lazygnome.net (iain at lazygnome.net)
Date: Tue, 6 May 2008 16:33:57 +0100
Subject: [Linux-uvc-devel] take a picture from command line
In-Reply-To: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>
References: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>
Message-ID: <a4031831059478cf8f3087314ba0fbb9@lazygnome.net>


On Tue, 6 May 2008 08:13:12 -0700, "matt baker" <mattlbaker at gmail.com> wrote:
> With luvcview I can  start it up, and then click the take a picture
> button.  It works great.  Does anyone know of a way to take a picture
> with the command line?  I'd like to make it part of a script.
> 
> Thank you all!
> Matt
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel

Hi Matt,

uvccapture by Gabriel A. Devenyi has served me well since the early days of the uvc driver.

http://staticwave.ca/source/uvccapture/

I wrote a simple perl wrapper called caption.pl the overlay a caption to images produced by uvccapture.

http://lazygnome.net/projects/caption/0.1/

Hopefully these will be of use to you.

Cheers,
Iain




From asergiu at yahoo.co.uk  Tue May  6 20:25:20 2008
From: asergiu at yahoo.co.uk (Adrian Sergiu DARABANT)
Date: Tue, 6 May 2008 21:25:20 +0300
Subject: [Linux-uvc-devel] Take a picture at a different resolution than the
	current stream
In-Reply-To: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>
References: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>
Message-ID: <000401c8afa6$8b39c4b0$0c00a8c0@core2>

Hi,
   I would like to know if anybody knows the basic idea of taking a snapshot
from a USB webcam at a different resolution than the currently displayed
video.

Example: displaying video at 800x600 and take snaps at 1600x1200 (supposing
the camera knows those resolutions).

Is a driver feature or an application space one ? I am asking this cause I
would need it for an application I am trying to develop and quickly changing
resolution is not that "quickly" in fact - for a USB camera changing the
resolution takes un unacceptable time. I noticed that on windows some
webcams/driver/software can do that.

Thx
Adrian



-----Original Message-----
From: linux-uvc-devel-bounces at lists.berlios.de
[mailto:linux-uvc-devel-bounces at lists.berlios.de] On Behalf Of matt baker
Sent: 6 mai 2008 18:13
To: linux-uvc-devel at lists.berlios.de
Subject: [Linux-uvc-devel] take a picture from command line

With luvcview I can  start it up, and then click the take a picture
button.  It works great.  Does anyone know of a way to take a picture
with the command line?  I'd like to make it part of a script.

Thank you all!
Matt
_______________________________________________
Linux-uvc-devel mailing list
Linux-uvc-devel at lists.berlios.de
https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From mattlbaker at gmail.com  Wed May  7 00:58:53 2008
From: mattlbaker at gmail.com (matt baker)
Date: Tue, 6 May 2008 15:58:53 -0700
Subject: [Linux-uvc-devel] take a picture from command line
In-Reply-To: <a4031831059478cf8f3087314ba0fbb9@lazygnome.net>
References: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>
	<a4031831059478cf8f3087314ba0fbb9@lazygnome.net>
Message-ID: <120449920805061558g232c66een5ae92faa0e35e940@mail.gmail.com>

Thank you.  It seems like exactly what I want.  Of course I'm having
an issue though.  I'm using uvccapture-0.4.  It works the first few
times but then it stops working.  Here is a small script I made for
testing.



#!/bin/bash

for ((i=100;i<=200;i+=1)); do

uvccapture -x640 -y480 -o$i.jpg

sleep 10

done



It pauses for 10 seconds between each uvccapture call.  It will take
between 3 to 14 pictures before it stops taking pictures.  Here is
what the console looks like.



--- console ---



[root at computer test]# ./run.sh

ioctl querycontrol error 5

ioctl querycontrol error 5

Unable to set format: 5.

 Init v4L2 failed !! exit fatal

Unable to set format: 5.

 Init v4L2 failed !! exit fatal

Unable to set format: 5.

 Init v4L2 failed !! exit fatal

Unable to set format: 5.

 Init v4L2 failed !! exit fatal

Unable to set format: 5.

 Init v4L2 failed !! exit fatal



<< I ctrl-c exited my script >>



---- end console ---





here is what a couple runs look like in /var/log/messages





May  6 14:05:52 localhost kernel: usb 1-5: new high speed USB device
using ehci_hcd and address 9

May  6 14:05:52 localhost kernel: usb 1-5: configuration #1 chosen from 1 choice

May  6 14:05:52 localhost kernel: Linux video capture interface: v2.00

May  6 14:05:52 localhost kernel: usbcore: registered new interface
driver snd-usb-audio

May  6 14:05:52 localhost kernel: uvcvideo: Found UVC 1.00 device
<unnamed> (046d:08ce)

May  6 14:05:52 localhost kernel: usbcore: registered new interface
driver uvcvideo

May  6 14:05:52 localhost kernel: USB Video Class driver (v0.1.0)

May  6 14:05:53 localhost pulseaudio[25185]: alsa-util.c: Device hw:1
doesn't support 44100 Hz, changed to 16000 Hz.

May  6 14:05:53 localhost pulseaudio[25185]: alsa-util.c: Device hw:1
doesn't support 2 channels, changed to 1.

...

May  6 14:20:10 localhost kernel: uvccapture[28658]: segfault at
00000000 eip 00a6361d esp bf9ec4ac error 4

May  6 14:20:20 localhost kernel: uvcvideo: Failed to query (131) UVC
control 3 (unit 2) : -32 (exp. 2).

May  6 14:20:21 localhost kernel: uvccapture[28666]: segfault at
00000000 eip 00a6361d esp bfbb8e7c error 4

May  6 14:20:31 localhost kernel: uvccapture[28673]: segfault at
00000000 eip 00a6361d esp bfac658c error 4

May  6 14:20:41 localhost kernel: uvcvideo: Failed to query (130) UVC
control 4 (unit 2) : -32 (exp. 2).

May  6 14:20:41 localhost kernel: uvccapture[28686]: segfault at
00000000 eip 00a6361d esp bfb68e2c error 4

May  6 14:20:52 localhost kernel: uvcvideo: Failed to query (1) UVC
control 1 (unit 0) : -32 (exp. 26).

May  6 14:21:03 localhost kernel: uvcvideo: Failed to query (1) UVC
control 1 (unit 0) : -110 (exp. 26).



I unplugged it and tried on a different usb port, routed away from all
power cords.



May  6 15:31:42 localhost kernel: uvcvideo: Found UVC 1.00 device
<unnamed> (046d:08ce)

May  6 15:31:42 localhost pulseaudio[25185]: alsa-util.c: Device hw:1
doesn't support 44100 Hz, changed to 16000 Hz.

May  6 15:31:42 localhost pulseaudio[25185]: alsa-util.c: Device hw:1
doesn't support 2 channels, changed to 1.

May  6 15:32:10 localhost kernel: uvccapture[29484]: segfault at
00000000 eip 00a6361d esp bfdcc08c error 4

May  6 15:32:20 localhost kernel: uvccapture[29491]: segfault at
00000000 eip 00a6361d esp bf88834c error 4

May  6 15:32:31 localhost kernel: uvccapture[29498]: segfault at
00000000 eip 00a6361d esp bfc63f2c error 4

May  6 15:32:41 localhost kernel: uvccapture[29507]: segfault at
00000000 eip 00a6361d esp bfa9ed6c error 4

May  6 15:32:52 localhost kernel: uvccapture[29518]: segfault at
00000000 eip 00a6361d esp bfddb09c error 4

May  6 15:33:02 localhost kernel: uvccapture[29525]: segfault at
00000000 eip 00a6361d esp bf809acc error 4

May  6 15:33:13 localhost kernel: uvccapture[29535]: segfault at
00000000 eip 00a6361d esp bf8e0bac error 4

May  6 15:33:23 localhost kernel: uvccapture[29542]: segfault at
00000000 eip 00a6361d esp bf84fb1c error 4

May  6 15:33:34 localhost kernel: uvccapture[29551]: segfault at
00000000 eip 00a6361d esp bfbbde7c error 4

May  6 15:33:44 localhost kernel: uvccapture[29558]: segfault at
00000000 eip 00a6361d esp bff4c20c error 4

May  6 15:33:55 localhost kernel: uvccapture[29570]: segfault at
00000000 eip 00a6361d esp bfdf18bc error 4

May  6 15:34:05 localhost kernel: uvcvideo: Failed to query (1) UVC
control 2 (unit 2) : -32 (exp. 2).

May  6 15:34:05 localhost kernel: uvcvideo: Failed to query (135) UVC
control 3 (unit 2) : -110 (exp. 2).

May  6 15:34:05 localhost kernel: uvcvideo: Failed to query (135) UVC
control 7 (unit 2) : -32 (exp. 2).

May  6 15:34:05 localhost kernel: uvccapture[29583]: segfault at
00000000 eip 00a6361d esp bfb81e4c error 4

May  6 15:34:16 localhost kernel: uvccapture[29596]: segfault at
00000000 eip 00a6361d esp bfeea1ac error 4

May  6 15:34:26 localhost kernel: uvccapture[29604]: segfault at
00000000 eip 00a6361d esp bfd6702c error 4

May  6 15:34:37 localhost kernel: uvccapture[29611]: segfault at
00000000 eip 00a6361d esp bfab0d7c error 4

May  6 15:34:47 localhost kernel: uvcvideo: Failed to query (1) UVC
control 1 (unit 0) : -32 (exp. 26).

May  6 15:34:57 localhost kernel: uvcvideo: Failed to query (1) UVC
control 1 (unit 0) : -32 (exp. 26).

May  6 15:35:08 localhost kernel: uvcvideo: Failed to query (1) UVC
control 1 (unit 0) : -110 (exp. 26).

May  6 15:36:14 localhost kernel:last message repeated 6 times

May  6 15:37:20 localhost kernel:last message repeated 6 times





I tried the version of the uvc driver that comes with the fedora 8
kernel, and also the latest svn.

I have no experience solving segfaults.  I'm probably going to try
sticking some prints in the code and try to find where it segfaults.



Thank you again.
Matt

On Tue, May 6, 2008 at 8:33 AM, iain @ lazygnome. net
<iain at lazygnome.net> wrote:
>
>
>  On Tue, 6 May 2008 08:13:12 -0700, "matt baker" <mattlbaker at gmail.com> wrote:
>
>  > With luvcview I can  start it up, and then click the take a picture
>
>  > button.  It works great.  Does anyone know of a way to take a picture
>
>  > with the command line?  I'd like to make it part of a script.
>
>  >
>
>  > Thank you all!
>
>  > Matt
>
>  > _______________________________________________
>
>  > Linux-uvc-devel mailing list
>
>  > Linux-uvc-devel at lists.berlios.de
>
>  > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>
>
>  Hi Matt,
>
>
>
>  uvccapture by Gabriel A. Devenyi has served me well since the early days of the uvc driver.
>
>
>
>  http://staticwave.ca/source/uvccapture/
>
>
>
>  I wrote a simple perl wrapper called caption.pl the overlay a caption to images produced by uvccapture.
>
>
>
>  http://lazygnome.net/projects/caption/0.1/
>
>
>
>  Hopefully these will be of use to you.
>
>
>
>  Cheers,
>
>  Iain
>
>
>
>


From barny.cespedes at hotmail.com  Wed May  7 11:02:55 2008
From: barny.cespedes at hotmail.com (=?iso-8859-1?Q?Barny_Cespedes_Ordo=F1ez?=)
Date: Wed, 7 May 2008 04:02:55 -0500
Subject: [Linux-uvc-devel] Hello Hola
Message-ID: <BAY122-W317E7EB1121857A45ED63E95D10@phx.gbl>


my camera integrated Web .... 04f2 ID: b057 Chicony Electronics Co. .... not shown in the list please help ... thanks
_________________________________________________________________
Invite your mail contacts to join your friends list with Windows Live Spaces. It's easy!
http://spaces.live.com/spacesapi.aspx?wx_action=create&wx_url=/friends.aspx&mkt=en-us

From georgeps at xmission.com  Wed May  7 16:08:24 2008
From: georgeps at xmission.com (George Peter Staplin)
Date: Wed, 07 May 2008 08:08:24 -0600
Subject: [Linux-uvc-devel] take a picture from command line
In-Reply-To: <120449920805061558g232c66een5ae92faa0e35e940@mail.gmail.com>
References: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>
	<a4031831059478cf8f3087314ba0fbb9@lazygnome.net>
	<120449920805061558g232c66een5ae92faa0e35e940@mail.gmail.com>
Message-ID: <20080507080824.hragmfa3kkk04g00@webmail.xmission.com>

Quoted matt baker <mattlbaker at gmail.com>:

> Thank you.  It seems like exactly what I want.  Of course I'm having
> an issue though.  I'm using uvccapture-0.4.  It works the first few
> times but then it stops working.  Here is a small script I made for
> testing.

For what it's worth, I couldn't get uvccapture to work with my  
Creative webcam.  It would only capture black images for me.  I  
suppose you could debug the segfault with:

gdb uvccapture
(gdb) set args -x 800 -y 600
(gdb) run
#wait for segfault
(gdb) bt full

You may need to add -ggdb to the gcc command line in the Makefile.

For streaming I tend to use the uvc_stream program that is part of the  
mjpg-streamer project, but it uses an MJPEG format that isn't quite  
right for Firefox and other MJPEG viewers.  Ideally I someday want to  
fix that.  I also wrote a viewer program that I send to some people  
that understands the somewhat odd uvc_stream format.  I say odd,  
because it uses: #define BOUNDARY "arflebarfle" as a boundary between  
images.  It's not ideal, because binary data could have such a string  
of bytes.  KHTML has a similar design bug, unfortunately...  I think  
uvcstream should be using a Content-Length header.

For capturing individual images them I also wrote a C extension for  
Tcl that uses the Video4Linux2 API.  I also wrote a server in Tcl that  
works with it.  It seems to work pretty well with at least my webcam.

http://code.google.com/p/megapkg/source/browse/trunk/csrc/v4limage/
http://code.google.com/p/megapkg/source/browse/trunk/v4limage_webcam_server/main.tcl
http://code.google.com/p/megapkg/source/browse/trunk/v4limage_webcam_viewer.vfs/main.tcl

BTW I think it's frustrating that each Video4Linux2 viewer should  
handle so many formats.  I would prefer that the kernel translate to a  
common format if possible, because right now a lot of code doesn't get  
it right (probably mine too (at least for YUYV)) with all webcams.   
You can do the hard work of converting the hardware image data once,  
or push it off onto application developers to do repeatedly.


George
-- 
http://www.xmission.com/~georgeps/  http://whim.linuxsys.net
http://code.google.com/p/megapkg/



From phil at sanslogic.co.uk  Wed May  7 16:44:35 2008
From: phil at sanslogic.co.uk (Philip Heron)
Date: Wed, 07 May 2008 15:44:35 +0100
Subject: [Linux-uvc-devel] take a picture from command line
In-Reply-To: <120449920805061558g232c66een5ae92faa0e35e940@mail.gmail.com>
References: <120449920805060813l2db115cdm3248bfef1780ac93@mail.gmail.com>	<a4031831059478cf8f3087314ba0fbb9@lazygnome.net>
	<120449920805061558g232c66een5ae92faa0e35e940@mail.gmail.com>
Message-ID: <4821C053.7010406@sanslogic.co.uk>

matt baker wrote:
> Thank you.  It seems like exactly what I want.  Of course I'm having
> an issue though.  I'm using uvccapture-0.4.  It works the first few
> times but then it stops working.  Here is a small script I made for
> testing.

Hi Matt,

Give fswebcam a whirl. It's a command line capture app I wrote a few 
years ago, might work for you.

-Phil


From ricardo at isr.ist.utl.pt  Wed May  7 21:42:57 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Wed, 7 May 2008 20:42:57 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
Message-ID: <200805072043.03701.ricardo@isr.ist.utl.pt>

Hello all,

I stumbled upon a problem when using your driver. It seems that it blocks on 
the first VIDIOC_DQBUF ioctl.

I first noticed it in my code using the latest debian linux-uvc-source on an 
amd64 2.6.24 kernel. I assumed it was my problem so I tried  luvcview and 
noticed that there was always a 2 second block the first time that same ioctl 
was called, but it worked flawlessly after that.

After grabing your latest svn driver, luvcview stopped working, blocking on 
the first call to VIDIOC_DQBUF. 

I have an integrated webcam:
Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry Co., Ltd 
(Foxlink)

since I never heard of this manufacturer, I tried a phillips spc1000nc freshly 
bought. The results were exactly the same. 

Do you think it has to do with the driver, this particular kernel, amd64 (had 
some other compatibility issues because of this in the past), or anything 
else?

Any help would be appreciated,

Thanks in advance (and for the software :) ),
Ricardo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080507/2f718a10/attachment.pgp>

From dpmcgee at gmail.com  Fri May  9 05:23:45 2008
From: dpmcgee at gmail.com (Dan McGee)
Date: Thu, 8 May 2008 22:23:45 -0500
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl
Message-ID: <449c10960805082023n2ef82d95t110b757126d12be4@mail.gmail.com>

I'm seeing this same problem on the Eee PC with the integrated webcam.
Running an strace on the luvcview process shows it coming to a halt on
the following:
ioctl(5, VIDIOC_STREAMON, 0x77eede58)   = 0
ioctl(5, VIDIOC_DQBUF

and stays there.

I attempted to track down when this problem started occurring and why,
but I couldn't figure out the why. I know I had a setup where
everything was working with a near-vanilla 2.6.25 kernel and
linux-uvc-svn version 205. The problem started when I compiled
2.6.25.1 and bumped to SVN revision 207. I attempted to drop back down
to 205 and the problem was still occurring. Looking through the kernel
changelog from .25 to .25.1 didn't turn up anything obvious as to what
changed causing it to fail.

-Dan

More complete strace output:

futex(0x6ff17a4c, FUTEX_WAKE_PRIVATE, 2147483647) = 0
select(4, [3], [3], NULL, NULL)         = 1 (out [3])
writev(3, [{"\22\0\21\0\3\0
\1\'\0\0\0\37\0\0\0\10\0\5\0,\0\0\0LUVCview"..., 88}], 1) = 88
select(4, [3], [], NULL, NULL)          = 1 (in [3])
read(3, "\34\364h\0\3\0
\1\'\0\0\0\347\307\23\0\0\247\322\t\'\0\0\0\3701\355w\207)\33\10"...,
4096) = 64
read(3, 0x9f2864c, 4096)                = -1 EAGAIN (Resource
temporarily unavailable)
select(4, [3], [3], NULL, NULL)         = 1 (out [3])
writev(3, [{"\22\0\21\0\3\0
\1.\1\0\0\21\1\0\0\10NG\0,\0\0\0LUVCview"..., 72}], 1) = 72
select(4, [3], [], NULL, NULL)          = 1 (in [3])
read(3, "\34Si\0\3\0
\1/\1\0\0\351\307\23\0\0t\272\t,\0\0\0(2\355w/\272\24\10", 4096) = 32
select(4, [3], [], NULL, NULL)          = 1 (in [3])
read(3, "\34-i\0\3\0
\0011\1\0\0\356\307\23\0\0-\302\t,\0\0\0(2\355w/\272\24\10", 4096) =
32
select(4, [3], [], NULL, NULL)          = 1 (in [3])
read(3, "\34\364j\0\3\0
\1.\1\0\0\357\307\23\0\0\333\272\t.\1\0\0\3701\355w\207)\33\10"...,
4096) = 64
read(3, 0x9f2864c, 4096)                = -1 EAGAIN (Resource
temporarily unavailable)
gettimeofday({1210302608, 783958}, NULL) = 0
brk(0x9fd3000)                          = 0x9fd3000
mmap2(NULL, 8392704, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS,
-1, 0) = 0x6efb6000
mprotect(0x6efb6000, 4096, PROT_NONE)   = 0
clone(child_stack=0x6f7b64b4,
flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID,
parent_tidptr=0x6f7b6bd8, {entry_number:6, base_addr:0x6f7b6b90,
limit:1048575, seg_32bit:1, contents:0, read_exec_only:0,
limit_in_pages:1, seg_not_present:0, useable:1},
child_tidptr=0x6f7b6bd8) = 3562
gettimeofday({1210302608, 826645}, NULL) = 0
ioctl(5, VIDIOC_STREAMON, 0x77eede58)   = 0
ioctl(5, VIDIOC_DQBUF
Stop asked
^Z
[1]+  Stopped                 strace luvcview -f yuv


From tom.leiming at gmail.com  Fri May  9 08:21:55 2008
From: tom.leiming at gmail.com (Ming Lei)
Date: Fri, 9 May 2008 14:21:55 +0800
Subject: [Linux-uvc-devel] Is there a usb still image class function driver
	in kernel?
Message-ID: <d82e647a0805082321g3df5b3a7u6cbdcf6f7ba973ed@mail.gmail.com>

Hi,

It seams there is not a usb still image class function driver in kernel.

How can I access photos in  a digital camera ,which is implemented
with still image class protocol,
instead of msc protocol ,and connected with linux pc by usb cable ?

Thanks!

-- 
Lei Ming


From oliver at neukum.org  Fri May  9 08:34:22 2008
From: oliver at neukum.org (Oliver Neukum)
Date: Fri, 9 May 2008 08:34:22 +0200
Subject: [Linux-uvc-devel] Is there a usb still image class function
	driver in kernel?
In-Reply-To: <d82e647a0805082321g3df5b3a7u6cbdcf6f7ba973ed@mail.gmail.com>
References: <d82e647a0805082321g3df5b3a7u6cbdcf6f7ba973ed@mail.gmail.com>
Message-ID: <200805090834.22682.oliver@neukum.org>

Am Freitag 09 Mai 2008 08:21:55 schrieb Ming Lei:
> Hi,
> 
> It seams there is not a usb still image class function driver in kernel.
> 
> How can I access photos in  a digital camera ,which is implemented
> with still image class protocol,
> instead of msc protocol ,and connected with linux pc by usb cable ?

That is handled by user space programs using libusb, for example gphoto2

	HTH
		Oliver


From hans.ullrich at loop.de  Sat May 10 20:09:06 2008
From: hans.ullrich at loop.de (Hans-J. Ullrich)
Date: Sat, 10 May 2008 20:09:06 +0200
Subject: [Linux-uvc-devel] My camera is not listed [Update]
Message-ID: <200805102009.06786.hans.ullrich@loop.de>

Dear maintainers, 

I saw my camera in my notebook is not listed yet. As you wished, I am 
reporting this now to you.

These are the datas of my built in webcam: 

Manufacturer: ALI Corporation
USB-Code: 	0402:5602

I know, you have a similar webcam already running. 
It is 0402:5605 (ALI Corporation), and this is running fine, as you are 
telling. So it might be, my camera will run with the driver, too ? Maybe I 
have to add some params when loading the kernel-module ?


Best regards

Hans-J. Ullrich
  
Update: Sorry,  if this mail was sent more than one time. I've got trouble 
with the registration process.



From cvaldess at gmail.com  Sat May 10 21:36:11 2008
From: cvaldess at gmail.com (Carlos Valdes)
Date: Sat, 10 May 2008 21:36:11 +0200
Subject: [Linux-uvc-devel] Support for 0402:5602 ALi Corp. Video Camera ??
Message-ID: <f8a142b00805101236o571828dfidac1a4ea8c42e656@mail.gmail.com>

Ubuntu 8.04
In Ekiga "device not found"

Bus 002 Device 003: ID 0402:5602 ALi Corp. Video Camera Controller
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  idVendor           0x0402 ALi Corp.
  idProduct          0x5602 Video Camera Controller
  bcdDevice            1.00
  iManufacturer           0
  iProduct                1 USB2.0 Camera
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          101
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0xa0
      (Bus Powered)
      Remote Wakeup
    MaxPower              500mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               4
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               4
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               4
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1300  3x 768 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               4
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080510/79f3699b/attachment.html>

From laurent.pinchart at skynet.be  Sun May 11 10:05:04 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 11 May 2008 10:05:04 +0200
Subject: [Linux-uvc-devel] Hello Hola
In-Reply-To: <BAY122-W317E7EB1121857A45ED63E95D10@phx.gbl>
References: <BAY122-W317E7EB1121857A45ED63E95D10@phx.gbl>
Message-ID: <200805111005.04509.laurent.pinchart@skynet.be>

Hi Barny,

On Wednesday 07 May 2008, Barny Cespedes Ordo?ez wrote:
> my camera integrated Web .... 04f2 ID: b057 Chicony Electronics Co. ....
> not shown in the list please help ... thanks

Have you tested it ? Is it detected by the driver ?

Please post the output of

lsusb -d 04f2:b057 -v

using usbutils 0.72 or newer (0.73+ is preferred) as well as any message 
printed by the uvcvideo module to the kernel log.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun May 11 10:06:52 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 11 May 2008 10:06:52 +0200
Subject: [Linux-uvc-devel] My camera is not listed [Update]
In-Reply-To: <200805102009.06786.hans.ullrich@loop.de>
References: <200805102009.06786.hans.ullrich@loop.de>
Message-ID: <200805111006.52719.laurent.pinchart@skynet.be>

Hi Hans,

On Saturday 10 May 2008, Hans-J. Ullrich wrote:
> Dear maintainers,
>
> I saw my camera in my notebook is not listed yet. As you wished, I am
> reporting this now to you.
>
> These are the datas of my built in webcam:
>
> Manufacturer: ALI Corporation
> USB-Code: 	0402:5602
>
> I know, you have a similar webcam already running.
> It is 0402:5605 (ALI Corporation), and this is running fine, as you are
> telling. So it might be, my camera will run with the driver, too ? Maybe I
> have to add some params when loading the kernel-module ?

Have you tested it ? Is it detected by the driver ?

Please post the output of

lsusb -d 0402:5602 -v

using usbutils 0.72 or newer (0.73+ is preferred) as well as any message 
printed by the uvcvideo module to the kernel log.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun May 11 10:08:00 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 11 May 2008 10:08:00 +0200
Subject: [Linux-uvc-devel] Support for 0402:5602 ALi Corp. Video Camera
	??
In-Reply-To: <f8a142b00805101236o571828dfidac1a4ea8c42e656@mail.gmail.com>
References: <f8a142b00805101236o571828dfidac1a4ea8c42e656@mail.gmail.com>
Message-ID: <200805111008.00182.laurent.pinchart@skynet.be>

Hi Carlos,

On Saturday 10 May 2008, Carlos Valdes wrote:
> Ubuntu 8.04
> In Ekiga "device not found"
>
> Bus 002 Device 003: ID 0402:5602 ALi Corp. Video Camera Controller
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass            0 (Defined at Interface level)
>   bDeviceSubClass         0
>   bDeviceProtocol         0
>   bMaxPacketSize0        64
>   idVendor           0x0402 ALi Corp.
>   idProduct          0x5602 Video Camera Controller
>   bcdDevice            1.00
>   iManufacturer           0
>   iProduct                1 USB2.0 Camera
>   iSerial                 0
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          101
>     bNumInterfaces          1
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0xa0
>       (Bus Powered)
>       Remote Wakeup
>     MaxPower              500mA
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0000  1x 0 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0000  1x 0 bytes
>         bInterval               4
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       1
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x1400  3x 1024 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               4
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       2
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x1380  3x 896 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               4
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       3
>       bNumEndpoints           2
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            1
>           Transfer Type            Isochronous
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x1300  3x 768 bytes
>         bInterval               1
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x82  EP 2 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               4
> Device Qualifier (for other device speed):
>   bLength                10
>   bDescriptorType         6
>   bcdUSB               2.00
>   bDeviceClass            0 (Defined at Interface level)
>   bDeviceSubClass         0
>   bDeviceProtocol         0
>   bMaxPacketSize0        64
>   bNumConfigurations      1
> Device Status:     0x0000
>   (Bus Powered)

Thanks for the report. Unfortunately your camera isn't UVC compliant, so it 
will not be supported by the Linux UVC driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun May 11 10:15:05 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 11 May 2008 10:15:05 +0200
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805072043.03701.ricardo@isr.ist.utl.pt>
References: <200805072043.03701.ricardo@isr.ist.utl.pt>
Message-ID: <200805111015.06109.laurent.pinchart@skynet.be>

Hi Ricardo,

On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> Hello all,
>
> I stumbled upon a problem when using your driver. It seems that it blocks
> on the first VIDIOC_DQBUF ioctl.
>
> I first noticed it in my code using the latest debian linux-uvc-source on
> an amd64 2.6.24 kernel. I assumed it was my problem so I tried  luvcview
> and noticed that there was always a 2 second block the first time that same
> ioctl was called, but it worked flawlessly after that.
>
> After grabing your latest svn driver, luvcview stopped working, blocking on
> the first call to VIDIOC_DQBUF.
>
> I have an integrated webcam:
> Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry Co., Ltd
> (Foxlink)
>
> since I never heard of this manufacturer, I tried a phillips spc1000nc
> freshly bought. The results were exactly the same.
>
> Do you think it has to do with the driver, this particular kernel, amd64
> (had some other compatibility issues because of this in the past), or
> anything else?

Could you please retry with r206 and r207 and compare the results ? r207 
introduces a patch to drop incomplete frames.

If reverting to r206 helps, I'll ask you to try a patch to get more 
information about the issue.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun May 11 10:16:27 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 11 May 2008 10:16:27 +0200
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl
In-Reply-To: <449c10960805082023n2ef82d95t110b757126d12be4@mail.gmail.com>
References: <449c10960805082023n2ef82d95t110b757126d12be4@mail.gmail.com>
Message-ID: <200805111016.27854.laurent.pinchart@skynet.be>

Hi Dan,

On Friday 09 May 2008, Dan McGee wrote:
> I'm seeing this same problem on the Eee PC with the integrated webcam.
> Running an strace on the luvcview process shows it coming to a halt on
> the following:
> ioctl(5, VIDIOC_STREAMON, 0x77eede58)   = 0
> ioctl(5, VIDIOC_DQBUF
>
> and stays there.
>
> I attempted to track down when this problem started occurring and why,
> but I couldn't figure out the why. I know I had a setup where
> everything was working with a near-vanilla 2.6.25 kernel and
> linux-uvc-svn version 205. The problem started when I compiled
> 2.6.25.1 and bumped to SVN revision 207. I attempted to drop back down
> to 205 and the problem was still occurring. Looking through the kernel
> changelog from .25 to .25.1 didn't turn up anything obvious as to what
> changed causing it to fail.

I'm pretty surprised that the upgrade from .25 to .25.1 alone caused the 
problem.

Could you please retry with r206 and r207 and compare the results ? r207 
introduces a patch to drop incomplete frames. Check the kernel log to make 
sure the right driver gets loaded (it should print the SVN revision number 
when loaded).

If reverting to r206 helps, I'll ask you to try a patch to get more 
information about the issue.

Best regards,

Laurent Pinchart


From ricardo at isr.ist.utl.pt  Sun May 11 11:36:05 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Sun, 11 May 2008 10:36:05 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805111015.06109.laurent.pinchart@skynet.be>
References: <200805072043.03701.ricardo@isr.ist.utl.pt>
	<200805111015.06109.laurent.pinchart@skynet.be>
Message-ID: <200805111036.16256.ricardo@isr.ist.utl.pt>

Hi, thanks for the response,

On Sunday 11 May 2008 09:15:05 Laurent Pinchart wrote:
> Hi Ricardo,
>
> On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> > Hello all,
> >
> > I stumbled upon a problem when using your driver. It seems that it blocks
> > on the first VIDIOC_DQBUF ioctl.
> >
> > I first noticed it in my code using the latest debian linux-uvc-source on
> > an amd64 2.6.24 kernel. I assumed it was my problem so I tried  luvcview
> > and noticed that there was always a 2 second block the first time that
> > same ioctl was called, but it worked flawlessly after that.
> >
> > After grabing your latest svn driver, luvcview stopped working, blocking
> > on the first call to VIDIOC_DQBUF.
> >
> > I have an integrated webcam:
> > Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry Co., Ltd
> > (Foxlink)
> >
> > since I never heard of this manufacturer, I tried a phillips spc1000nc
> > freshly bought. The results were exactly the same.
> >
> > Do you think it has to do with the driver, this particular kernel, amd64
> > (had some other compatibility issues because of this in the past), or
> > anything else?
>
> Could you please retry with r206 and r207 and compare the results ? r207
> introduces a patch to drop incomplete frames.

Yes, that is exactly were it breaks. r206 has that 1-2 second delay the first 
time DQBUF is called, but after that it is perfect. in r207 the first call to 
DQBUF never returns.

>
> If reverting to r206 helps, I'll ask you to try a patch to get more
> information about the issue.

sure, whatever helps.

>
> Best regards,
>
> Laurent Pinchart

Ricardo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080511/27bc5f38/attachment.pgp>

From laurent.pinchart at skynet.be  Sun May 11 12:06:46 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 11 May 2008 12:06:46 +0200
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805111036.16256.ricardo@isr.ist.utl.pt>
References: <200805072043.03701.ricardo@isr.ist.utl.pt>
	<200805111015.06109.laurent.pinchart@skynet.be>
	<200805111036.16256.ricardo@isr.ist.utl.pt>
Message-ID: <200805111206.47111.laurent.pinchart@skynet.be>

Hi Ricardo,

On Sunday 11 May 2008, Ricardo Ferreira wrote:
> Hi, thanks for the response,
>
> On Sunday 11 May 2008 09:15:05 Laurent Pinchart wrote:
> > Hi Ricardo,
> >
> > On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> > > Hello all,
> > >
> > > I stumbled upon a problem when using your driver. It seems that it
> > > blocks on the first VIDIOC_DQBUF ioctl.
> > >
> > > I first noticed it in my code using the latest debian linux-uvc-source
> > > on an amd64 2.6.24 kernel. I assumed it was my problem so I tried 
> > > luvcview and noticed that there was always a 2 second block the first
> > > time that same ioctl was called, but it worked flawlessly after that.
> > >
> > > After grabing your latest svn driver, luvcview stopped working,
> > > blocking on the first call to VIDIOC_DQBUF.
> > >
> > > I have an integrated webcam:
> > > Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry Co., Ltd
> > > (Foxlink)
> > >
> > > since I never heard of this manufacturer, I tried a phillips spc1000nc
> > > freshly bought. The results were exactly the same.
> > >
> > > Do you think it has to do with the driver, this particular kernel,
> > > amd64 (had some other compatibility issues because of this in the
> > > past), or anything else?
> >
> > Could you please retry with r206 and r207 and compare the results ? r207
> > introduces a patch to drop incomplete frames.
>
> Yes, that is exactly were it breaks. r206 has that 1-2 second delay the
> first time DQBUF is called, but after that it is perfect. in r207 the first
> call to DQBUF never returns.

Thanks for your fast reply.

> > If reverting to r206 helps, I'll ask you to try a patch to get more
> > information about the issue.
>
> sure, whatever helps.

I've attached a patch to this e-mail. Could you please apply it, load the 
driver with the trace parameter set to 143 and report the kernel log 
messages ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: frame-drop.patch
Type: text/x-diff
Size: 477 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080511/098fc953/attachment.patch>

From ricardo at isr.ist.utl.pt  Sun May 11 12:21:39 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Sun, 11 May 2008 11:21:39 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805111206.47111.laurent.pinchart@skynet.be>
References: <200805072043.03701.ricardo@isr.ist.utl.pt>
	<200805111036.16256.ricardo@isr.ist.utl.pt>
	<200805111206.47111.laurent.pinchart@skynet.be>
Message-ID: <200805111121.44209.ricardo@isr.ist.utl.pt>

Hello,

On Sunday 11 May 2008 11:06:46 Laurent Pinchart wrote:
> Hi Ricardo,
>
> On Sunday 11 May 2008, Ricardo Ferreira wrote:
> > Hi, thanks for the response,
> >
> > On Sunday 11 May 2008 09:15:05 Laurent Pinchart wrote:
> > > Hi Ricardo,
> > >
> > > On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> > > > Hello all,
> > > >
> > > > I stumbled upon a problem when using your driver. It seems that it
> > > > blocks on the first VIDIOC_DQBUF ioctl.
> > > >
> > > > I first noticed it in my code using the latest debian
> > > > linux-uvc-source on an amd64 2.6.24 kernel. I assumed it was my
> > > > problem so I tried luvcview and noticed that there was always a 2
> > > > second block the first time that same ioctl was called, but it worked
> > > > flawlessly after that.
> > > >
> > > > After grabing your latest svn driver, luvcview stopped working,
> > > > blocking on the first call to VIDIOC_DQBUF.
> > > >
> > > > I have an integrated webcam:
> > > > Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry Co.,
> > > > Ltd (Foxlink)
> > > >
> > > > since I never heard of this manufacturer, I tried a phillips
> > > > spc1000nc freshly bought. The results were exactly the same.
> > > >
> > > > Do you think it has to do with the driver, this particular kernel,
> > > > amd64 (had some other compatibility issues because of this in the
> > > > past), or anything else?
> > >
> > > Could you please retry with r206 and r207 and compare the results ?
> > > r207 introduces a patch to drop incomplete frames.
> >
> > Yes, that is exactly were it breaks. r206 has that 1-2 second delay the
> > first time DQBUF is called, but after that it is perfect. in r207 the
> > first call to DQBUF never returns.
>
> Thanks for your fast reply.
>
> > > If reverting to r206 helps, I'll ask you to try a patch to get more
> > > information about the issue.
> >
> > sure, whatever helps.
>
> I've attached a patch to this e-mail. Could you please apply it, load the
> driver with the trace parameter set to 143 and report the kernel log
> messages ?

many of these keep repeating:

uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 168960)
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 168960)

Anything else I can do?

Ricardo

>
> Best regards,
>
> Laurent Pinchart


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080511/5189fbe8/attachment.pgp>

From dpmcgee at gmail.com  Sun May 11 16:37:00 2008
From: dpmcgee at gmail.com (Dan McGee)
Date: Sun, 11 May 2008 09:37:00 -0500
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl
In-Reply-To: <200805111016.27854.laurent.pinchart@skynet.be>
References: <449c10960805082023n2ef82d95t110b757126d12be4@mail.gmail.com>
	<200805111016.27854.laurent.pinchart@skynet.be>
Message-ID: <449c10960805110737o21f31a0fkcb4db962cb416298@mail.gmail.com>

On Sun, May 11, 2008 at 3:16 AM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi Dan,
>
>
>  On Friday 09 May 2008, Dan McGee wrote:
>  > I'm seeing this same problem on the Eee PC with the integrated webcam.
>  > Running an strace on the luvcview process shows it coming to a halt on
>  > the following:
>  > ioctl(5, VIDIOC_STREAMON, 0x77eede58)   = 0
>  > ioctl(5, VIDIOC_DQBUF
>  >
>  > and stays there.
>  >
>  > I attempted to track down when this problem started occurring and why,
>  > but I couldn't figure out the why. I know I had a setup where
>  > everything was working with a near-vanilla 2.6.25 kernel and
>  > linux-uvc-svn version 205. The problem started when I compiled
>  > 2.6.25.1 and bumped to SVN revision 207. I attempted to drop back down
>  > to 205 and the problem was still occurring.
Doh! I thought I had been dropping down to 205, futher inspection
tells me my build script was always pulling the head revision. Answers
are below.

> >  Looking through the kernel
>  > changelog from .25 to .25.1 didn't turn up anything obvious as to what
>  > changed causing it to fail.
>
>  I'm pretty surprised that the upgrade from .25 to .25.1 alone caused the
>  problem.
>
>  Could you please retry with r206 and r207 and compare the results ? r207
>  introduces a patch to drop incomplete frames. Check the kernel log to make
>  sure the right driver gets loaded (it should print the SVN revision number
>  when loaded).
>
>  If reverting to r206 helps, I'll ask you to try a patch to get more
>  information about the issue.

The 206 -> 207 transition is in fact what broke it. I'd be happy to
test out any patches you want me to try to help debug this issue.
Commenting out the changes from that revision in
linux-uvc/trunk/uvc_v4l2.c and then compiling the current revision
(209) also solves the problem, as drop_incomplete will never get set.

For this camera, the only output format supported is yuv if that helps
at all, or is a possible configuration that did not get tested.

-Dan


From sboyce at blueyonder.co.uk  Sun May 11 23:13:58 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Sun, 11 May 2008 22:13:58 +0100
Subject: [Linux-uvc-devel] My camera is not listed [Update]
In-Reply-To: <mailman.2552.1210492731.5404.linux-uvc-devel@lists.berlios.de>
References: <mailman.2552.1210492731.5404.linux-uvc-devel@lists.berlios.de>
Message-ID: <48276196.7000602@blueyonder.co.uk>

> 
> Message: 4
> Date: Sun, 11 May 2008 10:06:52 +0200
> From: Laurent Pinchart <laurent.pinchart at skynet.be>
> Subject: Re: [Linux-uvc-devel] My camera is not listed [Update]
> To: linux-uvc-devel at lists.berlios.de
> Message-ID: <200805111006.52719.laurent.pinchart at skynet.be>
> Content-Type: text/plain;  charset="iso-8859-1"
> 
> Hi Hans,
> 
> On Saturday 10 May 2008, Hans-J. Ullrich wrote:
>> Dear maintainers,
>>
>> I saw my camera in my notebook is not listed yet. As you wished, I am
>> reporting this now to you.
>>
>> These are the datas of my built in webcam:
>>
>> Manufacturer: ALI Corporation
>> USB-Code: 	0402:5602
>>
>> I know, you have a similar webcam already running.
>> It is 0402:5605 (ALI Corporation), and this is running fine, as you are
>> telling. So it might be, my camera will run with the driver, too ? Maybe I
>> have to add some params when loading the kernel-module ?
> 
> Have you tested it ? Is it detected by the driver ?
> 
> Please post the output of
> 
> lsusb -d 0402:5602 -v
> 
> using usbutils 0.72 or newer (0.73+ is preferred) as well as any message
> printed by the uvcvideo module to the kernel log.
> 
> Best regards,
> 
> Laurent Pinchart
> 


I thought this camera was supported by the m5602 driver, however, it 
gets recognized but doesn't work and doesn't create a video device. The 
m560x driver recognizes it, creates a device, but likewise it doesn't work.
# dmesg|grep 5602
usb 1-3.4: New USB device found, idVendor=0402, idProduct=5602
m5602: usb_m5602_init - WebCam driver startup
m5602: BisonCam webcam found
m5602: Probing for an ov9650 sensor
m5602: Sensor reported as 0xff:0xff
m5602: No compatible sensor found
usbcore: registered new interface driver m5602
m5602: 0.2.0:M5602 Webcam Driver

My camera is part of a Asus flat screen monitor and I also have a 
Logitech Pro 9000 working with the uvcvideo driver. I must try it with 
just the uvcvideo module built to see what the output of dmesg is.
Is this camera uvc compatible?
Regards
Sid.
-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From sboyce at blueyonder.co.uk  Sun May 11 23:17:37 2008
From: sboyce at blueyonder.co.uk (Sid Boyce)
Date: Sun, 11 May 2008 22:17:37 +0100
Subject: [Linux-uvc-devel] My camera is not listed [Update]
In-Reply-To: <48276196.7000602@blueyonder.co.uk>
References: <mailman.2552.1210492731.5404.linux-uvc-devel@lists.berlios.de>
	<48276196.7000602@blueyonder.co.uk>
Message-ID: <48276271.1000402@blueyonder.co.uk>

Sid Boyce wrote:
>>
>> Message: 4
>> Date: Sun, 11 May 2008 10:06:52 +0200
>> From: Laurent Pinchart <laurent.pinchart at skynet.be>
>> Subject: Re: [Linux-uvc-devel] My camera is not listed [Update]
>> To: linux-uvc-devel at lists.berlios.de
>> Message-ID: <200805111006.52719.laurent.pinchart at skynet.be>
>> Content-Type: text/plain; charset="iso-8859-1"
>>
>> Hi Hans,
>>
>> On Saturday 10 May 2008, Hans-J. Ullrich wrote:
>>> Dear maintainers,
>>>
>>> I saw my camera in my notebook is not listed yet. As you wished, I am
>>> reporting this now to you.
>>>
>>> These are the datas of my built in webcam:
>>>
>>> Manufacturer: ALI Corporation
>>> USB-Code: 0402:5602
>>>
>>> I know, you have a similar webcam already running.
>>> It is 0402:5605 (ALI Corporation), and this is running fine, as you are
>>> telling. So it might be, my camera will run with the driver, too ? 
>>> Maybe I
>>> have to add some params when loading the kernel-module ?
>>
>> Have you tested it ? Is it detected by the driver ?
>>
>> Please post the output of
>>
>> lsusb -d 0402:5602 -v
>>
>> using usbutils 0.72 or newer (0.73+ is preferred) as well as any message
>> printed by the uvcvideo module to the kernel log.
>>
>> Best regards,
>>
>> Laurent Pinchart
>>
> 
> 
> I thought this camera was supported by the m5602 driver, however, it 
> gets recognized but doesn't work and doesn't create a video device. The 
> m560x driver recognizes it, creates a device, but likewise it doesn't work.
> # dmesg|grep 5602
> usb 1-3.4: New USB device found, idVendor=0402, idProduct=5602
> m5602: usb_m5602_init - WebCam driver startup
> m5602: BisonCam webcam found
> m5602: Probing for an ov9650 sensor
> m5602: Sensor reported as 0xff:0xff
> m5602: No compatible sensor found
> usbcore: registered new interface driver m5602
> m5602: 0.2.0:M5602 Webcam Driver
> 
> My camera is part of a Asus flat screen monitor and I also have a 
> Logitech Pro 9000 working with the uvcvideo driver. I must try it with 
> just the uvcvideo module built to see what the output of dmesg is.
> Is this camera uvc compatible?
> Regards
> Sid.

Question answered by Laurent in latest digest. The m560x/m5602 driver 
may one day support it.
Regards
Sid.

-- 
Sid Boyce ... Hamradio License G3VBV, Licensed Private Pilot
Emeritus IBM/Amdahl Mainframes and Sun/Fujitsu Servers Tech Support 
Specialist, Cricket Coach
Microsoft Windows Free Zone - Linux used for all Computing Tasks



From dpsaxena at hotmail.com  Mon May 12 18:56:33 2008
From: dpsaxena at hotmail.com (D saxena)
Date: Mon, 12 May 2008 22:26:33 +0530
Subject: [Linux-uvc-devel] troubled with make file in UVC driver
Message-ID: <BLU138-W4629F896B3A26D22197391DBCC0@phx.gbl>

Dear All,whenever I attempt to download "Makefile " from the website http://svn.berlios.de/viewcvs/linux-uvc/linux-uvc/trunk/?rev=209, it is downloaded as text file.Is it right ?rest every file is downloaded as per their extension, Is it a correct behavior for Makefile?That's why the driver is not getting compiled and giver following errors:
============================================================================================================
[root at localhost ~]# cd TRUNK-new/[root at localhost TRUNK-new]# makeBuilding USB Video Class driver...make[1]: Entering directory `/usr/src/kernels/2.6.9-5.EL-i686'  CC [M]  /root/TRUNK-new/uvc_driver.oIn file included from /root/TRUNK-new/uvcvideo.h:7,                 from /root/TRUNK-new/uvc_driver.c:40:/root/TRUNK-new/uvc_compat.h:185: error: syntax error before "gfp_flags"/root/TRUNK-new/uvc_compat.h:186: warning: function declaration isn't a prototype/root/TRUNK-new/uvc_compat.h: In function `kzalloc':/root/TRUNK-new/uvc_compat.h:187: error: `size' undeclared (first use in this function)/root/TRUNK-new/uvc_compat.h:187: error: (Each undeclared identifier is reported only once/root/TRUNK-new/uvc_compat.h:187: error: for each function it appears in.)/root/TRUNK-new/uvc_compat.h:187: error: `gfp_flags' undeclared (first use in this function)/root/TRUNK-new/uvc_compat.h: In function `vm_insert_page':/root/TRUNK-new/uvc_compat.h:208: warning: implicit declaration of function `remap_pfn_range'/root/TRUNK-new/uvc_driver.c: In function `uvc_probe':/root/TRUNK-new/uvc_driver.c:1551: error: structure has no member named `product'/root/TRUNK-new/uvc_driver.c:1552: error: structure has no member named `product'/root/TRUNK-new/uvc_driver.c:1566: error: structure has no member named `product'/root/TRUNK-new/uvc_driver.c:1566: error: structure has no member named `product'/root/TRUNK-new/uvc_driver.c: At top level:/root/TRUNK-new/uvc_driver.c:1635: error: syntax error before "pm_message_t"/root/TRUNK-new/uvc_driver.c:1636: warning: function declaration isn't a prototype/root/TRUNK-new/uvc_driver.c: In function `uvc_suspend':/root/TRUNK-new/uvc_driver.c:1637: error: `intf' undeclared (first use in this function)make[2]: *** [/root/TRUNK-new/uvc_driver.o] Error 1make[1]: *** [_module_/root/TRUNK-new] Error 2make[1]: Leaving directory `/usr/src/kernels/2.6.9-5.EL-i686'make: *** [uvcvideo] Error 2[root at localhost TRUNK-new]#==============================================================================================================pls guide me OR if any one can attach a folder containing the correct driver for uvc,in the reply of this mail, then it will be real help to me ...regards,Dharm
_________________________________________________________________
Timely update on all current affairs, sports, events and all thats in News here on MSN videos.
http://video.msn.com/?mkt=en-in
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080512/66ff2eac/attachment.html>

From pierre-eloi.bontinck at macopharma.com  Tue May 13 11:51:48 2008
From: pierre-eloi.bontinck at macopharma.com (pierre-eloi bontinck)
Date: Tue, 13 May 2008 11:51:48 +0200
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
Message-ID: <CEEC8DCC359B5E4E86163FCC7CA77A050499148F@EXCHANGE.gmp.local>

Dear all,
 
I did not succeed in getting 90fps on philips 1300NC webcam (30fps max).
I notice that private control are not read by luvcview. Adavanced
functionalities aren't accessible also (shutter priority, etc...). What
can I do ? 
 
(I tried to find a limitation to 30fps in the .c files, but did not find
it - tried also to write a config file for luvcview with values for
private control, but without success).
 
Thank you,
 
P.E.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080513/5100e5ac/attachment.html>

From daniel.pastrana at gmail.com  Wed May 14 15:01:31 2008
From: daniel.pastrana at gmail.com (Daniel CABRERA)
Date: Wed, 14 May 2008 15:01:31 +0200
Subject: [Linux-uvc-devel] Logitech Quickcame deluxe for notebooks
	(046d:09c1) UNSTABLE error -84
In-Reply-To: <200805021630.02152.laurent.pinchart@skynet.be>
References: <d59b0cd40804220415m3cf8242bjfea6c7a990e4c51f@mail.gmail.com>
	<200804250050.36500.laurent.pinchart@skynet.be>
	<d59b0cd40804250106mf5a16e3j1f2f2218ba084574@mail.gmail.com>
	<200805021630.02152.laurent.pinchart@skynet.be>
Message-ID: <d59b0cd40805140601n5f267b71n65c91d62931d25ae@mail.gmail.com>

Hi Laurent,

I apologize to do not answer you before, but I took some weeks off and
I did not check my mails ;0) . I noticed a very slow performance right
away in my system when I start using my webcam with either luvcview,
or skype. Even when I try to move the mouse the cursor does not move
smoothly it all, the GUI does not respond as fast as when a webcam
application( skype, luvcview) is using the webcab . I check the dmesg
if this could be related to a huge flow of constant warnings or error
messages, but that is not the case.

I guess my system is more susceptible to this condition, because it is
a laptop with an Intel Pentium M @ 800Mhz and 256 Megas of RAM :(

I do not know how to measure the performance, before and after using
the webcam any idea? Do you recommend any tool to give you more
accurate info?

A+

On Fri, May 2, 2008 at 4:30 PM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi Daniel,
>
> On Friday 25 April 2008, Daniel CABRERA wrote:
>> Laurent,
>>
>> I am not sure if the issue is 10% related to the -84 error, because as
>> you can see on the following log msgs. the interval is kind of high,
>> which made me think that this is only part of the issue. This log was
>> dumped during the execution of luvcview (2007/05/12).
>>
>> Thx again for your support and in the name of some lost souls like me thx
>> ;).
>>
>> Please let me know if you need me to test or evaluate anything else.
>
> Can you describe your performance issue in more details ?
>
> Best regards,
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From barsnick at gmx.net  Wed May 14 23:01:42 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 14 May 2008 23:01:42 +0200
Subject: [Linux-uvc-devel] troubled with make file in UVC driver
In-Reply-To: <BLU138-W4629F896B3A26D22197391DBCC0@phx.gbl>
References: <BLU138-W4629F896B3A26D22197391DBCC0@phx.gbl>
Message-ID: <20080514210142.GB14051@sunshine.barsnick.net>

Hi Dharm,

On Mon, May 12, 2008 at 22:26:33 +0530, D saxena wrote:

> whenever I attempt to download "Makefile " from the website http://
> svn.berlios.de/viewcvs/linux-uvc/linux-uvc/trunk/?rev=209, it is downloaded as
> text file.
> Is it right ?

It is correct to save it as a text file. But you should ideally be
fetching those files with an SVN client, not with your web browser.

> That's why the driver is not getting compiled and giver following
> errors:
[...]
> make[1]: Entering directory `/usr/src/kernels/2.6.9-5.EL-i686'

Your kernel is too old to properly work with this UVC driver. You
cannot build the driver, except perhaps without a lot of hacks and
tricks.

I know this is unfortunate, but RHEL tends to stick to old kernel
versions. You might want to figure out whether there's a repository
which provides newer kernels, or switch to Fedora. ;-)

Sorry,
Moritz


From barsnick at gmx.net  Wed May 14 23:14:33 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 14 May 2008 23:14:33 +0200
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
In-Reply-To: <CEEC8DCC359B5E4E86163FCC7CA77A050499148F@EXCHANGE.gmp.local>
References: <CEEC8DCC359B5E4E86163FCC7CA77A050499148F@EXCHANGE.gmp.local>
Message-ID: <20080514211433.GC14051@sunshine.barsnick.net>

Hi Pierre-Eloi,

On Tue, May 13, 2008 at 11:51:48 +0200, pierre-eloi bontinck wrote:

> I did not succeed in getting 90fps on philips 1300NC webcam (30fps
> max).

Did you get the error message "Unable to set frame rate"?

> (I tried to find a limitation to 30fps in the .c files, but did not
> find it

There is none - luvcview tries to set the frame rate and evaluates the
response from the driver.


> I notice that private control are not read by luvcview. Adavanced
> functionalities aren't accessible also (shutter priority, etc...).
> What can I do ?

Ah, it may have another cause then. What sort of error messages are you
getting (also dmesg)?

Moritz


From laurent.pinchart at skynet.be  Thu May 15 14:55:18 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 15 May 2008 14:55:18 +0200
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
In-Reply-To: <CEEC8DCC359B5E4E86163FCC7CA77A050499148F@EXCHANGE.gmp.local>
References: <CEEC8DCC359B5E4E86163FCC7CA77A050499148F@EXCHANGE.gmp.local>
Message-ID: <200805151455.18776.laurent.pinchart@skynet.be>

Hi Pierre-Eloi,

On Tuesday 13 May 2008, pierre-eloi bontinck wrote:
> Dear all,
>
> I did not succeed in getting 90fps on philips 1300NC webcam (30fps max).
> I notice that private control are not read by luvcview. Adavanced
> functionalities aren't accessible also (shutter priority, etc...). What
> can I do ?
>
> (I tried to find a limitation to 30fps in the .c files, but did not find
> it - tried also to write a config file for luvcview with values for
> private control, but without success).

Could you please post the output of lsusb -v (using usbutils 0.72 or newer) ? 
The SPC1300NC USB descriptors I got report a max frame rate of 30fps. I 
wouldn't be surprised if the 90fps were the result of software interpolation 
in the Windows driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 15 15:25:33 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 15 May 2008 15:25:33 +0200
Subject: [Linux-uvc-devel] Logitech Quickcame deluxe for notebooks
	(046d:09c1) UNSTABLE error -84
In-Reply-To: <d59b0cd40805140601n5f267b71n65c91d62931d25ae@mail.gmail.com>
References: <d59b0cd40804220415m3cf8242bjfea6c7a990e4c51f@mail.gmail.com>
	<200805021630.02152.laurent.pinchart@skynet.be>
	<d59b0cd40805140601n5f267b71n65c91d62931d25ae@mail.gmail.com>
Message-ID: <200805151525.33575.laurent.pinchart@skynet.be>

Hi Daniel,

On Wednesday 14 May 2008, Daniel CABRERA wrote:
> Hi Laurent,
>
> I apologize to do not answer you before, but I took some weeks off and
> I did not check my mails ;0) . I noticed a very slow performance right
> away in my system when I start using my webcam with either luvcview,
> or skype. Even when I try to move the mouse the cursor does not move
> smoothly it all, the GUI does not respond as fast as when a webcam
> application( skype, luvcview) is using the webcab . I check the dmesg
> if this could be related to a huge flow of constant warnings or error
> messages, but that is not the case.
>
> I guess my system is more susceptible to this condition, because it is
> a laptop with an Intel Pentium M @ 800Mhz and 256 Megas of RAM :(
>
> I do not know how to measure the performance, before and after using
> the webcam any idea? Do you recommend any tool to give you more
> accurate info?

The driver probably consumes too much memory, CPU time or both.

First of all, please check if the system performance is restored when you 
close the video application. I'll assume it is.

Could you try to lower the resolution and/or the frame rate in luvcview and 
report changes in system performances ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 15 15:28:18 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 15 May 2008 15:28:18 +0200
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl
In-Reply-To: <449c10960805110737o21f31a0fkcb4db962cb416298@mail.gmail.com>
References: <449c10960805082023n2ef82d95t110b757126d12be4@mail.gmail.com>
	<200805111016.27854.laurent.pinchart@skynet.be>
	<449c10960805110737o21f31a0fkcb4db962cb416298@mail.gmail.com>
Message-ID: <200805151528.18815.laurent.pinchart@skynet.be>

Hi Dan,

On Sunday 11 May 2008, Dan McGee wrote:
> On Sun, May 11, 2008 at 3:16 AM, Laurent Pinchart
>
> <laurent.pinchart at skynet.be> wrote:
> > Hi Dan,
> >
> >  On Friday 09 May 2008, Dan McGee wrote:
> >  > I'm seeing this same problem on the Eee PC with the integrated webcam.
> >  > Running an strace on the luvcview process shows it coming to a halt on
> >  > the following:
> >  > ioctl(5, VIDIOC_STREAMON, 0x77eede58)   = 0
> >  > ioctl(5, VIDIOC_DQBUF
> >  >
> >  > and stays there.
> >  >
> >  > I attempted to track down when this problem started occurring and why,
> >  > but I couldn't figure out the why. I know I had a setup where
> >  > everything was working with a near-vanilla 2.6.25 kernel and
> >  > linux-uvc-svn version 205. The problem started when I compiled
> >  > 2.6.25.1 and bumped to SVN revision 207. I attempted to drop back down
> >  > to 205 and the problem was still occurring.
>
> Doh! I thought I had been dropping down to 205, futher inspection
> tells me my build script was always pulling the head revision. Answers
> are below.
>
> > >  Looking through the kernel
> > >
> >  > changelog from .25 to .25.1 didn't turn up anything obvious as to what
> >  > changed causing it to fail.
> >
> >  I'm pretty surprised that the upgrade from .25 to .25.1 alone caused the
> >  problem.
> >
> >  Could you please retry with r206 and r207 and compare the results ? r207
> >  introduces a patch to drop incomplete frames. Check the kernel log to
> > make sure the right driver gets loaded (it should print the SVN revision
> > number when loaded).
> >
> >  If reverting to r206 helps, I'll ask you to try a patch to get more
> >  information about the issue.
>
> The 206 -> 207 transition is in fact what broke it. I'd be happy to
> test out any patches you want me to try to help debug this issue.
> Commenting out the changes from that revision in
> linux-uvc/trunk/uvc_v4l2.c and then compiling the current revision
> (209) also solves the problem, as drop_incomplete will never get set.
>
> For this camera, the only output format supported is yuv if that helps
> at all, or is a possible configuration that did not get tested.

Coud you please test the patch attached to 
https://lists.berlios.de/pipermail/linux-uvc-devel/2008-May/003500.html ? 
Instructions are available in the mail.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 15 15:35:12 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 15 May 2008 15:35:12 +0200
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805111121.44209.ricardo@isr.ist.utl.pt>
References: <200805072043.03701.ricardo@isr.ist.utl.pt>
	<200805111206.47111.laurent.pinchart@skynet.be>
	<200805111121.44209.ricardo@isr.ist.utl.pt>
Message-ID: <200805151535.12881.laurent.pinchart@skynet.be>

Hi Ricardo,

On Sunday 11 May 2008, Ricardo Ferreira wrote:
> Hello,
>
> On Sunday 11 May 2008 11:06:46 Laurent Pinchart wrote:
> > Hi Ricardo,
> >
> > On Sunday 11 May 2008, Ricardo Ferreira wrote:
> > > Hi, thanks for the response,
> > >
> > > On Sunday 11 May 2008 09:15:05 Laurent Pinchart wrote:
> > > > Hi Ricardo,
> > > >
> > > > On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> > > > > Hello all,
> > > > >
> > > > > I stumbled upon a problem when using your driver. It seems that it
> > > > > blocks on the first VIDIOC_DQBUF ioctl.
> > > > >
> > > > > I first noticed it in my code using the latest debian
> > > > > linux-uvc-source on an amd64 2.6.24 kernel. I assumed it was my
> > > > > problem so I tried luvcview and noticed that there was always a 2
> > > > > second block the first time that same ioctl was called, but it
> > > > > worked flawlessly after that.
> > > > >
> > > > > After grabing your latest svn driver, luvcview stopped working,
> > > > > blocking on the first call to VIDIOC_DQBUF.
> > > > >
> > > > > I have an integrated webcam:
> > > > > Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry Co.,
> > > > > Ltd (Foxlink)
> > > > >
> > > > > since I never heard of this manufacturer, I tried a phillips
> > > > > spc1000nc freshly bought. The results were exactly the same.
> > > > >
> > > > > Do you think it has to do with the driver, this particular kernel,
> > > > > amd64 (had some other compatibility issues because of this in the
> > > > > past), or anything else?
> > > >
> > > > Could you please retry with r206 and r207 and compare the results ?
> > > > r207 introduces a patch to drop incomplete frames.
> > >
> > > Yes, that is exactly were it breaks. r206 has that 1-2 second delay the
> > > first time DQBUF is called, but after that it is perfect. in r207 the
> > > first call to DQBUF never returns.
> >
> > Thanks for your fast reply.
> >
> > > > If reverting to r206 helps, I'll ask you to try a patch to get more
> > > > information about the issue.
> > >
> > > sure, whatever helps.
> >
> > I've attached a patch to this e-mail. Could you please apply it, load the
> > driver with the trace parameter set to 143 and report the kernel log
> > messages ?
>
> many of these keep repeating:
>
> uvcvideo: Frame complete (EOF found).
> uvcvideo: EOF in empty payload.
> uvcvideo: incomplete buffer (153600 bytes, expected 168960)
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Frame complete (EOF found).
> uvcvideo: EOF in empty payload.
> uvcvideo: incomplete buffer (153600 bytes, expected 168960)
>
> Anything else I can do?

Looks like a bug in the camera :-/

Could you try with different resolutions and report the number of bytes 
received and expected number of bytes for each resolution supported by the 
camera ? I'd appreciate if you could perform the test for both the Foxlink 
and Philips cameras.

Please also post the output of lsusb -v for both cameras.

Best regards,

Laurent Pinchart


From ricardo at isr.ist.utl.pt  Thu May 15 16:03:45 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Thu, 15 May 2008 15:03:45 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
Message-ID: <200805151503.45960.ricardo@isr.ist.utl.pt>

Hello,

On Thursday 15 May 2008 14:35:12 you wrote:
> Hi Ricardo,
>
> On Sunday 11 May 2008, Ricardo Ferreira wrote:
> > Hello,
> >
> > On Sunday 11 May 2008 11:06:46 Laurent Pinchart wrote:
> > > Hi Ricardo,
> > >
> > > On Sunday 11 May 2008, Ricardo Ferreira wrote:
> > > > Hi, thanks for the response,
> > > >
> > > > On Sunday 11 May 2008 09:15:05 Laurent Pinchart wrote:
> > > > > Hi Ricardo,
> > > > >
> > > > > On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> > > > > > Hello all,
> > > > > >
> > > > > > I stumbled upon a problem when using your driver. It seems that
> > > > > > it blocks on the first VIDIOC_DQBUF ioctl.
> > > > > >
> > > > > > I first noticed it in my code using the latest debian
> > > > > > linux-uvc-source on an amd64 2.6.24 kernel. I assumed it was my
> > > > > > problem so I tried luvcview and noticed that there was always a 2
> > > > > > second block the first time that same ioctl was called, but it
> > > > > > worked flawlessly after that.
> > > > > >
> > > > > > After grabing your latest svn driver, luvcview stopped working,
> > > > > > blocking on the first call to VIDIOC_DQBUF.
> > > > > >
> > > > > > I have an integrated webcam:
> > > > > > Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry
> > > > > > Co., Ltd (Foxlink)
> > > > > >
> > > > > > since I never heard of this manufacturer, I tried a phillips
> > > > > > spc1000nc freshly bought. The results were exactly the same.
> > > > > >
> > > > > > Do you think it has to do with the driver, this particular
> > > > > > kernel, amd64 (had some other compatibility issues because of
> > > > > > this in the past), or anything else?
> > > > >
> > > > > Could you please retry with r206 and r207 and compare the results ?
> > > > > r207 introduces a patch to drop incomplete frames.
> > > >
> > > > Yes, that is exactly were it breaks. r206 has that 1-2 second delay
> > > > the first time DQBUF is called, but after that it is perfect. in r207
> > > > the first call to DQBUF never returns.
> > >
> > > Thanks for your fast reply.
> > >
> > > > > If reverting to r206 helps, I'll ask you to try a patch to get more
> > > > > information about the issue.
> > > >
> > > > sure, whatever helps.
> > >
> > > I've attached a patch to this e-mail. Could you please apply it, load
> > > the driver with the trace parameter set to 143 and report the kernel
> > > log messages ?
> >
> > many of these keep repeating:
> >
> > uvcvideo: Frame complete (EOF found).
> > uvcvideo: EOF in empty payload.
> > uvcvideo: incomplete buffer (153600 bytes, expected 168960)
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Dropping payload (out of sync).
> > uvcvideo: Frame complete (EOF found).
> > uvcvideo: EOF in empty payload.
> > uvcvideo: incomplete buffer (153600 bytes, expected 168960)
> >
> > Anything else I can do?
>
> Looks like a bug in the camera :-/
>

Notice that I applied the patch to version 207 (that's what it said on the 
patch that you sent me). It "kind of works" in 206.

> Could you try with different resolutions and report the number of bytes
> received and expected number of bytes for each resolution supported by the
> camera ? I'd appreciate if you could perform the test for both the Foxlink
> and Philips cameras.

Yes, the Foxlink I can provide immediatly, but the Phillips will have to wait 
for Sunday.

Here is the dmesg information relevant for when I load the module (with 
trace=143):

uvcvideo: Adding mapping Brightness to control 
00000000-0000-0000-0000-000000000101/2.
uvcvideo: Adding mapping Contrast to control 
00000000-0000-0000-0000-000000000101/3.
uvcvideo: Adding mapping Hue to control 
00000000-0000-0000-0000-000000000101/6.
uvcvideo: Adding mapping Saturation to control 
00000000-0000-0000-0000-000000000101/7.
uvcvideo: Adding mapping Sharpness to control 
00000000-0000-0000-0000-000000000101/8.
uvcvideo: Adding mapping Gamma to control 
00000000-0000-0000-0000-000000000101/9.
uvcvideo: Adding mapping Backlight Compensation to control 
00000000-0000-0000-0000-000000000101/1.
uvcvideo: Adding mapping Gain to control 
00000000-0000-0000-0000-000000000101/4.
uvcvideo: Adding mapping Power Line Frequency to control 
00000000-0000-0000-0000-000000000101/5.
uvcvideo: Adding mapping Hue, Auto to control 
00000000-0000-0000-0000-000000000101/16.
uvcvideo: Adding mapping Exposure, Auto to control 
00000000-0000-0000-0000-000000000001/2.
uvcvideo: Adding mapping Exposure, Auto Priority to control 
00000000-0000-0000-0000-000000000001/3.
uvcvideo: Adding mapping Exposure (Absolute) to control 
00000000-0000-0000-0000-000000000001/4.
uvcvideo: Adding mapping White Balance Temperature, Auto to control 
00000000-0000-0000-0000-000000000101/11.
uvcvideo: Adding mapping White Balance Temperature to control 
00000000-0000-0000-0000-000000000101/10.
uvcvideo: Adding mapping White Balance Component, Auto to control 
00000000-0000-0000-0000-000000000101/13.
uvcvideo: Adding mapping White Balance Blue Component to control 
00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping White Balance Red Component to control 
00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping Focus (absolute) to control 
00000000-0000-0000-0000-000000000001/6.
uvcvideo: Adding mapping Focus, Auto to control 
00000000-0000-0000-0000-000000000001/8.
uvcvideo: Probing generic UVC device 4
uvcvideo: Found format YUV 4:2:2 (YUYV).
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 1280x960 (9.0 fps)
uvcvideo: - 1280x1024 (9.0 fps)
uvcvideo: Found a Status endpoint (addr 83).
uvcvideo: Found UVC 1.00 device FO13FF-65 PC-CAM (05c8:0103)
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 4 
entity 3
uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
uvcvideo: Found a valid video chain (1 -> 2).
input: FO13FF-65 PC-CAM as /class/input/input13
uvcvideo: Trying format 0x56595559 (YUYV): 10000x10000.
uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
uvcvideo: UVC device initialized.
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r207)



Now for each resolution:
640x480: uvcvideo: incomplete buffer (614400 bytes, expected 675840)
352x288: uvcvideo: incomplete buffer (202752 bytes, expected 223027)
320x240:  uvcvideo: incomplete buffer (153600 bytes, expected 168960)
176x144: uvcvideo: incomplete buffer (50688 bytes, expected 55756)
160x120: uvcvideo: incomplete buffer (38400 bytes, expected 42240)
1280x960: Here Many messages containing 

uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
uvcvideo: Dropping payload (out of sync).
(continue many more of these Dropping payload, and then keep repeating the 
Frame complete and EOF in empty payload) 

But luvcview actually works after an initial 3-4 second delay. In these 3 or 4 
seconds the following appears:

uvcvideo: Trying format 0x56595559 (YUYV): 1280x960.
uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
uvcvideo: Setting frame interval to 1/15 (666666).
uvcvideo: Frame complete (FID bit toggled).
uvcvideo: incomplete buffer (8160 bytes, expected 2457600) <-- NOTICE THIS ONE
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.


1280x1024: Same thing as the 1280x960 case. Here's the output of dmesg

uvcvideo: Trying format 0x56595559 (YUYV): 1280x1024.
uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
uvcvideo: Setting frame interval to 1/15 (666666).
uvcvideo: Frame complete (FID bit toggled).
uvcvideo: incomplete buffer (8160 bytes, expected 2621440)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.


>
> Please also post the output of lsusb -v for both cameras.

the result follows (large stream). sorry for this :)


ricardo at LatasG:~$ sudo lsusb  -v -s 6:2

Bus 006 Device 002: ID 05c8:0103 Cheng Uei Precision Industry Co., Ltd 
(Foxlink)
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x05c8 Cheng Uei Precision Industry Co., Ltd (Foxlink)
  idProduct          0x0103
  bcdDevice            1.10
  iManufacturer           2 Foxlink
  iProduct                1 FO13FF-65 PC-CAM
  iSerial                 3 1.10
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          653
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower               98mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               1 FO13FF-65 PC-CAM
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              1 FO13FF-65 PC-CAM
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0x01
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000053f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      407
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat                            
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   614400
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   202752
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   153600
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                    50688
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                    38400
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
        dwFrameInterval( 5)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                  2457600
        dwMaxBitRate                 22118400
        dwMaxVideoFrameBufferSize     2457600
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
        dwFrameInterval( 2)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                  2621440
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
        dwFrameInterval( 2)          10000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               7
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        352
        wHeight( 1)                       288
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        176
        wHeight( 3)                       144
        wWidth( 4)                        160
        wHeight( 4)                       120
        wWidth( 5)                       1280
        wHeight( 5)                       960
        wWidth( 6)                       1280
        wHeight( 6)                      1024
        bNumCompressionPatterns             7
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


>
> Best regards,
>
> Laurent Pinchart

Hope it helps. Sunday I'll repeat the tests for the Phillips.

Ricardo

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080515/158aa6a2/attachment.pgp>

From ricardo at isr.ist.utl.pt  Thu May 15 16:20:43 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Thu, 15 May 2008 15:20:43 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805151503.45960.ricardo@isr.ist.utl.pt>
References: <200805151503.45960.ricardo@isr.ist.utl.pt>
Message-ID: <200805151520.43239.ricardo@isr.ist.utl.pt>

I don't understand anything of how to acquire frames from the "usb cable", but 
these two lines that I sent you seem conflicting (seen in the high resolution 
modes that apparently do work):

uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
uvcvideo: Setting frame interval to 1/15 (666666).

(notice that the camera mode list states that it should be 9.0fps).

Sorry, This is probably just noise from my part and will do nothing to help 
solve the problem.

Ricardo

On Thursday 15 May 2008 15:03:45 Ricardo Ferreira wrote:
> Hello,
>
> On Thursday 15 May 2008 14:35:12 you wrote:
> > Hi Ricardo,
> >
> > On Sunday 11 May 2008, Ricardo Ferreira wrote:
> > > Hello,
> > >
> > > On Sunday 11 May 2008 11:06:46 Laurent Pinchart wrote:
> > > > Hi Ricardo,
> > > >
> > > > On Sunday 11 May 2008, Ricardo Ferreira wrote:
> > > > > Hi, thanks for the response,
> > > > >
> > > > > On Sunday 11 May 2008 09:15:05 Laurent Pinchart wrote:
> > > > > > Hi Ricardo,
> > > > > >
> > > > > > On Wednesday 07 May 2008, Ricardo Ferreira wrote:
> > > > > > > Hello all,
> > > > > > >
> > > > > > > I stumbled upon a problem when using your driver. It seems that
> > > > > > > it blocks on the first VIDIOC_DQBUF ioctl.
> > > > > > >
> > > > > > > I first noticed it in my code using the latest debian
> > > > > > > linux-uvc-source on an amd64 2.6.24 kernel. I assumed it was my
> > > > > > > problem so I tried luvcview and noticed that there was always a
> > > > > > > 2 second block the first time that same ioctl was called, but
> > > > > > > it worked flawlessly after that.
> > > > > > >
> > > > > > > After grabing your latest svn driver, luvcview stopped working,
> > > > > > > blocking on the first call to VIDIOC_DQBUF.
> > > > > > >
> > > > > > > I have an integrated webcam:
> > > > > > > Bus 006 Device 003: ID 05c8:0103 Cheng Uei Precision Industry
> > > > > > > Co., Ltd (Foxlink)
> > > > > > >
> > > > > > > since I never heard of this manufacturer, I tried a phillips
> > > > > > > spc1000nc freshly bought. The results were exactly the same.
> > > > > > >
> > > > > > > Do you think it has to do with the driver, this particular
> > > > > > > kernel, amd64 (had some other compatibility issues because of
> > > > > > > this in the past), or anything else?
> > > > > >
> > > > > > Could you please retry with r206 and r207 and compare the results
> > > > > > ? r207 introduces a patch to drop incomplete frames.
> > > > >
> > > > > Yes, that is exactly were it breaks. r206 has that 1-2 second delay
> > > > > the first time DQBUF is called, but after that it is perfect. in
> > > > > r207 the first call to DQBUF never returns.
> > > >
> > > > Thanks for your fast reply.
> > > >
> > > > > > If reverting to r206 helps, I'll ask you to try a patch to get
> > > > > > more information about the issue.
> > > > >
> > > > > sure, whatever helps.
> > > >
> > > > I've attached a patch to this e-mail. Could you please apply it, load
> > > > the driver with the trace parameter set to 143 and report the kernel
> > > > log messages ?
> > >
> > > many of these keep repeating:
> > >
> > > uvcvideo: Frame complete (EOF found).
> > > uvcvideo: EOF in empty payload.
> > > uvcvideo: incomplete buffer (153600 bytes, expected 168960)
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Dropping payload (out of sync).
> > > uvcvideo: Frame complete (EOF found).
> > > uvcvideo: EOF in empty payload.
> > > uvcvideo: incomplete buffer (153600 bytes, expected 168960)
> > >
> > > Anything else I can do?
> >
> > Looks like a bug in the camera :-/
>
> Notice that I applied the patch to version 207 (that's what it said on the
> patch that you sent me). It "kind of works" in 206.
>
> > Could you try with different resolutions and report the number of bytes
> > received and expected number of bytes for each resolution supported by
> > the camera ? I'd appreciate if you could perform the test for both the
> > Foxlink and Philips cameras.
>
> Yes, the Foxlink I can provide immediatly, but the Phillips will have to
> wait for Sunday.
>
> Here is the dmesg information relevant for when I load the module (with
> trace=143):
>
> uvcvideo: Adding mapping Brightness to control
> 00000000-0000-0000-0000-000000000101/2.
> uvcvideo: Adding mapping Contrast to control
> 00000000-0000-0000-0000-000000000101/3.
> uvcvideo: Adding mapping Hue to control
> 00000000-0000-0000-0000-000000000101/6.
> uvcvideo: Adding mapping Saturation to control
> 00000000-0000-0000-0000-000000000101/7.
> uvcvideo: Adding mapping Sharpness to control
> 00000000-0000-0000-0000-000000000101/8.
> uvcvideo: Adding mapping Gamma to control
> 00000000-0000-0000-0000-000000000101/9.
> uvcvideo: Adding mapping Backlight Compensation to control
> 00000000-0000-0000-0000-000000000101/1.
> uvcvideo: Adding mapping Gain to control
> 00000000-0000-0000-0000-000000000101/4.
> uvcvideo: Adding mapping Power Line Frequency to control
> 00000000-0000-0000-0000-000000000101/5.
> uvcvideo: Adding mapping Hue, Auto to control
> 00000000-0000-0000-0000-000000000101/16.
> uvcvideo: Adding mapping Exposure, Auto to control
> 00000000-0000-0000-0000-000000000001/2.
> uvcvideo: Adding mapping Exposure, Auto Priority to control
> 00000000-0000-0000-0000-000000000001/3.
> uvcvideo: Adding mapping Exposure (Absolute) to control
> 00000000-0000-0000-0000-000000000001/4.
> uvcvideo: Adding mapping White Balance Temperature, Auto to control
> 00000000-0000-0000-0000-000000000101/11.
> uvcvideo: Adding mapping White Balance Temperature to control
> 00000000-0000-0000-0000-000000000101/10.
> uvcvideo: Adding mapping White Balance Component, Auto to control
> 00000000-0000-0000-0000-000000000101/13.
> uvcvideo: Adding mapping White Balance Blue Component to control
> 00000000-0000-0000-0000-000000000101/12.
> uvcvideo: Adding mapping White Balance Red Component to control
> 00000000-0000-0000-0000-000000000101/12.
> uvcvideo: Adding mapping Focus (absolute) to control
> 00000000-0000-0000-0000-000000000001/6.
> uvcvideo: Adding mapping Focus, Auto to control
> 00000000-0000-0000-0000-000000000001/8.
> uvcvideo: Probing generic UVC device 4
> uvcvideo: Found format YUV 4:2:2 (YUYV).
> uvcvideo: - 640x480 (30.0 fps)
> uvcvideo: - 352x288 (30.0 fps)
> uvcvideo: - 320x240 (30.0 fps)
> uvcvideo: - 176x144 (30.0 fps)
> uvcvideo: - 160x120 (30.0 fps)
> uvcvideo: - 1280x960 (9.0 fps)
> uvcvideo: - 1280x1024 (9.0 fps)
> uvcvideo: Found a Status endpoint (addr 83).
> uvcvideo: Found UVC 1.00 device FO13FF-65 PC-CAM (05c8:0103)
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 4
> entity 3
> uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
> uvcvideo: Found a valid video chain (1 -> 2).
> input: FO13FF-65 PC-CAM as /class/input/input13
> uvcvideo: Trying format 0x56595559 (YUYV): 10000x10000.
> uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
> uvcvideo: UVC device initialized.
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (SVN r207)
>
>
>
> Now for each resolution:
> 640x480: uvcvideo: incomplete buffer (614400 bytes, expected 675840)
> 352x288: uvcvideo: incomplete buffer (202752 bytes, expected 223027)
> 320x240:  uvcvideo: incomplete buffer (153600 bytes, expected 168960)
> 176x144: uvcvideo: incomplete buffer (50688 bytes, expected 55756)
> 160x120: uvcvideo: incomplete buffer (38400 bytes, expected 42240)
> 1280x960: Here Many messages containing
>
> uvcvideo: Frame complete (EOF found).
> uvcvideo: EOF in empty payload.
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> uvcvideo: Dropping payload (out of sync).
> (continue many more of these Dropping payload, and then keep repeating the
> Frame complete and EOF in empty payload)
>
> But luvcview actually works after an initial 3-4 second delay. In these 3
> or 4 seconds the following appears:
>
> uvcvideo: Trying format 0x56595559 (YUYV): 1280x960.
> uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
> uvcvideo: Setting frame interval to 1/15 (666666).
> uvcvideo: Frame complete (FID bit toggled).
> uvcvideo: incomplete buffer (8160 bytes, expected 2457600) <-- NOTICE THIS
> ONE uvcvideo: Frame complete (EOF found).
> uvcvideo: EOF in empty payload.
>
>
> 1280x1024: Same thing as the 1280x960 case. Here's the output of dmesg
>
> uvcvideo: Trying format 0x56595559 (YUYV): 1280x1024.
> uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
> uvcvideo: Setting frame interval to 1/15 (666666).
> uvcvideo: Frame complete (FID bit toggled).
> uvcvideo: incomplete buffer (8160 bytes, expected 2621440)
> uvcvideo: Frame complete (EOF found).
> uvcvideo: EOF in empty payload.
>
> > Please also post the output of lsusb -v for both cameras.
>
> the result follows (large stream). sorry for this :)
>
>
> ricardo at LatasG:~$ sudo lsusb  -v -s 6:2
>
> Bus 006 Device 002: ID 05c8:0103 Cheng Uei Precision Industry Co., Ltd
> (Foxlink)
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   idVendor           0x05c8 Cheng Uei Precision Industry Co., Ltd (Foxlink)
>   idProduct          0x0103
>   bcdDevice            1.10
>   iManufacturer           2 Foxlink
>   iProduct                1 FO13FF-65 PC-CAM
>   iSerial                 3 1.10
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          653
>     bNumInterfaces          2
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0x80
>       (Bus Powered)
>     MaxPower               98mA
>     Interface Association:
>       bLength                 8
>       bDescriptorType        11
>       bFirstInterface         0
>       bInterfaceCount         2
>       bFunctionClass         14 Video
>       bFunctionSubClass       3 Video Interface Collection
>       bFunctionProtocol       0
>       iFunction               1 FO13FF-65 PC-CAM
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      1 Video Control
>       bInterfaceProtocol      0
>       iInterface              1 FO13FF-65 PC-CAM
>       VideoControl Interface Descriptor:
>         bLength                13
>         bDescriptorType        36
>         bDescriptorSubtype      1 (HEADER)
>         bcdUVC               1.00
>         wTotalLength          103
>         dwClockFrequency       15.000000MHz
>         bInCollection           1
>         baInterfaceNr( 0)       1
>       VideoControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>         bTerminalID             2
>         wTerminalType      0x0101 USB Streaming
>         bAssocTerminal          0
>         bSourceID               5
>         iTerminal               0
>       VideoControl Interface Descriptor:
>         bLength                26
>         bDescriptorType        36
>         bDescriptorSubtype      6 (EXTENSION_UNIT)
>         bUnitID                 4
>         guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
>         bNumControl             8
>         bNrPins                 1
>         baSourceID( 0)          3
>         bControlSize            1
>         bmControls( 0)       0x0f
>         iExtension              0
>       VideoControl Interface Descriptor:
>         bLength                26
>         bDescriptorType        36
>         bDescriptorSubtype      6 (EXTENSION_UNIT)
>         bUnitID                 5
>         guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
>         bNumControl             8
>         bNrPins                 1
>         baSourceID( 0)          4
>         bControlSize            1
>         bmControls( 0)       0x01
>         iExtension              0
>       VideoControl Interface Descriptor:
>         bLength                18
>         bDescriptorType        36
>         bDescriptorSubtype      2 (INPUT_TERMINAL)
>         bTerminalID             1
>         wTerminalType      0x0201 Camera Sensor
>         bAssocTerminal          0
>         iTerminal               0
>         wObjectiveFocalLengthMin      0
>         wObjectiveFocalLengthMax      0
>         wOcularFocalLength            0
>         bControlSize                  3
>         bmControls           0x00000000
>       VideoControl Interface Descriptor:
>         bLength                11
>         bDescriptorType        36
>         bDescriptorSubtype      5 (PROCESSING_UNIT)
>       Warning: Descriptor too short
>         bUnitID                 3
>         bSourceID               1
>         wMaxMultiplier          0
>         bControlSize            2
>         bmControls     0x0000053f
>           Brightness
>           Contrast
>           Hue
>           Saturation
>           Sharpness
>           Gamma
>           Backlight Compensation
>           Power Line Frequency
>         iProcessing             0
>         bmVideoStandards     0x 0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x83  EP 3 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               6
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       VideoStreaming Interface Descriptor:
>         bLength                            14
>         bDescriptorType                    36
>         bDescriptorSubtype                  1 (INPUT_HEADER)
>         bNumFormats                        1
>         wTotalLength                      407
>         bEndPointAddress                  129
>         bmInfo                              0
>         bTerminalLink                       2
>         bStillCaptureMethod                 2
>         bTriggerSupport                     1
>         bTriggerUsage                       0
>         bControlSize                        1
>         bmaControls( 0)                    27
>       VideoStreaming Interface Descriptor:
>         bLength                            27
>         bDescriptorType                    36
>         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>         bFormatIndex                        1
>         bNumFrameDescriptors                7
>         guidFormat
> {59555932-0000-1000-8000-00aa00389b71}
>         bBitsPerPixel                      16
>         bDefaultFrameIndex                  1
>         bAspectRatioX                       0
>         bAspectRatioY                       0
>         bmInterlaceFlags                 0x00
>           Interlaced stream or variable: No
>           Fields per frame: 1 fields
>           Field 1 first: No
>           Field pattern: Field 1 only
>           bCopyProtect                      0
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         1
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            640
>         wHeight                           480
>         dwMinBitRate                   614400
>         dwMaxBitRate                 18432000
>         dwMaxVideoFrameBufferSize      614400
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         2
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            352
>         wHeight                           288
>         dwMinBitRate                   202752
>         dwMaxBitRate                  6082560
>         dwMaxVideoFrameBufferSize      202752
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         3
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            320
>         wHeight                           240
>         dwMinBitRate                   153600
>         dwMaxBitRate                  4608000
>         dwMaxVideoFrameBufferSize      153600
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         4
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            176
>         wHeight                           144
>         dwMinBitRate                    50688
>         dwMaxBitRate                  1520640
>         dwMaxVideoFrameBufferSize       50688
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            50
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         5
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            160
>         wHeight                           120
>         dwMinBitRate                    38400
>         dwMaxBitRate                  1152000
>         dwMaxVideoFrameBufferSize       38400
>         dwDefaultFrameInterval         333333
>         bFrameIntervalType                  6
>         dwFrameInterval( 0)            333333
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>         dwFrameInterval( 5)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            38
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         6
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                           1280
>         wHeight                           960
>         dwMinBitRate                  2457600
>         dwMaxBitRate                 22118400
>         dwMaxVideoFrameBufferSize     2457600
>         dwDefaultFrameInterval        1111111
>         bFrameIntervalType                  3
>         dwFrameInterval( 0)           1111111
>         dwFrameInterval( 1)           2000000
>         dwFrameInterval( 2)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            38
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         7
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                           1280
>         wHeight                          1024
>         dwMinBitRate                  2621440
>         dwMaxBitRate                 23592960
>         dwMaxVideoFrameBufferSize     2621440
>         dwDefaultFrameInterval        1111111
>         bFrameIntervalType                  3
>         dwFrameInterval( 0)           1111111
>         dwFrameInterval( 1)           2000000
>         dwFrameInterval( 2)          10000000
>       VideoStreaming Interface Descriptor:
>         bLength                            34
>         bDescriptorType                    36
>         bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>         bEndpointAddress                    0
>         bNumImageSizePatterns               7
>         wWidth( 0)                        640
>         wHeight( 0)                       480
>         wWidth( 1)                        352
>         wHeight( 1)                       288
>         wWidth( 2)                        320
>         wHeight( 2)                       240
>         wWidth( 3)                        176
>         wHeight( 3)                       144
>         wWidth( 4)                        160
>         wHeight( 4)                       120
>         wWidth( 5)                       1280
>         wHeight( 5)                       960
>         wWidth( 6)                       1280
>         wHeight( 6)                      1024
>         bNumCompressionPatterns             7
>       VideoStreaming Interface Descriptor:
>         bLength                             6
>         bDescriptorType                    36
>         bDescriptorSubtype                 13 (COLORFORMAT)
>         bColorPrimaries                     1 (BT.709,sRGB)
>         bTransferCharacteristics            1 (BT.709)
>         bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       1
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0080  1x 128 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       2
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0100  1x 256 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       3
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0320  1x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       4
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0b20  2x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       5
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1320  3x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       6
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1400  3x 1024 bytes
>         bInterval               1
> Device Qualifier (for other device speed):
>   bLength                10
>   bDescriptorType         6
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   bNumConfigurations      1
> Device Status:     0x0000
>   (Bus Powered)
>
> > Best regards,
> >
> > Laurent Pinchart
>
> Hope it helps. Sunday I'll repeat the tests for the Phillips.
>
> Ricardo


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080515/957f8816/attachment.pgp>

From dpmcgee at gmail.com  Fri May 16 03:44:45 2008
From: dpmcgee at gmail.com (Dan McGee)
Date: Thu, 15 May 2008 20:44:45 -0500
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl
In-Reply-To: <200805151528.18815.laurent.pinchart@skynet.be>
References: <449c10960805082023n2ef82d95t110b757126d12be4@mail.gmail.com>
	<200805111016.27854.laurent.pinchart@skynet.be>
	<449c10960805110737o21f31a0fkcb4db962cb416298@mail.gmail.com>
	<200805151528.18815.laurent.pinchart@skynet.be>
Message-ID: <449c10960805151844s1b4ca11eq6947a363305314ea@mail.gmail.com>

On Thu, May 15, 2008 at 8:28 AM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Coud you please test the patch attached to
> https://lists.berlios.de/pipermail/linux-uvc-devel/2008-May/003500.html ?
> Instructions are available in the mail.

Here you are. I'm going to be on vacation for a bit so I probably
won't be able to help you debug this for the next week and a half.

Hope it helps.

-Dan

Linux video capture interface: v2.00
uvcvideo: Adding mapping Brightness to control
00000000-0000-0000-0000-000000000101/2.
uvcvideo: Adding mapping Contrast to control
00000000-0000-0000-0000-000000000101/3.
uvcvideo: Adding mapping Hue to control 00000000-0000-0000-0000-000000000101/6.
uvcvideo: Adding mapping Saturation to control
00000000-0000-0000-0000-000000000101/7.
uvcvideo: Adding mapping Sharpness to control
00000000-0000-0000-0000-000000000101/8.
uvcvideo: Adding mapping Gamma to control
00000000-0000-0000-0000-000000000101/9.
uvcvideo: Adding mapping Backlight Compensation to control
00000000-0000-0000-0000-000000000101/1.
uvcvideo: Adding mapping Gain to control 00000000-0000-0000-0000-000000000101/4.
uvcvideo: Adding mapping Power Line Frequency to control
00000000-0000-0000-0000-000000000101/5.
uvcvideo: Adding mapping Hue, Auto to control
00000000-0000-0000-0000-000000000101/16.
uvcvideo: Adding mapping Exposure, Auto to control
00000000-0000-0000-0000-000000000001/2.
uvcvideo: Adding mapping Exposure, Auto Priority to control
00000000-0000-0000-0000-000000000001/3.
uvcvideo: Adding mapping Exposure (Absolute) to control
00000000-0000-0000-0000-000000000001/4.
uvcvideo: Adding mapping White Balance Temperature, Auto to control
00000000-0000-0000-0000-000000000101/11.
uvcvideo: Adding mapping White Balance Temperature to control
00000000-0000-0000-0000-000000000101/10.
uvcvideo: Adding mapping White Balance Component, Auto to control
00000000-0000-0000-0000-000000000101/13.
uvcvideo: Adding mapping White Balance Blue Component to control
00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping White Balance Red Component to control
00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping Focus (absolute) to control
00000000-0000-0000-0000-000000000001/6.
uvcvideo: Adding mapping Focus, Auto to control
00000000-0000-0000-0000-000000000001/8.
uvcvideo: Probing generic UVC device 8
uvcvideo: Found format YUV 4:2:2 (YUYV).
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: Found format YUV 4:2:2 (UYVY).
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: Found a Status endpoint (addr 81).
uvcvideo: Found UVC 1.00 device <unnamed> (eb1a:2761)
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to
device 8 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to
device 8 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/10 to
device 8 entity 3
uvcvideo: Scanning UVC chain: OT 2 <- XU 4 <- PU 3 <- IT 1
uvcvideo: Found a valid video chain (1 -> 2).
input: UVC Camera (eb1a:2761) as
/devices/pci0000:00/0000:00:1d.7/usb1/1-8/1-8:1.0/input/input8
uvcvideo: UVC device initialized.
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r209)
<ran luvcview -f yuv here>

uvcvideo: Trying format 0x56595559 (YUYV): 320x240.
uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
uvcvideo: Setting frame interval to 1/15 (666666).
uvcvideo: Dropping payload (error bit set).
uvcvideo: Dropping payload (error bit set).
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
<and this continues for a long time>

<luvcview -f yuv -s 640x480>
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (153600 bytes, expected 655360)
uvcvideo: Trying format 0x56595559 (YUYV): 640x480.
uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
uvcvideo: Setting frame interval to 1/15 (666666).
uvcvideo: Dropping payload (error bit set).
uvcvideo: Dropping payload (error bit set).
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (614400 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (614400 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: incomplete buffer (614400 bytes, expected 655360)
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.

And lsusb output if this helps at all too. This is the webcam on the EeePC.

Bus 001 Device 003: ID eb1a:2761 eMPIA Technology, Inc.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0xeb1a eMPIA Technology, Inc.
  idProduct          0x2761
  bcdDevice            8.21
  iManufacturer           0
  iProduct                0
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          529
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              0
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           78
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000012
          Auto-Exposure Mode
          Exposure Time (Relative)
      VideoControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            3
        bmControls     0x0000147b
          Brightness
          Contrast
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x1a
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {2652215a-8932-5641-894a-5c557cdf9664}
        bNumControl             4
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x1f
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      397
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                3389521920
        dwMaxBitRate                3389521920
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                3103785120
        dwMaxBitRate                3103785120
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                2348810400
        dwMaxBitRate                2348810400
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                3858890880
        dwMaxBitRate                3858890880
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                        640
        wHeight( 0)                       480
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                5
        guidFormat
{55595659-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                3389521920
        dwMaxBitRate                3389521920
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                3103785120
        dwMaxBitRate                3103785120
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                2348810400
        dwMaxBitRate                2348810400
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                3858890880
        dwMaxBitRate                3858890880
        dwMaxVideoFrameBufferSize      655360
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                        640
        wHeight( 0)                       480
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


From pierre-eloi.bontinck at macopharma.com  Fri May 16 12:17:38 2008
From: pierre-eloi.bontinck at macopharma.com (pierre-eloi bontinck)
Date: Fri, 16 May 2008 12:17:38 +0200
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
Message-ID: <CEEC8DCC359B5E4E86163FCC7CA77A050499149C@EXCHANGE.gmp.local>

Hi,

Thank you for your interest !

I join my lsusb for this webcam. (it seems to me that your could be right from lsusb).

Could it be possible that Philips in doing an UVC compliant up to 30fps, to have the windows logo, but still having their own driver able to get up 90 fps out of UVC specification ? (I'll check also on videos done at 90 fps on movement if I can see interpolation).

Regards,

Pierre-Eloi

-----Message d'origine-----
De : Laurent Pinchart [mailto:laurent.pinchart at skynet.be] 
Envoy? : jeudi 15 mai 2008 14:55
? : linux-uvc-devel at lists.berlios.de
Cc : pierre-eloi bontinck
Objet : Re: [Linux-uvc-devel] 90 fps on Philips 1300NC

Hi Pierre-Eloi,

On Tuesday 13 May 2008, pierre-eloi bontinck wrote:
> Dear all,
>
> I did not succeed in getting 90fps on philips 1300NC webcam (30fps max).
> I notice that private control are not read by luvcview. Adavanced 
> functionalities aren't accessible also (shutter priority, etc...). 
> What can I do ?
>
> (I tried to find a limitation to 30fps in the .c files, but did not 
> find it - tried also to write a config file for luvcview with values 
> for private control, but without success).

Could you please post the output of lsusb -v (using usbutils 0.72 or newer) ? 
The SPC1300NC USB descriptors I got report a max frame rate of 30fps. I wouldn't be surprised if the 90fps were the result of software interpolation in the Windows driver.

Best regards,

Laurent Pinchart


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lsusb_0.72_ubuntu.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080516/6fdff7ef/attachment.txt>

From lsmithso at hare.demon.co.uk  Fri May 16 13:20:40 2008
From: lsmithso at hare.demon.co.uk (Les Smithson)
Date: Fri, 16 May 2008 12:20:40 +0100 (BST)
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
 vidioc_dqbuf ioctl (Dan McGee)
Message-ID: <44390.80.254.146.4.1210936840.squirrel@hare.demon.co.uk>

 > Here you are. I'm going to be on vacation for a bit so I probably
 > won't be able to help you debug this for the next week and a half.

Can I help with this? I have the same eMPIA/eeepc setup and I'd be willing
to pitch in.



From fvera at ucv.cl  Fri May 16 15:51:42 2008
From: fvera at ucv.cl (fvera at ucv.cl)
Date: Fri, 16 May 2008 09:51:42 -0400 (CLT)
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
In-Reply-To: <CEEC8DCC359B5E4E86163FCC7CA77A050499149C@EXCHANGE.gmp.local>
References: <CEEC8DCC359B5E4E86163FCC7CA77A050499149C@EXCHANGE.gmp.local>
Message-ID: <39139.190.46.161.31.1210945902.squirrel@190.46.161.31>


Dear Pierre-Eloi

Could you let drop a ball let say 1 meter and record this at 90 fps using
the drivers provided with your webcam?

using: y=(1/2)g t**2 and puttting y=1m, g=9.8 you can get t, the time that
your ball will take to get to the floor, then if the cam is doing 30 fps
you would end up with 13 frames of the ball, but if the cam is doing 90
fps you should obtain 39 frames!

when you record a video at higher speed than supported, some cams just
send duplicated frames, you could check this using:

ffmpeg -an -sameq -i yourmovie.avi photo%03d.jpg

and watch the image sequence.

Yesterday I downloaded a video (from youtube) recorded with this cam of
some cars in a crossing, but a crude calculation let me think that is only
30 fps.

If you record this video, could you send it to me?

Have you think on the possibility that the images from the webcam are
interlaced?

Good luck,

Francisco



From linux-uvc-devel at rogerpueyo.com  Sat May 17 17:06:34 2008
From: linux-uvc-devel at rogerpueyo.com (Roger Pueyo Centelles)
Date: Sat, 17 May 2008 17:06:34 +0200
Subject: [Linux-uvc-devel] UVC-compliant webcam not working
In-Reply-To: <mailman.3702.1211034114.5404.linux-uvc-devel@lists.berlios.de>
References: <mailman.3702.1211034114.5404.linux-uvc-devel@lists.berlios.de>
Message-ID: <3f01c3b00805170806g1bbb397fy773c07f910a82a82@mail.gmail.com>

Hello,

I've received a new webcam I bought via eBay, which claimed to be
UVC-compliant. As far as I have been able to test, I pluged it on a
windows xp system and worked correctly.

Now, I've downloaded, compiled and installed the UVC module and I'm
getting the following dmesg output when pluging in:

usb 2-2: new full speed USB device using uhci_hcd and address 9
usb 2-2: configuration #1 chosen from 1 choice
uvcvideo: Probing generic UVC device 2
uvcvideo: Found format MJPEG.
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: Found a Status endpoint (addr 81).
uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/4 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to
device 2 entity 5
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to
device 2 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/4 to
device 2 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to
device 2 entity 5
uvcvideo: Scanning UVC chain: OT 3 <- PU 5 <- SU 4 <- IT 1 2
uvcvideo: Found a valid video chain (1,2 -3).
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
input: USB Web Camera as /class/input/input9
uvcvideo: UVC device initialized.
usb 2-2: New USB device found, idVendor=1c4f, idProduct=3000
usb 2-2: New USB device strings: Mfr=1, Product=2, SerialNumber=0
usb 2-2: Product: USB Web Camera
usb 2-2: Manufacturer: SiGma Micro


and running luvcview:

uvcvideo: Trying format 0x47504a4d (MJPG): 320x240.
uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
uvcvideo: Failed to query (130) UVC control 1 (unit 0) : -32 (exp. 26).

By the way, I've done: "echo 0x0f
/sys/module/uvcvideo/parameters/trace" in order to get a more complete
output (I hope it's the best way to do so).

And lsusb claims its a 1c4f:3000 (no extra identification).

I hope this info can be useful.


Best regards,

Roger


From elbaddy at gmail.com  Mon May 19 09:42:54 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Mon, 19 May 2008 09:42:54 +0200
Subject: [Linux-uvc-devel] New device
Message-ID: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>

Hello,
I have a USB web camera not listed at
http://linux-uvc.berlios.de/#devices. Device ID is 1c4f:3000 : it is
made in China and its box quotes "Shadow Series". I am not able to
view video stream with any software (gqcam, skype, camorama, luvcview,
mplayer...). I tried both with driver provided within ubuntu and with
the SVN version. Kernel gives:

"uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)"
or
"USB Video Class driver (SVN r209)" with SVN driver

when some software tries to access to it:

"uvcvideo: Failed to query (130) UVC control 1 (unit 0) : -32 (exp. 26)."

or

"uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1)."

Thanks,
greetings


From ricardo at isr.ist.utl.pt  Mon May 19 10:30:34 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Mon, 19 May 2008 09:30:34 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
Message-ID: <200805190930.34140.ricardo@isr.ist.utl.pt>

Hello all, this is the second time I send this, the first complained about 
size being too big on the mailing list. I have striped previous clutter. 
Sorry for this. 

As promissed, here are the results for the phillips spc1000nc

first, here's the insmod results line:

ricardo at LatasG:~/tmp/uvc/trunk$ sudo insmod ./uvcvideo trace=143
insmod: can't read './uvcvideo': No such file or directory
ricardo at LatasG:~/tmp/uvc/trunk$ sudo insmod ./uvcvideo.ko trace=143
ricardo at LatasG:~/tmp/uvc/trunk$ sudo dmesg -c
uvcvideo: Adding mapping Brightness to control 
00000000-0000-0000-0000-000000000101/2.
uvcvideo: Adding mapping Contrast to control 
00000000-0000-0000-0000-000000000101/3.
uvcvideo: Adding mapping Hue to control 
00000000-0000-0000-0000-000000000101/6.
uvcvideo: Adding mapping Saturation to control 
00000000-0000-0000-0000-000000000101/7.
uvcvideo: Adding mapping Sharpness to control 
00000000-0000-0000-0000-000000000101/8.
uvcvideo: Adding mapping Gamma to control 
00000000-0000-0000-0000-000000000101/9.
uvcvideo: Adding mapping Backlight Compensation to control 
00000000-0000-0000-0000-000000000101/1.
uvcvideo: Adding mapping Gain to control 
00000000-0000-0000-0000-000000000101/4.
uvcvideo: Adding mapping Power Line Frequency to control 
00000000-0000-0000-0000-000000000101/5.
uvcvideo: Adding mapping Hue, Auto to control 
00000000-0000-0000-0000-000000000101/16.
uvcvideo: Adding mapping Exposure, Auto to control 
00000000-0000-0000-0000-000000000001/2.
uvcvideo: Adding mapping Exposure, Auto Priority to control 
00000000-0000-0000-0000-000000000001/3.
uvcvideo: Adding mapping Exposure (Absolute) to control 
00000000-0000-0000-0000-000000000001/4.
uvcvideo: Adding mapping White Balance Temperature, Auto to control 
00000000-0000-0000-0000-000000000101/11.
uvcvideo: Adding mapping White Balance Temperature to control 
00000000-0000-0000-0000-000000000101/10.
uvcvideo: Adding mapping White Balance Component, Auto to control 
00000000-0000-0000-0000-000000000101/13.
uvcvideo: Adding mapping White Balance Blue Component to control 
00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping White Balance Red Component to control 
00000000-0000-0000-0000-000000000101/12.
uvcvideo: Adding mapping Focus (absolute) to control 
00000000-0000-0000-0000-000000000001/6.
uvcvideo: Adding mapping Focus, Auto to control 
00000000-0000-0000-0000-000000000001/8.
uvcvideo: Probing generic UVC device 4
uvcvideo: Found format YUV 4:2:2 (YUYV).
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 1280x960 (9.0 fps)
uvcvideo: - 1280x1024 (9.0 fps)
uvcvideo: Found a Status endpoint (addr 83).
uvcvideo: Found UVC 1.00 device FO13FF-65 PC-CAM (05c8:0103)
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 4 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 4 
entity 3
uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
uvcvideo: Found a valid video chain (1 -> 2).
input: FO13FF-65 PC-CAM as /class/input/input9
uvcvideo: Trying format 0x56595559 (YUYV): 10000x10000.
uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
uvcvideo: UVC device initialized.
uvcvideo: Probing generic UVC device 1
uvcvideo: Found format YUV 4:2:2 (YUYV).
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 1280x1024 (9.0 fps)
uvcvideo: Found format MJPEG.
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 1280x1024 (15.0 fps)
uvcvideo: Found a Status endpoint (addr 83).
uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/4 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to device 1 
entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/3 to device 1 
entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/4 to device 1 
entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to device 1 
entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/10 to device 1 
entity 3
uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
uvcvideo: Found a valid video chain (1 -> 2).
input: Philips SPC 1000NC Webcam as /class/input/input10
uvcvideo: Trying format 0x56595559 (YUYV): 10000x10000.
uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
uvcvideo: UVC device initialized.
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r207)




Here's luvcview's output:

ricardo at LatasG:~/tmp/uvc/trunk$ luvcview -f yuv -L -d /dev/video1
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video1
/dev/video1 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 352, height = 288 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 176, height = 144 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 160, height = 120 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 1280, height = 1024 }
        Time interval between frame: 1/15, 1/10, 1/5,
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 352, height = 288 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 176, height = 144 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 160, height = 120 }
        Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
{ discrete: width = 1280, height = 1024 }
        Time interval between frame: 1/9, 1/5,


Now for the each size, the output of the patched driver:
YUV:
640x480: incomplete buffer (614400 bytes, expected 675840)
352x288: incomplete buffer (202752 bytes, expected 223027)
320x240: incomplete buffer (153600 bytes, expected 168960)
176x144: incomplete buffer (50688 bytes, expected 55756)
160x120: incomplete buffer (38400 bytes, expected 42240)
1280x1024: many messages like
uvcvideo: Frame complete (EOF found).
uvcvideo: EOF in empty payload.
uvcvideo: Dropping payload (out of sync).

but it works (apparently fine).

MJPG (-f jpg in luvcview)

640x480: many "out of sync" messages, but it works
352x288: same
320x240: same
176x144: same
160x120: same
1280x1024: same

the only problem with all of these is that luvcview is reporting around 5-15 
fps when the camera reports 30 fps (the camera box says it should be able to 
do 60 fps, but I don't see those modes listed in luvcview). I think it has to 
do with light conditions. low light-> 5fps, sunlight -> 15 fps.

attached is an lsusb of the camera device.

Since both cameras experience the same problem, I think a camera bug is ruled 
out?

Hope this helps,
Ricardo



-------------- next part --------------
Bus 007 Device 004: ID 0471:0332 Philips 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0471 Philips
  idProduct          0x0332 
  bcdDevice            1.00
  iManufacturer           2 Philips CE
  iProduct                1 Philips SPC 1000NC Webcam
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength         1066
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              168mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x1f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0x00
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000a0e
          Auto-Exposure Mode
          Auto-Exposure Priority
          Exposure Time (Absolute)
          Zoom (Absolute)
          PanTilt (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000177f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      692
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  3072000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  1013760
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   768000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   253440
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   192000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 13107200
        dwMaxBitRate                 23592960
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1111111
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1111111
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                       960
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        352
        wHeight( 2)                       288
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        2
        bNumFrameDescriptors                6
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   384000
        dwMaxBitRate                  2304000
        dwMaxVideoFrameBufferSize       76800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   126720
        dwMaxBitRate                   760320
        dwMaxVideoFrameBufferSize       25344
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                    96000
        dwMaxBitRate                   576000
        dwMaxVideoFrameBufferSize       19200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                    31680
        dwMaxBitRate                   190080
        dwMaxVideoFrameBufferSize        6336
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                    24000
        dwMaxBitRate                   144000
        dwMaxVideoFrameBufferSize        4800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                  1638400
        dwMaxBitRate                  4915200
        dwMaxVideoFrameBufferSize      327680
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  3
        dwFrameInterval( 0)            666666
        dwFrameInterval( 1)           1000000
        dwFrameInterval( 2)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            31
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                       960
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        352
        wHeight( 2)                       288
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       0 
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           41
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            2
        bmaControls( 0)      0x01
        bmaControls( 0)      0x00
          Mute
        bmaControls( 1)      0x02
        bmaControls( 1)      0x00
          Volume
        iFeature                0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                29
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            7 Discrete
        tSamFreq[ 0]         8000
        tSamFreq[ 1]        11025
        tSamFreq[ 2]        16000
        tSamFreq[ 3]        22050
        tSamFreq[ 4]        24000
        tSamFreq[ 5]        44100
        tSamFreq[ 6]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0190  1x 400 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080519/ef05e24b/attachment.pgp>

From laurent.pinchart at skynet.be  Tue May 20 00:24:33 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 20 May 2008 00:24:33 +0200
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805190930.34140.ricardo@isr.ist.utl.pt>
References: <200805190930.34140.ricardo@isr.ist.utl.pt>
Message-ID: <200805200024.33950.laurent.pinchart@skynet.be>

Hi Ricardo,

On Monday 19 May 2008, Ricardo Ferreira wrote:
> Hello all, this is the second time I send this, the first complained about
> size being too big on the mailing list. I have striped previous clutter.
> Sorry for this.

No worries. Thanks for the report.

> As promissed, here are the results for the phillips spc1000nc
>
> first, here's the insmod results line:
>
> ricardo at LatasG:~/tmp/uvc/trunk$ sudo insmod ./uvcvideo trace=143
> insmod: can't read './uvcvideo': No such file or directory
> ricardo at LatasG:~/tmp/uvc/trunk$ sudo insmod ./uvcvideo.ko trace=143
> ricardo at LatasG:~/tmp/uvc/trunk$ sudo dmesg -c
> uvcvideo: Adding mapping Brightness to control
> 00000000-0000-0000-0000-000000000101/2.
> uvcvideo: Adding mapping Contrast to control
> 00000000-0000-0000-0000-000000000101/3.
> uvcvideo: Adding mapping Hue to control
> 00000000-0000-0000-0000-000000000101/6.
> uvcvideo: Adding mapping Saturation to control
> 00000000-0000-0000-0000-000000000101/7.
> uvcvideo: Adding mapping Sharpness to control
> 00000000-0000-0000-0000-000000000101/8.
> uvcvideo: Adding mapping Gamma to control
> 00000000-0000-0000-0000-000000000101/9.
> uvcvideo: Adding mapping Backlight Compensation to control
> 00000000-0000-0000-0000-000000000101/1.
> uvcvideo: Adding mapping Gain to control
> 00000000-0000-0000-0000-000000000101/4.
> uvcvideo: Adding mapping Power Line Frequency to control
> 00000000-0000-0000-0000-000000000101/5.
> uvcvideo: Adding mapping Hue, Auto to control
> 00000000-0000-0000-0000-000000000101/16.
> uvcvideo: Adding mapping Exposure, Auto to control
> 00000000-0000-0000-0000-000000000001/2.
> uvcvideo: Adding mapping Exposure, Auto Priority to control
> 00000000-0000-0000-0000-000000000001/3.
> uvcvideo: Adding mapping Exposure (Absolute) to control
> 00000000-0000-0000-0000-000000000001/4.
> uvcvideo: Adding mapping White Balance Temperature, Auto to control
> 00000000-0000-0000-0000-000000000101/11.
> uvcvideo: Adding mapping White Balance Temperature to control
> 00000000-0000-0000-0000-000000000101/10.
> uvcvideo: Adding mapping White Balance Component, Auto to control
> 00000000-0000-0000-0000-000000000101/13.
> uvcvideo: Adding mapping White Balance Blue Component to control
> 00000000-0000-0000-0000-000000000101/12.
> uvcvideo: Adding mapping White Balance Red Component to control
> 00000000-0000-0000-0000-000000000101/12.
> uvcvideo: Adding mapping Focus (absolute) to control
> 00000000-0000-0000-0000-000000000001/6.
> uvcvideo: Adding mapping Focus, Auto to control
> 00000000-0000-0000-0000-000000000001/8.
> uvcvideo: Probing generic UVC device 4
> uvcvideo: Found format YUV 4:2:2 (YUYV).
> uvcvideo: - 640x480 (30.0 fps)
> uvcvideo: - 352x288 (30.0 fps)
> uvcvideo: - 320x240 (30.0 fps)
> uvcvideo: - 176x144 (30.0 fps)
> uvcvideo: - 160x120 (30.0 fps)
> uvcvideo: - 1280x960 (9.0 fps)
> uvcvideo: - 1280x1024 (9.0 fps)
> uvcvideo: Found a Status endpoint (addr 83).
> uvcvideo: Found UVC 1.00 device FO13FF-65 PC-CAM (05c8:0103)
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 4
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 4
> entity 3
> uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
> uvcvideo: Found a valid video chain (1 -> 2).
> input: FO13FF-65 PC-CAM as /class/input/input9
> uvcvideo: Trying format 0x56595559 (YUYV): 10000x10000.
> uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
> uvcvideo: UVC device initialized.
> uvcvideo: Probing generic UVC device 1
> uvcvideo: Found format YUV 4:2:2 (YUYV).
> uvcvideo: - 640x480 (30.0 fps)
> uvcvideo: - 352x288 (30.0 fps)
> uvcvideo: - 320x240 (30.0 fps)
> uvcvideo: - 176x144 (30.0 fps)
> uvcvideo: - 160x120 (30.0 fps)
> uvcvideo: - 1280x1024 (9.0 fps)
> uvcvideo: Found format MJPEG.
> uvcvideo: - 640x480 (30.0 fps)
> uvcvideo: - 352x288 (30.0 fps)
> uvcvideo: - 320x240 (30.0 fps)
> uvcvideo: - 176x144 (30.0 fps)
> uvcvideo: - 160x120 (30.0 fps)
> uvcvideo: - 1280x1024 (15.0 fps)
> uvcvideo: Found a Status endpoint (addr 83).
> uvcvideo: Found UVC 1.00 device Philips SPC 1000NC Webcam (0471:0332)
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/4 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to device 1
> entity 1
> uvcvideo: Added control 00000000-0000-0000-0000-000000000001/3 to device 1
> entity 1
> uvcvideo: Added control 00000000-0000-0000-0000-000000000001/4 to device 1
> entity 1
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to device 1
> entity 3
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/10 to device 1
> entity 3
> uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
> uvcvideo: Found a valid video chain (1 -> 2).
> input: Philips SPC 1000NC Webcam as /class/input/input10
> uvcvideo: Trying format 0x56595559 (YUYV): 10000x10000.
> uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
> uvcvideo: UVC device initialized.
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (SVN r207)
>
>
>
>
> Here's luvcview's output:
>
> ricardo at LatasG:~/tmp/uvc/trunk$ luvcview -f yuv -L -d /dev/video1
> luvcview version 0.2.1
> Video driver: x11
> A window manager is available
> video /dev/video1
> /dev/video1 does not support read i/o
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 640, height = 480 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 352, height = 288 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 320, height = 240 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 176, height = 144 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 160, height = 120 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 1280, height = 1024 }
>         Time interval between frame: 1/15, 1/10, 1/5,
> { pixelformat = 'MJPG', description = 'MJPEG' }
> { discrete: width = 640, height = 480 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 352, height = 288 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 320, height = 240 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 176, height = 144 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 160, height = 120 }
>         Time interval between frame: 1/30, 1/25, 1/20, 1/15, 1/10, 1/5,
> { discrete: width = 1280, height = 1024 }
>         Time interval between frame: 1/9, 1/5,
>
>
> Now for the each size, the output of the patched driver:
> YUV:
> 640x480: incomplete buffer (614400 bytes, expected 675840)
> 352x288: incomplete buffer (202752 bytes, expected 223027)
> 320x240: incomplete buffer (153600 bytes, expected 168960)
> 176x144: incomplete buffer (50688 bytes, expected 55756)
> 160x120: incomplete buffer (38400 bytes, expected 42240)
> 1280x1024: many messages like
> uvcvideo: Frame complete (EOF found).
> uvcvideo: EOF in empty payload.
> uvcvideo: Dropping payload (out of sync).
>
> but it works (apparently fine).
>
> MJPG (-f jpg in luvcview)
>
> 640x480: many "out of sync" messages, but it works
> 352x288: same
> 320x240: same
> 176x144: same
> 160x120: same
> 1280x1024: same
>
> the only problem with all of these is that luvcview is reporting around
> 5-15 fps when the camera reports 30 fps (the camera box says it should be
> able to do 60 fps, but I don't see those modes listed in luvcview). I think
> it has to do with light conditions. low light-> 5fps, sunlight -> 15 fps.

That would be my guess too.

> attached is an lsusb of the camera device.
>
> Since both cameras experience the same problem, I think a camera bug is
> ruled out?

Unfortunately not. Both cameras probably use the same buggy chipset.

I'll try to come up with a patch but I'm quite busy for now. I'll see what I 
can do. Sorry for the delay.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue May 20 17:50:19 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 20 May 2008 17:50:19 +0200
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805190930.34140.ricardo@isr.ist.utl.pt>
References: <200805190930.34140.ricardo@isr.ist.utl.pt>
Message-ID: <200805201750.19902.laurent.pinchart@skynet.be>

Hi Ricardo and Dan,

could you please try the attached patch and see if it helps ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: drop-fix.patch
Type: text/x-diff
Size: 2953 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/f90fe500/attachment.patch>

From laurent.pinchart at skynet.be  Tue May 20 17:53:08 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 20 May 2008 17:53:08 +0200
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
In-Reply-To: <CEEC8DCC359B5E4E86163FCC7CA77A050499149C@EXCHANGE.gmp.local>
References: <CEEC8DCC359B5E4E86163FCC7CA77A050499149C@EXCHANGE.gmp.local>
Message-ID: <200805201753.08948.laurent.pinchart@skynet.be>

Hi Pierre,

On Friday 16 May 2008, pierre-eloi bontinck wrote:
> Hi,
>
> Thank you for your interest !
>
> I join my lsusb for this webcam. (it seems to me that your could be right
> from lsusb).

Thanks.

> Could it be possible that Philips in doing an UVC compliant up to 30fps, to
> have the windows logo, but still having their own driver able to get up 90
> fps out of UVC specification ? (I'll check also on videos done at 90 fps on
> movement if I can see interpolation).

It's always possible, but I really doubt it. I have never come across a cheap 
consumer video sensor able to capture 90fps. Software interpolation is more 
than probable.

Of course you can prove me wrong :-)

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue May 20 17:54:25 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 20 May 2008 17:54:25 +0200
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl (Dan McGee)
In-Reply-To: <44390.80.254.146.4.1210936840.squirrel@hare.demon.co.uk>
References: <44390.80.254.146.4.1210936840.squirrel@hare.demon.co.uk>
Message-ID: <200805201754.25459.laurent.pinchart@skynet.be>

Hi Les,

On Friday 16 May 2008, Les Smithson wrote:
>  > Here you are. I'm going to be on vacation for a bit so I probably
>  > won't be able to help you debug this for the next week and a half.
>
> Can I help with this? I have the same eMPIA/eeepc setup and I'd be willing
> to pitch in.

Could you please try the patch I've just sent to the list ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue May 20 18:00:10 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 20 May 2008 18:00:10 +0200
Subject: [Linux-uvc-devel] UVC-compliant webcam not working
In-Reply-To: <3f01c3b00805170806g1bbb397fy773c07f910a82a82@mail.gmail.com>
References: <mailman.3702.1211034114.5404.linux-uvc-devel@lists.berlios.de>
	<3f01c3b00805170806g1bbb397fy773c07f910a82a82@mail.gmail.com>
Message-ID: <200805201800.10698.laurent.pinchart@skynet.be>

Hi Roger,

On Saturday 17 May 2008, Roger Pueyo Centelles wrote:
> Hello,
>
> I've received a new webcam I bought via eBay, which claimed to be
> UVC-compliant. As far as I have been able to test, I pluged it on a
> windows xp system and worked correctly.
>
> Now, I've downloaded, compiled and installed the UVC module and I'm
> getting the following dmesg output when pluging in:
>
> usb 2-2: new full speed USB device using uhci_hcd and address 9
> usb 2-2: configuration #1 chosen from 1 choice
> uvcvideo: Probing generic UVC device 2
> uvcvideo: Found format MJPEG.
> uvcvideo: - 320x240 (30.0 fps)
> uvcvideo: - 640x480 (30.0 fps)
> uvcvideo: - 160x120 (30.0 fps)
> uvcvideo: Found a Status endpoint (addr 81).
> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/4 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to
> device 2 entity 5
> uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to
> device 2 entity 1
> uvcvideo: Added control 00000000-0000-0000-0000-000000000001/4 to
> device 2 entity 1
> uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to
> device 2 entity 5
> uvcvideo: Scanning UVC chain: OT 3 <- PU 5 <- SU 4 <- IT 1 2
> uvcvideo: Found a valid video chain (1,2 -3).
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> input: USB Web Camera as /class/input/input9
> uvcvideo: UVC device initialized.
> usb 2-2: New USB device found, idVendor=1c4f, idProduct=3000
> usb 2-2: New USB device strings: Mfr=1, Product=2, SerialNumber=0
> usb 2-2: Product: USB Web Camera
> usb 2-2: Manufacturer: SiGma Micro
>
>
> and running luvcview:
>
> uvcvideo: Trying format 0x47504a4d (MJPG): 320x240.
> uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
> uvcvideo: Failed to query (130) UVC control 1 (unit 0) : -32 (exp. 26).

Please try the attached patch.

> By the way, I've done: "echo 0x0f
> /sys/module/uvcvideo/parameters/trace" in order to get a more complete
> output (I hope it's the best way to do so).

That's could. You could also have set the trace parameter when loading the 
module with

modprobe uvcvideo trace=15

> And lsusb claims its a 1c4f:3000 (no extra identification).

Could you please post the output of

lsusb -v -d 1c4f:3000

with usbutils 0.72 or newer (0.73+ preferred) ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sigma.diff
Type: text/x-diff
Size: 721 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/ae482f6e/attachment.diff>

From laurent.pinchart at skynet.be  Tue May 20 18:01:38 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 20 May 2008 18:01:38 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
Message-ID: <200805201801.38184.laurent.pinchart@skynet.be>

Hi Lorenzo,

On Monday 19 May 2008, Lorenzo Battistini wrote:
> Hello,
> I have a USB web camera not listed at
> http://linux-uvc.berlios.de/#devices. Device ID is 1c4f:3000 : it is
> made in China and its box quotes "Shadow Series". I am not able to
> view video stream with any software (gqcam, skype, camorama, luvcview,
> mplayer...). I tried both with driver provided within ubuntu and with
> the SVN version. Kernel gives:
>
> "uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0)"
> or
> "USB Video Class driver (SVN r209)" with SVN driver
>
> when some software tries to access to it:
>
> "uvcvideo: Failed to query (130) UVC control 1 (unit 0) : -32 (exp. 26)."
>
> or
>
> "uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1)."

Could you please try the attached patch ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sigma.diff
Type: text/x-diff
Size: 721 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/00240a3f/attachment.diff>

From ricardo at isr.ist.utl.pt  Tue May 20 18:38:52 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Tue, 20 May 2008 17:38:52 +0100
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805201750.19902.laurent.pinchart@skynet.be>
References: <200805190930.34140.ricardo@isr.ist.utl.pt>
	<200805201750.19902.laurent.pinchart@skynet.be>
Message-ID: <200805201738.59927.ricardo@isr.ist.utl.pt>

Hello,

On Tuesday 20 May 2008 16:50:19 Laurent Pinchart wrote:
> Hi Ricardo and Dan,
>
> could you please try the attached patch and see if it helps ?

I have applied the patch to svn209. All modes seem to work in luvcview apart 
from an initial delay of 2-4 seconds, depending on the resolution, on the 
first dqueue ioctl. Does this have a cure or is it the camera initializing?

About the fps, my man page must be old, it does not mention the -i parameter 
to luvcview. I set it to >30  and the cameras are now doing the lsusb 
reported 30 fps (instead of the 15 as I mentioned in a previous mail). This 
is still only half of what phillips claims for this webcam, but I have seen 
somebody else in this forum complaining about the 1300 not being able to do 
90fps as stated by the manufacturer.  

thanks for your time,
Ricardo

>
> Best regards,
>
> Laurent Pinchart


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/43d43b74/attachment.pgp>

From trigger at space-based.de  Tue May 20 18:56:46 2008
From: trigger at space-based.de (Armin Berres)
Date: Tue, 20 May 2008 18:56:46 +0200
Subject: [Linux-uvc-devel] 90 fps on Philips 1300NC
In-Reply-To: <200805201753.08948.laurent.pinchart@skynet.be>
References: <CEEC8DCC359B5E4E86163FCC7CA77A050499149C@EXCHANGE.gmp.local>
	<200805201753.08948.laurent.pinchart@skynet.be>
Message-ID: <20080520165646.GE10726@bluemoon>

On Tue, 20 May 08 17:53, Laurent Pinchart wrote:
> > Could it be possible that Philips in doing an UVC compliant up to 30fps, to
> > have the windows logo, but still having their own driver able to get up 90
> > fps out of UVC specification ? (I'll check also on videos done at 90 fps on
> > movement if I can see interpolation).
> 
> It's always possible, but I really doubt it. I have never come across a cheap 
> consumer video sensor able to capture 90fps. Software interpolation is more 
> than probable.

The Philips also claims that the old SPC 900 which only supports USB 1.1
can capture 90 FPS. When someone can tell we how to transport 90 fps in
a decent resolution via USB 1.1 I trust Philips that they don't
interpolate the 90 fps...
It is a marketing gag, nothing else.

Greetings,
Armin


From lsmithso at hare.demon.co.uk  Tue May 20 21:11:43 2008
From: lsmithso at hare.demon.co.uk (Les Smithson)
Date: Tue, 20 May 2008 20:11:43 +0100
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return
	from	vidioc_dqbuf ioctl (Dan McGee)
In-Reply-To: <200805201754.25459.laurent.pinchart@skynet.be>
References: <44390.80.254.146.4.1210936840.squirrel@hare.demon.co.uk>
	<200805201754.25459.laurent.pinchart@skynet.be>
Message-ID: <1211310703.17044.11.camel@desk1>

On Tue, 2008-05-20 at 17:54 +0200, Laurent Pinchart wrote:

> Hi Les,
> 
> On Friday 16 May 2008, Les Smithson wrote:
> >  > Here you are. I'm going to be on vacation for a bit so I probably
> >  > won't be able to help you debug this for the next week and a half.
> >
> > Can I help with this? I have the same eMPIA/eeepc setup and I'd be willing
> > to pitch in.
> 
> Could you please try the patch I've just sent to the list ?
> 
> Best regards,
> 
> Laurent Pinchart


I applied both
https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080511/098fc953/attachment.bin and https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/f90fe500/attachment.bin to 209 and it seems to work . I'm using it with luvcview and motion, and it hasn't captured any bad frames yet. I'll try it under the strip lights at work tomorrow and let you know how I get on.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/96269fbc/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/96269fbc/attachment.pgp>

From lsmithso at hare.demon.co.uk  Tue May 20 23:24:28 2008
From: lsmithso at hare.demon.co.uk (Les Smithson)
Date: Tue, 20 May 2008 22:24:28 +0100
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return
	from	vidioc_dqbuf ioctl (Dan McGee)
In-Reply-To: <1211310703.17044.11.camel@desk1>
References: <44390.80.254.146.4.1210936840.squirrel@hare.demon.co.uk>
	<200805201754.25459.laurent.pinchart@skynet.be>
	<1211310703.17044.11.camel@desk1>
Message-ID: <1211318668.17044.20.camel@desk1>

On Tue, 2008-05-20 at 20:11 +0100, Les Smithson wrote:

> On Tue, 2008-05-20 at 17:54 +0200, Laurent Pinchart wrote: 
> 
> > Hi Les,
> > 
> > On Friday 16 May 2008, Les Smithson wrote:
> > >  > Here you are. I'm going to be on vacation for a bit so I probably
> > >  > won't be able to help you debug this for the next week and a half.
> > >
> > > Can I help with this? I have the same eMPIA/eeepc setup and I'd be willing
> > > to pitch in.
> > 
> > Could you please try the patch I've just sent to the list ?
> > 
> > Best regards,
> > 
> > Laurent Pinchart
> 
> 
> I applied both
> https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080511/098fc953/attachment.bin and https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/f90fe500/attachment.bin to 209 and it seems to work . I'm using it with luvcview and motion, and it hasn't captured any bad frames yet. I'll try it under the strip lights at work tomorrow and let you know how I get on.
> 
> 

I think I spoke too soon. I pointed the eeepc out of my window and got
lots of bad frames. They seem to be associated with these messages, but
its difficult to be sure:

[ 7815.340000] uvcvideo: Dropping payload (error bit set).
[ 7815.350000] uvcvideo: uvc_v4l2_ioctl
[ 7815.350000] v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc044560f)
[ 7815.350000] uvcvideo: Queuing buffer 1.
[ 7815.350000] uvcvideo: uvc_v4l2_ioctl
[ 7815.350000] v4l2 ioctl VIDIOC_DQBUF, dir=rw (0xc0445611)
[ 7815.350000] uvcvideo: Dequeuing buffer 2 (3, 153600 bytes).
[ 7815.350000] uvcvideo: Dropping payload (error bit set).
[ 7815.400000] uvcvideo: Frame complete (EOF found).
[ 7815.400000] uvcvideo: EOF in empty payload.
[ 7815.420000] uvcvideo: Dropping payload (error bit set).
[ 7815.430000] uvcvideo: Dropping payload (error bit set).
[ 7815.440000] uvcvideo: Dropping payload (error bit set).
[ 7815.450000] uvcvideo: Dropping payload (error bit set).
[ 7815.470000] uvcvideo: Dropping payload (error bit set).
[ 7815.470000] uvcvideo: Dropping payload (error bit set).
[ 7815.480000] uvcvideo: Dropping payload (error bit set).
[ 7815.500000] uvcvideo: Dropping payload (error bit set).
[ 7815.520000] uvcvideo: Dropping payload (error bit set).
[ 7815.530000] uvcvideo: Dropping payload (error bit set).
[ 7815.540000] uvcvideo: Dropping payload (error bit set).
[ 7815.550000] uvcvideo: Dropping payload (error bit set).
[ 7815.570000] uvcvideo: Dropping payload (error bit set).
[ 7815.580000] uvcvideo: Dropping payload (error bit set).
[ 7815.600000] uvcvideo: Dropping payload (error bit set).
[ 7815.600000] uvcvideo: Dropping payload (error bit set).
[ 7815.620000] uvcvideo: Dropping payload (error bit set).
[ 7815.630000] uvcvideo: Dropping payload (error bit set).
[ 7815.640000] uvcvideo: Dropping payload (error bit set).
[ 7815.650000] uvcvideo: Dropping payload (error bit set).
[ 7815.670000] uvcvideo: Dropping payload (error bit set).
[ 7815.670000] uvcvideo: Dropping payload (error bit set).
[ 7815.680000] uvcvideo: Dropping payload (error bit set).
[ 7815.700000] uvcvideo: Dropping payload (error bit set).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/5205dc8c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/5205dc8c/attachment.pgp>

From roger.pierce at gmail.com  Tue May 20 23:56:01 2008
From: roger.pierce at gmail.com (Roger Pierce)
Date: Tue, 20 May 2008 16:56:01 -0500
Subject: [Linux-uvc-devel] UVC-compliant webcam not working
Message-ID: <20080520215601.94f10dbb@mailhost.frost-electric.com>

Laurent, 

I have a webcam that identifies itself the same as the other Roger's but the patch did not work. 

Output of lsusb -v -d 1c4f:3000:
---------------------------------

Bus 001 Device 002: ID 1c4f:3000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x1c4f 
  idProduct          0x3000 
  bcdDevice            1.00
  iManufacturer           1 SiGma Micro
  iProduct                2 USB Web Camera
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          342
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              250mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               2 USB Web Camera
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              2 USB Web Camera
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           67
        dwClockFrequency       48.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0004200a
          Auto-Exposure Mode
          Exposure Time (Absolute)
          Roll (Absolute)
          Privacy
      VideoControl Interface Descriptor:
        bLength                 8
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0401 Composite Video
        bAssocTerminal          0
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 8
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               2
        baSource( 0)            1
        baSource( 1)            2
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000163f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval              32
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      145
        bEndPointAddress                  136
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                3
        bFlags                             16
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x03
          Still image supported
          Fixed frame-rate
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  4915200
        dwMaxBitRate                  4915200
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  0
        dwMinFrameInterval             333333
        dwMaxFrameInterval             666666
        dwFrameIntervalStep            333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x03
          Still image supported
          Fixed frame-rate
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  4915200
        dwMaxBitRate                  4915200
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  0
        dwMinFrameInterval             333333
        dwMaxFrameInterval             666666
        dwFrameIntervalStep            333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x03
          Still image supported
          Fixed frame-rate
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  4915200
        dwMaxBitRate                  4915200
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  0
        dwMinFrameInterval             333333
        dwMaxFrameInterval             666666
        dwFrameIntervalStep            333333
      VideoStreaming Interface Descriptor:
        bLength                            19
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               3
        wWidth( 0)                        320
        wHeight( 0)                       240
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        160
        wHeight( 2)                       120
        bNumCompressionPatterns             3
        bCompression( 0)                  128
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 1 (BT.709)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x025c  1x 604 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03bc  1x 956 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x024c  1x 588 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x02b0  1x 688 bytes
        bInterval               1
Device Status:     0x0000
  (Bus Powered)
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080520/b4547b5f/attachment.html>

From robin.hartley at xtra.co.nz  Wed May 21 10:50:03 2008
From: robin.hartley at xtra.co.nz (robin.hartley)
Date: Wed, 21 May 2008 20:50:03 +1200
Subject: [Linux-uvc-devel] New camera not yet supported. (1871:0306)
Message-ID: <iho734pg98jnp5utv5ov7dqhuuu09gk3t6@4ax.com>

Hello,
I have a USB 2 camera froma generic manufacture.
Under windows it is USB2.0 and does not require a vendors driver.

Under linux it appears as a UVC type of camera.

I have tried the latest SVN source (SVN r209) but it fails
initalisation.

I've set the driver to trace=5 and captured the following.
May 22 08:02:14 localhost usb 1-6: new high speed USB device using
ehci_hcd and address 9
May 22 08:02:14 localhost usb 1-6: configuration #1 chosen from 1
choice
May 22 08:02:14 localhost uvcvideo: Probing generic UVC device 6
May 22 08:02:14 localhost uvcvideo: Found UVC 1.00 device USB2.0
Camera (1871:0306)
May 22 08:02:14 localhost uvcvideo: Added control
00000000-0000-0000-0000-000000000101/2 to device 6 entity 3
May 22 08:02:14 localhost uvcvideo: Added control
00000000-0000-0000-0000-000000000101/3 to device 6 entity 3
May 22 08:02:14 localhost uvcvideo: Added control
00000000-0000-0000-0000-000000000101/7 to device 6 entity 3
May 22 08:02:14 localhost uvcvideo: Added control
00000000-0000-0000-0000-000000000101/8 to device 6 entity 3
May 22 08:02:14 localhost uvcvideo: Added control
00000000-0000-0000-0000-000000000101/9 to device 6 entity 3
May 22 08:02:14 localhost uvcvideo: Added control
00000000-0000-0000-0000-000000000101/5 to device 6 entity 3
May 22 08:02:14 localhost uvcvideo: Scanning UVC chain: OT 2 <- XU 4
<- PU 3 <- IT 1
May 22 08:02:14 localhost uvcvideo: Found a valid video chain (1 ->
2).
May 22 08:02:14 localhost uvcvideo: Failed to query (1) UVC control 2
(unit 0) : -32 (exp. 26).
May 22 08:02:14 localhost uvcvideo: Failed to initialize the device
(-5).

luvcview reports ERROR opening V4L interface
:no such file or directory.

I would like to help get this camera added to the supported list.
Please advise what I can do to help.

Regards,
Robin


From elbaddy at gmail.com  Wed May 21 16:04:14 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Wed, 21 May 2008 16:04:14 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <200805201801.38184.laurent.pinchart@skynet.be>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805201801.38184.laurent.pinchart@skynet.be>
Message-ID: <3d7891440805210704i5a62ca69j3bba1eb1f1b55a72@mail.gmail.com>

Thanks Laurent,
tha patch permits to view video stream through luvcview. But, for now,
it's the only software that I was able to use.
For example, gqcam gives "Error reading image..." and a green screen;
skype gives

Skype V4L2: Could not find a suitable capture format
Skype V4L2: Could not find a suitable capture format
Skype V4L2: Could not find a suitable capture format
Skype V4L2: Could not find a suitable capture format
Starting the process...
Skype Xv: Xv ports available: 1
Skype XShm: XShm support enabled
Skype Xv: Using Xv port 73
Skype Xv: No suitable overlay format found

and a black screen.

Loading the patched driver, kernel says:

uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
input: USB Web Camera as
/devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r209)

Regards


2008/5/20 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi Lorenzo,
>
> On Monday 19 May 2008, Lorenzo Battistini wrote:
>> Hello,
>> I have a USB web camera not listed at
>> http://linux-uvc.berlios.de/#devices. Device ID is 1c4f:3000 : it is
>> made in China and its box quotes "Shadow Series". I am not able to
>> view video stream with any software (gqcam, skype, camorama, luvcview,
>> mplayer...). I tried both with driver provided within ubuntu and with
>> the SVN version. Kernel gives:
>>
>> "uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
>> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
>> usbcore: registered new interface driver uvcvideo
>> USB Video Class driver (v0.1.0)"
>> or
>> "USB Video Class driver (SVN r209)" with SVN driver
>>
>> when some software tries to access to it:
>>
>> "uvcvideo: Failed to query (130) UVC control 1 (unit 0) : -32 (exp. 26)."
>>
>> or
>>
>> "uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1)."
>
> Could you please try the attached patch ?
>
> Best regards,
>
> Laurent Pinchart
>


From laurent.pinchart at skynet.be  Fri May 23 00:25:44 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 23 May 2008 00:25:44 +0200
Subject: [Linux-uvc-devel] Driver doesn't return from VIDIOC_DQBUF ioctl
In-Reply-To: <200805201738.59927.ricardo@isr.ist.utl.pt>
References: <200805190930.34140.ricardo@isr.ist.utl.pt>
	<200805201750.19902.laurent.pinchart@skynet.be>
	<200805201738.59927.ricardo@isr.ist.utl.pt>
Message-ID: <200805230025.44427.laurent.pinchart@skynet.be>

Hi Ricardo,

On Tuesday 20 May 2008, Ricardo Ferreira wrote:
> Hello,
>
> On Tuesday 20 May 2008 16:50:19 Laurent Pinchart wrote:
> > Hi Ricardo and Dan,
> >
> > could you please try the attached patch and see if it helps ?
>
> I have applied the patch to svn209. All modes seem to work in luvcview
> apart from an initial delay of 2-4 seconds, depending on the resolution, on
> the first dqueue ioctl. Does this have a cure or is it the camera
> initializing?

I'm pretty certain the delay is caused by the camera initialisation procedure. 
There's not much we can do about it.

> About the fps, my man page must be old, it does not mention the -i
> parameter to luvcview. I set it to >30  and the cameras are now doing the
> lsusb reported 30 fps (instead of the 15 as I mentioned in a previous
> mail). This is still only half of what phillips claims for this webcam, but
> I have seen somebody else in this forum complaining about the 1300 not
> being able to do 90fps as stated by the manufacturer.

I wouldn't be surprised if those high frame rates were achieved by software 
interpolation in the Windows driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri May 23 01:01:59 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 23 May 2008 01:01:59 +0200
Subject: [Linux-uvc-devel] UVC-compliant webcam not working
In-Reply-To: <20080520215601.94f10dbb@mailhost.frost-electric.com>
References: <20080520215601.94f10dbb@mailhost.frost-electric.com>
Message-ID: <200805230101.59973.laurent.pinchart@skynet.be>

Hi Roger,

On Tuesday 20 May 2008, Roger Pierce wrote:
> Laurent,
>
> I have a webcam that identifies itself the same as the other Roger's but
> the patch did not work.

Could you elaborate (test procedure, error messages, ...) ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri May 23 01:13:07 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 23 May 2008 01:13:07 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <3d7891440805210704i5a62ca69j3bba1eb1f1b55a72@mail.gmail.com>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805201801.38184.laurent.pinchart@skynet.be>
	<3d7891440805210704i5a62ca69j3bba1eb1f1b55a72@mail.gmail.com>
Message-ID: <200805230113.07808.laurent.pinchart@skynet.be>

Hi Lorenzo,

On Wednesday 21 May 2008, Lorenzo Battistini wrote:
> Thanks Laurent,
> tha patch permits to view video stream through luvcview.

Thanks for the report.

> But, for now, it's the only software that I was able to use.
> For example, gqcam gives "Error reading image..." and a green screen;

gqcam is old an unmaintained. It doesn't support V4L2.

> skype gives
>
> Skype V4L2: Could not find a suitable capture format
> Skype V4L2: Could not find a suitable capture format
> Skype V4L2: Could not find a suitable capture format
> Skype V4L2: Could not find a suitable capture format
> Starting the process...
> Skype Xv: Xv ports available: 1
> Skype XShm: XShm support enabled
> Skype Xv: Using Xv port 73
> Skype Xv: No suitable overlay format found

Your camera supports MJPEG only. Maybe Skype doesn't implement MJPEG 
decoding ?

> and a black screen.
>
> Loading the patched driver, kernel says:
>
> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> input: USB Web Camera as
> /devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (SVN r209)

If you're looking for a video conferencing application try Ekiga. It should 
work with the Linux UVC driver.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri May 23 01:19:47 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 23 May 2008 01:19:47 +0200
Subject: [Linux-uvc-devel] New camera not yet supported. (1871:0306)
In-Reply-To: <iho734pg98jnp5utv5ov7dqhuuu09gk3t6@4ax.com>
References: <iho734pg98jnp5utv5ov7dqhuuu09gk3t6@4ax.com>
Message-ID: <200805230119.48173.laurent.pinchart@skynet.be>

Hi Robin,

On Wednesday 21 May 2008, robin.hartley wrote:
> Hello,
> I have a USB 2 camera froma generic manufacture.
> Under windows it is USB2.0 and does not require a vendors driver.
>
> Under linux it appears as a UVC type of camera.
>
> I have tried the latest SVN source (SVN r209) but it fails
> initalisation.
>
> I've set the driver to trace=5 and captured the following.
> May 22 08:02:14 localhost usb 1-6: new high speed USB device using
> ehci_hcd and address 9
> May 22 08:02:14 localhost usb 1-6: configuration #1 chosen from 1
> choice
> May 22 08:02:14 localhost uvcvideo: Probing generic UVC device 6
> May 22 08:02:14 localhost uvcvideo: Found UVC 1.00 device USB2.0
> Camera (1871:0306)
> May 22 08:02:14 localhost uvcvideo: Added control
> 00000000-0000-0000-0000-000000000101/2 to device 6 entity 3
> May 22 08:02:14 localhost uvcvideo: Added control
> 00000000-0000-0000-0000-000000000101/3 to device 6 entity 3
> May 22 08:02:14 localhost uvcvideo: Added control
> 00000000-0000-0000-0000-000000000101/7 to device 6 entity 3
> May 22 08:02:14 localhost uvcvideo: Added control
> 00000000-0000-0000-0000-000000000101/8 to device 6 entity 3
> May 22 08:02:14 localhost uvcvideo: Added control
> 00000000-0000-0000-0000-000000000101/9 to device 6 entity 3
> May 22 08:02:14 localhost uvcvideo: Added control
> 00000000-0000-0000-0000-000000000101/5 to device 6 entity 3
> May 22 08:02:14 localhost uvcvideo: Scanning UVC chain: OT 2 <- XU 4
> <- PU 3 <- IT 1
> May 22 08:02:14 localhost uvcvideo: Found a valid video chain (1 ->
> 2).
> May 22 08:02:14 localhost uvcvideo: Failed to query (1) UVC control 2
> (unit 0) : -32 (exp. 26).
> May 22 08:02:14 localhost uvcvideo: Failed to initialize the device
> (-5).
>
> luvcview reports ERROR opening V4L interface
>
> :no such file or directory.
>
> I would like to help get this camera added to the supported list.
> Please advise what I can do to help.

Could you please try the attached patch ?

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: aveo.diff
Type: text/x-diff
Size: 712 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080523/ed737925/attachment.diff>

From cpmcraven at ou.edu  Fri May 23 11:34:23 2008
From: cpmcraven at ou.edu (Chris McRaven)
Date: Fri, 23 May 2008 04:34:23 -0500
Subject: [Linux-uvc-devel] Report of functioning Dynex webcam
Message-ID: <48368F9F.9090206@ou.edu>

To whom this may concern,

I am writing to report that the linux-uvc driver supports a webcam which
is not mentioned at linux-uvc.berlios.de. The device is the Dynex 1.3 MP
Webcam, model number DX-WEB1C.

[Qbert] /usr/src# uname -a
Linux Qbert.homelinux.org 2.6.24.4 #3 Wed May 21 13:24:18 CDT 2008 i686
GNU/Linux

Output from dmesg upon plugging the device into my usb hub:

[Qbert] /usr/src# dmesg | tail -n 3
uvcvideo: Found UVC 1.00 device Dynex 1.3MP Webcam (19ff:0102)
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)

The source was compiled from the debian package, linux-uvc-source:

[Qbert] /usr/src# dpkg -p linux-uvc-source
Package: linux-uvc-source
Priority: optional
Section: graphics
Installed-Size: 84
Maintainer: Nobuhiro Iwamatsu <iwamatsu at nigauri.org>
Architecture: all
Source: linux-uvc
Version: 0.1.0.svn193-2
Depends: debhelper, module-assistant
Size: 48642
Description: Linux kernel USB video class module
The linux-uvc kernel module supports some standard devices that
implement the USB video class.
.
It currently includes support for the Logitech Quickcam Fusion,
Logitech Quickcam Orbit, Logitech Quickcam Pro for Notebooks, Logitech
Quickcam Pro 5000 device

Both video capture and audio capture are functioning quite well.  I have
not found a problem yet.  Thank you for your work.

Cheers,
Chris



From pvuorela at gmail.com  Sat May 24 11:23:02 2008
From: pvuorela at gmail.com (Pekka Vuorela)
Date: Sat, 24 May 2008 12:23:02 +0300
Subject: [Linux-uvc-devel] ioctl on a disconnected device
Message-ID: <1211620982.9791.21.camel@maestro>

Hello,

I debugged a bug[1] I was having with Motion and noticed that the UVC
driver doesn't return an error when doing an ioctl() on a disconnected
device. Wouldn't ENODEV be a sensible value to return in such
situations? 

Anyway, this small patch adds a check in the beginning of
uvc_v4l2_do_ioctl(). With the patch Motion works with me as it seems to
work with the pwc driver. 

1:
http://www.lavrsen.dk/twiki/bin/view/Motion/BugReport2008x05x17x175521

-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc-disconnected-device-ioctl-enodev.patch
Type: text/x-patch
Size: 379 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080524/0b40df66/attachment.bin>

From elbaddy at gmail.com  Mon May 26 20:36:56 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Mon, 26 May 2008 20:36:56 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <200805230113.07808.laurent.pinchart@skynet.be>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805201801.38184.laurent.pinchart@skynet.be>
	<3d7891440805210704i5a62ca69j3bba1eb1f1b55a72@mail.gmail.com>
	<200805230113.07808.laurent.pinchart@skynet.be>
Message-ID: <3d7891440805261136m69035bceyedafc36efa066631@mail.gmail.com>

Hi Laurent

2008/5/23 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi Lorenzo,
>
> On Wednesday 21 May 2008, Lorenzo Battistini wrote:
>> Thanks Laurent,
>> tha patch permits to view video stream through luvcview.
>
> Thanks for the report.
>
>> But, for now, it's the only software that I was able to use.
>> For example, gqcam gives "Error reading image..." and a green screen;
>
> gqcam is old an unmaintained. It doesn't support V4L2.
>
>> skype gives
>>
>> Skype V4L2: Could not find a suitable capture format
>> Skype V4L2: Could not find a suitable capture format
>> Skype V4L2: Could not find a suitable capture format
>> Skype V4L2: Could not find a suitable capture format
>> Starting the process...
>> Skype Xv: Xv ports available: 1
>> Skype XShm: XShm support enabled
>> Skype Xv: Using Xv port 73
>> Skype Xv: No suitable overlay format found
>
> Your camera supports MJPEG only. Maybe Skype doesn't implement MJPEG
> decoding ?
>
>> and a black screen.
>>
>> Loading the patched driver, kernel says:
>>
>> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
>> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
>> input: USB Web Camera as
>> /devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
>> usbcore: registered new interface driver uvcvideo
>> USB Video Class driver (SVN r209)
>
> If you're looking for a video conferencing application try Ekiga. It should
> work with the Linux UVC driver.

But ekiga gives "Error while opening video device USB Web" (I didn't
find details).

Testing through gstreamer-properties:

gstreamer-properties-Message: Error running pipeline 'Video for Linux
2 (v4l2)': Failed getting controls attributes on device '/dev/video0.'
[v4l2_calls.c(243): gst_v4l2_fill_lists (): /pipeline0/v4l2src4:
Failed querying control 9963788 on device '/dev/video0'. (5 -
Input/output error)]

Regards


From stefan.bauer at plzk.de  Tue May 27 19:40:46 2008
From: stefan.bauer at plzk.de (Stefan Bauer)
Date: Tue, 27 May 2008 19:40:46 +0200
Subject: [Linux-uvc-devel] hp 2133 camera -  CNF7070
Message-ID: <20080527174046.GA21509@plzk.de>

Dear Users,

i just compiled the latest source from the trunk repository and load the
modules. here is what i got:

uvcvideo: Found UVC 1.00 device CNF7070 (04f2:b107)
usbcore: registered new interface driver uvcvideo

lsusb gets me:

Bus 001 Device 002: ID 04f2:b107 Chicony Electronics Co., Ltd

Its the integrated camera on my brand new hp 2133 subnotebook.

the output from above looks good so i tried to access the device
/dev/video with the following mplayer stanza:

mplayer tv:// ndevice=/dev/video

Unfortunatelly i only got a green sreen, output of mplayer below:

sb at hpux:~$ mplayer tv:// device=/dev/video0 -vo x11
MPlayer 1.0rc1-4.1.2-DFSG-free (C) 2000-2006 MPlayer Team
CPU: VIA C7-M Processor 1200MHz (Family: 6, Model: 13, Stepping: 0)
CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
Compiled with runtime CPU detection.
mplayer: could not connect to socket
mplayer: No such file or directory
Failed to open LIRC support. You will not be able to use your remote
control.

Playing tv://.
TV file format detected.
Selected driver: dummy
 name: NULL-TV
  author: alex
  Selected input hasn't got a tuner!
  open: No such file or directory
  [MGA] Couldn't open: /dev/mga_vid
  open: No such file or directory
  [MGA] Couldn't open: /dev/mga_vid
  [VO_TDFXFB] This driver only supports the 3Dfx Banshee, Voodoo3 and
  Voodoo 5.
  [VO_3DFX] Unable to open /dev/3dfx.
  It seems there is no Xvideo support for your video card available.
  Run 'xvinfo' to verify its Xv support and read
  DOCS/HTML/en/video.html#xv!
  See 'mplayer -vo help' for other (non-xv) video out drivers. Try -vo
  x11
  ==========================================================================
  Opening video decoder: [raw] RAW Uncompressed Video
  VDec: vo config request - 320 x 200 (preferred colorspace: Planar
  YV12)
  VDec: using Planar YV12 as output csp (no 0)
  Movie-Aspect is undefined - no prescaling applied.
  VO: [x11] 320x200 => 320x200 Planar YV12 
  SwScaler: using unscaled yuv420p -> rgb32 special converter
  Selected video codec: [rawyv12] vfm: raw (RAW YV12)
  ==========================================================================
  Starting playback...

  after that i only get a green screen - any ideas?

any help is greatly appreciated

regards

stefan


From dusanc at gmail.com  Wed May 28 14:17:41 2008
From: dusanc at gmail.com (Dushan Tcholich)
Date: Wed, 28 May 2008 14:17:41 +0200
Subject: [Linux-uvc-devel] MSI Starcam racer UVC webcam support
In-Reply-To: <a08621850805280454x89276c7mf0c1628be89d295b@mail.gmail.com>
References: <a08621850805280454x89276c7mf0c1628be89d295b@mail.gmail.com>
Message-ID: <a08621850805280517j735fedddr531ef52ec518741f@mail.gmail.com>

Hi
I have a MSI starcam racer USB webcam that's not currently supported in linux.
Drivers for windows mention UVC support so as I couldn't find it on
the supported devices on linux-uvc web site I'd like to try to make it
work if I can.

Some data can be found on MSI website:
http://global.msi.com.tw/index.php?func=proddesc&maincat_no=132&cat2_no=&cat3_no=&prod_no=1217
lsusb gives:
Bus 002 Device 004: ID 0c45:62e0 Microdia

I opened it and found that it has this controller:
SN9C255
http://www.sonix.com.tw/sonix/product.do?p=SN9C255

And it has MI1320 sensor.

If you need any other info please cc me as I'm not subscribed.

Thanks in advance

Dushan Tcholich


From ricardo at isr.ist.utl.pt  Wed May 28 21:45:41 2008
From: ricardo at isr.ist.utl.pt (Ricardo Ferreira)
Date: Wed, 28 May 2008 20:45:41 +0100
Subject: [Linux-uvc-devel] Some cameras do not respond to
	VIDIOC_ENUM_FRAMEINTERVALS
Message-ID: <200805282045.51890.ricardo@isr.ist.utl.pt>

Hello all,

As stated in a previous thread, I've got 2 cameras using the uvc driver:

004: ID 0471:0332 Philips
05c8:0103 Cheng Uei Precision Industry Co., Ltd (Foxlink)

I just noticed that the between svn202 and svn203 (a rather big commit), the 
foxlink no longer answers to VIDIOC_ENUM_FRAMEINTERVALS (the phillips still 
works fine).

luvcview -L doesn't enumerate them:

ricardo at LatasG:~/tmp/uvc/trunk$ luvcview -d /dev/video0 -L
luvcview 0.2.4

SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
        Time interval between frame:
{ discrete: width = 352, height = 288 }
        Time interval between frame:
{ discrete: width = 320, height = 240 }
        Time interval between frame:
{ discrete: width = 176, height = 144 }
        Time interval between frame:
{ discrete: width = 160, height = 120 }
        Time interval between frame:
{ discrete: width = 1280, height = 960 }
        Time interval between frame:
{ discrete: width = 1280, height = 1024 }
        Time interval between frame:


and my own code:

ioctl (currentFd, VIDIOC_ENUM_FRAMEINTERVALS, &frameinterval)

exits with errno==EINVAL (with frameinterval.index=0) - indicating no more 
frameintervals available. 

Once again, with version svn202 all the frameintervals are listed correctly 
with both cameras, and the phillips webcam works with every svn version 
tested.

I've sent both "lsusb" in the previous thread "[Linux-uvc-devel] Driver 
doesn't return from VIDIOC_DQBUF ioctl".

thanks for your time,
Ricardo

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080528/c64fd97f/attachment.pgp>

From laurent.pinchart at skynet.be  Thu May 29 17:07:39 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 17:07:39 +0200
Subject: [Linux-uvc-devel] Some cameras do not respond to
	VIDIOC_ENUM_FRAMEINTERVALS
In-Reply-To: <200805282045.51890.ricardo@isr.ist.utl.pt>
References: <200805282045.51890.ricardo@isr.ist.utl.pt>
Message-ID: <200805291707.39945.laurent.pinchart@skynet.be>

Hi Ricardo,

thanks for the report. The problem should be fixed now in the latest SVN 
revision. Could you please check ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 29 17:11:54 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 17:11:54 +0200
Subject: [Linux-uvc-devel] MSI Starcam racer UVC webcam support
In-Reply-To: <a08621850805280517j735fedddr531ef52ec518741f@mail.gmail.com>
References: <a08621850805280454x89276c7mf0c1628be89d295b@mail.gmail.com>
	<a08621850805280517j735fedddr531ef52ec518741f@mail.gmail.com>
Message-ID: <200805291711.54105.laurent.pinchart@skynet.be>

Hi Dushan,

On Wednesday 28 May 2008, Dushan Tcholich wrote:
> Hi
> I have a MSI starcam racer USB webcam that's not currently supported in
> linux. Drivers for windows mention UVC support so as I couldn't find it on
> the supported devices on linux-uvc web site I'd like to try to make it work
> if I can.

Even when not listed on the Linux UVC website, UVC-compatible cameras should 
work out of the box with the driver. Have you tried your camera yet ?

If it doesn't work, please explain the steps you followed to test it, and 
report complete error messages along with uvcvideo-related kernel log 
messages.

> Some data can be found on MSI website:
> http://global.msi.com.tw/index.php?func=proddesc&maincat_no=132&cat2_no=&ca
>t3_no=&prod_no=1217 lsusb gives:
> Bus 002 Device 004: ID 0c45:62e0 Microdia
>
> I opened it and found that it has this controller:
> SN9C255
> http://www.sonix.com.tw/sonix/product.do?p=SN9C255
>
> And it has MI1320 sensor.
>
> If you need any other info please cc me as I'm not subscribed.

Could you please send me the output of

lsusb -v -d 0c45:62e0

using usbutils 0.72 or newer (0.73+ preferred) ?

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 29 17:19:25 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 17:19:25 +0200
Subject: [Linux-uvc-devel] hp 2133 camera -  CNF7070
In-Reply-To: <20080527174046.GA21509@plzk.de>
References: <20080527174046.GA21509@plzk.de>
Message-ID: <200805291719.26076.laurent.pinchart@skynet.be>

Hi Stefan,

On Tuesday 27 May 2008, Stefan Bauer wrote:
> Dear Users,
>
> i just compiled the latest source from the trunk repository and load the
> modules. here is what i got:
>
> uvcvideo: Found UVC 1.00 device CNF7070 (04f2:b107)
> usbcore: registered new interface driver uvcvideo
>
> lsusb gets me:
>
> Bus 001 Device 002: ID 04f2:b107 Chicony Electronics Co., Ltd

Could you please send me the output of

lsusb -v -d 04f2:b107

using usbutils 0.72 or newer (0.73+ preferred) ?

> Its the integrated camera on my brand new hp 2133 subnotebook.
>
> the output from above looks good so i tried to access the device
> /dev/video with the following mplayer stanza:
>
> mplayer tv:// ndevice=/dev/video
>
> Unfortunatelly i only got a green sreen, output of mplayer below:
>
> sb at hpux:~$ mplayer tv:// device=/dev/video0 -vo x11
> MPlayer 1.0rc1-4.1.2-DFSG-free (C) 2000-2006 MPlayer Team
> CPU: VIA C7-M Processor 1200MHz (Family: 6, Model: 13, Stepping: 0)
> CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
> Compiled with runtime CPU detection.
> mplayer: could not connect to socket
> mplayer: No such file or directory
> Failed to open LIRC support. You will not be able to use your remote
> control.
>
> Playing tv://.
> TV file format detected.
> Selected driver: dummy
>  name: NULL-TV
>   author: alex
>   Selected input hasn't got a tuner!
>   open: No such file or directory
>   [MGA] Couldn't open: /dev/mga_vid
>   open: No such file or directory
>   [MGA] Couldn't open: /dev/mga_vid
>   [VO_TDFXFB] This driver only supports the 3Dfx Banshee, Voodoo3 and
>   Voodoo 5.
>   [VO_3DFX] Unable to open /dev/3dfx.
>   It seems there is no Xvideo support for your video card available.
>   Run 'xvinfo' to verify its Xv support and read
>   DOCS/HTML/en/video.html#xv!
>   See 'mplayer -vo help' for other (non-xv) video out drivers. Try -vo
>   x11
>  
> ==========================================================================
> Opening video decoder: [raw] RAW Uncompressed Video
>   VDec: vo config request - 320 x 200 (preferred colorspace: Planar
>   YV12)
>   VDec: using Planar YV12 as output csp (no 0)
>   Movie-Aspect is undefined - no prescaling applied.
>   VO: [x11] 320x200 => 320x200 Planar YV12
>   SwScaler: using unscaled yuv420p -> rgb32 special converter
>   Selected video codec: [rawyv12] vfm: raw (RAW YV12)
>  
> ==========================================================================
> Starting playback...
>
>   after that i only get a green screen - any ideas?

Does the driver print any error/warning message in the kernel log when you 
start mplayer ?

If possible I'd like you to test your camera with luvcview and report the 
results.

Best regards,

Laurent Pinchart


From stefan.bauer at plzk.de  Thu May 29 19:23:22 2008
From: stefan.bauer at plzk.de (Stefan Bauer)
Date: Thu, 29 May 2008 19:23:22 +0200
Subject: [Linux-uvc-devel] hp 2133 camera -  CNF7070
In-Reply-To: <200805291719.26076.laurent.pinchart@skynet.be>
References: <20080527174046.GA21509@plzk.de>
	<200805291719.26076.laurent.pinchart@skynet.be>
Message-ID: <20080529172322.GA13435@plzk.de>

* Laurent Pinchart <laurent.pinchart at skynet.be> [29.05.2008 17:11]:
> Could you please send me the output of
> 
> lsusb -v -d 04f2:b107
> 
> using usbutils 0.72 or newer (0.73+ preferred) ?

hi,

please see the output below (debian etch stable with usbutils 0.7.2-7)

Bus 001 Device 002: ID 04f2:b107 Chicony Electronics Co., Ltd 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04f2 Chicony Electronics Co., Ltd
  idProduct          0xb107 
  bcdDevice            8.52
  iManufacturer           2 Chicony Electronics Co., Ltd.
  iProduct                1 CNF7070
  iSerial                 3 SN0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          523
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower               98mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 Webcam-101
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 Webcam-101
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {28f03370-6311-4a2e-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {2812ae3f-bcd7-4e11-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000053f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
        iProcessing             0 
        bmVideoStandards     0x93
          None
          NTSC - 525/60
          NTSC - 625/50
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormarts                        1
        wTotalLength                    33025
        bEndPointAddress                    0
        bmInfo                              2
        bTerminalLink                       0
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat                            {32595559-0000-0010-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  3072000
        dwMaxBitRate                 13516800
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         454545
        bFrameIntervalType                  5
        dwFrameInterval( 0)            454545
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  1013760
        dwMaxBitRate                  4460544
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         454545
        bFrameIntervalType                  5
        dwFrameInterval( 0)            454545
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   768000
        dwMaxBitRate                  3379200
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         454545
        bFrameIntervalType                  5
        dwFrameInterval( 0)            454545
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   253440
        dwMaxBitRate                  1115136
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         454545
        bFrameIntervalType                  5
        dwFrameInterval( 0)            454545
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   192000
        dwMaxBitRate                   844800
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         454545
        bFrameIntervalType                  5
        dwFrameInterval( 0)            454545
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 0 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled

> Does the driver print any error/warning message in the kernel log when you 
so far, no kernel logs. only the following which are related to the
uvc module:

Linux video capture interface: v2.00
uvcvideo: Found UVC 1.00 device CNF7070 (04f2:b107)
input: CNF7070 as /class/input/input6
usbcore: registered new interface driver uvcvideo
USB Video Class driver (SVN r209)

> If possible I'd like you to test your camera with luvcview and report the 
> results.

perfect! :) well it works like a charm. it's a shame that this piece of software is is still not available in the stable debian repository so i had to build it by myself.

regards

stefan


From laurent.pinchart at skynet.be  Thu May 29 20:12:25 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 20:12:25 +0200
Subject: [Linux-uvc-devel] hp 2133 camera -  CNF7070
In-Reply-To: <20080529172322.GA13435@plzk.de>
References: <20080527174046.GA21509@plzk.de>
	<200805291719.26076.laurent.pinchart@skynet.be>
	<20080529172322.GA13435@plzk.de>
Message-ID: <200805292012.25476.laurent.pinchart@skynet.be>

Hi Stefan,

On Thursday 29 May 2008, Stefan Bauer wrote:
> * Laurent Pinchart <laurent.pinchart at skynet.be> [29.05.2008 17:11]:
> > Could you please send me the output of
> >
> > lsusb -v -d 04f2:b107
> >
> > using usbutils 0.72 or newer (0.73+ preferred) ?
>
> hi,
>
> please see the output below (debian etch stable with usbutils 0.7.2-7)

Thanks.

> Bus 001 Device 002: ID 04f2:b107 Chicony Electronics Co., Ltd
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 Common Class
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   idVendor           0x04f2 Chicony Electronics Co., Ltd
>   idProduct          0xb107
>   bcdDevice            8.52
>   iManufacturer           2 Chicony Electronics Co., Ltd.
>   iProduct                1 CNF7070
>   iSerial                 3 SN0001
>   bNumConfigurations      1
>   Configuration Descriptor:
>     bLength                 9
>     bDescriptorType         2
>     wTotalLength          523
>     bNumInterfaces          2
>     bConfigurationValue     1
>     iConfiguration          0
>     bmAttributes         0x80
>       (Bus Powered)
>     MaxPower               98mA
>     Interface Association:
>       bLength                 8
>       bDescriptorType        11
>       bFirstInterface         0
>       bInterfaceCount         2
>       bFunctionClass         14 Video
>       bFunctionSubClass       3 Video Interface Collection
>       bFunctionProtocol       0
>       iFunction               5 Webcam-101
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      1 Video Control
>       bInterfaceProtocol      0
>       iInterface              5 Webcam-101
>       VideoControl Interface Descriptor:
>         bLength                13
>         bDescriptorType        36
>         bDescriptorSubtype      1 (HEADER)
>         bcdUVC               1.00
>         wTotalLength          103
>         dwClockFrequency       15.000000MHz
>         bInCollection           1
>         baInterfaceNr( 0)       1
>       VideoControl Interface Descriptor:
>         bLength                 9
>         bDescriptorType        36
>         bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>         bTerminalID             2
>         wTerminalType      0x0101 USB Streaming
>         bAssocTerminal          0
>         bSourceID               5
>         iTerminal               0
>       VideoControl Interface Descriptor:
>         bLength                26
>         bDescriptorType        36
>         bDescriptorSubtype      6 (EXTENSION_UNIT)
>         bUnitID                 4
>         guidExtensionCode         {28f03370-6311-4a2e-ba2c-6890eb334016}
>         bNumControl             8
>         bNrPins                 1
>         baSourceID( 0)          3
>         bControlSize            1
>         bmControls( 0)       0x0f
>         iExtension              0
>       VideoControl Interface Descriptor:
>         bLength                26
>         bDescriptorType        36
>         bDescriptorSubtype      6 (EXTENSION_UNIT)
>         bUnitID                 5
>         guidExtensionCode         {2812ae3f-bcd7-4e11-a357-6f1edef7d61d}
>         bNumControl             8
>         bNrPins                 1
>         baSourceID( 0)          4
>         bControlSize            1
>         bmControls( 0)       0xff
>         iExtension              0
>       VideoControl Interface Descriptor:
>         bLength                18
>         bDescriptorType        36
>         bDescriptorSubtype      2 (INPUT_TERMINAL)
>         bTerminalID             1
>         wTerminalType      0x0201 Camera Sensor
>         bAssocTerminal          0
>         iTerminal               0
>         wObjectiveFocalLengthMin      0
>         wObjectiveFocalLengthMax      0
>         wOcularFocalLength            0
>         bControlSize                  3
>         bmControls           0x00000000
>       VideoControl Interface Descriptor:
>         bLength                11
>         bDescriptorType        36
>         bDescriptorSubtype      5 (PROCESSING_UNIT)
>       Warning: Descriptor too short
>         bUnitID                 3
>         bSourceID               1
>         wMaxMultiplier          0
>         bControlSize            2
>         bmControls     0x0000053f
>           Brightness
>           Contrast
>           Hue
>           Saturation
>           Sharpness
>           Gamma
>           Backlight Compensation
>           Power Line Frequency
>         iProcessing             0
>         bmVideoStandards     0x93
>           None
>           NTSC - 525/60
>           NTSC - 625/50
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x83  EP 3 IN
>         bmAttributes            3
>           Transfer Type            Interrupt
>           Synch Type               None
>           Usage Type               Data
>         wMaxPacketSize     0x0010  1x 16 bytes
>         bInterval               6
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       0
>       bNumEndpoints           0
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       VideoStreaming Interface Descriptor:
>         bLength                            14
>         bDescriptorType                    36
>         bDescriptorSubtype                  1 (INPUT_HEADER)
>         bNumFormarts                        1
>         wTotalLength                    33025
>         bEndPointAddress                    0
>         bmInfo                              2
>         bTerminalLink                       0
>         bStillCaptureMethod                 1
>         bTriggerSupport                     1
>         bTriggerUsage                       1
>         bControlSize                        1
>         bmaControls( 0)                    27
>       VideoStreaming Interface Descriptor:
>         bLength                            27
>         bDescriptorType                    36
>         bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
>         bFormatIndex                        1
>         bNumFrameDescriptors                5
>         guidFormat                           
> {32595559-0000-0010-8000-00aa00389b71} bBitsPerPixel                     
> 16
>         bDefaultFrameIndex                  1
>         bAspectRatioX                       0
>         bAspectRatioY                       0
>         bmInterlaceFlags                 0x00
>           Interlaced stream or variable: No
>           Fields per frame: 1 fields
>           Field 1 first: No
>           Field pattern: Field 1 only
>           bCopyProtect                      0
>       VideoStreaming Interface Descriptor:
>         bLength                            46
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         1
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            640
>         wHeight                           480
>         dwMinBitRate                  3072000
>         dwMaxBitRate                 13516800
>         dwMaxVideoFrameBufferSize      614400
>         dwDefaultFrameInterval         454545
>         bFrameIntervalType                  5
>         dwFrameInterval( 0)            454545
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>       VideoStreaming Interface Descriptor:
>         bLength                            46
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         2
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            352
>         wHeight                           288
>         dwMinBitRate                  1013760
>         dwMaxBitRate                  4460544
>         dwMaxVideoFrameBufferSize      202752
>         dwDefaultFrameInterval         454545
>         bFrameIntervalType                  5
>         dwFrameInterval( 0)            454545
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>       VideoStreaming Interface Descriptor:
>         bLength                            46
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         3
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            320
>         wHeight                           240
>         dwMinBitRate                   768000
>         dwMaxBitRate                  3379200
>         dwMaxVideoFrameBufferSize      153600
>         dwDefaultFrameInterval         454545
>         bFrameIntervalType                  5
>         dwFrameInterval( 0)            454545
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>       VideoStreaming Interface Descriptor:
>         bLength                            46
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         4
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            176
>         wHeight                           144
>         dwMinBitRate                   253440
>         dwMaxBitRate                  1115136
>         dwMaxVideoFrameBufferSize       50688
>         dwDefaultFrameInterval         454545
>         bFrameIntervalType                  5
>         dwFrameInterval( 0)            454545
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>       VideoStreaming Interface Descriptor:
>         bLength                            46
>         bDescriptorType                    36
>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>         bFrameIndex                         5
>         bmCapabilities                   0x00
>           Still image unsupported
>         wWidth                            160
>         wHeight                           120
>         dwMinBitRate                   192000
>         dwMaxBitRate                   844800
>         dwMaxVideoFrameBufferSize       38400
>         dwDefaultFrameInterval         454545
>         bFrameIntervalType                  5
>         dwFrameInterval( 0)            454545
>         dwFrameInterval( 1)            500000
>         dwFrameInterval( 2)            666666
>         dwFrameInterval( 3)           1000000
>         dwFrameInterval( 4)           2000000
>       VideoStreaming Interface Descriptor:
>         bLength                             6
>         bDescriptorType                    36
>         bDescriptorSubtype                 13 (COLORFORMAT)
>         bColorPrimaries                     1 (BT.709,sRGB)
>         bTransferCharacteristics            1 (BT.709)
>         bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       1
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0080  1x 128 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       2
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0100  1x 256 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       3
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0320  1x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       4
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x0b20  2x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       5
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1320  3x 800 bytes
>         bInterval               1
>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        1
>       bAlternateSetting       6
>       bNumEndpoints           1
>       bInterfaceClass        14 Video
>       bInterfaceSubClass      2 Video Streaming
>       bInterfaceProtocol      0
>       iInterface              0
>       Endpoint Descriptor:
>         bLength                 7
>         bDescriptorType         5
>         bEndpointAddress     0x81  EP 1 IN
>         bmAttributes            5
>           Transfer Type            Isochronous
>           Synch Type               Asynchronous
>           Usage Type               Data
>         wMaxPacketSize     0x1400  3x 0 bytes
>         bInterval               1
> Device Qualifier (for other device speed):
>   bLength                10
>   bDescriptorType         6
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 Common Class
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   bNumConfigurations      1
> Device Status:     0x0002
>   (Bus Powered)
>   Remote Wakeup Enabled
>
> > Does the driver print any error/warning message in the kernel log when
> > you
>
> so far, no kernel logs. only the following which are related to the
> uvc module:
>
> Linux video capture interface: v2.00
> uvcvideo: Found UVC 1.00 device CNF7070 (04f2:b107)
> input: CNF7070 as /class/input/input6
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (SVN r209)
>
> > If possible I'd like you to test your camera with luvcview and report the
> > results.
>
> perfect! :) well it works like a charm. it's a shame that this piece of
> software is is still not available in the stable debian repository so i had
> to build it by myself.

mplayer had a bug which prevented if from working properly with the Linux UVC 
driver. The code is fixed in mplayer SVN but I'm not sure if they released a 
version including the fix.

Best regards,

Laurent Pinchart


From stefan.bauer at plzk.de  Thu May 29 20:09:16 2008
From: stefan.bauer at plzk.de (Stefan Bauer)
Date: Thu, 29 May 2008 20:09:16 +0200
Subject: [Linux-uvc-devel] hp 2133 camera -  CNF7070
In-Reply-To: <200805292012.25476.laurent.pinchart@skynet.be>
References: <20080527174046.GA21509@plzk.de>
	<200805291719.26076.laurent.pinchart@skynet.be>
	<20080529172322.GA13435@plzk.de>
	<200805292012.25476.laurent.pinchart@skynet.be>
Message-ID: <20080529180916.GA11892@plzk.de>

* Laurent Pinchart <laurent.pinchart at skynet.be> [29.05.2008 20:04]:
> mplayer had a bug which prevented if from working properly with the Linux UVC 
> driver. The code is fixed in mplayer SVN but I'm not sure if they released a 
> version including the fix.
> 

thank you for the details. i will give a recent version of mplayer from svn a try and
will post a follow up if it works.

regards

stefan


From laurent.pinchart at skynet.be  Thu May 29 21:02:11 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 21:02:11 +0200
Subject: [Linux-uvc-devel] Report of functioning Dynex webcam
In-Reply-To: <48368F9F.9090206@ou.edu>
References: <48368F9F.9090206@ou.edu>
Message-ID: <200805292102.11628.laurent.pinchart@skynet.be>

Hi Chris,

thanks for the report. I've updated the supported devices list on the website.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 29 21:17:30 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 21:17:30 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <3d7891440805261136m69035bceyedafc36efa066631@mail.gmail.com>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805230113.07808.laurent.pinchart@skynet.be>
	<3d7891440805261136m69035bceyedafc36efa066631@mail.gmail.com>
Message-ID: <200805292117.30490.laurent.pinchart@skynet.be>

Hi Lorenzo,

On Monday 26 May 2008, Lorenzo Battistini wrote:
> Hi Laurent
>
> 2008/5/23 Laurent Pinchart <laurent.pinchart at skynet.be>:
> > Hi Lorenzo,
> >
> > On Wednesday 21 May 2008, Lorenzo Battistini wrote:
> >> Thanks Laurent,
> >> tha patch permits to view video stream through luvcview.
> >
> > Thanks for the report.
> >
> >> But, for now, it's the only software that I was able to use.
> >> For example, gqcam gives "Error reading image..." and a green screen;
> >
> > gqcam is old an unmaintained. It doesn't support V4L2.
> >
> >> skype gives
> >>
> >> Skype V4L2: Could not find a suitable capture format
> >> Skype V4L2: Could not find a suitable capture format
> >> Skype V4L2: Could not find a suitable capture format
> >> Skype V4L2: Could not find a suitable capture format
> >> Starting the process...
> >> Skype Xv: Xv ports available: 1
> >> Skype XShm: XShm support enabled
> >> Skype Xv: Using Xv port 73
> >> Skype Xv: No suitable overlay format found
> >
> > Your camera supports MJPEG only. Maybe Skype doesn't implement MJPEG
> > decoding ?
> >
> >> and a black screen.
> >>
> >> Loading the patched driver, kernel says:
> >>
> >> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
> >> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
> >> input: USB Web Camera as
> >> /devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
> >> usbcore: registered new interface driver uvcvideo
> >> USB Video Class driver (SVN r209)
> >
> > If you're looking for a video conferencing application try Ekiga. It
> > should work with the Linux UVC driver.
>
> But ekiga gives "Error while opening video device USB Web" (I didn't
> find details).

Could you please check the kernel log after Ekiga's failure and report any 
message printed by the driver ?

> Testing through gstreamer-properties:
>
> gstreamer-properties-Message: Error running pipeline 'Video for Linux
> 2 (v4l2)': Failed getting controls attributes on device '/dev/video0.'
> [v4l2_calls.c(243): gst_v4l2_fill_lists (): /pipeline0/v4l2src4:
> Failed querying control 9963788 on device '/dev/video0'. (5 -
> Input/output error)]

Best regards,

Laurent Pinchart


From dereck.sun at free.fr  Thu May 29 22:32:44 2008
From: dereck.sun at free.fr (Tristan RENAUD)
Date: Thu, 29 May 2008 22:32:44 +0200
Subject: [Linux-uvc-devel] New Webcam
Message-ID: <200805292232.44807.dereck.sun@free.fr>

Hi,

I have plugged my webcam to my Mandriva 2008.1 Linux PC, and it works fine 
with the uvcvideo driver. I test it with Kopete.

Informations about that webcam :
Device ID = 145f:013f
Name = Trust Megapixel USB2 Auto Focus Webcam
Manufacturer = Trust

NOTE : lsusb don't display Name and Manufacturer. I don't know who to contact 
to add those informations...

NOTE 2 : mic works with the sound_usb_audio driver

When looking at dmesg|grep uvc, I get some messages :

uvcvideo: Found UVC 1.00 device USB 2.0 Camera (145f:013f)
usbcore: registered new interface driver uvcvideo
uvcvideo: Failed to query (1) UVC control 9 (unit 3) : -32 (exp. 2).
uvcvideo: Failed to query (1) UVC control 9 (unit 3) : -32 (exp. 2).

Don't know if this is important for you. I can do some tests if you need. Tell 
me what to do, I'll try it and report to you.

Hope that help to have a more user-friendly Linux !!

Tristan RENAUD.
-- 
Tristan RENAUD
___________________________
Site Web  : http://cyberconnexion.free.fr
JABBER ID : tristan at jabber.fr
 YAHOO ID : dereck_sun at yahoo
   MSN ID : dereck.sun at free.fr
   ICQ ID : 1196863


From laurent.pinchart at skynet.be  Thu May 29 22:58:01 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 22:58:01 +0200
Subject: [Linux-uvc-devel] [linux-uvc-devel] driver doesn't return from
	vidioc_dqbuf ioctl (Dan McGee)
In-Reply-To: <1211313568.17044.18.camel@desk1>
References: <44390.80.254.146.4.1210936840.squirrel@hare.demon.co.uk>
	<200805201754.25459.laurent.pinchart@skynet.be>
	<1211313568.17044.18.camel@desk1>
Message-ID: <200805292258.01568.laurent.pinchart@skynet.be>

Hi Les,

On Tuesday 20 May 2008, Les Smithson wrote:
> On Tue, 2008-05-20 at 17:54 +0200, Laurent Pinchart wrote:
> > Hi Les,
> >
> > On Friday 16 May 2008, Les Smithson wrote:
> > >  > Here you are. I'm going to be on vacation for a bit so I probably
> > >  > won't be able to help you debug this for the next week and a half.
> > >
> > > Can I help with this? I have the same eMPIA/eeepc setup and I'd be
> > > willing to pitch in.
> >
> > Could you please try the patch I've just sent to the list ?
> >
> > Best regards,
> >
> > Laurent Pinchart
>
> I think I spoke too soon. I pointed the eeepc out of my window and I get
> lots of bad frames (see attached). They seem to be associated with these
> messages:
>
> [ 7815.340000] uvcvideo: Dropping payload (error bit set).
> [ 7815.350000] uvcvideo: uvc_v4l2_ioctl
> [ 7815.350000] v4l2 ioctl VIDIOC_QBUF, dir=rw (0xc044560f)
> [ 7815.350000] uvcvideo: Queuing buffer 1.
> [ 7815.350000] uvcvideo: uvc_v4l2_ioctl
> [ 7815.350000] v4l2 ioctl VIDIOC_DQBUF, dir=rw (0xc0445611)
> [ 7815.350000] uvcvideo: Dequeuing buffer 2 (3, 153600 bytes).
> [ 7815.350000] uvcvideo: Dropping payload (error bit set).
> [ 7815.400000] uvcvideo: Frame complete (EOF found).
> [ 7815.400000] uvcvideo: EOF in empty payload.
> [ 7815.420000] uvcvideo: Dropping payload (error bit set).
> [ 7815.430000] uvcvideo: Dropping payload (error bit set).
> [ 7815.440000] uvcvideo: Dropping payload (error bit set).
> [ 7815.450000] uvcvideo: Dropping payload (error bit set).
> [ 7815.470000] uvcvideo: Dropping payload (error bit set).
> [ 7815.470000] uvcvideo: Dropping payload (error bit set).
> [ 7815.480000] uvcvideo: Dropping payload (error bit set).
> [ 7815.500000] uvcvideo: Dropping payload (error bit set).
> [ 7815.520000] uvcvideo: Dropping payload (error bit set).
> [ 7815.530000] uvcvideo: Dropping payload (error bit set).
> [ 7815.540000] uvcvideo: Dropping payload (error bit set).
> [ 7815.550000] uvcvideo: Dropping payload (error bit set).
> [ 7815.570000] uvcvideo: Dropping payload (error bit set).
> [ 7815.580000] uvcvideo: Dropping payload (error bit set).
> [ 7815.600000] uvcvideo: Dropping payload (error bit set).
> [ 7815.600000] uvcvideo: Dropping payload (error bit set).
> [ 7815.620000] uvcvideo: Dropping payload (error bit set).
> [ 7815.630000] uvcvideo: Dropping payload (error bit set).
> [ 7815.640000] uvcvideo: Dropping payload (error bit set).
> [ 7815.650000] uvcvideo: Dropping payload (error bit set).
> [ 7815.670000] uvcvideo: Dropping payload (error bit set).
> [ 7815.670000] uvcvideo: Dropping payload (error bit set).
> [ 7815.680000] uvcvideo: Dropping payload (error bit set).
> [ 7815.700000] uvcvideo: Dropping payload (error bit set).

I'm not sure what to do here. The camera sets the error bit in the payload. 
The data packet is dropped, and the image buffer should be dropped as well. I 
don't know why corrupted images are received by the userspace application. If 
the camera silently sends erroneous data there's not much I can do.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu May 29 23:09:03 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 29 May 2008 23:09:03 +0200
Subject: [Linux-uvc-devel] ioctl on a disconnected device
In-Reply-To: <1211620982.9791.21.camel@maestro>
References: <1211620982.9791.21.camel@maestro>
Message-ID: <200805292309.03581.laurent.pinchart@skynet.be>

Hi Pekka,

On Saturday 24 May 2008, Pekka Vuorela wrote:
> Hello,
>
> I debugged a bug[1] I was having with Motion and noticed that the UVC
> driver doesn't return an error when doing an ioctl() on a disconnected
> device. Wouldn't ENODEV be a sensible value to return in such
> situations?
>
> Anyway, this small patch adds a check in the beginning of
> uvc_v4l2_do_ioctl(). With the patch Motion works with me as it seems to
> work with the pwc driver.
>
> 1:
> http://www.lavrsen.dk/twiki/bin/view/Motion/BugReport2008x05x17x175521

Thanks for debugging the problem. I'm still not sure if all ioctls should 
return -ENODEV when the device gets disconnected. It might make sense to 
allow applications to retrieve the last few captured images for instance.

I'll think about this and I'll work on a patch in the next few days.

Best regards,

Laurent Pinchart


From dusanc at gmail.com  Fri May 30 01:08:29 2008
From: dusanc at gmail.com (Dushan Tcholich)
Date: Fri, 30 May 2008 01:08:29 +0200
Subject: [Linux-uvc-devel] MSI Starcam racer UVC webcam support
In-Reply-To: <200805291711.54105.laurent.pinchart@skynet.be>
References: <a08621850805280454x89276c7mf0c1628be89d295b@mail.gmail.com>
	<a08621850805280517j735fedddr531ef52ec518741f@mail.gmail.com>
	<200805291711.54105.laurent.pinchart@skynet.be>
Message-ID: <a08621850805291608h7d4012c7sefd1cf583cd5f351@mail.gmail.com>

On Thu, May 29, 2008 at 5:11 PM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
> Hi Dushan,
>

Hi Laurent
> On Wednesday 28 May 2008, Dushan Tcholich wrote:
>> Hi
>> I have a MSI starcam racer USB webcam that's not currently supported in
>> linux. Drivers for windows mention UVC support so as I couldn't find it on
>> the supported devices on linux-uvc web site I'd like to try to make it work
>> if I can.
>
> Even when not listed on the Linux UVC website, UVC-compatible cameras should
> work out of the box with the driver. Have you tried your camera yet ?
>
> If it doesn't work, please explain the steps you followed to test it, and
> report complete error messages along with uvcvideo-related kernel log
> messages.
>

I messed around a little with that webcam today and got it to work
with  linux-uvc 0.1.0_pre173 (version from gentoo portage).
It works with luvcview when I select YUV format.
When I try default (MJPEG afaik) it gives:
Unable to set format: 22
 Init v4L2 failed !! exit fatal

With YUV it works satisfactory for video (selfadjusting to light
conditions etc.). I haven't tried to use audio.
2 of them together saturate somehow 1 USB2.0 hub. I'll look into that
in a few days. Maybe I overlooked something :)

>> Some data can be found on MSI website:
>> http://global.msi.com.tw/index.php?func=proddesc&maincat_no=132&cat2_no=&ca
>>t3_no=&prod_no=1217 lsusb gives:
>> Bus 002 Device 004: ID 0c45:62e0 Microdia
>>
>> I opened it and found that it has this controller:
>> SN9C255
>> http://www.sonix.com.tw/sonix/product.do?p=SN9C255
>>
>> And it has MI1320 sensor.
>>
>> If you need any other info please cc me as I'm not subscribed.
>
> Could you please send me the output of
>
> lsusb -v -d 0c45:62e0
>
> using usbutils 0.72 or newer (0.73+ preferred) ?
>

Do you still need this info?

> Best regards,
>
> Laurent Pinchart
>

Thanks for the help

Dushan Tcholich


From brandon at ifup.org  Fri May 30 01:41:47 2008
From: brandon at ifup.org (Brandon Philips)
Date: Thu, 29 May 2008 16:41:47 -0700
Subject: [Linux-uvc-devel] [PATCH] uvc: release streaming interface to fix
	suspend to RAM
Message-ID: <20080529234147.GA2353@plankton.ifup.org>

Bug report: https://bugzilla.novell.com/show_bug.cgi?id=387876

If probe fails the UVC driver may still be bound to a streaming
interface.  This interface must be released with
usb_driver_release_interface() otherwise the interface will continue to
be bound causing suspend operations to fail.

Tested using this little hack:
> +++ uvc_video.c
> @@ -870,6 +870,8 @@ int uvc_video_init(st
>        if ((ret = uvc_get_video_ctrl(video, probe, 1, GET_DEF)) < 0 &&
>             (ret = uvc_get_video_ctrl(video, probe, 1, GET_CUR)) < 0)
>                 return ret;
> +
> +       return -EIO;
>  

Signed-off-by: Brandon Philips <bphilips at suse.de>

---
 uvc_driver.c |    4 ++++
 1 file changed, 4 insertions(+)

Index: uvc/uvc_driver.c
===================================================================
--- uvc.orig/uvc_driver.c
+++ uvc/uvc_driver.c
@@ -865,6 +865,8 @@ static int uvc_parse_standard_control(st
 
 			if (uvc_parse_streaming(dev, streaming) < 0) {
 				usb_put_intf(intf);
+				usb_driver_release_interface(&uvc_driver.driver,
+					intf);
 				kfree(streaming->format);
 				kfree(streaming->header.bmaControls);
 				kfree(streaming);
@@ -1524,6 +1526,8 @@ void uvc_delete(struct kref *kref)
 		struct uvc_streaming *streaming;
 		streaming = list_entry(p, struct uvc_streaming, list);
 		usb_put_intf(streaming->intf);
+		usb_driver_release_interface(&uvc_driver.driver,
+			streaming->intf);
 		kfree(streaming->format);
 		kfree(streaming->header.bmaControls);
 		kfree(streaming);


From elbaddy at gmail.com  Fri May 30 14:12:39 2008
From: elbaddy at gmail.com (Lorenzo Battistini)
Date: Fri, 30 May 2008 14:12:39 +0200
Subject: [Linux-uvc-devel] New device
In-Reply-To: <200805292117.30490.laurent.pinchart@skynet.be>
References: <3d7891440805190042n79a03257nf02b4a656e3bda60@mail.gmail.com>
	<200805230113.07808.laurent.pinchart@skynet.be>
	<3d7891440805261136m69035bceyedafc36efa066631@mail.gmail.com>
	<200805292117.30490.laurent.pinchart@skynet.be>
Message-ID: <3d7891440805300512o43d97bdcp2f104726aeda819a@mail.gmail.com>

Hi Laurent,

2008/5/29 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi Lorenzo,
>
> On Monday 26 May 2008, Lorenzo Battistini wrote:
>> Hi Laurent
>>
>> 2008/5/23 Laurent Pinchart <laurent.pinchart at skynet.be>:
>> > Hi Lorenzo,
>> >
>> > On Wednesday 21 May 2008, Lorenzo Battistini wrote:
>> >> Thanks Laurent,
>> >> tha patch permits to view video stream through luvcview.
>> >
>> > Thanks for the report.
>> >
>> >> But, for now, it's the only software that I was able to use.
>> >> For example, gqcam gives "Error reading image..." and a green screen;
>> >
>> > gqcam is old an unmaintained. It doesn't support V4L2.
>> >
>> >> skype gives
>> >>
>> >> Skype V4L2: Could not find a suitable capture format
>> >> Skype V4L2: Could not find a suitable capture format
>> >> Skype V4L2: Could not find a suitable capture format
>> >> Skype V4L2: Could not find a suitable capture format
>> >> Starting the process...
>> >> Skype Xv: Xv ports available: 1
>> >> Skype XShm: XShm support enabled
>> >> Skype Xv: Using Xv port 73
>> >> Skype Xv: No suitable overlay format found
>> >
>> > Your camera supports MJPEG only. Maybe Skype doesn't implement MJPEG
>> > decoding ?
>> >
>> >> and a black screen.
>> >>
>> >> Loading the patched driver, kernel says:
>> >>
>> >> uvcvideo: Found UVC 1.00 device USB Web Camera (1c4f:3000)
>> >> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : -32 (exp. 26).
>> >> input: USB Web Camera as
>> >> /devices/pci0000:00/0000:00:02.0/usb1/1-2/1-2:1.0/input/input7
>> >> usbcore: registered new interface driver uvcvideo
>> >> USB Video Class driver (SVN r209)
>> >
>> > If you're looking for a video conferencing application try Ekiga. It
>> > should work with the Linux UVC driver.
>>
>> But ekiga gives "Error while opening video device USB Web" (I didn't
>> find details).
>
> Could you please check the kernel log after Ekiga's failure and report any
> message printed by the driver ?

Sure. I didn't think of it.

uvcvideo: Failed to query (1) UVC control 1 (unit 4) : -110 (exp. 1).

>
>> Testing through gstreamer-properties:
>>
>> gstreamer-properties-Message: Error running pipeline 'Video for Linux
>> 2 (v4l2)': Failed getting controls attributes on device '/dev/video0.'
>> [v4l2_calls.c(243): gst_v4l2_fill_lists (): /pipeline0/v4l2src4:
>> Failed querying control 9963788 on device '/dev/video0'. (5 -
>> Input/output error)]
>

Best regards,

Lorenzo Battistini


From laurent.pinchart at skynet.be  Fri May 30 20:31:22 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 30 May 2008 20:31:22 +0200
Subject: [Linux-uvc-devel] MSI Starcam racer UVC webcam support
In-Reply-To: <a08621850805291608h7d4012c7sefd1cf583cd5f351@mail.gmail.com>
References: <a08621850805280454x89276c7mf0c1628be89d295b@mail.gmail.com>
	<200805291711.54105.laurent.pinchart@skynet.be>
	<a08621850805291608h7d4012c7sefd1cf583cd5f351@mail.gmail.com>
Message-ID: <200805302031.22746.laurent.pinchart@skynet.be>

Hi Dushan,

On Friday 30 May 2008, Dushan Tcholich wrote:
> On Thu, May 29, 2008 at 5:11 PM, Laurent Pinchart
>
> <laurent.pinchart at skynet.be> wrote:
> > Hi Dushan,
>
> Hi Laurent
>
> > On Wednesday 28 May 2008, Dushan Tcholich wrote:
> >> Hi
> >> I have a MSI starcam racer USB webcam that's not currently supported in
> >> linux. Drivers for windows mention UVC support so as I couldn't find it
> >> on the supported devices on linux-uvc web site I'd like to try to make
> >> it work if I can.
> >
> > Even when not listed on the Linux UVC website, UVC-compatible cameras
> > should work out of the box with the driver. Have you tried your camera
> > yet ?
> >
> > If it doesn't work, please explain the steps you followed to test it, and
> > report complete error messages along with uvcvideo-related kernel log
> > messages.
>
> I messed around a little with that webcam today and got it to work
> with  linux-uvc 0.1.0_pre173 (version from gentoo portage).
> It works with luvcview when I select YUV format.
> When I try default (MJPEG afaik) it gives:
> Unable to set format: 22
>  Init v4L2 failed !! exit fatal
>
> With YUV it works satisfactory for video (selfadjusting to light
> conditions etc.). I haven't tried to use audio.
> 2 of them together saturate somehow 1 USB2.0 hub. I'll look into that
> in a few days. Maybe I overlooked something :)
>
> >> Some data can be found on MSI website:
> >> http://global.msi.com.tw/index.php?func=proddesc&maincat_no=132&cat2_no=
> >>&ca t3_no=&prod_no=1217 lsusb gives:
> >> Bus 002 Device 004: ID 0c45:62e0 Microdia
> >>
> >> I opened it and found that it has this controller:
> >> SN9C255
> >> http://www.sonix.com.tw/sonix/product.do?p=SN9C255
> >>
> >> And it has MI1320 sensor.
> >>
> >> If you need any other info please cc me as I'm not subscribed.
> >
> > Could you please send me the output of
> >
> > lsusb -v -d 0c45:62e0
> >
> > using usbutils 0.72 or newer (0.73+ preferred) ?
>
> Do you still need this info?

Yes please. Then I'll add the model to the supported devices list on the 
website.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri May 30 20:34:14 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 30 May 2008 20:34:14 +0200
Subject: [Linux-uvc-devel] New Webcam
In-Reply-To: <200805292232.44807.dereck.sun@free.fr>
References: <200805292232.44807.dereck.sun@free.fr>
Message-ID: <200805302034.14213.laurent.pinchart@skynet.be>

Hi Tristan,

On Thursday 29 May 2008, Tristan RENAUD wrote:
> Hi,
>
> I have plugged my webcam to my Mandriva 2008.1 Linux PC, and it works fine
> with the uvcvideo driver. I test it with Kopete.
>
> Informations about that webcam :
> Device ID = 145f:013f
> Name = Trust Megapixel USB2 Auto Focus Webcam
> Manufacturer = Trust
>
> NOTE : lsusb don't display Name and Manufacturer. I don't know who to
> contact to add those informations...

Could you please send me the output of

lsusb -v -d 145f:013f

using usbutils 0.72 or newer (0.73+ preferred) ?

> NOTE 2 : mic works with the sound_usb_audio driver
>
> When looking at dmesg|grep uvc, I get some messages :
>
> uvcvideo: Found UVC 1.00 device USB 2.0 Camera (145f:013f)
> usbcore: registered new interface driver uvcvideo
> uvcvideo: Failed to query (1) UVC control 9 (unit 3) : -32 (exp. 2).
> uvcvideo: Failed to query (1) UVC control 9 (unit 3) : -32 (exp. 2).
>
> Don't know if this is important for you. I can do some tests if you need.
> Tell me what to do, I'll try it and report to you.

Those errors should not be fatal. Most webcams are only tested on Windows, and 
some are buggy when the USB requests timing differs from the test conditions.

> Hope that help to have a more user-friendly Linux !!

I hope so, otherwise I wouldn't be working on the UVC driver :-)

Best regards,

Laurent Pinchart


From dereck.sun at free.fr  Fri May 30 21:19:46 2008
From: dereck.sun at free.fr (Tristan RENAUD)
Date: Fri, 30 May 2008 21:19:46 +0200
Subject: [Linux-uvc-devel] New Webcam
In-Reply-To: <200805302034.14213.laurent.pinchart@skynet.be>
References: <200805292232.44807.dereck.sun@free.fr>
	<200805302034.14213.laurent.pinchart@skynet.be>
Message-ID: <200805302119.46888.dereck.sun@free.fr>

Hello Laurent,

Le Friday 30 May 2008 20:34:14, vous avez ?crit?:
> Hi Tristan,
>
> On Thursday 29 May 2008, Tristan RENAUD wrote:
> > Hi,
> >
> > I have plugged my webcam to my Mandriva 2008.1 Linux PC, and it works
> > fine with the uvcvideo driver. I test it with Kopete.
> >
> > Informations about that webcam :
> > Device ID = 145f:013f
> > Name = Trust Megapixel USB2 Auto Focus Webcam
> > Manufacturer = Trust
> >
> > NOTE : lsusb don't display Name and Manufacturer. I don't know who to
> > contact to add those informations...
>
> Could you please send me the output of
>
> lsusb -v -d 145f:013f
>
> using usbutils 0.72 or newer (0.73+ preferred) ?

The output is stored in the attached file.
Created using usbutils 0.73.

>
> > NOTE 2 : mic works with the sound_usb_audio driver
> >
> > When looking at dmesg|grep uvc, I get some messages :
> >
> > uvcvideo: Found UVC 1.00 device USB 2.0 Camera (145f:013f)
> > usbcore: registered new interface driver uvcvideo
> > uvcvideo: Failed to query (1) UVC control 9 (unit 3) : -32 (exp. 2).
> > uvcvideo: Failed to query (1) UVC control 9 (unit 3) : -32 (exp. 2).
> >
> > Don't know if this is important for you. I can do some tests if you need.
> > Tell me what to do, I'll try it and report to you.
>
> Those errors should not be fatal. Most webcams are only tested on Windows,
> and some are buggy when the USB requests timing differs from the test
> conditions.
>
> > Hope that help to have a more user-friendly Linux !!
>
> I hope so, otherwise I wouldn't be working on the UVC driver :-)

Thanks a lot for all the great work you've already done !


-- 
Tristan RENAUD
___________________________
Site Web  : http://cyberconnexion.hd.free.fr
JABBER ID : tristan at jabber.fr
 YAHOO ID : dereck_sun at yahoo
   MSN ID : dereck.sun at free.fr
   ICQ ID : 1196863
-------------- next part --------------

Bus 001 Device 004: ID 145f:013f  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x145f 
  idProduct          0x013f 
  bcdDevice            1.00
  iManufacturer           2 Sonix Technology Co., Ltd.
  iProduct                1 USB 2.0 Camera
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          616
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              168mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 USB Camera
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 USB Camera
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x7f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0x00
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000a0a
          Auto-Exposure Mode
          Exposure Time (Absolute)
          Zoom (Absolute)
          PanTilt (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000176f
          Brightness
          Contrast
          Hue
          Saturation
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      257
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                   614400
        dwMaxBitRate                 15360000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  1
        dwFrameInterval( 0)            400000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                    38400
        dwMaxBitRate                   960000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  1
        dwFrameInterval( 0)            400000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                    50688
        dwMaxBitRate                  1267200
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  1
        dwFrameInterval( 0)            400000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   153600
        dwMaxBitRate                  3840000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  1
        dwFrameInterval( 0)            400000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   202752
        dwMaxBitRate                  5068800
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  1
        dwFrameInterval( 0)            400000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                  2621440
        dwMaxBitRate                 19660800
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        352
        wHeight( 2)                       288
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       0 
      bFunctionProtocol       0 
      iFunction               4 USB Audio Device
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              4 USB Audio Device
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           41
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            2
        bmaControls( 0)      0x01
        bmaControls( 0)      0x00
          Mute
        bmaControls( 1)      0x02
        bmaControls( 1)      0x00
          Volume
        iFeature                0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                14
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            2 Discrete
        tSamFreq[ 0]         8000
        tSamFreq[ 1]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0190  1x 400 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled

From tmazzotta at titanmicro.com  Sat May 31 21:52:04 2008
From: tmazzotta at titanmicro.com (Tom Mazzotta)
Date: Sat, 31 May 2008 15:52:04 -0400
Subject: [Linux-uvc-devel] Logitech QuickCam Pro for Notebooks - NO Cheese
 (or Camorama for	that matter)
Message-ID: <1212263524.7617.44.camel@LTdevlUbnt>

?
        I am using the Logitech QuickCam Pro for Notebooks under (newly
        installed) Ubuntu 8.04LTS on an HP Compaq nc6220 laptop. This
        setup
        works "out of the box" just fine with Ekiga 2.0.12, Skype
        2.0.0.68, and
        luvcview 0.2.1. However, when I run Cheese 2.22.1, I only see
        the test
        pattern and "static video". When I run Camorama 0.19-2, I get an
        alert
        box saying:
        
                "Could not connect to video device (/dev/video0). Please
        check
                connection."
        
        FYI, I recently built/installed uvcvideo from svn source.
        
        I apologize in advance if this is more of an application issue
        than an
        issue w/ uvc (which apparently works like a champ using other
        apps
        running on the same system). I'm happy to provide any add'l info
        required.
        
        Also, this is the second camera I have tried with this laptop.
        Originally I tried using the Creative Live! Cam Notebook Ultra,
        with
        little advance research on Linux compatibility issues. Well I
        couldn't
        get it to work and stopped trying after finding a post within
        the last
        few months in the archives of this list saying that the camera
        is not
        uvc compliant. The only reason I mention this now is that I read
        on
        Wikipedia (http://en.wikipedia.org/wiki/USB_video_device_class):
        
                "It can be expected that in the near future most webcams
        will be
                UVC compatible as this is a logo requirement for Windows
        Vista."
        
        Well clear as day, there is a "CERTIFIED for Windows Vista" logo
        on the
        packing material of the Creative product. I don't know if the
        Wiki
        statement is erroneous or otherwise... just thought the
        subscribers of
        this list may be interested in this info.
        
        Any help with the Logitech would be greatly appreciated.
        
        Best,
        -tm
        
        



From barsnick at gmx.net  Sat May 31 22:48:16 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Sat, 31 May 2008 22:48:16 +0200
Subject: [Linux-uvc-devel] hp 2133 camera -  CNF7070
In-Reply-To: <200805292012.25476.laurent.pinchart@skynet.be>
References: <20080527174046.GA21509@plzk.de>
	<200805291719.26076.laurent.pinchart@skynet.be>
	<20080529172322.GA13435@plzk.de>
	<200805292012.25476.laurent.pinchart@skynet.be>
Message-ID: <20080531204816.GA13912@sunshine.barsnick.net>

On Thu, May 29, 2008 at 20:12:25 +0200, Laurent Pinchart wrote:

> mplayer had a bug which prevented if from working properly with the
> Linux UVC driver. The code is fixed in mplayer SVN but I'm not sure
> if they released a version including the fix.

Indeed, mplayer developers consider 1.0-rc1 too old to debug.

Using mplayer, you may _have_ to set the desired fps. That was my
experience, but mplayer will say so (among its many messages).

Moritz


From barsnick at gmx.net  Sat May 31 23:05:23 2008
From: barsnick at gmx.net (Moritz Barsnick)
Date: Sat, 31 May 2008 23:05:23 +0200
Subject: [Linux-uvc-devel] Logitech QuickCam Pro for Notebooks -
	NO	Cheese (or Camorama for that matter)
In-Reply-To: <1212263524.7617.44.camel@LTdevlUbnt>
References: <1212263524.7617.44.camel@LTdevlUbnt>
Message-ID: <20080531210523.GB13912@sunshine.barsnick.net>

Hi Tom,

On Sat, May 31, 2008 at 15:52:04 -0400, Tom Mazzotta wrote:

>         I am using the Logitech QuickCam Pro for Notebooks under
>         (newly installed) Ubuntu 8.04LTS on an HP Compaq nc6220
>         laptop. This setup works "out of the box" just fine with
>         Ekiga 2.0.12, Skype 2.0.0.68, and luvcview 0.2.1.

Luvcview is the reference application. So if your webcam works with
that, and even with Skype, I would say "it works".

>         However, when I run Cheese 2.22.1, I only see the test
>         pattern and "static video". When I run Camorama 0.19-2, I get
>         an alert box saying:
>         
>                 "Could not connect to video device (/dev/video0).
>                 Please check connection."

I think you may have to file a bug report with Cheese.
Camorama is known not to support V4L2.

OTOH, mplayer usually works, and I think so does wxCam (which has
rather peculiar requirements to build though).

>         Wikipedia (http://en.wikipedia.org/wiki/USB_video_device_class):
>         
>                 "It can be expected that in the near future most
>                 webcams will be UVC compatible as this is a logo
>                 requirement for Windows Vista."

We wish. I bet many devices will still behave totally crude though. ;-)

Moritz


From laurent.pinchart at skynet.be  Sat May 31 18:40:02 2008
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 31 May 2008 18:40:02 +0200
Subject: [Linux-uvc-devel] [PATCH] uvc: release streaming interface to
	fix suspend to RAM
In-Reply-To: <20080529234147.GA2353@plankton.ifup.org>
References: <20080529234147.GA2353@plankton.ifup.org>
Message-ID: <200805311840.03003.laurent.pinchart@skynet.be>

Hi Brandon,

On Friday 30 May 2008, Brandon Philips wrote:
> Bug report: https://bugzilla.novell.com/show_bug.cgi?id=387876
>
> If probe fails the UVC driver may still be bound to a streaming
> interface.  This interface must be released with
> usb_driver_release_interface() otherwise the interface will continue to
> be bound causing suspend operations to fail.

Thanks for the report.

> Tested using this little hack:
> > +++ uvc_video.c
> > @@ -870,6 +870,8 @@ int uvc_video_init(st
> >        if ((ret = uvc_get_video_ctrl(video, probe, 1, GET_DEF)) < 0 &&
> >             (ret = uvc_get_video_ctrl(video, probe, 1, GET_CUR)) < 0)
> >                 return ret;
> > +
> > +       return -EIO;
>
> Signed-off-by: Brandon Philips <bphilips at suse.de>
>
> ---
>  uvc_driver.c |    4 ++++
>  1 file changed, 4 insertions(+)
>
> Index: uvc/uvc_driver.c
> ===================================================================
> --- uvc.orig/uvc_driver.c
> +++ uvc/uvc_driver.c
> @@ -865,6 +865,8 @@ static int uvc_parse_standard_control(st
>
>  			if (uvc_parse_streaming(dev, streaming) < 0) {
>  				usb_put_intf(intf);
> +				usb_driver_release_interface(&uvc_driver.driver,
> +					intf);
>  				kfree(streaming->format);
>  				kfree(streaming->header.bmaControls);
>  				kfree(streaming);
> @@ -1524,6 +1526,8 @@ void uvc_delete(struct kref *kref)
>  		struct uvc_streaming *streaming;
>  		streaming = list_entry(p, struct uvc_streaming, list);
>  		usb_put_intf(streaming->intf);
> +		usb_driver_release_interface(&uvc_driver.driver,
> +			streaming->intf);
>  		kfree(streaming->format);
>  		kfree(streaming->header.bmaControls);
>  		kfree(streaming);

Shouldn't usb_driver_release_interface be called before usb_put_intf ? It 
looks like the interface can be freed by usb_put_intf otherwise.

You are also missing an error path (kzalloc returning NULL right after 
claiming the interface). Here is a modified version of your patch that cleans 
up the driver code a little as well. It works fine here, could you please 
test it ? 

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: release-intf.patch
Type: text/x-diff
Size: 5757 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20080531/4a621b0c/attachment.patch>

