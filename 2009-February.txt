From jan.ciger at gmail.com  Sun Feb  1 21:32:41 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Sun, 01 Feb 2009 21:32:41 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
Message-ID: <498606E9.2060808@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello,

I have also got the Minoru stereo webcam, the same as described by Yann
on 31.1. and with the same problem (unable to stream from both cameras
at once), regardless of which USB port is used. It doesn't work even if
the camera is attached to a separate USB controller with nothing else on it.

The webcam contains actually two Vimicro cameras connected to an
internal USB hub, together with a USB microphone. In Windows on the same
machine it works OK, albeit a bit slow (framerate throttling?).

I have tried to reduce the framerate (only 30 and 15fps are supported)
and all resolutions besides the 640x480 maximum (the Windows driver
claims 800x600, but that looks interpolated) and still the second camera
will not stream if the first one is already doing so.

Is there a way to get two UVC cameras to stream at the same time?

Regards,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJhgbnn11XseNj94gRAnbmAKCCZ7bQs17hK7w+0TU9TKQnoUXtRACg3LeM
tDpg1CdD3YX9sAWQJFczvmw=
=8wul
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Sun Feb  1 22:52:12 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 1 Feb 2009 22:52:12 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200901311727.33749.yann@lecun.org>
References: <200901311727.33749.yann@lecun.org>
Message-ID: <200902012252.12834.laurent.pinchart@skynet.be>

Hi Yann,

On Saturday 31 January 2009, Yann LeCun wrote:
> Laurent and all,
>
> I just got one of those new Minoru stereo webcams.  At 90 bucks from
> Amazon, the Minoru is several times cheaper than any alternative, and
> there are lots of cool things you could do with a stereo camera under
> Linux (see http://www.minoru3d.com/ ).
>
> The good news is that uvcvideo recognizes the stereo camera as two
> separate cameras (which appear as /dev/video0 and /dev/video1 in my
> laptop with Ubuntu 8.10). I can grab video from the left and right
> camera separately with no problem.  I'm using the standard uvcvideo
> driver that comes with Ubuntu 8.10 Intrepid.
>
> The problem is that I cannot seem to be able to grab from both cameras
> simultaneously.  If I turn on streaming on one camera, the second
> camera refuses to turn on streaming. In other words "
> ioctl(fd, VIDIOC_STREAMON, &type)" with
> "type = V4L2_BUF_TYPE_VIDEO_CAPTURE" fails (it returns -2).
>
> dmesg says:
> uvcvideo: Failed to submit URB 0 (-28).
>
> Similarly, if I have luvcview running on one camera and I try to start
> luvcview on the other camera, I get the error message:
> "Unable to start capture: No space left on device"
>
> I suspect this is a problem with the USB bus bandwidth.

That's right. The webcams request more bandwidth than the USB can allocate (or 
the driver mistakenly believes so).

> The problem with luvcview occurs even if I reduce the
> resolution to 160x120 with "luvcview -d /dev/video0 -s 160x120"
>
> Is there an easy fix? A difficult fix?

Could you please apply the attached patch ? It adds a print statement to log 
the requested bandwidth when starting the video stream. Please check the 
kernel log (using dmesg) after starting luvcview in various resolutions and 
report the requested bandwidths.

Best regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bandwidth.patch
Type: text/x-diff
Size: 507 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090201/d0f5f075/attachment.patch>

From jan.ciger at gmail.com  Mon Feb  2 00:35:12 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 02 Feb 2009 00:35:12 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902012252.12834.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org>
	<200902012252.12834.laurent.pinchart@skynet.be>
Message-ID: <498631B0.7010209@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Laurent,

I have applied your patch and here are the data:

- - luvcview -s 640x480 -i 30 -d /dev/video0
uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.

- - luvcview -s 320x240 -i 30 -d /dev/video0
uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.

- - luvcview -s 176x144 -i 30 -d /dev/video0
uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.

- - luvcview -s 160x120 -i 30 -d /dev/video0
uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.

It makes no difference whether I am asking for 30 or 15fps neither -
always 3072 bytes are requested.

Regards,

Jan


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJhjGun11XseNj94gRAqdFAKCKcWQ6tQO3ndMMYD6oAohNSdM0NQCgi6zv
mG8ior07wtd6eRenWtKX2L0=
=0NcE
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Mon Feb  2 18:51:34 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 2 Feb 2009 18:51:34 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <498631B0.7010209@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902012252.12834.laurent.pinchart@skynet.be>
	<498631B0.7010209@gmail.com>
Message-ID: <200902021851.34732.laurent.pinchart@skynet.be>

On Monday 02 February 2009, Jan Ciger wrote:
> Hi Laurent,
>
> I have applied your patch and here are the data:
>
> - luvcview -s 640x480 -i 30 -d /dev/video0
> uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.
>
> - luvcview -s 320x240 -i 30 -d /dev/video0
> uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.
>
> - luvcview -s 176x144 -i 30 -d /dev/video0
> uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.
>
> - luvcview -s 160x120 -i 30 -d /dev/video0
> uvcvideo: device Vimicro USB2.0 PC Camera requested 3072 bytes per payload.
>
> It makes no difference whether I am asking for 30 or 15fps neither -
> always 3072 bytes are requested.

That's bad. The USB EHCI driver will reject 2x 3072 bytes per microframe as 
exceeding the available bandwidth.

I suppose you'll object that the cameras work on Windows, so I'll try to 
address that :-)

I see three possible reasons why Windows would stream video from both cameras 
at the same time.

- The Windows UVC driver might query the cameras slightly differently and 
receive a different bandwidth. A USB sniffer would help confirm or infirm 
this explanation.

- The Windows UVC driver might ignore the requested bandwidth and compute a 
value itself.

- Windows might accept 2x 3072 bytes per microframe. I seem to remember this 
might be the case, and that that behaviour is buggy according to the USB 2.0 
spec. You would have to contact the linux-usb mailing list for more 
information on that.

It would be helpful if you could capture all USB control traffic from device 
enumeration to video streaming using a USB analyser (a software one will do). 
It would show what bandwidth the device requests, and what bandwidth the 
Windows UVC driver selects.

Best regards,

Laurent Pinchart


From jan.ciger at gmail.com  Mon Feb  2 19:38:57 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 02 Feb 2009 19:38:57 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902021851.34732.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org>
	<200902012252.12834.laurent.pinchart@skynet.be>
	<498631B0.7010209@gmail.com>
	<200902021851.34732.laurent.pinchart@skynet.be>
Message-ID: <49873DC1.7010802@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Laurent Pinchart wrote:
> That's bad. The USB EHCI driver will reject 2x 3072 bytes per microframe as 
> exceeding the available bandwidth.

Yep, I suspected something like that ...

> I suppose you'll object that the cameras work on Windows, so I'll try to 
> address that :-)

Thank you :)

> 
> I see three possible reasons why Windows would stream video from both cameras 
> at the same time.
> 
> - The Windows UVC driver might query the cameras slightly differently and 
> receive a different bandwidth. A USB sniffer would help confirm or infirm 
> this explanation.

I can check this if I manage to get a sniffer to work. I will report
back once that far.

> 
> - The Windows UVC driver might ignore the requested bandwidth and compute a 
> value itself.
> 
> - Windows might accept 2x 3072 bytes per microframe. I seem to remember this 
> might be the case, and that that behaviour is buggy according to the USB 2.0 
> spec. You would have to contact the linux-usb mailing list for more 
> information on that.

Hard to say which one is correct. It could be even both - Windows
accepts the value (doesn't report error) and the driver does some kind
of black magic afterwards to get things actually working.

I am getting different resolutions offered on Windows than on Linux and
also the camera seems to run at a lower framerate if both cameras are
streaming. I didn't try to measure it, but the stereo output looks like
~10fps or so. It could be a software issue as well, though.

The documentation is also cautioning to plug the device ideally to a
separate host and not to use the USB connectors on the front panel -
they assume that those are not full-featured. So it could be indeed a
marginal design.

> It would be helpful if you could capture all USB control traffic from device 
> enumeration to video streaming using a USB analyser (a software one will do). 
> It would show what bandwidth the device requests, and what bandwidth the 
> Windows UVC driver selects.

As I said above, I will try to get a sniffer working and will report
back once that far.

Regards (and thanks),

Jan

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJhz2+n11XseNj94gRAlm+AKDOTMtUwPvAFW4sqLmLc+DhGzcXvgCeIuJP
/Pq16p2jarKlLMQdVtCJmbI=
=NsvL
-----END PGP SIGNATURE-----


From sioux1977 at gmail.com  Tue Feb  3 01:07:56 2009
From: sioux1977 at gmail.com (Simone Freddio)
Date: Tue, 03 Feb 2009 01:07:56 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49873DC1.7010802@gmail.com>
References: <200901311727.33749.yann@lecun.org>	<200902012252.12834.laurent.pinchart@skynet.be>	<498631B0.7010209@gmail.com>	<200902021851.34732.laurent.pinchart@skynet.be>
	<49873DC1.7010802@gmail.com>
Message-ID: <49878ADC.7080901@gmail.com>

Hi Jan, hi Laurent...

    i have the same problem with different webcam... i think to have 
found the problem, Laurent tell me if i am wrong, i'll go to explain:

    The problem is in the bandwidth, the uvcdriver ALWAYS ask to usb 
layer a dw_MaxPayloadTransferSize that is fetched only when the device 
is opening;

    In my case is always set to 3072 (3x1024). I have tried changing 
uvc_video.c in a very dirty manner (excuse me Laurent) in this way:

    In function 'uvc_set_video_ctrl' where there is:
     put_unaligned_le32(ctrl->dwMaxVideoFrameSize, &data[18]);
     put_unaligned_le32(ctrl->dwMaxPayloadTransferSize, &data[22]);
    
    i have commented out the second line and changed it in:
    put_unaligned_le32(1024, &data[22]);

    In this way i have always force uvc driver to ask for a payload size 
of 1024.

    After recompiling, reinstalling, unload e load the module, i can get 
two webcam working fine and simultaneously.

    Now i didn't have a big experience and i can't change source myself 
in the right way... but i think that my observation can be usefull.

    I think that the best way to re-negotiate the bandwidth is to set 
video streaming parameters (framesize and frameinterval) and after ask 
the device wich bandwidth it requests.
    In a short way, at the end of uvc_set_video_ctrl function a call to 
uvc_get_video_ctrl will solve the problem... what do you think Laurent?)

BR Simone

P.S.: Excuse me for my english....

Jan Ciger wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Laurent Pinchart wrote:
>   
>> That's bad. The USB EHCI driver will reject 2x 3072 bytes per microframe as 
>> exceeding the available bandwidth.
>>     
>
> Yep, I suspected something like that ...
>
>   
>> I suppose you'll object that the cameras work on Windows, so I'll try to 
>> address that :-)
>>     
>
> Thank you :)
>
>   
>> I see three possible reasons why Windows would stream video from both cameras 
>> at the same time.
>>
>> - The Windows UVC driver might query the cameras slightly differently and 
>> receive a different bandwidth. A USB sniffer would help confirm or infirm 
>> this explanation.
>>     
>
> I can check this if I manage to get a sniffer to work. I will report
> back once that far.
>
>   
>> - The Windows UVC driver might ignore the requested bandwidth and compute a 
>> value itself.
>>
>> - Windows might accept 2x 3072 bytes per microframe. I seem to remember this 
>> might be the case, and that that behaviour is buggy according to the USB 2.0 
>> spec. You would have to contact the linux-usb mailing list for more 
>> information on that.
>>     
>
> Hard to say which one is correct. It could be even both - Windows
> accepts the value (doesn't report error) and the driver does some kind
> of black magic afterwards to get things actually working.
>
> I am getting different resolutions offered on Windows than on Linux and
> also the camera seems to run at a lower framerate if both cameras are
> streaming. I didn't try to measure it, but the stereo output looks like
> ~10fps or so. It could be a software issue as well, though.
>
> The documentation is also cautioning to plug the device ideally to a
> separate host and not to use the USB connectors on the front panel -
> they assume that those are not full-featured. So it could be indeed a
> marginal design.
>
>   
>> It would be helpful if you could capture all USB control traffic from device 
>> enumeration to video streaming using a USB analyser (a software one will do). 
>> It would show what bandwidth the device requests, and what bandwidth the 
>> Windows UVC driver selects.
>>     
>
> As I said above, I will try to get a sniffer working and will report
> back once that far.
>
> Regards (and thanks),
>
> Jan
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.9 (GNU/Linux)
> Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org
>
> iD8DBQFJhz2+n11XseNj94gRAlm+AKDOTMtUwPvAFW4sqLmLc+DhGzcXvgCeIuJP
> /Pq16p2jarKlLMQdVtCJmbI=
> =NsvL
> -----END PGP SIGNATURE-----
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>   



From laurent.pinchart at skynet.be  Tue Feb  3 01:23:01 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 3 Feb 2009 01:23:01 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49878ADC.7080901@gmail.com>
References: <200901311727.33749.yann@lecun.org> <49873DC1.7010802@gmail.com>
	<49878ADC.7080901@gmail.com>
Message-ID: <200902030123.01803.laurent.pinchart@skynet.be>

Hi Simone,

On Tuesday 03 February 2009, Simone Freddio wrote:
> Hi Jan, hi Laurent...
>
>     i have the same problem with different webcam... i think to have
> found the problem, Laurent tell me if i am wrong, i'll go to explain:
>
>     The problem is in the bandwidth, the uvcdriver ALWAYS ask to usb
> layer a dw_MaxPayloadTransferSize that is fetched only when the device
> is opening;
>
>     In my case is always set to 3072 (3x1024). I have tried changing
> uvc_video.c in a very dirty manner (excuse me Laurent)

Don't worry :-)

> in this way: 
>
>     In function 'uvc_set_video_ctrl' where there is:
>      put_unaligned_le32(ctrl->dwMaxVideoFrameSize, &data[18]);
>      put_unaligned_le32(ctrl->dwMaxPayloadTransferSize, &data[22]);
>
>     i have commented out the second line and changed it in:
>     put_unaligned_le32(1024, &data[22]);
>
>     In this way i have always force uvc driver to ask for a payload size
> of 1024.

According to the UVC 1.1 specification, the dwMaxPayloadTransferSize is set by 
the device and read only from the host. The value set by the host shouldn't 
matter.

>     After recompiling, reinstalling, unload e load the module, i can get
> two webcam working fine and simultaneously.
>
>     Now i didn't have a big experience and i can't change source myself
> in the right way... but i think that my observation can be usefull.

It is, thanks.

>     I think that the best way to re-negotiate the bandwidth is to set
> video streaming parameters (framesize and frameinterval) and after ask
> the device wich bandwidth it requests.

That's exactly what the driver does. In uvc_probe_video, each SET_CUR request 
is followed by a GET_CUR to retrieve the bandwidth requested by the camera.

>     In a short way, at the end of uvc_set_video_ctrl function a call to
> uvc_get_video_ctrl will solve the problem... what do you think Laurent?)

This is already handled by uvc_probe_video. From your report it seems that the 
device doesn't touch the dwMaxPayloadTransferSize at all and just returns the 
value sets by the host.

Could you (or Jan) try to set dwMaxPayloadTransferSize to a weird value (let's 
say 42) and see what the device returns in the next GET_CUR call ?

Best regards,

Laurent Pinchart


From jan.ciger at gmail.com  Tue Feb  3 10:22:32 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Tue, 03 Feb 2009 10:22:32 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902030123.01803.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org> <49873DC1.7010802@gmail.com>
	<49878ADC.7080901@gmail.com>
	<200902030123.01803.laurent.pinchart@skynet.be>
Message-ID: <49880CD8.7040805@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Laurent Pinchart wrote:

> Could you (or Jan) try to set dwMaxPayloadTransferSize to a weird
> value (let's say 42) and see what the device returns in the next
> GET_CUR call ?

I can give this a shot later today and will report back.

Jan

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJiAzYn11XseNj94gRAjwdAKCDQSQZg7roZ/yd+fdupmHXEfrwRACg3Q9c
+HFiZEpU/q2XzpbRWXcOKtQ=
=MkLd
-----END PGP SIGNATURE-----


From sioux1977 at gmail.com  Tue Feb  3 10:32:22 2009
From: sioux1977 at gmail.com (Simone Freddio)
Date: Tue, 03 Feb 2009 10:32:22 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902030123.01803.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org> <49873DC1.7010802@gmail.com>
	<49878ADC.7080901@gmail.com>
	<200902030123.01803.laurent.pinchart@skynet.be>
Message-ID: <49880F26.1070005@gmail.com>

Hi Laurent,

    here the results of my tests:

    MaxPayloadTransferSize        Value Returned from device            
Result
    0                                            128                    
                              uvcvideo: USB isochronous frame lost (-71).
    1                                            128                    
                              uvcvideo: USB isochronous frame lost (-71).
    42                                          128                    
                              uvcvideo: USB isochronous frame lost (-71).
    1024                                      1024                     
                           works right with few USB iso frame lost
    0xFFFF                                   3072                        
                       no error but also no capture :-(

    My conclusion is that MaxPayloadTransferSize, regardless of 
specification, is not readonly... seems to be that device round this 
value to the closest that is supported (see also my lsusb in file 
lsusb.txt).

    I think that the right bandwidth allocation must be calculated in 
the driver and set up in the device (the same you have done for 
frameinterval value :-).

BR Simone.

Laurent Pinchart wrote:
> Hi Simone,
>
> On Tuesday 03 February 2009, Simone Freddio wrote:
>   
>> Hi Jan, hi Laurent...
>>
>>     i have the same problem with different webcam... i think to have
>> found the problem, Laurent tell me if i am wrong, i'll go to explain:
>>
>>     The problem is in the bandwidth, the uvcdriver ALWAYS ask to usb
>> layer a dw_MaxPayloadTransferSize that is fetched only when the device
>> is opening;
>>
>>     In my case is always set to 3072 (3x1024). I have tried changing
>> uvc_video.c in a very dirty manner (excuse me Laurent)
>>     
>
> Don't worry :-)
>
>   
>> in this way: 
>>
>>     In function 'uvc_set_video_ctrl' where there is:
>>      put_unaligned_le32(ctrl->dwMaxVideoFrameSize, &data[18]);
>>      put_unaligned_le32(ctrl->dwMaxPayloadTransferSize, &data[22]);
>>
>>     i have commented out the second line and changed it in:
>>     put_unaligned_le32(1024, &data[22]);
>>
>>     In this way i have always force uvc driver to ask for a payload size
>> of 1024.
>>     
>
> According to the UVC 1.1 specification, the dwMaxPayloadTransferSize is set by 
> the device and read only from the host. The value set by the host shouldn't 
> matter.
>
>   
>>     After recompiling, reinstalling, unload e load the module, i can get
>> two webcam working fine and simultaneously.
>>
>>     Now i didn't have a big experience and i can't change source myself
>> in the right way... but i think that my observation can be usefull.
>>     
>
> It is, thanks.
>
>   
>>     I think that the best way to re-negotiate the bandwidth is to set
>> video streaming parameters (framesize and frameinterval) and after ask
>> the device wich bandwidth it requests.
>>     
>
> That's exactly what the driver does. In uvc_probe_video, each SET_CUR request 
> is followed by a GET_CUR to retrieve the bandwidth requested by the camera.
>
>   
>>     In a short way, at the end of uvc_set_video_ctrl function a call to
>> uvc_get_video_ctrl will solve the problem... what do you think Laurent?)
>>     
>
> This is already handled by uvc_probe_video. From your report it seems that the 
> device doesn't touch the dwMaxPayloadTransferSize at all and just returns the 
> value sets by the host.
>
> Could you (or Jan) try to set dwMaxPayloadTransferSize to a weird value (let's 
> say 42) and see what the device returns in the next GET_CUR call ?
>
> Best regards,
>
> Laurent Pinchart
>
>   

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lsusb.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090203/1d52a89c/attachment.txt>

From ruena at web.de  Tue Feb  3 16:28:12 2009
From: ruena at web.de (Jens Gottstein)
Date: Tue, 03 Feb 2009 16:28:12 +0100
Subject: [Linux-uvc-devel] <kein Betreff>
Message-ID: <722292328@web.de>

Hi all,

I am using Ubuntu 8.10 and a Crative VF0540 Webcam. Which identifies 
isself as:

$ dmesg
[26238.642082] uvcvideo: Found UVC 1.00 device Vimicro USB 2.0 PC Camera 
(Venus) (0ac8:3420)
[26238.642675] uvcvideo: No valid video chain found.

The problem is:  uvcvideo: No valid video chain found.

The funny thing is, It worked before (about a month ago.) But back than 
I did not investigate anything - it just worked. Now it does not work 
anymore. I constantly updated my Ubuntu. Booting an old kernel did not 
do it. On a other Ubuntu 8.10 which is almost the same it doesn't work 
either.

Funny is also that 0ac8:3420 is listed as working on 
http://linux-uvc.berlios.de/.


I downloaded the latest uvcvideo-f5c337ded781.tar.gz from 02. Feb 2009, 
compiled is and run it (see listings below). No help.

I got no Idea any more, I would appreciate any help.

I look forward to your answers.


ruena




$modinfo uvcvideo
filename: 
/lib/modules/2.6.27-11-generic/kernel/drivers/media/video/uvc/uvcvideo.ko
version:        v0.1.0
license:        GPL
description:    USB Video Class driver
author:         Laurent Pinchart <laurent.pinchart at skynet.be>
srcversion:     413A0ECBDFDB0F4525A35E3
alias:          usb:v*p*d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v1C4Fp3000d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v19ABp1000d00*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v19ABp1000d01[0-1]*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v19ABp1000d012[0-6]dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v18CDpCAFEd*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v17EFp480Bd*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v174Fp8A33d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v174Fp8A31d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v174Fp5931d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v174Fp5212d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v0E8Dp0004d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v05E3p0505d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v05ACp8501d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v058Fp3820d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v046Dp08C7d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C6d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C5d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C3d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C2d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v046Dp08C1d*dc*dsc*dp*icFFisc01ip00*
alias:          usb:v045Ep0723d*dc*dsc*dp*ic0Eisc01ip00*
alias:          usb:v045Ep00F8d*dc*dsc*dp*ic0Eisc01ip00*
depends:        usbcore,videodev,v4l1-compat
vermagic:       2.6.27-11-generic SMP mod_unload modversions 586
parm:           nodrop:Don't drop incomplete frames (uint)
parm:           quirks:Forced device quirks (uint)
parm:           trace:Trace level bitmask (uint)



$ ls -l 
/lib/modules/2.6.27-11-generic/kernel/drivers/media/video/uvc/uvcvideo.ko
-rw-r--r-- 1 root root 83156 2009-02-02 23:07 
/lib/modules/2.6.27-11-generic/kernel/drivers/media/video/uvc/uvcvideo.ko


$ uname -a
Linux core 2.6.27-11-generic #1 SMP Thu Jan 29 19:24:39 UTC 2009 i686 
GNU/Linux


$ sudo lsusb -vv -d 0ac8:3420
Bus 004 Device 016: ID 0ac8:3420 Z-Star Microelectronics Corp.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0ac8 Z-Star Microelectronics Corp.
  idProduct          0x3420
  bcdDevice           83.14
  iManufacturer           1 Vimicro
  iProduct                2 Vimicro USB 2.0 PC Camera (Venus)
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          252
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              256mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               2 Vimicro USB 2.0 PC Camera (Venus)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              2 Vimicro USB 2.0 PC Camera (Venus)
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           79
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x00000000
        iProcessing             0
        bmVideoStandards     0x 9
          None
          SECAM - 625/50
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                28
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {5bef79f6-df54-fc4b-b8cb-ca7e89a5233f}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          1
        bControlSize            3
        bmControls( 0)       0xff
        bmControls( 1)       0x01
        bmControls( 2)       0x80
        iExtension              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x000a  1x 10 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                       14
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                     0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b00  2x 768 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


$ lsmod
Module                  Size  Used by 
uvcvideo               66188  0 
videodev               49152  1 uvcvideo 
v4l1_compat            21892  2 uvcvideo,videodev 
binfmt_misc            16904  1 
rfcomm                 44432  0 
sco                    18308  2 
bridge                 56980  0 
stp                    10628  1 bridge 
bnep                   20480  2 
l2cap                  30464  6 rfcomm,bnep 
bluetooth              61924  6 rfcomm,sco,bnep,l2cap 
vboxdrv                71576  0 
ppdev                  15620  0 
acpi_cpufreq           15500  1 
cpufreq_ondemand       14988  1 
cpufreq_userspace      11396  0 
cpufreq_stats          13188  0 
freq_table             12672  3 
acpi_cpufreq,cpufreq_ondemand,cpufreq_stats
cpufreq_powersave       9856  0 
cpufreq_conservative    14600  0 
container              11520  0 
sbs                    19464  0 
sbshc                  13440  1 sbs 
video                  25232  0 
output                 11008  1 video 
wmi                    14504  0 
pci_slot               12680  0 
battery                18436  0 
ipv6                  263972  18 
nfs                   269544  2 
lockd                  71976  1 nfs 
nfs_acl                11264  1 nfs 
sunrpc                197088  11 nfs,lockd,nfs_acl 
af_packet              25728  2 
iptable_filter         10752  0 
ip_tables              19600  1 iptable_filter 
x_tables               22916  1 ip_tables 
nls_iso8859_1          12032  3 
nls_cp437              13696  3 
vfat                   18816  3 
fat                    57376  1 vfat 
ac                     12292  0 
coretemp               14080  0 
w83627ehf              27144  0 
hwmon_vid              11264  1 w83627ehf 
sbp2                   29324  0 
parport_pc             39204  0 
lp                     17156  0 
parport                42604  3 ppdev,parport_pc,lp 
dvb_pll                17160  1 
pcspkr                 10624  0 
mt2060                 13060  0 
snd_hda_intel         384176  3 
dvb_usb_nova_t_usb2    13572  0 
dvb_usb_dibusb_common    17028  1 dvb_usb_nova_t_usb2 
dib3000mc              20616  2 dvb_usb_dibusb_common 
dibx000_common         11652  1 dib3000mc 
evdev                  17696  8
snd_pcm_oss            46848  0
dvb_usb                27660  2 dvb_usb_nova_t_usb2,dvb_usb_dibusb_common
dvb_core               94208  1 dvb_usb
snd_mixer_oss          22784  1 snd_pcm_oss
snd_pcm                83204  2 snd_hda_intel,snd_pcm_oss
iTCO_wdt               18596  0
snd_seq_dummy          10884  0
usblp                  20480  0
iTCO_vendor_support    11652  1 iTCO_wdt
nvidia               6909268  26
snd_seq_oss            38528  0
snd_seq_midi           14336  0
snd_rawmidi            29824  1 snd_seq_midi
i2c_core               31892  6 
dvb_pll,mt2060,dib3000mc,dibx000_common,dvb_usb,nvidia
snd_seq_midi_event     15232  2 snd_seq_oss,snd_seq_midi
snd_seq                57776  6 
snd_seq_dummy,snd_seq_oss,snd_seq_midi,snd_seq_midi_event
snd_timer              29960  2 snd_pcm,snd_seq
snd_seq_device         15116  5 
snd_seq_dummy,snd_seq_oss,snd_seq_midi,snd_rawmidi,snd_seq
snd                    63268  15 
snd_hda_intel,snd_pcm_oss,snd_mixer_oss,snd_pcm,snd_seq_oss,snd_rawmidi,snd_seq,snd_timer,snd_seq_device
intel_agp              33724  0
agpgart                42184  2 nvidia,intel_agp
button                 14224  0
soundcore              15328  1 snd
snd_page_alloc         16136  2 snd_hda_intel,snd_pcm
shpchp                 38036  0
pci_hotplug            34976  1 shpchp
ext3                  133256  1
jbd                    55828  1 ext3
mbcache                16004  1 ext3
sr_mod                 22212  0
cdrom                  43168  1 sr_mod
sd_mod                 42392  8
crc_t10dif              9984  1 sd_mod
pata_jmicron           11136  0
usbhid                 35840  0
hid                    50560  1 usbhid
usb_storage            82752  2
libusual               30356  1 usb_storage
sg                     39732  0
pata_acpi              12160  0
ata_piix               24580  3
ohci1394               37936  0
ahci                   37132  0
ieee1394               96324  2 sbp2,ohci1394
atl1                   40968  0
mii                    13440  1 atl1
ata_generic            12932  0
libata                178208  5 
pata_jmicron,pata_acpi,ata_piix,ahci,ata_generic
scsi_mod              155212  6 sbp2,sr_mod,sd_mod,usb_storage,sg,libata
dock                   16656  1 libata
ehci_hcd               43788  0
uhci_hcd               30736  0
usbcore               149360  10 
uvcvideo,dvb_usb_nova_t_usb2,dvb_usb,usblp,usbhid,usb_storage,libusual,ehci_hcd,uhci_hcd
thermal                23708  0
processor              42156  2 acpi_cpufreq,thermal
fan                    12548  0
fbcon                  47648  0
tileblit               10880  1 fbcon
font                   16512  1 fbcon
bitblit                13824  1 fbcon
softcursor              9984  1 bitblit
fuse                   60828  5


____________________________________________________________________
Psssst! Schon vom neuen WEB.DE MultiMessenger geh?rt? 
Der kann`s mit allen: http://www.produkte.web.de/messenger/?did=3123



From jan.ciger at gmail.com  Wed Feb  4 00:17:42 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Wed, 04 Feb 2009 00:17:42 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49880F26.1070005@gmail.com>
References: <200901311727.33749.yann@lecun.org> <49873DC1.7010802@gmail.com>
	<49878ADC.7080901@gmail.com>
	<200902030123.01803.laurent.pinchart@skynet.be>
	<49880F26.1070005@gmail.com>
Message-ID: <4988D096.7090208@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Simone Freddio wrote:
> Hi Laurent,
> 
>    here the results of my tests:
> 
>    MaxPayloadTransferSize        Value Returned from device           
> Result
>    0                                            128                   
>                              uvcvideo: USB isochronous frame lost (-71).
>    1                                            128                   
>                              uvcvideo: USB isochronous frame lost (-71).
>    42                                          128                   
>                              uvcvideo: USB isochronous frame lost (-71).
>    1024                                      1024                    
>                           works right with few USB iso frame lost
>    0xFFFF                                   3072                       
>                       no error but also no capture :-(
> 
>    My conclusion is that MaxPayloadTransferSize, regardless of
> specification, is not readonly... seems to be that device round this
> value to the closest that is supported (see also my lsusb in file
> lsusb.txt).

I have tried this too and regardless what I put as the
PayloadTransferSize, the Minoru camera will always ask for 3072 back.

Jan


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJiNCUn11XseNj94gRAg/gAJ0dORAwgwUJ0EYqA9O0vG0XgBtGDgCdHXCx
0igBKNMX3tSawbs0+L4hz/M=
=ok3d
-----END PGP SIGNATURE-----


From barrow_dj at yahoo.com  Wed Feb  4 18:01:21 2009
From: barrow_dj at yahoo.com (D.J. Barrow)
Date: Wed, 4 Feb 2009 09:01:21 -0800 (PST)
Subject: [Linux-uvc-devel] Hercules HD Dualpix webcam doesn't appear to be
	supported.
Message-ID: <342575.6674.qm@web51106.mail.re2.yahoo.com>

Hi all,
Let me know if it is.
Relevant details from dmesg.
usb 2-1: New USB device found, idVendor=06f8, idProduct=3003
usb 2-1: New USB device strings: Mfr=1, Product=2, SerialNumber=0
usb 2-1: Product: Hercules Dualpix HD Microphone
usb 2-1: Manufacturer: Hercules Dualpix HD Webcam
ALSA sound/usb/usbaudio.c:1298: 6:2:1: cannot get freq at ep 0x84

I looked in the sources for USB descriptors i.e. 06f8,3003
I can't find them anywhere where are they or is the endianness
switched or something.

D.J. Barrow Linux kernel developer
email: dj_barrow at ariasoft.ie
Mobile Ireland: +353-86-1715438
Mobile Belgium  +32-496-226190
www.travelsmart.ie, everyones favourite carpool website, works beautifully on the apple iphone
www.warehog.com, & you thought ebay was good
www.ariasoft.ie, See my GPL contributions


      


From barsnick at gmx.net  Wed Feb  4 21:45:40 2009
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 4 Feb 2009 21:45:40 +0100
Subject: [Linux-uvc-devel] Hercules HD Dualpix webcam doesn't appear
	to	be supported.
In-Reply-To: <342575.6674.qm@web51106.mail.re2.yahoo.com>
References: <342575.6674.qm@web51106.mail.re2.yahoo.com>
Message-ID: <20090204204540.GA27531@sunshine.barsnick.net>

Hi D.J.,

On Wed, Feb 04, 2009 at 09:01:21 -0800, D.J. Barrow wrote:
> Let me know if it is.

It isn't.

> Relevant details from dmesg.
> usb 2-1: New USB device found, idVendor=06f8, idProduct=3003
> usb 2-1: New USB device strings: Mfr=1, Product=2, SerialNumber=0
> usb 2-1: Product: Hercules Dualpix HD Microphone
> usb 2-1: Manufacturer: Hercules Dualpix HD Webcam
> ALSA sound/usb/usbaudio.c:1298: 6:2:1: cannot get freq at ep 0x84

That's not really sufficient. There are instructions on the website on
how to identify a UVC device.

Anyway, the info _is_ sufficient for googling, and you will find that
Laurent already once identified (on this list) this device as using a
proprietary protocol.

Sorry,
Moritz


From laurent.pinchart at skynet.be  Thu Feb  5 17:40:17 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Feb 2009 17:40:17 +0100
Subject: [Linux-uvc-devel] <kein Betreff>
In-Reply-To: <722292328@web.de>
References: <722292328@web.de>
Message-ID: <200902051740.17681.laurent.pinchart@skynet.be>

Hi Jens,

On Tuesday 03 February 2009, Jens Gottstein wrote:
> Hi all,
>
> I am using Ubuntu 8.10 and a Crative VF0540 Webcam. Which identifies
> isself as:
>
> $ dmesg
> [26238.642082] uvcvideo: Found UVC 1.00 device Vimicro USB 2.0 PC Camera
> (Venus) (0ac8:3420)
> [26238.642675] uvcvideo: No valid video chain found.
>
> The problem is:  uvcvideo: No valid video chain found.

Indeed :-)

> The funny thing is, It worked before (about a month ago.) But back than
> I did not investigate anything - it just worked. Now it does not work
> anymore. I constantly updated my Ubuntu. Booting an old kernel did not
> do it. On a other Ubuntu 8.10 which is almost the same it doesn't work
> either.
>
> Funny is also that 0ac8:3420 is listed as working on
> http://linux-uvc.berlios.de/.
>
>
> I downloaded the latest uvcvideo-f5c337ded781.tar.gz from 02. Feb 2009,
> compiled is and run it (see listings below). No help.
>
> I got no Idea any more, I would appreciate any help.

I might have introduced a bug in the driver (shame on me then), who knows...

Could you please set the trace parameter to 255 ('modprobe uvcvideo trace=255' 
if the driver is not loaded yet, or 'echo 255 
> /sys/modules/uvcvideo/parameters/trace' if the driver is already loaded). 
Plug the camera and check in the kernel log if the driver reports anything 
new.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Feb  5 18:08:02 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Feb 2009 18:08:02 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49880F26.1070005@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902030123.01803.laurent.pinchart@skynet.be>
	<49880F26.1070005@gmail.com>
Message-ID: <200902051808.02213.laurent.pinchart@skynet.be>

Hi Simone,

On Tuesday 03 February 2009, Simone Freddio wrote:
> Hi Laurent,
>
>     here the results of my tests:
>
>     MaxPayloadTransferSize        Value Returned from device
> Result
>     0                                            128
>                               uvcvideo: USB isochronous frame lost (-71).
>     1                                            128
>                               uvcvideo: USB isochronous frame lost (-71).
>     42                                          128
>                               uvcvideo: USB isochronous frame lost (-71).
>     1024                                      1024
>                            works right with few USB iso frame lost
>     0xFFFF                                   3072
>                        no error but also no capture :-(
>
>     My conclusion is that MaxPayloadTransferSize, regardless of
> specification, is not readonly... seems to be that device round this
> value to the closest that is supported (see also my lsusb in file
> lsusb.txt).
>
>     I think that the right bandwidth allocation must be calculated in
> the driver and set up in the device (the same you have done for
> frameinterval value :-).

I'll see if I can compute an estimated maximum payload transfer size based on 
the information available to the driver, otherwise I will just just smaller 
allocations until one of them succeeds.

I should get a Vimicro camera soon that I will use to develop and test the 
workaround.

Best regards,

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Feb  5 18:12:54 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Feb 2009 18:12:54 +0100
Subject: [Linux-uvc-devel] [PATCH] Video/UVC: Port mainlined uvc video
	driver to NOMMU
In-Reply-To: <386072610902050110r192c53f5xf06a91ac3a115c8f@mail.gmail.com>
References: <1225963130-6784-1-git-send-email-cooloney@kernel.org>
	<20081118133908.GA26119@linux-sh.org>
	<386072610902050110r192c53f5xf06a91ac3a115c8f@mail.gmail.com>
Message-ID: <200902051812.54504.laurent.pinchart@skynet.be>

Hi Bryan,

On Thursday 05 February 2009, Bryan Wu wrote:
> On Tue, Nov 18, 2008 at 9:39 PM, Paul Mundt <lethal at linux-sh.org> wrote:
> > On Fri, Nov 14, 2008 at 12:52:10AM +0100, Laurent Pinchart wrote:
> >> On Monday 10 November 2008, Hennerich, Michael wrote:
> >> > >On Thursday 06 November 2008, Bryan Wu wrote:
> >> > > > @@ -1071,7 +1072,20 @@ static int uvc_v4l2_mmap(struct file *file,
> >> > > > struct vm_area_struct *vma) addr += PAGE_SIZE;
> >> > > >                 size -= PAGE_SIZE;
> >> > > >         }
> >> > > > +#else
> >> > > > +       if (i == video->queue.count ||
> >> > > > +               PAGE_ALIGN(size) != video->queue.buf_size) {
> >> > >
> >> > > Just out of curiosity, why do you need to PAGE_ALIGN size for
> >> > > non-MMU platforms ?
> >> >
> >> > Size and video->queue.buf_size is not the 100% same size (off by a few
> >> > bytes < pagesize), I think it's because on NOMMU the kernel calls
> >> > kmalloc() to allocate the buffer, not get_free_page().
> >>
> >> That's right, but only for private mappings. It makes little sense to
> >> create a private mapping on a V4L2 device as the kernel will read()
> >> device data into the buffer when mapping the device (at least on NOMMU
> >> platforms). Only shared mappings make sense in this case.
> >
> > The change itself is crap anyways, since it is just working around the
> > fact that vm_insert_page() presently -EINVAL's out on nommu. The
> > vmalloc_to_page()/vm_insert_page() pair is used extensively across the
> > v4l drivers, and it's unrealistic to expect to patch every call site with
> > this sort of a workaround.
> >
> > While we can't support vm_insert_page() in most cases, these sorts of
> > use cases where it is just iterating over a contiguous block of pages on
> > a VMA that has already been established is something that can at least be
> > handled fairly easily (in this case, even just doing nothing in
> > vm_insert_page() would likely give the desired result, although we ought
> > to fix up vm_insert_page() to do something more useful instead). Working
> > out the bounds of the VMA isn't exactly difficult either, since we have
> > all of that already filled in the VMA by the time vma_insert_page() is
> > called.
> >
> > Regarding the VMA flag, this can be rectified by providing a dummy
> > get_unmapped_area() for the v4l devices which will set some default
> > capabilities. After that, determine_vm_flags() should take care of
> > setting up the proper VMA flags without hacking every driver's mmap()
> > routine. This sort of thing has absolutely no place in the driver,
> > though.
>
> Hi Laurent,
>
> Does this patch make sense? I hope you understand the tricky things in
> nommu mapping world.

I agree with Paul, the problem lies in vm_insert_page() and a fix is needed 
there.

Best regards,

Laurent Pinchart


From JRoberts at trinityconvergence.com  Fri Feb  6 17:56:23 2009
From: JRoberts at trinityconvergence.com (Jonathan Roberts)
Date: Fri, 6 Feb 2009 16:56:23 -0000
Subject: [Linux-uvc-devel] Problems cross compiling uvc
Message-ID: <864811E44DB83D4DB83B667A4631E755010D6A51@nurburg.Trinity.local>

Hi all,

I am having a few problems with both a Quickcam Pro 9000 and a Creative
Live Optia AF camera on an embedded platform. Before I start digging
into the cause of the problems I thought I have better move to the
latest version of the UVC driver.

The version of the driver that I have working was the last revision in
the old SVN repository. With this version I simply modified the makefile
to point to my Kernel directory and specified my tool chain on the
command line with a CROSS_COMPILE=.... parameter.

With the latest version of UVC that I checked out of mercurial today,
the build process has become much more involved the build environment
does not seem to have any built in support for cross compilers unless I
am missing something. 

In order to cross compile the UVC module I modified the root makefile to
add a definition of CROSS_COMPILE and then changed the targets to:

install:
        $(MAKE) -C $(BUILD_DIR) CROSS_COMPILE=$(CROSS_COMPILE) install
%::
        $(MAKE) -C $(BUILD_DIR) CROSS_COMPILE=$(CROSS_COMPILE)
$(MAKECMDGOALS)

In the v4l/Makefile I changed the SRCDIR and the OUTDIR to point to my
kernel source tree. Everything seems to build ok, but when I try and
insert the module on my target I get an error from insmod:

	insmod: cannot insert './uvcvideo.ko': unknown symbol in module

dmesg shows the following:

uvcvideo: disagrees about version of symbol video_devdata
uvcvideo: Unknown symbol video_devdata
uvcvideo: disagrees about version of symbol video_unregister_device
uvcvideo: Unknown symbol video_unregister_device
uvcvideo: disagrees about version of symbol video_device_alloc
uvcvideo: Unknown symbol video_device_alloc
uvcvideo: disagrees about version of symbol video_register_device
uvcvideo: Unknown symbol video_register_device
uvcvideo: disagrees about version of symbol video_usercopy
uvcvideo: Unknown symbol video_usercopy
uvcvideo: disagrees about version of symbol video_device_release
uvcvideo: Unknown symbol video_device_release

I gather that this shows some sort of missmatch between the environment
that the module was built for and the environment on the target board.
Is that correct? Are these issues related to these messages that I get
when the modules are built?: 

WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_chip_ident_i2c_client'
exported twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_chip_match_i2c_client'
exported twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_chip_match_host' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_ctrl_next' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_ctrl_query_menu' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_ctrl_query_fill_std' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_ctrl_query_fill' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_ctrl_get_menu' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_ctrl_check' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_prio_check' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_prio_max' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_prio_close' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_prio_open' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_prio_change' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_prio_init' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-int-device: 'v4l2_int_ioctl_1' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-int-device: 'v4l2_int_ioctl_0' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-int-device: 'v4l2_int_device_unregister'
exported twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/v4l2-int-device: 'v4l2_int_device_register'
exported twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_unregister_device' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_register_device' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_devdata' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_device_release' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_device_alloc' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_ioctl2' exported twice. Previous
export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'video_usercopy' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'v4l_printk_ioctl' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'v4l2_type_names' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'v4l2_field_names' exported twice.
Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'v4l2_video_std_construct' exported
twice. Previous export was in drivers/built-in.ko
WARNING: /uvcvideo/v4l/videodev: 'v4l2_norm_to_name' exported twice.
Previous export was in drivers/built-in.ko

Building the old code against the same kernel results in a module that
installs correctly, so I guess I have misconfigured something, but I am
not sure what! Any suggestions would be greatfully received.

Thanks

Jonathan


From shaohuang at gmail.com  Sat Feb  7 08:28:34 2009
From: shaohuang at gmail.com (Brian Pin)
Date: Fri, 6 Feb 2009 23:28:34 -0800
Subject: [Linux-uvc-devel] How to tell the difference of single/multiple
	bulk transfer?
Message-ID: <a81f87bb0902062328m5a2f4eacs6fb8bdd6ebe0fbbd@mail.gmail.com>

Hi all,

I am going to make a UVC gadget, and we would like to make some bulk
transferred video device first.
Reviewing the UVC spec 1.1, There is payload header added to each bulk
transfer, and there is only one payload header when I have a single bulk
transfer. (Please refer to spec Figure 2-10, 2-11) My question is how to
tell if this transfer is a single bulk xfer or a multiple bulk xfer?


-- 
Best Regards
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090206/b7234efa/attachment.html>

From gilles.gigan at gmail.com  Sun Feb  8 05:06:25 2009
From: gilles.gigan at gmail.com (Gilles GIGAN)
Date: Sun, 8 Feb 2009 15:06:25 +1100
Subject: [Linux-uvc-devel] Pan and Tilt controls
Message-ID: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>

Hi,
I have checked out the latest v4l code from the mercurial repository on
linuxtv.org, and successfully compiled and loaded the uvcvideo module, which
I tested with a logitech quickcam sphere af (046d:0994). I have comments and
questions regarding the V4L2 controls to pilot the pan and tilt motors:
After mapping the dynamic controls (with uvcdynctrl), the following controls
become available:
- Pan Reset: min: 0, max: 1, step: 1, type: integer
- Tilt Reset: min 0, max: 1, step: 0, type: integer (note the step value of
0 which should really be 1 here)
- Pan (Relative): min: 4480, max: 4480, step: 1, type: integer
- Tilt (Relative): min: 1920, max: 1920, step: 1, type: integer
- Pan/tilt Reset: min: 0, max: 3, step: 1, type: integer
Creating a user interface based on these controls is quite hard because of
their types and step values:
Trying to set a value of 0 on any of the Reset controls fails, even though 0
is reported as an acceptable value.
Setting a value of 1 on either Pan (Relative) or Tilt (Relative) succeeds
but results in no movement.
Keeping the GUI up-to-date is not possible because calling
ioctl(VIDIOC_G_CTRL) on any of these controls fails (which makes sense when
you know what the controls are). But from a programming point of view, if
you try to create an interface that will work with any controls, the way
these are reported (integers) makes it almost impossible to keep track of.
I have a couple of suggestions to improve this, and would appreciate
comments on them:
- Reporting the Pan/Tilt Reset control as a menu and Pan Reset and Tilt
Reset as buttons instead of integers, will solve the previously mentioned
issues.
- Change the Pan (Relative) and Tilt (relative) step value to one that
actually results in a slight movement of the camera.
Is there a way to make these changes when mapping the controls, or do they
have to be coded in the driver itself ?
Thanks
Gilles
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090208/a22a9237/attachment.html>

From pj.assis at gmail.com  Sun Feb  8 13:28:13 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 8 Feb 2009 12:28:13 +0000
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
Message-ID: <59cf47a80902080428p2aaa05c5idfd91e0b581fe275@mail.gmail.com>

Gilles,
Please have a look at guvcview code: http://guvcview.berlios.de
There is an implementation in a GTK GUI of these controls.

Best regards
Paulo

2009/2/8 Gilles GIGAN <gilles.gigan at gmail.com>:
> Hi,
> I have checked out the latest v4l code from the mercurial repository on
> linuxtv.org, and successfully compiled and loaded the uvcvideo module, which
> I tested with a logitech quickcam sphere af (046d:0994). I have comments and
> questions regarding the V4L2 controls to pilot the pan and tilt motors:
> After mapping the dynamic controls (with uvcdynctrl), the following controls
> become available:
> - Pan Reset: min: 0, max: 1, step: 1, type: integer
> - Tilt Reset: min 0, max: 1, step: 0, type: integer (note the step value of
> 0 which should really be 1 here)
> - Pan (Relative): min: 4480, max: 4480, step: 1, type: integer
> - Tilt (Relative): min: 1920, max: 1920, step: 1, type: integer
> - Pan/tilt Reset: min: 0, max: 3, step: 1, type: integer
> Creating a user interface based on these controls is quite hard because of
> their types and step values:
> Trying to set a value of 0 on any of the Reset controls fails, even though 0
> is reported as an acceptable value.
> Setting a value of 1 on either Pan (Relative) or Tilt (Relative) succeeds
> but results in no movement.
> Keeping the GUI up-to-date is not possible because calling
> ioctl(VIDIOC_G_CTRL) on any of these controls fails (which makes sense when
> you know what the controls are). But from a programming point of view, if
> you try to create an interface that will work with any controls, the way
> these are reported (integers) makes it almost impossible to keep track of.
> I have a couple of suggestions to improve this, and would appreciate
> comments on them:
> - Reporting the Pan/Tilt Reset control as a menu and Pan Reset and Tilt
> Reset as buttons instead of integers, will solve the previously mentioned
> issues.
> - Change the Pan (Relative) and Tilt (relative) step value to one that
> actually results in a slight movement of the camera.
> Is there a way to make these changes when mapping the controls, or do they
> have to be coded in the driver itself ?
> Thanks
> Gilles
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>


From laurent.pinchart at skynet.be  Sun Feb  8 13:37:12 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Feb 2009 13:37:12 +0100
Subject: [Linux-uvc-devel] Problems cross compiling uvc
In-Reply-To: <864811E44DB83D4DB83B667A4631E755010D6A51@nurburg.Trinity.local>
References: <864811E44DB83D4DB83B667A4631E755010D6A51@nurburg.Trinity.local>
Message-ID: <200902081337.13036.laurent.pinchart@skynet.be>

Hi Jonathan,

On Friday 06 February 2009 17:56:23 Jonathan Roberts wrote:
> Hi all,
>
> I am having a few problems with both a Quickcam Pro 9000 and a Creative
> Live Optia AF camera on an embedded platform. Before I start digging
> into the cause of the problems I thought I have better move to the
> latest version of the UVC driver.
>
> The version of the driver that I have working was the last revision in
> the old SVN repository. With this version I simply modified the makefile
> to point to my Kernel directory and specified my tool chain on the
> command line with a CROSS_COMPILE=.... parameter.
>
> With the latest version of UVC that I checked out of mercurial today,
> the build process has become much more involved the build environment
> does not seem to have any built in support for cross compilers unless I
> am missing something.
>
> In order to cross compile the UVC module I modified the root makefile to
> add a definition of CROSS_COMPILE and then changed the targets to:
>
> install:
>         $(MAKE) -C $(BUILD_DIR) CROSS_COMPILE=$(CROSS_COMPILE) install
> %::
>         $(MAKE) -C $(BUILD_DIR) CROSS_COMPILE=$(CROSS_COMPILE)
> $(MAKECMDGOALS)
>
> In the v4l/Makefile I changed the SRCDIR and the OUTDIR to point to my
> kernel source tree.

You're right, the current linuxtv.org build system doesn't support cross 
compilation out of the box. As this isn't uvcvideo specific, could you report 
the problem to the linux-media mailing list ? I'm sure they will welcome a 
fix.

> Everything seems to build ok, but when I try and insert the module on my
> target I get an error from insmod:
>
> 	insmod: cannot insert './uvcvideo.ko': unknown symbol in module
>
> dmesg shows the following:
>
> uvcvideo: disagrees about version of symbol video_devdata
> uvcvideo: Unknown symbol video_devdata
> uvcvideo: disagrees about version of symbol video_unregister_device
> uvcvideo: Unknown symbol video_unregister_device
> uvcvideo: disagrees about version of symbol video_device_alloc
> uvcvideo: Unknown symbol video_device_alloc
> uvcvideo: disagrees about version of symbol video_register_device
> uvcvideo: Unknown symbol video_register_device
> uvcvideo: disagrees about version of symbol video_usercopy
> uvcvideo: Unknown symbol video_usercopy
> uvcvideo: disagrees about version of symbol video_device_release
> uvcvideo: Unknown symbol video_device_release
>
> I gather that this shows some sort of missmatch between the environment
> that the module was built for and the environment on the target board.
> Is that correct? Are these issues related to these messages that I get
> when the modules are built?:
>
> WARNING: /uvcvideo/v4l/v4l2-common: 'v4l2_chip_ident_i2c_client'
> exported twice. Previous export was in drivers/built-in.ko

[snip]

> Building the old code against the same kernel results in a module that
> installs correctly, so I guess I have misconfigured something, but I am
> not sure what! Any suggestions would be greatfully received.


linuxtv.org Mercurial trees come with their own version of the video4linux 
subsystem. You will need to disable v4l in your kernel and use the modules 
provided by the uvcvideo tree.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Sun Feb  8 13:53:45 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Feb 2009 13:53:45 +0100
Subject: [Linux-uvc-devel] How to tell the difference of single/multiple
	bulk transfer?
In-Reply-To: <a81f87bb0902062328m5a2f4eacs6fb8bdd6ebe0fbbd@mail.gmail.com>
References: <a81f87bb0902062328m5a2f4eacs6fb8bdd6ebe0fbbd@mail.gmail.com>
Message-ID: <200902081353.46007.laurent.pinchart@skynet.be>

On Saturday 07 February 2009 08:28:34 Brian Pin wrote:
> Hi all,
>
> I am going to make a UVC gadget, and we would like to make some bulk
> transferred video device first.
> Reviewing the UVC spec 1.1, There is payload header added to each bulk
> transfer, and there is only one payload header when I have a single bulk
> transfer. (Please refer to spec Figure 2-10, 2-11) My question is how to
> tell if this transfer is a single bulk xfer or a multiple bulk xfer?

Your device determines the maximum UVC payload size by setting the 
dwMaxPayloadTransferSize field in the video probe/commit control structure. 
You can either set dwMaxPayloadTransferSize to the size of your UVC frame 
(including the header), in which case you can send the frame in a single 
payload, or use a smaller size in which case you will cut your frame into 
chunks of (dwMaxPayloadTransferSize - sizeof(header)) at most and prepend each 
of them with a header.

Don't forget to terminate each payload by a bulk transfer smaller than the 
bulk endpoint maximum packet size (possibly a zero packet if the payload size 
is a multiple of the maximum packet size).

Best regards,

Laurent Pinchart



From gilles.gigan at gmail.com  Mon Feb  9 01:20:15 2009
From: gilles.gigan at gmail.com (Gilles GIGAN)
Date: Mon, 9 Feb 2009 11:20:15 +1100
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <78877a450902081618qeb54395j5cafd6174b1cb08d@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
	<59cf47a80902080428p2aaa05c5idfd91e0b581fe275@mail.gmail.com>
	<78877a450902081618qeb54395j5cafd6174b1cb08d@mail.gmail.com>
Message-ID: <78877a450902081620i38b6e235hc8447a5c426a6e9e@mail.gmail.com>

Hi Paulo,
I had a look at guvcview. I think it s a great app, full of features beyond
a simple frame view/capturing. Great work.
I am trying to write an application that properly displays V4L controls from
any driver, and I have tested with pwc and uvcvideo so far. Digging into
guvcview's source code confirmed what the point I made in my previous post:
img_controls.c, which draws controls on the screen, is full of if..else if
statements which do a lot more than just checking the control type. There
are also some hardcoded menu values for the raw pixel order. This is
precisely what I think should be done differently:
In my opinion, when enumerating V4L controls, user applications should NOT
have to check what a control DOES, ie trying to make sense of either the
v4l2_queryctrl.name or v4l2_queryctrl.id field (which is what guvcview
does), in order to draw this control on the screen. Doing this ties your
application to a specific driver/implementation/version/... and will require
more coding when any of these changes. An application should only have to
check what TYPE the control is (v4l2_queryctrl.type field, and possibly
enumerate over the different menu values if it is a menu), to decide how to
best draw it in a GUI. The driver shoud be responsible for filling in the
struct v4l2_queryctrl correctly with meaningful & sensible values, and
provide a menu for controls that require one. Let me know if my
understanding is flawed somewhere in here.

The V4L2 spec lists the Pan Reset and Tilt Reset as Booleans, which is
already a bit better than Integer (what uvcvideo does so far), although I
stick to my comment in my previous post: I really think these should be
reported as Buttons for the obvious reason that resetting the pan or tilt is
a one-shot action, not a continuous one which holds a value over time (this
fits the definition of V4L2_CTRLTYPE_BUTTON in the specs). Using a button
type makes it clear that trying to get its value is pointless, and it also
makes sense when drawing this control on a GUI. I will bring this up on the
V4L mailing list but I thought I d throw this one here first and see what
people think.
The V4L2 spec says the step value "gives the smallest change of an integer
control actually affecting hardware". Calling ioctl(VIDIOC_G_CTRL) on the
Pan or Tilt Relative control with a value of 1, as per reported step value,
does not do anything. Both guvcview and luvcview get around that by defining
a macro set to 64. Do applications really have to guess/do that, or can the
driver simply report 64 as a step value ?
The Pan/Tilt Reset control is a bit of a tricky one, because it is  a
collection of buttons (Pan reset, Tilt reset or both). Since we already have
dedicated controls for both Pan Reset and Tilt Reset, is it a good idea
change this one to "Pan & Tilt Reset" only, so it can be presented as a
button ? If not, can this control have a menu explaining the different
acceptable values ?

Cheers,
Gilles

On Sun, Feb 8, 2009 at 11:28 PM, Paulo Assis <pj.assis at gmail.com> wrote:

> Gilles,
> Please have a look at guvcview code: http://guvcview.berlios.de
> There is an implementation in a GTK GUI of these controls.
>
> Best regards
> Paulo
>
> 2009/2/8 Gilles GIGAN <gilles.gigan at gmail.com>:
> > Hi,
> > I have checked out the latest v4l code from the mercurial repository on
> > linuxtv.org, and successfully compiled and loaded the uvcvideo module,
> which
> > I tested with a logitech quickcam sphere af (046d:0994). I have comments
> and
> > questions regarding the V4L2 controls to pilot the pan and tilt motors:
> > After mapping the dynamic controls (with uvcdynctrl), the following
> controls
> > become available:
> > - Pan Reset: min: 0, max: 1, step: 1, type: integer
> > - Tilt Reset: min 0, max: 1, step: 0, type: integer (note the step value
> of
> > 0 which should really be 1 here)
> > - Pan (Relative): min: 4480, max: 4480, step: 1, type: integer
> > - Tilt (Relative): min: 1920, max: 1920, step: 1, type: integer
> > - Pan/tilt Reset: min: 0, max: 3, step: 1, type: integer
> > Creating a user interface based on these controls is quite hard because
> of
> > their types and step values:
> > Trying to set a value of 0 on any of the Reset controls fails, even
> though 0
> > is reported as an acceptable value.
> > Setting a value of 1 on either Pan (Relative) or Tilt (Relative) succeeds
> > but results in no movement.
> > Keeping the GUI up-to-date is not possible because calling
> > ioctl(VIDIOC_G_CTRL) on any of these controls fails (which makes sense
> when
> > you know what the controls are). But from a programming point of view, if
> > you try to create an interface that will work with any controls, the way
> > these are reported (integers) makes it almost impossible to keep track
> of.
> > I have a couple of suggestions to improve this, and would appreciate
> > comments on them:
> > - Reporting the Pan/Tilt Reset control as a menu and Pan Reset and Tilt
> > Reset as buttons instead of integers, will solve the previously mentioned
> > issues.
> > - Change the Pan (Relative) and Tilt (relative) step value to one that
> > actually results in a slight movement of the camera.
> > Is there a way to make these changes when mapping the controls, or do
> they
> > have to be coded in the driver itself ?
> > Thanks
> > Gilles
> >
> >
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
> >
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090209/2df6b902/attachment.html>

From pj.assis at gmail.com  Mon Feb  9 01:42:18 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 9 Feb 2009 00:42:18 +0000
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <78877a450902081618qeb54395j5cafd6174b1cb08d@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
	<59cf47a80902080428p2aaa05c5idfd91e0b581fe275@mail.gmail.com>
	<78877a450902081618qeb54395j5cafd6174b1cb08d@mail.gmail.com>
Message-ID: <59cf47a80902081642n4efdaff5x7d3634284b5a2b10@mail.gmail.com>

Gilles,

2009/2/9 Gilles GIGAN <gilles.gigan at gmail.com>:
> Hi Paulo,
> I had a look at guvcview. I think it s a great app, full of features beyond
> a simple frame view/capturing. Great work.
> I am trying to write an application that properly displays V4L controls from
> any driver, and I have tested with pwc and uvcvideo so far. Digging into
> guvcview's source code confirmed what the point I made in my previous post:
> img_controls.c, which draws controls on the screen, is full of if..else if
> statements which do a lot more than just checking the control type. There
> are also some hardcoded menu values for the raw pixel order. This is
> precisely what I think should be done differently:
> In my opinion, when enumerating V4L controls, user applications should NOT
> have to check what a control DOES, ie trying to make sense of either the
> v4l2_queryctrl.name or v4l2_queryctrl.id field (which is what guvcview
> does), in order to draw this control on the screen. Doing this ties your
> application to a specific driver/implementation/version/... and will require
> more coding when any of these changes. An application should only have to
> check what TYPE the control is (v4l2_queryctrl.type field, and possibly
> enumerate over the different menu values if it is a menu), to decide how to
> best draw it in a GUI. The driver shoud be responsible for filling in the
> struct v4l2_queryctrl correctly with meaningful & sensible values, and
> provide a menu for controls that require one. Let me know if my
> understanding is flawed somewhere in here.
>
> The V4L2 spec lists the Pan Reset and Tilt Reset as Booleans, which is
> already a bit better than Integer (what uvcvideo does so far), although I
> stick to my comment in my previous post: I really think these should be
> reported as Buttons for the obvious reason that resetting the pan or tilt is
> a one-shot action, not a continuous one which holds a value over time (this
> fits the definition of V4L2_CTRLTYPE_BUTTON in the specs). Using a button
> type makes it clear that trying to get its value is pointless, and it also
> makes sense when drawing this control on a GUI. I will bring this up on the
> V4L mailing list but I thought I d throw this one here first and see what
> people think.
> The V4L2 spec says the step value "gives the smallest change of an integer
> control actually affecting hardware". Calling ioctl(VIDIOC_G_CTRL) on the
> Pan or Tilt Relative control with a value of 1, as per reported step value,
> does not do anything. Both guvcview and luvcview get around that by defining
> a macro set to 64. Do applications really have to guess/do that, or can the
> driver simply report 64 as a step value ?
> The Pan/Tilt Reset control is a bit of a tricky one, because it is  a
> collection of buttons (Pan reset, Tilt reset or both). Since we already have
> dedicated controls for both Pan Reset and Tilt Reset, is it a good idea
> change this one to "Pan & Tilt Reset" only, so it can be presented as a
> button ? If not, can this control have a menu explaining the different
> acceptable values ?
>

You are absolutely right on every point, except for one thing:
Pan/Tilt controls are  extension controls, the driver just loads the
values passed by applications, in this case logitech defines these has
integers, unless the hardware accepts them as buttons or menu values
then there is not much it can be done, I think. The good (maybe bad)
thing is that so far only logitech cameras seem to support these
extension controls, so not much code changes have been needed until
now).

PS: since today (10 minutes ago) svn head version of guvcview also
allows for a control only window (just committed the changes), I've
tested controlling the image in cheese and ekiga and it worked great,
just start with:
guvcview --control_only

Best regards,
Paulo


From gilles.gigan at gmail.com  Mon Feb  9 06:33:13 2009
From: gilles.gigan at gmail.com (Gilles GIGAN)
Date: Mon, 9 Feb 2009 16:33:13 +1100
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <59cf47a80902081642n4efdaff5x7d3634284b5a2b10@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
	<59cf47a80902080428p2aaa05c5idfd91e0b581fe275@mail.gmail.com>
	<78877a450902081618qeb54395j5cafd6174b1cb08d@mail.gmail.com>
	<59cf47a80902081642n4efdaff5x7d3634284b5a2b10@mail.gmail.com>
Message-ID: <78877a450902082133s522b3b48r68b05b7bb7dab5e7@mail.gmail.com>

Paulo,
I checked the libwebcam code which I used to add/map the dynamic controls to
my camera. I found that it will only map and add integer and boolean
controls, but if you uncomment some lines (446 to 456), it will take menu,
buttons and integer64 controls. I did just that, and managed to have Pan
Reset and Tilt Reset mapped as buttons instead of integers.
However, setting a value on there fails and "uvcvideo: Control 9/2 failure
change len 6." is printed in syslog (I enabled tracing when I loaded
uvcvideo). Looks like you are right, I don t know if the driver can do much
about that (maybe Laurent can comment on that).
GIlles

On Mon, Feb 9, 2009 at 11:42 AM, Paulo Assis <pj.assis at gmail.com> wrote:

> Gilles,
>
> You are absolutely right on every point, except for one thing:
> Pan/Tilt controls are  extension controls, the driver just loads the
> values passed by applications, in this case logitech defines these has
> integers, unless the hardware accepts them as buttons or menu values
> then there is not much it can be done, I think. The good (maybe bad)
> thing is that so far only logitech cameras seem to support these
> extension controls, so not much code changes have been needed until
> now).
>
> PS: since today (10 minutes ago) svn head version of guvcview also
> allows for a control only window (just committed the changes), I've
> tested controlling the image in cheese and ekiga and it worked great,
> just start with:
> guvcview --control_only
>
> Best regards,
> Paulo
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090209/1f004637/attachment.html>

From hlambermont at virtualproteins.com  Fri Feb 13 09:58:15 2009
From: hlambermont at virtualproteins.com (Hans Lambermont)
Date: Fri, 13 Feb 2009 09:58:15 +0100
Subject: [Linux-uvc-devel] Philips SPC1330NC 0471:2037
In-Reply-To: <20090212153302.GA20219@gagh.ehv.virtualproteins.com>
References: <20090212153302.GA20219@gagh.ehv.virtualproteins.com>
Message-ID: <20090213085815.GA30669@gagh.ehv.virtualproteins.com>

Hi all,

The Philips SPC 1330NC (0471:2037) is not yet listed on the Supported
devices list at http://linux-uvc.berlios.de/

The webcam works fine with uvcvideo 1.00 .

Supported modes :
   640x480  (YUYV, MJPEG) at 30 Hz
   800x600  (YUYV, MJPEG) at 20 Hz
  1280x960  (YUYV, MJPEG) at  6 Hz
  1600x1200 (YUYV,      ) at  6 Hz

regards,
   Hans Lambermont
-- 
Hans Lambermont, M.Sc. - Senior Software Engineer - Virtual Proteins
http://virtualproteins.com/                           t:+31408512250



From laurent.pinchart at skynet.be  Sun Feb 15 00:51:08 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 15 Feb 2009 00:51:08 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902051808.02213.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org> <49880F26.1070005@gmail.com>
	<200902051808.02213.laurent.pinchart@skynet.be>
Message-ID: <200902150051.08428.laurent.pinchart@skynet.be>

Hi everybody,

here's a patch to fix the USB bandwidth value for Vimicro cameras. The 
required bandwidth is computed from the frame size (width * height * bpp / 8), 
the minimum frame interval and the USB (micro-)frame duration.

If you own a Vimicro device, could you please test the patch and report 
results ? I'm especially interested in reports from streaming from two Vimicro 
devices at the same time (if you own a Minoru3D you have no excuse not to try 
this).

Simone, could you also test the patch with your camera ? I don't think you've 
reported the camera model, is it a Vimicro device ?

Best regards,

Laurent Pinchart

-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix-bandwidth.diff
Type: text/x-patch
Size: 2340 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090215/eae689fb/attachment.bin>

From laurent.pinchart at skynet.be  Sun Feb 15 01:13:52 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 15 Feb 2009 01:13:52 +0100
Subject: [Linux-uvc-devel] Philips SPC1330NC 0471:2037
In-Reply-To: <20090213085815.GA30669@gagh.ehv.virtualproteins.com>
References: <20090212153302.GA20219@gagh.ehv.virtualproteins.com>
	<20090213085815.GA30669@gagh.ehv.virtualproteins.com>
Message-ID: <200902150113.52492.laurent.pinchart@skynet.be>

Hi Hans,

On Friday 13 February 2009 09:58:15 Hans Lambermont wrote:
> Hi all,
>
> The Philips SPC 1330NC (0471:2037) is not yet listed on the Supported
> devices list at http://linux-uvc.berlios.de/
>
> The webcam works fine with uvcvideo 1.00 .
>
> Supported modes :
>    640x480  (YUYV, MJPEG) at 30 Hz
>    800x600  (YUYV, MJPEG) at 20 Hz
>   1280x960  (YUYV, MJPEG) at  6 Hz
>   1600x1200 (YUYV,      ) at  6 Hz

Thanks for the report. Could you please send me the output of

lsusb -v -d 0471:2037

using usbutils 0.72 or newer (0.73+ preferred) ? I'll then update the website.

Best regards,

Laurent Pinchart



From jan.ciger at gmail.com  Sun Feb 15 03:32:45 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Sun, 15 Feb 2009 03:32:45 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902150051.08428.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org> <49880F26.1070005@gmail.com>
	<200902051808.02213.laurent.pinchart@skynet.be>
	<200902150051.08428.laurent.pinchart@skynet.be>
Message-ID: <49977ECD.5050906@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Laurent Pinchart wrote:
> Hi everybody,
> 
> here's a patch to fix the USB bandwidth value for Vimicro cameras.
> The required bandwidth is computed from the frame size (width *
> height * bpp / 8), the minimum frame interval and the USB
> (micro-)frame duration.
> 
> If you own a Vimicro device, could you please test the patch and
> report results ? I'm especially interested in reports from streaming
> from two Vimicro devices at the same time (if you own a Minoru3D you
> have no excuse not to try this).

I am on it!

Will report back ASAP.

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJl37Kn11XseNj94gRAuDZAJ4i987vxrALaKcJWw/dmi0x7BlywgCg4BQj
tHN2SC5qHoQ92pnWfnjAQsk=
=g+ur
-----END PGP SIGNATURE-----


From jan.ciger at gmail.com  Sun Feb 15 05:46:09 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Sun, 15 Feb 2009 05:46:09 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902150051.08428.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org> <49880F26.1070005@gmail.com>
	<200902051808.02213.laurent.pinchart@skynet.be>
	<200902150051.08428.laurent.pinchart@skynet.be>
Message-ID: <49979E11.7000107@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Laurent Pinchart wrote:
> Hi everybody,
>...

Hello Laurent,

I have tried the patch against the driver in Mandriva's 2.6.27
(2.6.27.14-server-1.uc2mnb) and it didn't apply cleanly. After fixing
the rejects the driver worked, but I was unable to stream the video from
both cameras. I was getting no space on device error as before.

Afterwards I have downloaded the latest uvc driver from the repository,
applied the patch (cleanly this time) and tried to load the driver. The
driver loads, recognizes the camera but when I try to start luvcview, I
get the attached kernel crash :(

Which kernel is your driver supposed to work with?

Regards,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJl54Pn11XseNj94gRAu4uAKCZiyVsksdJKzqt1wHtZihrOOvhmACgvnea
nABxZnHGm4beM7di6I96IBs=
=okma
-----END PGP SIGNATURE-----
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bug_txt.zip
Type: application/zip
Size: 2568 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090215/0a2e55f5/attachment.zip>

From laurent.pinchart at skynet.be  Sun Feb 15 12:59:05 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 15 Feb 2009 12:59:05 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49979E11.7000107@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902150051.08428.laurent.pinchart@skynet.be>
	<49979E11.7000107@gmail.com>
Message-ID: <200902151259.05960.laurent.pinchart@skynet.be>

Hi Jan,

On Sunday 15 February 2009 05:46:09 Jan Ciger wrote:
> Laurent Pinchart wrote:
> > Hi everybody,
> >...
>
> Hello Laurent,
>
> I have tried the patch against the driver in Mandriva's 2.6.27
> (2.6.27.14-server-1.uc2mnb) and it didn't apply cleanly. After fixing
> the rejects the driver worked, but I was unable to stream the video from
> both cameras. I was getting no space on device error as before.

Could you try different resolutions ? The driver should report the bandwidth 
requested by the camera in the kernel log, that information can help debugging 
the issue.

> Afterwards I have downloaded the latest uvc driver from the repository,
> applied the patch (cleanly this time) and tried to load the driver. The
> driver loads, recognizes the camera but when I try to start luvcview, I
> get the attached kernel crash :(
>
> Which kernel is your driver supposed to work with?

It's supposed to be compatible with all kernels starting at 2.6.16.

Please note that you must use the videodev module (and its dependencies) from 
the uvcvideo source tree. Mixing uvcvideo from the mercurial tree with a 
mainline videodev module will probably crash.

Best regards,

Laurent Pinchart



From jan.ciger at gmail.com  Sun Feb 15 17:19:42 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Sun, 15 Feb 2009 17:19:42 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902151259.05960.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org>
	<200902150051.08428.laurent.pinchart@skynet.be>
	<49979E11.7000107@gmail.com>
	<200902151259.05960.laurent.pinchart@skynet.be>
Message-ID: <4998409E.2020800@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Laurent,

Laurent Pinchart wrote:
> Hi Jan,
> 
> Could you try different resolutions ? The driver should report the
> bandwidth requested by the camera in the kernel log, that information
> can help debugging the issue.

OK, got it work now - I guess I have mixed some incompatible module
versions.

320x240 15 and 30fps works, both cameras stream.
Log shows: uvcvideo: device Vimicro USB2.0 PC Camera requested 595 bytes
per payload.

352x288 15 and 30fps works, both cameras stream
Log: uvcvideo: device Vimicro USB2.0 PC Camera requested 785 bytes per
payload.

640x480 15 and 30fps doesn't work, opening second luvcview results in:
uvcvideo: device Vimicro USB2.0 PC Camera requested 2380 bytes per payload.
uvcvideo: Failed to submit URB 0 (-28).

Strange thing is that the amount of data requested doesn't depend on the
frame rate.

I did a bit of experimentation and have managed to get both cameras
stream at 640x480/15fps with the payload size of 2000 bytes. However,
luvcview hangs if I try to use 30fps (there is no message in the log). I
think you need to take the requested framerate in the account when doing
the calculation.


> Please note that you must use the videodev module (and its
> dependencies) from the uvcvideo source tree. Mixing uvcvideo from the
> mercurial tree with a mainline videodev module will probably crash.

Yep - that was it :(


Regards,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJmECcn11XseNj94gRAuJkAJ0YQy+B1wL0M8i7rCZbC//dQnOtjQCgnTyM
FXjydE+KeTkSxfLwF0bGE9o=
=crOr
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Sun Feb 15 19:58:48 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 15 Feb 2009 19:58:48 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <4998409E.2020800@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902151259.05960.laurent.pinchart@skynet.be>
	<4998409E.2020800@gmail.com>
Message-ID: <200902151958.48305.laurent.pinchart@skynet.be>

Hi Jan,

On Sunday 15 February 2009 17:19:42 Jan Ciger wrote:
> Hi Laurent,
>
> Laurent Pinchart wrote:
> > Hi Jan,
> >
> > Could you try different resolutions ? The driver should report the
> > bandwidth requested by the camera in the kernel log, that information
> > can help debugging the issue.
>
> OK, got it work now - I guess I have mixed some incompatible module
> versions.
>
> 320x240 15 and 30fps works, both cameras stream.
> Log shows: uvcvideo: device Vimicro USB2.0 PC Camera requested 595 bytes
> per payload.
>
> 352x288 15 and 30fps works, both cameras stream
> Log: uvcvideo: device Vimicro USB2.0 PC Camera requested 785 bytes per
> payload.
>
> 640x480 15 and 30fps doesn't work, opening second luvcview results in:
> uvcvideo: device Vimicro USB2.0 PC Camera requested 2380 bytes per payload.
> uvcvideo: Failed to submit URB 0 (-28).
>
> Strange thing is that the amount of data requested doesn't depend on the
> frame rate.
>
> I did a bit of experimentation and have managed to get both cameras
> stream at 640x480/15fps with the payload size of 2000 bytes. However,
> luvcview hangs if I try to use 30fps (there is no message in the log). I
> think you need to take the requested framerate in the account when doing
> the calculation.

You're right. I've attached an updated version of the patch to this e-mail. 
Could you please test it ?

> > Please note that you must use the videodev module (and its
> > dependencies) from the uvcvideo source tree. Mixing uvcvideo from the
> > mercurial tree with a mainline videodev module will probably crash.
>
> Yep - that was it :(

Best regards,

Laurent Pinchart

-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix-bandwidth.diff
Type: text/x-patch
Size: 2452 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090215/bafe0a70/attachment.bin>

From kollix at aon.at  Mon Feb 16 08:40:36 2009
From: kollix at aon.at (Martin Koller)
Date: Mon, 16 Feb 2009 08:40:36 +0100
Subject: [Linux-uvc-devel] Device ID of my UVC WebCam
Message-ID: <200902160840.36220.kollix@aon.at>

Hi,

In my Acer Aspire 7730ZG-343G32Mn Notebook, the webcam delivers the following
lsusb -v output:

Bus 004 Device 002: ID 064e:a103 Suyin Corp.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x064e Suyin Corp.
  idProduct          0xa103
  bcdDevice            1.00
  iManufacturer           2 SuYin
  iProduct                1 Acer Crystal Eye webcam
  iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02


Please add it to the Supported devices list.

(I use openSuse 11.1, kernel 2.6.27.7-9-pae)
Thanks.

-- 
Best regards/Sch?ne Gr??e

Martin Koller   ()  ascii ribbon campaign - against html mail 
                /\                        - against microsoft attachments


From jan.ciger at gmail.com  Mon Feb 16 10:32:13 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 16 Feb 2009 10:32:13 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902151958.48305.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org>
	<200902151259.05960.laurent.pinchart@skynet.be>
	<4998409E.2020800@gmail.com>
	<200902151958.48305.laurent.pinchart@skynet.be>
Message-ID: <4999329D.8070808@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Laurent,

Laurent Pinchart wrote:
> Hi Jan,
>
> You're right. I've attached an updated version of the patch to this
e-mail.
> Could you please test it ?

Will do later today when I am back from office.

Regards,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJmTKdn11XseNj94gRAqIbAKDZX7xvP/dlQgjDMLSorecDFMFNugCfY6Q8
BHYYHeaz5qeIZJ42CdG53aA=
=AChB
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Mon Feb 16 11:27:39 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 16 Feb 2009 11:27:39 +0100
Subject: [Linux-uvc-devel] Device ID of my UVC WebCam
In-Reply-To: <200902160840.36220.kollix@aon.at>
References: <200902160840.36220.kollix@aon.at>
Message-ID: <200902161127.39505.laurent.pinchart@skynet.be>

Hi Martin

On Monday 16 February 2009 08:40:36 Martin Koller wrote:
> Hi,
>
> In my Acer Aspire 7730ZG-343G32Mn Notebook, the webcam delivers the
> following lsusb -v output:
>
> Bus 004 Device 002: ID 064e:a103 Suyin Corp.
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   idVendor           0x064e Suyin Corp.
>   idProduct          0xa103
>   bcdDevice            1.00
>   iManufacturer           2 SuYin
>   iProduct                1 Acer Crystal Eye webcam
>   iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02
>
> Please add it to the Supported devices list.

Should I assume you've tested the camera and it works ?

> (I use openSuse 11.1, kernel 2.6.27.7-9-pae)

Could you please provide the complete output of

lsusb -v -d 064e:a103

Thanks.

Best regards,

Laurent Pinchart



From jan.ciger at gmail.com  Mon Feb 16 18:00:54 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 16 Feb 2009 18:00:54 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49999885.8000404@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902151259.05960.laurent.pinchart@skynet.be>
	<4998409E.2020800@gmail.com>
	<200902151958.48305.laurent.pinchart@skynet.be>
	<49999885.8000404@gmail.com>
Message-ID: <49999BC6.2030603@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Replying to self:

Jan Ciger wrote:
> 
> Is it actually possible to have two cameras on USB 2.0 bus streaming at
> 30 fps and VGA resolution? It certainly does work on FireWire 400 - that
> should have comparable bandwidth in YUV411 mode (have two such Unibrain
> cams on my desk right now).

Actually, I have checked the Minoru camera and it reports the mode as
YUV422, not 411. 422 doesn't work in 30fps even on FireWire, so this
issue is moot.

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJmZvGn11XseNj94gRAhF8AJ42QKV5w64Z3e7YXNImmeG+oOjv1ACg8fFD
JbCfQn62YJ7DK8Fk+/uM8oQ=
=UZsC
-----END PGP SIGNATURE-----


From jan.ciger at gmail.com  Mon Feb 16 17:47:01 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 16 Feb 2009 17:47:01 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902151958.48305.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org>
	<200902151259.05960.laurent.pinchart@skynet.be>
	<4998409E.2020800@gmail.com>
	<200902151958.48305.laurent.pinchart@skynet.be>
Message-ID: <49999885.8000404@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Laurent,

Laurent Pinchart wrote:

> You're right. I've attached an updated version of the patch to this e-mail. 
> Could you please test it ?
> 


I have tested your new patch and now I am able to stream from both
cameras at 640x480 and 15fps. 30fps is still giving the "no space on
device" message when I try to open the second camera. The payload sizes
reported are 1152 bytes for 15 fps case and 2380 bytes for 30 fps.

Is it actually possible to have two cameras on USB 2.0 bus streaming at
30 fps and VGA resolution? It certainly does work on FireWire 400 - that
should have comparable bandwidth in YUV411 mode (have two such Unibrain
cams on my desk right now). Other than this, the camera seems to start
being usable, good job!

Regards,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJmZiFn11XseNj94gRAqHTAKDMqWYdwNTyk5EyUWPArA/GEaFtmgCfbpqg
R2tZc4MqjmcxF99ckSX3Gk0=
=tmOI
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Mon Feb 16 18:21:59 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 16 Feb 2009 18:21:59 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49999885.8000404@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902151958.48305.laurent.pinchart@skynet.be>
	<49999885.8000404@gmail.com>
Message-ID: <200902161822.00177.laurent.pinchart@skynet.be>

Hi Jan,

On Monday 16 February 2009 17:47:01 Jan Ciger wrote:
> Hello Laurent,
>
> Laurent Pinchart wrote:
> > You're right. I've attached an updated version of the patch to this
> > e-mail. Could you please test it ?
>
> I have tested your new patch and now I am able to stream from both
> cameras at 640x480 and 15fps. 30fps is still giving the "no space on
> device" message when I try to open the second camera. The payload sizes
> reported are 1152 bytes for 15 fps case and 2380 bytes for 30 fps.
>
> Is it actually possible to have two cameras on USB 2.0 bus streaming at
> 30 fps and VGA resolution? It certainly does work on FireWire 400 - that
> should have comparable bandwidth in YUV411 mode (have two such Unibrain
> cams on my desk right now).

Short answer, I don't know.

The cameras need to transfer 2380 bytes of video data per microframe. The 12 
bytes headers are currently not taken into account by the driver, adding them 
would raise the total to 2392 bytes per microframe per camera.

The smallest bandwidth alternate setting that would still allow us to stream 
2380+12 bytes per microframe has an endpoint maximum packed size of 2688 
bytes. This would lead to 5376 bytes per microframe for both devices.

Periodic transfers can't take more than 80% of the available bandwidth. If we 
neglect overhead, the maximum periodic transfer length is

480e6 / 8 / 8000 * 0.8 = 6000 bytes per microframe.

5376 bytes seem to fit in the available bandwidth, but we need to take 
overhead into account, as well as other periodic transfers (interrupt). As the 
USB core rejects our request for twice 2380 bytes per microframe, I'm inclined 
to believe 2x 640x480 at 30fps YUYV can't be streamed on high-speed USB.

> Other than this, the camera seems to start being usable, good job!

Thanks.

Unless you believe 30 fps should be supported, I'll take the header size into 
account and I'll commit the patch.

Laurent Pinchart



From yann at lecun.org  Mon Feb 16 18:26:15 2009
From: yann at lecun.org (Yann LeCun)
Date: Mon, 16 Feb 2009 12:26:15 -0500
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <49999BC6.2030603@gmail.com>
References: <200901311727.33749.yann@lecun.org> <49999885.8000404@gmail.com>
	<49999BC6.2030603@gmail.com>
Message-ID: <200902161226.15537.yann@lecun.org>

Cool! 

Just to make sure: the patch is meant to be applied to the standard
2.6.27-xx source tree, not to the latest/greatest version of uvc from
http://linuxtv.org/hg/~pinchartl/uvcvideo 
right?

by the way, this will probably fix a similar problem I was having
while trying to grab images from two Logitech webcams simultaneously.

  -- Yann


On Monday 16 February 2009, Jan Ciger wrote:
> Replying to self:
>
> Jan Ciger wrote:
> > Is it actually possible to have two cameras on USB 2.0 bus streaming at
> > 30 fps and VGA resolution? It certainly does work on FireWire 400 - that
> > should have comparable bandwidth in YUV411 mode (have two such Unibrain
> > cams on my desk right now).
>
> Actually, I have checked the Minoru camera and it reports the mode as
> YUV422, not 411. 422 doesn't work in 30fps even on FireWire, so this
> issue is moot.
>
> Jan




From jan.ciger at gmail.com  Mon Feb 16 18:54:29 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 16 Feb 2009 18:54:29 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902161822.00177.laurent.pinchart@skynet.be>
References: <200901311727.33749.yann@lecun.org>
	<200902151958.48305.laurent.pinchart@skynet.be>
	<49999885.8000404@gmail.com>
	<200902161822.00177.laurent.pinchart@skynet.be>
Message-ID: <4999A855.6070202@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Laurent Pinchart wrote:
> 5376 bytes seem to fit in the available bandwidth, but we need to
> take overhead into account, as well as other periodic transfers
> (interrupt). As the USB core rejects our request for twice 2380 bytes
> per microframe, I'm inclined to believe 2x 640x480 at 30fps YUYV can't
> be streamed on high-speed USB.

Thanks for the explanation, this looks reasonable :( Unfortunately that
will make my life a bit more complicated, but well ..

> Unless you believe 30 fps should be supported, I'll take the header
> size into account and I'll commit the patch.

Well, if there is no way how to get this to work, there is no point in
delaying the patch. I am sure the camera doesn't stream 30 fps in
Windows neither.

Thanks,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJmahTn11XseNj94gRAoAwAJ0eURr6Y/JTseiYNOIjz+q0IKenEACgvZUU
sioAKtqb/U04fpwHkD9abTI=
=7/fG
-----END PGP SIGNATURE-----


From jan.ciger at gmail.com  Mon Feb 16 18:55:51 2009
From: jan.ciger at gmail.com (Jan Ciger)
Date: Mon, 16 Feb 2009 18:55:51 +0100
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <200902161226.15537.yann@lecun.org>
References: <200901311727.33749.yann@lecun.org> <49999885.8000404@gmail.com>
	<49999BC6.2030603@gmail.com> <200902161226.15537.yann@lecun.org>
Message-ID: <4999A8A7.9040509@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Yann LeCun wrote:
> Cool! 
> 
> Just to make sure: the patch is meant to be applied to the standard
> 2.6.27-xx source tree, not to the latest/greatest version of uvc from
> http://linuxtv.org/hg/~pinchartl/uvcvideo 
> right?
> 

Nope, this was to the latest UVC. It doesn't apply cleanly to 2.6.27.xxx

Regards,

Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mandriva - http://enigmail.mozdev.org

iD8DBQFJmainn11XseNj94gRAgzmAJ9IuwkSAvYOC0oKJgf5azqKl1+J1wCg3TPa
4Wd78rKM0BW1efaZ1qn9bTQ=
=gvQ0
-----END PGP SIGNATURE-----


From laurent.pinchart at skynet.be  Mon Feb 16 22:38:06 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 16 Feb 2009 22:38:06 +0100
Subject: [Linux-uvc-devel] [ANNOUNCE] Minoru3D camera supported by the Linux
	UVC driver
Message-ID: <200902162238.06526.laurent.pinchart@skynet.be>

Hi everybody,

I've just realized that my latest announcement to the linux-uvc-devel mailing 
list is awfully old. I had to do something about it, and I'm pleased to 
announce that the Linux UVC driver now supports the Minoru3D stereo camera.

The Minoru3D (http://www.minoru3d.com) is a cute, anthropomorphic device made 
of two UVC cameras mounted in a single case and spaced roughly the same 
distance apart as human eyes to get a stereoscopic effect.

The latest Linux UVC driver supports streaming from both cameras 
simultaneously at 30fps (up to 320x240) or 15fps (up to 640x480). You can 
download it from the Linux UVC Mercurial repository 
(http://linuxtv.org/hg/~pinchartl/uvcvideo) or wait for Linux 2.6.30.

Please note that anaglyph (pseudo-3D image with red and blue or red and cyan 
components), "picture in picture" and "side by side" output provided by the 
Minoru3D driver on the Windows platform is not supported at this stage. This 
is an excellent opportunity for all of you to get into V4L2 application 
development and write a nice anaglyph Linux application :-)

I would like to thank Promotion & Display Technology for helping the Linux UVC 
driver development by providing both hardware samples and technical 
information.

Cheers,

Laurent Pinchart



From yann at lecun.org  Mon Feb 16 23:45:23 2009
From: yann at lecun.org (Yann LeCun)
Date: Mon, 16 Feb 2009 17:45:23 -0500
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <4999A8A7.9040509@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902161226.15537.yann@lecun.org> <4999A8A7.9040509@gmail.com>
Message-ID: <200902161745.23777.yann@lecun.org>

OK, the patch works for me too. 
The Minoru works like a charm now.

640x480 at 15 fps works fine.
640x480 at 30 fps doesn't work, as Jan noted.
the raw bandwidth for 2 cameras at 640x480, 30 fps, 
in YUYV (two bytes per pixel) is just below the USB 
bandwidth, but the overhead must make it go over.

Laurent: merci mille fois.

  -- Yann


On Monday 16 February 2009, Jan Ciger wrote:
> Yann LeCun wrote:
> > Cool!
> >
> > Just to make sure: the patch is meant to be applied to the standard
> > 2.6.27-xx source tree, not to the latest/greatest version of uvc from
> > http://linuxtv.org/hg/~pinchartl/uvcvideo
> > right?
>
> Nope, this was to the latest UVC. It doesn't apply cleanly to 2.6.27.xxx
>
> Regards,
>
> Jan




From yann at lecun.org  Tue Feb 17 00:30:37 2009
From: yann at lecun.org (Yann LeCun)
Date: Mon, 16 Feb 2009 18:30:37 -0500
Subject: [Linux-uvc-devel] Minoru stereo webcam
In-Reply-To: <4999A855.6070202@gmail.com>
References: <200901311727.33749.yann@lecun.org>
	<200902161822.00177.laurent.pinchart@skynet.be>
	<4999A855.6070202@gmail.com>
Message-ID: <200902161830.37415.yann@lecun.org>

I seem to be having a strange problem with the patch:
Using my own v4l2 grabbing code, I can do:
640x480 15 fps
320x240 30 fps
160x120 30 fps
and everything works fine.

but if I try 320x240 or 160x120 with an fps any 
lower than 30 fps, it doesn't work.

It looks like my code hangs at the next i/o (or perhaps
the next call to select() that it encounters) after grabbing 
a frame.  This problem doesn't happen if I set the fps to 30 
(or more).

Very strange.

  -- Yann


On Monday 16 February 2009, Jan Ciger wrote:
> Laurent Pinchart wrote:
> > 5376 bytes seem to fit in the available bandwidth, but we need to
> > take overhead into account, as well as other periodic transfers
> > (interrupt). As the USB core rejects our request for twice 2380 bytes
> > per microframe, I'm inclined to believe 2x 640x480 at 30fps YUYV can't
> > be streamed on high-speed USB.
>
> Thanks for the explanation, this looks reasonable :( Unfortunately that
> will make my life a bit more complicated, but well ..
>
> > Unless you believe 30 fps should be supported, I'll take the header
> > size into account and I'll commit the patch.
>
> Well, if there is no way how to get this to work, there is no point in
> delaying the patch. I am sure the camera doesn't stream 30 fps in
> Windows neither.
>
> Thanks,
>
> Jan




From pmarques at grupopie.com  Tue Feb 17 13:49:15 2009
From: pmarques at grupopie.com (Paulo Marques)
Date: Tue, 17 Feb 2009 12:49:15 +0000
Subject: [Linux-uvc-devel] [ANNOUNCE] Minoru3D camera supported by the
 Linux	UVC driver
In-Reply-To: <200902162238.06526.laurent.pinchart@skynet.be>
References: <200902162238.06526.laurent.pinchart@skynet.be>
Message-ID: <499AB24B.2010900@grupopie.com>

Laurent Pinchart wrote:
> Hi everybody,

Hi, Laurent

> [...]
> The latest Linux UVC driver supports streaming from both cameras 
> simultaneously at 30fps (up to 320x240) or 15fps (up to 640x480). You can 
> download it from the Linux UVC Mercurial repository 
> (http://linuxtv.org/hg/~pinchartl/uvcvideo) or wait for Linux 2.6.30.

Do you happen to know if the frames coming from both cameras are
synchronized?

The reason I ask this is that, if you use the cameras on a robot and
you're trying to extract depth information from the two images and the
robot is moving, having two unsynchronized images is pretty much useless.

However, if they are synchronized, this would make a nice low cost
robotic stereoscopic vision system...

-- 
Paulo Marques
Software Development Department - Grupo PIE, S.A.
Phone: +351 252 290600, Fax: +351 252 290601
Web: www.grupopie.com

"Feed the hungry, save the whales, free the mallocs!"


From andrej at podzimek.org  Tue Feb 17 15:19:05 2009
From: andrej at podzimek.org (Andrej Podzimek)
Date: Tue, 17 Feb 2009 15:19:05 +0100
Subject: [Linux-uvc-devel] QuickCam Orbit AF does not work
Message-ID: <499AC759.4020409@podzimek.org>

Hello,

I'm trying to make my new webcam work with uvcvideo. The model I use 
should work fine according to the hardware compatibility list. 
Unfortunately, this is not true in my case.

This is what dmesg says after I plug in the camera:

    usb 1-2: new high speed USB device using ehci_hcd and address 3
    usb 1-2: configuration #1 chosen from 1 choice
    v4l1_compat: module is already loaded
    videodev: exports duplicate symbol video_unregister_device (owned by 
kernel)
    usbcore: registered new interface driver snd-usb-audio
    v4l1_compat: module is already loaded
    videodev: exports duplicate symbol video_unregister_device (owned by 
kernel)
    uvcvideo: Found UVC 1.00 device <unnamed> (046d:0994)
    videodev: "?2?" has no release callback. Please fix your driver for 
proper sysfs support, see http://lwn.net/Articles/36850/
    input: UVC Camera (046d:0994) as /class/input/input9
    usbcore: registered new interface driver uvcvideo

I haven't found any program that would detect the camera. Tried Cheese, 
Ekiga, Skype, Kopete and VLC... All of them either crash or freeze. This 
is what I see in dmesg when I try to open the camera with VLC:

    USB Video Class driver (v0.1.0)
    BUG: unable to handle kernel paging request at 0c060b02
    IP: [<0c060b02>]
    *pde = 00000000
    Oops: 0000 [#1] PREEMPT
    Modules linked in: uvcvideo snd_usb_audio snd_usb_lib snd_rawmidi 
snd_hwdep ipv6 aes_i586 aes_generic ieee80211_crypt_ccmp bnep sco l2cap 
bluetooth rng_core video output ohci1394 ieee1394 tun ipw2200 ieee80211 
ieee80211_crypt 8139too mii lp usbhid ppdev       parport_pc parport 
uhci_hcd ohci_hcd evdev ehci_hcd usbcore i915 drm pcspkr snd_intel8x0m 
snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device snd_pcm_oss 
snd_mixer_oss snd_intel8x0 snd_ac97_codec ac97_bus snd_pcm 
snd_page_alloc snd_rtctimer snd_timer snd soundcore rtc psmouse nsc_ircc 
irda crc_ccitt cpufreq_ondemand pcmcia yenta_socket rsrc_nonstatic 
pcmcia_core asus_laptop backlight speedstep_centrino freq_table lm90 
hwmon i2c_i801

    Pid: 11777, comm: vlc Not tainted (2.6.27.17-AP #2)
    EIP: 0060:[<0c060b02>] EFLAGS: 00010202 CPU: 0
    EIP is at 0xc060b02
    EAX: c29fa180 EBX: 0c060b02 ECX: ae08dd14 EDX: 80685600
    ESI: c29fa180 EDI: ae08dd14 EBP: 80685600 ESP: ed7a6f68
     DS: 007b ES: 007b FS: 0000 GS: 0033 SS: 0068
    Process vlc (pid: 11777, ti=ed7a6000 task=c3418e00 task.ti=ed7a6000)
    Stack: c018fccb d3e2459c c29fa180 fffffff7 0000001c ed7a6000 
c018fd97 00000000
           00000000 c29fa180 fffffff7 0000001c ed7a6000 c019006d 
ae08dd14 00000001
           0000001c 00000000 00000000 c010327d 0000001c 80685600 
ae08dd14 00000000
    Call Trace:
     [<c018fccb>] vfs_ioctl+0x2b/0x90
     [<c018fd97>] do_vfs_ioctl+0x67/0x300
     [<c019006d>] sys_ioctl+0x3d/0x70
     [<c010327d>] sysenter_do_call+0x12/0x25
     =======================
    Code:  Bad EIP value.
    EIP: [<0c060b02>] 0xc060b02 SS:ESP 0068:ed7a6f68
    ---[ end trace 94bdb257045f4ef3 ]---

I use a vanilla kernel 2.6.27.17 with Reiser4 and Suspend2 patches. My 
machine is a Asus M2400N laptop. This is modinfo uvcvideo with all the 
version numbers and kernel details:

    filename:       
/lib/modules/2.6.27.17-AP/kernel/drivers/media/video/uvc/uvcvideo.ko
    version:        v0.1.0
    license:        GPL
    description:    USB Video Class driver
    author:         Laurent Pinchart <laurent.pinchart at skynet.be>
    srcversion:     28AC4F0572EC0186788A86D
    alias:          usb:v*p*d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v1C4Fp3000d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v19ABp1000d00*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v19ABp1000d01[0-1]*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v19ABp1000d012[0-6]dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v18CDpCAFEd*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v17EFp480Bd*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v174Fp8A33d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v174Fp8A31d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v174Fp5931d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v174Fp5212d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v0E8Dp0004d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v0AC8p*d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v05E3p0505d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v05ACp8501d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v058Fp3820d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v046Dp08C7d*dc*dsc*dp*icFFisc01ip00*
    alias:          usb:v046Dp08C6d*dc*dsc*dp*icFFisc01ip00*
    alias:          usb:v046Dp08C5d*dc*dsc*dp*icFFisc01ip00*
    alias:          usb:v046Dp08C3d*dc*dsc*dp*icFFisc01ip00*
    alias:          usb:v046Dp08C2d*dc*dsc*dp*icFFisc01ip00*
    alias:          usb:v046Dp08C1d*dc*dsc*dp*icFFisc01ip00*
    alias:          usb:v045Ep0723d*dc*dsc*dp*ic0Eisc01ip00*
    alias:          usb:v045Ep00F8d*dc*dsc*dp*ic0Eisc01ip00*
    depends:        usbcore
    vermagic:       2.6.27.17-AP preempt mod_unload PENTIUMM 4KSTACKS
    parm:           nodrop:Don't drop incomplete frames (uint)
    parm:           quirks:Forced device quirks (uint)
    parm:           trace:Trace level bitmask (uint)

According to the device list, this webcam should just work. So there 
must be something I'm doing wrong. A piece of good advice would help me 
a lot.

Regards,

Andrej Podzimek



From kollix at aon.at  Tue Feb 17 19:26:30 2009
From: kollix at aon.at (Martin Koller)
Date: Tue, 17 Feb 2009 19:26:30 +0100
Subject: [Linux-uvc-devel] Device ID of my UVC WebCam
In-Reply-To: <200902161127.39505.laurent.pinchart@skynet.be>
References: <200902160840.36220.kollix@aon.at>
	<200902161127.39505.laurent.pinchart@skynet.be>
Message-ID: <200902171926.31109.kollix@aon.at>

Hi Laurent,

On Monday 16 February 2009, Laurent Pinchart wrote:
> Hi Martin
> 
> On Monday 16 February 2009 08:40:36 Martin Koller wrote:
> > Hi,
> >
> > In my Acer Aspire 7730ZG-343G32Mn Notebook, the webcam delivers the
> > following lsusb -v output:
> >
> > Bus 004 Device 002: ID 064e:a103 Suyin Corp.
> > Device Descriptor:
> >   bLength                18
> >   bDescriptorType         1
> >   bcdUSB               2.00
> >   bDeviceClass          239 Miscellaneous Device
> >   bDeviceSubClass         2 ?
> >   bDeviceProtocol         1 Interface Association
> >   bMaxPacketSize0        64
> >   idVendor           0x064e Suyin Corp.
> >   idProduct          0xa103
> >   bcdDevice            1.00
> >   iManufacturer           2 SuYin
> >   iProduct                1 Acer Crystal Eye webcam
> >   iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02
> >
> > Please add it to the Supported devices list.
> 
> Should I assume you've tested the camera and it works ?

Sorry for being not clear. Yes, the camera works.
I've tested it with luvcview.

> > (I use openSuse 11.1, kernel 2.6.27.7-9-pae)
> 
> Could you please provide the complete output of
> 
> lsusb -v -d 064e:a103

Attached.

-- 
Best regards/Sch?ne Gr??e

Martin    ()  ascii ribbon campaign - against html mail 
          /\                        - against microsoft attachments
-------------- next part --------------

Bus 004 Device 002: ID 064e:a103 Suyin Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x064e Suyin Corp.
  idProduct          0xa103 
  bcdDevice            1.00
  iManufacturer           2 SuYin
  iProduct                1 Acer Crystal Eye webcam
  iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          544
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 Acer Crystal Eye webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 Acer Crystal Eye webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          104
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            3
        bmControls     0x000025bf
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Component
          Backlight Compensation
          Power Line Frequency
          White Balance Component, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      297
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 0
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  3072000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  1013760
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   768000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   253440
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   192000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090217/53cf16e0/attachment.pgp>

From andrej at podzimek.org  Wed Feb 18 04:26:10 2009
From: andrej at podzimek.org (Andrej Podzimek)
Date: Wed, 18 Feb 2009 04:26:10 +0100
Subject: [Linux-uvc-devel] QuickCam Orbit AF does not work (even with 2.6.28)
Message-ID: <499B7FD2.80901@podzimek.org>

Hello,

I switched to kernel 2.6.28.6 (vanilla) hoping that my camera could work this time. This is what I got:

usb 1-2.2: new high speed USB device using ehci_hcd and address 9
usb 1-2.2: configuration #1 chosen from 1 choice
v4l1_compat: module is already loaded
videodev: exports duplicate symbol video_unregister_device (owned by kernel)
usbcore: registered new interface driver snd-usb-audio
v4l1_compat: module is already loaded
videodev: exports duplicate symbol video_unregister_device (owned by kernel)
uvcvideo: Found UVC 1.00 device <unnamed> (046d:0994)
------------[ cut here ]------------
kernel BUG at drivers/media/video/v4l2-dev.c:229!
invalid opcode: 0000 [#1] PREEMPT
last sysfs file: /sys/devices/pci0000:00/0000:00:1d.7/usb1/1-2/1-2.2/1-2.2:1.2/bInterfaceProtocol
Modules linked in: uvcvideo(+) snd_usb_audio snd_usb_lib snd_rawmidi snd_hwdep ipv6 aes_i586 aes_generic ieee80211_crypt_ccmp rfcomm bnep sco l2cap btusb bluetooth usbhid rng_core video output ohci1394 ieee1394 tun ipw2200 ieee80211 ieee80211_crypt 8139too mii lp ppdev parport_pc parport uhci_hcd ohci_hcd ehci_hcd usbcore i915 drm pcspkr snd_intel8x0m evdev snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device snd_intel8x0 snd_ac97_codec snd_pcm_oss snd_mixer_oss ac97_bus snd_pcm snd_page_alloc snd_rtctimer snd_timer snd soundcore rtc psmouse nsc_ircc irda crc_ccitt cpufreq_ondemand pcmcia yenta_socket rsrc_nonstatic pcmcia_core asus_laptop backlight speedstep_centrino freq_table lm90 hwmon i2c_i801

Pid: 12352, comm: modprobe Not tainted (2.6.28.6-AP #1) M2N
EIP: 0060:[<c02c3d9c>] EFLAGS: 00010246 CPU: 0
EIP is at video_register_device_index+0x42c/0x430
EAX: 00000000 EBX: 00000000 ECX: ffffffff EDX: 00000000
ESI: c1c52c00 EDI: ffffffff EBP: c9885a80 ESP: d6ba4c70
 DS: 007b ES: 007b FS: 0000 GS: 0033 SS: 0068
Process modprobe (pid: 12352, ti=d6ba4000 task=db564000 task.ti=d6ba4000)
Stack:
 810da8a0 00000001 ed805054 00000081 ed805000 c988552c ed805064 ed805054
 ed805054 00000292 c1c52c00 ed805000 ed805054 c9885a80 c02c3daf ffffffff
 f04f2a1d f04f9bb0 00000001 00000000 f04fb196 0000046d 00000994 ed805000
Call Trace:
 [<c02c3daf>] video_register_device+0xf/0x20
 [<f04f2a1d>] uvc_probe+0xa2d/0xd60 [uvcvideo]
 [<f009babc>] usb_probe_interface+0xac/0x160 [usbcore]
 [<c02be387>] driver_probe_device+0x87/0x1b0
 [<f009ae69>] usb_match_id+0x49/0x70 [usbcore]
 [<c02be539>] __driver_attach+0x89/0x90
 [<c02bdc64>] bus_for_each_dev+0x44/0x70
 [<c02be216>] driver_attach+0x16/0x20
 [<c02be4b0>] __driver_attach+0x0/0x90
 [<c02bd5ef>] bus_add_driver+0x1bf/0x240
 [<c02be6cc>] driver_register+0x5c/0x130
 [<f009bd9a>] usb_register_driver+0x7a/0xf0 [usbcore]
 [<f0501000>] uvc_init+0x0/0x86 [uvcvideo]
 [<f0501000>] uvc_init+0x0/0x86 [uvcvideo]
 [<f050106d>] uvc_init+0x6d/0x86 [uvcvideo]
 [<c023dae2>] ida_get_new_above+0x82/0x210
 [<c0101126>] do_one_initcall+0x36/0x1b0
 [<c01cf8b0>] sysfs_ilookup_test+0x0/0x10
 [<c01cfcf1>] __sysfs_add_one+0x11/0xa0
 [<c01d00b4>] sysfs_addrm_finish+0x14/0x240
 [<c01775c0>] __vunmap+0xb0/0xe0
 [<c0147fd2>] load_module+0x12e2/0x1450
 [<c011b2b6>] update_curr+0x136/0x1a0
 [<c011f5d5>] finish_task_switch+0x95/0xc0
 [<c011f5d5>] finish_task_switch+0x95/0xc0
 [<c011f5d5>] finish_task_switch+0x95/0xc0
 [<c03aa3d9>] schedule+0x1e9/0x390
 [<c014829b>] sys_init_module+0x8b/0x1b0
 [<c01033cd>] sysenter_do_call+0x12/0x25
Code: 64 0e 00 e9 c5 fe ff ff bf 60 0f 3d c0 89 7c 24 04 c7 04 24 9c 48 44 c0 e8 1a 64 0e 00 8b 44 24 14 e8 89 66 ec ff e9 a2 fe ff ff <0f> 0b eb fe 83 ec 04 c7 04 24 ff ff ff ff e8 c1 fb ff ff 5a c3
EIP: [<c02c3d9c>] video_register_device_index+0x42c/0x430 SS:ESP 0068:d6ba4c70
---[ end trace ad37cc8929c6494c ]---

Feel free to ask for more debug info.

I guess snd-usb-audio needs some options or quirks here. KMix shows a new USB audio device, but the first attempt to change its volume blocks the mixer channel. Audacity recorded about half a second of weird noise from the webcam before the sound input got interrupted for some reason.

Tried the old workaround that forces snd-usb-audio to be loaded before uvcvideo. The problem seems to persist and the error messages are similar.

Plugging and unplugging the camera multiple times seems to crash the whole USB controller. Even my keyboard and mouse stopped working. Fortunately, my laptop's internal keyboard still works. ;-) Error -71 was reported. (Excessive electromagnetic noise in the cable...? That's weird.)

Should I report this to the kernel bugzilla? If you want me to carry out more webcam experiments, I'm ready to help.

Regards,

Andrej Podzimek


From laurent.pinchart at skynet.be  Wed Feb 18 15:37:49 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 18 Feb 2009 15:37:49 +0100
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
Message-ID: <200902181537.49176.laurent.pinchart@skynet.be>

Hi Gilles,

sorry for the late reply.

On Sunday 08 February 2009 05:06:25 Gilles GIGAN wrote:
> Hi,
> I have checked out the latest v4l code from the mercurial repository on
> linuxtv.org, and successfully compiled and loaded the uvcvideo module,
> which I tested with a logitech quickcam sphere af (046d:0994). I have
> comments and questions regarding the V4L2 controls to pilot the pan and
> tilt motors: After mapping the dynamic controls (with uvcdynctrl), the
> following controls become available:
> - Pan Reset: min: 0, max: 1, step: 1, type: integer
> - Tilt Reset: min 0, max: 1, step: 0, type: integer (note the step value of
> 0 which should really be 1 here)
> - Pan (Relative): min: 4480, max: 4480, step: 1, type: integer
> - Tilt (Relative): min: 1920, max: 1920, step: 1, type: integer
> - Pan/tilt Reset: min: 0, max: 3, step: 1, type: integer
> Creating a user interface based on these controls is quite hard because of
> their types and step values:
> Trying to set a value of 0 on any of the Reset controls fails, even though
> 0 is reported as an acceptable value.
> Setting a value of 1 on either Pan (Relative) or Tilt (Relative) succeeds
> but results in no movement.
> Keeping the GUI up-to-date is not possible because calling
> ioctl(VIDIOC_G_CTRL) on any of these controls fails (which makes sense when
> you know what the controls are). But from a programming point of view, if
> you try to create an interface that will work with any controls, the way
> these are reported (integers) makes it almost impossible to keep track of.
> I have a couple of suggestions to improve this, and would appreciate
> comments on them:
> - Reporting the Pan/Tilt Reset control as a menu and Pan Reset and Tilt
> Reset as buttons instead of integers, will solve the previously mentioned
> issues.

Agreed. Pan Reset and Tilt Reset controls should be reported as buttons. The 
Pan/Tilt Reset control should in my opinion go away.

> - Change the Pan (Relative) and Tilt (relative) step value to one that
> actually results in a slight movement of the camera.

Now this is gonna be trickier. The step value is reported by the device 
itself, and it seems the device gets it wrong :-/

> Is there a way to make these changes when mapping the controls, or do they
> have to be coded in the driver itself ?

Switching the Pan Reset and Tilt Reset from integers to button should require 
a modification of the logitech.xml file only (although it might also trigger 
bugs in yet unused code paths of libwebcam/uvcdynctrl).

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 18 15:43:22 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 18 Feb 2009 15:43:22 +0100
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <78877a450902081620i38b6e235hc8447a5c426a6e9e@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
	<78877a450902081618qeb54395j5cafd6174b1cb08d@mail.gmail.com>
	<78877a450902081620i38b6e235hc8447a5c426a6e9e@mail.gmail.com>
Message-ID: <200902181543.22134.laurent.pinchart@skynet.be>

Hi Gilles,

On Monday 09 February 2009 01:20:15 Gilles GIGAN wrote:
> Hi Paulo,
> I had a look at guvcview. I think it s a great app, full of features beyond
> a simple frame view/capturing. Great work.
> I am trying to write an application that properly displays V4L controls
> from any driver, and I have tested with pwc and uvcvideo so far. Digging
> into guvcview's source code confirmed what the point I made in my previous
> post: img_controls.c, which draws controls on the screen, is full of
> if..else if statements which do a lot more than just checking the control
> type. There are also some hardcoded menu values for the raw pixel order.
> This is precisely what I think should be done differently:
> In my opinion, when enumerating V4L controls, user applications should NOT
> have to check what a control DOES, ie trying to make sense of either the
> v4l2_queryctrl.name or v4l2_queryctrl.id field (which is what guvcview
> does), in order to draw this control on the screen. Doing this ties your
> application to a specific driver/implementation/version/... and will
> require more coding when any of these changes. An application should only
> have to check what TYPE the control is (v4l2_queryctrl.type field, and
> possibly enumerate over the different menu values if it is a menu), to
> decide how to best draw it in a GUI. The driver shoud be responsible for
> filling in the struct v4l2_queryctrl correctly with meaningful & sensible
> values, and provide a menu for controls that require one. Let me know if my
> understanding is flawed somewhere in here.

Your understanding is correct. An application should be able to create a 
usable GUI from information retrieved from the driver. Now, if the application 
wants to make the GUI more userfriendly, or deal with some rare corner cases, 
I expected some controls will have to be handled in a non-generic way. This 
should remain an exception though.

> The V4L2 spec lists the Pan Reset and Tilt Reset as Booleans, which is
> already a bit better than Integer (what uvcvideo does so far),

For the sake of correctness, the controls are reported as integers by the 
uvcvideo driver because they have been configured as such by the userspace 
uvcdynctrl utility based on the information provided by the logitech.xml 
configuration file.

> although I stick to my comment in my previous post: I really think these
> should be reported as Buttons for the obvious reason that resetting the pan
> or tilt is a one-shot action, not a continuous one which holds a value over
> time (this fits the definition of V4L2_CTRLTYPE_BUTTON in the specs). Using
> a button type makes it clear that trying to get its value is pointless, and
> it also makes sense when drawing this control on a GUI. I will bring this
> up on the V4L mailing list but I thought I d throw this one here first and
> see what people think.

Agreed.

> The V4L2 spec says the step value "gives the smallest change of an integer
> control actually affecting hardware". Calling ioctl(VIDIOC_G_CTRL) on the
> Pan or Tilt Relative control with a value of 1, as per reported step value,
> does not do anything. Both guvcview and luvcview get around that by
> defining a macro set to 64. Do applications really have to guess/do that,
> or can the driver simply report 64 as a step value ?

As stated in my previous mail, the camera itself reports erroneous values :-/

> The Pan/Tilt Reset control is a bit of a tricky one, because it is  a
> collection of buttons (Pan reset, Tilt reset or both). Since we already
> have dedicated controls for both Pan Reset and Tilt Reset, is it a good
> idea change this one to "Pan & Tilt Reset" only, so it can be presented as
> a button ? If not, can this control have a menu explaining the different
> acceptable values ?

The control should in my opinion be removed completely.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 18 15:57:18 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 18 Feb 2009 15:57:18 +0100
Subject: [Linux-uvc-devel] QuickCam Orbit AF does not work (even with
	2.6.28)
In-Reply-To: <499B7FD2.80901@podzimek.org>
References: <499B7FD2.80901@podzimek.org>
Message-ID: <200902181557.18887.laurent.pinchart@skynet.be>

Hi Andrej,

On Wednesday 18 February 2009 04:26:10 Andrej Podzimek wrote:
> Hello,
>
> I switched to kernel 2.6.28.6 (vanilla) hoping that my camera could work
> this time. This is what I got:
>
> usb 1-2.2: new high speed USB device using ehci_hcd and address 9
> usb 1-2.2: configuration #1 chosen from 1 choice
> v4l1_compat: module is already loaded
> videodev: exports duplicate symbol video_unregister_device (owned by
> kernel) usbcore: registered new interface driver snd-usb-audio
> v4l1_compat: module is already loaded
> videodev: exports duplicate symbol video_unregister_device (owned by
> kernel) uvcvideo: Found UVC 1.00 device <unnamed> (046d:0994)

[snip]

> Feel free to ask for more debug info.
>
> I guess snd-usb-audio needs some options or quirks here. KMix shows a new
> USB audio device, but the first attempt to change its volume blocks the
> mixer channel. Audacity recorded about half a second of weird noise from
> the webcam before the sound input got interrupted for some reason.
>
> Tried the old workaround that forces snd-usb-audio to be loaded before
> uvcvideo. The problem seems to persist and the error messages are similar.
>
> Plugging and unplugging the camera multiple times seems to crash the whole
> USB controller. Even my keyboard and mouse stopped working. Fortunately, my
> laptop's internal keyboard still works. ;-) Error -71 was reported.
> (Excessive electromagnetic noise in the cable...? That's weird.)
>
> Should I report this to the kernel bugzilla? If you want me to carry out
> more webcam experiments, I'm ready to help.

It seems you mixed a uvcvideo.ko module coming from a linuxtv.org tree with 
the videodev stock modules coming from your kernel. This isn't allowed and 
won't work.

linuxtv.org Mercurial trees come with their own version of the video4linux 
subsystem. You will need to disable v4l in your kernel and use the modules 
provided by the uvcvideo tree.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 18 16:01:56 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 18 Feb 2009 16:01:56 +0100
Subject: [Linux-uvc-devel] Device ID of my UVC WebCam
In-Reply-To: <200902171926.31109.kollix@aon.at>
References: <200902160840.36220.kollix@aon.at>
	<200902161127.39505.laurent.pinchart@skynet.be>
	<200902171926.31109.kollix@aon.at>
Message-ID: <200902181601.56987.laurent.pinchart@skynet.be>

Hi Martin,

On Tuesday 17 February 2009 19:26:30 Martin Koller wrote:
> Hi Laurent,
> On Monday 16 February 2009, Laurent Pinchart wrote:
> > Hi Martin
> > On Monday 16 February 2009 08:40:36 Martin Koller wrote:
> > > Hi,
> > >
> > > In my Acer Aspire 7730ZG-343G32Mn Notebook, the webcam delivers the
> > > following lsusb -v output:
> > >
> > > Bus 004 Device 002: ID 064e:a103 Suyin Corp.
> > > Device Descriptor:
> > >   bLength                18
> > >   bDescriptorType         1
> > >   bcdUSB               2.00
> > >   bDeviceClass          239 Miscellaneous Device
> > >   bDeviceSubClass         2 ?
> > >   bDeviceProtocol         1 Interface Association
> > >   bMaxPacketSize0        64
> > >   idVendor           0x064e Suyin Corp.
> > >   idProduct          0xa103
> > >   bcdDevice            1.00
> > >   iManufacturer           2 SuYin
> > >   iProduct                1 Acer Crystal Eye webcam
> > >   iSerial                 3 CN0314-SN30-OV03-VA-R02.03.02
> > >
> > > Please add it to the Supported devices list.
> >
> > Should I assume you've tested the camera and it works ?
>
> Sorry for being not clear. Yes, the camera works.
> I've tested it with luvcview.
>
> > > (I use openSuse 11.1, kernel 2.6.27.7-9-pae)
> >
> > Could you please provide the complete output of
> >
> > lsusb -v -d 064e:a103
>
> Attached.

Thanks. I've updated the website.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 18 16:08:56 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 18 Feb 2009 16:08:56 +0100
Subject: [Linux-uvc-devel]
 =?iso-8859-1?q?=5BANNOUNCE=5D_Minoru3D_camera_s?=
 =?iso-8859-1?q?upported_by_the_Linux=09UVC_driver?=
In-Reply-To: <499AB24B.2010900@grupopie.com>
References: <200902162238.06526.laurent.pinchart@skynet.be>
	<499AB24B.2010900@grupopie.com>
Message-ID: <200902181608.56531.laurent.pinchart@skynet.be>

Hi Paulo,

On Tuesday 17 February 2009 13:49:15 Paulo Marques wrote:
> Laurent Pinchart wrote:
> > Hi everybody,
>
> Hi, Laurent
>
> > [...]
> > The latest Linux UVC driver supports streaming from both cameras
> > simultaneously at 30fps (up to 320x240) or 15fps (up to 640x480). You can
> > download it from the Linux UVC Mercurial repository
> > (http://linuxtv.org/hg/~pinchartl/uvcvideo) or wait for Linux 2.6.30.
>
> Do you happen to know if the frames coming from both cameras are
> synchronized?

Short answer, I don't know.

> The reason I ask this is that, if you use the cameras on a robot and
> you're trying to extract depth information from the two images and the
> robot is moving, having two unsynchronized images is pretty much useless.
>
> However, if they are synchronized, this would make a nice low cost
> robotic stereoscopic vision system...

Still short answer, try it :-)

UVC devices send timing information along with video data. This can be used to 
synchronize the device internal clock with the host clock. The UVC driver 
doesn't implement that feature, and I'll be happy if someone wants to give it 
a go and submit a patch.

Cheers,

Laurent Pinchart



From pj.assis at gmail.com  Thu Feb 19 11:44:15 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 19 Feb 2009 10:44:15 +0000
Subject: [Linux-uvc-devel] guvcview bug
Message-ID: <499D37FF.8000703@gmail.com>

Hi,
I seems recent changes to guvcview code have caused at least one, :-) ,
little bug on.
If it exits with format unavailable, and you know that the format is
supported, currently: 'yuvy' 'uyvy' 'yyuv' 'yu12' 'gbrg' 'jpeg' 'mjpg'
please just force the format with guvcview --format=FOURCC, where FOURCC
is one of the above.
Available device formats are listed in the output. e.g  for:
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }

just run: guvcview --format=yuyv

I've never encounter this problem myself, but it has been reported a
couple of times, by first time users, you just need to this once since
the new format will be set on the configuration file. (the default is
mjpg, so this will only happen in devices where this format is unavailable)
I will try to fix this for the next release.

Best regards,
Paulo


From pj.assis at gmail.com  Thu Feb 19 15:29:21 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 19 Feb 2009 14:29:21 +0000
Subject: [Linux-uvc-devel] guvcview format detection bug
Message-ID: <499D6CC1.1080503@gmail.com>

Hi,
The bug described in my previous post should be fixed in svn now.
Anyone with a device that doesn't support mjpg, could you please remove
your configuration file (.guvcviewrc or .guvciewrc-deviceN) and test the
latest svn revision:

svn checkout http://svn.berlios.de/svnroot/repos/guvcview/trunk

PS: The bug was pretty dumb (like most of them), I was updating all of
the collected device information except the most important , v4l2 pixel
format.

Best regards,
Paulo


From pgorbett at usc.edu.au  Thu Feb 19 17:36:13 2009
From: pgorbett at usc.edu.au (Phil Gorbett)
Date: Fri, 20 Feb 2009 02:36:13 +1000
Subject: [Linux-uvc-devel] Dell SP2309W Monitor webcam
Message-ID: <1235061373.32390.39.camel@sundance.localdomain>

Hi there,

Dell's new wide screen monitor has an integrated webcam with a
two-microphone array.  Googling about, it appears that no one has yet
got the mic's working.  While the webcam video works a treat in
guvcview, the audio input does not show the webcam usbaudio.  I have
been able to get the webcam usbaudio to show up as being active in
alsamixer, but tests of the mic capture fails with the error:

gconfaudiosrc ! audioconvert ! audioresample ! gconfaudiosink
profile=chat: Could not get/set settings from/on resource.

The camera device itself is an Omivision with ID 05a9:2649.  The lsusb
simple output lists two additional devices - 0424:2514 and 0424:2512,
both SMC devices and both listed as USB hubs in lsusb -v.  I have
attached three addition files - outputs from lsusb -d -v for all three
devices.  The output for the camera itself, i.e., 2649, indicates audio
functionality.  The uvcvideo supported devices list indicates that while
both 2640 and 2646 Omivision webcams are supported, this particular
device (2649) is not.

There seems to be a view from people having similar difficulty that the
SMC devices are the mics, but it appears to me that these are just the
USB interfaces and that the webcam driver itself provides audio
functionality.

Any insights you have would be greatly appreciated by myself - and a
number of other people - with what is otherwise an excellent monitor.

Cheers,
PG
-------------- next part --------------

Bus 001 Device 008: ID 0424:2512 Standard Microsystems Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         1 Single TT
  bMaxPacketSize0        64
  idVendor           0x0424 Standard Microsystems Corp.
  idProduct          0x2512 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                0 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                2mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              12
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x000d
    Per-port power switching
    Compound device
    Per-port overcurrent protection
    TT think time 8 FS bits
  bPwrOn2PwrGood       50 * 2 milli seconds
  bHubContrCurrent      1 milli Ampere
  DeviceRemovable    0x06
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0503 highspeed power enable connect
   Port 2: 0000.0503 highspeed power enable connect
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0001
  Self Powered
-------------- next part --------------

Bus 001 Device 009: ID 0424:2514 Standard Microsystems Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         2 TT per port
  bMaxPacketSize0        64
  idVendor           0x0424 Standard Microsystems Corp.
  idProduct          0x2514 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                0 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           41
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                2mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      1 Single TT
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              12
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      2 TT per port
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0001  1x 1 bytes
        bInterval              12
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             4
  wHubCharacteristic 0x000d
    Per-port power switching
    Compound device
    Per-port overcurrent protection
    TT think time 8 FS bits
  bPwrOn2PwrGood       50 * 2 milli seconds
  bHubContrCurrent      1 milli Ampere
  DeviceRemovable    0x02
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0303 lowspeed power enable connect
   Port 2: 0000.0303 lowspeed power enable connect
   Port 3: 0000.0100 power
   Port 4: 0000.0100 power
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0001
  Self Powered
-------------- next part --------------

Bus 001 Device 010: ID 05a9:2649 OmniVision Technologies, Inc. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x05a9 OmniVision Technologies, Inc.
  idProduct          0x2649 
  bcdDevice           89.09
  iManufacturer           1 OmniVision Technologies, Inc.538-2640-08.09.09.1
  iProduct                2 Monitor Webcam
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          969
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              200mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               2 Monitor Webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              2 Monitor Webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          110
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 4
        bNrInPins               1
        baSource( 0)            1
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               4
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000157f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x1a
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 7
        guidExtensionCode         {8a0f88dd-ba1c-5449-8a25-f7875967f0f7}
        bNumControl             1
        bNrPins                 1
        baSourceID( 0)          1
        bControlSize            1
        bmControls( 0)       0x01
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 6
        guidExtensionCode         {6a108077-3202-dc11-8314-0800200c9a66}
        bNumControl             7
        bNrPins                 1
        baSourceID( 0)          1
        bControlSize            2
        bmControls( 0)       0xaf
        bmControls( 1)       0x01
        iExtension              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval              16
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      669
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    11
        bmaControls( 1)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                9
        bFlags                              1
          Fixed-size samples: Yes
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 73728000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  4608000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  6082560
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 18432000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 24330240
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                115200000
        dwMaxBitRate                230400000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 94371840
        dwMaxBitRate                188743680
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  2
        dwFrameInterval( 0)            666666
        dwFrameInterval( 1)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                314572800
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  2
        dwFrameInterval( 0)            666666
        dwFrameInterval( 1)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         9
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                230400000
        dwMaxBitRate                460800000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  2
        dwFrameInterval( 0)            666666
        dwFrameInterval( 1)           1333333
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                9
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 73728000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  4608000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  6082560
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 18432000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 24330240
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            800
        wHeight                           600
        dwMinBitRate                 57600000
        dwMaxBitRate                115200000
        dwMaxVideoFrameBufferSize      960000
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  2
        dwFrameInterval( 0)            666666
        dwFrameInterval( 1)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 94371840
        dwMaxBitRate                150994944
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval         833333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            833333
        dwFrameInterval( 1)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                157286400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         9
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                153600000
        dwMaxBitRate                153600000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2000000
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13fc  3x 1020 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       1 Control Device
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           43
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0205 Microphone Array
        bAssocTerminal          0
        bNrChannels             2
        wChannelConfig     0x0000
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 3
        bSourceID               1
        bControlSize            2
        bmaControls( 0)      0x43
        bmaControls( 0)      0x02
          Mute
          Volume
          Automatic Gain
          Loudness
        bmaControls( 1)      0x00
        bmaControls( 1)      0x00
        bmaControls( 2)      0x00
        bmaControls( 2)      0x00
        iFeature                0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           2
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             2
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            6 Discrete
        tSamFreq[ 0]        48000
        tSamFreq[ 1]        44100
        tSamFreq[ 2]        32000
        tSamFreq[ 3]        24000
        tSamFreq[ 4]        16000
        tSamFreq[ 5]         8000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes           13
          Transfer Type            Isochronous
          Synch Type               Synchronous
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)

From gilles.gigan at gmail.com  Thu Feb 19 23:38:32 2009
From: gilles.gigan at gmail.com (Gilles GIGAN)
Date: Fri, 20 Feb 2009 09:38:32 +1100
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <200902181537.49176.laurent.pinchart@skynet.be>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
	<200902181537.49176.laurent.pinchart@skynet.be>
Message-ID: <78877a450902191438t5b40329fv40e589c84b9ade48@mail.gmail.com>

Laurent,

>
> > Is there a way to make these changes when mapping the controls, or do
> they
> > have to be coded in the driver itself ?
>
> Switching the Pan Reset and Tilt Reset from integers to button should
> require
> a modification of the logitech.xml file only (although it might also
> trigger
> bugs in yet unused code paths of libwebcam/uvcdynctrl).


I gave that a go:
I changed  the v4l2_type element from V4L2_CTRL_TYPE_INTEGER to
V4L2_CTRL_TYPE_BUTTON for both the Pan Reset and Tilt Reset mappings.
Not sure how to get uvcvideo to unmap existing controls, so I rmmod/modprobe
(trace=1023) it, and confirmed it lacks these mappings. Then I had to modify
libwebcam to support the V4L2_CTRL_TYPE_BUTTON. To be precise, libwebcam
already had the code for that but it was commented out (lines 446 to 456 in
dynctrl.c). I then imported the dynamic controls with uvcdynctrl -i, and it
went fine. Pan & Tilt Reset are reported as buttons, but setting a value on
them does nothing and these lines are added to syslog:

 kernel: [57399.195259] v4l2 ioctl VIDIOC_S_CTRL, dir=rw (0xc008561c)
 kernel: [57399.202594] uvcvideo: Control 9/2 failure change len 6.

I m not sure what the implications of the change to V4L2_CTRL_TYPE_BUTTON
are (besides modifying the reported v4l2_queryctrl struct) within the driver
and the way it send control values to the device. Is it anything that can be
fixed ? If so how can I help ?
Gilles
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090220/8c96888d/attachment.html>

From rsaxvc at gmail.com  Fri Feb 20 03:39:57 2009
From: rsaxvc at gmail.com (Richard Allen)
Date: Thu, 19 Feb 2009 20:39:57 -0600
Subject: [Linux-uvc-devel] Linux-uvc-devel Digest, Vol 32, Issue 18
In-Reply-To: <mailman.2320.1235061386.20436.linux-uvc-devel@lists.berlios.de>
References: <mailman.2320.1235061386.20436.linux-uvc-devel@lists.berlios.de>
Message-ID: <c8402960902191839r49c51723q70dab5c1e852efe@mail.gmail.com>

I have a issue with the uvcvideo driver running on sparc64. The device comes
up as /dev/video0. I can take pictures using cheese(gnome app), but I cannot
access the device using opencv. I this problem may be related to the "kernel
unaligned memory access", but I haven't really looked into it. In any
reason, I figure you should be aligning your memory accesses anyhow, and
this may be of interest.

This affects both my 'Logitech Quickcam Pro', and 'Logitech Quickcam', I can
supply model numbers if needed. I've attached a dmesg log with the relevant
section.

My kernel is 2.6.26-1/sparc64/smp
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090219/f7b46858/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: UVCVideoKernelBug.rtf
Type: application/rtf
Size: 6243 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090219/f7b46858/attachment.rtf>

From roidelapluie at gmail.com  Sat Feb 21 19:58:02 2009
From: roidelapluie at gmail.com (Pivo)
Date: Sat, 21 Feb 2009 19:58:02 +0100
Subject: [Linux-uvc-devel] support for 05ca:183a
Message-ID: <fe0b26c40902211058r4e730792oe6f654ecc50f8ac7@mail.gmail.com>

Hi Laurent,
I have the same webcam, the same problems than petr but the problem is not
solve and I think you didn't get the answers you wanted.

> Hi Petr,
>
> On Monday 10 November 2008, Petr Men??k wrote:
> > hi,
> >
> > i found interesting news. my camera will change its resolution, but only
> > to 640x480 and 1280x1024 correctly. I was astonished when high
> > resolution worked, i did not expect that. I got working svn version of
> > luvcview, but really lower resolutions are still wrong in that also.
>
> Could you please send me the USB descriptors of your camera ? You can
retrieve
> them with 'lsusb -v'.

Bus 001 Device 002: ID 05ca:183b Ricoh Co., Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x05ca Ricoh Co., Ltd
  idProduct          0x183b
  bcdDevice            1.00
  iManufacturer           0
  iProduct                0
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          396
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              100mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              0
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           78
        dwClockFrequency       30.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          1
        bSourceID               4
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {1c624144-8989-4643-afb3-20f37590304e}
        bNumControl             1
        bNrPins                 1
        baSourceID( 0)          2
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          3
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            3
        bmControls     0x0000053f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      191
        bEndPointAddress                  134
        bmInfo                              1
        bTerminalLink                       3
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x02
          Interlaced stream or variable: No
          Fields per frame: 2 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                147456000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                157286400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 36864000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                 12165120
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  9216000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13d4  3x 980 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13ec  3x 1004 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0364  1x 868 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0278  1x 632 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


> > Yes, lower resolutions worked fine in ekiga before, i believe it is
> > using lowest one, 160x120.
>
> So there's probably a problem on the host side (or at least in the host
<->
> device communication). Your tests seem to point to the resolution change
not
> being understood by the camera.
>
> To confirm that, I'd like you to check the kernel log with the uvcvideo
trace
> parameter set to 128 (either when loading the driver, or later with 'echo
128
> > /sys/modules/uvcvideo/parameters/trace').

>
> Clear the kernel log (dmesg -c), run a video application in 640x480 for a
> second or two (longer would write too much messages to the log), close the

> application and capture the kernel log. Rerun the same test procedure in a

> lower, faulty resolution such as 320x240.

# luvcview -s 640x480 -f yuv -i 30
luvcview version 0.2.1
 size width: 640 height: 480
 interval: 30 fps
Video driver: x11
A window manager is available
video /dev/video0

Stop asked
 Clean Up done Quit

# dmesg
[20451.408588] uvcvideo: Frame complete (EOF found).
[20451.438601] uvcvideo: Frame complete (EOF found).
[20451.473589] uvcvideo: Frame complete (EOF found).
[20451.508575] uvcvideo: Frame complete (EOF found).
[20451.538596] uvcvideo: Frame complete (EOF found).
[20451.573583] uvcvideo: Frame complete (EOF found).
[20451.608585] uvcvideo: Frame complete (EOF found).
[20451.673620] uvcvideo: Frame complete (EOF found).
[20451.738601] uvcvideo: Frame complete (EOF found).
[20451.873623] uvcvideo: Frame complete (EOF found).
[20452.008584] uvcvideo: Frame complete (EOF found).
[20452.138638] uvcvideo: Frame complete (EOF found).
[20452.273605] uvcvideo: Frame complete (EOF found).
[20452.408576] uvcvideo: Frame complete (EOF found).
[20452.538635] uvcvideo: Frame complete (EOF found).
[20452.673607] uvcvideo: Frame complete (EOF found).
[20452.808574] uvcvideo: Frame complete (EOF found).
[20452.938600] uvcvideo: Frame complete (EOF found).
[20453.073578] uvcvideo: Frame complete (EOF found).
[20453.208535] uvcvideo: Frame complete (EOF found).
[20453.338595] uvcvideo: Frame complete (EOF found).
[20453.473590] uvcvideo: Frame complete (EOF found).
[20453.603653] uvcvideo: Frame complete (EOF found).
[20453.738619] uvcvideo: Frame complete (EOF found).
[20453.873587] uvcvideo: Frame complete (EOF found).
[20454.003620] uvcvideo: Frame complete (EOF found).
[20454.138615] uvcvideo: Frame complete (EOF found).
[20454.273582] uvcvideo: Frame complete (EOF found).
[20454.403646] uvcvideo: Frame complete (EOF found).
[20454.538612] uvcvideo: Frame complete (EOF found).
[20454.673581] uvcvideo: Frame complete (EOF found).
[20454.803637] uvcvideo: Frame complete (EOF found).
[20454.938611] uvcvideo: Frame complete (EOF found).
[20455.073570] uvcvideo: Frame complete (EOF found).
[20455.203595] uvcvideo: Frame complete (EOF found).
[20455.338602] uvcvideo: Frame complete (EOF found).
[20455.473571] uvcvideo: Frame complete (EOF found).
[20455.603626] uvcvideo: Frame complete (EOF found).
[20455.738599] uvcvideo: Frame complete (EOF found).
[20455.868638] uvcvideo: Frame complete (EOF found).
[20456.003625] uvcvideo: Frame complete (EOF found).
[20456.138594] uvcvideo: Frame complete (EOF found).

# luvcview -s 320x240 -f yuv -i 30
luvcview version 0.2.1
 size width: 320 height: 240
 interval: 30 fps
Video driver: x11
A window manager is available
video /dev/video0
^C
Stop asked
 Clean Up done Quit

# dmesg
[20516.062625] uvcvideo: Frame complete (overflow).
[20516.062637] uvcvideo: Dropping payload (out of sync).
[20516.062641] uvcvideo: Dropping payload (out of sync).
[20516.062645] uvcvideo: Dropping payload (out of sync).
[20516.062649] uvcvideo: Dropping payload (out of sync).
[20516.062653] uvcvideo: Dropping payload (out of sync).
[20516.062657] uvcvideo: Dropping payload (out of sync).
[20516.062661] uvcvideo: Dropping payload (out of sync).
[20516.062664] uvcvideo: Dropping payload (out of sync).
[20516.062668] uvcvideo: Dropping payload (out of sync).
[20516.062672] uvcvideo: Dropping payload (out of sync).
[20516.062676] uvcvideo: Dropping payload (out of sync).
[20516.062680] uvcvideo: Dropping payload (out of sync).
[20516.062684] uvcvideo: Dropping payload (out of sync).
[20516.062688] uvcvideo: Dropping payload (out of sync).
[20516.067540] uvcvideo: Dropping payload (out of sync).
[20516.067547] uvcvideo: Dropping payload (out of sync).
[20516.067551] uvcvideo: Dropping payload (out of sync).
[20516.067554] uvcvideo: Dropping payload (out of sync).
[20516.067558] uvcvideo: Dropping payload (out of sync).
[20516.067562] uvcvideo: Dropping payload (out of sync).
[20516.067566] uvcvideo: Dropping payload (out of sync).
[20516.067569] uvcvideo: Dropping payload (out of sync).
[20516.067573] uvcvideo: Dropping payload (out of sync).
[20516.067577] uvcvideo: Dropping payload (out of sync).
[20516.067581] uvcvideo: Dropping payload (out of sync).
[20516.067585] uvcvideo: Dropping payload (out of sync).
[20516.067589] uvcvideo: Dropping payload (out of sync).
[20516.067593] uvcvideo: Dropping payload (out of sync).
[20516.067596] uvcvideo: Dropping payload (out of sync).
[20516.067600] uvcvideo: Dropping payload (out of sync).
[20516.067604] uvcvideo: Dropping payload (out of sync).
[20516.067608] uvcvideo: Dropping payload (out of sync).
[20516.067612] uvcvideo: Dropping payload (out of sync).
[20516.067615] uvcvideo: Dropping payload (out of sync).
[20516.067619] uvcvideo: Dropping payload (out of sync).
[20516.067623] uvcvideo: Dropping payload (out of sync).
[20516.067627] uvcvideo: Dropping payload (out of sync).
[20516.067631] uvcvideo: Dropping payload (out of sync).

Many and many lines like that!

> If, as I suspect, the camera doesn't understand the resolution change
> properly, it should send a whole 640x480 frame even when the driver
expects a
> lower resolution. Excess video data should be dropped and logged by the
> driver with a "Dropping payload (out of sync)" message. Those messages
should
> not occur in 640x480 (or at least be way less frequent than in 320x240).

You are right!

> Best regards,
>
> Laurent Pinchart
>


Thank you for your time,

roidelapluie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090221/b617ee58/attachment.html>

From elitebadger at gmail.com  Mon Feb 23 00:17:51 2009
From: elitebadger at gmail.com (Nathan Baker)
Date: Sun, 22 Feb 2009 18:17:51 -0500
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics Imaging
	Division (VLSI Vision)
Message-ID: <49A1DD1F.6020206@gmail.com>

Hi all,

I have a webcam which isn't supported by uvc. I have tried for a while
but haven't managed to make it work.

Here is the lsusb -v output:
===
[nathan at ebisu ~] sudo lsusb -v
Bus 006 Device 008: ID 0553:0a02 STMicroelectronics Imaging Division
(VLSI Vision)
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0         8
  idVendor           0x0553 STMicroelectronics Imaging Division (VLSI
Vision)
  idProduct          0x0a02
  bcdDevice            1.00
  iManufacturer           1 5 button optical mouse with scroll wheel
  iProduct                3 5 button optical mouse with scroll wheel
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           34
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0xa0
      (Bus Powered)
      Remote Wakeup
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         3 Human Interface Device
      bInterfaceSubClass      1 Boot Interface Subclass
      bInterfaceProtocol      2 Mouse
      iInterface              0
        HID Device Descriptor:
          bLength                 9
          bDescriptorType        33
          bcdHID               1.10
          bCountryCode            0 Not supported
          bNumDescriptors         1
          bDescriptorType        34 Report
          wDescriptorLength      52
         Report Descriptors:
           ** UNAVAILABLE **
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval              10
Device Status:     0x0000
  (Bus Powered)
===

For reference, here is uname -a:
Linux ebisu 2.6.27.7-9-default #1 SMP 2008-12-04 18:10:04 +0100 x86_64
x86_64 x86_64 GNU/Linux

It was suggested on LinuxQuestions.org
(http://www.linuxquestions.org/questions/linux-hardware-18/cant-get-usb-webcam-to-work-706318/)
that I ask this mailing list for help.

Thanks,
Nathan



From linux-uvc at bachelorguy.com  Mon Feb 23 02:23:01 2009
From: linux-uvc at bachelorguy.com (ADFH)
Date: Mon, 23 Feb 2009 12:23:01 +1100
Subject: [Linux-uvc-devel] Supported camera: Aldi Traveler DC 8900
Message-ID: <20090223122301.5c2cfc44.linux-uvc@bachelorguy.com>

Awhile ago I posted about this..

Occasionally it'll lock up and I have to turn it off, turn it back on
again.. Also, to get it to play nice with skype, I have to use libv4l..

Using uvc driver with vanilla kernel 2.6.28.4, compiled from source.

Bus 004 Device 007: ID 0489:d00a Foxconn / Hon Hai 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0489 Foxconn / Hon Hai
  idProduct          0xd00a 
  bcdDevice            0.10
  iManufacturer           1 NT96611
  iProduct                2 USB Camera
  iSerial                 0 
  bNumConfigurations      1

The camera has NO configuration options (no brightness, saturation
etc.) in linux or in windows with supplied binary driver.
-- 



From linux-uvc at bachelorguy.com  Mon Feb 23 02:07:36 2009
From: linux-uvc at bachelorguy.com (ADFH)
Date: Mon, 23 Feb 2009 12:07:36 +1100
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
 Imaging Division (VLSI Vision)
In-Reply-To: <49A1DD1F.6020206@gmail.com>
References: <49A1DD1F.6020206@gmail.com>
Message-ID: <20090223120736.bedfec5d.linux-uvc@bachelorguy.com>

Hi,

> [nathan at ebisu ~] sudo lsusb -v
> Bus 006 Device 008: ID 0553:0a02 STMicroelectronics Imaging Division
> (VLSI Vision)
....
>   iManufacturer           1 5 button optical mouse with scroll wheel
>   iProduct                3 5 button optical mouse with scroll wheel
...
>       bInterfaceClass         3 Human Interface Device
>       bInterfaceSubClass      1 Boot Interface Subclass
>       bInterfaceProtocol      2 Mouse

This seems to be the USB details on your mouse, not your webcam..
When you plugged in your webcam, it showed ID 17a1:0118 (based upon
thread on messageboard link)..
This lsusb output above shows ID 0553:0a02 and talks about your mouse..

1. Plug the webcam in
2. Check dmesg output for the connected ID (Ie. 17a1:0118)
   Ie. $ dmesg | less
   ... jump to the bottom and look at the most recent USB connection messages
       for ID.. "q" to quit less..
3. Run lsusb -v and output to a text file
   Ie. $ sudo lsusb -v > /tmp/lsusb.txt
4. Search that text file (/tmp/lsusb.txt) for the ID you recorded earlier
5. Post everything from the line that says:
   Bus XXX Device XXX: ID XXXX:XXXX ..........
   ... through to the end of the output, or the next Bus XXX Device XXX
       line, whichever comes first

The webcam must be plugged in when you're running lsusb..


From elitebadger at gmail.com  Mon Feb 23 04:23:41 2009
From: elitebadger at gmail.com (Nathan Baker)
Date: Sun, 22 Feb 2009 22:23:41 -0500
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
 Imaging Division (VLSI Vision)
In-Reply-To: <20090223120736.bedfec5d.linux-uvc@bachelorguy.com>
References: <49A1DD1F.6020206@gmail.com>
	<20090223120736.bedfec5d.linux-uvc@bachelorguy.com>
Message-ID: <49A216BD.3060307@gmail.com>

Wow, sorry, I saw "imaging" and figured I had the right thing. My bad.

Here's the right one:

===
Bus 001 Device 015: ID 17a1:0118
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  idVendor           0x17a1
  idProduct          0x0118
  bcdDevice            1.00
  iManufacturer          64 TASCORP
  iProduct               77 USB2.0 WebCam
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           57
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0xc0
      Self Powered
    MaxPower               96mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         0 (Defined at Interface level)
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         0 (Defined at Interface level)
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass         0 (Defined at Interface level)
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03c0  1x 960 bytes
        bInterval               1
Device Status:     0x0000
  (Bus Powered)
===

Again, sorry for the fail.

Thanks,
Nathan


ADFH wrote:
> Hi,
>
>   
>> [nathan at ebisu ~] sudo lsusb -v
>> Bus 006 Device 008: ID 0553:0a02 STMicroelectronics Imaging Division
>> (VLSI Vision)
>>     
> ....
>   
>>   iManufacturer           1 5 button optical mouse with scroll wheel
>>   iProduct                3 5 button optical mouse with scroll wheel
>>     
> ...
>   
>>       bInterfaceClass         3 Human Interface Device
>>       bInterfaceSubClass      1 Boot Interface Subclass
>>       bInterfaceProtocol      2 Mouse
>>     
>
> This seems to be the USB details on your mouse, not your webcam..
> When you plugged in your webcam, it showed ID 17a1:0118 (based upon
> thread on messageboard link)..
> This lsusb output above shows ID 0553:0a02 and talks about your mouse..
>
> 1. Plug the webcam in
> 2. Check dmesg output for the connected ID (Ie. 17a1:0118)
>    Ie. $ dmesg | less
>    ... jump to the bottom and look at the most recent USB connection messages
>        for ID.. "q" to quit less..
> 3. Run lsusb -v and output to a text file
>    Ie. $ sudo lsusb -v > /tmp/lsusb.txt
> 4. Search that text file (/tmp/lsusb.txt) for the ID you recorded earlier
> 5. Post everything from the line that says:
>    Bus XXX Device XXX: ID XXXX:XXXX ..........
>    ... through to the end of the output, or the next Bus XXX Device XXX
>        line, whichever comes first
>
> The webcam must be plugged in when you're running lsusb..
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>   


From linux-uvc at bachelorguy.com  Mon Feb 23 05:03:45 2009
From: linux-uvc at bachelorguy.com (ADFH)
Date: Mon, 23 Feb 2009 15:03:45 +1100
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
 Imaging Division (VLSI Vision)
In-Reply-To: <49A216BD.3060307@gmail.com>
References: <49A1DD1F.6020206@gmail.com>
	<20090223120736.bedfec5d.linux-uvc@bachelorguy.com>
	<49A216BD.3060307@gmail.com>
Message-ID: <20090223150345.59093277.linux-uvc@bachelorguy.com>

Hi Nathan,

> Here's the right one:

Looking at http://linux-uvc.berlios.de/faq/ it would appear that your
camera doesn't say that it's USB Video Class compatible.

Ie. My camera shows:

$ sudo lsusb -vd 0489:d00a | grep "14 Video"
      bFunctionClass         14 Video
      bInterfaceClass        14 Video
      bInterfaceClass        14 Video

Yours doesn't have any Video class entries.

(Someone else feel free to chime in here if I've fluffed up my reading
of the doco)

Anthony


From elitebadger at gmail.com  Mon Feb 23 05:45:44 2009
From: elitebadger at gmail.com (Nathan Baker)
Date: Sun, 22 Feb 2009 23:45:44 -0500
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
 Imaging Division (VLSI Vision)
In-Reply-To: <20090223150345.59093277.linux-uvc@bachelorguy.com>
References: <49A1DD1F.6020206@gmail.com>	<20090223120736.bedfec5d.linux-uvc@bachelorguy.com>	<49A216BD.3060307@gmail.com>
	<20090223150345.59093277.linux-uvc@bachelorguy.com>
Message-ID: <49A229F8.7020908@gmail.com>

Hm, well, if it's not a uvc device, do you have any idea where I should
look to get the driver?

Thanks,
Nathan

ADFH wrote:
> Hi Nathan,
>
>   
>> Here's the right one:
>>     
>
> Looking at http://linux-uvc.berlios.de/faq/ it would appear that your
> camera doesn't say that it's USB Video Class compatible.
>
> Ie. My camera shows:
>
> $ sudo lsusb -vd 0489:d00a | grep "14 Video"
>       bFunctionClass         14 Video
>       bInterfaceClass        14 Video
>       bInterfaceClass        14 Video
>
> Yours doesn't have any Video class entries.
>
> (Someone else feel free to chime in here if I've fluffed up my reading
> of the doco)
>
> Anthony
>
>   


From linux-uvc at bachelorguy.com  Mon Feb 23 05:57:15 2009
From: linux-uvc at bachelorguy.com (ADFH)
Date: Mon, 23 Feb 2009 15:57:15 +1100
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
 Imaging Division (VLSI Vision)
In-Reply-To: <49A229F8.7020908@gmail.com>
References: <49A1DD1F.6020206@gmail.com>
	<20090223120736.bedfec5d.linux-uvc@bachelorguy.com>
	<49A216BD.3060307@gmail.com>
	<20090223150345.59093277.linux-uvc@bachelorguy.com>
	<49A229F8.7020908@gmail.com>
Message-ID: <20090223155715.a6c605f5.linux-uvc@bachelorguy.com>

Hi,

> Hm, well, if it's not a uvc device, do you have any idea where I
> should look to get the driver?

Unfortunately it looks like it's not supported by the GSPCA driver
either ... http://mxhaard.free.fr/spca5xx.html

You could try googling for the device ID - on cursory examination it
looks like there might be some other people trying as well.

Another thing to try is looking through the windows drivers for
manufacturer info and seeing if there's any google hits against the
listed manufacturer in the drivers ... +linux +webcam etc. etc.

Anthony


From juhovh at iki.fi  Mon Feb 23 06:18:00 2009
From: juhovh at iki.fi (=?ISO-8859-1?Q?Juho_V=E4h=E4-Herttua?=)
Date: Mon, 23 Feb 2009 13:18:00 +0800
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
 Imaging Division (VLSI Vision)
In-Reply-To: <49A229F8.7020908@gmail.com>
References: <49A1DD1F.6020206@gmail.com>
	<20090223120736.bedfec5d.linux-uvc@bachelorguy.com>
	<49A216BD.3060307@gmail.com>
	<20090223150345.59093277.linux-uvc@bachelorguy.com>
	<49A229F8.7020908@gmail.com>
Message-ID: <49A23188.7090301@iki.fi>

Nathan Baker wrote:
> Hm, well, if it's not a uvc device, do you have any idea where I should
> look to get the driver?

I'll start with a small rant. If you're coming from this thread:
http://www.linuxquestions.org/questions/linux-hardware-18/cant-get-usb-webcam-to-work-706318/,
I think someone could mention to BigVig about the FAQ
http://linux-uvc.berlios.de/faq/ and especially the first question. It's
not very useful to post the lsusb dump if the device is not UVC device
to begin with, so pointing new users here is a bit misinformation, but
then again the lsusb wasn't very correct either.

Then to the actual question. As Anthony mentioned, GSPCA driver doesn't
seem to support it either. However what I find interesting is that in
GSPCA driver there's a patch for the same manufacturer's different
device
http://lists-archives.org/spca50x-devs/01649-patch-for-17a1-0128-xpx-jpeg-webcam-tascorp.html
that is not released yet. That patch might work with slight
modifications, so I would recommend to contact the developer of it.
However be prepared for compiling the driver yourself and debugging...
To me it looks like there might be no drivers supporting that webcam at
all right now.

By the way I would personally be happy to hear if you get it to work in
the end. :)


Juho


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 252 bytes
Desc: OpenPGP digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090223/fc04e2ad/attachment.pgp>

From thomas.a.moore at lmco.com  Tue Feb 24 12:51:47 2009
From: thomas.a.moore at lmco.com (Tom Moore)
Date: Tue, 24 Feb 2009 06:51:47 -0500
Subject: [Linux-uvc-devel] Strange issue with V4L, Gumstix,
	and VIDIOC_REQBUFS/VIDIOC_QUERYBUF
Message-ID: <49A3DF53.8080302@atl.lmco.com>

Hi all,

I wrote some capture code and tested it out on Ubuntu 8.10 (kernel 
2.6.27.11). My Dynex 1.3 MP camera supports memory mapping and works 
just fine on my Ubuntu box. However, I have cross-compiled the UVC 
driver for my Gumstix (the target platform for capture - kernel is 
2.6.21) and though I was able to successfully install the driver, my 
capture code doesn't seem to work. I've traced the problem to to ioctl 
call with VIDIOC_QUERYBUF. On my box, that function call returns a 
buffer length of width * height * 2 (format is YUYV, so this is right). 
On my Gumstix, it returns width * height + 589 (the 589 is the same 
regardless of the frame size).

Is there any reason why this would be happening? I appear to be 
unfamilar with the behavior of VIDIOC_QUERYBUF, but it looks like it 
ought to be pretty straightforward.

Oh, I should point out that calls to VIDIOCSPICT and VIDIOCGPICT on my 
Ubuntu box works just fine, but returns -1 for the Gumstix. This camera 
requires that I use some bizarre combinations of V4L1 and V4L2 code to 
access all of its functionality. I'm not sure what versions of the 
various V4L modules and camera drivers are.

Thanks in advance.

-Tom

-- 

Tom Moore
Member, Engineering Staff
Lockheed Martin Advanced Technology Laboratories
3 Executive Campus, Suite 600
Cherry Hill, NJ 08002
Phone: 856-792-9750
E-mail: tmoore at atl.lmco.com



From palmax at gmail.com  Tue Feb 24 17:50:55 2009
From: palmax at gmail.com (palmax at gmail.com)
Date: Tue, 24 Feb 2009 17:50:55 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam Optia
	AF capture still-image feature?
Message-ID: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>

Hello Laurent and UVC developers

I was searching the best webcam without quirks => Creative Live! Cam Optia AF
http://us.creative.com/products/product.asp?category=218&subcategory=219&product=16425

I asked Laurent about webcam with still-image feature and he gave this list:
--------------------------------------------------
0402:5606 ALi Corp.
0408:030c Quanta Computer, Inc.
046d:0994 Logitech, Inc.
046d:09a1 Logitech, Inc.
046d:09b2 Logitech, Inc.
0471:0332 Philips
04f2:b016 Chicony Electronics Co., Ltd
05ac:8502 Apple Computer, Inc.
064e:a110 Suyin Corp.
0ac8:332d Z-Star Microelectronics Corp.
0ac8:3343 Z-Star Microelectronics Corp.
0ad2:933d Service & Quality Technology Co., Ltd
0c45:62e0 Microdia
0c45:63e0 Microdia
145f:013e Unknown
145f:013f
174f:5931 Syntek
174f:5a31
174f:8a33
1871:0306
1c4f:3000
1cac:a332
1cac:b288
5986:0104 Bison
5986:0200
5986:0202 Bison
5986:0240 Bison
5986:0300
5986:0303 Bison
--------------------------------------------------

It isn't in this list that it's why i want to know if Creative Live!
Cam Optia AF has capture still-Image feature.

Thanks
Palmax


From laurent.pinchart at skynet.be  Wed Feb 25 00:39:29 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 00:39:29 +0100
Subject: [Linux-uvc-devel] Dell SP2309W Monitor webcam
In-Reply-To: <1235061373.32390.39.camel@sundance.localdomain>
References: <1235061373.32390.39.camel@sundance.localdomain>
Message-ID: <200902250039.29176.laurent.pinchart@skynet.be>

Hi Phil,

On Thursday 19 February 2009 17:36:13 Phil Gorbett wrote:
> Hi there,
>
> Dell's new wide screen monitor has an integrated webcam with a
> two-microphone array.  Googling about, it appears that no one has yet
> got the mic's working.  While the webcam video works a treat in
> guvcview,

Thanks for the report. I've updated the supported devices list on the website.

> the audio input does not show the webcam usbaudio.  I have
> been able to get the webcam usbaudio to show up as being active in
> alsamixer, but tests of the mic capture fails with the error:
>
> gconfaudiosrc ! audioconvert ! audioresample ! gconfaudiosink
> profile=chat: Could not get/set settings from/on resource.
>
> The camera device itself is an Omivision with ID 05a9:2649.  The lsusb
> simple output lists two additional devices - 0424:2514 and 0424:2512,
> both SMC devices and both listed as USB hubs in lsusb -v.  I have
> attached three addition files - outputs from lsusb -d -v for all three
> devices.  The output for the camera itself, i.e., 2649, indicates audio
> functionality.  The uvcvideo supported devices list indicates that while
> both 2640 and 2646 Omivision webcams are supported, this particular
> device (2649) is not.
>
> There seems to be a view from people having similar difficulty that the
> SMC devices are the mics, but it appears to me that these are just the
> USB interfaces and that the webcam driver itself provides audio
> functionality.

Does the monitor have extra USB ports ? If so the SMC devices are probably 
what they claim to be, USB hubs.

> Any insights you have would be greatly appreciated by myself - and a
> number of other people - with what is otherwise an excellent monitor.

The audio function is part of the camera device (05a9:2649) and is handled by 
the usbaudio driver. You should contact the alsa-devel mailing list for help.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 00:51:01 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 00:51:01 +0100
Subject: [Linux-uvc-devel] Pan and Tilt controls
In-Reply-To: <78877a450902191438t5b40329fv40e589c84b9ade48@mail.gmail.com>
References: <78877a450902072006q7ffc2f73o8381e70411873b4f@mail.gmail.com>
	<200902181537.49176.laurent.pinchart@skynet.be>
	<78877a450902191438t5b40329fv40e589c84b9ade48@mail.gmail.com>
Message-ID: <200902250051.01750.laurent.pinchart@skynet.be>

Hi Gilles,

On Thursday 19 February 2009 23:38:32 Gilles GIGAN wrote:
> Laurent,
>
> > > Is there a way to make these changes when mapping the controls, or do
> > > they have to be coded in the driver itself ?
> >
> > Switching the Pan Reset and Tilt Reset from integers to button should
> > require a modification of the logitech.xml file only (although it might
> > also trigger bugs in yet unused code paths of libwebcam/uvcdynctrl).
>
> I gave that a go:
> I changed  the v4l2_type element from V4L2_CTRL_TYPE_INTEGER to
> V4L2_CTRL_TYPE_BUTTON for both the Pan Reset and Tilt Reset mappings.
> Not sure how to get uvcvideo to unmap existing controls, so I
> rmmod/modprobe (trace=1023) it,

Unmapping controls isn't supported at the moment, rmmod/modprobe is the only 
option.

> and confirmed it lacks these mappings. Then
> I had to modify libwebcam to support the V4L2_CTRL_TYPE_BUTTON. To be
> precise, libwebcam already had the code for that but it was commented out
> (lines 446 to 456 in dynctrl.c). I then imported the dynamic controls with
> uvcdynctrl -i, and it went fine. Pan & Tilt Reset are reported as buttons,

Could you please report that to Martin Rubli on www.quickcamteam.net ?

> but setting a value on them does nothing and these lines are added to
> syslog:
>
>  kernel: [57399.195259] v4l2 ioctl VIDIOC_S_CTRL, dir=rw (0xc008561c)
>  kernel: [57399.202594] uvcvideo: Control 9/2 failure change len 6.

This means the webcam sent an unsolicited message to report a control change 
failure. You can check the failure reason by printing data[5] in 
uvc_event_control. Possible values are

0x00: No error
0x01: Not ready
0x02: Wrong state
0x03: Power
0x04: Out of range
0x05: Invalid unit
0x06: Invalid control
0x07: Invalid Request
0x08-0xFE: Reserved for future use
0xFF: Unknown

> I m not sure what the implications of the change to V4L2_CTRL_TYPE_BUTTON
> are (besides modifying the reported v4l2_queryctrl struct) within the
> driver and the way it send control values to the device. Is it anything
> that can be fixed ? If so how can I help ?

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 00:52:10 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 00:52:10 +0100
Subject: [Linux-uvc-devel] Linux-uvc-devel Digest, Vol 32, Issue 18
In-Reply-To: <c8402960902191839r49c51723q70dab5c1e852efe@mail.gmail.com>
References: <mailman.2320.1235061386.20436.linux-uvc-devel@lists.berlios.de>
	<c8402960902191839r49c51723q70dab5c1e852efe@mail.gmail.com>
Message-ID: <200902250052.10796.laurent.pinchart@skynet.be>

Hi Richard,

On Friday 20 February 2009 03:39:57 Richard Allen wrote:
> I have a issue with the uvcvideo driver running on sparc64. The device
> comes up as /dev/video0. I can take pictures using cheese(gnome app), but I
> cannot access the device using opencv. I this problem may be related to the
> "kernel unaligned memory access", but I haven't really looked into it. In
> any reason, I figure you should be aligning your memory accesses anyhow,
> and this may be of interest.
>
> This affects both my 'Logitech Quickcam Pro', and 'Logitech Quickcam', I
> can supply model numbers if needed. I've attached a dmesg log with the
> relevant section.

Could you please resend the log in a readable (i.e. plain text) format ?

> My kernel is 2.6.26-1/sparc64/smp

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 01:13:34 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 01:13:34 +0100
Subject: [Linux-uvc-devel] Supported camera: Aldi Traveler DC 8900
In-Reply-To: <20090223122301.5c2cfc44.linux-uvc@bachelorguy.com>
References: <20090223122301.5c2cfc44.linux-uvc@bachelorguy.com>
Message-ID: <200902250113.34664.laurent.pinchart@skynet.be>

Hi,

On Monday 23 February 2009 02:23:01 ADFH wrote:
> Awhile ago I posted about this..
>
> Occasionally it'll lock up and I have to turn it off, turn it back on
> again.. Also, to get it to play nice with skype, I have to use libv4l..
>
> Using uvc driver with vanilla kernel 2.6.28.4, compiled from source.
>
> Bus 004 Device 007: ID 0489:d00a Foxconn / Hon Hai
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass          239 Miscellaneous Device
>   bDeviceSubClass         2 ?
>   bDeviceProtocol         1 Interface Association
>   bMaxPacketSize0        64
>   idVendor           0x0489 Foxconn / Hon Hai
>   idProduct          0xd00a
>   bcdDevice            0.10
>   iManufacturer           1 NT96611
>   iProduct                2 USB Camera
>   iSerial                 0
>   bNumConfigurations      1
>
> The camera has NO configuration options (no brightness, saturation
> etc.) in linux or in windows with supplied binary driver.

Could you please post the complete output of

lsusb -v -d 0489:d00a

using usbutils 0.72 or newer (0.73+ preferred) ?

Thanks.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 01:19:29 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 01:19:29 +0100
Subject: [Linux-uvc-devel] Unsupported webcam: STMicroelectronics
	Imaging Division (VLSI Vision)
In-Reply-To: <49A23188.7090301@iki.fi>
References: <49A1DD1F.6020206@gmail.com> <49A229F8.7020908@gmail.com>
	<49A23188.7090301@iki.fi>
Message-ID: <200902250119.29281.laurent.pinchart@skynet.be>

On Monday 23 February 2009 06:18:00 Juho V?h?-Herttua wrote:
> Nathan Baker wrote:
> > Hm, well, if it's not a uvc device, do you have any idea where I should
> > look to get the driver?
>
> I'll start with a small rant. If you're coming from this thread:
> http://www.linuxquestions.org/questions/linux-hardware-18/cant-get-usb-webc
>am-to-work-706318/, I think someone could mention to BigVig about the FAQ
> http://linux-uvc.berlios.de/faq/ and especially the first question. It's
> not very useful to post the lsusb dump if the device is not UVC device
> to begin with, so pointing new users here is a bit misinformation, but
> then again the lsusb wasn't very correct either.

I'd appreciate if someone with a linuxquestions.org account could do that. I 
already have too many mailing lists to monitor, I don't feel like registering 
to yet another forum (I guess we really need OpenID).

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 01:24:36 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 01:24:36 +0100
Subject: [Linux-uvc-devel] Strange issue with V4L, Gumstix,
	and VIDIOC_REQBUFS/VIDIOC_QUERYBUF
In-Reply-To: <49A3DF53.8080302@atl.lmco.com>
References: <49A3DF53.8080302@atl.lmco.com>
Message-ID: <200902250124.36542.laurent.pinchart@skynet.be>

Hi Tom,

On Tuesday 24 February 2009 12:51:47 Tom Moore wrote:
> Hi all,
>
> I wrote some capture code and tested it out on Ubuntu 8.10 (kernel
> 2.6.27.11). My Dynex 1.3 MP camera supports memory mapping and works
> just fine on my Ubuntu box. However, I have cross-compiled the UVC
> driver for my Gumstix (the target platform for capture - kernel is
> 2.6.21) and though I was able to successfully install the driver, my
> capture code doesn't seem to work. I've traced the problem to to ioctl
> call with VIDIOC_QUERYBUF. On my box, that function call returns a
> buffer length of width * height * 2 (format is YUYV, so this is right).
> On my Gumstix, it returns width * height + 589 (the 589 is the same
> regardless of the frame size).
>
> Is there any reason why this would be happening? I appear to be
> unfamilar with the behavior of VIDIOC_QUERYBUF, but it looks like it
> ought to be pretty straightforward.

None that I can think of (at least at this time of the night). Would you mind 
adding a few printk's to the driver code to hunt the bug down ?

> Oh, I should point out that calls to VIDIOCSPICT and VIDIOCGPICT on my
> Ubuntu box works just fine, but returns -1 for the Gumstix.

The uvcvideo driver relies on the videodev compatibility layer to handle V4L1 
ioctls. The Gumstix kernel might come with those disabled.

> This camera requires that I use some bizarre combinations of V4L1 and V4L2
> code to access all of its functionality. I'm not sure what versions of the
> various V4L modules and camera drivers are.

That's definitely not normal. The uvcvideo driver implement V4L2 only. The 
V4L1 ioctls are translated to V4L2 ioctls by the videodev compatibility layer, 
there's no added functionality for the V4L1 API.

Best regards,

Laurent Pinchart



From linux-uvc at bachelorguy.com  Wed Feb 25 01:22:49 2009
From: linux-uvc at bachelorguy.com (ADFH)
Date: Wed, 25 Feb 2009 11:22:49 +1100
Subject: [Linux-uvc-devel] Supported camera: Aldi Traveler DC 8900
Message-ID: <20090225112249.120ff58e.linux-uvc@bachelorguy.com>

... Ooops.. sending to list too ...

> Could you please post the complete output of
> 
> lsusb -v -d 0489:d00a

No probs..

$ sudo lsusb -v -d 0489:d00a
Bus 004 Device 010: ID 0489:d00a Foxconn / Hon Hai 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0489 Foxconn / Hon Hai
  idProduct          0xd00a 
  bcdDevice            0.10
  iManufacturer           1 NT96611
  iProduct                2 USB Camera
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          218
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower              100mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           57
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      4 (SELECTOR_UNIT)
        bUnitID                 3
        bNrInPins               1
        baSource( 0)            1
        iSelector               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 4
        bSourceID               3
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x00000000
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
        INTERFACE CLASS:  0e 24 01 01 65 00 81 01 02 01 00 00 01 00
        INTERFACE CLASS:  0b 24 06 01 02 01 01 00 00 00 00
        INTERFACE CLASS:  26 24 07 01 03 80 02 e0 01 00 ec 0d 00 00 ec
0d 00 00 58 02 00 15 16 05 00 00 15 16 05 00 15 16 05 00 00 00 00 00
INTERFACE CLASS:  26 24 07 02 03 40 01 f0 00 00 ec 0d 00 00 ec 0d 00 00
58 02 00 15 16 05 00 00 15 16 05 00 15 16 05 00 00 00 00 00 INTERFACE
CLASS:  06 24 0d 00 00 00 Device Qualifier (for other device speed):
bLength                10 bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0001
  Self Powered

> using usbutils 0.72 or newer (0.73+ preferred) ?

$ lsusb --version
lsusb (usbutils) 0.73
-- 



From laurent.pinchart at skynet.be  Wed Feb 25 01:31:31 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 01:31:31 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
Message-ID: <200902250131.31260.laurent.pinchart@skynet.be>

Hi,

On Tuesday 24 February 2009 17:50:55 palmax at gmail.com wrote:
> Hello Laurent and UVC developers
>
> I was searching the best webcam without quirks => Creative Live! Cam Optia
> AF
> http://us.creative.com/products/product.asp?category=218&subcategory=219&pr
>oduct=16425
>
> I asked Laurent about webcam with still-image feature and he gave this
> list: --------------------------------------------------
> 0402:5606 ALi Corp.
> 0408:030c Quanta Computer, Inc.
> 046d:0994 Logitech, Inc.
> 046d:09a1 Logitech, Inc.
> 046d:09b2 Logitech, Inc.
> 0471:0332 Philips
> 04f2:b016 Chicony Electronics Co., Ltd
> 05ac:8502 Apple Computer, Inc.
> 064e:a110 Suyin Corp.
> 0ac8:332d Z-Star Microelectronics Corp.
> 0ac8:3343 Z-Star Microelectronics Corp.
> 0ad2:933d Service & Quality Technology Co., Ltd
> 0c45:62e0 Microdia
> 0c45:63e0 Microdia
> 145f:013e Unknown
> 145f:013f
> 174f:5931 Syntek
> 174f:5a31
> 174f:8a33
> 1871:0306
> 1c4f:3000
> 1cac:a332
> 1cac:b288
> 5986:0104 Bison
> 5986:0200
> 5986:0202 Bison
> 5986:0240 Bison
> 5986:0300
> 5986:0303 Bison
> --------------------------------------------------

Please note that this list was based on the information I had at the time. 
Other webcam models can support still image capture.

> It isn't in this list that it's why i want to know if Creative Live!
> Cam Optia AF has capture still-Image feature.

Run the following command

lsusb -v -d 041e:4058 | grep bStillCaptureMethod

This should output the still image capture method supported by the device.

0: No still image capture supported
1: The host software will extract the next frame from the active video stream
2: Higher-quality still images through the video pipe
3: Higher-quality still images through a dedicated pipe

Even if a device reports no still image capture capability (0), the host 
software can always use method 1.

Method 2 and 3 are currently not supported by the uvcvideo driver.

Best regards,

Laurent Pinchart



From thomas.a.moore at lmco.com  Wed Feb 25 14:05:08 2009
From: thomas.a.moore at lmco.com (Tom Moore)
Date: Wed, 25 Feb 2009 08:05:08 -0500
Subject: [Linux-uvc-devel] Strange issue with V4L, Gumstix,
	and VIDIOC_REQBUFS/VIDIOC_QUERYBUF
In-Reply-To: <200902250124.36542.laurent.pinchart@skynet.be>
References: <49A3DF53.8080302@atl.lmco.com>
	<200902250124.36542.laurent.pinchart@skynet.be>
Message-ID: <49A54204.6030602@atl.lmco.com>

Is it possible that some fields are not being set for the buffer size 
per frame on the Gumstix? All I am setting currently is the frame width 
and height, and assuming that V4L will figure out the pixel depth and 
such. Is it possible that the driver on the Gumstix needs more 
information to be specified before requesting buffers?

I'll look into the printk's.

Thanks,
Tom

Laurent Pinchart wrote:
> Hi Tom,
> 
> On Tuesday 24 February 2009 12:51:47 Tom Moore wrote:
>> Hi all,
>>
>> I wrote some capture code and tested it out on Ubuntu 8.10 (kernel
>> 2.6.27.11). My Dynex 1.3 MP camera supports memory mapping and works
>> just fine on my Ubuntu box. However, I have cross-compiled the UVC
>> driver for my Gumstix (the target platform for capture - kernel is
>> 2.6.21) and though I was able to successfully install the driver, my
>> capture code doesn't seem to work. I've traced the problem to to ioctl
>> call with VIDIOC_QUERYBUF. On my box, that function call returns a
>> buffer length of width * height * 2 (format is YUYV, so this is right).
>> On my Gumstix, it returns width * height + 589 (the 589 is the same
>> regardless of the frame size).
>>
>> Is there any reason why this would be happening? I appear to be
>> unfamilar with the behavior of VIDIOC_QUERYBUF, but it looks like it
>> ought to be pretty straightforward.
> 
> None that I can think of (at least at this time of the night). Would you mind 
> adding a few printk's to the driver code to hunt the bug down ?
> 
>> Oh, I should point out that calls to VIDIOCSPICT and VIDIOCGPICT on my
>> Ubuntu box works just fine, but returns -1 for the Gumstix.
> 
> The uvcvideo driver relies on the videodev compatibility layer to handle V4L1 
> ioctls. The Gumstix kernel might come with those disabled.
> 
>> This camera requires that I use some bizarre combinations of V4L1 and V4L2
>> code to access all of its functionality. I'm not sure what versions of the
>> various V4L modules and camera drivers are.
> 
> That's definitely not normal. The uvcvideo driver implement V4L2 only. The 
> V4L1 ioctls are translated to V4L2 ioctls by the videodev compatibility layer, 
> there's no added functionality for the V4L1 API.
> 
> Best regards,
> 
> Laurent Pinchart

-- 

Tom Moore
Member, Engineering Staff
Lockheed Martin Advanced Technology Laboratories
3 Executive Campus, Suite 600
Cherry Hill, NJ 08002
Phone: 856-792-9750
E-mail: tmoore at atl.lmco.com



From palmax at gmail.com  Wed Feb 25 20:27:17 2009
From: palmax at gmail.com (palmax at gmail.com)
Date: Wed, 25 Feb 2009 20:27:17 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <200902250131.31260.laurent.pinchart@skynet.be>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902250131.31260.laurent.pinchart@skynet.be>
Message-ID: <209499a0902251127o12f3777bp377aa2264074dfc1@mail.gmail.com>

Hi,

I can't do it, because I haven't this webcam. Remember that I'm
interesting in develop method 1 and 2. I supposed that "Creative Live!
Cam Optia AF" could be the most interesting webcam for it, because it
doesn't any quirk in your linux-uvc driver.

Instead of that, it's one of the best webcams that I can buy.

Good Bye
Palmax

2009/2/25 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi,
>
> On Tuesday 24 February 2009 17:50:55 palmax at gmail.com wrote:
>> Hello Laurent and UVC developers
>>
>> I was searching the best webcam without quirks => Creative Live! Cam Optia
>> AF
>> http://us.creative.com/products/product.asp?category=218&subcategory=219&pr
>>oduct=16425
>>
>> I asked Laurent about webcam with still-image feature and he gave this
>> list: --------------------------------------------------
>> 0402:5606 ALi Corp.
>> 0408:030c Quanta Computer, Inc.
>> 046d:0994 Logitech, Inc.
>> 046d:09a1 Logitech, Inc.
>> 046d:09b2 Logitech, Inc.
>> 0471:0332 Philips
>> 04f2:b016 Chicony Electronics Co., Ltd
>> 05ac:8502 Apple Computer, Inc.
>> 064e:a110 Suyin Corp.
>> 0ac8:332d Z-Star Microelectronics Corp.
>> 0ac8:3343 Z-Star Microelectronics Corp.
>> 0ad2:933d Service & Quality Technology Co., Ltd
>> 0c45:62e0 Microdia
>> 0c45:63e0 Microdia
>> 145f:013e Unknown
>> 145f:013f
>> 174f:5931 Syntek
>> 174f:5a31
>> 174f:8a33
>> 1871:0306
>> 1c4f:3000
>> 1cac:a332
>> 1cac:b288
>> 5986:0104 Bison
>> 5986:0200
>> 5986:0202 Bison
>> 5986:0240 Bison
>> 5986:0300
>> 5986:0303 Bison
>> --------------------------------------------------
>
> Please note that this list was based on the information I had at the time.
> Other webcam models can support still image capture.
>
>> It isn't in this list that it's why i want to know if Creative Live!
>> Cam Optia AF has capture still-Image feature.
>
> Run the following command
>
> lsusb -v -d 041e:4058 | grep bStillCaptureMethod
>
> This should output the still image capture method supported by the device.
>
> 0: No still image capture supported
> 1: The host software will extract the next frame from the active video stream
> 2: Higher-quality still images through the video pipe
> 3: Higher-quality still images through a dedicated pipe
>
> Even if a device reports no still image capture capability (0), the host
> software can always use method 1.
>
> Method 2 and 3 are currently not supported by the uvcvideo driver.
>
> Best regards,
>
> Laurent Pinchart
>
>


From laurent.pinchart at skynet.be  Wed Feb 25 22:17:03 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 22:17:03 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <209499a0902251127o12f3777bp377aa2264074dfc1@mail.gmail.com>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902250131.31260.laurent.pinchart@skynet.be>
	<209499a0902251127o12f3777bp377aa2264074dfc1@mail.gmail.com>
Message-ID: <200902252217.03862.laurent.pinchart@skynet.be>

Hi,

On Wednesday 25 February 2009 20:27:17 palmax at gmail.com wrote:
> Hi,
>
> I can't do it, because I haven't this webcam. Remember that I'm
> interesting in develop method 1 and 2.

The most interesting methods, as far as the driver is concerned, are 2 and 3.

> I supposed that "Creative Live! Cam Optia AF" could be the most interesting
> webcam for it, because it doesn't any quirk in your linux-uvc driver.

As far as I know, the 041e:4058 implements method 1.

> Instead of that, it's one of the best webcams that I can buy.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 22:22:22 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 22:22:22 +0100
Subject: [Linux-uvc-devel] Strange issue with V4L, Gumstix,
	and VIDIOC_REQBUFS/VIDIOC_QUERYBUF
In-Reply-To: <49A54204.6030602@atl.lmco.com>
References: <49A3DF53.8080302@atl.lmco.com>
	<200902250124.36542.laurent.pinchart@skynet.be>
	<49A54204.6030602@atl.lmco.com>
Message-ID: <200902252222.23040.laurent.pinchart@skynet.be>

Hi Tom,

On Wednesday 25 February 2009 14:05:08 Tom Moore wrote:
> Is it possible that some fields are not being set for the buffer size
> per frame on the Gumstix?

I'm pretty sure I haven't written a Gumstix-specific uvcvideo driver :-) In 
theory the driver should behave the same way on a Gumstix than it does on a 
regular computer. In practice bugs happen.

> All I am setting currently is the frame width and height, and assuming that
> V4L will figure out the pixel depth and such. Is it possible that the driver
> on the Gumstix needs more information to be specified before requesting
> buffers?

Once again there's a single driver (probably with multiple bugs though).

Best regards,

Laurent Pinchart



From palmax at gmail.com  Wed Feb 25 22:18:22 2009
From: palmax at gmail.com (palmax at gmail.com)
Date: Wed, 25 Feb 2009 22:18:22 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <200902252217.03862.laurent.pinchart@skynet.be>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902250131.31260.laurent.pinchart@skynet.be>
	<209499a0902251127o12f3777bp377aa2264074dfc1@mail.gmail.com>
	<200902252217.03862.laurent.pinchart@skynet.be>
Message-ID: <209499a0902251318o7a09e6c4m4773289450e7883f@mail.gmail.com>

Hello
2009/2/25 Laurent Pinchart <laurent.pinchart at skynet.be>:
> Hi,
>
> On Wednesday 25 February 2009 20:27:17 palmax at gmail.com wrote:
>> Hi,
>>
>> I can't do it, because I haven't this webcam. Remember that I'm
>> interesting in develop method 1 and 2.
>
> The most interesting methods, as far as the driver is concerned, are 2 and 3.
>
Sorry I did a mistake about it, I want to develop methods 2 and 3.

>> I supposed that "Creative Live! Cam Optia AF" could be the most interesting
>> webcam for it, because it doesn't any quirk in your linux-uvc driver.
>
> As far as I know, the 041e:4058 implements method 1.
>
>> Instead of that, it's one of the best webcams that I can buy.
>

What is the best webcam that you know that has this methods in its firmware?

> Best regards,
>
> Laurent Pinchart
>
>

Good Bye
Palmax


From laurent.pinchart at skynet.be  Wed Feb 25 23:34:48 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 23:34:48 +0100
Subject: [Linux-uvc-devel] Supported camera: Aldi Traveler DC 8900
In-Reply-To: <20090225112249.120ff58e.linux-uvc@bachelorguy.com>
References: <20090225112249.120ff58e.linux-uvc@bachelorguy.com>
Message-ID: <200902252334.48947.laurent.pinchart@skynet.be>

On Wednesday 25 February 2009 01:22:49 ADFH wrote:
> ... Ooops.. sending to list too ...
>
> > Could you please post the complete output of
> >
> > lsusb -v -d 0489:d00a
>
> No probs..

Thanks. I've updated the supported devices list.

Regarding Skype and libv4l, I'm not surprised. Skype isn't exactly known to 
work well with webcams on Linux.

If you want to investigate the "occasional lock-up", please send a detailed 
description of the problem (including the procedure to reproduce it and kernel 
log messages)

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Feb 25 23:57:16 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 25 Feb 2009 23:57:16 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <209499a0902251318o7a09e6c4m4773289450e7883f@mail.gmail.com>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902252217.03862.laurent.pinchart@skynet.be>
	<209499a0902251318o7a09e6c4m4773289450e7883f@mail.gmail.com>
Message-ID: <200902252357.17106.laurent.pinchart@skynet.be>

Hi,

On Wednesday 25 February 2009 22:18:22 palmax at gmail.com wrote:
> 2009/2/25 Laurent Pinchart <laurent.pinchart at skynet.be>:
> > The most interesting methods, as far as the driver is concerned, are 2
> > and 3.
>
> Sorry I did a mistake about it, I want to develop methods 2 and 3.

I don't know of any UVC webcam implementing method 3, so you will have to 
settle for method 2.

[snip]

> What is the best webcam that you know that has this methods in its
> firmware?

In theory you could pick any camera in the list I provided. In practice I 
expect some of the camera to have firmware bugs in their still image 
implementation, as the still image function probably gets less tested than 
video streaming.

I haven't tested the still image function on any of the webcams in the list so 
I can't really tell you which one will work the best. I suppose your best bet 
would be to go for a well-known brand.

Best regards,

Laurent Pinchart



From graham at gmurray.org.uk  Thu Feb 26 15:59:26 2009
From: graham at gmurray.org.uk (Graham Murray)
Date: Thu, 26 Feb 2009 14:59:26 +0000
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <200902252217.03862.laurent.pinchart@skynet.be> (Laurent
	Pinchart's message of "Wed, 25 Feb 2009 22:17:03 +0100")
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902250131.31260.laurent.pinchart@skynet.be>
	<209499a0902251127o12f3777bp377aa2264074dfc1@mail.gmail.com>
	<200902252217.03862.laurent.pinchart@skynet.be>
Message-ID: <87tz6htfap.fsf@newton.gmurray.org.uk>

Laurent Pinchart <laurent.pinchart at skynet.be> writes:

> As far as I know, the 041e:4058 implements method 1.

#lsusb -v -d 41e:4058 | grep apture
        bStillCaptureMethod                 2



From laurent.pinchart at skynet.be  Thu Feb 26 16:41:55 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 26 Feb 2009 16:41:55 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <87tz6htfap.fsf@newton.gmurray.org.uk>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902252217.03862.laurent.pinchart@skynet.be>
	<87tz6htfap.fsf@newton.gmurray.org.uk>
Message-ID: <200902261641.55958.laurent.pinchart@skynet.be>

Hi Graham,

On Thursday 26 February 2009 15:59:26 Graham Murray wrote:
> Laurent Pinchart <laurent.pinchart at skynet.be> writes:
> > As far as I know, the 041e:4058 implements method 1.
>
> #lsusb -v -d 41e:4058 | grep apture
>         bStillCaptureMethod                 2

This means there are (at least) two different 041e:4058 in the wild. Could you 
please post the complete lsusb output ?

Best regards,

Laurent Pinchart



From graham at gmurray.org.uk  Thu Feb 26 16:47:03 2009
From: graham at gmurray.org.uk (Graham Murray)
Date: Thu, 26 Feb 2009 15:47:03 +0000
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <200902261641.55958.laurent.pinchart@skynet.be> (Laurent
	Pinchart's message of "Thu, 26 Feb 2009 16:41:55 +0100")
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902252217.03862.laurent.pinchart@skynet.be>
	<87tz6htfap.fsf@newton.gmurray.org.uk>
	<200902261641.55958.laurent.pinchart@skynet.be>
Message-ID: <87prh5td3c.fsf@newton.gmurray.org.uk>

Laurent Pinchart <laurent.pinchart at skynet.be> writes:

> Hi Graham,
>
> On Thursday 26 February 2009 15:59:26 Graham Murray wrote:
>> Laurent Pinchart <laurent.pinchart at skynet.be> writes:
>> > As far as I know, the 041e:4058 implements method 1.
>>
>> #lsusb -v -d 41e:4058 | grep apture
>>         bStillCaptureMethod                 2
>
> This means there are (at least) two different 041e:4058 in the wild. Could you 
> please post the complete lsusb output ?


Bus 001 Device 006: ID 041e:4058 Creative Technology, Ltd Live! Cam Optia AF
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x041e Creative Technology, Ltd
  idProduct          0x4058 Live! Cam Optia AF
  bcdDevice            1.00
  iManufacturer           1 Creative Labs
  iProduct                0 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength         1073
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           78
        dwClockFrequency       48.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0006002a
          Auto-Exposure Mode
          Exposure Time (Absolute)
          Focus (Absolute)
          Focus, Auto
          Privacy
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000157f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 9
          None
          SECAM - 625/50
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {5dc717a9-1941-da11-ae0e-000d56ac7b4c}
        bNumControl             9
        bNrPins                 1
        baSourceID( 0)          1
        bControlSize            2
        bmControls( 0)       0xff
        bmControls( 1)       0x01
        iExtension              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x000a  1x 10 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      703
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  6144000
        dwMaxBitRate                 73728000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1536000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                 98304000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1333333
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                153600000
        dwMaxBitRate                153600000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            22
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               4
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        320
        wHeight( 1)                       240
        wWidth( 2)                       1280
        wHeight( 2)                       960
        wWidth( 3)                       1600
        wHeight( 3)                      1200
        bNumCompressionPatterns             4
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        2
        bNumFrameDescriptors                6
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  4915200
        dwMaxBitRate                 29491200
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   614400
        dwMaxBitRate                  7372800
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   153600
        dwMaxBitRate                  1843200
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  4915200
        dwMaxBitRate                 29491200
        dwMaxVideoFrameBufferSize       61440
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  4915200
        dwMaxBitRate                 29491200
        dwMaxVideoFrameBufferSize       61440
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666667
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           960
        dwMinBitRate                 10485760
        dwMaxBitRate                 20971520
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1000000
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1000000
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            18
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               3
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        320
        wHeight( 1)                       240
        wWidth( 2)                       1280
        wHeight( 2)                       960
        bNumCompressionPatterns             3
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b00  2x 768 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       2 Streaming
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           40
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0602 Digital Audio Interface
        bAssocTerminal          0
        bNrChannels             2
        wChannelConfig     0x0003
          Left Front (L)
          Right Front (R)
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                10
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            1
        bmaControls( 0)      0x00
        bmaControls( 1)      0x43
          Mute
          Volume
          Automatic Gain
        bmaControls( 2)      0x43
          Mute
          Volume
          Automatic Gain
        iFeature                0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                35
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             2
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            9 Discrete
        tSamFreq[ 0]         8000
        tSamFreq[ 1]        11025
        tSamFreq[ 2]        12000
        tSamFreq[ 3]        16000
        tSamFreq[ 4]        22050
        tSamFreq[ 5]        24000
        tSamFreq[ 6]        32000
        tSamFreq[ 7]        44100
        tSamFreq[ 8]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x00c4  1x 196 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


From pj.assis at gmail.com  Thu Feb 26 21:53:58 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 26 Feb 2009 20:53:58 +0000
Subject: [Linux-uvc-devel] getting vid:pid
Message-ID: <59cf47a80902261253r26a835e4s6740d3b6ea89e5b9@mail.gmail.com>

Hi,
In order to proper add dynamic controls to the uvc driver, I need at least
the vid string for the selected device.
I tried libwebcam approach  by using /sys/class/video4linux, but this proved
highly distribution dependent and has caused a lot of trouble,
so no I'm parsing the values passed in the device card field of
v4l2_capability struct. UVC sets this to "UVC Camera (vid:pid)" and since I
only need these fields for the uvc driver there shouldn't be a problem,
right?
Or are there any plans to change this field in the future ?
The best solution would be if I could get these values directly in v4l2, but
it looks like v4l2 developers "forgot" or at least didn't consider this
information important enought.
If there is some other distro independent solution I would like to know.
I've also tried libusb, but failed to link the /sys/class device name to the
usb bus-devicename provided by this library.

Best regards,
Paulo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090226/004c63af/attachment.html>

From laurent.pinchart at skynet.be  Thu Feb 26 22:37:40 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 26 Feb 2009 22:37:40 +0100
Subject: [Linux-uvc-devel] [UVC] [Still-image] Has Creative Live! Cam
	Optia AF capture still-image feature?
In-Reply-To: <87prh5td3c.fsf@newton.gmurray.org.uk>
References: <209499a0902240850s481cf922l3f86aa71f1818314@mail.gmail.com>
	<200902261641.55958.laurent.pinchart@skynet.be>
	<87prh5td3c.fsf@newton.gmurray.org.uk>
Message-ID: <200902262237.40126.laurent.pinchart@skynet.be>

Hi Graham,

On Thursday 26 February 2009 16:47:03 Graham Murray wrote:
> Laurent Pinchart <laurent.pinchart at skynet.be> writes:
> > On Thursday 26 February 2009 15:59:26 Graham Murray wrote:
> >> Laurent Pinchart <laurent.pinchart at skynet.be> writes:
> >> > As far as I know, the 041e:4058 implements method 1.
> >>
> >> #lsusb -v -d 41e:4058 | grep apture
> >>         bStillCaptureMethod                 2
> >
> > This means there are (at least) two different 041e:4058 in the wild.
> > Could you please post the complete lsusb output ?

[snip]

Thanks for the information. It turns out my copy of the Live! Cam Optia AF 
descriptors was wrong. The camera indeed claims to support bStillCaptureMethod 
2.

Best regards,

Laurent Pinchart



From sdukan at googlemail.com  Fri Feb 27 01:38:20 2009
From: sdukan at googlemail.com (Sinisa Dukanovic)
Date: Fri, 27 Feb 2009 01:38:20 +0100
Subject: [Linux-uvc-devel] Video/Audio recording issues with a Philips
	SPC1300NC
Message-ID: <560f0caf0902261638p689dc64dhde406c0b580c45e7@mail.gmail.com>

Hi everyone,
i own a Philips SPC1300NC which runs fine with uvc. Recording video never
was an issue, and since a weeks i can even record audio using the internal
mix of the camera. But i was never able to record audio and video at the
same time; not in skype, nor in any other application. When trying to
videophone with skype my communication partner receives perfect video but
only distorted audio. I some how realized the the audio distortion starts
when i start video. Running a few tests outside of skype (with arecord and
luvcview) i now have a deterinistc behaviour:
1) When audio recording is started prior to video recording, audio recording
goes only well until video recording is started.
2) When video recording is started prior to audio recording, both work
perfectly
For my test i used skype(video test in options)+skype(audio-only phone call)
skype(video test in options) + arecord
luvcview + skype(audio-only phone call)
arecord + luvcview

In all cases 1) and 2) hold.

Does anybody know why this happens? Whether this is a uvc-bug or an
alsa-bug? Any hints on how to debug this?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090227/5aebd5ca/attachment.html>

From paulg at cse.yorku.ca  Fri Feb 27 17:16:31 2009
From: paulg at cse.yorku.ca (Paul Griffith)
Date: Fri, 27 Feb 2009 11:16:31 -0500
Subject: [Linux-uvc-devel] uvcvideo and older kernels
Message-ID: <op.up0p5tuqyuj1tx@jazzy.cs.yorku.ca>


Greetings,

Is there any hope of compiling and installing uvcvideo on a older kernel?  
I am running CentOS 4.6 with kernel version 2.6.9-78.0.13.EL.smp and using  
a Logitech QuickCam Communicate MP (aka S5500) camera (usb id number:  
0x046d:09a1). This is a lab of 24 computers and we really don't want to  
upgrade the kernel at the start of a term, the other option is to use  
Windows (we have dual boot).


Thanks
Paul


From thomas.a.moore at lmco.com  Fri Feb 27 20:12:22 2009
From: thomas.a.moore at lmco.com (Tom Moore)
Date: Fri, 27 Feb 2009 14:12:22 -0500
Subject: [Linux-uvc-devel] Strange issue with V4L, Gumstix,
	and VIDIOC_REQBUFS/VIDIOC_QUERYBUF
In-Reply-To: <200902250124.36542.laurent.pinchart@skynet.be>
References: <49A3DF53.8080302@atl.lmco.com>
	<200902250124.36542.laurent.pinchart@skynet.be>
Message-ID: <49A83B16.8080506@atl.lmco.com>

Hello again,

I re-compiled the driver with tracing enabled on pretty much everything, 
and below is the output I received from plugging in the camera and 
running my control program (the output from the uvccapture program is 
very similar). Why is the camera using the MJPEG format? On my desktop 
machine (Ubunto 8.10, kernel 2.6.27), I specify that I want the image 
format to be YUYV and it works fine. I'm even able to output .ppm files 
to disk. Does the camera support more than one format? Also, when I run 
uvccapture, the output file is about 8 KB for a 320x240 image, and it 
will not open in any standard image viewer.

Thanks,
Tom

==============================================================================
<6>Linux video capture interface: v2.00
<7>uvcvideo: Adding mapping Brightness to control 
00000000-0000-0000-0000-000000000101/2.
<7>uvcvideo: Adding mapping Contrast to control 
00000000-0000-0000-0000-000000000101/3.
<7>uvcvideo: Adding mapping Hue to control 
00000000-0000-0000-0000-000000000101/6.
<7>uvcvideo: Adding mapping Saturation to control 
00000000-0000-0000-0000-000000000101/7.
<7>uvcvideo: Adding mapping Sharpness to control 
00000000-0000-0000-0000-000000000101/8.
<7>uvcvideo: Adding mapping Gamma to control 
00000000-0000-0000-0000-000000000101/9.
<7>uvcvideo: Adding mapping Backlight Compensation to control 
00000000-0000-0000-0000-000000000101/1.
<7>uvcvideo: Adding mapping Gain to control 
00000000-0000-0000-0000-000000000101/4.
<7>uvcvideo: Adding mapping Power Line Frequency to control 
00000000-0000-0000-0000-000000000101/5.
<7>uvcvideo: Adding mapping Hue, Auto to control 
00000000-0000-0000-0000-000000000101/16.
<7>uvcvideo: Adding mapping Exposure, Auto to control 
00000000-0000-0000-0000-000000000001/2.
<7>uvcvideo: Adding mapping Exposure, Auto Priority to control 
00000000-0000-0000-0000-000000000001/3.
<7>uvcvideo: Adding mapping Exposure (Absolute) to control 
00000000-0000-0000-0000-000000000001/4.
<7>uvcvideo: Adding mapping White Balance Temperature, Auto to control 
00000000-0000-0000-0000-000000000101/11.
<7>uvcvideo: Adding mapping White Balance Temperature to control 
00000000-0000-0000-0000-000000000101/10.
<7>uvcvideo: Adding mapping White Balance Component, Auto to control 
00000000-0000-0000-0000-000000000101/13.
<7>uvcvideo: Adding mapping White Balance Blue Component to control 
00000000-0000-0000-0000-000000000101/12.
<7>uvcvideo: Adding mapping White Balance Red Component to control 
00000000-0000-0000-0000-000000000101/12.
<7>uvcvideo: Adding mapping Focus (absolute) to control 
00000000-0000-0000-0000-000000000001/6.
<7>uvcvideo: Adding mapping Focus, Auto to control 
00000000-0000-0000-0000-000000000001/8.
<7>uvcvideo: Adding mapping Zoom, Absolute to control 
00000000-0000-0000-0000-000000000001/11.
<7>uvcvideo: Adding mapping Zoom, Continuous to control 
00000000-0000-0000-0000-000000000001/12.
<7>uvcvideo: Adding mapping Privacy to control 
00000000-0000-0000-0000-000000000001/17.
<7>uvcvideo: Probing generic UVC device 2
<7>uvcvideo: Found format MJPEG.
<7>uvcvideo: - 640x480 (15.0 fps)
<7>uvcvideo: - 352x288 (30.0 fps)
<7>uvcvideo: - 320x240 (30.0 fps)
<7>uvcvideo: - 176x144 (30.0 fps)
<7>uvcvideo: - 160x120 (30.0 fps)
<7>uvcvideo: Found a Status endpoint (addr 83).
<6>uvcvideo: Found UVC 1.00 device Dynex 1.3MP Webcam (19ff:0102)
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/10 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/4 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to 
device 2 entity 3
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to 
device 2 entity 1
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000001/3 to 
device 2 entity 1
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000001/4 to 
device 2 entity 1
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000001/11 to 
device 2 entity 1
<7>uvcvideo: Added control 00000000-0000-0000-0000-000000000001/13 to 
device 2 entity 1
<7>uvcvideo: Scanning UVC chain: OT 2<4>videodev: "" has no release 
callback. Please fix your driver for proper sysfs support, see 
http://lwn.net/Articles/36850/
<6>input: Dynex 1.3MP Webcam as /class/input/input0
<7>uvcvideo: UVC device initialized.
<6>usbcore: registered new interface driver uvcvideo
<6>USB Video Class driver (v0.1.0)
<4>3:3:1: cannot get freq at ep 0x84



<7>uvcvideo: uvc_v4l2_open
<7>uvcvideo: Unknown ioctl 0x800e7606
<7>uvcvideo: Unknown ioctl 0x400e7607
<7>uvcvideo: Trying format 0x47504a4d (MJPG): 320x240.
<7>uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: Queuing buffer 1.
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Frame complete (EOF found).
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dequeuing buffer 1 (3, 17584 bytes).
<7>uvcvideo: Queuing buffer 2.
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Frame complete (EOF found).
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dequeuing buffer 2 (3, 17640 bytes).
<7>uvcvideo: Queuing buffer 3.
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Frame complete (EOF found).
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dequeuing buffer 3 (3, 17696 bytes).
<7>uvcvideo: uvc_v4l2_release
<7>uvcvideo: uvc_v4l2_open
<7>uvcvideo: Unknown ioctl 0x800e7606
<7>uvcvideo: Unknown ioctl 0x400e7607
<7>uvcvideo: Trying format 0x47504a4d (MJPG): 320x240.
<7>uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: uvc_v4l2_mmap
<7>uvcvideo: Queuing buffer 1.
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Frame complete (EOF found).
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dequeuing buffer 1 (3, 16352 bytes).
<7>uvcvideo: Queuing buffer 2.
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Frame complete (EOF found).
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dequeuing buffer 2 (3, 10096 bytes).
<7>uvcvideo: Queuing buffer 3.
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Dropping payload (out of sync).
<7>uvcvideo: Frame complete (EOF found).
<7>uvcvideo: uvc_v4l2_poll
<7>uvcvideo: Dequeuing buffer 3 (3, 9720 bytes).
<7>uvcvideo: uvc_v4l2_release

==============================================================================



Laurent Pinchart wrote:
> Hi Tom,
> 
> On Tuesday 24 February 2009 12:51:47 Tom Moore wrote:
>> Hi all,
>>
>> I wrote some capture code and tested it out on Ubuntu 8.10 (kernel
>> 2.6.27.11). My Dynex 1.3 MP camera supports memory mapping and works
>> just fine on my Ubuntu box. However, I have cross-compiled the UVC
>> driver for my Gumstix (the target platform for capture - kernel is
>> 2.6.21) and though I was able to successfully install the driver, my
>> capture code doesn't seem to work. I've traced the problem to to ioctl
>> call with VIDIOC_QUERYBUF. On my box, that function call returns a
>> buffer length of width * height * 2 (format is YUYV, so this is right).
>> On my Gumstix, it returns width * height + 589 (the 589 is the same
>> regardless of the frame size).
>>
>> Is there any reason why this would be happening? I appear to be
>> unfamilar with the behavior of VIDIOC_QUERYBUF, but it looks like it
>> ought to be pretty straightforward.
> 
> None that I can think of (at least at this time of the night). Would you mind 
> adding a few printk's to the driver code to hunt the bug down ?
> 
>> Oh, I should point out that calls to VIDIOCSPICT and VIDIOCGPICT on my
>> Ubuntu box works just fine, but returns -1 for the Gumstix.
> 
> The uvcvideo driver relies on the videodev compatibility layer to handle V4L1 
> ioctls. The Gumstix kernel might come with those disabled.
> 
>> This camera requires that I use some bizarre combinations of V4L1 and V4L2
>> code to access all of its functionality. I'm not sure what versions of the
>> various V4L modules and camera drivers are.
> 
> That's definitely not normal. The uvcvideo driver implement V4L2 only. The 
> V4L1 ioctls are translated to V4L2 ioctls by the videodev compatibility layer, 
> there's no added functionality for the V4L1 API.
> 
> Best regards,
> 
> Laurent Pinchart

-- 

Tom Moore
Member, Engineering Staff
Lockheed Martin Advanced Technology Laboratories
3 Executive Campus, Suite 600
Cherry Hill, NJ 08002
Phone: 856-792-9750
E-mail: tmoore at atl.lmco.com



