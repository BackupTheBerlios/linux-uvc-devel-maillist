From lstonebr at yahoo.com  Wed Sep  1 16:48:20 2010
From: lstonebr at yahoo.com (Logan Stonebraker)
Date: Wed, 1 Sep 2010 07:48:20 -0700
Subject: [Linux-uvc-devel] 046d:08c2 Logitech Quickcam Orbit/Sphere MP
	Controls Incompatibility
Message-ID: <000301cb49e4$b8a281a0$29e784e0$@com>

Greetings,

 

I have been working with Paulo Assis on the quickcamteam forums.

 

We have been trying to determine why a Logitech Orbit MP 046d:08c2 is not
responding to Pan (relative) or Tilt (relative) controls.  Pan/Tilt reset
and all other Logitech specific controls work splendidly despite this.

 

The thread with the details is here:
http://forums.quickcamteam.net/showthread.php?tid=685

 

I noticed on the uvc driver home page http://www.ideasonboard.org/uvc that
the 046d:08c2 is listed as being compatible with no mention of these
controls being unusable (albeit potentially unreliable with the footnotes).

 

We are unable to get past the camera reporting that it failed to query the
control.

 

Interestingly enough pan and tilt functions work fine on any supported
Windows OS using available pan/tilt control software.  We are thinking that
perhaps the reason for this is that the uvcvideo driver expects to query
these controls prior to setting their values (and fails to read), as opposed
to the working windows drivers which (perhaps aware of this firmware issue)
do not query the controls, rather just attempt to set their values.

 

dmesg uvcvideo trace=15 on module insertion

 -snip-

 [ 1449.492454] USB Video Class driver (v0.1.0)

 [ 1449.732361] uvcvideo: Control f70c9e90/2 is already defined.

 [ 1449.741717] uvcvideo: Added control f70c9d90/1 to device 2 entity 9

 [ 1449.752219] uvcvideo: Added control f70c9e50/2 to device 2 entity 9

 [ 1449.752259] uvcvideo: Adding mapping Pan (relative) to control
f70c9d90/1.

 [ 1449.752278] uvcvideo: Adding mapping Tilt (relative) to control
f70c9d90/1.

 [ 1449.752294] uvcvideo: Adding mapping Pan Reset to control f70c9e50/2.

 [ 1449.752309] uvcvideo: Adding mapping Tilt Reset to control f70c9e50/2.

 [ 1449.752324] uvcvideo: Adding mapping Pan/tilt Reset to control
f70c9e50/2.

 [ 1449.752340] uvcvideo: Adding mapping Focus to control f70c9dd0/3.

 [ 1449.752355] uvcvideo: Adding mapping LED1 Mode to control f70c9d10/1.

 [ 1449.752371] uvcvideo: Adding mapping LED1 Frequency to control
f70c9d10/1.

 [ 1449.752387] uvcvideo: Adding mapping Disable video processing to control
f70c9e90/5.

 [ 1449.752402] uvcvideo: Adding mapping Raw bits per pixel to control
f70c9fd0/8.

-snip-

 

sudo ./pan /dev/video0 128
 control(0x009a0904) failed to set (error -1)

dmesg on attempting to set pan or tilt control (via either usb 1.1 or usb
2.0)
 [3035.732371] uvcvideo: Failed to query (131) UVC control 1 (unit 9) : -32
(exp. 4).

 

modinfo uvcvideo on Ubuntu 10.04

 filename:
/lib/modules/2.6.32-24-generic/kernel/drivers/media/video/uvc/uvcvideo.ko

 version:        v0.1.0

 -snip-

 srcversion:     DAAA10E136867F1C47E5652

 -snip-

 

lsusb | grep PTZ

 Bus 001 Device 003: ID 046d:08c2 Logitech, Inc. QuickCam PTZ

 

Thank you in advance if you are able to assist in debugging this <or> at the
very least making mention in a footnote that these specific pan and tilt
controls could be totally unusable to warn potential 046d:08c2 Orbit owners
about this issue.

 

Regards,

 

-Logan

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100901/86184d47/attachment.html>

From uberphi at gmail.com  Wed Sep  1 23:23:19 2010
From: uberphi at gmail.com (Will Walmsley)
Date: Wed, 1 Sep 2010 17:23:19 -0400
Subject: [Linux-uvc-devel] No driver for Omnivision test kit + Lifecam
 Cinema HD driver nowhere to be found
Message-ID: <AANLkTimJKJMbrNkRqjF8_V7uH3QUfAP0pv03uKxSxHpk@mail.gmail.com>

Hello,

I'm using an Omnivision test kit that uses an OV538 controller and an
OV9712 chip (vid:pid 05A9:8065), for which no uvc driver exists - I'm
trying to avoid reinventing the wheel, and so want to find a driver to
modify that has been written for as similar a model as possible.

I believe that the Microsoft Lifecam Cinema HD (045e:075d) uses
similar hardware, and it is supposedly (at least partially)
UVC-compliant. However, looking through the source code that I just
grabbed (from git://linuxtv.org/pinchartl/uvcvideo.git), it looks like
the Lifecam Cinema should be listed in
(uvcvideo/drivers/media/video/uvc/) uvc_driver.c. However,
uvc_driver.c only mentions two previous types of lifecams (NX6000 and
VX7000). Further, no files in the entire source code directory contain
any other mention of lifecams, or reference to the Lifecam Cinema's
product ID (075d). I believe that by simply changing/adding the vendor
ID and product ID in the right place in the source code, I can make
the driver work for my hardware - but the ID's are nowhere to be
found! Can anyone out there help? Where should I be going to find the
Lifecam Cinema-specific driver in the source code?

If for some reason the Lifecam Cinema isn't actually supported (or
ends up not working with my test kit anyway), and I have to start a
new driver from scratch, are there any helpful pointers about how to
best approach this?

(And I would be eternally grateful to anyone that may already have a
driver set up for an identical Omnivision test kit)

Thanks,
Will


From igor.demyanov at gmail.com  Thu Sep  2 01:49:03 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Thu, 2 Sep 2010 03:49:03 +0400
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer Aspire
	5745G)
In-Reply-To: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
Message-ID: <AANLkTinDktUZw2aD-NWunXt3SHW-WY5eAsbQm0H8S=Ob@mail.gmail.com>

Work normal, low fps(7.5)
v4l2ctrl -s
9963776: ? ? ? ? ? ? ? ? ? ? Brightness:0
9963777: ? ? ? ? ? ? ? ? ? ? ? Contrast:32
9963778: ? ? ? ? ? ? ? ? ? ? Saturation:64
9963779: ? ? ? ? ? ? ? ? ? ? ? ? ? ?Hue:0
9963788:White Balance Temperature, Auto:1
9963792: ? ? ? ? ? ? ? ? ? ? ? ? ?Gamma:100
9963800: ? ? ? ? ? Power Line Frequency:1
9963803: ? ? ? ? ? ? ? ? ? ? ?Sharpness:4
9963804: ? ? ? ? Backlight Compensation:1

lsusb
Bus 001 Device 003: ID 064e:a219 Suyin Corp.
Device Descriptor:
??bLength ? ? ? ? ? ? ? ?18
??bDescriptorType ? ? ? ? 1
??bcdUSB ? ? ? ? ? ? ? 2.00
??bDeviceClass ? ? ? ? ?239 Miscellaneous Device
??bDeviceSubClass ? ? ? ? 2 ?
??bDeviceProtocol ? ? ? ? 1 Interface Association
??bMaxPacketSize0 ? ? ? ?64
??idVendor ? ? ? ? ? 0x064e Suyin Corp.
??idProduct ? ? ? ? ?0xa219
??bcdDevice ? ? ? ? ? ?2.15
??iManufacturer ? ? ? ? ? 2 Suyin
??iProduct ? ? ? ? ? ? ? ?1 1.3M WebCam
??iSerial ? ? ? ? ? ? ? ? 3 HF1315-S32B-OV01-VA-R02.01.05
??bNumConfigurations ? ? ?1
??Configuration Descriptor:
?? ?bLength ? ? ? ? ? ? ? ? 9
?? ?bDescriptorType ? ? ? ? 2
?? ?wTotalLength ? ? ? ? ?527
?? ?bNumInterfaces ? ? ? ? ?2
?? ?bConfigurationValue ? ? 1
?? ?iConfiguration ? ? ? ? ?0
?? ?bmAttributes ? ? ? ? 0x80
?? ? ?(Bus Powered)
?? ?MaxPower ? ? ? ? ? ? ?500mA
?? ?Interface Association:
?? ? ?bLength ? ? ? ? ? ? ? ? 8
?? ? ?bDescriptorType ? ? ? ?11
?? ? ?bFirstInterface ? ? ? ? 0
?? ? ?bInterfaceCount ? ? ? ? 2
?? ? ?bFunctionClass ? ? ? ? 14 Video
?? ? ?bFunctionSubClass ? ? ? 3 Video Interface Collection
?? ? ?bFunctionProtocol ? ? ? 0
?? ? ?iFunction ? ? ? ? ? ? ? 5 1.3M WebCam
?? ?Interface Descriptor:
?? ? ?bLength ? ? ? ? ? ? ? ? 9
?? ? ?bDescriptorType ? ? ? ? 4
?? ? ?bInterfaceNumber ? ? ? ?0
?? ? ?bAlternateSetting ? ? ? 0
?? ? ?bNumEndpoints ? ? ? ? ? 1
?? ? ?bInterfaceClass ? ? ? ?14 Video
?? ? ?bInterfaceSubClass ? ? ?1 Video Control
?? ? ?bInterfaceProtocol ? ? ?0
?? ? ?iInterface ? ? ? ? ? ? ?5 1.3M WebCam
?? ? ?VideoControl Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ?13
?? ? ? ?bDescriptorType ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ?1 (HEADER)
?? ? ? ?bcdUVC ? ? ? ? ? ? ? 1.00
?? ? ? ?wTotalLength ? ? ? ? ? 77
?? ? ? ?dwClockFrequency ? ? ? 15.000000MHz
?? ? ? ?bInCollection ? ? ? ? ? 1
?? ? ? ?baInterfaceNr( 0) ? ? ? 1
?? ? ?VideoControl Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? 9
?? ? ? ?bDescriptorType ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ?3 (OUTPUT_TERMINAL)
?? ? ? ?bTerminalID ? ? ? ? ? ? 2
?? ? ? ?wTerminalType ? ? ?0x0101 USB Streaming
?? ? ? ?bAssocTerminal ? ? ? ? ?0
?? ? ? ?bSourceID ? ? ? ? ? ? ? 4
?? ? ? ?iTerminal ? ? ? ? ? ? ? 0
?? ? ?VideoControl Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ?26
?? ? ? ?bDescriptorType ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ?6 (EXTENSION_UNIT)
?? ? ? ?bUnitID ? ? ? ? ? ? ? ? 4
?? ? ? ?guidExtensionCode ? ? ? ? {7033f028-1163-2e4a-ba2c-6890eb334016}
?? ? ? ?bNumControl ? ? ? ? ? ? 8
?? ? ? ?bNrPins ? ? ? ? ? ? ? ? 1
?? ? ? ?baSourceID( 0) ? ? ? ? ?3
?? ? ? ?bControlSize ? ? ? ? ? ?1
?? ? ? ?bmControls( 0) ? ? ? 0x0f
?? ? ? ?iExtension ? ? ? ? ? ? ?0
?? ? ?VideoControl Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ?18
?? ? ? ?bDescriptorType ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ?2 (INPUT_TERMINAL)
?? ? ? ?bTerminalID ? ? ? ? ? ? 1
?? ? ? ?wTerminalType ? ? ?0x0201 Camera Sensor
?? ? ? ?bAssocTerminal ? ? ? ? ?0
?? ? ? ?iTerminal ? ? ? ? ? ? ? 0
?? ? ? ?wObjectiveFocalLengthMin ? ? ?0
?? ? ? ?wObjectiveFocalLengthMax ? ? ?0
?? ? ? ?wOcularFocalLength ? ? ? ? ? ?0
?? ? ? ?bControlSize ? ? ? ? ? ? ? ? ?3
?? ? ? ?bmControls ? ? ? ? ? 0x00000000
?? ? ?VideoControl Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ?11
?? ? ? ?bDescriptorType ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ?5 (PROCESSING_UNIT)
?? ? ?Warning: Descriptor too short
?? ? ? ?bUnitID ? ? ? ? ? ? ? ? 3
?? ? ? ?bSourceID ? ? ? ? ? ? ? 1
?? ? ? ?wMaxMultiplier ? ? ? ? ?0
?? ? ? ?bControlSize ? ? ? ? ? ?2
?? ? ? ?bmControls ? ? 0x0000153f
?? ? ? ? ?Brightness
?? ? ? ? ?Contrast
?? ? ? ? ?Hue
?? ? ? ? ?Saturation
?? ? ? ? ?Sharpness
?? ? ? ? ?Gamma
?? ? ? ? ?Backlight Compensation
?? ? ? ? ?Power Line Frequency
?? ? ? ? ?White Balance Temperature, Auto
?? ? ? ?iProcessing ? ? ? ? ? ? 0
?? ? ? ?bmVideoStandards ? ? 0x 0
?? ? ?Endpoint Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? 7
?? ? ? ?bDescriptorType ? ? ? ? 5
?? ? ? ?bEndpointAddress ? ? 0x83 ?EP 3 IN
?? ? ? ?bmAttributes ? ? ? ? ? ?3
?? ? ? ? ?Transfer Type ? ? ? ? ? ?Interrupt
?? ? ? ? ?Synch Type ? ? ? ? ? ? ? None
?? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
?? ? ? ?wMaxPacketSize ? ? 0x0010 ?1x 16 bytes
?? ? ? ?bInterval ? ? ? ? ? ? ? 6
?? ?Interface Descriptor:
?? ? ?bLength ? ? ? ? ? ? ? ? 9
?? ? ?bDescriptorType ? ? ? ? 4
?? ? ?bInterfaceNumber ? ? ? ?1
?? ? ?bAlternateSetting ? ? ? 0
?? ? ?bNumEndpoints ? ? ? ? ? 0
?? ? ?bInterfaceClass ? ? ? ?14 Video
?? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
?? ? ?bInterfaceProtocol ? ? ?0
?? ? ?iInterface ? ? ? ? ? ? ?5 1.3M WebCam
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?14
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?1 (INPUT_HEADER)
?? ? ? ?bNumFormats ? ? ? ? ? ? ? ? ? ? ? ? 1
?? ? ? ?wTotalLength ? ? ? ? ? ? ? ? ? ? ?307
?? ? ? ?bEndPointAddress ? ? ? ? ? ? ? ? ?129
?? ? ? ?bmInfo ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?0
?? ? ? ?bTerminalLink ? ? ? ? ? ? ? ? ? ? ? 2
?? ? ? ?bStillCaptureMethod ? ? ? ? ? ? ? ? 2
?? ? ? ?bTriggerSupport ? ? ? ? ? ? ? ? ? ? 0
?? ? ? ?bTriggerUsage ? ? ? ? ? ? ? ? ? ? ? 0
?? ? ? ?bControlSize ? ? ? ? ? ? ? ? ? ? ? ?1
?? ? ? ?bmaControls( 0) ? ? ? ? ? ? ? ? ? ?27
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?27
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?4 (FORMAT_UNCOMPRESSED)
?? ? ? ?bFormatIndex ? ? ? ? ? ? ? ? ? ? ? ?1
?? ? ? ?bNumFrameDescriptors ? ? ? ? ? ? ? ?7
?? ? ? ?guidFormat
{59555932-0000-1000-8000-00aa00389b71}
?? ? ? ?bBitsPerPixel ? ? ? ? ? ? ? ? ? ? ?16
?? ? ? ?bDefaultFrameIndex ? ? ? ? ? ? ? ? ?1
?? ? ? ?bAspectRatioX ? ? ? ? ? ? ? ? ? ? ? 0
?? ? ? ?bAspectRatioY ? ? ? ? ? ? ? ? ? ? ? 0
?? ? ? ?bmInterlaceFlags ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Interlaced stream or variable: No
?? ? ? ? ?Fields per frame: 1 fields
?? ? ? ? ?Field 1 first: No
?? ? ? ? ?Field pattern: Field 1 only
?? ? ? ? ?bCopyProtect ? ? ? ? ? ? ? ? ? ? ?0
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?34
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 1
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?640
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 480
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 73728000
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?147456000
?? ? ? ?dwMaxVideoFrameBufferSize ? ? ?614400
?? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?2
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
?? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?666666
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?34
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 2
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?352
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 288
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 24330240
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 48660480
?? ? ? ?dwMaxVideoFrameBufferSize ? ? ?202752
?? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?2
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
?? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?666666
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?34
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 3
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?320
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 240
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 18432000
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 36864000
?? ? ? ?dwMaxVideoFrameBufferSize ? ? ?153600
?? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?2
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
?? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?666666
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?34
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 4
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?176
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 144
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?6082560
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 12165120
?? ? ? ?dwMaxVideoFrameBufferSize ? ? ? 50688
?? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?2
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
?? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?666666
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?34
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 5
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?160
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 120
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?4608000
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? ?9216000
?? ? ? ?dwMaxVideoFrameBufferSize ? ? ? 38400
?? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?2
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
?? ? ? ?dwFrameInterval( 1) ? ? ? ? ? ?666666
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 6
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? 1280
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 800
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ?122880000
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?122880000
?? ? ? ?dwMaxVideoFrameBufferSize ? ? 2048000
?? ? ? ?dwDefaultFrameInterval ? ? ? ?1333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? 1333333
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
?? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 7
?? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
?? ? ? ? ?Still image unsupported
?? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? 1280
?? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ?1024
?? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ?157286400
?? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?157286400
?? ? ? ?dwMaxVideoFrameBufferSize ? ? 2621440
?? ? ? ?dwDefaultFrameInterval ? ? ? ?1333333
?? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
?? ? ? ?dwFrameInterval( 0) ? ? ? ? ? 1333333
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?3 (STILL_IMAGE_FRAME)
?? ? ? ?bEndpointAddress ? ? ? ? ? ? ? ? ? ?0
?? ? ? ?bNumImageSizePatterns ? ? ? ? ? ? ? 6
?? ? ? ?wWidth( 0) ? ? ? ? ? ? ? ? ? ? ? 1280
?? ? ? ?wHeight( 0) ? ? ? ? ? ? ? ? ? ? ?1024
?? ? ? ?wWidth( 1) ? ? ? ? ? ? ? ? ? ? ? ?640
?? ? ? ?wHeight( 1) ? ? ? ? ? ? ? ? ? ? ? 480
?? ? ? ?wWidth( 2) ? ? ? ? ? ? ? ? ? ? ? ?320
?? ? ? ?wHeight( 2) ? ? ? ? ? ? ? ? ? ? ? 240
?? ? ? ?wWidth( 3) ? ? ? ? ? ? ? ? ? ? ? ?320
?? ? ? ?wHeight( 3) ? ? ? ? ? ? ? ? ? ? ? 240
?? ? ? ?wWidth( 4) ? ? ? ? ? ? ? ? ? ? ? ?176
?? ? ? ?wHeight( 4) ? ? ? ? ? ? ? ? ? ? ? 144
?? ? ? ?wWidth( 5) ? ? ? ? ? ? ? ? ? ? ? ?160
?? ? ? ?wHeight( 5) ? ? ? ? ? ? ? ? ? ? ? 120
?? ? ? ?bNumCompressionPatterns ? ? ? ? ? ? 6
?? ? ?VideoStreaming Interface Descriptor:
?? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ? 6
?? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
?? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? 13 (COLORFORMAT)
?? ? ? ?bColorPrimaries ? ? ? ? ? ? ? ? ? ? 1 (BT.709,sRGB)
?? ? ? ?bTransferCharacteristics ? ? ? ? ? ?1 (BT.709)
?? ? ? ?bMatrixCoefficients ? ? ? ? ? ? ? ? 4 (SMPTE 170M (BT.601))
?// Cutting

From csrodley at xnet.co.nz  Thu Sep  2 04:32:11 2010
From: csrodley at xnet.co.nz (Chris)
Date: Thu, 02 Sep 2010 14:32:11 +1200
Subject: [Linux-uvc-devel] Multiple Camera Resolution
Message-ID: <4C7F0CAB.2020800@xnet.co.nz>

Hi,

I am using an embedded device and wish to get at least 2 USB webcams 
working at one time.
I have been playing with the:
bandwidth = stream->ctrl.dwMaxPayloadTransferSize;

And changed it to a variety of numbers finding that setting it to 768 works:
bandwidth = 768;

With the above setting I can get 4 webcams working at 320x240 at 1 fps.

I have tried: 768, 1024, 1536, 1792, 2048 (can run one cam at 640x480 
only), 3072
The only way I can get multiple cams at any resolution is at 768 and 
only 320x240.
Ideally we want to be able to run up to 4 cams at 640x480.

I was wondering if there are any other ways to achieve this?
I see there are a few posts this year around this topic by Laurent.

Many thanks,
CJ


From pj.assis at gmail.com  Thu Sep  2 18:08:48 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 2 Sep 2010 17:08:48 +0100
Subject: [Linux-uvc-devel] No driver for Omnivision test kit + Lifecam
 Cinema HD driver nowhere to be found
In-Reply-To: <AANLkTimJKJMbrNkRqjF8_V7uH3QUfAP0pv03uKxSxHpk@mail.gmail.com>
References: <AANLkTimJKJMbrNkRqjF8_V7uH3QUfAP0pv03uKxSxHpk@mail.gmail.com>
Message-ID: <AANLkTimbkSe0-gb2508TLW4i1H2J6QKcoKCNTVY4uKz=@mail.gmail.com>

Hi,

No usd ID is needed for the uvc driver.
UVC cameras identify themselves as such:
http://www.ideasonboard.org/uvc/faq/

ID's found on the driver code are merely used for passing driver
quirks for some cameras with known issues.

So first check if your camera is uvc compliant (see previous link), if
not then I would advise you to look at gspca code and maybe try to
write a subdriver for your specific device.

the following docs may help:
http://www.linuxtv.org/wiki/index.php/Developer_Section

Best Regards,
Paulo


From palmax at gmail.com  Thu Sep  2 22:57:27 2010
From: palmax at gmail.com (Palmax Maverick)
Date: Thu, 2 Sep 2010 22:57:27 +0200
Subject: [Linux-uvc-devel] [Linux-UVC] [UVC] Probe at uvc_set_video_ctrl.
 bFormatIndex, dwMaxVideoFrameSize and dwMaxPayloadTransferSize
Message-ID: <AANLkTingr=WRHU4mcK8NNP_uY-jpG_c91wMh0fj-q0Zz@mail.gmail.com>

Dear Laurent and others linux-UVC developers,


I'm writting the messages of ctrl that will be based on yours. I'm
trying to understand the meaning of the "probe" parameter of
uvc_vide.c::uvc_get_video_ctrl

Could you tell me it please?


In addition, I want to know what is the value of bFormatIndex that
It's the last selected. Have I to query it?

What is the meaning of dwMaxVideoFrameSize? and
dwMaxPayloadTransferSize at still image controls point of view?


Thanks in advance
Palmax


From mark.sf.net at huijgen.tk  Fri Sep  3 10:07:46 2010
From: mark.sf.net at huijgen.tk (Mark Huijgen)
Date: Fri, 03 Sep 2010 10:07:46 +0200
Subject: [Linux-uvc-devel] Quirk no_fid needed for IMC 13d3:5103
Message-ID: <4C80ACD2.3020402@huijgen.tk>

 Hi all,

The integrated webcam found in the Medion Akoya all-in-one touch screen PC needs a quirk set to get it to work properly.
Without it mplayer reports lots of select timeouts and the image is just green.

With quirk UVC_QUIRK_STREAM_NO_FID set the webcam works great.

Attached the lsusb -vv output for the webcam and the patch I made to add the quirk, maybe this patch can be merged?

Regards,
Mark Huijgen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100903/612267c5/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: IMC-13d3-5103-lsusb.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100903/612267c5/attachment.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: IMC-webcam-nofid-quirk.patch
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100903/612267c5/attachment.ksh>

From travis+ml-uvc-dev at subspacefield.org  Fri Sep  3 23:58:45 2010
From: travis+ml-uvc-dev at subspacefield.org (travis+ml-uvc-dev at subspacefield.org)
Date: Fri, 3 Sep 2010 14:58:45 -0700
Subject: [Linux-uvc-devel] resetting resolution causes crash/failure
Message-ID: <20100903215845.GI29744@subspacefield.org>

Hey all,

I'm using uvc/v4l2 and running into a weird problem.

Under VMWare Fusion, if I reset resolution twice, it hangs the VM.

Attached camera is a USB camera attached to host.

On a native machine, it merely causes the camera to return a blank
screen.

Before getting into details, I wanted to see if anyone had a hunch as
to why this might be.

Also, on my Ubuntu 9.04 box, I'm seeing lots of stuff in dmesg
about uvcvideo: unknown event type x, where x varies, but 121
is a popular value.  I assume that can be ignored and merely
suggests the s/w is out of date.
-- 
It asked me for my race, so I wrote in "human". -- The Beastie Boys
My emails do not have attachments; it's a digital signature that your mail
program doesn't understand. | http://www.subspacefield.org/~travis/ 
If you are a spammer, please email john at subspacefield.org to get blacklisted.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100903/2f98a09a/attachment.pgp>

From civil.over at gmail.com  Sat Sep  4 19:40:30 2010
From: civil.over at gmail.com (Civil)
Date: Sat, 4 Sep 2010 21:40:30 +0400
Subject: [Linux-uvc-devel] Unlisted UVC Camera
Message-ID: <AANLkTin8_xvxE6-m429hOfyC9rFFX5234BtT4baw=Vf-@mail.gmail.com>

Device id: 04f2:b1be (Chicony Electronics Co., Ltd). Found on ASUS UL30Jt
Laptop. Works well, but seems to be mounter upside-down.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100904/128b94c3/attachment.html>

From floe at butterbrot.org  Mon Sep  6 14:24:55 2010
From: floe at butterbrot.org (Florian Echtler)
Date: Mon, 06 Sep 2010 14:24:55 +0200
Subject: [Linux-uvc-devel] Logitech C910, long exposures?
Message-ID: <1283775895.4388.7.camel@block>

Hello everyone,

I'm currently considering a Logitech C910 for some long-term outdoor
imaging. In particular, this means that the camera will have to be able
to do very long exposure times (probably >= 1 sec) for nighttime shots.

Can somebody tell me if a) this camera can do this at all and b) if so,
does the uvc driver currently support this?

Many thanks in advance!

Yours,
Florian
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 190 bytes
Desc: Dies ist ein digital signierter Nachrichtenteil
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100906/19a98484/attachment.pgp>

From coronasensei at gmail.com  Wed Sep  8 02:03:02 2010
From: coronasensei at gmail.com (Andrew Leech)
Date: Wed, 8 Sep 2010 10:03:02 +1000
Subject: [Linux-uvc-devel] Slow frame rate windows/linux?
Message-ID: <002501cb4ee9$3838bca0$a8aa35e0$@gmail.com>

Hi everyone,

This may not be most appropriate place to ask, because the UVC device I'm
building (custom hardware) actually seems to be working pretty well under
linux, I'm getting a nice steady 25fps PAL picture. I just feel there's a
lot of expertise here that someone may be able to assist. 

The problem is my hardware under windows only gets ~10-12fps, and I need
cross platform compatibility. It doesn't report any dropped frames, and it
gets this speed no matter which renderer I use. 

I don't think the problem is the pc, as I've tried it on a couple of
different windows boxes and the working linux is in a vmware instance on the
same pc anyway.

 

I feel there must be something wrong in my uvc descriptors / setup that is
confusing the windows driver where the linux one is more forgiving. I've
tried playing with the mix/max bitrates, and continuous vs static frame
intervals, all to no avail. 

 

I've also added timestamps to my frames (uncompressed yuy2) which I think
are working, but also noticed no difference.

Is there any way with the linux driver to check the frame timestamps, if
they're wrong it should show up as late/missed frames?

 

Has anyone got any suggestions? I really want to ensure my hardware is going
to be stable on as wide a range of computers as possible.

 

Thanks,

Andrew

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100908/46ef82e1/attachment.html>

From barsnick at gmx.net  Wed Sep  8 11:14:58 2010
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 8 Sep 2010 11:14:58 +0200
Subject: [Linux-uvc-devel] Logitech C910, long exposures?
In-Reply-To: <1283775895.4388.7.camel@block>
References: <1283775895.4388.7.camel@block>
Message-ID: <20100908091458.GA31573@sunshine.barsnick.net>

On Mon, Sep 06, 2010 at 14:24:55 +0200, Florian Echtler wrote:
> I'm currently considering a Logitech C910 for some long-term outdoor
> imaging. In particular, this means that the camera will have to be able
> to do very long exposure times (probably >= 1 sec) for nighttime shots.
> 
> Can somebody tell me if a) this camera can do this at all and b) if so,
> does the uvc driver currently support this?

The UVC driver does not support still images, but if you select a frame
rate low enough, exposure time will be larger.

Unfortunately, it seems that few cameras allow frame rates _below_ 5
FPS. Logitech only lists the _max_ frame rate in their specs, but their
happens to be discussion on the C910 in their forums with a dump from
guvcview (this is the kind of info we'd love from every cam!):
http://forums.quickcamteam.net/showthread.php?tid=1345&pid=4976#pid4976

See, nothing below 5 FPS.

For your kind of application, I would almost recommend getting a
cheap and/or used digital camera and controlling it with gphoto2.
(My guess is you will also get more and perhaps better megapixels for
the same price, unless you need an additional mini-tripod.)

I'm saying "almost" because:
  a) I have never owned a camera where this gphoto2 mode was
     supported. I haven't tried my wife's old IXUS 70 yet though,
     it should work. Let me mark that as something to try on a rainy
     weekend.
  b) I don't know how to set exposure and focus, let alone zoom.
     According to
     http://www.linux.com/news/software/applications/47498-sophisticated-picture-taking-with-gphoto
     "Focus, aperture, and other settings will need to be set before
     taking any shots." Fair enough. I guess you could always use
     auto-exposure.

I hope this helps, at least to find a path to a different solution.

Moritz


From accensi at gmail.com  Wed Sep  8 13:35:31 2010
From: accensi at gmail.com (A. C. Censi)
Date: Wed, 8 Sep 2010 08:35:31 -0300
Subject: [Linux-uvc-devel] Logitech C910, long exposures?
In-Reply-To: <20100908091458.GA31573@sunshine.barsnick.net>
References: <1283775895.4388.7.camel@block>
	<20100908091458.GA31573@sunshine.barsnick.net>
Message-ID: <AANLkTin0JSkVogfosQB+sBxY98PePmg2JHZJHXFBr6Z+@mail.gmail.com>

On Wed, Sep 8, 2010 at 6:14 AM, Moritz Barsnick <barsnick at gmx.net> wrote:
> On Mon, Sep 06, 2010 at 14:24:55 +0200, Florian Echtler wrote:
>> I'm currently considering a Logitech C910 for some long-term outdoor
>> imaging. In particular, this means that the camera will have to be able
>
> For your kind of application, I would almost recommend getting a
> cheap and/or used digital camera and controlling it with gphoto2.

See http://www.gphoto.org/doc/remote/ for details.

Using CHDK special firmware, it is possible to control almost
everything on the cheap Canon Powershot cameras, even those not
supported by Canon original SDK (on Windows). See the forums of CHDK.
http://chdk.wikia.com/wiki/CHDK

Somewhat similar
http://www.moreno.marzolla.name/software/time_lapse_movies/

-- 
A. C. Censi
accensi [em] gmail [ponto] com
accensi [em] montreal [ponto] com [ponto] br


From floe at butterbrot.org  Wed Sep  8 15:36:58 2010
From: floe at butterbrot.org (Florian Echtler)
Date: Wed, 08 Sep 2010 15:36:58 +0200
Subject: [Linux-uvc-devel] Logitech C910, long exposures?
In-Reply-To: <20100908091458.GA31573@sunshine.barsnick.net>
References: <1283775895.4388.7.camel@block>
	<20100908091458.GA31573@sunshine.barsnick.net>
Message-ID: <1283953018.4388.20.camel@block>

Am Mittwoch, den 08.09.2010, 11:14 +0200 schrieb Moritz Barsnick:
> On Mon, Sep 06, 2010 at 14:24:55 +0200, Florian Echtler wrote:
> > I'm currently considering a Logitech C910 for some long-term outdoor
> > imaging. In particular, this means that the camera will have to be able
> > to do very long exposure times (probably >= 1 sec) for nighttime shots.
> > 
> > Can somebody tell me if a) this camera can do this at all and b) if so,
> > does the uvc driver currently support this?
> The UVC driver does not support still images, but if you select a frame
> rate low enough, exposure time will be larger.
If still image support (for still image method 2) were to be added, would
that bring exposure control with it? (probably not?)

> Unfortunately, it seems that few cameras allow frame rates _below_ 5
> FPS. Logitech only lists the _max_ frame rate in their specs, but their
> happens to be discussion on the C910 in their forums with a dump from
> guvcview (this is the kind of info we'd love from every cam!):
> http://forums.quickcamteam.net/showthread.php?tid=1345&pid=4976#pid4976
> See, nothing below 5 FPS.
Hm, but resolutions from full HD and up in YUYV show 1/2 fps? (Don't know
if this is actually equal to exposure time or just due to the bandwidth..)

> For your kind of application, I would almost recommend getting a
> cheap and/or used digital camera and controlling it with gphoto2.
> (My guess is you will also get more and perhaps better megapixels for
> the same price, unless you need an additional mini-tripod.)
Well, this is exactly the solution I am using right now :-) I have a
Powershot A60 mounted outdoors in a watertight case. However, there are
some drawbacks:
- moving parts. The camera is already through some 1000s of shots and I
have no idea how long it's going to hold up, particularly at outdoor
temperatures.
- flaky USB. The camera clearly wasn't meant for this sort of usage and
irregularly crashes after a couple dozen of pictures.

For these reasons, I got the idea of using a webcam.

Yours,
Florian
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 190 bytes
Desc: Dies ist ein digital signierter Nachrichtenteil
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100908/d0d6fca1/attachment.pgp>

From barsnick at gmx.net  Wed Sep  8 16:14:32 2010
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 8 Sep 2010 16:14:32 +0200
Subject: [Linux-uvc-devel] Logitech C910, long exposures?
In-Reply-To: <1283953018.4388.20.camel@block>
References: <1283775895.4388.7.camel@block>
	<20100908091458.GA31573@sunshine.barsnick.net>
	<1283953018.4388.20.camel@block>
Message-ID: <20100908141432.GA1079@sunshine.barsnick.net>

Hi,

On Wed, Sep 08, 2010 at 15:36:58 +0200, Florian Echtler wrote:

> If still image support (for still image method 2) were to be added,
> would that bring exposure control with it? (probably not?)

Good question. I have no understanding of the UVC standard, I only know
the still image buzzword from many threads here. :)
In Message-Id: <200804162242.45541.laurent.pinchart at skynet.be>, Laurent
wrote:
> It all depends on the hardware. The UVC spec defines several method
> to capture still images. The most common one, implemented by all the
> webcams I've tested so far, is to take the next image from the video
> stream. This won't help improving image quality.
So you're probably out of luck.

> Hm, but resolutions from full HD and up in YUYV show 1/2 fps? (Don't know
> if this is actually equal to exposure time or just due to the bandwidth..)

You're right, I missed that. It does say 1/2 (that's SPF, not FPS, by
the way).

My experience - without having done _anything_ with re-adjusting
autoexposure or the likes - is that the camera will expose as much of
that interval if it needs to. But since it doesn't have an aperture, it
reduces exposure time in better lighting. One of my personal webcam
(non-UVC) installations is at constant 5 FPS, but only in the evening
does movement appear blurry in the stream.

I do _not_ know whether a constant FPS and disabled autoexposure would
lead to under-/overexposure but defined exposure time.

> Well, this is exactly the solution I am using right now :-)

Ha! :-) But you have valid points there. No mechanical wear in the web
cam. (But my web cam's sensor seems to have deteriorated over the
years.)

Gru?,
Moritz


From m_uvcdev at ml1.co.uk  Wed Sep  8 16:04:13 2010
From: m_uvcdev at ml1.co.uk (Martin)
Date: Wed, 08 Sep 2010 15:04:13 +0100
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <4C7B9668.6020204@ml1.co.uk>
References: <4C77C85C.4040504@ml1.co.uk> <4C7B9668.6020204@ml1.co.uk>
Message-ID: <4C8797DD.3040104@ml1.co.uk>

OK, so the current linux UVC driver doesn't support still image capture.

What is needed to implement that?

Is it just a case of programming in the data structures, or is there a
lot more needed for decoding/converting a captured image and interfacing?

Will a new /dev device need creating dedicated to still image capture?...

How much interest is there for that? (Presumably there will be some so
as to utilise HD webcams to their full resolution...)

Regards,
Martin



On 30/08/10 12:30, Martin wrote:
> On 27/08/10 15:14, Martin wrote:
>> The problem:
>>
>> From reading around this list and elsewhere, it appears that you simply
>> cannot run more than one webcam video stream per USB root hub.
>>
>> When enabled for video streaming, the webcam reserves the full
>> isochronous bandwidth needed to stream data at the selected resolution
>> and framerate, regardless...

[...]

>> *A possible solution* ?
>>
>> Instead, could the UVC driver 'simulate' a reduced framerate by instead
>> using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
>> set number of images per second? Or even only when polled by a read from
>> the user application?
>>
>> On *nix, "everything is a file"... Could the uvc driver accept reading
>> of /dev/videoX by the command "cp" so that still image data is copied,
>> formatted for a jpg or png?
>>
>> Could the "quirks" setting be abused to set the image grab rate? Or some
>> other neater method?
> 
> That still looks to be the best solution. The webcam is supposed to
> support still image capture, but how do I do that?! Is there a nice
> little snippet of C code that I can compile to grab a still image to a
> jpg or png?

[...]

>> Further details:
>>
>> I'm trying to use two webcams simultaneously:
>>
>>   iManufacturer           1 Sweex
>>   iProduct                2 WC060 Series HD Webcam
>>
>>
>> On separate hubs, they work fine. On the same hub, the second one to
>> start shows the error:
>>
>> "Error starting stream VIDIOC_STREAMON: No space left on device".
>>
>> I've only got the one root hub on the system I want to use for the two
>> webcams!
>>
>>
>> Their descriptors show:
>>
>>         bFrameIntervalType                  2
>>         dwFrameInterval( 0)           2000000
>>         dwFrameInterval( 1)           4000000
>>
>>
>> Can I tweak the UVC driver to preferentially choose the slower frame
>> rate available?
>>
>> Aside: The MJPG format doesn't seem to work, nor are any compression
>> settings visible...
>>
>>
>> Given a few hints or a patch, I can hack the kernel module to test :-)
>>
>> This is running on Gentoo, kernel 2.6.34 using the in-kernel uvc module.
>>
>> Any comment/ideas welcomed.
>>
>> Regards,
>> Martin
>>
>>
>>
>>
>> From lsusb -v (excerpt):
>>
>> VideoStreaming Interface Descriptor:
>>         bLength                            34
>>         bDescriptorType                    36
>>         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>>         bFrameIndex                         9
>>         bmCapabilities                   0x00
>>           Still image unsupported
>>         wWidth                           1600
>>         wHeight                          1200
>>         dwMinBitRate                   768000
>>         dwMaxBitRate                196608000
>>         dwMaxVideoFrameBufferSize     3840000
>>         dwDefaultFrameInterval        2000000
>>         bFrameIntervalType                  2
>>         dwFrameInterval( 0)           2000000
>>         dwFrameInterval( 1)           4000000
>> VideoStreaming Interface Descriptor:
>>         bLength                            42
>>         bDescriptorType                    36
>>         bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>>         bEndpointAddress                    0
>>         bNumImageSizePatterns               9
>>         wWidth( 0)                        640
>>         wHeight( 0)                       480
>>         wWidth( 1)                        352
>>         wHeight( 1)                       288
>>         wWidth( 2)                        320
>>         wHeight( 2)                       240
>>         wWidth( 3)                        176
>>         wHeight( 3)                       144
>>         wWidth( 4)                        160
>>         wHeight( 4)                       120
>>         wWidth( 5)                        800
>>         wHeight( 5)                       600
>>         wWidth( 6)                       1280
>>         wHeight( 6)                       960
>>         wWidth( 7)                       1280
>>         wHeight( 7)                      1024
>>         wWidth( 8)                       1600
>>         wHeight( 8)                      1200
>>         bNumCompressionPatterns             9




From shop at open-t.co.uk  Wed Sep  8 17:20:00 2010
From: shop at open-t.co.uk (Sebastian)
Date: Wed, 08 Sep 2010 16:20:00 +0100
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <4C8797DD.3040104@ml1.co.uk>
References: <4C77C85C.4040504@ml1.co.uk> <4C7B9668.6020204@ml1.co.uk>
	<4C8797DD.3040104@ml1.co.uk>
Message-ID: <4C87A9A0.5090502@open-t.co.uk>

Hi,

I've posted the stuff below a while ago - but I've just discovered I was 
actually replying privately to the original poster by mistake. So a bit 
late, but I will post it again to the list - just in case anybody is 
interested.

On 09/08/2010 03:04 PM, Martin wrote:
> OK, so the current linux UVC driver doesn't support still image capture.
>
> What is needed to implement that?
>
> Is it just a case of programming in the data structures, or is there a
> lot more needed for decoding/converting a captured image and interfacing?
>
> Will a new /dev device need creating dedicated to still image capture?...
>
> How much interest is there for that? (Presumably there will be some so
> as to utilise HD webcams to their full resolution...)
>
> Regards,
> Martin
>
>
>
> On 30/08/10 12:30, Martin wrote:
>> On 27/08/10 15:14, Martin wrote:
>>> The problem:
>>>
>>>  From reading around this list and elsewhere, it appears that you simply
>>> cannot run more than one webcam video stream per USB root hub.

I have managed to get 4 cameras working, at 10fps and 640x480 on one usb 
2.0 controller. The only way I managed to achieve this was by using 
mjpeg capable cameras - and forcing the stream in mjpeg format directly 
from the webcam - not in raw video.

Also, according to my experiments - it looks like the compression rate 
varies from camera to camera (probably a characteristic of the internal 
chipset) - which will affect the usb bandwidth used. I have 4 different 
mjpeg capable webcam models - I could run some measurements.

VLC is capable of requesting mjpeg stream. FFmpeg was capable - but the 
syntax changed. However, it looks like it is possible to set the camera 
in mjpeg mode using v4l2-ctl first - which would open up the possibility 
of using other capture software which is not capable of requesting an 
mjpeg stream - I think.

One more thing - avoid Microsoft LifeCam Cinema HD - it requests a 
constant amount of bandwidth - regardless of resolution or compression 
used - so that is a no go. Unless you modify the v4l2/uvc driver - to 
ignore the bandwidth requests from camera.

Hope the above helps a bit,

Sebastian

>>>
>>> When enabled for video streaming, the webcam reserves the full
>>> isochronous bandwidth needed to stream data at the selected resolution
>>> and framerate, regardless...
>
> [...]
>
>>> *A possible solution* ?
>>>
>>> Instead, could the UVC driver 'simulate' a reduced framerate by instead
>>> using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
>>> set number of images per second? Or even only when polled by a read from
>>> the user application?
>>>
>>> On *nix, "everything is a file"... Could the uvc driver accept reading
>>> of /dev/videoX by the command "cp" so that still image data is copied,
>>> formatted for a jpg or png?
>>>
>>> Could the "quirks" setting be abused to set the image grab rate? Or some
>>> other neater method?
>>
>> That still looks to be the best solution. The webcam is supposed to
>> support still image capture, but how do I do that?! Is there a nice
>> little snippet of C code that I can compile to grab a still image to a
>> jpg or png?
>
> [...]
>
>>> Further details:
>>>
>>> I'm trying to use two webcams simultaneously:
>>>
>>>    iManufacturer           1 Sweex
>>>    iProduct                2 WC060 Series HD Webcam
>>>
>>>
>>> On separate hubs, they work fine. On the same hub, the second one to
>>> start shows the error:
>>>
>>> "Error starting stream VIDIOC_STREAMON: No space left on device".
>>>
>>> I've only got the one root hub on the system I want to use for the two
>>> webcams!
>>>
>>>
>>> Their descriptors show:
>>>
>>>          bFrameIntervalType                  2
>>>          dwFrameInterval( 0)           2000000
>>>          dwFrameInterval( 1)           4000000
>>>
>>>
>>> Can I tweak the UVC driver to preferentially choose the slower frame
>>> rate available?
>>>
>>> Aside: The MJPG format doesn't seem to work, nor are any compression
>>> settings visible...
>>>
>>>
>>> Given a few hints or a patch, I can hack the kernel module to test :-)
>>>
>>> This is running on Gentoo, kernel 2.6.34 using the in-kernel uvc module.
>>>
>>> Any comment/ideas welcomed.
>>>
>>> Regards,
>>> Martin
>>>
>>>
>>>
>>>
>>>  From lsusb -v (excerpt):
>>>
>>> VideoStreaming Interface Descriptor:
>>>          bLength                            34
>>>          bDescriptorType                    36
>>>          bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
>>>          bFrameIndex                         9
>>>          bmCapabilities                   0x00
>>>            Still image unsupported
>>>          wWidth                           1600
>>>          wHeight                          1200
>>>          dwMinBitRate                   768000
>>>          dwMaxBitRate                196608000
>>>          dwMaxVideoFrameBufferSize     3840000
>>>          dwDefaultFrameInterval        2000000
>>>          bFrameIntervalType                  2
>>>          dwFrameInterval( 0)           2000000
>>>          dwFrameInterval( 1)           4000000
>>> VideoStreaming Interface Descriptor:
>>>          bLength                            42
>>>          bDescriptorType                    36
>>>          bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
>>>          bEndpointAddress                    0
>>>          bNumImageSizePatterns               9
>>>          wWidth( 0)                        640
>>>          wHeight( 0)                       480
>>>          wWidth( 1)                        352
>>>          wHeight( 1)                       288
>>>          wWidth( 2)                        320
>>>          wHeight( 2)                       240
>>>          wWidth( 3)                        176
>>>          wHeight( 3)                       144
>>>          wWidth( 4)                        160
>>>          wHeight( 4)                       120
>>>          wWidth( 5)                        800
>>>          wHeight( 5)                       600
>>>          wWidth( 6)                       1280
>>>          wHeight( 6)                       960
>>>          wWidth( 7)                       1280
>>>          wHeight( 7)                      1024
>>>          wWidth( 8)                       1600
>>>          wHeight( 8)                      1200
>>>          bNumCompressionPatterns             9
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From largret at gmail.com  Thu Sep  9 08:01:47 2010
From: largret at gmail.com (Chris Largret)
Date: Thu, 9 Sep 2010 01:01:47 -0500
Subject: [Linux-uvc-devel] Another Confirmed Model
Message-ID: <20100909010147.3f83eccd@shogun.epicvoyage.org>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I purchased a used netbook with a Chicony webcam in it. Since there is
a list of supported devices at http://www.ideasonboard.org/uvc/, I
wanted to sound off.

As of the 2.6.33.4 kernel (slightly old now), UVC works with
Chicony Electronics device ID 04f2:b084.

Thanks!

- -- 
Chris Largret <largret at gmail.com>
http://www.largret.com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAkyIeEsACgkQyBrDZUqad5H3NgCeKdTpJ9GtXaXUltXSSWXfOB8x
nzIAn0AFCT4CRYzzq5LYCUAXaRZC/Xjh
=JJNf
-----END PGP SIGNATURE-----

From floe at butterbrot.org  Thu Sep  9 11:30:41 2010
From: floe at butterbrot.org (Florian Echtler)
Date: Thu, 09 Sep 2010 11:30:41 +0200
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
	hackish)
Message-ID: <1284024641.2294.43.camel@flunder>

Hello everybody,

since the topic of still image support has come up time and again, I've
decided to give it a shot. After reading the UVC spec, it seems that
there isn't too much difference to the normal operation, so I created a
new set of functions from uvc_probe_video, uvc_commit_video and friends.
These are called uvc_probe_still, uvc_commit_still and additionally
uvc_trigger_still.

Just for testing, I replaced the original functions with calls to the
still image functions and got somewhat mixed results with my two cams:

- the builtin camera in my Lenovo netbook doesn't really behave any
different, it still streams images as before

- my Quickcam S5500 doesn't do anything, guvcview complains:
 Could not grab image (select timeout): Resource temporarily unavailable

I'm aware that this is a really ugly hack right now, but maybe it
provides a starting point for those of you with more insight into how
the driver works. I'd be glad for some hints as to how to proceed!

Thanks
Florian

P.S. The relevant parts from the UVC spec are:

Spec:
  2.4.2.4 Still Image Capture
  4.3.1.2 Video Still Probe/Commit Control
  4.3.1.4 Still Image Trigger Control

FAQ:
  2.30 Still Image Transfer

-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc-still-image-support.patch
Type: text/x-patch
Size: 5233 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100909/ea7e2dd2/attachment.bin>

From palmax at gmail.com  Thu Sep  9 12:04:49 2010
From: palmax at gmail.com (Palmax Maverick)
Date: Thu, 9 Sep 2010 12:04:49 +0200
Subject: [Linux-uvc-devel] Linux-uvc-devel Digest, Vol 51, Issue 10
In-Reply-To: <mailman.35.1284026406.31352.linux-uvc-devel@lists.berlios.de>
References: <mailman.35.1284026406.31352.linux-uvc-devel@lists.berlios.de>
Message-ID: <AANLkTimNt3fde-H8+SE+sRaqu_zsdqfY9vBDM8wyLgrM@mail.gmail.com>

Hello Florian,


I'm writting still image feature for linux-uvc. If you want to
collaborate you may work about timing problem, because it's very
important to resolve.
You may read about "Timestamps" in UVC documentation pdf.


Thanks for your collaboration
Palmax

2010/9/9  <linux-uvc-devel-request at lists.berlios.de>:
> Send Linux-uvc-devel mailing list submissions to
> ? ? ? ?linux-uvc-devel at lists.berlios.de
>
> To subscribe or unsubscribe via the World Wide Web, visit
> ? ? ? ?https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> or, via email, send a message with subject or body 'help' to
> ? ? ? ?linux-uvc-devel-request at lists.berlios.de
>
> You can reach the person managing the list at
> ? ? ? ?linux-uvc-devel-owner at lists.berlios.de
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Linux-uvc-devel digest..."
>
>
> Today's Topics:
>
> ? 1. [PATCH] Still image support (very broken and ? ? ?hackish)
> ? ? ?(Florian Echtler)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Thu, 09 Sep 2010 11:30:41 +0200
> From: Florian Echtler <floe at butterbrot.org>
> To: linux-uvc-devel at lists.berlios.de
> Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken
> ? ? ? ?and ? ? hackish)
> Message-ID: <1284024641.2294.43.camel at flunder>
> Content-Type: text/plain; charset="utf-8"
>
> Hello everybody,
>
> since the topic of still image support has come up time and again, I've
> decided to give it a shot. After reading the UVC spec, it seems that
> there isn't too much difference to the normal operation, so I created a
> new set of functions from uvc_probe_video, uvc_commit_video and friends.
> These are called uvc_probe_still, uvc_commit_still and additionally
> uvc_trigger_still.
>
> Just for testing, I replaced the original functions with calls to the
> still image functions and got somewhat mixed results with my two cams:
>
> - the builtin camera in my Lenovo netbook doesn't really behave any
> different, it still streams images as before
>
> - my Quickcam S5500 doesn't do anything, guvcview complains:
> ?Could not grab image (select timeout): Resource temporarily unavailable
>
> I'm aware that this is a really ugly hack right now, but maybe it
> provides a starting point for those of you with more insight into how
> the driver works. I'd be glad for some hints as to how to proceed!
>
> Thanks
> Florian
>
> P.S. The relevant parts from the UVC spec are:
>
> Spec:
> ?2.4.2.4 Still Image Capture
> ?4.3.1.2 Video Still Probe/Commit Control
> ?4.3.1.4 Still Image Trigger Control
>
> FAQ:
> ?2.30 Still Image Transfer
>
> -------------- next part --------------
> A non-text attachment was scrubbed...
> Name: uvc-still-image-support.patch
> Type: text/x-patch
> Size: 5233 bytes
> Desc: not available
> URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100909/ea7e2dd2/attachment-0001.bin>
>
> ------------------------------
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>
> End of Linux-uvc-devel Digest, Vol 51, Issue 10
> ***********************************************
>


From floe at butterbrot.org  Fri Sep 10 07:37:10 2010
From: floe at butterbrot.org (Florian Echtler)
Date: Fri, 10 Sep 2010 07:37:10 +0200
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
 hackish)
In-Reply-To: <1284024641.2294.43.camel@flunder>
References: <1284024641.2294.43.camel@flunder>
Message-ID: <1284097030.2294.61.camel@flunder>

Brief update: I've found that the patch actually does work with the
Quickcam, it delivers a single image which is correctly flagged as still
image in the header. The problem seems to be rather that guvcview
doesn't quite know yet how to handle this; I wrote a small V4L2 test
program myself which starts the stream, retrieves a single image and
stops it again.

So I'd say that this patch is working better than I first said, it might
actually work as a starting point, at least for further testing.

Florian

On Thu, 2010-09-09 at 11:30 +0200, Florian Echtler wrote:
> Hello everybody,
> 
> since the topic of still image support has come up time and again, I've
> decided to give it a shot. After reading the UVC spec, it seems that
> there isn't too much difference to the normal operation, so I created a
> new set of functions from uvc_probe_video, uvc_commit_video and friends.
> These are called uvc_probe_still, uvc_commit_still and additionally
> uvc_trigger_still.
> 
> Just for testing, I replaced the original functions with calls to the
> still image functions and got somewhat mixed results with my two cams:
> 
> - the builtin camera in my Lenovo netbook doesn't really behave any
> different, it still streams images as before
> 
> - my Quickcam S5500 doesn't do anything, guvcview complains:
>  Could not grab image (select timeout): Resource temporarily unavailable
> 
> I'm aware that this is a really ugly hack right now, but maybe it
> provides a starting point for those of you with more insight into how
> the driver works. I'd be glad for some hints as to how to proceed!
> 
> Thanks
> Florian
> 
> P.S. The relevant parts from the UVC spec are:
> 
> Spec:
>   2.4.2.4 Still Image Capture
>   4.3.1.2 Video Still Probe/Commit Control
>   4.3.1.4 Still Image Trigger Control
> 
> FAQ:
>   2.30 Still Image Transfer
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel




From coronasensei at gmail.com  Fri Sep 10 08:14:30 2010
From: coronasensei at gmail.com (Andrew Leech)
Date: Fri, 10 Sep 2010 16:14:30 +1000
Subject: [Linux-uvc-devel] Maximising iram throughput?
Message-ID: <012901cb50af$70e70bc0$52b52340$@gmail.com>

Hi all,

Just wondering if anyone's found some tricks to speed up iram data
throughput, specifically with dma transfers.

My application is basically sending data (real time video) from the external
static ram interface over USB. The catch is the data buffer sizes of the
external data and the usb data need to be quite different so I've had to set
up a double buffering arrangement, where I'm using the DMA to copy from
external port to a large rolling buffer space in iram, and then on a
separate dma channel copying the (smaller) chunks of data from the large
buffer to my usb buffer/structs. The usb packets needs a header on each one,
so I can't just give the usb a pointer to a location in the main buffer
because it obviously won't have the header.

 

The system is technically working, but I'm running very low on memory bus
bandwidth. The main issue is coming from latency in the external interface,
I currently have it running with a MPMCStaticWaitRd0 of 1 and have a couple
of errors in transmission. The errors are completely gone if I up the WaitRd
to 2 but then the dma from buffer to usb is not keeping up.

 

The external ram interface is in 16 bit mode, and the write buffers (in
MPMCStaticConfig) are disabled, I'm using interface strictly read only and
enabling them slowed it down more.

Both dma channels are running in burst mode (16 byte chunks).

Clocks are all at csp default settings again, so mpmc, dma, ebi all at
90Mhz, core at 180Mhz.

I've tried SYS_REGS->eshctrl_sup4 = 0; to enable high speed performance mode
on EBI, but that doesn't really seem to help much, not that I expected it to
really.

 

I've also tried enabling instruction and data caches at start of main:

                // Set virtual address of MMU table

                cp15_set_vmmu_addr((void *) ISROM_MMU_TTB_BASE);

                cp15_set_mmu(1);

                cp15_set_icache(1);

                cp15_set_dcache(1);

But I didn't notice any difference in application speed, can anyone confirm
whether this is the correct way to enable the buffers? Although I guess
these are buffers for the cpu, so wouldn't affect the dma anyway.

 

Basically I'd really like to speed up the iram - iram dma transfer to allow
more bus bandwidth / time to devote to external ram - iram dma channel so I
can slow the mpmc WaitRd down a touch and still kepp up with the video
stream.

 

Cheers,

Andrew

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100910/25c233a9/attachment.html>

From josu.lazkano at gmail.com  Sun Sep 12 01:38:45 2010
From: josu.lazkano at gmail.com (Josu Lazkano)
Date: Sun, 12 Sep 2010 01:38:45 +0200
Subject: [Linux-uvc-devel] Logitech C910 video conference
Message-ID: <AANLkTi=LN97_RJs1o+BaUSyrTsDJESGsROdMeupB75Lo@mail.gmail.com>

Hello, I am new on this mail list, I want to try the Logitech C910
webcam to make some video conference between two different PCs on a
LAN.

I have some questions?

1. Is possible to manage this webcam with 1080p resolution?
2. Is the re any open-source conference software on GNU/Linux to
manage this streams?
3. Is there any better webcam or video capturer device to get working
on GNU/linux?

The idea is to configure two FullHD TVs on a 100Mbps LAN.

-- 
Josu Lazkano


From igor.demyanov at gmail.com  Sun Sep 12 13:28:44 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Sun, 12 Sep 2010 15:28:44 +0400
Subject: [Linux-uvc-devel] Always low fps
Message-ID: <AANLkTim6YX76XcZuFT5g1QWavA-dDqg9_1w8XSeQZh64@mail.gmail.com>

Hello.
I have a built-in camera (64e: a219 Suyin Corp) in a laptop Acer
Aspire 5745G. Image fine, but in all modes low fps = 7.5. Can anybody
tell how to solve this problem?
Change various settings through v4l2ucp, changed the resolution, fps always 7.5
Ready to provide any data.

#v4l2ctrl -s
9963776:                     Brightness:0
9963777:                       Contrast:32
9963778:                     Saturation:64
9963779:                            Hue:0
9963788:White Balance Temperature, Auto:1
9963792:                          Gamma:100
9963800:           Power Line Frequency:1
9963803:                      Sharpness:4
9963804:         Backlight Compensation:1

-- 
Best regards,
Igor Demyanov


From laurent.pinchart at ideasonboard.com  Sun Sep 12 12:14:18 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 12:14:18 +0200
Subject: [Linux-uvc-devel] [UVC] [Linux-UVC] put_unaligned_le32
In-Reply-To: <AANLkTi=52Te1Z7OzPm+pQ000q8-zVVHj2_j973KUufrf@mail.gmail.com>
References: <AANLkTi=52Te1Z7OzPm+pQ000q8-zVVHj2_j973KUufrf@mail.gmail.com>
Message-ID: <201009121214.19095.laurent.pinchart@ideasonboard.com>

Hi,

On Monday 30 August 2010 19:53:13 Palmax Maverick wrote:
> Hello,
> 
> I'm trying to understand uvc_set_video_ctrl (
> http://lxr.linux.no/linux+v2.6.35/drivers/media/video/uvc/uvc_video.c#L209
> ), that its a function for sending and receiving controls.
> 
> I don't know why do you use put_unaligned_le32 for dwMaxVideoFrameSize
> and dwMaxPayloadTransferSize (these parameters are explained at the
> table 4-47 of UVC especification pdf).

Because the fields are not aligned to a 32-bit boundary in memory. Platforms 
that can't handle unaligned access (such as ARM) need the put_unaligned_le32 
macro.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 13:32:40 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 13:32:40 +0200
Subject: [Linux-uvc-devel] Quirk no_fid needed for IMC 13d3:5103
In-Reply-To: <4C80ACD2.3020402@huijgen.tk>
References: <4C80ACD2.3020402@huijgen.tk>
Message-ID: <201009121332.41321.laurent.pinchart@ideasonboard.com>

Hi Mark,

On Friday 03 September 2010 10:07:46 Mark Huijgen wrote:
>  Hi all,
> 
> The integrated webcam found in the Medion Akoya all-in-one touch screen PC
> needs a quirk set to get it to work properly. Without it mplayer reports
> lots of select timeouts and the image is just green.
> 
> With quirk UVC_QUIRK_STREAM_NO_FID set the webcam works great.
> 
> Attached the lsusb -vv output for the webcam and the patch I made to add
> the quirk, maybe this patch can be merged?

Thanks for the report and the patch. I've applied the patch and updated the 
supported devices list.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 14:41:55 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 14:41:55 +0200
Subject: [Linux-uvc-devel] 046d:08c2 Logitech Quickcam Orbit/Sphere MP
	Controls Incompatibility
In-Reply-To: <000301cb49e4$b8a281a0$29e784e0$@com>
References: <000301cb49e4$b8a281a0$29e784e0$@com>
Message-ID: <201009121441.55884.laurent.pinchart@ideasonboard.com>

Hi Logan,

On Wednesday 01 September 2010 16:48:20 Logan Stonebraker wrote:
> Greetings,
> 
> I have been working with Paulo Assis on the quickcamteam forums.
> 
> We have been trying to determine why a Logitech Orbit MP 046d:08c2 is not
> responding to Pan (relative) or Tilt (relative) controls.  Pan/Tilt reset
> and all other Logitech specific controls work splendidly despite this.
> 
> The thread with the details is here:
> http://forums.quickcamteam.net/showthread.php?tid=685
> 
> I noticed on the uvc driver home page http://www.ideasonboard.org/uvc that
> the 046d:08c2 is listed as being compatible with no mention of these
> controls being unusable (albeit potentially unreliable with the footnotes).
> 
> We are unable to get past the camera reporting that it failed to query the
> control.
> 
> Interestingly enough pan and tilt functions work fine on any supported
> Windows OS using available pan/tilt control software.  We are thinking that
> perhaps the reason for this is that the uvcvideo driver expects to query
> these controls prior to setting their values (and fails to read), as
> opposed to the working windows drivers which (perhaps aware of this
> firmware issue) do not query the controls, rather just attempt to set
> their values.

The uvcvideo driver indeed tries to query the controls first. The Windows 
driver, being Logitech-specific, might skip that step.

> dmesg uvcvideo trace=15 on module insertion
> 
>  -snip-
> 
>  [ 1449.492454] USB Video Class driver (v0.1.0)
>  [ 1449.732361] uvcvideo: Control f70c9e90/2 is already defined.
>  [ 1449.741717] uvcvideo: Added control f70c9d90/1 to device 2 entity 9
>  [ 1449.752219] uvcvideo: Added control f70c9e50/2 to device 2 entity 9
>  [ 1449.752259] uvcvideo: Adding mapping Pan (relative) to control
> f70c9d90/1.
>  [ 1449.752278] uvcvideo: Adding mapping Tilt (relative) to control
> f70c9d90/1.
>  [ 1449.752294] uvcvideo: Adding mapping Pan Reset to control f70c9e50/2.
>  [ 1449.752309] uvcvideo: Adding mapping Tilt Reset to control f70c9e50/2.
>  [ 1449.752324] uvcvideo: Adding mapping Pan/tilt Reset to control
> f70c9e50/2.
>  [ 1449.752340] uvcvideo: Adding mapping Focus to control f70c9dd0/3.
>  [ 1449.752355] uvcvideo: Adding mapping LED1 Mode to control f70c9d10/1.
>  [ 1449.752371] uvcvideo: Adding mapping LED1 Frequency to control
> f70c9d10/1.
>  [ 1449.752387] uvcvideo: Adding mapping Disable video processing to
> control f70c9e90/5.
>  [ 1449.752402] uvcvideo: Adding mapping Raw bits per pixel to control
> f70c9fd0/8.
> 
> -snip-
> 
> sudo ./pan /dev/video0 128
>  control(0x009a0904) failed to set (error -1)
> 
> dmesg on attempting to set pan or tilt control (via either usb 1.1 or usb
> 2.0)
>  [3035.732371] uvcvideo: Failed to query (131) UVC control 1 (unit 9) : -32
> (exp. 4).

-32 is -EPIPE, which basically means that your camera failed to answer the 
GET_MAX (131) request on the pan/tilt control (control 1, unit 9). This is 
caused by a timing-related bug in the camera firmware described in footnote 1 
on the website. There's not much I can do about it. According to the messages 
you've posted on the forum, at least one of your test runs showed a different 
behaviour:

 [ 855.955995] uvcvideo: Control 0x009a0900 not found.
 [ 856.003477] uvcvideo: Failed to query (132) UVC control 1 (unit 9) : 1 
(exp. 4).
 [ 856.024605] uvcvideo: Failed to query (132) UVC control 1 (unit 9) : 1 
(exp. 4).
 [ 856.066239] uvcvideo: Control 0x009a0908 not found.

That's also what I get on my computer when I test the pan/tilt controls with 
the same camera. In this case the camera goes past the GET_MAX request, but 
answers the next GET_RES request with only 1 byte of data when the driver 
expect 4. I'll try to get information about that problem from Logitech.

[snip]

> Thank you in advance if you are able to assist in debugging this <or> at
> the very least making mention in a footnote that these specific pan and
> tilt controls could be totally unusable to warn potential 046d:08c2 Orbit
> owners about this issue.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 15:15:21 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 15:15:21 +0200
Subject: [Linux-uvc-devel] Web cam not listed in UVC database
In-Reply-To: <1283424633.7336.2.camel@WN-ANTEC-904>
References: <1283424633.7336.2.camel@WN-ANTEC-904>
Message-ID: <201009121515.22264.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 02 September 2010 12:50:33 Che wrote:
> Hi,
> This is the return line when i do :$ lsusb in terminal.
> 
> ID 0ac8:307b Z-Star Microelectronics Corp. USB 1.1 WebCam
> 
> I am about to trawl for an answer on how to get it running, but thought
> i would also report it to you.

Please send me the output of

lsusb -v -d 0ac8:307b

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 15:28:00 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 15:28:00 +0200
Subject: [Linux-uvc-devel] Multiple Camera Resolution
In-Reply-To: <4C7F0CAB.2020800@xnet.co.nz>
References: <4C7F0CAB.2020800@xnet.co.nz>
Message-ID: <201009121528.00968.laurent.pinchart@ideasonboard.com>

Hi Chris,

On Thursday 02 September 2010 04:32:11 Chris wrote:
> Hi,
> 
> I am using an embedded device and wish to get at least 2 USB webcams
> working at one time.
> I have been playing with the:
> bandwidth = stream->ctrl.dwMaxPayloadTransferSize;
> 
> And changed it to a variety of numbers finding that setting it to 768
> works: bandwidth = 768;
> 
> With the above setting I can get 4 webcams working at 320x240 at 1 fps.
> 
> I have tried: 768, 1024, 1536, 1792, 2048 (can run one cam at 640x480 only),
> 3072
> The only way I can get multiple cams at any resolution is at 768 and only
> 320x240.
> Ideally we want to be able to run up to 4 cams at 640x480.
> 
> I was wondering if there are any other ways to achieve this?
> I see there are a few posts this year around this topic by Laurent.

The camera reports the bandwidth requirements and the driver tries to fulfill 
them. You haven't reported the camera model and the frame formats, so I can 
only assume that your camera outputs uncompressed YUV images.

2 cameras streaming uncompressed video at 640x480 will exceed the maximum USB 
bandwidth. You have several options to achieve 4 simultaneous VGA streams:

- switch to MJPEG if your cameras supports hardware compression
- use multiple USB host controllers (on add-on PCI boards for instance)
- use cameras that can buffer whole images and use a lower frame rate (this is 
theoretical only, I don't know of any such camera in the mainstream market).

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 15:30:12 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 15:30:12 +0200
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <AANLkTinDktUZw2aD-NWunXt3SHW-WY5eAsbQm0H8S=Ob@mail.gmail.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<AANLkTinDktUZw2aD-NWunXt3SHW-WY5eAsbQm0H8S=Ob@mail.gmail.com>
Message-ID: <201009121530.12607.laurent.pinchart@ideasonboard.com>

Hi Igor,

On Thursday 02 September 2010 01:49:03 Igor Demyanov wrote:
> Work normal, low fps(7.5)
> v4l2ctrl -s
> 9963776:                     Brightness:0
> 9963777:                       Contrast:32
> 9963778:                     Saturation:64
> 9963779:                            Hue:0
> 9963788:White Balance Temperature, Auto:1
> 9963792:                          Gamma:100
> 9963800:           Power Line Frequency:1
> 9963803:                      Sharpness:4
> 9963804:         Backlight Compensation:1
> 
> lsusb
> Bus 001 Device 003: ID 064e:a219 Suyin Corp.
> Device Descriptor:

[snip]

>  // Cutting

Please send me the full descriptors.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 15:34:48 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 15:34:48 +0200
Subject: [Linux-uvc-devel] [Linux-UVC] [UVC] Probe at
	uvc_set_video_ctrl. bFormatIndex,
	dwMaxVideoFrameSize and dwMaxPayloadTransferSize
In-Reply-To: <AANLkTingr=WRHU4mcK8NNP_uY-jpG_c91wMh0fj-q0Zz@mail.gmail.com>
References: <AANLkTingr=WRHU4mcK8NNP_uY-jpG_c91wMh0fj-q0Zz@mail.gmail.com>
Message-ID: <201009121534.48816.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 02 September 2010 22:57:27 Palmax Maverick wrote:
> Dear Laurent and others linux-UVC developers,
> 
> I'm writting the messages of ctrl that will be based on yours. I'm
> trying to understand the meaning of the "probe" parameter of
> uvc_vide.c::uvc_get_video_ctrl
> 
> Could you tell me it please?

See section 4.3.1.1 in the UVC 1.1 specification.

> In addition, I want to know what is the value of bFormatIndex that It's the
> last selected. Have I to query it?

The current bFormatIndex value can be retrieved with a GET_CUR request on the 
video commit control.

> What is the meaning of dwMaxVideoFrameSize?

For frame-based formats (stream-based formats are not supported by the 
uvcvideo driver yet) the field stores the maximum size of a video frame.

> and dwMaxPayloadTransferSize at still image controls point of view?

It has the same meaning as for the video controls.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 15:36:04 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 15:36:04 +0200
Subject: [Linux-uvc-devel] Unlisted UVC Camera
In-Reply-To: <AANLkTin8_xvxE6-m429hOfyC9rFFX5234BtT4baw=Vf-@mail.gmail.com>
References: <AANLkTin8_xvxE6-m429hOfyC9rFFX5234BtT4baw=Vf-@mail.gmail.com>
Message-ID: <201009121536.05153.laurent.pinchart@ideasonboard.com>

Hi,

On Saturday 04 September 2010 19:40:30 Civil wrote:
> Device id: 04f2:b1be (Chicony Electronics Co., Ltd). Found on ASUS UL30Jt
> Laptop. Works well, but seems to be mounter upside-down.

Please send me the output of

lsusb -v -d 04f2:b1be

and (as root)

dmidecode

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Sun Sep 12 15:37:42 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Sun, 12 Sep 2010 15:37:42 +0200
Subject: [Linux-uvc-devel] Another Confirmed Model
In-Reply-To: <20100909010147.3f83eccd@shogun.epicvoyage.org>
References: <20100909010147.3f83eccd@shogun.epicvoyage.org>
Message-ID: <201009121537.42665.laurent.pinchart@ideasonboard.com>

Hi Chris,

On Thursday 09 September 2010 08:01:47 Chris Largret wrote:
> I purchased a used netbook with a Chicony webcam in it. Since there is
> a list of supported devices at http://www.ideasonboard.org/uvc/, I
> wanted to sound off.
> 
> As of the 2.6.33.4 kernel (slightly old now), UVC works with
> Chicony Electronics device ID 04f2:b084.

Thanks for the report. Could you please send me the output of

lsusb -v -d 04f2:b084

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Mon Sep 13 00:13:48 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 13 Sep 2010 00:13:48 +0200
Subject: [Linux-uvc-devel] Logitech C910, long exposures?
In-Reply-To: <20100908141432.GA1079@sunshine.barsnick.net>
References: <1283775895.4388.7.camel@block> <1283953018.4388.20.camel@block>
	<20100908141432.GA1079@sunshine.barsnick.net>
Message-ID: <201009130013.48864.laurent.pinchart@ideasonboard.com>

Hi,

On Wednesday 08 September 2010 16:14:32 Moritz Barsnick wrote:
> On Wed, Sep 08, 2010 at 15:36:58 +0200, Florian Echtler wrote:
> > If still image support (for still image method 2) were to be added,
> > would that bring exposure control with it? (probably not?)
> 
> Good question. I have no understanding of the UVC standard, I only know
> the still image buzzword from many threads here. :)
> In Message-Id: <200804162242.45541.laurent.pinchart at skynet.be>, Laurent
> wrote:
> > It all depends on the hardware. The UVC spec defines several method
> > to capture still images. The most common one, implemented by all the
> > webcams I've tested so far, is to take the next image from the video
> > stream. This won't help improving image quality.
> 
> So you're probably out of luck.

Still image capture won't bring exposure control.

> > Hm, but resolutions from full HD and up in YUYV show 1/2 fps? (Don't know
> > if this is actually equal to exposure time or just due to the
> > bandwidth..)
> 
> You're right, I missed that. It does say 1/2 (that's SPF, not FPS, by
> the way).
> 
> My experience - without having done _anything_ with re-adjusting
> autoexposure or the likes - is that the camera will expose as much of
> that interval if it needs to. But since it doesn't have an aperture, it
> reduces exposure time in better lighting. One of my personal webcam
> (non-UVC) installations is at constant 5 FPS, but only in the evening
> does movement appear blurry in the stream.

In theory, auto-exposure will modify the frame rate according to the light 
conditions and can lower the frame rate. It should never push the frame rate 
higher than the selected value.

> I do _not_ know whether a constant FPS and disabled autoexposure would
> lead to under-/overexposure but defined exposure time.

The UVC specification isn't very clear on the subject. It states that "[...] 
the manual exposure control is further limited by the frame interval, which 
always has higher precedence."

My understanding is that disabling auto-exposure and setting the exposure time 
manually should work when the requested exposure time is lower than the frame 
interval. The specificat

In practice I expect most webcams not to bother about this and honor the 
requested exposure time. I've just tested an old Logitech camera and it seems 
to work that way (although the exposure time values seem broken, a lower value 
corresponds to a higher exposure time).

> > Well, this is exactly the solution I am using right now :-)
> 
> Ha! :-) But you have valid points there. No mechanical wear in the web
> cam. (But my web cam's sensor seems to have deteriorated over the
> years.)

-- 
Regards,

Laurent Pinchart


From igor.demyanov at gmail.com  Mon Sep 13 00:31:41 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Mon, 13 Sep 2010 02:31:41 +0400
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer Aspire
	5745G)
In-Reply-To: <AANLkTim7g3mcdx=Trmg7oUP008xrEGD1ahZAdQQCR0nr@mail.gmail.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<AANLkTinDktUZw2aD-NWunXt3SHW-WY5eAsbQm0H8S=Ob@mail.gmail.com>
	<201009121530.12607.laurent.pinchart@ideasonboard.com>
	<AANLkTim7g3mcdx=Trmg7oUP008xrEGD1ahZAdQQCR0nr@mail.gmail.com>
Message-ID: <AANLkTin+bLWk1w9RPV=PyW+WxAm1SPX+ngG4Pik+=WHp@mail.gmail.com>

Hi Laurent,
lsusb -v attached.

I'm sorry if repeat. My first time using mailing list.
Please add the camera(064e:a219 Suyin Corp.) to supported
devices<http://www.ideasonboard.org/uvc/>
.

2010/9/12 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> Hi Igor,
>
> On Thursday 02 September 2010 01:49:03 Igor Demyanov wrote:
>> Work normal, low fps(7.5)
>> v4l2ctrl -s
>> 9963776:                     Brightness:0
>> 9963777:                       Contrast:32
>> 9963778:                     Saturation:64
>> 9963779:                            Hue:0
>> 9963788:White Balance Temperature, Auto:1
>> 9963792:                          Gamma:100
>> 9963800:           Power Line Frequency:1
>> 9963803:                      Sharpness:4
>> 9963804:         Backlight Compensation:1
>>
>> lsusb
>> Bus 001 Device 003: ID 064e:a219 Suyin Corp.
>> Device Descriptor:
>
> [snip]
>
>>  // Cutting
>
> Please send me the full descriptors.

-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100913/e9580d08/attachment.html>
-------------- next part --------------
Bus 001 Device 003: ID 064e:a219 Suyin Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x064e Suyin Corp.
  idProduct          0xa219 
  bcdDevice            2.15
  iManufacturer           2 Suyin
  iProduct                1 1.3M WebCam
  iSerial                 3 HF1315-S32B-OV01-VA-R02.01.05
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          527
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 1.3M WebCam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 1.3M WebCam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           77
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000153f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              5 1.3M WebCam
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                      307
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 73728000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 24330240
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 18432000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  6082560
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  4608000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           800
        dwMinBitRate                122880000
        dwMaxBitRate                122880000
        dwMaxVideoFrameBufferSize     2048000
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                157286400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled

From laurent.pinchart at ideasonboard.com  Mon Sep 13 00:47:55 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 13 Sep 2010 00:47:55 +0200
Subject: [Linux-uvc-devel] Slow frame rate windows/linux?
In-Reply-To: <002501cb4ee9$3838bca0$a8aa35e0$@gmail.com>
References: <002501cb4ee9$3838bca0$a8aa35e0$@gmail.com>
Message-ID: <201009130047.55965.laurent.pinchart@ideasonboard.com>

Hi Andrew,

On Wednesday 08 September 2010 02:03:02 Andrew Leech wrote:
> Hi everyone,
> 
> This may not be most appropriate place to ask, because the UVC device I'm
> building (custom hardware) actually seems to be working pretty well under
> linux, I'm getting a nice steady 25fps PAL picture. I just feel there's a
> lot of expertise here that someone may be able to assist.
> 
> The problem is my hardware under windows only gets ~10-12fps, and I need
> cross platform compatibility. It doesn't report any dropped frames, and it
> gets this speed no matter which renderer I use.
> 
> I don't think the problem is the pc, as I've tried it on a couple of
> different windows boxes and the working linux is in a vmware instance on
> the same pc anyway.
> 
> I feel there must be something wrong in my uvc descriptors / setup that is
> confusing the windows driver where the linux one is more forgiving. I've
> tried playing with the mix/max bitrates, and continuous vs static frame
> intervals, all to no avail.

If you post the output of lsusb -v I could check the descriptors.

> I've also added timestamps to my frames (uncompressed yuy2) which I think
> are working, but also noticed no difference.
> 
> Is there any way with the linux driver to check the frame timestamps, if
> they're wrong it should show up as late/missed frames?

The uvcvideo driver ignores timestamps at the moment;

> Has anyone got any suggestions? I really want to ensure my hardware is
> going to be stable on as wide a range of computers as possible.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Mon Sep 13 00:49:40 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 13 Sep 2010 00:49:40 +0200
Subject: [Linux-uvc-devel] Always low fps
In-Reply-To: <AANLkTim6YX76XcZuFT5g1QWavA-dDqg9_1w8XSeQZh64@mail.gmail.com>
References: <AANLkTim6YX76XcZuFT5g1QWavA-dDqg9_1w8XSeQZh64@mail.gmail.com>
Message-ID: <201009130049.41402.laurent.pinchart@ideasonboard.com>

Hi Igor,

On Sunday 12 September 2010 13:28:44 Igor Demyanov wrote:
> Hello.
> I have a built-in camera (64e: a219 Suyin Corp) in a laptop Acer
> Aspire 5745G.

Please send me the output of

lsusb -v -d 064e:a219

> Image fine, but in all modes low fps = 7.5. Can anybody tell how to solve
> this problem?
> Change various settings through v4l2ucp, changed the resolution, fps always
> 7.5 Ready to provide any data.
> 
> #v4l2ctrl -s
> 9963776:                     Brightness:0
> 9963777:                       Contrast:32
> 9963778:                     Saturation:64
> 9963779:                            Hue:0
> 9963788:White Balance Temperature, Auto:1
> 9963792:                          Gamma:100
> 9963800:           Power Line Frequency:1
> 9963803:                      Sharpness:4
> 9963804:         Backlight Compensation:1

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Mon Sep 13 00:51:30 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 13 Sep 2010 00:51:30 +0200
Subject: [Linux-uvc-devel] Maximising iram throughput?
In-Reply-To: <012901cb50af$70e70bc0$52b52340$@gmail.com>
References: <012901cb50af$70e70bc0$52b52340$@gmail.com>
Message-ID: <201009130051.31499.laurent.pinchart@ideasonboard.com>

Hi Andrew,

On Friday 10 September 2010 08:14:30 Andrew Leech wrote:
> Hi all,
> 
> Just wondering if anyone's found some tricks to speed up iram data
> throughput, specifically with dma transfers.

Are you sure you've sent this mail to the right mailing list ?

> My application is basically sending data (real time video) from the
> external static ram interface over USB. The catch is the data buffer sizes
> of the external data and the usb data need to be quite different so I've
> had to set up a double buffering arrangement, where I'm using the DMA to
> copy from external port to a large rolling buffer space in iram, and then
> on a separate dma channel copying the (smaller) chunks of data from the
> large buffer to my usb buffer/structs. The usb packets needs a header on
> each one, so I can't just give the usb a pointer to a location in the main
> buffer because it obviously won't have the header.
> 
> The system is technically working, but I'm running very low on memory bus
> bandwidth. The main issue is coming from latency in the external interface,
> I currently have it running with a MPMCStaticWaitRd0 of 1 and have a couple
> of errors in transmission. The errors are completely gone if I up the
> WaitRd to 2 but then the dma from buffer to usb is not keeping up.
> 
> The external ram interface is in 16 bit mode, and the write buffers (in
> MPMCStaticConfig) are disabled, I'm using interface strictly read only and
> enabling them slowed it down more.
> 
> Both dma channels are running in burst mode (16 byte chunks).
> 
> Clocks are all at csp default settings again, so mpmc, dma, ebi all at
> 90Mhz, core at 180Mhz.
> 
> I've tried SYS_REGS->eshctrl_sup4 = 0; to enable high speed performance
> mode on EBI, but that doesn't really seem to help much, not that I
> expected it to really.
> 
> I've also tried enabling instruction and data caches at start of main:
> 
>                 // Set virtual address of MMU table
>                 cp15_set_vmmu_addr((void *) ISROM_MMU_TTB_BASE);
>                 cp15_set_mmu(1);
>                 cp15_set_icache(1);
>                 cp15_set_dcache(1);
> 
> But I didn't notice any difference in application speed, can anyone confirm
> whether this is the correct way to enable the buffers? Although I guess
> these are buffers for the cpu, so wouldn't affect the dma anyway.
> 
> Basically I'd really like to speed up the iram - iram dma transfer to allow
> more bus bandwidth / time to devote to external ram - iram dma channel so I
> can slow the mpmc WaitRd down a touch and still kepp up with the video
> stream.

-- 
Regards,

Laurent Pinchart


From igor.demyanov at gmail.com  Mon Sep 13 00:54:25 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Mon, 13 Sep 2010 02:54:25 +0400
Subject: [Linux-uvc-devel] Always low fps
In-Reply-To: <201009130049.41402.laurent.pinchart@ideasonboard.com>
References: <AANLkTim6YX76XcZuFT5g1QWavA-dDqg9_1w8XSeQZh64@mail.gmail.com>
	<201009130049.41402.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=Pt0vb-V-+83cum77R70eHsyf_kV2UG-qoX9Mq@mail.gmail.com>

lsusb -v -d 064e:a219 attached

2010/9/13 Laurent Pinchart <laurent.pinchart at ideasonboard.com>

> Hi Igor,
>
> On Sunday 12 September 2010 13:28:44 Igor Demyanov wrote:
> > Hello.
> > I have a built-in camera (64e: a219 Suyin Corp) in a laptop Acer
> > Aspire 5745G.
>
> Please send me the output of
>
> lsusb -v -d 064e:a219
>
> > Image fine, but in all modes low fps = 7.5. Can anybody tell how to solve
> > this problem?
> > Change various settings through v4l2ucp, changed the resolution, fps
> always
> > 7.5 Ready to provide any data.
> >
> > #v4l2ctrl -s
> > 9963776:                     Brightness:0
> > 9963777:                       Contrast:32
> > 9963778:                     Saturation:64
> > 9963779:                            Hue:0
> > 9963788:White Balance Temperature, Auto:1
> > 9963792:                          Gamma:100
> > 9963800:           Power Line Frequency:1
> > 9963803:                      Sharpness:4
> > 9963804:         Backlight Compensation:1
>
> --
> Regards,
>
> Laurent Pinchart
>



-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100913/3b6ead5d/attachment.html>
-------------- next part --------------

Bus 001 Device 003: ID 064e:a219 Suyin Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x064e Suyin Corp.
  idProduct          0xa219 
  bcdDevice            2.15
  iManufacturer           2 Suyin
  iProduct                1 1.3M WebCam
  iSerial                 3 HF1315-S32B-OV01-VA-R02.01.05
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          527
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 1.3M WebCam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 1.3M WebCam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           77
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000153f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              5 1.3M WebCam
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                      307
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 73728000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 24330240
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 18432000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  6082560
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  4608000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           800
        dwMinBitRate                122880000
        dwMaxBitRate                122880000
        dwMaxVideoFrameBufferSize     2048000
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                157286400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled

From laurent.pinchart at ideasonboard.com  Mon Sep 13 00:58:04 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 13 Sep 2010 00:58:04 +0200
Subject: [Linux-uvc-devel] resetting resolution causes crash/failure
In-Reply-To: <20100903215845.GI29744@subspacefield.org>
References: <20100903215845.GI29744@subspacefield.org>
Message-ID: <201009130058.05116.laurent.pinchart@ideasonboard.com>

Hi Travis,

On Friday 03 September 2010 23:58:45 travis+ml-uvc-dev at subspacefield.org 
wrote:
> Hey all,
> 
> I'm using uvc/v4l2 and running into a weird problem.
> 
> Under VMWare Fusion, if I reset resolution twice, it hangs the VM.
> 
> Attached camera is a USB camera attached to host.
> 
> On a native machine, it merely causes the camera to return a blank
> screen.
> 
> Before getting into details, I wanted to see if anyone had a hunch as
> to why this might be.
> 
> Also, on my Ubuntu 9.04 box, I'm seeing lots of stuff in dmesg
> about uvcvideo: unknown event type x, where x varies, but 121
> is a popular value.  I assume that can be ignored and merely
> suggests the s/w is out of date.

What camera are you using ?

-- 
Regards,

Laurent Pinchart


From coronasensei at gmail.com  Mon Sep 13 01:06:37 2010
From: coronasensei at gmail.com (Andrew Leech)
Date: Mon, 13 Sep 2010 09:06:37 +1000
Subject: [Linux-uvc-devel] Maximising iram throughput?
In-Reply-To: <201009130051.31499.laurent.pinchart@ideasonboard.com>
References: <012901cb50af$70e70bc0$52b52340$@gmail.com>
	<201009130051.31499.laurent.pinchart@ideasonboard.com>
Message-ID: <015101cb52cf$29e7b4f0$7db71ed0$@gmail.com>

Ah whoops, yep I really though I picked a different email to reply to....
thanks for the heads up, I can ask the right lot now!

Andrew

-----Original Message-----
From: Laurent Pinchart [mailto:laurent.pinchart at ideasonboard.com] 
Sent: Monday, 13 September 2010 8:52 AM
To: linux-uvc-devel at lists.berlios.de
Cc: Andrew Leech
Subject: Re: [Linux-uvc-devel] Maximising iram throughput?

Hi Andrew,

On Friday 10 September 2010 08:14:30 Andrew Leech wrote:
> Hi all,
> 
> Just wondering if anyone's found some tricks to speed up iram data 
> throughput, specifically with dma transfers.

Are you sure you've sent this mail to the right mailing list ?

> My application is basically sending data (real time video) from the 
> external static ram interface over USB. The catch is the data buffer 
> sizes of the external data and the usb data need to be quite different 
> so I've had to set up a double buffering arrangement, where I'm using 
> the DMA to copy from external port to a large rolling buffer space in 
> iram, and then on a separate dma channel copying the (smaller) chunks 
> of data from the large buffer to my usb buffer/structs. The usb 
> packets needs a header on each one, so I can't just give the usb a 
> pointer to a location in the main buffer because it obviously won't have
the header.
> 
> The system is technically working, but I'm running very low on memory 
> bus bandwidth. The main issue is coming from latency in the external 
> interface, I currently have it running with a MPMCStaticWaitRd0 of 1 
> and have a couple of errors in transmission. The errors are completely 
> gone if I up the WaitRd to 2 but then the dma from buffer to usb is not
keeping up.
> 
> The external ram interface is in 16 bit mode, and the write buffers 
> (in
> MPMCStaticConfig) are disabled, I'm using interface strictly read only 
> and enabling them slowed it down more.
> 
> Both dma channels are running in burst mode (16 byte chunks).
> 
> Clocks are all at csp default settings again, so mpmc, dma, ebi all at 
> 90Mhz, core at 180Mhz.
> 
> I've tried SYS_REGS->eshctrl_sup4 = 0; to enable high speed 
> performance mode on EBI, but that doesn't really seem to help much, 
> not that I expected it to really.
> 
> I've also tried enabling instruction and data caches at start of main:
> 
>                 // Set virtual address of MMU table
>                 cp15_set_vmmu_addr((void *) ISROM_MMU_TTB_BASE);
>                 cp15_set_mmu(1);
>                 cp15_set_icache(1);
>                 cp15_set_dcache(1);
> 
> But I didn't notice any difference in application speed, can anyone 
> confirm whether this is the correct way to enable the buffers? 
> Although I guess these are buffers for the cpu, so wouldn't affect the dma
anyway.
> 
> Basically I'd really like to speed up the iram - iram dma transfer to 
> allow more bus bandwidth / time to devote to external ram - iram dma 
> channel so I can slow the mpmc WaitRd down a touch and still kepp up 
> with the video stream.

--
Regards,

Laurent Pinchart



From laurent.pinchart at ideasonboard.com  Mon Sep 13 01:11:34 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 13 Sep 2010 01:11:34 +0200
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <4C77C85C.4040504@ml1.co.uk>
References: <4C77C85C.4040504@ml1.co.uk>
Message-ID: <201009130111.35110.laurent.pinchart@ideasonboard.com>

Hi Martin,

On Friday 27 August 2010 16:14:52 Martin wrote:
> The problem:
> 
> From reading around this list and elsewhere, it appears that you simply
> cannot run more than one webcam video stream per USB root hub.
>
> When enabled for video streaming, the webcam reserves the full
> isochronous bandwidth needed to stream data at the selected resolution
> and framerate, regardless of whether your application acquires the full
> framerate or just samples at one frame per second.

That's not correct. The webcam reports its bandwidth requirements, and the 
driver allocates bandwidth accordingly. Some cameras are buggy and report high 
bandwidth requirements when they could use lower bandwidths.

> Hence, trying to set a low framerate in your user application has no effect
> to reduce the bandwidth from the webcam.

That's correct, because most webcams can't buffer a whole frame of video data 
and send it slowly over USB (embedded RAM is expensive). Even at lower frame 
rates, webcams might thus need high bandwidth for a short time. As USB 
bandwidth reservation takes the peak bandwidth into account, bandwidth will be 
wasted.

> The webcam is still streaming at the maximum framerate regardless.
> 
> I'm guessing that the video stream is being 'pushed' out by the webcam
> firmware and so the UVC driver must take all that it is given...

The webcam sends a frame at high speed and then waits a (relatively) long time 
before sending the next frame.

> *A possible solution* ?
> 
> Instead, could the UVC driver 'simulate' a reduced framerate by instead
> using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
> set number of images per second? Or even only when polled by a read from
> the user application?

Still image capture isn't supported yet. The reason is that most webcams just 
ask the driver to take the next picture in the video stream to emulate still 
image capture. Very few cameras support out-of-band still image capture, and I 
don't own any that support that.

As most cameras just ask the driver to capture the next frame in an active 
video stream this won't solve your problem anyway.

> On *nix, "everything is a file"... Could the uvc driver accept reading
> of /dev/videoX by the command "cp" so that still image data is copied,
> formatted for a jpg or png?

It would need to process the image (compress it to JPG or PNG), and that's not 
the job of a kernel driver, so no.

> Could the "quirks" setting be abused to set the image grab rate? Or some
> other neater method?
> 
> Further details:
> 
> I'm trying to use two webcams simultaneously:
> 
>   iManufacturer           1 Sweex
>   iProduct                2 WC060 Series HD Webcam

Please post the whole USB descriptors (lsusb -v)

> On separate hubs, they work fine. On the same hub, the second one to
> start shows the error:
> 
> "Error starting stream VIDIOC_STREAMON: No space left on device".
> 
> I've only got the one root hub on the system I want to use for the two
> webcams!
> 
> Their descriptors show:
> 
>         bFrameIntervalType                  2
>         dwFrameInterval( 0)           2000000
>         dwFrameInterval( 1)           4000000
> 
> 
> Can I tweak the UVC driver to preferentially choose the slower frame
> rate available?

You can select a frame rate explictly with VIDIOC_S_PARM.

> Aside: The MJPG format doesn't seem to work, nor are any compression
> settings visible...

Maybe your webcam doesn't support MJPG.

> Given a few hints or a patch, I can hack the kernel module to test :-)
> 
> This is running on Gentoo, kernel 2.6.34 using the in-kernel uvc module.
> 
> Any comment/ideas welcomed.

If you don't need to capture frames simultaneously, you can just start the 
video stream, capture a frame, stop the video stream, and repeat the sequence 
on the second webcam.

If you need higher frame rates, search the mailing list archives for 
discussions about bandwidth (dwMaxPayloadTransferSize is a keyword). You can 
also have a look at the "Multiple camera framerate." mail thread started by  
Dennis Muhlestein.

-- 
Regards,

Laurent Pinchart


From coronasensei at gmail.com  Mon Sep 13 01:30:35 2010
From: coronasensei at gmail.com (Andrew Leech)
Date: Mon, 13 Sep 2010 09:30:35 +1000
Subject: [Linux-uvc-devel] Slow frame rate windows/linux?
In-Reply-To: <201009130047.55965.laurent.pinchart@ideasonboard.com>
References: <002501cb4ee9$3838bca0$a8aa35e0$@gmail.com>
	<201009130047.55965.laurent.pinchart@ideasonboard.com>
Message-ID: <01f701cb52d2$8258d260$870a7720$@gmail.com>

Hi Laurent, all,
That's interesting about the timestamps, I though they were supposed to be
essential for synchronising audio and video properly. I'm not using audio
myself so not too concerned about that side of things. Also, there was a
small footnote on one of the msdn pages about interlacing requiring
timestamps so I had tried that for make interlacing work...it didn't work
and interlacing still isn't working properly so I stripped out oll the
interlacing descriptors and I'm going to do deinterlacing manually now
anyway because I need to do frame grabbing to disk so having proper video
card deinterlacing wouldn't help much anyway.

I think I may have found the source of my fps problems however, my frame is
768 x576, and as a point of convenience I found that sending 4 lines in a
uvc packet seemed to work just fine. 4 x 768 + 12 (header) turns out to be
1028 x 3 isoc usb packets, which is obviously more than you're allowed, but
because it was showing the picture just fine I thought it was ok.
Cropping the image to a smaller width though, and making the usb packets
smaller, seems to fix the frame rate in windows. It seems that while the usb
stack can handle the larger isoc packets, there's some buffering in the uvc
driver that's not large enough to work. I still need to do more testing to
confirm that's the root of the problem however. That's actually what that
other message I sent here by mistake was about, I meant to send it to the
lpc3000 group, I need a lot more buffering in chip to get my usb packet
sizes back down to legit sizes. I'll let you all know if I get it sorted
out, because it's a pretty deceptive problem, and highlights a way your
linux driver handles dodgy hardware better!

lsusb:
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x9999 
  idProduct          0x8000 
  bcdDevice            1.00
  iManufacturer           1 xxxx
  iProduct                2 xxx
  iSerial                 3 DEMO12345678
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          198
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower              100mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               2 xxx
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              2 xxx
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           50
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 5
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000001f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
        iProcessing             0 
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               8
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                       79
        bEndPointAddress                  131
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                1
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            768
        wHeight                           576
        dwMinBitRate                197376000
        dwMaxBitRate                197376000
        dwMaxVideoFrameBufferSize      884736
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  0
        dwMinFrameInterval             400000
        dwMaxFrameInterval           10000000
        dwFrameIntervalStep                 1
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1404  3x 1028 bytes
        bInterval               1


-----Original Message-----
From: Laurent Pinchart [mailto:laurent.pinchart at ideasonboard.com] 
Sent: Monday, 13 September 2010 8:48 AM
To: linux-uvc-devel at lists.berlios.de
Cc: Andrew Leech
Subject: Re: [Linux-uvc-devel] Slow frame rate windows/linux?

----

> I feel there must be something wrong in my uvc descriptors / setup 
> that is confusing the windows driver where the linux one is more 
> forgiving. I've tried playing with the mix/max bitrates, and 
> continuous vs static frame intervals, all to no avail.

If you post the output of lsusb -v I could check the descriptors.

> I've also added timestamps to my frames (uncompressed yuy2) which I 
> think are working, but also noticed no difference.
> 
> Is there any way with the linux driver to check the frame timestamps, 
> if they're wrong it should show up as late/missed frames?

The uvcvideo driver ignores timestamps at the moment;

> Has anyone got any suggestions? I really want to ensure my hardware is 
> going to be stable on as wide a range of computers as possible.

--
Regards,

Laurent Pinchart



From shop at open-t.co.uk  Mon Sep 13 01:39:36 2010
From: shop at open-t.co.uk (Sebastian)
Date: Mon, 13 Sep 2010 00:39:36 +0100
Subject: [Linux-uvc-devel] Maximising iram throughput?
In-Reply-To: <015101cb52cf$29e7b4f0$7db71ed0$@gmail.com>
References: <012901cb50af$70e70bc0$52b52340$@gmail.com>	<201009130051.31499.laurent.pinchart@ideasonboard.com>
	<015101cb52cf$29e7b4f0$7db71ed0$@gmail.com>
Message-ID: <4C8D64B8.2040002@open-t.co.uk>



On 09/13/2010 12:06 AM, Andrew Leech wrote:
> Ah whoops, yep I really though I picked a different email to reply to....
> thanks for the heads up, I can ask the right lot now!
>
> Andrew
>
> -----Original Message-----
> From: Laurent Pinchart [mailto:laurent.pinchart at ideasonboard.com]
> Sent: Monday, 13 September 2010 8:52 AM
> To: linux-uvc-devel at lists.berlios.de
> Cc: Andrew Leech
> Subject: Re: [Linux-uvc-devel] Maximising iram throughput?
>
> Hi Andrew,
>
> On Friday 10 September 2010 08:14:30 Andrew Leech wrote:
>> Hi all,
>>
>> Just wondering if anyone's found some tricks to speed up iram data
>> throughput, specifically with dma transfers.
>
> Are you sure you've sent this mail to the right mailing list ?

Thanks Laurent. I was lost there for a moment. I was scratching my head 
thinking I was even further behind technology then I thought I was :-)

Sebastian

>
>> My application is basically sending data (real time video) from the
>> external static ram interface over USB. The catch is the data buffer
>> sizes of the external data and the usb data need to be quite different
>> so I've had to set up a double buffering arrangement, where I'm using
>> the DMA to copy from external port to a large rolling buffer space in
>> iram, and then on a separate dma channel copying the (smaller) chunks
>> of data from the large buffer to my usb buffer/structs. The usb
>> packets needs a header on each one, so I can't just give the usb a
>> pointer to a location in the main buffer because it obviously won't have
> the header.
>>
>> The system is technically working, but I'm running very low on memory
>> bus bandwidth. The main issue is coming from latency in the external
>> interface, I currently have it running with a MPMCStaticWaitRd0 of 1
>> and have a couple of errors in transmission. The errors are completely
>> gone if I up the WaitRd to 2 but then the dma from buffer to usb is not
> keeping up.
>>
>> The external ram interface is in 16 bit mode, and the write buffers
>> (in
>> MPMCStaticConfig) are disabled, I'm using interface strictly read only
>> and enabling them slowed it down more.
>>
>> Both dma channels are running in burst mode (16 byte chunks).
>>
>> Clocks are all at csp default settings again, so mpmc, dma, ebi all at
>> 90Mhz, core at 180Mhz.
>>
>> I've tried SYS_REGS->eshctrl_sup4 = 0; to enable high speed
>> performance mode on EBI, but that doesn't really seem to help much,
>> not that I expected it to really.
>>
>> I've also tried enabling instruction and data caches at start of main:
>>
>>                  // Set virtual address of MMU table
>>                  cp15_set_vmmu_addr((void *) ISROM_MMU_TTB_BASE);
>>                  cp15_set_mmu(1);
>>                  cp15_set_icache(1);
>>                  cp15_set_dcache(1);
>>
>> But I didn't notice any difference in application speed, can anyone
>> confirm whether this is the correct way to enable the buffers?
>> Although I guess these are buffers for the cpu, so wouldn't affect the dma
> anyway.
>>
>> Basically I'd really like to speed up the iram - iram dma transfer to
>> allow more bus bandwidth / time to devote to external ram - iram dma
>> channel so I can slow the mpmc WaitRd down a touch and still kepp up
>> with the video stream.
>
> --
> Regards,
>
> Laurent Pinchart
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From mann88 at gmail.com  Mon Sep 13 08:40:41 2010
From: mann88 at gmail.com (David Mann)
Date: Mon, 13 Sep 2010 16:40:41 +1000
Subject: [Linux-uvc-devel] help
Message-ID: <AANLkTimB88xnP_vKTvZ8u5D0BCoRs7fAeaOxad+qfg0z@mail.gmail.com>

On Tue, Aug 31, 2010 at 4:31 PM,
<linux-uvc-devel-request at lists.berlios.de>wrote:

> Send Linux-uvc-devel mailing list submissions to
>        linux-uvc-devel at lists.berlios.de
>
> To subscribe or unsubscribe via the World Wide Web, visit
>        https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> or, via email, send a message with subject or body 'help' to
>        linux-uvc-devel-request at lists.berlios.de
>
> You can reach the person managing the list at
>        linux-uvc-devel-owner at lists.berlios.de
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Linux-uvc-devel digest..."
>
>
> Today's Topics:
>
>   1. Re: Running multiple webcams on the same hub (Martin)
>   2. [UVC] [Linux-UVC] put_unaligned_le32 (Palmax Maverick)
>   3. Interlaced UVC camera? (Andrew Leech)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 30 Aug 2010 12:30:48 +0100
> From: Martin <m_uvcdev at ml1.co.uk>
> To: linux-uvc-devel at lists.berlios.de
> Subject: Re: [Linux-uvc-devel] Running multiple webcams on the same
>        hub
> Message-ID: <4C7B9668.6020204 at ml1.co.uk>
> Content-Type: text/plain; charset=ISO-8859-1
>
> On 27/08/10 15:14, Martin wrote:
> > The problem:
> >
> > From reading around this list and elsewhere, it appears that you simply
> > cannot run more than one webcam video stream per USB root hub.
> >
> > When enabled for video streaming, the webcam reserves the full
> > isochronous bandwidth needed to stream data at the selected resolution
> > and framerate, regardless...
>
> Kindly, a direct reply suggested:
>
> ####
> ...the only way I've managed to get multiple cameras working was by
> using the mjpeg format. I've got this way working 3 cameras at 10fps
> 640x480 resolution on same root usb hub - and it looked like I might be
> able to get a fourth one. I would suggest you start by checking the
> specs for your cameras - if they are supposed to support mjpeg.
>
> Don't know how you are trying to get them working on mjpeg, but I used
> the command:
>
> ffmpeg -vcodec mjpeg -f video4linux2 -r 10 -s 640x480 -i /dev/video0
> ouputfile.ext
>
> The '-vcodec mjpeg' has to go in front of the '-i' option in order to
> request the stream in mjpeg format from the camera - after the '-i' it
> will merely convert the stream to mjpeg.
> ####
>
> Tried that and a few variations... Although the mjpeg streaming is
> accepted, there is no output. I've had the same non-result with other
> applications I've tried for getting a mjpeg stream from the WV060 webcam
> and the uvcvideo driver.
>
>
> > *A possible solution* ?
> >
> > Instead, could the UVC driver 'simulate' a reduced framerate by instead
> > using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
> > set number of images per second? Or even only when polled by a read from
> > the user application?
> >
> > On *nix, "everything is a file"... Could the uvc driver accept reading
> > of /dev/videoX by the command "cp" so that still image data is copied,
> > formatted for a jpg or png?
> >
> > Could the "quirks" setting be abused to set the image grab rate? Or some
> > other neater method?
>
> That still looks to be the best solution. The webcam is supposed to
> support still image capture, but how do I do that?! Is there a nice
> little snippet of C code that I can compile to grab a still image to a
> jpg or png?
>
>
> A gruesome work-around that does work is to use old USB 1.1 hubs to
> force the WC060 to a lower data rate. You can then have many webcams
> connected to your system! However...
>
> The WC060 reduces the maximum resolution to 640x480 rather than reduce
> the framerate. Quite a waste for the 1600x1200 that it supports;
>
> The USB 1.1 hubs must be plugged directly into the USB 2.0 root hub for
> a USB 1.1 root hub to be allocated (or for the UVC driver to work?);
>
> Use "lsusb -t" and "lsusb -v" to see what is happening.
>
>
> The USB 1.1 hubs that I picked up for very cheap correctly announce
> themselves as USB 1.1 but have a product name of "USB hub 2.0". Very
> Marketing-esq nasty!
>
> eg:
>
> Bus 003 Device 002: ID 05e3:0606 Genesys Logic, Inc. USB 2.0 Hub /
> D-Link DUB-H4 USB 2.0 Hub
> Device Descriptor:
>  bLength                18
>  bDescriptorType         1
>  bcdUSB               2.00
>  bDeviceClass            9 Hub
>  bDeviceSubClass         0 Unused
>  bDeviceProtocol         0 Full speed (or root) hub
>  bMaxPacketSize0         8
>  idVendor           0x05e3 Genesys Logic, Inc.
>  idProduct          0x0606 USB 2.0 Hub / D-Link DUB-H4 USB 2.0 Hub
>  bcdDevice            7.02
>  iManufacturer           1 ALCOR
>  iProduct                2 USB Hub 2.0
>
>
> Note: "Full speed" = USB 1.1 and "High speed" = USB 2.0 ... Hence,
> despite the confusing "2.0" in the descriptors, it is actually USB 1.1.
>
>
>
> Is the UVC driver still being developed? Are there features support yet
> to be added?
>
> Or is all this a problem of the user-side application software?
>
>
> Regards,
> Martin
>
>
>
> > Further details:
> >
> > I'm trying to use two webcams simultaneously:
> >
> >   iManufacturer           1 Sweex
> >   iProduct                2 WC060 Series HD Webcam
> >
> >
> > On separate hubs, they work fine. On the same hub, the second one to
> > start shows the error:
> >
> > "Error starting stream VIDIOC_STREAMON: No space left on device".
> >
> > I've only got the one root hub on the system I want to use for the two
> > webcams!
> >
> >
> > Their descriptors show:
> >
> >         bFrameIntervalType                  2
> >         dwFrameInterval( 0)           2000000
> >         dwFrameInterval( 1)           4000000
> >
> >
> > Can I tweak the UVC driver to preferentially choose the slower frame
> > rate available?
> >
> > Aside: The MJPG format doesn't seem to work, nor are any compression
> > settings visible...
> >
> >
> > Given a few hints or a patch, I can hack the kernel module to test :-)
> >
> > This is running on Gentoo, kernel 2.6.34 using the in-kernel uvc module.
> >
> > Any comment/ideas welcomed.
> >
> > Regards,
> > Martin
> >
> >
> >
> >
> > From lsusb -v (excerpt):
> >
> > VideoStreaming Interface Descriptor:
> >         bLength                            34
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
> >         bFrameIndex                         9
> >         bmCapabilities                   0x00
> >           Still image unsupported
> >         wWidth                           1600
> >         wHeight                          1200
> >         dwMinBitRate                   768000
> >         dwMaxBitRate                196608000
> >         dwMaxVideoFrameBufferSize     3840000
> >         dwDefaultFrameInterval        2000000
> >         bFrameIntervalType                  2
> >         dwFrameInterval( 0)           2000000
> >         dwFrameInterval( 1)           4000000
> > VideoStreaming Interface Descriptor:
> >         bLength                            42
> >         bDescriptorType                    36
> >         bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
> >         bEndpointAddress                    0
> >         bNumImageSizePatterns               9
> >         wWidth( 0)                        640
> >         wHeight( 0)                       480
> >         wWidth( 1)                        352
> >         wHeight( 1)                       288
> >         wWidth( 2)                        320
> >         wHeight( 2)                       240
> >         wWidth( 3)                        176
> >         wHeight( 3)                       144
> >         wWidth( 4)                        160
> >         wHeight( 4)                       120
> >         wWidth( 5)                        800
> >         wHeight( 5)                       600
> >         wWidth( 6)                       1280
> >         wHeight( 6)                       960
> >         wWidth( 7)                       1280
> >         wHeight( 7)                      1024
> >         wWidth( 8)                       1600
> >         wHeight( 8)                      1200
> >         bNumCompressionPatterns             9
>
>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 30 Aug 2010 19:53:13 +0200
> From: Palmax Maverick <palmax at gmail.com>
> To: Developers of UVC <linux-uvc-devel at lists.berlios.de>
> Subject: [Linux-uvc-devel] [UVC] [Linux-UVC] put_unaligned_le32
> Message-ID:
>        <AANLkTi=52Te1Z7OzPm+pQ000q8-zVVHj2_j973KUufrf at mail.gmail.com<52Te1Z7OzPm%2BpQ000q8-zVVHj2_j973KUufrf at mail.gmail.com>
> >
> Content-Type: text/plain; charset=UTF-8
>
> Hello,
>
>
> I'm trying to understand uvc_set_video_ctrl (
> http://lxr.linux.no/linux+v2.6.35/drivers/media/video/uvc/uvc_video.c#L209
> ), that its a function for sending and receiving controls.
>
> I don't know why do you use put_unaligned_le32 for dwMaxVideoFrameSize
> and dwMaxPayloadTransferSize (these parameters are explained at the
> table 4-47 of UVC especification pdf).
>
>
> Thanks for your help
> Palmax
>
>
> ------------------------------
>
> Message: 3
> Date: Tue, 31 Aug 2010 16:31:12 +1000
> From: "Andrew Leech" <coronasensei at gmail.com>
> To: <linux-uvc-devel at lists.berlios.de>
> Subject: [Linux-uvc-devel] Interlaced UVC camera?
> Message-ID: <000701cb48d6$1e432830$5ac97890$@gmail.com>
> Content-Type: text/plain;       charset="iso-8859-1"
>
> Hi All,
> I?m trying to develop a UVC video grabber device, which captures interlaced
> PAL video. My hardware (custom firmware on LPC3131 with a TVP5147 analog
> frontend) is working to the point of streaming video but I can?t get the
> computer to deinterlace the picture. The desired frame specs are a
> resolution of 768x576 @ 25fps, YUY2 16Bit. The video I?m streaming
> currently
> is each field separately, ie half frames at double the frame rate of
> 768x288
> @ 50fps. The way I read the UVC specs this should be a supported standard
> (One field per sample).
> I can?t seem to get the computer to think so however, it just shows the
> half
> height double rate frames. Is one field per sample format supported in the
> UVC driver, and if so how you to inform the driver of the format correctly.
>
> I?ve included my descriptors in the hope someone might see something there
> that?s askew, but I feel I?ve tried a lot of different things there with no
> positive results. One thing I noticed, it?s reporting 2 fields per frame in
> the interlaced flags, whereas bit 1 set should read as One field per frame
> according to the spec, so lsusb is reporting wrong?..? a minor bug. UVCview
> in windows reports it right for what it?s worth. On the flip side, lsusb
> seems to report bmVideoStandards correctly unlike UVCview, which gets those
> flags offset.
>
> I?m guessing that the interleaved line format is more common for
> interlaced,
> but that would require full frames worth of ram in my hardware which I just
> don?t have (I?ve got 96KB total ram where a half frame requires ~430KB ).
>
> I?ve been working on this for over a week and am really at a loss, any help
> would be very much appreciated.
>
> Thanks,
> Andrew Leech
>
> Device Descriptor:
> ? bLength??????????????? ???????????????????????????? 18
> ? bDescriptorType???????? ?????????????????? 1
> ? bcdUSB?????????????? ?????????????????????????????? 2.00
> ? bDeviceClass????????? ????????????????????????? 239 Miscellaneous Device
> ? bDeviceSubClass???????? ?????????????????? 2 ?
> ? bDeviceProtocol???????? ??????????????????? 1 Interface Association
> ? bMaxPacketSize0??????? ????????????????? 64
> ? idVendor?????????? ??????????????????????????????? 0x14e3
> ??idProduct????????? ??????????????????????????????? 0x8000
> ??bcdDevice??????????? ???????????????????????????? 1.00
> ? iManufacturer?????????? ????????????????????? 1
> ??iProduct??????????????? ???????????????????????????? 2
> ??iSerial????????????? ??????????????????????????????????? 3
> ??bNumConfigurations????? ????????????? 1
> ? Configuration Descriptor:
> ??? bLength???????????????? ????????????????????????? 9
> ??? bDescriptorType???????? ???????????????? 2
> ??? wTotalLength????????? ????????????????????? 191
> ??? bNumInterfaces????????? ???????????????? 2
> ??? bConfigurationValue???? ???????????? 1
> ??? iConfiguration????????? ???????????????????? 0
> ????bmAttributes???????? ??????????????????????? 0xc0
> ????? ????????????????????????????????????????????????????????? Self
> Powered
> ??? MaxPower????????????? ??????????????????????? 100mA
> ??? Interface Association:
> ????? bLength???????????????? ??????????????????????? 8
> ????? bDescriptorType??????? ??????????????? 11
> ????? bFirstInterface???????? ?????????????????? 0
> ????? bInterfaceCount???????? ?????????????? 2
> ??? ??bFunctionClass???????? ?????????????????? 14 Video
> ????? bFunctionSubClass?????? ???????????? 3 Video Interface Collection
> ????? bFunctionProtocol?????? ????????????? 0
> ??????iFunction?????????????? ??????????????????????? 2
> ????Interface Descriptor:
> ????? bLength???????????????? ??????????????????????? 9
> ????? bDescriptorType???????? ?????????????? 4
> ????? bInterfaceNumber??????? ??????????? 0
> ????? bAlternateSetting?????? ?????????????? 0
> ????? bNumEndpoints?????????? ????????????? 1
> ????? bInterfaceClass??????? ?????????????????? 14 Video
> ????? bInterfaceSubClass????? ???????????? 1 Video Control
> ????? bInterfaceProtocol????? ????????????? 0
> ??????iInterface????????????? ??????????????????????? 2
> ??????VideoControl Interface Descriptor:
> ??????? bLength??????????????? ?????????????????????? 13
> ??????? bDescriptorType??????? ????????????? 36
> ??????? bDescriptorSubtype????? ???????? 1 (HEADER)
> ??????? bcdUVC?????????????? ???????????????????????? 1.10
> ??????? wTotalLength?????????? ???????????????? 51
> ??????? dwClockFrequency?? ????????????? 480.000000MHz
> ??????? bInCollection?????????? ????????????????? 1
> ??????? baInterfaceNr( 0)?????? ????????????? 1
> ????? VideoControl Interface Descriptor:
> ??????? bLength??????????????? ?????????????????????? 17
> ??????? bDescriptorType??????? ????????????? 36
> ??????? bDescriptorSubtype????? ???????? 2 (INPUT_TERMINAL)
> ?? ?????bTerminalID???????????? ????????????????? 1
> ??????? wTerminalType????? ?????????????????? 0x0201 Camera Sensor
> ??????? bAssocTerminal????????? ????????????? 0
> ??????? iTerminal?????????????? ????????????????????? 0
> ????????wObjectiveFocalLengthMin????? 0
> ??????? wObjectiveFocalLengthMax????? 0
> ??????? wOcularFocalLength??????????? ?? 0
> ??????? bControlSize????????????????? ??????????? 2
> ??????? bmControls?????????? ???????????????????? 0x0000000f
> ????????                                ?   Scanning Mode
> ????????                                    Auto-Exposure Mode
>                                    Auto-Exposure Priority
> ?????????????????????????????????????????????????????????
> Exposure
> Time (Absolute)
> ????? VideoControl Interface Descriptor:
> ??????? bLength???????????????? ????????????????????? 9
> ??????? bDescriptorType??????? ????????????? 36
> ??????? bDescriptorSubtype????? ???????? 3 (OUTPUT_TERMINAL)
> ??????? bTerminalID???????????? ????????????????? 3
> ??????? wTerminalType????? ?????????????????? 0x0101 USB Streaming
> ??????? bAssocTerminal????????? ????????????? 0
> ??????? bSourceID?????????????? ??????????????????? 5
> ??????? iTerminal?????????????? ????????????????????? 0
> ??????VideoControl Interface Descriptor:
> ??????? bLength??????????????? ?????????????????????? 12
> ??????? bDescriptorType??????? ????????????? 36
> ??????? bDescriptorSubtype????? ???????? 5 (PROCESSING_UNIT)
> ??????? bUnitID???????????????? ?????????????????????? 5
> ??????? bSourceID?????????????? ??????????????????? 1
> ??????? wMaxMultiplier????????? ????????????? 0
> ??????? bControlSize??????????? ????????????????? 2
> ??????? bmControls???? ?????????????????????????? 0x00000001
> ?????????                               Brightness
> ??????? iProcessing???????????? ??????????????????? 0
> ????????bmVideoStandards???? ??????????? 0x 4
> ??????? ???????????????????????  ?              PAL - 625/50
> ????? Endpoint Descriptor:
> ??????? bLength???????????????? ????????????????????? 7
> ??????? bDescriptorType???????? ???????????? 5
> ??????? bEndpointAddress???? ???????????? 0x81? EP 1 IN
> ??????? bmAttributes??????????? ???????????????? 3
> ????????? Transfer Type ???????????????????????? Interrupt
> ????????? Synch Type?????????????? ??????????????? None
> ????????? Usage Type?????????????? ?????????????? Data
> ??????? wMaxPacketSize???? ???????????????? 0x0008? 1x 8 bytes
> ??????? bInterval?????????????? ?????????????????????? 8
> ??? Interface Descriptor:
> ????? bLength???????????????? ??????????????????????? 9
> ????? bDescriptorType???????? ?????????????? 4
> ????? bInterfaceNumber??????? ??????????? 1
> ????? bAlternateSetting?????? ?????????????? 0
> ????? bNumEndpoints?????????? ????????????? 0
> ????? bInterfaceClass??????? ?????????????????? 14 Video
> ????? bInterfaceSubClass????? ???????????? 2 Video Streaming
> ????? bInterfaceProtocol????? ????????????? 0
> ??????iInterface????????????? ??????????????????????? 0
> ??????VideoStreaming Interface Descriptor:
> ??????? bLength??????????????????????????? ?????????? 14
> ??????? bDescriptorType??????????????????? ? 36
> ??????? bDescriptorSubtype????????????? ?1 (INPUT_HEADER)
> ??????? bNumFormats???????????? ????????????? 1
> ??????? wTotalLength?????????????????????? ???? 71
> ??????? bEndPointAddress???????? ???????? 131
> ??????? bmInfo????????????????????????????? ?????????? 0
> ??????? bTerminalLink?????????????????????? ???? 3
> ??????? bStillCaptureMethod?????????? ? 1
> ??????? bTriggerSupport???????????????????? ? 1
> ??????? bTriggerUsage?????????????????????? ??? 0
> ??????? bControlSize??????????????????????? ????? 1
> ??????? bmaControls( 0)??????????????????? ?? 27
> ????? VideoStreaming Interface Descriptor:
> ??????? bLength??????????????????????????? ?????????? 27
> ??????? bDescriptorType??????????????????? ? 36
> ??????? bDescriptorSubtype??????????? ?? 4 (FORMAT_UNCOMPRESSED)
> ??????? bFormatIndex??????????????????????? ?? 1
> ??????? bNumFrameDescriptors???? ? 1
> ??????? guidFormat {59555932-0000-1000-8000-00aa00389b71}
> ??????? bBitsPerPixel????????????????????? ?????? 16
> ??????? bDefaultFrameIndex?????? ?????? 1
> ??????? bAspectRatioX?????????????????????? ?? 4
> ??????? bAspectRatioY?????????????????????? ??? 3
> ??????? bmInterlaceFlags???????????????? ???    0x67
> ??????? ??Interlaced stream or variable:        Yes
> ????????? Fields per frame: ??????????????????  2 fields
> ????????? Field 1 first: ?????????????????????????????  Yes
> ????????? Field pattern: ?????????????????????????      Regular pattern of
> fields 1 and 2
> ????????? bCopyProtect????????????????????? ??? 0
> ????? VideoStreaming Interface Descriptor:
> ??????? bLength??????????????????????????? ?????????? 30
> ??????? bDescriptorType??????????????????? ? 36
> ??????? bDescriptorSubtype???????? ????? 5 (FRAME_UNCOMPRESSED)
> ??????? bFrameIndex???????????????????????? ??? 1
> ??????? bmCapabilities?????????????????? ?????? 0x03
> ??????                          Still image supported
> ?????????                               Fixed frame-rate
> ??????? wWidth??????????????????????????? ??????????? 768
> ??????? wHeight?????????????????????????? ??????????? 288
> ??????? dwMinBitRate??????????????? ?????????? 174489600
> ??????? dwMaxBitRate??????????????? ????????? 174489600
> ????? ??dwMaxVideoFrameBufferSize????? 436224
> ??????? dwDefaultFrameInterval ???? 200000
> ??????? bFrameIntervalType??????? ?????? 1
> ??????? dwFrameInterval( 0)??????????? ? 200000
> ????? VideoStreaming Interface Descriptor:
> ??????? bLength???????????????????????????? ????????? 6
> ?? ?????bDescriptorType??????????????????? ? 36
> ??????? bDescriptorSubtype????????? ???? 13 (COLORFORMAT)
> ??????? bColorPrimaries????????????????? ????? 1 (BT.709,sRGB)
> ??????? bTransferCharacteristics??? ?? 1 (BT.709)
> ??????? bMatrixCoefficients??????????? ??? 4 (SMPTE 170M (BT.601))
> ??? Interface Descriptor:
> ????? bLength???????????????? ??????????????????????? 9
> ????? bDescriptorType???????? ?????????????? 4
> ????? bInterfaceNumber??????? ??????????? 1
> ????? bAlternateSetting?????? ?????????????? 1
> ????? bNumEndpoints?????????? ????????????? 1
> ????? bInterfaceClass??????? ?????????????????? 14 Video
> ????? bInterfaceSubClass????? ???????????? 2 Video Streaming
> ????? bInterfaceProtocol????? ????????????? 0
> ??????iInterface????????????? ??????????????????????? 0
> ??????Endpoint Descriptor:
> ??????? bLength???????????????? ????????????????????? 7
> ??????? bDescriptorType???????? ???????????? 5
> ??????? bEndpointAddress???? ???????????? 0x83? EP 3 IN
> ??????? bmAttributes??????????? ???????????????? 5
> ????????? Transfer Type??????????? ????????????? Isochronous
> ????????? Synch Type?????????????? ??????????????? Asynchronous
> ????????? Usage Type?????????????? ?????????????? Data
> ??????? wMaxPacketSize???? ???????????????? 0x1404? 3x 1028 bytes
> ??????? bInterval????????? ??????????????????????????? 1
>
>
>
> ------------------------------
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>
> End of Linux-uvc-devel Digest, Vol 50, Issue 24
> ***********************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100913/a3bffbe4/attachment.html>

From m_uvcdev at ml1.co.uk  Tue Sep 14 11:36:56 2010
From: m_uvcdev at ml1.co.uk (Martin)
Date: Tue, 14 Sep 2010 10:36:56 +0100
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <201009130111.35110.laurent.pinchart@ideasonboard.com>
References: <4C77C85C.4040504@ml1.co.uk>
	<201009130111.35110.laurent.pinchart@ideasonboard.com>
Message-ID: <4C8F4238.50009@ml1.co.uk>

Thanks for the comments and explanation.

On 13/09/10 00:11, Laurent Pinchart wrote:
> Hi Martin,
> 
> On Friday 27 August 2010 16:14:52 Martin wrote:
>> The problem:

[...]

> The webcam sends a frame at high speed and then waits a (relatively) long time 
> before sending the next frame.
> 
>> *A possible solution* ?
>>
>> Instead, could the UVC driver 'simulate' a reduced framerate by instead
>> using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
>> set number of images per second? Or even only when polled by a read from
>> the user application?
> 
> Still image capture isn't supported yet. The reason is that most webcams just 
> ask the driver to take the next picture in the video stream to emulate still 
> image capture. Very few cameras support out-of-band still image capture, and I 
> don't own any that support that.
> 
> As most cameras just ask the driver to capture the next frame in an active 
> video stream this won't solve your problem anyway.

That's quite a shame... And very wasteful of bandwidth.

I guess we need slightly more expensive webcams that buffer an image
into local ram before forwarding it on at whatever USB rate might be
available. No go on that one I guess...



>> Further details:
>>
>> I'm trying to use two webcams simultaneously:
>>
>>   iManufacturer           1 Sweex
>>   iProduct                2 WC060 Series HD Webcam
> 
> Please post the whole USB descriptors (lsusb -v)

I've attached "lsusb -v -d 177f:0060".



[...]
>> Can I tweak the UVC driver to preferentially choose the slower frame
>> rate available?
> 
> You can select a frame rate explictly with VIDIOC_S_PARM.
> 
>> Aside: The MJPG format doesn't seem to work, nor are any compression
>> settings visible...
> 
> Maybe your webcam doesn't support MJPG.
> 
>> Given a few hints or a patch, I can hack the kernel module to test :-)
>>
>> This is running on Gentoo, kernel 2.6.34 using the in-kernel uvc module.
>>
>> Any comment/ideas welcomed.
> 
> If you don't need to capture frames simultaneously, you can just start the 
> video stream, capture a frame, stop the video stream, and repeat the sequence 
> on the second webcam.
> 
> If you need higher frame rates, search the mailing list archives for 
> discussions about bandwidth (dwMaxPayloadTransferSize is a keyword). You can 
> also have a look at the "Multiple camera framerate." mail thread started by  
> Dennis Muhlestein.

Thanks for the pointers.


I've had mixed results with (bash):

while true
do
	ffmpeg -v 5 -y -r 5 -vframes 2 -s xga -f video4linux2 -i /dev/video0
-sameq -f image2 foo0-%03d.jpg
	sleep 5
	ffmpeg -v 5 -y -r 5 -vframes 2 -s xga -f video4linux2 -i /dev/video1
-sameq -f image2 foo1-%03d.jpg
	sleep 5
	date -R
done


That sometimes works fine, and then can randomly freeze at the point
where ffmpeg is to capture a frame. Usually, the freeze-up scenario is
that /dev/video0 is captured fine and then ffmpeg freezes on /dev/video1.

The "-r 5" may well not be needed. "-vframes 1" also works for if you
just want one frame, although I've found the first frame can be
overexposed compared to the following frames.

Not sure if -sameq is doing anything. Trying -bitexact always caused an
error for the options.

The "sleep 5" appears to help to allow operation for longer (a minute or
so) before ffmpeg freezing.

Running ffmpeg manually, one webcam at a time usually works fine.

Using "-r 30 -s vga" for the default framerate and 640x480 always works...


So... Is there some timing race or other untidiness whereby ffmpeg jams
or the video stream otherwise doesn't start?


I've only got one PCI slot... Are there any PCI cards with multiple
separate USB hubs?! (I suspect not...)

Regards,
Martin

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lsusb.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100914/d8195063/attachment.txt>

From floe at butterbrot.org  Tue Sep 14 12:14:04 2010
From: floe at butterbrot.org (Florian Echtler)
Date: Tue, 14 Sep 2010 12:14:04 +0200
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <4C8F4238.50009@ml1.co.uk>
References: <4C77C85C.4040504@ml1.co.uk>
	<201009130111.35110.laurent.pinchart@ideasonboard.com>
	<4C8F4238.50009@ml1.co.uk>
Message-ID: <1284459244.15800.14.camel@flunder>

> > The webcam sends a frame at high speed and then waits a (relatively) long time 
> > before sending the next frame.
> > 
> >> *A possible solution* ?
> >>
> >> Instead, could the UVC driver 'simulate' a reduced framerate by instead
> >> using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
> >> set number of images per second? Or even only when polled by a read from
> >> the user application?
> > Still image capture isn't supported yet. The reason is that most webcams just 
> > ask the driver to take the next picture in the video stream to emulate still 
> > image capture. Very few cameras support out-of-band still image capture, and I 
> > don't own any that support that.
> That's quite a shame... And very wasteful of bandwidth.
A few days ago, I posted a very rough patch for preliminary still image
support. According to the descriptors you attached, your camera actually
supports still image capture method 2, which is the "true" one.

Right now, with this patch, it is necessary to start and stop the stream
before and after each picture; I assume ffmpeg should do this if you ask
it to capture exactly 1 frame.

So if you are feeling curious, you could give my patch a try; I'd be
quite interested in some experience reports. 

Florian



From jyrki.rajala at antso.se  Tue Sep 14 14:50:26 2010
From: jyrki.rajala at antso.se (jyrki rajala)
Date: Tue, 14 Sep 2010 14:50:26 +0200
Subject: [Linux-uvc-devel] Two Fantec eMPIA's(eb1a:2771 eMPIA) cannot be run
 simultaneously on a system...
Message-ID: <57FDC2BAC5339C4F8E2E845F0F2258553CEA054990@vampire.ttmail.local>

Hello mailinglist!

First time mailinglisting for me, don't know much about it, but I'll try to make an effort.



Sorry for poorly written english in this letter...

I'm looking for a solution to the fantec eMPIA's(eb1a:2771 eMPIA) problem.
Using one fantec works, tough I cannot change framerate on it.

But using TWO fantec's doesn't work.
I did contact the company who delivered the cameras to us. And...


This is the final respons from the letters I've sent to Axiomtek in Taiwan...

> Hi Edsor,
>
>    Since it's UVC driver, nothing we can do with it. For the firmware, it might
>    be a little chance. Would you please provide couple devices for us to do some experiment?
>
> Andy



These are emails I've sent to axiomtek in Taiwan.


> This output comes from an Ubuntu 10.04 with kernel 2.6.32-24-generic-pae
>  #39-Ubuntu SMP Wed Jul 28 07:39:26 UTC 2010 i686 GNU/Linux
>
> I attempted to play video0 first, on its own, it worked as expected.
> Then I plugged second camera, tested it alone, worked as expected.
> I let it run while trying to start video0
>
> And this is the result...
>
> It complains about no space left on device video0....
>
> If I start video0 first and then start video1, mplayer on video1 will complain
>  about same thing.
>
>
> When I tried luvcview or guvcview i found out that these applications could
>  NOT set any other framerate than 30 fps. No mather the size of image 160x120,
>  320x240 or 640x480. And yes, these applications suffer from the same problem.
>
> I did test yv12 as format from device, but still the same result.
>
> dmesg reveals several rows like this
>
> "uvcvideo: Failed to submit URB 0 (-28)"
>  (these rows only appears when trying to run second mplayer simultaneously)
>
>
> Using spc900nc or spc1030nc is no problem at all, I can have FOUR simultaneus
>  cameras running with mplayer. If however I use ONE fangtec eMPIA and almost
>  another anything else it'll work. spc630nc did not play well.
>
> Since mplayer, luvcview and guvcview suffers from the same problems as my own
>  software, these will do as examples.


> (ps! I've cut irrelevant info.)
>********************************************************''*******************>
>mplayer -cache 256 -tv driver=v4l2:width=320:height=240:outfmt=mjpg:device=/dev/video1:fps=20 -vo xv tv://
>
>
> MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009 MPlayer Team
>
> Selected driver: v4l2
>  name: Video 4 Linux 2 input
> v4l2: your device driver does not support VIDIOC_G_STD ioctl, VIDIOC_G_PARM was used instead.
> Selected device: UVC Camera (eb1a:2771)
>  Capabilites:  video capture  streaming
>  supported norms:
>  inputs: 0 = Camera 1;
>  Current input: 0
>  Current format: YUYV
> v4l2: ioctl set format failed: Invalid argument
> tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
> v4l2: ioctl enum norm failed: Invalid argument
> Error: Cannot set norm!
> ==========================================================================
> Opening video decoder: [raw] RAW Uncompressed Video
> VDec: vo config request - 320 x 240 (preferred colorspace: Packed YUY2)
> VDec: using Packed YUY2 as output csp (no 0)  Movie-Aspect is undefined - no prescaling applied.
> VO: [xv] 320x240 => 320x240 Packed YUY2  Selected video codec: [rawyuy2] vfm: raw (RAW YUY2)
> ==========================================================================
> Starting playback...
> v4l2: 2126 frames successfully processed, 227 frames dropped.
>
> Exiting... (Quit)
>
>
>********************************************************''*******************
>
>mplayer -cache 256 -tv driver=v4l2:width=320:height=240:outfmt=mjpg:device=/dev/video0:fps=20 -vo xv tv://
>
> MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009 MPlayer Team
>
> Selected driver: v4l2
>  name: Video 4 Linux 2 input
> v4l2: your device driver does not support VIDIOC_G_STD ioctl, VIDIOC_G_PARM was used instead.
> Selected device: UVC Camera (eb1a:2771)
>  Capabilites:  video capture  streaming
>  supported norms:
>  inputs: 0 = Camera 1;
>  Current input: 0
>  Current format: YUYV
> v4l2: ioctl set format failed: Invalid argument
> tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
> v4l2: ioctl enum norm failed: Invalid argument
> Error: Cannot set norm!
> ==========================================================================
> Opening video decoder: [raw] RAW Uncompressed Video
> VDec: vo config request - 320 x 240 (preferred colorspace: Packed YUY2)
> VDec: using Packed YUY2 as output csp (no 0)  Movie-Aspect is undefined - no prescaling applied.
> VO: [xv] 320x240 => 320x240 Packed YUY2  Selected video codec: [rawyuy2] vfm: raw (RAW YUY2)
>  ==========================================================================
> Starting playback...
> v4l2: ioctl streamon failed: No space left on device
> No bind found for key 'MOUSE_BTN0'.
> v4l2: ioctl set mute failed: Invalid argument
> v4l2: 0 frames successfully processed, 0 frames dropped.
>
> Exiting... (Quit)
>
>
>
>*****************************************************************************
>
>
>
> mplayer -cache 256 -tv driver=v4l2:width=320:height=240:outfmt=yv12:device=/dev/video1:fps=20 -vo xv tv://
>
> MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009 MPlayer Team
>
> Selected driver: v4l2
>  name: Video 4 Linux 2 input
> v4l2: your device driver does not support VIDIOC_G_STD ioctl, VIDIOC_G_PARM was used instead.
> Selected device: UVC Camera (eb1a:2771)
>  Capabilites:  video capture  streaming
>  supported norms:
>  inputs: 0 = Camera 1;
>  Current input: 0
>  Current format: YUYV
> v4l2: ioctl set format failed: Invalid argument
> tv.c: norm_from_string(pal): Bogus norm parameter, setting default.
> v4l2: ioctl enum norm failed: Invalid argument
> Error: Cannot set norm!
> ==========================================================================
> Starting playback...
> v4l2: ioctl streamon failed: No space left on device
> v4l2: ioctl set mute failed: Invalid argument
> v4l2: 0 frames successfully processed, 0 frames dropped.
>
> Exiting... (Quit)
>
>
>
>*****************************************************************************
>
>
>Best regards JOR

>> Hello Eric!
>>
>>
>> I'm having problems getting TWO fantec eMPIA's(eb1a:2771 eMPIA) to work at the same time.
>>  I can only use systems with one eMPIA-camera installed. Though if I use another camera,
>>  say spc1030nc THEN I'll be able to use two cameras in one system.
>>
>> I.E. One eMPIA and one spc1030nc works flawlessly...
>>
>> Two spc1030nc works flawlessly...
>>
>> But two eMPIA will NOT.
>>
>> I had my suspicions on hardware issues, but since they work good on windows-laptops.
>>
>> For the moment I'm using 2.6.30 on a Gentoo-based system, with uvcdriver.
>>
>>
>> Do you have any suggestions for how to solve this?
>>
>> Special-drivers, special-setup scripts, other uvc-drivers?
>>
>>
>> Best regards  Jyrki Rajala.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100914/63f33064/attachment.html>

From coronasensei at gmail.com  Wed Sep 15 09:04:58 2010
From: coronasensei at gmail.com (Andrew Leech)
Date: Wed, 15 Sep 2010 17:04:58 +1000
Subject: [Linux-uvc-devel] Slow frame rate windows/linux?
References: <002501cb4ee9$3838bca0$a8aa35e0$@gmail.com>
	<201009130047.55965.laurent.pinchart@ideasonboard.com> 
Message-ID: <02a201cb54a4$517bd1f0$f47375d0$@gmail.com>

Just an update, yeah I've confirmed that the USB isoc packet sizes were the
culprit. Linux can handle overspec'd usb packets (1028 bytes), it appears
that the microsoft usb stack can handle them, but microsoft's usbvideo.sys
can't, it misses about every second frame. 

Fixed the usb packet size to be <= 1024 and it streams just fine in both
windows and linux!

Cheers,
Andrew

-----Original Message-----
From: Laurent Pinchart [mailto:laurent.pinchart at ideasonboard.com]
Sent: Monday, 13 September 2010 8:48 AM
To: linux-uvc-devel at lists.berlios.de
Cc: Andrew Leech
Subject: Re: [Linux-uvc-devel] Slow frame rate windows/linux?

----

> I feel there must be something wrong in my uvc descriptors / setup 
> that is confusing the windows driver where the linux one is more 
> forgiving. I've tried playing with the mix/max bitrates, and 
> continuous vs static frame intervals, all to no avail.

If you post the output of lsusb -v I could check the descriptors.

> I've also added timestamps to my frames (uncompressed yuy2) which I 
> think are working, but also noticed no difference.
> 
> Is there any way with the linux driver to check the frame timestamps, 
> if they're wrong it should show up as late/missed frames?

The uvcvideo driver ignores timestamps at the moment;

> Has anyone got any suggestions? I really want to ensure my hardware is 
> going to be stable on as wide a range of computers as possible.

--
Regards,

Laurent Pinchart



From chrisfriedt at gmail.com  Wed Sep 15 17:00:56 2010
From: chrisfriedt at gmail.com (Christopher Friedt)
Date: Wed, 15 Sep 2010 11:00:56 -0400
Subject: [Linux-uvc-devel] pwc driver breakage in recent kernels (for old
	hardware)
Message-ID: <AANLkTi=LRyBB_3=ueN4gY-LSYXH3CouVxLBNbjCUgA21@mail.gmail.com>

Hi everyone,

I've been using a Logitech Sphere for years on various projects. This
model is probably from the first batch ever made. In lsusb it shows up
as

046d:08b5 Logitech, Inc. QuickCam Sphere

It's a bit troublesome, because on older kernel versions (~2.4.x,
~2.6.2x) I never had a single issue with this hardware at all, on
several different platforms ranging from x86 to x86_64, to arm
(ep93xx), etc. However, somewhere between then and now, the pwc driver
underwent some changes rendering this device unusable in any recent
kernel. All of my old apps and new apps (including cheese, mplayer,
etc) simply hang indefinitely waiting to read a single frame (using
the v4l2 mmap api). The v4l2 read api also hangs indefinitely (using
pwcgrab). A few of the very old apps that I have also use the v4l1
api, with a 2.4.26 kernel, and that actually works.

I can verify that the hardware itself is fine on windows (also using
very old drivers from Logitech).

Who has been working on this driver? What were the major changes that
have been applied? I'm guessing that the bridge / sensor init sequence
has been messed up somehow. Any ideas?

Cheers,

Chris


From pj.assis at gmail.com  Wed Sep 15 17:20:56 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 15 Sep 2010 16:20:56 +0100
Subject: [Linux-uvc-devel] pwc driver breakage in recent kernels (for
	old hardware)
In-Reply-To: <AANLkTi=LRyBB_3=ueN4gY-LSYXH3CouVxLBNbjCUgA21@mail.gmail.com>
References: <AANLkTi=LRyBB_3=ueN4gY-LSYXH3CouVxLBNbjCUgA21@mail.gmail.com>
Message-ID: <AANLkTinj=MG-iCHgNANBRx2=_pxadNQDqdgUd3Wk4=mx@mail.gmail.com>

Hi,
you should post this on the linux-media mailing list:
http://www.linuxtv.org/news.php?entry=2009-01-06.mchehab

I see no recent changes for pwc:
http://git.linuxtv.org/v4l-dvb.git?a=history;f=drivers/media/video/pwc;hb=1c1371c2fe53ded8ede3a0404c9415fbf3321328

although I seem to remember a patch posted recently in linux-media for
this driver.

Regards,
Paulo

2010/9/15 Christopher Friedt <chrisfriedt at gmail.com>:
> Hi everyone,
>
> I've been using a Logitech Sphere for years on various projects. This
> model is probably from the first batch ever made. In lsusb it shows up
> as
>
> 046d:08b5 Logitech, Inc. QuickCam Sphere
>
> It's a bit troublesome, because on older kernel versions (~2.4.x,
> ~2.6.2x) I never had a single issue with this hardware at all, on
> several different platforms ranging from x86 to x86_64, to arm
> (ep93xx), etc. However, somewhere between then and now, the pwc driver
> underwent some changes rendering this device unusable in any recent
> kernel. All of my old apps and new apps (including cheese, mplayer,
> etc) simply hang indefinitely waiting to read a single frame (using
> the v4l2 mmap api). The v4l2 read api also hangs indefinitely (using
> pwcgrab). A few of the very old apps that I have also use the v4l1
> api, with a 2.4.26 kernel, and that actually works.
>
> I can verify that the hardware itself is fine on windows (also using
> very old drivers from Logitech).
>
> Who has been working on this driver? What were the major changes that
> have been applied? I'm guessing that the bridge / sensor init sequence
> has been messed up somehow. Any ideas?
>
> Cheers,
>
> Chris
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From laurent.pinchart at ideasonboard.com  Thu Sep 16 14:20:42 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 14:20:42 +0200
Subject: [Linux-uvc-devel] Bison Webcam on Debian
In-Reply-To: <AANLkTinyrUQU_aqLKnFATk4bXCO5ghJ03G_eTNayx7qt@mail.gmail.com>
References: <AANLkTikJktgzP7UarDcb+ncxE_BquMXJrL2=jzRnPZqS@mail.gmail.com>
	<AANLkTimWi590Vh31b_cnX4=Q4rNO2H0O=_fYqb=87-Kq@mail.gmail.com>
	<AANLkTinyrUQU_aqLKnFATk4bXCO5ghJ03G_eTNayx7qt@mail.gmail.com>
Message-ID: <201009161420.45639.laurent.pinchart@ideasonboard.com>

Hi Oz,

On Friday 27 August 2010 11:27:24 Oz Nahum wrote:
> Hi Paulo and Laurent,
> Thanks again for your answer.
> I am aware of the different roles one can take in FOSS development. I do it
> my self via bug reporting (mainly in debian), translation and when I have
> time submit patches to projects - mainly in Python.
> Since, I am now busy writing my thesis, I will not have time to help via the
> usual altruistic path. I'm in the opinion that free software developers
> should be paid, and when I can I donate money.
> So, If you want I can donate money for the uvc project which can use it to
> finance beer to developers or hardware. Someone has to pay for all the
> berlios infrastructure no ?

Berlios is actually free :-) If you plan to attend the ELC-E conference in 
Cambridge this year, or the FOSDEM in Belgium next year, I'll accept a beer 
(or rather another beverage as, despite being Belgian, I'm not very fond of 
beer) :-)

> Since I'm in Germany, I can easily transfer money to German bank accounts
> or via pay pal.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 14:40:23 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 14:40:23 +0200
Subject: [Linux-uvc-devel] Interlaced UVC camera?
In-Reply-To: <000701cb48d6$1e432830$5ac97890$@gmail.com>
References: <000701cb48d6$1e432830$5ac97890$@gmail.com>
Message-ID: <201009161440.24448.laurent.pinchart@ideasonboard.com>

JHi Andrew,

On Tuesday 31 August 2010 08:31:12 Andrew Leech wrote:
> Hi All,
> I'm trying to develop a UVC video grabber device, which captures interlaced
> PAL video. My hardware (custom firmware on LPC3131 with a TVP5147 analog
> frontend) is working to the point of streaming video but I can't get the
> computer to deinterlace the picture. The desired frame specs are a
> resolution of 768x576 @ 25fps, YUY2 16Bit. The video I'm streaming currently
> is each field separately, ie half frames at double the frame rate of 768x288
> @ 50fps. The way I read the UVC specs this should be a supported standard
> (One field per sample). I can't seem to get the computer to think so
> however, it just shows the half height double rate frames. Is one field per
> sample format supported in the UVC driver, and if so how you to inform the
> driver of the format correctly.

The UVC driver doesn't support interlaced formats yet. Want to submit a patch 
? :-)

> I've included my descriptors in the hope someone might see something there
> that's askew, but I feel I've tried a lot of different things there with no
> positive results. One thing I noticed, it's reporting 2 fields per frame in
> the interlaced flags, whereas bit 1 set should read as One field per frame
> according to the spec, so lsusb is reporting wrong...  a minor bug.

Thanks for the reporT. I've sent an lsusb patch to the linux-usb mailing list.

> UVCview in windows reports it right for what it's worth. On the flip side,
> lsusb seems to report bmVideoStandards correctly unlike UVCview, which gets
> those flags offset.
> 
> I'm guessing that the interleaved line format is more common for interlaced,
> but that would require full frames worth of ram in my hardware which I just
> don't have (I've got 96KB total ram where a half frame requires ~430KB).
> 
> I've been working on this for over a week and am really at a loss, any help
> would be very much appreciated.

Support for interlaced formats "just" needs to be implemented in the uvcvideo 
driver.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 15:01:41 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 15:01:41 +0200
Subject: [Linux-uvc-devel] Logitech C910 video conference
In-Reply-To: <AANLkTi=LN97_RJs1o+BaUSyrTsDJESGsROdMeupB75Lo@mail.gmail.com>
References: <AANLkTi=LN97_RJs1o+BaUSyrTsDJESGsROdMeupB75Lo@mail.gmail.com>
Message-ID: <201009161501.42281.laurent.pinchart@ideasonboard.com>

Hi Josu,

On Sunday 12 September 2010 01:38:45 Josu Lazkano wrote:
> Hello, I am new on this mail list, I want to try the Logitech C910
> webcam to make some video conference between two different PCs on a
> LAN.
> 
> I have some questions?
> 
> 1. Is possible to manage this webcam with 1080p resolution?

In theory, yes. 1080p can be achieved at 2fps in uncompressed format, and 
30fps in MJPEG format.

> 2. Is the re any open-source conference software on GNU/Linux to manage this
> streams?

Ekiga comes to mind, there are others. However, the software will need to 
uncompress the MJPEG stream and recompress it for transmission on the network. 
I doubt your CPU will be happy.

> 3. Is there any better webcam or video capturer device to get working
> on GNU/linux?
> 
> The idea is to configure two FullHD TVs on a 100Mbps LAN.

You will likely need hardware-assisted compression/decompression to achieve 
1080p video conference. I don't think any available open-source software can 
do that out of the box.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 15:21:21 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 15:21:21 +0200
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <AANLkTin+bLWk1w9RPV=PyW+WxAm1SPX+ngG4Pik+=WHp@mail.gmail.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<AANLkTim7g3mcdx=Trmg7oUP008xrEGD1ahZAdQQCR0nr@mail.gmail.com>
	<AANLkTin+bLWk1w9RPV=PyW+WxAm1SPX+ngG4Pik+=WHp@mail.gmail.com>
Message-ID: <201009161521.22605.laurent.pinchart@ideasonboard.com>

Hi Igor,

On Monday 13 September 2010 00:31:41 Igor Demyanov wrote:
> Hi Laurent,
> lsusb -v attached.
> 
> I'm sorry if repeat. My first time using mailing list.
> Please add the camera(064e:a219 Suyin Corp.) to supported
> devices<http://www.ideasonboard.org/uvc/>.

Done. Thanks for the report.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 15:30:25 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 15:30:25 +0200
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <1284459244.15800.14.camel@flunder>
References: <4C77C85C.4040504@ml1.co.uk> <4C8F4238.50009@ml1.co.uk>
	<1284459244.15800.14.camel@flunder>
Message-ID: <201009161530.26446.laurent.pinchart@ideasonboard.com>

Hi Florian,

On Tuesday 14 September 2010 12:14:04 Florian Echtler wrote:
> > > The webcam sends a frame at high speed and then waits a (relatively)
> > > long time before sending the next frame.
> > > 
> > >> *A possible solution* ?
> > >> 
> > >> Instead, could the UVC driver 'simulate' a reduced framerate by
> > >> instead using the "STILL_IMAGE_FRAME" mode of the webcam and grab for
> > >> itself a set number of images per second? Or even only when polled by
> > >> a read from the user application?
> > > 
> > > Still image capture isn't supported yet. The reason is that most
> > > webcams just ask the driver to take the next picture in the video
> > > stream to emulate still image capture. Very few cameras support
> > > out-of-band still image capture, and I don't own any that support
> > > that.
> > 
> > That's quite a shame... And very wasteful of bandwidth.
> 
> A few days ago, I posted a very rough patch for preliminary still image
> support. According to the descriptors you attached, your camera actually
> supports still image capture method 2, which is the "true" one.

Just for the sake of completeness, methods 2 and 3 are the "true" ones. Method 
0 is "no still image capture supported", and method 1 just asks the host to 
capture the next image in the active video stream.

> Right now, with this patch, it is necessary to start and stop the stream
> before and after each picture; I assume ffmpeg should do this if you ask
> it to capture exactly 1 frame.
> 
> So if you are feeling curious, you could give my patch a try; I'd be
> quite interested in some experience reports.

I'll review the patch :-)

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 15:39:56 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 15:39:56 +0200
Subject: [Linux-uvc-devel] Running multiple webcams on the same hub
In-Reply-To: <4C8F4238.50009@ml1.co.uk>
References: <4C77C85C.4040504@ml1.co.uk>
	<201009130111.35110.laurent.pinchart@ideasonboard.com>
	<4C8F4238.50009@ml1.co.uk>
Message-ID: <201009161539.57699.laurent.pinchart@ideasonboard.com>

Hi Martin,

On Tuesday 14 September 2010 11:36:56 Martin wrote:
> On 13/09/10 00:11, Laurent Pinchart wrote:
> > On Friday 27 August 2010 16:14:52 Martin wrote:
> >> The problem:
> [...]
> 
> > The webcam sends a frame at high speed and then waits a (relatively) long
> > time before sending the next frame.
> > 
> >> *A possible solution* ?
> >> 
> >> Instead, could the UVC driver 'simulate' a reduced framerate by instead
> >> using the "STILL_IMAGE_FRAME" mode of the webcam and grab for itself a
> >> set number of images per second? Or even only when polled by a read from
> >> the user application?
> > 
> > Still image capture isn't supported yet. The reason is that most webcams
> > just ask the driver to take the next picture in the video stream to
> > emulate still image capture. Very few cameras support out-of-band still
> > image capture, and I don't own any that support that.
> > 
> > As most cameras just ask the driver to capture the next frame in an
> > active video stream this won't solve your problem anyway.
> 
> That's quite a shame... And very wasteful of bandwidth.
> 
> I guess we need slightly more expensive webcams that buffer an image into
> local ram before forwarding it on at whatever USB rate might be available.
> No go on that one I guess...

That's unfortunately not the kind of features found in consumer webcams. The 
problem with buffering is also that it can introduce lag.

> >> Further details:
> >> 
> >> I'm trying to use two webcams simultaneously:
> >>   iManufacturer           1 Sweex
> >>   iProduct                2 WC060 Series HD Webcam
> > 
> > Please post the whole USB descriptors (lsusb -v)
> 
> I've attached "lsusb -v -d 177f:0060".

Thanks. I've added the camera to the supported devices list.

> >> Can I tweak the UVC driver to preferentially choose the slower frame
> >> rate available?
> > 
> > You can select a frame rate explictly with VIDIOC_S_PARM.
> > 
> >> Aside: The MJPG format doesn't seem to work, nor are any compression
> >> settings visible...
> > 
> > Maybe your webcam doesn't support MJPG.
> > 
> >> Given a few hints or a patch, I can hack the kernel module to test :-)
> >> 
> >> This is running on Gentoo, kernel 2.6.34 using the in-kernel uvc module.
> >> 
> >> Any comment/ideas welcomed.
> > 
> > If you don't need to capture frames simultaneously, you can just start
> > the video stream, capture a frame, stop the video stream, and repeat the
> > sequence on the second webcam.
> > 
> > If you need higher frame rates, search the mailing list archives for
> > discussions about bandwidth (dwMaxPayloadTransferSize is a keyword). You
> > can also have a look at the "Multiple camera framerate." mail thread
> > started by Dennis Muhlestein.
> 
> Thanks for the pointers.
> 
> I've had mixed results with (bash):
> 
> while true
> do
> 	ffmpeg -v 5 -y -r 5 -vframes 2 -s xga -f video4linux2 -i /dev/video0
> -sameq -f image2 foo0-%03d.jpg
> 	sleep 5
> 	ffmpeg -v 5 -y -r 5 -vframes 2 -s xga -f video4linux2 -i /dev/video1
> -sameq -f image2 foo1-%03d.jpg
> 	sleep 5
> 	date -R
> done
> 
> That sometimes works fine, and then can randomly freeze at the point
> where ffmpeg is to capture a frame. Usually, the freeze-up scenario is
> that /dev/video0 is captured fine and then ffmpeg freezes on /dev/video1.
> 
> The "-r 5" may well not be needed. "-vframes 1" also works for if you
> just want one frame, although I've found the first frame can be
> overexposed compared to the following frames.
> 
> Not sure if -sameq is doing anything. Trying -bitexact always caused an
> error for the options.
> 
> The "sleep 5" appears to help to allow operation for longer (a minute or
> so) before ffmpeg freezing.
> 
> Running ffmpeg manually, one webcam at a time usually works fine.
> 
> Using "-r 30 -s vga" for the default framerate and 640x480 always works...
> 
> So... Is there some timing race or other untidiness whereby ffmpeg jams
> or the video stream otherwise doesn't start?

A 5 seconds sleep should be more than enough. It would be interested to find 
out what happens when ffmpeg freezes. You can attach strace to the frozen 
ffmpeg process to find out on which syscall it gets stuck (if any).

> I've only got one PCI slot... Are there any PCI cards with multiple
> separate USB hubs?! (I suspect not...)

I suppose you mean with separate USB controllers. I don't know.

-- 
Regards,

Laurent Pinchart


From igor.demyanov at gmail.com  Thu Sep 16 15:40:52 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Thu, 16 Sep 2010 17:40:52 +0400
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <201009161521.22605.laurent.pinchart@ideasonboard.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<AANLkTim7g3mcdx=Trmg7oUP008xrEGD1ahZAdQQCR0nr@mail.gmail.com>
	<AANLkTin+bLWk1w9RPV=PyW+WxAm1SPX+ngG4Pik+=WHp@mail.gmail.com>
	<201009161521.22605.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTinFHpknPY=8C7ojaghb+5KRfiPuqWWnE3Uw1tuM@mail.gmail.com>

Hi Laurent,
Wonderful. Thank you very much. How can you understand what's the reason for
the low fps? May have the opportunity to start debugging a kernel module?
I am a developer (C, C++) and is ready tohelp.
Where to start?

2010/9/16 Laurent Pinchart <laurent.pinchart at ideasonboard.com>

> Hi Igor,
>
> On Monday 13 September 2010 00:31:41 Igor Demyanov wrote:
> > Hi Laurent,
> > lsusb -v attached.
> >
> > I'm sorry if repeat. My first time using mailing list.
> > Please add the camera(064e:a219 Suyin Corp.) to supported
> > devices<http://www.ideasonboard.org/uvc/>.
>
> Done. Thanks for the report.
>

-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100916/87bd6a1c/attachment.html>

From laurent.pinchart at ideasonboard.com  Thu Sep 16 15:42:33 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 15:42:33 +0200
Subject: [Linux-uvc-devel] Two Fantec eMPIA's(eb1a:2771 eMPIA) cannot be
	run simultaneously on a system...
In-Reply-To: <57FDC2BAC5339C4F8E2E845F0F2258553CEA054990@vampire.ttmail.local>
References: <57FDC2BAC5339C4F8E2E845F0F2258553CEA054990@vampire.ttmail.local>
Message-ID: <201009161542.34281.laurent.pinchart@ideasonboard.com>

Hi Jyrki,

On Tuesday 14 September 2010 14:50:26 jyrki rajala wrote:
> Hello mailinglist!
> 
> First time mailinglisting for me, don't know much about it, but I'll try to
> make an effort.
> 
> Sorry for poorly written english in this letter...
> 
> I'm looking for a solution to the fantec eMPIA's(eb1a:2771 eMPIA) problem.
> Using one fantec works, tough I cannot change framerate on it.
> 
> But using TWO fantec's doesn't work.

[snip]

In a nutshell, the USB bandwidth is limited. There have been lots of 
discussions on this subject, please search the linux-uvc-devel mailing list 
archive.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 15:54:22 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 15:54:22 +0200
Subject: [Linux-uvc-devel] Slow frame rate windows/linux?
In-Reply-To: <01f701cb52d2$8258d260$870a7720$@gmail.com>
References: <002501cb4ee9$3838bca0$a8aa35e0$@gmail.com>
	<201009130047.55965.laurent.pinchart@ideasonboard.com>
	<01f701cb52d2$8258d260$870a7720$@gmail.com>
Message-ID: <201009161554.23611.laurent.pinchart@ideasonboard.com>

Hi Andrew,

On Monday 13 September 2010 01:30:35 Andrew Leech wrote:
> Hi Laurent, all,
> That's interesting about the timestamps, I though they were supposed to be
> essential for synchronising audio and video properly.

Yes they are... :-)

> I'm not using audio myself so not too concerned about that side of things.

Same here, that's why timestamp support hasn't been implemented yet. And also 
because it doesn't seem to be supported in the USB Audio Class driver either.

I'd love it if someone could write timestamps support for the uvcvideo driver, 
but that's a difficult task.

> Also, there was a small footnote on one of the msdn pages about interlacing
> requiring timestamps so I had tried that for make interlacing work...it
> didn't work and interlacing still isn't working properly so I stripped out
> oll the interlacing descriptors and I'm going to do deinterlacing manually
> now anyway because I need to do frame grabbing to disk so having proper
> video card deinterlacing wouldn't help much anyway.
> 
> I think I may have found the source of my fps problems however, my frame is
> 768 x576, and as a point of convenience I found that sending 4 lines in a
> uvc packet seemed to work just fine. 4 x 768 + 12 (header) turns out to be
> 1028 x 3 isoc usb packets, which is obviously more than you're allowed, but
> because it was showing the picture just fine I thought it was ok.
> Cropping the image to a smaller width though, and making the usb packets
> smaller, seems to fix the frame rate in windows. It seems that while the
> usb stack can handle the larger isoc packets, there's some buffering in
> the uvc driver that's not large enough to work. I still need to do more
> testing to confirm that's the root of the problem however. That's actually
> what that other message I sent here by mistake was about, I meant to send
> it to the lpc3000 group, I need a lot more buffering in chip to get my usb
> packet sizes back down to legit sizes. I'll let you all know if I get it
> sorted out, because it's a pretty deceptive problem, and highlights a way
> your linux driver handles dodgy hardware better!

Given the amount of dodgy hardware out there, I'm not surprised that the Linux 
driver works better than the Windows driver :-) Several vendors ship (or at 
least used to ship) a custom UVC driver for Windows to work around device 
bugs.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 16 16:17:54 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 16:17:54 +0200
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <AANLkTinFHpknPY=8C7ojaghb+5KRfiPuqWWnE3Uw1tuM@mail.gmail.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<201009161521.22605.laurent.pinchart@ideasonboard.com>
	<AANLkTinFHpknPY=8C7ojaghb+5KRfiPuqWWnE3Uw1tuM@mail.gmail.com>
Message-ID: <201009161617.55621.laurent.pinchart@ideasonboard.com>

Hi Igor,

On Thursday 16 September 2010 15:40:52 Igor Demyanov wrote:
> Hi Laurent,
> Wonderful. Thank you very much. How can you understand what's the reason
> for the low fps?

Low frame rates are usually caused by low light conditions and auto-exposure 
(or even auto white balance) being turned on. Try to turn them off and see if 
it helps.

> May have the opportunity to start debugging a kernel module? I am a
> developer (C, C++) and is ready tohelp. Where to start?

-- 
Regards,

Laurent Pinchart


From igor.demyanov at gmail.com  Thu Sep 16 16:26:17 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Thu, 16 Sep 2010 18:26:17 +0400
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <201009161617.55621.laurent.pinchart@ideasonboard.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<201009161521.22605.laurent.pinchart@ideasonboard.com>
	<AANLkTinFHpknPY=8C7ojaghb+5KRfiPuqWWnE3Uw1tuM@mail.gmail.com>
	<201009161617.55621.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTinJkYD5uGvJwfUf7sv-8ji_UV+--NRO-93FFOi7@mail.gmail.com>

Hi Laurent,
I wrote earlier. I have tried all options (auto white balance,
auto-exposure, etc) and all resolutions (320x240, 640x480, etc). The result
always is 6.3 fps.
The point in the driver, not in the settings.

2010/9/16 Laurent Pinchart <laurent.pinchart at ideasonboard.com>

> Hi Igor,
>
> On Thursday 16 September 2010 15:40:52 Igor Demyanov wrote:
> > Hi Laurent,
> > Wonderful. Thank you very much. How can you understand what's the reason
> > for the low fps?
>
> Low frame rates are usually caused by low light conditions and
> auto-exposure
> (or even auto white balance) being turned on. Try to turn them off and see
> if
> it helps.
>
> > May have the opportunity to start debugging a kernel module? I am a
> > developer (C, C++) and is ready tohelp. Where to start?
>
> --
> Regards,
>
> Laurent Pinchart
>



-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100916/23ef7587/attachment.html>

From laurent.pinchart at ideasonboard.com  Thu Sep 16 16:44:47 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 16 Sep 2010 16:44:47 +0200
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
	hackish)
In-Reply-To: <1284024641.2294.43.camel@flunder>
References: <1284024641.2294.43.camel@flunder>
Message-ID: <201009161644.48604.laurent.pinchart@ideasonboard.com>

Hi Florian,

Thanks for the patch.

On Thursday 09 September 2010 11:30:41 Florian Echtler wrote:
> Hello everybody,
> 
> since the topic of still image support has come up time and again, I've
> decided to give it a shot. After reading the UVC spec, it seems that
> there isn't too much difference to the normal operation, so I created a
> new set of functions from uvc_probe_video, uvc_commit_video and friends.
> These are called uvc_probe_still, uvc_commit_still and additionally
> uvc_trigger_still.
> 
> Just for testing, I replaced the original functions with calls to the
> still image functions and got somewhat mixed results with my two cams:
> 
> - the builtin camera in my Lenovo netbook doesn't really behave any
> different, it still streams images as before
> 
> - my Quickcam S5500 doesn't do anything, guvcview complains:
>  Could not grab image (select timeout): Resource temporarily unavailable
> 
> I'm aware that this is a really ugly hack right now, but maybe it
> provides a starting point for those of you with more insight into how
> the driver works. I'd be glad for some hints as to how to proceed!

The patch looks good to me, except of course that it's a hack :-)

The real question we need to answer is how to expose the still image capture 
function to userspace. Should a new video node be created for still image 
capture ? The new video node could be linked to the existing one using the 
media controller API. Or should we use multiple open on a single video node ? 
In that case, how would we select video/still image capture ?

I'm really open to suggestions here. We also need to remember that capturing a 
still image with method 2 (unlike method 3) will stop the live video stream 
for a brief time. Is that acceptable ?

-- 
Regards,

Laurent Pinchart


From m_uvcdev at ml1.co.uk  Thu Sep 16 17:39:41 2010
From: m_uvcdev at ml1.co.uk (Martin)
Date: Thu, 16 Sep 2010 16:39:41 +0100
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
 hackish)
In-Reply-To: <201009161644.48604.laurent.pinchart@ideasonboard.com>
References: <1284024641.2294.43.camel@flunder>
	<201009161644.48604.laurent.pinchart@ideasonboard.com>
Message-ID: <4C923A3D.2080803@ml1.co.uk>

On 16/09/10 15:44, Laurent Pinchart wrote:
> Hi Florian,
> 
> Thanks for the patch.
> 
> On Thursday 09 September 2010 11:30:41 Florian Echtler wrote:
>> Hello everybody,
>>
>> since the topic of still image support has come up time and again, I've
>> decided to give it a shot. After reading the UVC spec, it seems that
[...]

> The patch looks good to me, except of course that it's a hack :-)
> 
> The real question we need to answer is how to expose the still image capture 
> function to userspace. Should a new video node be created for still image 
> capture ? The new video node could be linked to the existing one using the 
> media controller API. Or should we use multiple open on a single video node ? 
> In that case, how would we select video/still image capture ?

Good questions...

How many user applications support 'multiple open' and 'channel selection'?

Perhaps creating a new video node is the more user friendly way to
go?... With a snapshot image repeatedly given until a new snapshot image
is acquired?


> I'm really open to suggestions here. We also need to remember that capturing a 
> still image with method 2 (unlike method 3) will stop the live video stream 
> for a brief time. Is that acceptable ?

For my example usage, I'm deliberately wanting the live video stream to
be *not* active at all.

For the case where there is a live video stream that must be stopped
temporarily, then perhaps the last video image could be repeated until
the stream can be automatically reactivated again? Also, with the last
settings maintained? Hence, such a transition will be transparent to the
user application.


Regards,
Martin


From floe at butterbrot.org  Fri Sep 17 07:57:24 2010
From: floe at butterbrot.org (Florian Echtler)
Date: Fri, 17 Sep 2010 07:57:24 +0200
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
 hackish)
In-Reply-To: <201009161644.48604.laurent.pinchart@ideasonboard.com>
References: <1284024641.2294.43.camel@flunder>
	<201009161644.48604.laurent.pinchart@ideasonboard.com>
Message-ID: <1284703044.15800.37.camel@flunder>

On Thu, 2010-09-16 at 16:44 +0200, Laurent Pinchart wrote:
> > I'm aware that this is a really ugly hack right now, but maybe it
> > provides a starting point for those of you with more insight into how
> > the driver works. I'd be glad for some hints as to how to proceed!
> The patch looks good to me, except of course that it's a hack :-)
Good to hear :-)

> The real question we need to answer is how to expose the still image capture 
> function to userspace. Should a new video node be created for still image 
> capture ? The new video node could be linked to the existing one using the 
> media controller API. Or should we use multiple open on a single video node ? 
> In that case, how would we select video/still image capture ?
Good point - I'd say that a second device node, e.g. /dev/stillX would
be the best solution. Otherwise, you'd have to rewrite every piece of
video software to include the new ioctl (or something like that). With a
separate dev node, it _should_ "just work" (TM)....
BTW, if the new node would be just a link, how would the driver know
about it?

> I'm really open to suggestions here. We also need to remember that capturing a 
> still image with method 2 (unlike method 3) will stop the live video stream 
> for a brief time. Is that acceptable ?
I think so, it's acceptable that one video camera can only be used by one application
at a time (which would otherwise probably trigger all kinds of
interference anyway).

Florian



From josu.lazkano at gmail.com  Fri Sep 17 10:37:13 2010
From: josu.lazkano at gmail.com (Josu Lazkano)
Date: Fri, 17 Sep 2010 10:37:13 +0200
Subject: [Linux-uvc-devel] Logitech C910 video conference
In-Reply-To: <201009161501.42281.laurent.pinchart@ideasonboard.com>
References: <AANLkTi=LN97_RJs1o+BaUSyrTsDJESGsROdMeupB75Lo@mail.gmail.com>
	<201009161501.42281.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTikrxosAvJNNer7D2CJFsJZGXmfB_S2vJyW_kA0H@mail.gmail.com>

Thanks for your reply Laurent, I am not have any idea on compress and
decompress process.

1. MJPEG has enought quality? It use lot of bandwith?
2. Is possible to transmit video on MJPEG format on a LAN?
3. I have a VDPAU capable machine, I can use it to decompress H.264
codec, the problem is to compress it on real time, I will need a CPU.

Thanks for all your help.

2010/9/16 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> Hi Josu,
>
> On Sunday 12 September 2010 01:38:45 Josu Lazkano wrote:
>> Hello, I am new on this mail list, I want to try the Logitech C910
>> webcam to make some video conference between two different PCs on a
>> LAN.
>>
>> I have some questions?
>>
>> 1. Is possible to manage this webcam with 1080p resolution?
>
> In theory, yes. 1080p can be achieved at 2fps in uncompressed format, and
> 30fps in MJPEG format.
>
>> 2. Is the re any open-source conference software on GNU/Linux to manage this
>> streams?
>
> Ekiga comes to mind, there are others. However, the software will need to
> uncompress the MJPEG stream and recompress it for transmission on the network.
> I doubt your CPU will be happy.
>
>> 3. Is there any better webcam or video capturer device to get working
>> on GNU/linux?
>>
>> The idea is to configure two FullHD TVs on a 100Mbps LAN.
>
> You will likely need hardware-assisted compression/decompression to achieve
> 1080p video conference. I don't think any available open-source software can
> do that out of the box.
>
> --
> Regards,
>
> Laurent Pinchart
>



-- 
Josu Lazkano


From igor.demyanov at gmail.com  Fri Sep 17 22:49:39 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Sat, 18 Sep 2010 00:49:39 +0400
Subject: [Linux-uvc-devel] Dropped frames with 064e:a219 UVC 1.3M Webcam
Message-ID: <AANLkTimTDcK=1EZ4Gto7cnc=eo546mdqS09--PDpn_x8@mail.gmail.com>

Hi All,
Why is my camera dropped frames?
160x120-> dropped 383, 102 frames successfully processed
320x240-> dropped 383, 102 frames successfully processed
640x480-> dropped 383, 102 frames successfully processed
CPU in all tests was loaded on ~ 8%

My system: Core i5 M430, 4Gb
uname -a

Linux wings 2.6.32-24-generic-pae #42-Ubuntu SMP Fri Aug 20 15:37:22 UTC
2010 i686 GNU/Linux


Testing in mplayer(MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009
MPlayer Team):

mplayer tv:// -tv driver=v4l2:width=640:height=480:device=/dev/video0:fps=30

==========================================================================
Opening video decoder: [raw] RAW Uncompressed Video
VDec: vo config request - 640 x 480 (preferred colorspace: Packed YUY2)
VDec: using Packed YUY2 as output csp (no 0)
Movie-Aspect is undefined - no prescaling applied.
VO: [xv] 640x480 => 640x480 Packed YUY2
Selected video codec: [rawyuy2] vfm: raw (RAW YUY2)
==========================================================================
Starting playback...
v4l2: select timeout
v4l2: ioctl set mute failed: Invalid argument
v4l2: 102 frames successfully processed, 383 frames dropped.


mplayer tv:// -tv driver=v4l2:width=320:height=240:device=/dev/video0:fps=30

........................
VO: [xv] 320x240 => 320x240 Packed YUY2
Selected video codec: [rawyuy2] vfm: raw (RAW YUY2)
.........................
v4l2: 102 frames successfully processed, 383 frames dropped.


mplayer tv:// -tv driver=v4l2:width=160:height=120:device=/dev/video0:fps=30

.........................
VO: [xv] 160x120 => 160x120 Packed YUY2
v4l2: 102 frames successfully processed, 383 frames dropped.



-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100918/76901f61/attachment.html>

From SanitoeterNo1 at gmx.de  Mon Sep 20 21:15:23 2010
From: SanitoeterNo1 at gmx.de (SanitoeterNo1)
Date: Mon, 20 Sep 2010 21:15:23 +0200
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
Message-ID: <201009202115.23591.SanitoeterNo1@gmx.de>

Hello,
I own a Lenovo SL510 laptop with an integrated webcam.
The camera works well but it doesnt allow me to select resolutions higher than 
640x480 regardless of which program I use, although this is supposed to be a 2 
megapixel camera.
I hope you can help me fix this.

Here is the output of lsusb:

root at thinkpad:~# lsusb
Bus 008 Device 002: ID 0a5c:217f Broadcom Corp. Bluetooth Controller
Bus 008 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 002 Device 003: ID 17ef:481c Lenovo 
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 003: ID 046d:c051 Logitech, Inc. G3 (MX518) Optical Mouse
Bus 001 Device 002: ID 05e3:0608 Genesys Logic, Inc. USB-2.0 4-Port HUB
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub

where 17ef:481c is the camera (the id is similar to Lenovo SL500's camera, if 
this helps).

Regards


From pj.assis at gmail.com  Tue Sep 21 10:47:28 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 21 Sep 2010 09:47:28 +0100
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <201009202115.23591.SanitoeterNo1@gmx.de>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
Message-ID: <AANLkTinHbCO_xHv-umiWLjiWby-Bx-2kTxQkfK2FbeG2@mail.gmail.com>

Hi,
Could you please post the output of lsusb -d 17ef:481c

Regards,
Paulo

2010/9/20 SanitoeterNo1 <SanitoeterNo1 at gmx.de>:
> Hello,
> I own a Lenovo SL510 laptop with an integrated webcam.
> The camera works well but it doesnt allow me to select resolutions higher than
> 640x480 regardless of which program I use, although this is supposed to be a 2
> megapixel camera.
> I hope you can help me fix this.
>
> Here is the output of lsusb:
>
> root at thinkpad:~# lsusb
> Bus 008 Device 002: ID 0a5c:217f Broadcom Corp. Bluetooth Controller
> Bus 008 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 002 Device 003: ID 17ef:481c Lenovo
> Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
> Bus 001 Device 003: ID 046d:c051 Logitech, Inc. G3 (MX518) Optical Mouse
> Bus 001 Device 002: ID 05e3:0608 Genesys Logic, Inc. USB-2.0 4-Port HUB
> Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
>
> where 17ef:481c is the camera (the id is similar to Lenovo SL500's camera, if
> this helps).
>
> Regards
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From pj.assis at gmail.com  Tue Sep 21 10:47:28 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 21 Sep 2010 09:47:28 +0100
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <201009202115.23591.SanitoeterNo1@gmx.de>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
Message-ID: <AANLkTinHbCO_xHv-umiWLjiWby-Bx-2kTxQkfK2FbeG2@mail.gmail.com>

Hi,
Could you please post the output of lsusb -d 17ef:481c

Regards,
Paulo

2010/9/20 SanitoeterNo1 <SanitoeterNo1 at gmx.de>:
> Hello,
> I own a Lenovo SL510 laptop with an integrated webcam.
> The camera works well but it doesnt allow me to select resolutions higher than
> 640x480 regardless of which program I use, although this is supposed to be a 2
> megapixel camera.
> I hope you can help me fix this.
>
> Here is the output of lsusb:
>
> root at thinkpad:~# lsusb
> Bus 008 Device 002: ID 0a5c:217f Broadcom Corp. Bluetooth Controller
> Bus 008 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
> Bus 002 Device 003: ID 17ef:481c Lenovo
> Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
> Bus 001 Device 003: ID 046d:c051 Logitech, Inc. G3 (MX518) Optical Mouse
> Bus 001 Device 002: ID 05e3:0608 Genesys Logic, Inc. USB-2.0 4-Port HUB
> Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
>
> where 17ef:481c is the camera (the id is similar to Lenovo SL500's camera, if
> this helps).
>
> Regards
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From SanitoeterNo1 at gmx.de  Tue Sep 21 11:49:28 2010
From: SanitoeterNo1 at gmx.de (SanitoeterNo1)
Date: Tue, 21 Sep 2010 11:49:28 +0200
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <AANLkTinHbCO_xHv-umiWLjiWby-Bx-2kTxQkfK2FbeG2@mail.gmail.com>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
	<AANLkTinHbCO_xHv-umiWLjiWby-Bx-2kTxQkfK2FbeG2@mail.gmail.com>
Message-ID: <201009211149.28978.SanitoeterNo1@gmx.de>

Hi,
since lsusb -d 17ef:481c does not print any more information, I added the -v 
option. Here is the output:

root at thinkpad:~# lsusb -d 17ef:481c -v
Bus 002 Device 003: ID 17ef:481c Lenovo
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x17ef Lenovo
  idProduct          0x481c
  bcdDevice            0.06
  iManufacturer           1 Bison
  iProduct                2 Integrated Camera
  iSerial                 3 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          527
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               2 Integrated Camera
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              2 Integrated Camera
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           80
        dwClockFrequency       48.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier      16384
        bControlSize            2
        bmControls     0x0000147f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x1d
          None
          PAL - 625/50
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                29
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 3
        guidExtensionCode         {82066163-7050-ab49-b8cc-b3855e8d221d}
        bNumControl             0
        bNrPins                 1
        baSourceID( 0)          2
        bControlSize            4
        bmControls( 0)       0xff
        bmControls( 1)       0xff
        bmControls( 2)       0x04
        bmControls( 3)       0x00
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             4
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x87  EP 7 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               8
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                      224
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       4
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat                            
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                147456000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  9216000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                 12165120
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 36864000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               5
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        160
        wHeight( 1)                       120
        wWidth( 2)                        176
        wHeight( 2)                       144
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        352
        wHeight( 4)                       288
        bNumCompressionPatterns             5
        bCompression( 0)                    1
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0280  1x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x03b0  1x 944 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0a80  2x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       8
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       9
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0be0  2x 992 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting      10
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting      11
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13fc  3x 1020 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


On Tuesday 21 September 2010 10:47:28 you wrote:
> Hi,
> Could you please post the output of lsusb -d 17ef:481c
> 
> Regards,
> Paulo
> 


From pj.assis at gmail.com  Tue Sep 21 11:55:39 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 21 Sep 2010 10:55:39 +0100
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <201009211149.28978.SanitoeterNo1@gmx.de>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
	<AANLkTinHbCO_xHv-umiWLjiWby-Bx-2kTxQkfK2FbeG2@mail.gmail.com>
	<201009211149.28978.SanitoeterNo1@gmx.de>
Message-ID: <AANLkTimSXM+hGnTasbKxJkt+mkfoz4fkxRtdH=VnMfSs@mail.gmail.com>

Hi,

2010/9/21 SanitoeterNo1 <SanitoeterNo1 at gmx.de>:
> Hi,
> since lsusb -d 17ef:481c does not print any more information, I added the -v
> option. Here is the output:
>

Yes, I forgot that, sorry.

If you look down the descriptors, you will notice that the camera
doesn't support more than 640x480:

  wWidth( 0)                        640
  wHeight( 0)                       480
  wWidth( 1)                        160
  wHeight( 1)                       120
  wWidth( 2)                        176
  wHeight( 2)                       144
  wWidth( 3)                        320
  wHeight( 3)                       240
  wWidth( 4)                        352
  wHeight( 4)                       288


Best Regards,
Paulo

> root at thinkpad:~# lsusb -d 17ef:481c -v
> Bus 002 Device 003: ID 17ef:481c Lenovo
> Device Descriptor:
> ?bLength ? ? ? ? ? ? ? ?18
> ?bDescriptorType ? ? ? ? 1
> ?bcdUSB ? ? ? ? ? ? ? 2.00
> ?bDeviceClass ? ? ? ? ?239 Miscellaneous Device
> ?bDeviceSubClass ? ? ? ? 2 ?
> ?bDeviceProtocol ? ? ? ? 1 Interface Association
> ?bMaxPacketSize0 ? ? ? ?64
> ?idVendor ? ? ? ? ? 0x17ef Lenovo
> ?idProduct ? ? ? ? ?0x481c
> ?bcdDevice ? ? ? ? ? ?0.06
> ?iManufacturer ? ? ? ? ? 1 Bison
> ?iProduct ? ? ? ? ? ? ? ?2 Integrated Camera
> ?iSerial ? ? ? ? ? ? ? ? 3 0
> ?bNumConfigurations ? ? ?1
> ?Configuration Descriptor:
> ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ?bDescriptorType ? ? ? ? 2
> ? ?wTotalLength ? ? ? ? ?527
> ? ?bNumInterfaces ? ? ? ? ?2
> ? ?bConfigurationValue ? ? 1
> ? ?iConfiguration ? ? ? ? ?0
> ? ?bmAttributes ? ? ? ? 0x80
> ? ? ?(Bus Powered)
> ? ?MaxPower ? ? ? ? ? ? ?500mA
> ? ?Interface Association:
> ? ? ?bLength ? ? ? ? ? ? ? ? 8
> ? ? ?bDescriptorType ? ? ? ?11
> ? ? ?bFirstInterface ? ? ? ? 0
> ? ? ?bInterfaceCount ? ? ? ? 2
> ? ? ?bFunctionClass ? ? ? ? 14 Video
> ? ? ?bFunctionSubClass ? ? ? 3 Video Interface Collection
> ? ? ?bFunctionProtocol ? ? ? 0
> ? ? ?iFunction ? ? ? ? ? ? ? 2 Integrated Camera
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?0
> ? ? ?bAlternateSetting ? ? ? 0
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?1 Video Control
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?2 Integrated Camera
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?13
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?1 (HEADER)
> ? ? ? ?bcdUVC ? ? ? ? ? ? ? 1.00
> ? ? ? ?wTotalLength ? ? ? ? ? 80
> ? ? ? ?dwClockFrequency ? ? ? 48.000000MHz
> ? ? ? ?bInCollection ? ? ? ? ? 1
> ? ? ? ?baInterfaceNr( 0) ? ? ? 1
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?18
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?2 (INPUT_TERMINAL)
> ? ? ? ?bTerminalID ? ? ? ? ? ? 1
> ? ? ? ?wTerminalType ? ? ?0x0201 Camera Sensor
> ? ? ? ?bAssocTerminal ? ? ? ? ?0
> ? ? ? ?iTerminal ? ? ? ? ? ? ? 0
> ? ? ? ?wObjectiveFocalLengthMin ? ? ?0
> ? ? ? ?wObjectiveFocalLengthMax ? ? ?0
> ? ? ? ?wOcularFocalLength ? ? ? ? ? ?0
> ? ? ? ?bControlSize ? ? ? ? ? ? ? ? ?3
> ? ? ? ?bmControls ? ? ? ? ? 0x00000000
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?11
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?5 (PROCESSING_UNIT)
> ? ? ?Warning: Descriptor too short
> ? ? ? ?bUnitID ? ? ? ? ? ? ? ? 2
> ? ? ? ?bSourceID ? ? ? ? ? ? ? 1
> ? ? ? ?wMaxMultiplier ? ? ?16384
> ? ? ? ?bControlSize ? ? ? ? ? ?2
> ? ? ? ?bmControls ? ? 0x0000147f
> ? ? ? ? ?Brightness
> ? ? ? ? ?Contrast
> ? ? ? ? ?Hue
> ? ? ? ? ?Saturation
> ? ? ? ? ?Sharpness
> ? ? ? ? ?Gamma
> ? ? ? ? ?White Balance Temperature
> ? ? ? ? ?Power Line Frequency
> ? ? ? ? ?White Balance Temperature, Auto
> ? ? ? ?iProcessing ? ? ? ? ? ? 0
> ? ? ? ?bmVideoStandards ? ? 0x1d
> ? ? ? ? ?None
> ? ? ? ? ?PAL - 625/50
> ? ? ? ? ?SECAM - 625/50
> ? ? ? ? ?NTSC - 625/50
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ?29
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?6 (EXTENSION_UNIT)
> ? ? ? ?bUnitID ? ? ? ? ? ? ? ? 3
> ? ? ? ?guidExtensionCode ? ? ? ? {82066163-7050-ab49-b8cc-b3855e8d221d}
> ? ? ? ?bNumControl ? ? ? ? ? ? 0
> ? ? ? ?bNrPins ? ? ? ? ? ? ? ? 1
> ? ? ? ?baSourceID( 0) ? ? ? ? ?2
> ? ? ? ?bControlSize ? ? ? ? ? ?4
> ? ? ? ?bmControls( 0) ? ? ? 0xff
> ? ? ? ?bmControls( 1) ? ? ? 0xff
> ? ? ? ?bmControls( 2) ? ? ? 0x04
> ? ? ? ?bmControls( 3) ? ? ? 0x00
> ? ? ? ?iExtension ? ? ? ? ? ? ?0
> ? ? ?VideoControl Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ? ?bDescriptorType ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ?3 (OUTPUT_TERMINAL)
> ? ? ? ?bTerminalID ? ? ? ? ? ? 4
> ? ? ? ?wTerminalType ? ? ?0x0101 USB Streaming
> ? ? ? ?bAssocTerminal ? ? ? ? ?0
> ? ? ? ?bSourceID ? ? ? ? ? ? ? 3
> ? ? ? ?iTerminal ? ? ? ? ? ? ? 0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x87 ?EP 7 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?3
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Interrupt
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? None
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0010 ?1x 16 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 8
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 0
> ? ? ?bNumEndpoints ? ? ? ? ? 0
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?14
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?1 (INPUT_HEADER)
> ? ? ? ?bNumFormats ? ? ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?wTotalLength ? ? ? ? ? ? ? ? ? ? ?224
> ? ? ? ?bEndPointAddress ? ? ? ? ? ? ? ? ?129
> ? ? ? ?bmInfo ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?0
> ? ? ? ?bTerminalLink ? ? ? ? ? ? ? ? ? ? ? 4
> ? ? ? ?bStillCaptureMethod ? ? ? ? ? ? ? ? 2
> ? ? ? ?bTriggerSupport ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?bTriggerUsage ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bControlSize ? ? ? ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bmaControls( 0) ? ? ? ? ? ? ? ? ? ?27
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?27
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?4 (FORMAT_UNCOMPRESSED)
> ? ? ? ?bFormatIndex ? ? ? ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bNumFrameDescriptors ? ? ? ? ? ? ? ?5
> ? ? ? ?guidFormat
> {59555932-0000-1000-8000-00aa00389b71}
> ? ? ? ?bBitsPerPixel ? ? ? ? ? ? ? ? ? ? ?16
> ? ? ? ?bDefaultFrameIndex ? ? ? ? ? ? ? ? ?1
> ? ? ? ?bAspectRatioX ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bAspectRatioY ? ? ? ? ? ? ? ? ? ? ? 0
> ? ? ? ?bmInterlaceFlags ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Interlaced stream or variable: No
> ? ? ? ? ?Fields per frame: 1 fields
> ? ? ? ? ?Field 1 first: No
> ? ? ? ? ?Field pattern: Field 1 only
> ? ? ? ? ?bCopyProtect ? ? ? ? ? ? ? ? ? ? ?0
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 1
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 480
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ?147456000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ?147456000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?614400
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 2
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?160
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 120
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? ?9216000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? ?9216000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ? 38400
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 3
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?176
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 144
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 12165120
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 12165120
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ? 50688
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 4
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?320
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 240
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 36864000
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 36864000
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?153600
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?30
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?5 (FRAME_UNCOMPRESSED)
> ? ? ? ?bFrameIndex ? ? ? ? ? ? ? ? ? ? ? ? 5
> ? ? ? ?bmCapabilities ? ? ? ? ? ? ? ? ? 0x00
> ? ? ? ? ?Still image unsupported
> ? ? ? ?wWidth ? ? ? ? ? ? ? ? ? ? ? ? ? ?352
> ? ? ? ?wHeight ? ? ? ? ? ? ? ? ? ? ? ? ? 288
> ? ? ? ?dwMinBitRate ? ? ? ? ? ? ? ? 48660480
> ? ? ? ?dwMaxBitRate ? ? ? ? ? ? ? ? 48660480
> ? ? ? ?dwMaxVideoFrameBufferSize ? ? ?202752
> ? ? ? ?dwDefaultFrameInterval ? ? ? ? 333333
> ? ? ? ?bFrameIntervalType ? ? ? ? ? ? ? ? ?1
> ? ? ? ?dwFrameInterval( 0) ? ? ? ? ? ?333333
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ?27
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? ?3 (STILL_IMAGE_FRAME)
> ? ? ? ?bEndpointAddress ? ? ? ? ? ? ? ? ? ?0
> ? ? ? ?bNumImageSizePatterns ? ? ? ? ? ? ? 5
> ? ? ? ?wWidth( 0) ? ? ? ? ? ? ? ? ? ? ? ?640
> ? ? ? ?wHeight( 0) ? ? ? ? ? ? ? ? ? ? ? 480
> ? ? ? ?wWidth( 1) ? ? ? ? ? ? ? ? ? ? ? ?160
> ? ? ? ?wHeight( 1) ? ? ? ? ? ? ? ? ? ? ? 120
> ? ? ? ?wWidth( 2) ? ? ? ? ? ? ? ? ? ? ? ?176
> ? ? ? ?wHeight( 2) ? ? ? ? ? ? ? ? ? ? ? 144
> ? ? ? ?wWidth( 3) ? ? ? ? ? ? ? ? ? ? ? ?320
> ? ? ? ?wHeight( 3) ? ? ? ? ? ? ? ? ? ? ? 240
> ? ? ? ?wWidth( 4) ? ? ? ? ? ? ? ? ? ? ? ?352
> ? ? ? ?wHeight( 4) ? ? ? ? ? ? ? ? ? ? ? 288
> ? ? ? ?bNumCompressionPatterns ? ? ? ? ? ? 5
> ? ? ? ?bCompression( 0) ? ? ? ? ? ? ? ? ? ?1
> ? ? ?VideoStreaming Interface Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? ? ? ? ? ? ? 6
> ? ? ? ?bDescriptorType ? ? ? ? ? ? ? ? ? ?36
> ? ? ? ?bDescriptorSubtype ? ? ? ? ? ? ? ? 13 (COLORFORMAT)
> ? ? ? ?bColorPrimaries ? ? ? ? ? ? ? ? ? ? 1 (BT.709,sRGB)
> ? ? ? ?bTransferCharacteristics ? ? ? ? ? ?1 (BT.709)
> ? ? ? ?bMatrixCoefficients ? ? ? ? ? ? ? ? 4 (SMPTE 170M (BT.601))
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 1
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x00c0 ?1x 192 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 2
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0180 ?1x 384 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 3
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0200 ?1x 512 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 4
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0280 ?1x 640 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 5
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0320 ?1x 800 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 6
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x03b0 ?1x 944 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 7
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0a80 ?2x 640 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 8
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0b20 ?2x 800 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ? 9
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x0be0 ?2x 992 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ?10
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x1380 ?3x 896 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> ? ?Interface Descriptor:
> ? ? ?bLength ? ? ? ? ? ? ? ? 9
> ? ? ?bDescriptorType ? ? ? ? 4
> ? ? ?bInterfaceNumber ? ? ? ?1
> ? ? ?bAlternateSetting ? ? ?11
> ? ? ?bNumEndpoints ? ? ? ? ? 1
> ? ? ?bInterfaceClass ? ? ? ?14 Video
> ? ? ?bInterfaceSubClass ? ? ?2 Video Streaming
> ? ? ?bInterfaceProtocol ? ? ?0
> ? ? ?iInterface ? ? ? ? ? ? ?0
> ? ? ?Endpoint Descriptor:
> ? ? ? ?bLength ? ? ? ? ? ? ? ? 7
> ? ? ? ?bDescriptorType ? ? ? ? 5
> ? ? ? ?bEndpointAddress ? ? 0x81 ?EP 1 IN
> ? ? ? ?bmAttributes ? ? ? ? ? ?5
> ? ? ? ? ?Transfer Type ? ? ? ? ? ?Isochronous
> ? ? ? ? ?Synch Type ? ? ? ? ? ? ? Asynchronous
> ? ? ? ? ?Usage Type ? ? ? ? ? ? ? Data
> ? ? ? ?wMaxPacketSize ? ? 0x13fc ?3x 1020 bytes
> ? ? ? ?bInterval ? ? ? ? ? ? ? 1
> Device Qualifier (for other device speed):
> ?bLength ? ? ? ? ? ? ? ?10
> ?bDescriptorType ? ? ? ? 6
> ?bcdUSB ? ? ? ? ? ? ? 2.00
> ?bDeviceClass ? ? ? ? ?239 Miscellaneous Device
> ?bDeviceSubClass ? ? ? ? 2 ?
> ?bDeviceProtocol ? ? ? ? 1 Interface Association
> ?bMaxPacketSize0 ? ? ? ?64
> ?bNumConfigurations ? ? ?1
> Device Status: ? ? 0x0000
> ?(Bus Powered)
>
>
> On Tuesday 21 September 2010 10:47:28 you wrote:
>> Hi,
>> Could you please post the output of lsusb -d 17ef:481c
>>
>> Regards,
>> Paulo
>>
>

From SanitoeterNo1 at gmx.de  Tue Sep 21 12:10:36 2010
From: SanitoeterNo1 at gmx.de (SanitoeterNo1)
Date: Tue, 21 Sep 2010 12:10:36 +0200
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <AANLkTimSXM+hGnTasbKxJkt+mkfoz4fkxRtdH=VnMfSs@mail.gmail.com>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
	<201009211149.28978.SanitoeterNo1@gmx.de>
	<AANLkTimSXM+hGnTasbKxJkt+mkfoz4fkxRtdH=VnMfSs@mail.gmail.com>
Message-ID: <201009211210.36539.SanitoeterNo1@gmx.de>

Hi,
I know uvc does not offer any resolutions above 640x480, but I bought this 
laptop with a 2 megapixel camera, so I suppose this is a driver problem, 
otherwise I'll have to talk to the Lenovo support.
I will try to get the webcam working on Windows and check what resolution the 
official drivers offer.

Regards,
Paul

On Tuesday 21 September 2010 11:55:39 you wrote:
> Yes, I forgot that, sorry.
> 
> If you look down the descriptors, you will notice that the camera
> doesn't support more than 640x480:
> 
>   wWidth( 0)                        640
>   wHeight( 0)                       480
>   wWidth( 1)                        160
>   wHeight( 1)                       120
>   wWidth( 2)                        176
>   wHeight( 2)                       144
>   wWidth( 3)                        320
>   wHeight( 3)                       240
>   wWidth( 4)                        352
>   wHeight( 4)                       288
> 
> 
> Best Regards,
> Paulo


From pj.assis at gmail.com  Tue Sep 21 13:04:52 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 21 Sep 2010 12:04:52 +0100
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <201009211210.36539.SanitoeterNo1@gmx.de>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
	<201009211149.28978.SanitoeterNo1@gmx.de>
	<AANLkTimSXM+hGnTasbKxJkt+mkfoz4fkxRtdH=VnMfSs@mail.gmail.com>
	<201009211210.36539.SanitoeterNo1@gmx.de>
Message-ID: <AANLkTinkMEHD687=xtvaBAHt6w=vQxOrCHOKxN2nw4TH@mail.gmail.com>

Hi,

2010/9/21 SanitoeterNo1 <SanitoeterNo1 at gmx.de>:
> Hi,
> I know uvc does not offer any resolutions above 640x480, but I bought this
> laptop with a 2 megapixel camera, so I suppose this is a driver problem,
> otherwise I'll have to talk to the Lenovo support.

The camera itself doesn't advertise any resolution above 640x480, I
guess you can get higher values by interpolation, but this is just a
software trick, not the real resolution.
If I were you I would first double check the camera specs.
Here it says it's a 1.3 Mp camera:
http://hubpages.com/hub/Product-reviews-Lenovo-SL-510-laptop

Best Regards,
Paulo

> I will try to get the webcam working on Windows and check what resolution the
> official drivers offer.
>
> Regards,
> Paul
>
> On Tuesday 21 September 2010 11:55:39 you wrote:
>> Yes, I forgot that, sorry.
>>
>> If you look down the descriptors, you will notice that the camera
>> doesn't support more than 640x480:
>>
>> ? wWidth( 0) ? ? ? ? ? ? ? ? ? ? ? ?640
>> ? wHeight( 0) ? ? ? ? ? ? ? ? ? ? ? 480
>> ? wWidth( 1) ? ? ? ? ? ? ? ? ? ? ? ?160
>> ? wHeight( 1) ? ? ? ? ? ? ? ? ? ? ? 120
>> ? wWidth( 2) ? ? ? ? ? ? ? ? ? ? ? ?176
>> ? wHeight( 2) ? ? ? ? ? ? ? ? ? ? ? 144
>> ? wWidth( 3) ? ? ? ? ? ? ? ? ? ? ? ?320
>> ? wHeight( 3) ? ? ? ? ? ? ? ? ? ? ? 240
>> ? wWidth( 4) ? ? ? ? ? ? ? ? ? ? ? ?352
>> ? wHeight( 4) ? ? ? ? ? ? ? ? ? ? ? 288
>>
>>
>> Best Regards,
>> Paulo
>


From SanitoeterNo1 at gmx.de  Tue Sep 21 21:19:24 2010
From: SanitoeterNo1 at gmx.de (SanitoeterNo1)
Date: Tue, 21 Sep 2010 21:19:24 +0200
Subject: [Linux-uvc-devel] Lenovo SL510 Webcam,
	only resolutions < 640x480 available
In-Reply-To: <AANLkTinkMEHD687=xtvaBAHt6w=vQxOrCHOKxN2nw4TH@mail.gmail.com>
References: <201009202115.23591.SanitoeterNo1@gmx.de>
	<201009211210.36539.SanitoeterNo1@gmx.de>
	<AANLkTinkMEHD687=xtvaBAHt6w=vQxOrCHOKxN2nw4TH@mail.gmail.com>
Message-ID: <201009212119.24411.SanitoeterNo1@gmx.de>

Hi,
I did that before subscribing to this mailing list, and actually your page is 
the first one I came across which (if at all) listed a resolution other than 2 
mp. I dont know why there is the same wrong information on all these websites.

However, you seem to be right because I cannot get a resolution higher than 
640x480 using any of the Windows drivers as well.
Thank you for helping!

Regards,
Paul

On Tuesday 21 September 2010 13:04:52 you wrote:
> The camera itself doesn't advertise any resolution above 640x480, I
> guess you can get higher values by interpolation, but this is just a
> software trick, not the real resolution.
> If I were you I would first double check the camera specs.
> Here it says it's a 1.3 Mp camera:
> http://hubpages.com/hub/Product-reviews-Lenovo-SL-510-laptop
> 
> Best Regards,
> Paulo



From laurent.pinchart at ideasonboard.com  Wed Sep 22 23:23:42 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 22 Sep 2010 23:23:42 +0200
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <AANLkTinJkYD5uGvJwfUf7sv-8ji_UV+--NRO-93FFOi7@mail.gmail.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<201009161617.55621.laurent.pinchart@ideasonboard.com>
	<AANLkTinJkYD5uGvJwfUf7sv-8ji_UV+--NRO-93FFOi7@mail.gmail.com>
Message-ID: <201009222323.42642.laurent.pinchart@ideasonboard.com>

Hi Igor,

On Thursday 16 September 2010 16:26:17 Igor Demyanov wrote:
> Hi Laurent,
> I wrote earlier. I have tried all options (auto white balance,
> auto-exposure, etc) and all resolutions (320x240, 640x480, etc). The result
> always is 6.3 fps.
> The point in the driver, not in the settings.

Then I don't know where your problem comes from. The driver doesn't limit the 
frame rate on purpose. It might miss frames though, could check the timestamps 
to see if you detect some kind of pattern.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Sep 22 23:42:51 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 22 Sep 2010 23:42:51 +0200
Subject: [Linux-uvc-devel] Logitech C910 video conference
In-Reply-To: <AANLkTikrxosAvJNNer7D2CJFsJZGXmfB_S2vJyW_kA0H@mail.gmail.com>
References: <AANLkTi=LN97_RJs1o+BaUSyrTsDJESGsROdMeupB75Lo@mail.gmail.com>
	<201009161501.42281.laurent.pinchart@ideasonboard.com>
	<AANLkTikrxosAvJNNer7D2CJFsJZGXmfB_S2vJyW_kA0H@mail.gmail.com>
Message-ID: <201009222342.51933.laurent.pinchart@ideasonboard.com>

Hi Josu,

On Friday 17 September 2010 10:37:13 Josu Lazkano wrote:
> Thanks for your reply Laurent, I am not have any idea on compress and
> decompress process.
> 
> 1. MJPEG has enought quality?

It should, yes.

> It use lot of bandwith?

Way less than uncompressed video, but more than H.264. You'll have to measure 
it.

> 2. Is possible to transmit video on MJPEG format on a LAN?

I think so. It depends on the LAN bandwidth, and the MJPEG bandwidth. 
Measurements are needed. You will also have to find software that stream MJPEG 
video over a network. Most stock VoIP software use some kind of MPEG 
compression.

> 3. I have a VDPAU capable machine, I can use it to decompress H.264
> codec, the problem is to compress it on real time, I will need a CPU.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Sep 22 23:45:46 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 22 Sep 2010 23:45:46 +0200
Subject: [Linux-uvc-devel] Dropped frames with 064e:a219 UVC 1.3M Webcam
In-Reply-To: <AANLkTimTDcK=1EZ4Gto7cnc=eo546mdqS09--PDpn_x8@mail.gmail.com>
References: <AANLkTimTDcK=1EZ4Gto7cnc=eo546mdqS09--PDpn_x8@mail.gmail.com>
Message-ID: <201009222345.46762.laurent.pinchart@ideasonboard.com>

Hi Igor,

On Friday 17 September 2010 22:49:39 Igor Demyanov wrote:
> Hi All,
> Why is my camera dropped frames?
> 160x120-> dropped 383, 102 frames successfully processed
> 320x240-> dropped 383, 102 frames successfully processed
> 640x480-> dropped 383, 102 frames successfully processed
> CPU in all tests was loaded on ~ 8%

I think mplayer just compares the number of frames it received from the driver 
(102) with the number of frames it expected (based on the 30 fps frame rate 
you specified on the command line), and prints the difference (I might be 
wrong though, please double-check that). So frames are not really dropped by 
mplayer, they would be dropped either in the kernel or in the camera.

-- 
Regards,

Laurent Pinchart


From igor.demyanov at gmail.com  Wed Sep 22 23:59:59 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Thu, 23 Sep 2010 01:59:59 +0400
Subject: [Linux-uvc-devel] Dropped frames with 064e:a219 UVC 1.3M Webcam
In-Reply-To: <201009222345.46762.laurent.pinchart@ideasonboard.com>
References: <AANLkTimTDcK=1EZ4Gto7cnc=eo546mdqS09--PDpn_x8@mail.gmail.com>
	<201009222345.46762.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=2PbGJCwsTQPjKqV8Tm2vZq=kqsPgFBpMKN7YM@mail.gmail.com>

Hi, Laurent
Thank you. You were my last hope :-)
I also noticed that:
guvcview set:320x240, 1/15, show 3fps
guvcview set:320x240, 1/30, show 7fps
So I can not understand the cause of the problem.

2010/9/23 Laurent Pinchart <laurent.pinchart at ideasonboard.com>
> Hi Igor,
> On Friday 17 September 2010 22:49:39 Igor Demyanov wrote:
> > Hi All,
> > Why is my camera dropped frames?
> > 160x120-> dropped 383, 102 frames successfully processed
> > 320x240-> dropped 383, 102 frames successfully processed
> > 640x480-> dropped 383, 102 frames successfully processed
> > CPU in all tests was loaded on ~ 8%
>
> I think mplayer just compares the number of frames it received from the
driver
> (102) with the number of frames it expected (based on the 30 fps frame
rate
> you specified on the command line), and prints the difference (I might be
> wrong though, please double-check that). So frames are not really dropped
by
> mplayer, they would be dropped either in the kernel or in the camera.
>

-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100923/31b908d6/attachment.html>

From igor.demyanov at gmail.com  Thu Sep 23 00:08:13 2010
From: igor.demyanov at gmail.com (Igor Demyanov)
Date: Thu, 23 Sep 2010 02:08:13 +0400
Subject: [Linux-uvc-devel] 064e:a219 Suyin Corp. "1.3M WebCam" (Acer
	Aspire 5745G)
In-Reply-To: <201009222323.42642.laurent.pinchart@ideasonboard.com>
References: <AANLkTim=3bMcoT+Yn3fR2P_eySXKmr8RVPvjWqnnt-Fq@mail.gmail.com>
	<201009161617.55621.laurent.pinchart@ideasonboard.com>
	<AANLkTinJkYD5uGvJwfUf7sv-8ji_UV+--NRO-93FFOi7@mail.gmail.com>
	<201009222323.42642.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTi=oFc+MsHfdZ6tokQr-uaCmLK=dFostxnNjqJdB@mail.gmail.com>

Hi Laurent,

I found the cause. All the matter in light of the room. So in the exposure
(auto-exposure or even auto white balance).
My camera only supports:
9963776: Brightness: 0
9963777: Contrast: 32
9963778: Saturation: 64
9963779: Hue: 0
9963788: White Balance Temperature, Auto: 1
9963792: Gamma: 100
9963800: Power Line Frequency: 1
9963803: Sharpness: 4
9963804: Backlight Compensation: 1

How to add support exposure and auto white balance?

PS: You were right, the talking about it earlier.

-- 
Best regards,
Igor Demyanov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100923/9b855599/attachment.html>

From laurent.pinchart at ideasonboard.com  Thu Sep 23 00:50:36 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 23 Sep 2010 00:50:36 +0200
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
	hackish)
In-Reply-To: <4C923A3D.2080803@ml1.co.uk>
References: <1284024641.2294.43.camel@flunder>
	<201009161644.48604.laurent.pinchart@ideasonboard.com>
	<4C923A3D.2080803@ml1.co.uk>
Message-ID: <201009230050.37467.laurent.pinchart@ideasonboard.com>

Hi martin,

On Thursday 16 September 2010 17:39:41 Martin wrote:
> On 16/09/10 15:44, Laurent Pinchart wrote:
> > Hi Florian,
> > 
> > Thanks for the patch.
> > 
> > On Thursday 09 September 2010 11:30:41 Florian Echtler wrote:
> >> Hello everybody,
> >> 
> >> since the topic of still image support has come up time and again, I've
> >> decided to give it a shot. After reading the UVC spec, it seems that
> 
> [...]
> 
> > The patch looks good to me, except of course that it's a hack :-)
> > 
> > The real question we need to answer is how to expose the still image
> > capture function to userspace. Should a new video node be created for
> > still image capture ? The new video node could be linked to the existing
> > one using the media controller API. Or should we use multiple open on a
> > single video node ? In that case, how would we select video/still image
> > capture ?
> 
> Good questions...
> 
> How many user applications support 'multiple open' and 'channel selection'?

Not many. As there's no still image capture API at the moment, I don't think 
any application supports still image capture :-)

> Perhaps creating a new video node is the more user friendly way to
> go?... With a snapshot image repeatedly given until a new snapshot image
> is acquired?

I think all this should be discussed in the linux-media mailing list. A still 
image capture API could be useful for other devices as well.

> > I'm really open to suggestions here. We also need to remember that
> > capturing a still image with method 2 (unlike method 3) will stop the
> > live video stream for a brief time. Is that acceptable ?
> 
> For my example usage, I'm deliberately wanting the live video stream to
> be *not* active at all.

I wonder if that would work. The UVC specification states that method 2 
interrupts the live video stream. This implies the existence of a live video 
stream :-) There's probably nothing in practice that prevents method 2 from 
working without a live video stream, but it's a bit of a grey area, and there 
could be device bugs.

> For the case where there is a live video stream that must be stopped
> temporarily, then perhaps the last video image could be repeated until
> the stream can be automatically reactivated again? Also, with the last
> settings maintained? Hence, such a transition will be transparent to the
> user application.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 23 00:52:45 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 23 Sep 2010 00:52:45 +0200
Subject: [Linux-uvc-devel] [PATCH] Still image support (very broken and
	hackish)
In-Reply-To: <1284703044.15800.37.camel@flunder>
References: <1284024641.2294.43.camel@flunder>
	<201009161644.48604.laurent.pinchart@ideasonboard.com>
	<1284703044.15800.37.camel@flunder>
Message-ID: <201009230052.45996.laurent.pinchart@ideasonboard.com>

Hi Florian,

On Friday 17 September 2010 07:57:24 Florian Echtler wrote:
> On Thu, 2010-09-16 at 16:44 +0200, Laurent Pinchart wrote:
> > > I'm aware that this is a really ugly hack right now, but maybe it
> > > provides a starting point for those of you with more insight into how
> > > the driver works. I'd be glad for some hints as to how to proceed!
> > 
> > The patch looks good to me, except of course that it's a hack :-)
> 
> Good to hear :-)
> 
> > The real question we need to answer is how to expose the still image
> > capture function to userspace. Should a new video node be created for
> > still image capture ? The new video node could be linked to the existing
> > one using the media controller API. Or should we use multiple open on a
> > single video node ? In that case, how would we select video/still image
> > capture ?
> 
> Good point - I'd say that a second device node, e.g. /dev/stillX would
> be the best solution. Otherwise, you'd have to rewrite every piece of
> video software to include the new ioctl (or something like that). With a
> separate dev node, it _should_ "just work" (TM)....

I think this should be discussed on the linux-media mailing list. We're 
creating a still image capture API (or at least an interpretation of the V4L 
API on how to capture still images), developers of other drivers could be 
interested.

Can you start a mail thread on the linux-media mailing list ? I can do it as 
well but probably not before this weekend.

> BTW, if the new node would be just a link, how would the driver know
> about it?

What do you mean by a link ?

> > I'm really open to suggestions here. We also need to remember that
> > capturing a still image with method 2 (unlike method 3) will stop the
> > live video stream for a brief time. Is that acceptable ?
> 
> I think so, it's acceptable that one video camera can only be used by one
> application at a time (which would otherwise probably trigger all kinds of
> interference anyway).

-- 
Regards,

Laurent Pinchart


From dion at thinkmoult.com  Sun Sep 26 04:26:57 2010
From: dion at thinkmoult.com (Dion Moult)
Date: Sun, 26 Sep 2010 10:26:57 +0800
Subject: [Linux-uvc-devel] Webcam doesn't work.
Message-ID: <201009261027.01752.dion@thinkmoult.com>

I've been trying to get my webcam working for a few years now and I've 
unfortunately made little progress. I'm sorry for being vague about the 
problem but that's because I don't know what the problem is.

Here's a detailed thread describing my progress:
http://forums.gentoo.org/viewtopic-t-804143.html

I hope one of you can help me resolve this issue.

-- 
Dion Moult
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100926/d1feac9b/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100926/d1feac9b/attachment.pgp>

From preetish.tripathi at gmail.com  Wed Sep 29 09:16:56 2010
From: preetish.tripathi at gmail.com (Preetish)
Date: Wed, 29 Sep 2010 12:46:56 +0530
Subject: [Linux-uvc-devel] Not able to compile v4l-dvb-1da5fed5c8b2 on
	RHEL5.5
Message-ID: <AANLkTi=waPOa0ve71XumOi=THCGK5c-xL49EkmZT_X5n@mail.gmail.com>

Hello Everybody

I am not able to compile v4l-dvb-1da5fed5c8b2 on RHEL5.5 Client .
Below are the details :

This is a lenovo R400 Thinkpad with a builtin webcam.
$uname -a
Linux punlap13 2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:39 EDT 2010
x86_64 x86_64 x86_64 GNU/Linux


When I run 'make' I get the following error :

---- snip ----

make -C /exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l
make[1]: Entering directory `/exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l'
perl scripts/make_config_compat.pl /lib/modules/2.6.18-194.el5/source
./.myconfig ./config-compat.h
creating symbolic links...
make -C firmware prep
make[2]: Entering directory
`/exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l/firmware'
make[2]: Leaving directory
`/exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l/firmware'
make -C firmware
make[2]: Entering directory
`/exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l/firmware'
 CC  ihex2fw
gcc: No such file or directory
make[2]: *** [ihex2fw] Error 1
make[2]: Leaving directory
`/exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l/firmware'
make[1]: *** [firmware] Error 2
make[1]: Leaving directory `/exports/preetish/Rpms/v4l-dvb-1da5fed5c8b2/v4l'
make: *** [all] Error 2

---- snip ----

It looks like ihex2fw is not there in 2.6.18.194 . Can someone please
point me what am I missing. Should I be using an older source which
supports my kernel. If yes can someone point me the link to download
it. I am not able to find one. Thanks in advance .

Regards
Preetish


