From luc at saillard.org  Wed Jan  4 12:30:51 2006
From: luc at saillard.org (Luc Saillard)
Date: Wed, 4 Jan 2006 12:30:51 +0100
Subject: [Linux-uvc-devel] Comments about the driver
Message-ID: <20060104113050.GW15519@sd291.sivit.org>

Some comments about the current driver.
I'll try tonight the driver, and thanks for writing the driver.

Luc
> 
> /*
>  *      usbvideo.c  --  USB Video Class driver
>  *
>  *      Copyright (C) 2005
Now you can update the year :-)

>  *          Laurent Pinchart (laurent.pinchart at skynet.be)
>  *
>  *      This program is free software; you can redistribute it and/or modify
>  *      it under the terms of the GNU General Public License as published by
>  *      the Free Software Foundation; either version 2 of the License, or
>  *      (at your option) any later version.
>  *
>  */

> * Don't try to open the driver multiple times ! This will crash and make your
> * computer explode (well, maybe not, but still, don't do it). I plan to fix
> * that in the very near future. You have been warned.

  You can just put a counter in the uvc_v4l2_open() and when the counter != 0
don't try to continue.
  
> struct uvc_terminal {
> 	struct list_head list;
> 
> 	__u8 id;
> 	__u16 type;
> 	char name[64];
> 
> 	union {
> 		struct {
> 			__u16 wObjectiveFocalLengthMin;
> 			__u16 wObjectiveFocalLengthMax;
> 			__u16 wOcularFocalLength;
> 			__u8  bControlSize;
> 			__u8  *bmControls;
> 		} camera;
> 
> 		struct {
> 			__u8  bSourceID;
> 		} output;
> 	};
> };

union without name can't be build with gcc2.95 is it ok ?

> 
> struct uvc_unit {
> 	struct list_head list;
> 
> 	int id;
> 	int type;
> 	char name[64];
> };
> 
 
> struct uvc_control_desc uvc_ctrls[] = {
> 	{

 put a static here too.

 
> /*
>  * Allocate the video buffers.
>  *
>  * Pages are reserved to make sure they will not be swaped, as they will be
>  * filled in URB completion handler.
>  * 
>  * Buffers will be individually mapped, so they must all be page aligned.
>  */
> static int uvc_alloc_buffers(struct uvc_video_queue *queue, unsigned int nbuffers,
> 		unsigned int buflength)
> {
> 	unsigned int bufsize = PAGE_ALIGN(buflength);
> 	unsigned int i;
> 	void *mem = NULL;
> 	int ret;
> 
> 	if (nbuffers > UVC_MAX_VIDEO_BUFFERS)
> 		nbuffers = UVC_MAX_VIDEO_BUFFERS;
> 
> 	down(&queue->lock);
> 
> 	if ((ret = uvc_free_buffers(queue)) < 0)
> 		goto done;
> 
> 	/* Decrement the number of buffers until allocation succeeds. */
> 	for (; nbuffers > 0; --nbuffers) {
> 		mem = vmalloc_32(nbuffers * bufsize);
> 		if (mem != NULL)
> 			break;
> 	}
> 
> 	if (mem == NULL)
> 		return -ENOMEM;

                ^^^^ return without a up()
                ret = -ENOMEM;
                goto done;

> 
> 	for (i = 0; i < nbuffers; ++i) {
> 		memset(&queue->buffer[i], 0, sizeof queue->buffer[i]);
> 		queue->buffer[i].size = bufsize;
> 		queue->buffer[i].buf.index = i;
> 		queue->buffer[i].buf.m.offset = i * bufsize;

Is any buffersize aligned on a page boudary ?

> 		queue->buffer[i].buf.length = buflength;
> 		queue->buffer[i].buf.type = V4L2_BUF_TYPE_VIDEO_CAPTURE;
> 		queue->buffer[i].buf.sequence = 0;
> 		queue->buffer[i].buf.field = V4L2_FIELD_NONE;
> 		queue->buffer[i].buf.memory = V4L2_MEMORY_MMAP;
> 		queue->buffer[i].buf.flags = 0;
> 		init_waitqueue_head(&queue->buffer[i].wait);
> 	}
> 
> 	queue->mem = mem;
> 	queue->count = nbuffers;
> 	ret = nbuffers;
> 
> done:
> 	up(&queue->lock);
> 	return ret;
> }
> 
 
> /*
>  * Dequeue a video buffer. If nonblocking is false, block until a buffer is
>  * available.
>  */
> static int uvc_dequeue_buffer(struct uvc_video_queue *queue,
> 		struct v4l2_buffer *v4l2_buf, int nonblocking)
> {
> 	struct uvc_buffer *buf;
> 	int ret = 0;
> 
> 	if (v4l2_buf->type != V4L2_BUF_TYPE_VIDEO_CAPTURE ||
> 	    v4l2_buf->memory != V4L2_MEMORY_MMAP)
> 		return -EINVAL;
> 
> 	down(&queue->lock);
> 	if (list_empty(&queue->mainqueue)) {
> 		ret = -EINVAL;
> 		goto done;
> 	}
> 
> 	buf = list_entry(queue->mainqueue.next, struct uvc_buffer, stream);
> 	if ((ret = uvc_queue_waiton(buf, nonblocking)) < 0)
> 		goto done;
> 
> 	switch (buf->state) {
> 	case UVC_BUF_STATE_ERROR:
> 		ret = -EIO;
                ^^^^ ? need a goto done or is it wanted ?

> 	case UVC_BUF_STATE_DONE:
> 		buf->state = UVC_BUF_STATE_IDLE;
> 		break;
> 
> 	case UVC_BUF_STATE_IDLE:
> 	case UVC_BUF_STATE_QUEUED:
> 	case UVC_BUF_STATE_ACTIVE:
> 	default:
> 		ret = -EINVAL;
> 		goto done;
> 	}
> 
> 	list_del(&buf->stream);
> 	memcpy(v4l2_buf, &buf->buf, sizeof *v4l2_buf);
> 
> done:
> 	up(&queue->lock);
> 	return ret;
> }
> 
> /*
>  * Queue a video buffer. Attempting to queue a buffer that has already been
>  * queued will return -EINVAL.
>  */
> static int uvc_queue_buffer(struct uvc_video_queue *queue, struct v4l2_buffer *v4l2_buf)
> {
> 	struct uvc_buffer *buf;
> 	unsigned long flags;
> 	int ret = 0;
> 
> 	if (v4l2_buf->type != V4L2_BUF_TYPE_VIDEO_CAPTURE ||
> 	    v4l2_buf->memory != V4L2_MEMORY_MMAP)
> 		return -EINVAL;
> 
> 	down(&queue->lock);
> 	if (v4l2_buf->index >= queue->count)  {
> 		ret = -EINVAL;
> 		goto done;
> 	}
> 
> 	buf = &queue->buffer[v4l2_buf->index];
> 	if (buf->state != UVC_BUF_STATE_IDLE) {
> 		ret = -EINVAL;
> 		goto done;
> 	}
> 
> 	buf->state = UVC_BUF_STATE_QUEUED;
> 	buf->buf.bytesused = 0;
> 	list_add_tail(&buf->stream, &queue->mainqueue);
> 	spin_lock_irqsave(&queue->irqlock, flags);
> 	list_add_tail(&buf->queue, &queue->irqqueue);
> 	spin_unlock_irqrestore(&queue->irqlock, flags);
> 
> done:
> 	up(&queue->lock);
> 	return ret;
> }
> 
 
 }
> 
> static int uvc_set_video_ctrl(struct uvc_video_device *video,
> 	struct uvc_streaming_control *ctrl, int probe)
> {
> 	__u8 data[34];
        is it not posible to create a structure and access it ?
        i think it will more readable than data[2] ?
> 	__u8 size;
> 
> 	size = video->dev->uvc_version > 0x0100 ? 34 : 26;
> 	memset(data, 0, sizeof data);
> 
> 	*(__le16*)&data[0] = cpu_to_le32(ctrl->bmHint);
> 	data[2] = ctrl->bFormatIndex;
> 	data[3] = ctrl->bFrameIndex;
> 	*(__le32*)&data[4] = cpu_to_le32(ctrl->dwFrameInterval);
> 	*(__le16*)&data[8] = cpu_to_le16(ctrl->wKeyFrameRate);
> 	*(__le16*)&data[10] = cpu_to_le16(ctrl->wPFrameRate);
> 	*(__le16*)&data[12] = cpu_to_le16(ctrl->wCompQuality);
> 	*(__le16*)&data[14] = cpu_to_le16(ctrl->wCompWindowSize);
> 	*(__le16*)&data[16] = cpu_to_le16(ctrl->wDelay);

 


From laurent.pinchart at skynet.be  Wed Jan  4 13:13:16 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 4 Jan 2006 13:13:16 +0100
Subject: [Linux-uvc-devel] Comments about the driver
In-Reply-To: <20060104113050.GW15519@sd291.sivit.org>
References: <20060104113050.GW15519@sd291.sivit.org>
Message-ID: <200601041313.16533.laurent.pinchart@skynet.be>

Hi Luc,

Thanks for your comments. I fixed the locking issue, added the missing static 
keywords and will add a counter to open() to temporarly fix the multiple open 
issue (I should implement multiple open support though).

As for your other comments, I answered inline.

> > /*
> >  *      usbvideo.c  --  USB Video Class driver
> >  *
> >  *      Copyright (C) 2005
>
> Now you can update the year :-)

Done. Happy New Year :-)

> union without name can't be build with gcc2.95 is it ok ?

As long as I don't receive complains about it, yes :-)

> > static int uvc_alloc_buffers(struct uvc_video_queue *queue, unsigned int
> > nbuffers, unsigned int buflength)
> > {
> > 	unsigned int bufsize = PAGE_ALIGN(buflength);
> > 	unsigned int i;
> > 	void *mem = NULL;
> > 	int ret;
> >
[...]
> > 	for (i = 0; i < nbuffers; ++i) {
> > 		memset(&queue->buffer[i], 0, sizeof queue->buffer[i]);
> > 		queue->buffer[i].size = bufsize;
> > 		queue->buffer[i].buf.index = i;
> > 		queue->buffer[i].buf.m.offset = i * bufsize;
>
> Is any buffersize aligned on a page boudary ?

Not sure to understand what you mean. bufsize is always page aligned as I 
initialized it to PAGE_ALIGN(buflength).

> > static int uvc_dequeue_buffer(struct uvc_video_queue *queue,
> > 		struct v4l2_buffer *v4l2_buf, int nonblocking)
> > {
> > 	struct uvc_buffer *buf;
> > 	int ret = 0;
> >
> > 	if (v4l2_buf->type != V4L2_BUF_TYPE_VIDEO_CAPTURE ||
> > 	    v4l2_buf->memory != V4L2_MEMORY_MMAP)
> > 		return -EINVAL;
> >
> > 	down(&queue->lock);
> > 	if (list_empty(&queue->mainqueue)) {
> > 		ret = -EINVAL;
> > 		goto done;
> > 	}
> >
> > 	buf = list_entry(queue->mainqueue.next, struct uvc_buffer, stream);
> > 	if ((ret = uvc_queue_waiton(buf, nonblocking)) < 0)
> > 		goto done;
> >
> > 	switch (buf->state) {
> > 	case UVC_BUF_STATE_ERROR:
> > 		ret = -EIO;
>
>                 ^^^^ ? need a goto done or is it wanted ?

It's wanted. A buffer marked as erroneous by the driver must still be removed 
from the list, otherwise it will always stay there and no buffer will ever be 
dequeued anymore.

> > static int uvc_set_video_ctrl(struct uvc_video_device *video,
> > 	struct uvc_streaming_control *ctrl, int probe)
> > {
> > 	__u8 data[34];
>
>         is it not posible to create a structure and access it ?
>         i think it will more readable than data[2] ?

Yes, I can do that. I wasn't sure it was worth it, as data is just a block of 
bytes to be passed to the device.

Laurent Pinchart


From Olivier.Bornet at idiap.ch  Wed Jan  4 14:32:45 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Wed, 4 Jan 2006 14:32:45 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
Message-ID: <20060104133245.GA6004@idiap.ch>

Hello,

first, I'm happy to see the support of the new Logitech webcams under
Linux... Even if this is not coming from Logitech itself. (I think it's
an error from Logitech to not making some opensource drivers for their
products, like for example Intel started with their ipw2100/2200 wifi
cards).

My quick first tests are done on a GNU/Debian amd64 system (testing). At
this time, the kernel is linux-image-2.6.13-1-amd64-k8 version 2.6.13-1.

linux-uvc is revision 3 from svn trunk. One remark: the info on the
berlios page http://developer.berlios.de/svn/?group_id=5681 is not
correct for downloading the project. Instead of doing:

  svn checkout svn://svn.berlios.de/linux-uvc/trunk

as described, I have done:

  svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk

Maybe a small re-organisation of the svn tree will be great ? (to have
directly trunk instead of linux-uvc/trunk). This will help users to
download the tree with the berlios instructions.

Build was ok, with just one warning:

  /home/speech/bornet/devel/work/misc/uvc/trunk/uvcvideo.c:2190:
  warning: initialization from incompatible pointer type

Attached patch uvc_v4l2_read.patch correct this warning.

Installing don't put the module in the right directory, but I think this
is more related to GNU/Debian. (install in /lib/modules/2.6.13/ instead
of /lib/modules/2.6.13-1-amd64-k8/).

Loading the driver seems OK:

  <6>usbcore: registered new driver usbvideo
  <6>USB Video Class driver (v0.1.0)

plugging the cam (a QuickCam fusion):

  <7>usbvideo: Probing device 5
  <7>Format MJPEG found
  <7>Format Uncompressed found
  <7>usbvideo: Found a Status endpoint (addr 87).
  <7>usbvideo: Found UVC device (1.00)
  <7>usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
  <7>usbvideo: Found a valid video chain (1 -> 5).
  <3>40:3:1: cannot set freq 0 to ep 0x86
  <4>40:3:3: cannot get freq at ep 0x86

Then, I have try to access the camera with camstream, without success:

  CVideoDevice::CVideoDevice() could not query capabilities; is this
  really a video device?

Accessing the camera with OpenCV
(http://sourceforge.net/projects/opencvlibrary/) also cause problems...
I'm now debugging these problems, because I want to use these camera
with OpenCV. I will keep you informed on the progress.

But to be sure that the webcam and driver is starting to work, could you
please give me a pointer to a user program working with it ?

Thanks in advance, and thanks a lot for starting this driver.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
Index: uvcvideo.c
===================================================================
--- uvcvideo.c	(revision 3)
+++ uvcvideo.c	(working copy)
@@ -2081,7 +2081,7 @@
 	return video_usercopy(inode, file, cmd, arg, uvc_v4l2_do_ioctl);
 }
 
-static int uvc_v4l2_read(struct file *file, char __user *data,
+static ssize_t uvc_v4l2_read(struct file *file, char __user *data,
 		    size_t count, loff_t *ppos)
 {
 	uvc_printk(KERN_DEBUG, "uvc_v4l2_read\n");
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/a305cdf5/attachment.pgp>

From laurent.pinchart at skynet.be  Wed Jan  4 15:04:32 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 4 Jan 2006 15:04:32 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <20060104133245.GA6004@idiap.ch>
References: <20060104133245.GA6004@idiap.ch>
Message-ID: <200601041504.32358.laurent.pinchart@skynet.be>

Hi Olivier,

first of all, thanks for your interest in the project, and thanks for your 
patch. It has been applied to SVN.

> first, I'm happy to see the support of the new Logitech webcams under
> Linux... Even if this is not coming from Logitech itself. (I think it's
> an error from Logitech to not making some opensource drivers for their
> products, like for example Intel started with their ipw2100/2200 wifi
> cards).

I've contacted Logitech a few months ago, and they were very interested in the 
project. Linux is clearly a market they can't ignore anymore, but they 
currently don't have development resources to assign to Linux drivers 
development. They offered their help and are very supportive.

> linux-uvc is revision 3 from svn trunk. One remark: the info on the
> berlios page http://developer.berlios.de/svn/?group_id=5681 is not
> correct for downloading the project. Instead of doing:
>
>   svn checkout svn://svn.berlios.de/linux-uvc/trunk
>
> as described, I have done:
>
>   svn checkout svn://svn.berlios.de/linux-uvc/linux-uvc/trunk
>
> Maybe a small re-organisation of the svn tree will be great ? (to have
> directly trunk instead of linux-uvc/trunk). This will help users to
> download the tree with the berlios instructions.

I created a linux-uvc directory on purpose, as the project is very likely to 
release more software soon (sample SDL V4L2 viewer for instance, or patches 
for software like usbutils, GnomeMeeting or Kopete). I planned to organise 
SVN in way similar to this :

linux-uvc
  linux-uvc		(Kernel driver)
    branches
    tags
    trunk
  uvcview-sdl		(SDL-based UVC viewer)
    branches
    tags
    trunk
  uvcview-qt		(Qt-based UVC viewer)
    branches
    tags
    trunk
  patches		(Patches for GnomeMeeting, Kopete, ...)

If that's not a good idea, feel free to kick me :-)

> Build was ok, with just one warning:
>
>   /home/speech/bornet/devel/work/misc/uvc/trunk/uvcvideo.c:2190:
>   warning: initialization from incompatible pointer type
>
> Attached patch uvc_v4l2_read.patch correct this warning.

Applied.

> Installing don't put the module in the right directory, but I think this
> is more related to GNU/Debian. (install in /lib/modules/2.6.13/ instead
> of /lib/modules/2.6.13-1-amd64-k8/).

I'm developping on a Gentoo box, and the module is installed in the correct 
location. If there's an easy way to fix the Debian problem without breaking 
other distributions, feel free to send a patch.

> Loading the driver seems OK:
[...]
> Then, I have try to access the camera with camstream, without success:
>
>   CVideoDevice::CVideoDevice() could not query capabilities; is this
>   really a video device?

camstream uses the deprecated V4L1 API, and the UVC driver only support V4L2.

> Accessing the camera with OpenCV
> (http://sourceforge.net/projects/opencvlibrary/) also cause problems...

Same problem.

> I'm now debugging these problems, because I want to use these camera
> with OpenCV. I will keep you informed on the progress.

You will have to implement V4L2 support in OpenCV.

> But to be sure that the webcam and driver is starting to work, could you
> please give me a pointer to a user program working with it ?

Here is a (very) basic test program which saves 100 frames to disk. You can 
change the resolution and format by modifying video_set_format (the camera 
supports V4L2_PIX_FMT_YUYV and V4L2_PIX_FMT_MJPEG). An SDL-based front-end 
will probably be added to the SVN repository in a few weeks time.

> Thanks in advance, and thanks a lot for starting this driver.

You're welcome.

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.c
Type: text/x-csrc
Size: 5435 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/0be4fffe/attachment.c>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Makefile
Type: text/x-makefile
Size: 175 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/0be4fffe/attachment.bin>

From Olivier.Bornet at idiap.ch  Wed Jan  4 15:37:40 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Wed, 4 Jan 2006 15:37:40 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <200601041504.32358.laurent.pinchart@skynet.be>
References: <20060104133245.GA6004@idiap.ch> <200601041504.32358.laurent.pinchart@skynet.be>
Message-ID: <20060104143740.GB6004@idiap.ch>

Hi Laurent,

> I've contacted Logitech a few months ago, and they were very
> interested in the project. Linux is clearly a market they can't ignore
> anymore, but they currently don't have development resources to assign
> to Linux drivers development. They offered their help and are very
> supportive.

Cool. It's a good start. Hope they have given some webcams to you. :-)

> I created a linux-uvc directory on purpose, as the project is very likely to 
> release more software soon (sample SDL V4L2 viewer for instance, or patches 
> for software like usbutils, GnomeMeeting or Kopete). I planned to organise 
> SVN in way similar to this :
> 
> linux-uvc
>   linux-uvc		(Kernel driver)
>     branches
>     tags
>     trunk
>   uvcview-sdl		(SDL-based UVC viewer)
>     branches
>     tags
>     trunk
>   uvcview-qt		(Qt-based UVC viewer)
>     branches
>     tags
>     trunk
>   patches		(Patches for GnomeMeeting, Kopete, ...)
> 
> If that's not a good idea, feel free to kick me :-)

No, it's a good idea... Maybe just add linux-uvc/trunk directly, which
will include all the "sub-projects". So, you will have something like
this:

linux-uvc
  trunk
    linux-uvc    (a link to linux-uvc/linux-uvc/trunk)
    uvcview-sdl  (a link to linux-uvc/uvcview-sdl/trunk)
    uvcview-qt   (a link to linux-uvc/uvcview-qt/trunk)
    patches      (a link to linux-uvc/patches)
  linux-uvc
    branches
    tags
    trunk
  uvcview-sdl
    branches
    tags
    trunk
  uvcview-qt
    branches
    tags
    trunk
  patches

After that, you can retrieve the full tree using the berlios
instructions.

> > Attached patch uvc_v4l2_read.patch correct this warning.
> 
> Applied.

Great. :-)

> I'm developping on a Gentoo box, and the module is installed in the correct 
> location. If there's an easy way to fix the Debian problem without breaking 
> other distributions, feel free to send a patch.

It's not a big problem for me at this time... Maybe I will look at it in
the future...

> > Then, I have try to access the camera with camstream, without success:
> >
> >   CVideoDevice::CVideoDevice() could not query capabilities; is this
> >   really a video device?
> 
> camstream uses the deprecated V4L1 API, and the UVC driver only support V4L2.

OK. So, no camstream.

> > Accessing the camera with OpenCV
> > (http://sourceforge.net/projects/opencvlibrary/) also cause problems...
> 
> Same problem.
> [...]
> You will have to implement V4L2 support in OpenCV.

OpenCV has support for both V4L1 and V4L2 since mid September 2005...
But it has maybe some problems with the implementation. (I have just
found one now...).

The main problem with OpenCV is the support for V4L2_PIX_FMT_YUYV and
V4L2_PIX_FMT_MJPEG. These formats are not supported at this time. The
supported formats are V4L2_PIX_FMT_BGR24, V4L2_PIX_FMT_YVU420,
V4L2_PIX_FMT_YUYV, V4L2_PIX_FMT_YUV411P, V4L2_PIX_FMT_SBGGR8,
V4L2_PIX_FMT_SN9C10X.

I will see if I can add V4L2_PIX_FMT_YUYV and/or V4L2_PIX_FMT_MJPEG to
OpenCV now.

> Here is a (very) basic test program which saves 100 frames to disk.

Works OK. Thanks.

Thanks for your help.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/ca1ab800/attachment.pgp>

From Olivier.Bornet at idiap.ch  Wed Jan  4 15:40:38 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Wed, 4 Jan 2006 15:40:38 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <20060104143740.GB6004@idiap.ch>
References: <20060104133245.GA6004@idiap.ch> <200601041504.32358.laurent.pinchart@skynet.be> <20060104143740.GB6004@idiap.ch>
Message-ID: <20060104144038.GC6004@idiap.ch>

Hoops...

On Wed, Jan 04, 2006 at 03:37:40PM +0100, Olivier Bornet wrote:
> The main problem with OpenCV is the support for V4L2_PIX_FMT_YUYV and
> V4L2_PIX_FMT_MJPEG. These formats are not supported at this time. The
> supported formats are V4L2_PIX_FMT_BGR24, V4L2_PIX_FMT_YVU420,
> V4L2_PIX_FMT_YUYV, V4L2_PIX_FMT_YUV411P, V4L2_PIX_FMT_SBGGR8,
> V4L2_PIX_FMT_SN9C10X.

wrong... V4L2_PIX_FMT_YUYV is _not_ supported. Supported are
V4L2_PIX_FMT_BGR24, V4L2_PIX_FMT_YVU420, V4L2_PIX_FMT_YUV411P,
V4L2_PIX_FMT_SBGGR8, V4L2_PIX_FMT_SN9C10X.

(copy-paste error...).

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/466ef440/attachment.pgp>

From Olivier.Bornet at idiap.ch  Wed Jan  4 17:35:06 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Wed, 4 Jan 2006 17:35:06 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <20060104143740.GB6004@idiap.ch>
References: <20060104133245.GA6004@idiap.ch> <200601041504.32358.laurent.pinchart@skynet.be> <20060104143740.GB6004@idiap.ch>
Message-ID: <20060104163506.GD6004@idiap.ch>

Hello again,

> > > Accessing the camera with OpenCV
> > > (http://sourceforge.net/projects/opencvlibrary/) also cause problems...
> > 
> > Same problem.
> > [...]
> > You will have to implement V4L2 support in OpenCV.
> 
> OpenCV has support for both V4L1 and V4L2 since mid September 2005...
> But it has maybe some problems with the implementation. (I have just
> found one now...).

OpenCV is now working with the uvc driver. I have implemented support of
V4L2_PIX_FMT_YUYV in OpenCV. Feel free to checkout the CVS of OpenCV if
you want to try it.

I don't know why, but it seems changing the size of the capture don't
works. I always have a capture of 1024x576 pixels. Even if I try to set
to another size, like for example 640x480. This must be a problem with
OpenCV, as it seems your test program is changing the resolution
correctly (altough I don't have look at the output files, because I
don't know how to display yuyv raw data images...).

Any way, thanks a lot for the driver. It's starting on the right way.

Have a nice evening.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/2f4cde1b/attachment.pgp>

From laurent.pinchart at skynet.be  Wed Jan  4 18:56:15 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 4 Jan 2006 18:56:15 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <20060104163506.GD6004@idiap.ch>
References: <20060104133245.GA6004@idiap.ch> <20060104143740.GB6004@idiap.ch> <20060104163506.GD6004@idiap.ch>
Message-ID: <200601041856.15756.laurent.pinchart@skynet.be>

> OpenCV is now working with the uvc driver. I have implemented support of
> V4L2_PIX_FMT_YUYV in OpenCV. Feel free to checkout the CVS of OpenCV if
> you want to try it.

Good work. While you're at it, you can also implement MJPEG support ;-) I 
recently posted a patch to the video4linux and qt-interest mailing lists to 
add MJPEG support to Qt, it can be used as a starting point.

> I don't know why, but it seems changing the size of the capture don't
> works. I always have a capture of 1024x576 pixels. Even if I try to set
> to another size, like for example 640x480. This must be a problem with
> OpenCV, as it seems your test program is changing the resolution
> correctly (altough I don't have look at the output files, because I
> don't know how to display yuyv raw data images...).

That's normal. The minimum size for YUYV capture is 1024x576. Lower 
resolutions are only available in MJPEG. I'll ask Logitech if they can enable 
YUYV in lower resolutions in their firmware updates.

> Any way, thanks a lot for the driver. It's starting on the right way.

You're welcome. I'm glad people are interested in UVC.

Thanks for getting involved.

Laurent Pinchart


From mxhaard at magic.fr  Wed Jan  4 22:47:07 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Wed, 4 Jan 2006 22:47:07 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
Message-ID: <200601042247.07142.mxhaard@magic.fr>

Hi all,
Just test the rev 4 with my HP zd8000 P4 64 bits 3Go with a smp kernel, 
graphic card ATI Mobility X600 and the uvcview SDL grabber
the good news
the driver work fine with all jpeg/size 
SDL yuv overlay never crash :)
the bad news :
driver return EIO on VIDIOC_DQBUF with all yuyv palette in my grabbing 
routine. SDL open a black screen but did not crash the box :) 
to be sure
tested with my Athlon 2200+ Nvidia card, all size/palette are working like a 
charm .
-- 
Michel Xhaard
http://mxhaard.free.fr


From laurent.pinchart at skynet.be  Wed Jan  4 23:02:15 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 4 Jan 2006 23:02:15 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601042247.07142.mxhaard@magic.fr>
References: <200601042247.07142.mxhaard@magic.fr>
Message-ID: <200601042302.15697.laurent.pinchart@skynet.be>

Hi Michel,

> Just test the rev 4 with my HP zd8000 P4 64 bits 3Go with a smp kernel,
> graphic card ATI Mobility X600 and the uvcview SDL grabber
> the good news
> the driver work fine with all jpeg/size
> SDL yuv overlay never crash :)
> the bad news :
> driver return EIO on VIDIOC_DQBUF with all yuyv palette in my grabbing
> routine. SDL open a black screen but did not crash the box :)
> to be sure
> tested with my Athlon 2200+ Nvidia card, all size/palette are working like
> a charm .

-EIO means that the buffer has been marked as erroneous. Either because the 
URB completion handler received more data than expected or because it 
received a non-zero status. Could you check dmesg to see if it prints a debug 
message ? If not, please have a look at uvc_video_complete and add printks to 
see where it fails.

Laurent Pinchart


From jwspring at comcast.net  Thu Jan  5 05:07:16 2006
From: jwspring at comcast.net (James W. Spring)
Date: Wed, 04 Jan 2006 20:07:16 -0800
Subject: [Linux-uvc-devel] Initial use of UVC driver
Message-ID: <43BC9B74.3050704@comcast.net>

Here is`what I receive upon initial use of the UVC driver.
I have attached two files both are "dmesg' outputs. First upon plugging 
in the camera
Second after trying xawtv

Kernel
 2.6.14-1.1653_FC4 #1 Tue Dec 13 21:32:09 EST 2005 i686 i686 i386 GNU/Linux
Logitech 046d:08c3

/var/log/messages
Jan  4 19:58:50 manycats kernel: usb 1-3: new high speed USB device 
using ehci_hcd and address 13
Jan  4 19:58:51 manycats kernel: 13:3:1: cannot set freq 0 to ep 0x86
Jan  4 19:58:52 manycats kernel: 13:3:2: cannot set freq 0 to ep 0x86
Jan  4 19:58:53 manycats kernel: 13:3:3: cannot get freq at ep 0x86

Ouput of x xawtv
This is xawtv-3.95, running on Linux/i686 (2.6.14-1.1653_FC4)
/dev/video0 [v4l2]: no overlay support
v4l-conf had some trouble, trying to continue anyway
ioctl: VIDIOC_G_STD(std=0xbfc37ad4 
[PAL_G,PAL_I,PAL_D1,PAL_K,PAL_N,PAL_60,NTSC_M,NTSC_M_JP,?,SECAM_B,SECAM_D,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null),(null),(null),(null),(null)]): 
Invalid argument
ioctl: VIDIOC_S_CTRL(id=9963778;value=39): Input/output error
ioctl: VIDIOC_S_STD(std=0x0 []): Invalid argument
ioctl: VIDIOC_DQBUF(index=0;type=VIDEO_CAPTURE;bytesused=0;flags=0x0 
[];field=ANY;;timecode.type=0;timecode.flags=0;timecode.frames=0;timecode.seconds=0;timecode.minutes=0;timecode.hours=0;timecode.userbits="";sequence=0;memory=unknown): 
Invalid argument
ioctl: VIDIOC_DQBUF(index=0;type=VIDEO_CAPTURE;bytesused=0;flags=0x0 
[];field=ANY;;timecode.type=0;timecode.flags=0;timecode.frames=0;timecode.seconds=0;timecode.minutes=0;timecode.hours=0;timecode.userbits="";sequence=0;memory=unknown): 
Invalid argument
awtv on startup



-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: uvc
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/8ca72746/attachment.ksh>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: uvc1
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060104/8ca72746/attachment-0001.ksh>

From laurent.pinchart at skynet.be  Thu Jan  5 12:15:15 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jan 2006 12:15:15 +0100
Subject: [Linux-uvc-devel] Initial use of UVC driver
In-Reply-To: <43BC9B74.3050704@comcast.net>
References: <43BC9B74.3050704@comcast.net>
Message-ID: <200601051215.15899.laurent.pinchart@skynet.be>

Hi James,

> Here is`what I receive upon initial use of the UVC driver.
> I have attached two files both are "dmesg' outputs. First upon plugging
> in the camera
> Second after trying xawtv

And what is your problem exactly ?

Laurent Pinchart


From jwspring at comcast.net  Thu Jan  5 15:26:51 2006
From: jwspring at comcast.net (jwspring at comcast.net)
Date: Thu, 05 Jan 2006 14:26:51 +0000
Subject: [Linux-uvc-devel] Initial use of UVC driver
Message-ID: <010520061426.13006.43BD2CAB00050857000032CE22007636920902079D9F9C9906@comcast.net>

I have attempted to view images from the device without success. I have tried xawtv, tvtime and both do not receive images. Upon statup the LED momentarly lights, but that is about all.

In doing some additional analsyis I downloaded compiled then ran the test.c program you posted.  It does access the camera but it tnen completly locks up the system. It appears to me that the Fedora 4 kernel has some differences than a stock kernel that is affecting how the driver functions.


From Olivier.Bornet at idiap.ch  Thu Jan  5 15:39:20 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Thu, 5 Jan 2006 15:39:20 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <200601041856.15756.laurent.pinchart@skynet.be>
References: <20060104133245.GA6004@idiap.ch> <20060104143740.GB6004@idiap.ch> <20060104163506.GD6004@idiap.ch> <200601041856.15756.laurent.pinchart@skynet.be>
Message-ID: <20060105143920.GG6004@idiap.ch>

Hello,

On Wed, Jan 04, 2006 at 06:56:15PM +0100, Laurent Pinchart wrote:
> > OpenCV is now working with the uvc driver. I have implemented support of
> > V4L2_PIX_FMT_YUYV in OpenCV. Feel free to checkout the CVS of OpenCV if
> > you want to try it.
> 
> Good work. While you're at it, you can also implement MJPEG support ;-) I 
> recently posted a patch to the video4linux and qt-interest mailing lists to 
> add MJPEG support to Qt, it can be used as a starting point.

Thanks for the tip. OpenCV is now supporting MJPEG. :-)
So, now with OpenCV (and the UVC driver), you can:
  - load a image file of format MJPEG,
  - use V4L2_PIX_FMT_MJPEG format for video acquisition.

The patch you have posted to the video4linux mailing list was helpful.

> > I don't know why, but it seems changing the size of the capture don't
> > works. I always have a capture of 1024x576 pixels. Even if I try to set
> > to another size, like for example 640x480. This must be a problem with
> > OpenCV, as it seems your test program is changing the resolution
> > correctly (altough I don't have look at the output files, because I
> > don't know how to display yuyv raw data images...).
> 
> That's normal. The minimum size for YUYV capture is 1024x576. Lower 
> resolutions are only available in MJPEG. I'll ask Logitech if they can enable 
> YUYV in lower resolutions in their firmware updates.

With V4L2_PIX_FMT_MJPEG, resolution switching works. Cool. :-)

Thanks for your suggestions.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060105/bb73be19/attachment.pgp>

From Olivier.Bornet at idiap.ch  Thu Jan  5 15:42:06 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Thu, 5 Jan 2006 15:42:06 +0100
Subject: [Linux-uvc-devel] frame rate of acquisition
Message-ID: <20060105144206.GH6004@idiap.ch>

Hello,

what is the frame rate you have with the UVC driver ? I have only about
7 fps with either the test program or OpenCV and UVC driver. Can I
change this ? For example, with pwc, we can switch the fps when loading
the kernel module.

Have a nice day.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060105/4e5d66ac/attachment.pgp>

From laurent.pinchart at skynet.be  Thu Jan  5 15:50:36 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jan 2006 15:50:36 +0100
Subject: [Linux-uvc-devel] Initial use of UVC driver
In-Reply-To: <010520061426.13006.43BD2CAB00050857000032CE22007636920902079D9F9C9906@comcast.net>
References: <010520061426.13006.43BD2CAB00050857000032CE22007636920902079D9F9C9906@comcast.net>
Message-ID: <200601051550.36525.laurent.pinchart@skynet.be>

Hi James,

> I have attempted to view images from the device without success. I have
> tried xawtv, tvtime and both do not receive images. Upon statup the LED
> momentarly lights, but that is about all.

I tried xawtv in the past, but it hang due to a unrelated problem. I'll try 
with tvtime.

> In doing some additional analsyis I downloaded compiled then ran the test.c
> program you posted.  It does access the camera but it tnen completly locks
> up the system. It appears to me that the Fedora 4 kernel has some
> differences than a stock kernel that is affecting how the driver functions.

Can you run the test program in a virtual console (not under X) and see if you 
get a kernel oops ? If so, please post the report.

Laurent Pinchart


From luc at saillard.org  Thu Jan  5 15:50:41 2006
From: luc at saillard.org (Luc Saillard)
Date: Thu, 5 Jan 2006 15:50:41 +0100
Subject: [Linux-uvc-devel] frame rate of acquisition
In-Reply-To: <20060105144206.GH6004@idiap.ch>
References: <20060105144206.GH6004@idiap.ch>
Message-ID: <20060105145040.GZ15519@sd291.sivit.org>

On Thu, Jan 05, 2006 at 03:42:06PM +0100, Olivier Bornet wrote:
> Hello,
> 
> what is the frame rate you have with the UVC driver ? I have only about
> 7 fps with either the test program or OpenCV and UVC driver. Can I
> change this ? For example, with pwc, we can switch the fps when loading
> the kernel module.

Or using the private field when setting the format ...

struct v4l2_format *f = arg;
compression = (f->fmt.pix.priv & PWC_QLT_MASK) >> PWC_QLT_SHIFT;
snapshot = f->fmt.pix.priv & PWC_FPS_SNAPSHOT;
fps = (f->fmt.pix.priv & PWC_FPS_FRMASK) >> PWC_FPS_SHIFT;

Perhaps we can do the same ? I've haven't look how other webcam can do this.
v4l2 can return the frame rate but we need to use one of the default standart
(secam, pal, ...)

Luc


From laurent.pinchart at skynet.be  Thu Jan  5 15:59:50 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jan 2006 15:59:50 +0100
Subject: [Linux-uvc-devel] frame rate of acquisition
In-Reply-To: <20060105144206.GH6004@idiap.ch>
References: <20060105144206.GH6004@idiap.ch>
Message-ID: <200601051559.50936.laurent.pinchart@skynet.be>

Hi Olivier,

> what is the frame rate you have with the UVC driver ? I have only about
> 7 fps with either the test program or OpenCV and UVC driver. Can I
> change this ? For example, with pwc, we can switch the fps when loading
> the kernel module.

The frame rate should be selectable using VIDIOC_S_PARM, but that's currently 
not implemented. The V4L2 and UVC stream parameters negociation (pixel 
format, frame size, frame rate and compression quality) are not entirely 
compatible, I'm thus trying to find a way to solve the problem.

Basically, UVC negociates streaming parameters by setting the pixel format and 
frame size first, then negociates frame rate and compression quality. V4L2 
uses VIDIOC_S_PARM to set the frame rate and compression quality, and 
VIDIOC_S_FMT to negociate the format. My problem is that if the user selects 
a frame rate/compression quality before negociating the format (which is what 
V4L2 currently does), I will have no way to report a failure before format 
negociation, at which time compression quality/frame rate values might be 
changed by the driver without any notification to the user.

The other issue is that V4L2 reports the maximum buffer size to the user when 
VIDIOC_S_FMT/VIDIOC_TRY_FMT are called, and I need the compression quality to 
compute the buffer size, so I can't report it there if the compression 
quality is changed after pixel format and frame size negociation.

The easiest fix would be to modify V4L2 to negociate compression quality and 
frame rate after format negociation, but that would break backward 
compatibility, so it's probably not a valid solution.

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan  5 16:02:53 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 5 Jan 2006 16:02:53 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <20060105143920.GG6004@idiap.ch>
References: <20060104133245.GA6004@idiap.ch> <200601041856.15756.laurent.pinchart@skynet.be> <20060105143920.GG6004@idiap.ch>
Message-ID: <200601051602.53708.laurent.pinchart@skynet.be>

> Thanks for the tip. OpenCV is now supporting MJPEG. :-)
> So, now with OpenCV (and the UVC driver), you can:
>   - load a image file of format MJPEG,
>   - use V4L2_PIX_FMT_MJPEG format for video acquisition.
>
> The patch you have posted to the video4linux mailing list was helpful.

Great ! That will be very helpful (I plan to use OpenCV for a robotic project 
in the near future). Are the changes commited to OpenCV CVS ?

> With V4L2_PIX_FMT_MJPEG, resolution switching works. Cool. :-)

Resolution switching works with YUYV too, but only two resolutions are 
available (1024x576 and 1280x960). That's a device limitation, not a driver 
issue.

> Thanks for your suggestions.

You're welcome.

Laurent Pinchart


From Olivier.Bornet at idiap.ch  Thu Jan  5 16:10:17 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Thu, 5 Jan 2006 16:10:17 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <200601051602.53708.laurent.pinchart@skynet.be>
References: <20060104133245.GA6004@idiap.ch> <200601041856.15756.laurent.pinchart@skynet.be> <20060105143920.GG6004@idiap.ch> <200601051602.53708.laurent.pinchart@skynet.be>
Message-ID: <20060105151017.GJ6004@idiap.ch>

Hi Laurent,

> Great ! That will be very helpful (I plan to use OpenCV for a robotic project 
> in the near future). Are the changes commited to OpenCV CVS ?

Great. :-)
Yes, the changes are commited... But maybe the anonymous CVS of SF is
not in-sync now. Don't remember if the sync is done each hour or each 4
hours.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060105/e67698ae/attachment.pgp>

From m.xhaard at CRPSMASSON.ORG  Thu Jan  5 16:19:06 2006
From: m.xhaard at CRPSMASSON.ORG (michel Xhaard)
Date: Thu, 5 Jan 2006 16:19:06 +0100
Subject: [Linux-uvc-devel] patch 490952 test on dual athlon MP smp box at work :)
Message-ID: <200601051619.06820.m.xhaard@crpsmasson.org>

hi 
here is the message from the patch from last night .
First part are MJPG palette (working)  second part YUYV palette (unworking)

Jan  5 15:59:42 linux kernel: usbvideo: VIDIOC_S_FMT
Jan  5 15:59:42 linux kernel: usbvideo: Trying format 0x47504a4d (MJPG): 
960x720.
Jan  5 15:59:43 linux kernel: usbvideo: VIDIOC_REQBUFS
Jan  5 15:59:43 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:43 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:43 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:43 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:43 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:43 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:43 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:43 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:43 linux kernel: usbvideo: VIDIOC_STREAMON
Jan  5 15:59:50 linux kernel: usbvideo: VIDIOC_STREAMOFF
Jan  5 15:59:50 linux kernel: usbvideo: > uvc_v4l2_release
Jan  5 15:59:50 linux kernel: usbvideo: < uvc_v4l2_release
Jan  5 15:59:54 linux kernel: usbvideo: uvc_v4l2_open
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_QUERYCAP
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_S_FMT
Jan  5 15:59:54 linux kernel: usbvideo: Trying format 0x56595559 (YUYV): 
1024x576.
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_REQBUFS
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:54 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:54 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:54 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_QUERYBUF
Jan  5 15:59:54 linux kernel: usbvideo: uvc_v4l2_mmap
Jan  5 15:59:54 linux kernel: usbvideo: VIDIOC_STREAMON
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame.
Jan  5 15:59:55 linux kernel: Warning: FID bit has changed before end of 
frame. 
-- 
Michel Xhaard
http://mxhaard.free.fr


From lamiphq at gmail.com  Thu Jan  5 22:16:28 2006
From: lamiphq at gmail.com (=?ISO-8859-1?Q?Fondriest_Fr=E9d=E9ric?=)
Date: Thu, 05 Jan 2006 22:16:28 +0100
Subject: [Linux-uvc-devel] Successfull compil on a linux 2.6.10
Message-ID: <43BD8CAC.5040701@epita.fr>

just download the svn , compil and install on my gentoo box
gcc-3.3.6 and linux-2.6.10

Trying to get some images with mplayer or amsn for now...
from my logitech webcam :-)

---- kern.log
Jan  5 21:42:03 pc kernel: USB Video Class driver (v0.1.0)
Jan  5 21:42:22 pc kernel: usb 2-1: new full speed USB device using 
uhci_hcd and address 2
Jan  5 21:42:22 pc kernel: usbvideo: Probing device 1
Jan  5 21:42:22 pc kernel: Format MJPEG found
Jan  5 21:42:22 pc kernel: usbvideo: Found a Status endpoint (addr 87).
Jan  5 21:42:22 pc kernel: usbvideo: Found UVC device (1.00)
Jan  5 21:42:22 pc kernel: usbvideo: Scanning UVC chain: OT 5 <- Unit 4 
<- Unit 3 <- Unit 2 <- IT 1
Jan  5 21:42:22 pc kernel: usbvideo: Found a valid video chain (1 -> 5).
Jan  5 21:42:22 pc kernel: usbvideo: UVC device initialized.
Jan  5 21:42:33 pc kernel: usbvideo: Button event (1).
Jan  5 21:42:33 pc kernel: usbvideo: Button event (0).
Jan  5 21:42:35 pc kernel: usbvideo: Button event (1).
Jan  5 21:42:35 pc kernel: usbvideo: Button event (0).
Jan  5 21:45:24 pc kernel: usbvideo: uvc_v4l2_open
----

so now... need to read the usb doc and the source code :)
-- 
ciberfred


From js4422 at comcast.net  Fri Jan  6 01:21:14 2006
From: js4422 at comcast.net (James W. Spring)
Date: Thu, 05 Jan 2006 16:21:14 -0800
Subject: [Linux-uvc-devel] Initial use of UVC driver
In-Reply-To: <200601051550.36525.laurent.pinchart@skynet.be>
References: <010520061426.13006.43BD2CAB00050857000032CE22007636920902079D9F9C9906@comcast.net> <200601051550.36525.laurent.pinchart@skynet.be>
Message-ID: <43BDB7FA.6090208@comcast.net>

Laurent Pinchart wrote:

>Hi James,
>
>  
>
>>I have attempted to view images from the device without success. I have
>>tried xawtv, tvtime and both do not receive images. Upon statup the LED
>>momentarly lights, but that is about all.
>>    
>>
>
>I tried xawtv in the past, but it hang due to a unrelated problem. I'll try 
>with tvtime.
>
>  
>
>>In doing some additional analsyis I downloaded compiled then ran the test.c
>>program you posted.  It does access the camera but it tnen completly locks
>>up the system. It appears to me that the Fedora 4 kernel has some
>>differences than a stock kernel that is affecting how the driver functions.
>>    
>>
>
>Can you run the test program in a virtual console (not under X) and see if you 
>get a kernel oops ? If so, please post the report.
>
>Laurent Pinchart
>_______________________________________________
>Linux-uvc-devel mailing list
>Linux-uvc-devel at lists.berlios.de
>http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>  
>
Laurent,

I configured my system into runlevel 3.
I successfully ran and stoppe your  test program.



From laurent.pinchart at skynet.be  Fri Jan  6 10:18:44 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 10:18:44 +0100
Subject: [Linux-uvc-devel] Re: [ANNOUNCE] Linux UVC driver available
In-Reply-To: <e0716e9f0601050751w6a0cee52pdda9e5cff28a3fd5@mail.gmail.com>
References: <200601031816.32687.laurent.pinchart@skynet.be> <e0716e9f0601050751w6a0cee52pdda9e5cff28a3fd5@mail.gmail.com>
Message-ID: <200601061018.44410.laurent.pinchart@skynet.be>

Hi William,

I cc'ed my answer to linux-uvc-devel at lists.berlios.de, please use the mailing 
list instead of contacting me directly (so that other people can learn from 
your problems and/or help you).

> Thank you for doing all of this work. I pulled down the sources from
> SVN and built the driver under SuSE 10, for on the stock 2.6.13 kernel
> supplied with the distribution, then under 2.6.15 which I built. It
> does not load under 2.6.13, but does load fine under 2.6.15. There is,
> however, a problem when I try to use it.

Why does it fail with the 2.6.13 kernel ? What happens ?

> First, I've written an application that uses ffmpeg and SDL to perform
> image processing. It works with either pre-recorded videos or webcams.
> The webcam section works with a Logitech 4000 Pro and the pwc driver
> from Saillard. This is the section of my application code that fails
> with your driver:
>
>         // Hard code this for now.
>         //
>         params.device = filename;
>         params.channel = 0;
>         params.standard = "ntsc";
>         params.width = 640;
>         params.height = 480;
>         params.time_base.den = 24;
>         params.time_base.num = 1;
>         AVInputFormat
>             *ciformat = av_find_input_format(videoSubsystem);
>
>         if (ciformat)
>         {
>             DBG << "Found " << videoSubsystem << std::endl;
>         }
>         else
>         {
>             ERR << "AVInputFormat from av_find_input_format "
>                 "for " << videoSubsystem << " is null!" << std::endl;
>         }
>
>         DBG << "Attempting to open device: " << filename << std::endl;
>
>         if (av_open_input_file(&fmtContext, filename, ciformat, 0, &params)
> < 0) {
>             ERR << "Could not open device: " << filename << std::endl;
>             return 0;
>         }
>
> Evreything works fine for the older driver and the 4000 Pro. When I
> load your driver and plug in the Logitech Fusion I get "VIDIOCGCAP:
> Invalid argument" when calling av_open_input_file(...). I set up
> ciformat with av_find_input_format(...) where videoSubsystem is a
> const cstring equal to "video4linux". I know that you state that your
> driver does not support V4L, but V4L2. My basic questions are do I
> have V4L2 installed on my SuSE distribution, and how to I invoke it
> from ffmpeg?

V4L2 is an API. It describes the way user-space applications (in your case 
ffmpeg) communicate with the driver. You can't "install" V4L2. You will need 
to code V4L2 support in ffmpeg. Or ask nicely someone to do it for you :-)

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan  6 10:41:29 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 10:41:29 +0100
Subject: [Linux-uvc-devel] patch 490952 test on dual athlon MP smp box at work :)
In-Reply-To: <200601051619.06820.m.xhaard@crpsmasson.org>
References: <200601051619.06820.m.xhaard@crpsmasson.org>
Message-ID: <200601061041.29173.laurent.pinchart@skynet.be>

Hi Michel,

> here is the message from the patch from last night .
> First part are MJPG palette (working)  second part YUYV palette (unworking)

Thanks. Can you try the same with SMP disabled ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan  6 11:07:18 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 11:07:18 +0100
Subject: [Linux-uvc-devel] Initial use of UVC driver
In-Reply-To: <43BDB7FA.6090208@comcast.net>
References: <010520061426.13006.43BD2CAB00050857000032CE22007636920902079D9F9C9906@comcast.net> <200601051550.36525.laurent.pinchart@skynet.be> <43BDB7FA.6090208@comcast.net>
Message-ID: <200601061107.18578.laurent.pinchart@skynet.be>

> >>In doing some additional analsyis I downloaded compiled then ran the
> >> test.c program you posted.  It does access the camera but it tnen
> >> completly locks up the system. It appears to me that the Fedora 4 kernel
> >> has some differences than a stock kernel that is affecting how the
> >> driver functions.
> >
> >Can you run the test program in a virtual console (not under X) and see if
> > you get a kernel oops ? If so, please post the report.
>
> Laurent,
>
> I configured my system into runlevel 3.
> I successfully ran and stoppe your  test program.

Can you reproduce the problem when you run the test program in X ? If so, 
could you try to get a kernel oops report using a serial console (or a net 
console) ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan  6 11:11:14 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 11:11:14 +0100
Subject: [Linux-uvc-devel] Success with tvtime
Message-ID: <200601061111.15036.laurent.pinchart@skynet.be>

Hi everybody,

I commited a patch which fixes an issue with the video buffers queue (the 
buffers were not properly uninitialized when disabling the queue). I'm now 
able to use the driver with tvtime. You will have to patch tvtime with 
http://svn.berlios.de/wsvn/linux-uvc/patches/tvtime/tvtime-1.0.2-videoinput.patch?op=file&rev=0&sc=0 
(I submitted a bug report, the patch should hopefully be commited soon).

I noticed that controls (brightness, saturation, ...) sometimes timeout when 
using tvtime, I'm investigating the issue.

Have fun, and report bugs :-).

Laurent Pinchart


From mxhaard at magic.fr  Fri Jan  6 11:38:35 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 6 Jan 2006 11:38:35 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601042302.15697.laurent.pinchart@skynet.be>
References: <200601042247.07142.mxhaard@magic.fr> <200601042302.15697.laurent.pinchart@skynet.be>
Message-ID: <200601061138.36032.mxhaard@magic.fr>

Le Mercredi 4 Janvier 2006 23:02, Laurent Pinchart a ?crit?:
> Hi Michel,
>
> > Just test the rev 4 with my HP zd8000 P4 64 bits 3Go with a smp kernel,
> > graphic card ATI Mobility X600 and the uvcview SDL grabber
> > the good news
> > the driver work fine with all jpeg/size
> > SDL yuv overlay never crash :)
> > the bad news :
> > driver return EIO on VIDIOC_DQBUF with all yuyv palette in my grabbing
> > routine. SDL open a black screen but did not crash the box :)
> > to be sure
> > tested with my Athlon 2200+ Nvidia card, all size/palette are working
> > like a charm .
>
> -EIO means that the buffer has been marked as erroneous. Either because the
> URB completion handler received more data than expected or because it
> received a non-zero status. Could you check dmesg to see if it prints a
> debug message ? If not, please have a look at uvc_video_complete and add
> printks to see where it fails.
>
> Laurent Pinchart
Laurent,
I am still trying to figure out where the corruption come from on the SMP box. 
After some usefull uvc_printk() and moving some part of code from 
uvc_video_decode() to uvc_video_complete() i can make MJPEG working or not :(
even if my code do nothing exept take the value in the iso desc buffer brr .

On each usb packet desc (data[0]) the first field reffer to the packet header 
lenght ?with yuyv palette the stream start with that field set to 0 then 
toggle to 12 in the stream and  for a short  times ( ~2 usb packet) goes to 0 
when the packet length is full ? this feature only appear on yuyv palette.
On a UP box this field is constant and always egal to 12. 
I think we are not getting the right data from the urb buffer here :(
In my experiment i have get some good kernel crash :)  I suspect on restart 
the last synchro bit in the queue is not reset or maybe my grabber is wrong 
and need to dequeue all buffers on stop ?  
-- 
Michel Xhaard
http://mxhaard.free.fr


From laurent.pinchart at skynet.be  Fri Jan  6 11:59:52 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 11:59:52 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061138.36032.mxhaard@magic.fr>
References: <200601042247.07142.mxhaard@magic.fr> <200601042302.15697.laurent.pinchart@skynet.be> <200601061138.36032.mxhaard@magic.fr>
Message-ID: <200601061159.52214.laurent.pinchart@skynet.be>

> Laurent,
> I am still trying to figure out where the corruption come from on the SMP
> box. After some usefull uvc_printk() and moving some part of code from
> uvc_video_decode() to uvc_video_complete() i can make MJPEG working or not
> :( even if my code do nothing exept take the value in the iso desc buffer
> brr .

Mmmmm... Sounds like a timing issue... I don't like those.

> On each usb packet desc (data[0]) the first field reffer to the packet
> header lenght ?

(from the UVC specs)

"Each Uncompressed frame is considered a single video sample. A video sample 
is made up of one or more payload transfers (as defined in the USB Device 
Class Specification for Video Devices).

For an isochronous pipe, each (micro) frame will contain a single payload 
transfer. Each payload transfer will consist of a payload header immediately 
followed by payload data in one or more data transactions (up to 3 data 
transactions for high speed high bandwidth endpoints)."

So each frame contains a header followed by data. The frame can span up to 3 
data transactions, but that's handled by the USB layer and transparent for 
the driver.

> with yuyv palette the stream start with that field set to 0 
> then toggle to 12 in the stream and  for a short  times ( ~2 usb packet)
> goes to 0 when the packet length is full ? this feature only appear on yuyv
> palette.

That shouldn't happen. From my understanding of the spec, the header length 
should always be at least 2 (the HLE and BFH fields seem to be required, the 
PTS and SCR fields are optional).

> On a UP box this field is constant and always egal to 12. 

That's how it should be.

> I think we are not getting the right data from the urb buffer here :(

Might... I'd like you to run the same tests on the SMP box with SMP disabled. 
I'd like to be sure it's not a USB controller issue. Which kernel version are 
you running ?

> In my experiment i have get some good kernel crash :)  I suspect on restart
> the last synchro bit in the queue is not reset or maybe my grabber is wrong
> and need to dequeue all buffers on stop ?

The synchro bit is reset on restart, but I had forgotten to mark the buffers 
as idle. This is fixed in svn.

If the last packet of a frame is lost (which can happen with isochronous 
transfers), the EOF bit will not be seen and the FID bit will toggle on the 
next frame. The driver currently doesn't handle that properly, but it 
shouldn't result in a 0 header length. Try to print the second header byte as 
well (data[1]) as an hexadecimal number, and see if it tells you anything 
(have a look at USB_Video_Payload_Uncompressed_1.1.pdf to find the stream 
header description).

Laurent Pinchart


From mxhaard at magic.fr  Fri Jan  6 12:21:27 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 6 Jan 2006 12:21:27 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061159.52214.laurent.pinchart@skynet.be>
References: <200601042247.07142.mxhaard@magic.fr> <200601061138.36032.mxhaard@magic.fr> <200601061159.52214.laurent.pinchart@skynet.be>
Message-ID: <200601061221.27780.mxhaard@magic.fr>

Le Vendredi 6 Janvier 2006 11:59, Laurent Pinchart a ?crit?:
> > Laurent,
> > I am still trying to figure out where the corruption come from on the SMP
> > box. After some usefull uvc_printk() and moving some part of code from
> > uvc_video_decode() to uvc_video_complete() i can make MJPEG working or
> > not
> >
> > :( even if my code do nothing exept take the value in the iso desc buffer
> >
> > brr .
>
> Mmmmm... Sounds like a timing issue... I don't like those.
>
> > On each usb packet desc (data[0]) the first field reffer to the packet
> > header lenght ?
>
> (from the UVC specs)
>
> "Each Uncompressed frame is considered a single video sample. A video
> sample is made up of one or more payload transfers (as defined in the USB
> Device Class Specification for Video Devices).
>
> For an isochronous pipe, each (micro) frame will contain a single payload
> transfer. Each payload transfer will consist of a payload header
> immediately followed by payload data in one or more data transactions (up
> to 3 data transactions for high speed high bandwidth endpoints)."
>
> So each frame contains a header followed by data. The frame can span up to
> 3 data transactions, but that's handled by the USB layer and transparent
> for the driver.
>
> > with yuyv palette the stream start with that field set to 0
> > then toggle to 12 in the stream and  for a short  times ( ~2 usb packet)
> > goes to 0 when the packet length is full ? this feature only appear on
> > yuyv palette.
>
> That shouldn't happen. From my understanding of the spec, the header length
> should always be at least 2 (the HLE and BFH fields seem to be required,
> the PTS and SCR fields are optional).
>
> > On a UP box this field is constant and always egal to 12.
>
> That's how it should be.
>
> > I think we are not getting the right data from the urb buffer here :(
>
> Might... I'd like you to run the same tests on the SMP box with SMP
> disabled. I'd like to be sure it's not a USB controller issue. Which kernel
> version are you running ?
>
> > In my experiment i have get some good kernel crash :)  I suspect on
> > restart the last synchro bit in the queue is not reset or maybe my
> > grabber is wrong and need to dequeue all buffers on stop ?
>
> The synchro bit is reset on restart, but I had forgotten to mark the
> buffers as idle. This is fixed in svn.
>
> If the last packet of a frame is lost (which can happen with isochronous
> transfers), the EOF bit will not be seen and the FID bit will toggle on the
> next frame. The driver currently doesn't handle that properly, but it
> shouldn't result in a 0 header length. Try to print the second header byte
> as well (data[1]) as an hexadecimal number, and see if it tells you
> anything (have a look at USB_Video_Payload_Uncompressed_1.1.pdf to find the
> stream header description).
>
> Laurent Pinchart
Laurent,
Look like i need to read the spec before ask :)
Unfortunnatelly i cannot get nosmp nor noht working on my HP :( all i get is a 
black screen on boot.
Kernel is set with a Suse 2.6.11 smp on the two box. Maybe i am wrong but 
spca5xx or pwc are working fine with this SMP box so that should not be a 
controller issue. 
-- 
Michel Xhaard
http://mxhaard.free.fr


From mxhaard at magic.fr  Fri Jan  6 12:56:50 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 6 Jan 2006 12:56:50 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061159.52214.laurent.pinchart@skynet.be>
References: <200601042247.07142.mxhaard@magic.fr> <200601061138.36032.mxhaard@magic.fr> <200601061159.52214.laurent.pinchart@skynet.be>
Message-ID: <200601061256.51088.mxhaard@magic.fr>

Le Vendredi 6 Janvier 2006 11:59, Laurent Pinchart a ?crit?:
> > Laurent,
> > I am still trying to figure out where the corruption come from on the SMP
> > box. After some usefull uvc_printk() and moving some part of code from
> > uvc_video_decode() to uvc_video_complete() i can make MJPEG working or
> > not
> >
> > :( even if my code do nothing exept take the value in the iso desc buffer
> >
> > brr .
>
> Mmmmm... Sounds like a timing issue... I don't like those.
>
> > On each usb packet desc (data[0]) the first field reffer to the packet
> > header lenght ?
>
> (from the UVC specs)
>
> "Each Uncompressed frame is considered a single video sample. A video
> sample is made up of one or more payload transfers (as defined in the USB
> Device Class Specification for Video Devices).
>
> For an isochronous pipe, each (micro) frame will contain a single payload
> transfer. Each payload transfer will consist of a payload header
> immediately followed by payload data in one or more data transactions (up
> to 3 data transactions for high speed high bandwidth endpoints)."
>
> So each frame contains a header followed by data. The frame can span up to
> 3 data transactions, but that's handled by the USB layer and transparent
> for the driver.
>
> > with yuyv palette the stream start with that field set to 0
> > then toggle to 12 in the stream and  for a short  times ( ~2 usb packet)
> > goes to 0 when the packet length is full ? this feature only appear on
> > yuyv palette.
>
> That shouldn't happen. From my understanding of the spec, the header length
> should always be at least 2 (the HLE and BFH fields seem to be required,
> the PTS and SCR fields are optional).
>
> > On a UP box this field is constant and always egal to 12.
>
> That's how it should be.
>
> > I think we are not getting the right data from the urb buffer here :(
>
> Might... I'd like you to run the same tests on the SMP box with SMP
> disabled. I'd like to be sure it's not a USB controller issue. Which kernel
> version are you running ?
>
> > In my experiment i have get some good kernel crash :)  I suspect on
> > restart the last synchro bit in the queue is not reset or maybe my
> > grabber is wrong and need to dequeue all buffers on stop ?
>
> The synchro bit is reset on restart, but I had forgotten to mark the
> buffers as idle. This is fixed in svn.
>
> If the last packet of a frame is lost (which can happen with isochronous
> transfers), the EOF bit will not be seen and the FID bit will toggle on the
> next frame. The driver currently doesn't handle that properly, but it
> shouldn't result in a 0 header length. Try to print the second header byte
> as well (data[1]) as an hexadecimal number, and see if it tells you
> anything (have a look at USB_Video_Payload_Uncompressed_1.1.pdf to find the
> stream header description).
>
> Laurent Pinchart
Laurent,
http://mxhaard.free.fr/spca50x/Investigation/uvc/
messages.tar.gz from my /var/log/messages
first part MJPEG stream working
second part YUYV not working
I have also set here the uvc_video_complete() used for this record 
for a best understanding (without pass by indent sorry :))
The only difference from the original is i bypass when len <= data[0] as i did 
not want to fill all my harddrive :)
-- 
Michel Xhaard
http://mxhaard.free.fr


From laurent.pinchart at skynet.be  Fri Jan  6 13:54:54 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 13:54:54 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061221.27780.mxhaard@magic.fr>
References: <200601042247.07142.mxhaard@magic.fr> <200601061159.52214.laurent.pinchart@skynet.be> <200601061221.27780.mxhaard@magic.fr>
Message-ID: <200601061354.54392.laurent.pinchart@skynet.be>

> Look like i need to read the spec before ask :)
> Unfortunnatelly i cannot get nosmp nor noht working on my HP :( all i get
> is a black screen on boot.

:-(

> Kernel is set with a Suse 2.6.11 smp on the two box. Maybe i am wrong but
> spca5xx or pwc are working fine with this SMP box so that should not be a
> controller issue.

Except that spca5xx and pwc are USB 1.1 devices. I would have liked to make 
sure that this is not a high speed isochronous transfer issue.

Laurent Pinchart


From mxhaard at magic.fr  Fri Jan  6 13:57:39 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 6 Jan 2006 13:57:39 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061354.54392.laurent.pinchart@skynet.be>
References: <200601042247.07142.mxhaard@magic.fr> <200601061221.27780.mxhaard@magic.fr> <200601061354.54392.laurent.pinchart@skynet.be>
Message-ID: <200601061357.39162.mxhaard@magic.fr>

Le Vendredi 6 Janvier 2006 13:54, Laurent Pinchart a ?crit?:
> > Look like i need to read the spec before ask :)
> > Unfortunnatelly i cannot get nosmp nor noht working on my HP :( all i get
> > is a black screen on boot.
> >
> :-(
> :
> > Kernel is set with a Suse 2.6.11 smp on the two box. Maybe i am wrong but
> > spca5xx or pwc are working fine with this SMP box so that should not be a
> > controller issue.
>
> Except that spca5xx and pwc are USB 1.1 devices. I would have liked to make
> sure that this is not a high speed isochronous transfer issue.
>
> Laurent Pinchart
Laurent,
Good point :) 
I am just compiling a fresh 2.6.15 kernel on the HP 
-- 
Michel Xhaard
http://mxhaard.free.fr


From mxhaard at magic.fr  Fri Jan  6 15:04:25 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 6 Jan 2006 15:04:25 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061357.39162.mxhaard@magic.fr>
References: <200601042247.07142.mxhaard@magic.fr> <200601061354.54392.laurent.pinchart@skynet.be> <200601061357.39162.mxhaard@magic.fr>
Message-ID: <200601061504.25436.mxhaard@magic.fr>

Le Vendredi 6 Janvier 2006 13:57, michel Xhaard a ?crit?:
> Le Vendredi 6 Janvier 2006 13:54, Laurent Pinchart a ?crit?:
> > > Look like i need to read the spec before ask :)
> > > Unfortunnatelly i cannot get nosmp nor noht working on my HP :( all i
> > > get is a black screen on boot.
> > >
> > :-(
> > :
> > > Kernel is set with a Suse 2.6.11 smp on the two box. Maybe i am wrong
> > > but spca5xx or pwc are working fine with this SMP box so that should
> > > not be a controller issue.
> >
> > Except that spca5xx and pwc are USB 1.1 devices. I would have liked to
> > make sure that this is not a high speed isochronous transfer issue.
> >
> > Laurent Pinchart
>
> Laurent,
> Good point :)
> I am just compiling a fresh 2.6.15 kernel on the HP
Maybe a little to mutch enthousiast 2.6.15 did not boot on my HP
Waiting for /dev/hda3 to appear ...... look like it never appear nor resume ;(
-- 
Michel Xhaard
http://mxhaard.free.fr


From laurent.pinchart at skynet.be  Fri Jan  6 16:04:21 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 6 Jan 2006 16:04:21 +0100
Subject: [Linux-uvc-devel] [FIXED] Crash with tvtime on second open
Message-ID: <200601061604.21337.laurent.pinchart@skynet.be>

Hi everybody,

I just commited release 8 of uvcvideo.c which fixes a bad crash when trying to 
open the webcam two times in a row with tvtime (or actually with anything the 
second time).

Laurent Pinchart


From luc at saillard.org  Fri Jan  6 16:31:50 2006
From: luc at saillard.org (Luc Saillard)
Date: Fri, 6 Jan 2006 16:31:50 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <200601061504.25436.mxhaard@magic.fr>
References: <200601042247.07142.mxhaard@magic.fr> <200601061354.54392.laurent.pinchart@skynet.be> <200601061357.39162.mxhaard@magic.fr> <200601061504.25436.mxhaard@magic.fr>
Message-ID: <20060106153150.GB15519@sd291.sivit.org>

On Fri, Jan 06, 2006 at 03:04:25PM +0100, michel Xhaard wrote:
> Le Vendredi 6 Janvier 2006 13:57, michel Xhaard a ?crit?:
> > Le Vendredi 6 Janvier 2006 13:54, Laurent Pinchart a ?crit?:
> > > > Look like i need to read the spec before ask :)
> > > > Unfortunnatelly i cannot get nosmp nor noht working on my HP :( all i
> > > > get is a black screen on boot.

Have you try maxcpus=1 ?

> > > > Kernel is set with a Suse 2.6.11 smp on the two box. Maybe i am wrong
> > > > but spca5xx or pwc are working fine with this SMP box so that should
> > > > not be a controller issue.
> > >
> > > Except that spca5xx and pwc are USB 1.1 devices. I would have liked to
> > > make sure that this is not a high speed isochronous transfer issue.

Try to remove the ehci driver, so you disconnect the usb2.0 device, and you
will return in usb1.1. Even if you have ehci loaded and an usb device, ehci
is not used.

Luc


From wbeebe at gmail.com  Fri Jan  6 17:15:15 2006
From: wbeebe at gmail.com (William Beebe)
Date: Fri, 6 Jan 2006 11:15:15 -0500
Subject: [Linux-uvc-devel] Re: [ANNOUNCE] Linux UVC driver available
In-Reply-To: <200601061018.44410.laurent.pinchart@skynet.be>
References: <200601031816.32687.laurent.pinchart@skynet.be>
	 <e0716e9f0601050751w6a0cee52pdda9e5cff28a3fd5@mail.gmail.com>
	 <200601061018.44410.laurent.pinchart@skynet.be>
Message-ID: <e0716e9f0601060815l6f055e6bq6b5f53e723654539@mail.gmail.com>

I've got a short amount of time, so I'll just answer part of this to
you and the list.

> Why does it fail with the 2.6.13 kernel ? What happens ?

My bad. It seems I was trying to load the 2.6.15 version in the wee
hours of the mornig while running under 2.6.13-15.7. When I load the
right version with the right kernel, it loads just fine. Sorry.

> V4L2 is an API... You will need to code V4L2 support in ffmpeg.

Yep. That's the answer I was afraid of. Thanks.

On 1/6/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> Hi William,
>
> I cc'ed my answer to linux-uvc-devel at lists.berlios.de, please use the mailing
> list instead of contacting me directly (so that other people can learn from
> your problems and/or help you).
>
...
>
> V4L2 is an API. It describes the way user-space applications (in your case
> ffmpeg) communicate with the driver. You can't "install" V4L2. You will need
> to code V4L2 support in ffmpeg. Or ask nicely someone to do it for you :-)
>
> Laurent Pinchart
>


From mxhaard at magic.fr  Fri Jan  6 17:25:11 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 6 Jan 2006 17:25:11 +0100
Subject: [Linux-uvc-devel] rev 4 test with kernel smp Intel x86_64
In-Reply-To: <20060106153150.GB15519@sd291.sivit.org>
References: <200601042247.07142.mxhaard@magic.fr> <200601061504.25436.mxhaard@magic.fr> <20060106153150.GB15519@sd291.sivit.org>
Message-ID: <200601061725.12131.mxhaard@magic.fr>

Le Vendredi 6 Janvier 2006 16:31, Luc Saillard a ?crit?:
> On Fri, Jan 06, 2006 at 03:04:25PM +0100, michel Xhaard wrote:
> > Le Vendredi 6 Janvier 2006 13:57, michel Xhaard a ?crit?:
> > > Le Vendredi 6 Janvier 2006 13:54, Laurent Pinchart a ?crit?:
> > > > > Look like i need to read the spec before ask :)
> > > > > Unfortunnatelly i cannot get nosmp nor noht working on my HP :( all
> > > > > i get is a black screen on boot.
>
> Have you try maxcpus=1 ?
>
> > > > > Kernel is set with a Suse 2.6.11 smp on the two box. Maybe i am
> > > > > wrong but spca5xx or pwc are working fine with this SMP box so that
> > > > > should not be a controller issue.
> > > >
> > > > Except that spca5xx and pwc are USB 1.1 devices. I would have liked
> > > > to make sure that this is not a high speed isochronous transfer
> > > > issue.
>
> Try to remove the ehci driver, so you disconnect the usb2.0 device, and you
> will return in usb1.1. Even if you have ehci loaded and an usb device, ehci
> is not used.
>
> Luc
maxcpus=1 boot with only cpu0 thanks :) 
but seem not FIX our problem i get the same data corruption with
 data[0] = 0 :( 
removing ehci_hcd : uvcvideo did not accept 1024x576 nor 1280x960 in yuyv 
without usb2.
 My SDL grabber return Unable to set format !! 
-- 
Michel Xhaard
http://mxhaard.free.fr


From ostheimer at gmail.com  Fri Jan  6 21:46:03 2006
From: ostheimer at gmail.com (Drew Ostheimer)
Date: Fri, 6 Jan 2006 15:46:03 -0500
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
Message-ID: <601a9acf0601061246v2cea8757t2ebd9785ce0b1c6b@mail.gmail.com>

Hello Olivier Et All,

It's great to see some people working on this driver. I am working
with a Quickcam for Notebooks Pro, megapixle edition. I have installed
and got the uvcvideo module to load and when i connect the camera
everything is recognized properly. The only thing i see lacking is it
not informing me that it is attached to /dev/video*. I am unsure of
where it is getting attached and that could be half my problem.



Olivier: Would it be possible to post a simple OpenCV application to
grab 1 frame from the camera? Would be greatly appreciated and help me
in my endeavor.


From ostheimer at gmail.com  Fri Jan  6 21:52:22 2006
From: ostheimer at gmail.com (Drew Ostheimer)
Date: Fri, 6 Jan 2006 15:52:22 -0500
Subject: [Linux-uvc-devel] Slackware 10.2 - 2.6.15 vanilla
Message-ID: <601a9acf0601061252v4b31f222mf6816823fe2b773@mail.gmail.com>

Hey All,

Sorry about the last message, hit send when i was meaning to past in
some of the results.

Here is my dmesg output:

usb 2-2: new full speed USB device using ohci_hcd and address 2
usbvideo: Probing device 2
Format MJPEG found
usbvideo: Found a Status endpoint (addr 87).
usbvideo: Found UVC device (1.00)
usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
usbvideo: Found a valid video chain (1 -> 5).
usbvideo: UVC device initialized.
usbcore: registered new driver usbvideo
USB Video Class driver (v0.1.0)


And my output running the previous test application which was posted
in the mailing list:

Device /dev/video0 opened: .
Unable to set format: 22.

Hopefully this will be able to give you guys a better idea on what i
am working with. If you should require anything don't hesitate to ask.

And again, work on a driver like this is amazing! Keep it up!

Regards,

Drew Ostheimer

---------- Original message ----------
From: Drew Ostheimer <ostheimer at gmail.com>
Date: Jan 6, 2006 3:46 PM
Subject: Re: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
To: linux-uvc-devel at lists.berlios.de


Hello Olivier Et All,

It's great to see some people working on this driver. I am working
with a Quickcam for Notebooks Pro, megapixle edition. I have installed
and got the uvcvideo module to load and when i connect the camera
everything is recognized properly. The only thing i see lacking is it
not informing me that it is attached to /dev/video*. I am unsure of
where it is getting attached and that could be half my problem.



Olivier: Would it be possible to post a simple OpenCV application to
grab 1 frame from the camera? Would be greatly appreciated and help me
in my endeavor.


From Olivier.Bornet at idiap.ch  Fri Jan  6 23:58:32 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Fri, 6 Jan 2006 23:58:32 +0100
Subject: [Linux-uvc-devel] Test of the driver on GNU/Debian amd64
In-Reply-To: <601a9acf0601061246v2cea8757t2ebd9785ce0b1c6b@mail.gmail.com>
References: <601a9acf0601061246v2cea8757t2ebd9785ce0b1c6b@mail.gmail.com>
Message-ID: <20060106225832.GA5474@idiap.ch>

Hello,

> Olivier: Would it be possible to post a simple OpenCV application to
> grab 1 frame from the camera? Would be greatly appreciated and help me
> in my endeavor.

Just download the CVS version of OpenCV from:

    http://sourceforge.net/cvs/?group_id=22870

Build and install. Then, try one of the sample in samples/c/ or
samples/python/. To see how to use the camera, you can look at
samples/c/camshiftdemo.c or samples/python/cam-histo.py (my preference
goes to the python version :-) ).

In general, I'm testing uvc with cam-histo.py. (don't have try the C
version at with uvc, but it should works without problems). If you just
want to grab 1 frame from the cam, this simple python code should works:

    from opencv import highgui
    device_nb = 0
    capture = highgui.cvCaptureFromCAM (device_nb)
    frame = highgui.cvQueryFrame (capture)
    highgui.cvSaveImage ('my-frame.jpg', frame)

Hope this help.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060106/c9df1bfc/attachment.pgp>

From laurent.pinchart at skynet.be  Sat Jan  7 11:30:33 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 7 Jan 2006 11:30:33 +0100
Subject: [Linux-uvc-devel] Slackware 10.2 - 2.6.15 vanilla
In-Reply-To: <601a9acf0601061252v4b31f222mf6816823fe2b773@mail.gmail.com>
References: <601a9acf0601061252v4b31f222mf6816823fe2b773@mail.gmail.com>
Message-ID: <200601071130.33760.laurent.pinchart@skynet.be>

> Here is my dmesg output:
>
> usb 2-2: new full speed USB device using ohci_hcd and address 2

full speed means USB 1.1, 12Mb/s. Uncompressed YUYV formats won't be 
available. If your hardware supports USB 2.0, please investigate. Have you 
loaded the EHCI module ?

Laurent Pinchart


From ostheimer at gmail.com  Sat Jan  7 16:31:37 2006
From: ostheimer at gmail.com (Drew Ostheimer)
Date: Sat, 7 Jan 2006 10:31:37 -0500
Subject: [Linux-uvc-devel] Re: Test of the driver on GNU/Debian amd64
Message-ID: <601a9acf0601070731q7e1873cfrf7e5433c97678ef7@mail.gmail.com>

Hello,

> Just download the CVS version of OpenCV from:
>
>     http://sourceforge.net/cvs/?group_id=3D22870

Did that yesterday and actually got it to compile.

> Build and install. Then, try one of the sample in samples/c/ or
> samples/python/. To see how to use the camera, you can look at
> samples/c/camshiftdemo.c or samples/python/cam-histo.py (my preference
> goes to the python version :-) ).

I compiled the C version yesterday and the samples seem to be working
properly. Thanks for you help with this matter.

I was wondering if you had a sample piece of code for changing the
camera resolution? I seem to be getting 640x480 nice and smooth, but i
would rather work in 320x240, limitations on my processing algorithms.
Is there a way to grab straight from the camera at this resolution or
should i just convert in my application? There is already a heavy load
on the processors by the way.

Regards,

Drew Ostheimer


From ostheimer at gmail.com  Sat Jan  7 16:42:19 2006
From: ostheimer at gmail.com (Drew Ostheimer)
Date: Sat, 7 Jan 2006 10:42:19 -0500
Subject: [Linux-uvc-devel] Slackware 10.2 - 2.6.15 vanilla
Message-ID: <601a9acf0601070742h5ebae01cq15a6617976180785@mail.gmail.com>

Hi,

> full speed means USB 1.1, 12Mb/s. Uncompressed YUYV formats won't be
> available. If your hardware supports USB 2.0, please investigate. Have you
> loaded the EHCI module ?

I have EHCI built into the kernel, however i noticed by looking into
the specs of my main board that it is only USB 1.1. I do wish to let
you know that i can capture from the camera using OpenCV, so the
driver is working correctly on my system.

Keep up the great work on this driver, I can honestly say that the
hardware is good, and your driver is awesome. To my eyes i am
receiving a better image on my Linux box with USB 1.1 then i do on my
Notebook with USB 2.0 with windows.

I also receive these emails in a digest, and can't for the life of me
figure out the subject line i should be replying with to keep my
emails in the thread. If you know could you please let me know, i hate
creating new threads for nothing.

Regards,

Drew Ostheimer


From mxhaard at magic.fr  Sat Jan  7 19:55:46 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Sat, 7 Jan 2006 19:55:46 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
Message-ID: <200601071955.46267.mxhaard@magic.fr>

Aujourd'hui 19:51:24
  ?
Hi
uvcview grabber is available ?for testing : 
http://mxhaard.free.fr/spca50x/Investigation/uvc/
need libSDL installed
?linux framebuffer or X11
????????features 
????????display in overlay all surfaces from the uvcvideo webcam. without 
colors 
transformations (all done by your videocard)
????????controls are set by mouse or keyboard
????????windows are resizable on the fly
????????get picture in jpeg mode only
to run the apps
uvcview -d /dev/video0 -f jpg -s 960x720
ask uvcvideo on video0, palette jpeg, width 960, height 720

uvcview -d /dev/video0 -f yuv -s 1024x576
ask uvcvideo on video0, palette yuyv, width 1024, height 576

If the size is not good uvcview will follow uvcvideo transaction and run the 
first nearest available resolution with the same palette.

Know bugs:
Crash Laurent Pinchart box with ATI card ( maybe FIXED by this release)
-- 
Michel Xhaard
http://mxhaard.free.fr


From Olivier.Bornet at idiap.ch  Sat Jan  7 23:56:43 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Sat, 7 Jan 2006 23:56:43 +0100
Subject: [Linux-uvc-devel] Re: Test of the driver on GNU/Debian amd64
In-Reply-To: <601a9acf0601070731q7e1873cfrf7e5433c97678ef7@mail.gmail.com>
References: <601a9acf0601070731q7e1873cfrf7e5433c97678ef7@mail.gmail.com>
Message-ID: <20060107225643.GA13323@idiap.ch>

Hello,

<comment>
A little bit off-topic, as this talk about OpenCV...
Next questions about OpenCV should maybe done on the OpenCV mailing
list: http://www.yahoogroups.com/group/OpenCV
</comment>

> I was wondering if you had a sample piece of code for changing the
> camera resolution? I seem to be getting 640x480 nice and smooth, but i
> would rather work in 320x240, limitations on my processing algorithms.
> Is there a way to grab straight from the camera at this resolution or
> should i just convert in my application? There is already a heavy load
> on the processors by the way.

here is the Python code for doing this:
  # set the wanted image size from the camera
  highgui.cvSetCaptureProperty (capture, highgui.CV_CAP_PROP_FRAME_WIDTH, 320)
  highgui.cvSetCaptureProperty (capture, highgui.CV_CAP_PROP_FRAME_HEIGHT,240)

I will let you make the C code as an exercice. ;-)

Have a nice night.

        Olivier
-- 
   . __    . ___  __.  | Olivier Bornet         Olivier.Bornet at idiap.ch
  / /  `  / /  / /  /  | IDIAP             http://www.idiap.ch/~bornet/
 / /   / / /--/ /--'   | CP 592        http://www.idiap.ch/~bornet/pgp/
/ /__.' / /  / /       | CH-1920 Martigny           PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060107/15be0ab4/attachment.pgp>

From jwspring at comcast.net  Sun Jan  8 01:00:27 2006
From: jwspring at comcast.net (James W. Spring)
Date: Sat, 07 Jan 2006 16:00:27 -0800
Subject: [Linux-uvc-devel] Initial use of UVC driver
Message-ID: <43C0561B.2050302@comcast.net>

I retried the test script under a gnome terminal and it
completed correctly. I will continue to duplicate
the lockup I first experienced.

I need to thank you for developing this driver.

James


From simo at archlinux.org  Sun Jan  8 06:58:50 2006
From: simo at archlinux.org (Simo Leone)
Date: Sat, 7 Jan 2006 23:58:50 -0600
Subject: [Linux-uvc-devel] UVC Device
Message-ID: <20060108055850.GA1516@neotuli.net>

Hello, I saw the request on the homepage about reporting UVC devices.

I own a Fuji Finepix E500, it is a digital camera that can be put into a
webcam mode. When in this mode, it appears to act as a UVC device. 
I would be willing to do testing as well, feel free to contact me if it
is needed.

-Simo


lsusb -v output from it follows:

--snip--
Bus 004 Device 002: ID 04cb:0169 Fuji Photo Film Co., Ltd 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 Common Class
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04cb Fuji Photo Film Co., Ltd
  idProduct          0x0169 
  bcdDevice            1.00
  iManufacturer           0 
  iProduct                2 USB Web Camera
  iSerial                 3 A-Serial-Number
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          156
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower               50mA
    UNRECOGNIZED:  08 0b 00 02 0e 03 00 00
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
--snip--
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060107/7142cd4f/attachment.pgp>

From maxime.delorme at tiscali.fr  Sun Jan  8 11:15:19 2006
From: maxime.delorme at tiscali.fr (=?iso-8859-1?Q?maxime.delorme@tiscali.fr?=)
Date: Sun,  8 Jan 2006 11:15:19 +0100
Subject: [Linux-uvc-devel] =?iso-8859-1?Q?[Linux-uvc-devel]_uvcview_videograbber_with_preview_available_for_testing?=
Message-ID: <ISRR5J$4E0D0848AFCA5048F867BB0978548C6C@aliceadsl.fr>

Hello from France !
I've just buy a new webcam : logiteck webcam pro 5000
I've just compile uvcview and its works really well, for the
first time I see the image from my webcam
I'm under kubuntu breezy kde 3.5
I've got still a probleme with vlc (VideolanClient) or
kopete I can see images from my webcam.

Does I miss something

Thank for your help and your contribution for the OpenSource
World

Maxime Delorme from Paris

-------------- ALICE HAUT DEBIT : TRIPLE PLAY A 29,95 EUR/MOIS -------------- 
D?couvrez vite ALICEBOX : avec le modem WIFI, profitez de l'ADSL, de la TELEPHONIE et en exclusivit? de la TELEVISION ! 
B?n?ficiez aussi de la hotline gratuite 24h/24 ! Soumis ? conditions. Pour en profiter cliquez ici http://abonnement.aliceadsl.fr






From laurent.pinchart at skynet.be  Sun Jan  8 15:53:04 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jan 2006 15:53:04 +0100
Subject: [Linux-uvc-devel] [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <ISRR5J$4E0D0848AFCA5048F867BB0978548C6C@aliceadsl.fr>
References: <ISRR5J$4E0D0848AFCA5048F867BB0978548C6C@aliceadsl.fr>
Message-ID: <200601081553.04583.laurent.pinchart@skynet.be>

Hi Maxime,

> I've just buy a new webcam : logiteck webcam pro 5000
> I've just compile uvcview and its works really well, for the
> first time I see the image from my webcam
> I'm under kubuntu breezy kde 3.5
> I've got still a probleme with vlc (VideolanClient) or
> kopete I can see images from my webcam.
>
> Does I miss something

Yes. Unfortunately, neither Kopete nor Gnomemeeting support the image formats 
that your webcam can produce. I expect vlc has the same problems. 
Applications will need to be fixed to handle MJPEG. I had a look at the video 
support code in Kopete, it will probably need to be rewritten.

> Thank for your help and your contribution for the OpenSource
> World

You're welcome :-)

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jan  8 15:55:16 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jan 2006 15:55:16 +0100
Subject: [Linux-uvc-devel] UVC Device
In-Reply-To: <20060108055850.GA1516@neotuli.net>
References: <20060108055850.GA1516@neotuli.net>
Message-ID: <200601081555.16985.laurent.pinchart@skynet.be>

Hi Simo,

> I own a Fuji Finepix E500, it is a digital camera that can be put into a
> webcam mode. When in this mode, it appears to act as a UVC device.
> I would be willing to do testing as well, feel free to contact me if it
> is needed.

Could you please send me the whole USB descriptors ? It seems from the snipet 
in your mail that your digital camera works in bulk mode, which is not 
implemented yet (I don't own any bulk mode hardware). If you're interested in 
implementing bulk support, please contact me.

Laurent Pinchart


From simo at archlinux.org  Sun Jan  8 18:42:55 2006
From: simo at archlinux.org (Simo Leone)
Date: Sun, 8 Jan 2006 11:42:55 -0600
Subject: [Linux-uvc-devel] UVC Device
In-Reply-To: <200601081555.16985.laurent.pinchart@skynet.be>
References: <20060108055850.GA1516@neotuli.net> <200601081555.16985.laurent.pinchart@skynet.be>
Message-ID: <20060108174255.GA2968@archlinux.org>

On Sun, Jan 08, 2006 at 03:55:16PM +0100, Laurent Pinchart wrote:
> Hi Simo,
> 
> Could you please send me the whole USB descriptors ? It seems from the snipet 
> in your mail that your digital camera works in bulk mode, which is not 
> implemented yet (I don't own any bulk mode hardware). If you're interested in 
> implementing bulk support, please contact me.

I'm not sure this is what you wanted, but let's try anyway.
Unfortunately I don't know enough about the workings of USB, but it
sounds like now is as good a time as any to learn :)

-S

--snip--
T:  Bus=04 Lev=01 Prnt=01 Port=01 Cnt=01 Dev#=  3 Spd=12  MxCh= 0
D:  Ver= 2.00 Cls=ef(unk. ) Sub=02 Prot=01 MxPS=64 #Cfgs=  1
P:  Vendor=04cb ProdID=0169 Rev= 1.00
S:  Product=USB Web Camera
S:  SerialNumber=Y-702^^^^^041024XFPX000F004039
C:* #Ifs= 2 Cfg#= 1 Atr=c0 MxPwr= 50mA
I:  If#= 0 Alt= 0 #EPs= 0 Cls=0e(unk. ) Sub=01 Prot=00 Driver=(none)
I:  If#= 1 Alt= 0 #EPs= 1 Cls=0e(unk. ) Sub=02 Prot=00 Driver=(none)
E:  Ad=81(I) Atr=02(Bulk) MxPS=  64 Ivl=0ms
--snip--

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060108/78ce9e5d/attachment.pgp>

From laurent.pinchart at skynet.be  Sun Jan  8 19:53:26 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jan 2006 19:53:26 +0100
Subject: [Linux-uvc-devel] UVC Device
In-Reply-To: <20060108174255.GA2968@archlinux.org>
References: <20060108055850.GA1516@neotuli.net> <200601081555.16985.laurent.pinchart@skynet.be> <20060108174255.GA2968@archlinux.org>
Message-ID: <200601081953.26237.laurent.pinchart@skynet.be>

Hi Simo,

> I'm not sure this is what you wanted, but let's try anyway.

Sorry, I haven't been clear enough. I'd like the output of lsusb -v with the 
CVS version of usbutils (http://sourceforge.net/cvs/?group_id=3581). If you 
can't do that, please cat /proc/bus/usb/your/device and send me the result.

> Unfortunately I don't know enough about the workings of USB, but it
> sounds like now is as good a time as any to learn :)

Do you have any experience with device driver development ? The starting point 
here would be to read the UVC spec. You can find a link at the bottom of the 
Linux UVC page.

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jan  8 23:13:41 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 8 Jan 2006 23:13:41 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr>
Message-ID: <200601082313.41340.laurent.pinchart@skynet.be>

> So I'm quite disappointed.
> So how could I use my new webcam ?
> Is there a hope that one day I could use my webcam to do IM ?
> Or at least that I could record movies ?

Don't worry, there's always hope :-)

You can already use your webcam with uvcview or tvtime (if you apply following 
patch to tvtime: 
http://svn.berlios.de/wsvn/linux-uvc/patches/tvtime/tvtime-1.0.2-videoinput.patch?op=file&rev=0&sc=0).

IM support will come (hopefully) soon. It's "just" a matter of implementing 
proper v4l2 and MJPEG support in Kopete and Gnomemeeting. Is there someone 
here who could fix one (or both :-)) of those applications ?

> Finally what can I do or wil be able to do  with my webcam ?

You will be able to use your webcam with all Linux video applications. There 
is no video multimedia framework widely used in Linux applications today, so 
all applications must implement MJPEG support. Maybe KDE4 will fill a big 
hole. But don't worry, Kopete will support your webcam before KDE4. Is there 
someone here already involved with the KDE multimedia development team ? It 
sounds like the right time to raise the video acquisition matter with them.

Laurent Pinchart


From mxhaard at magic.fr  Mon Jan  9 00:13:42 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Mon, 9 Jan 2006 00:13:42 +0100
Subject: [Linux-uvc-devel] [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <ISRR5J$4E0D0848AFCA5048F867BB0978548C6C@aliceadsl.fr>
References: <ISRR5J$4E0D0848AFCA5048F867BB0978548C6C@aliceadsl.fr>
Message-ID: <200601090013.42195.mxhaard@magic.fr>

Le Dimanche 8 Janvier 2006 11:15, maxime.delorme at tiscali.fr a ?crit?:
> Hello from France !
> I've just buy a new webcam : logiteck webcam pro 5000
> I've just compile uvcview and its works really well, for the
> first time I see the image from my webcam
> I'm under kubuntu breezy kde 3.5
> I've got still a probleme with vlc (VideolanClient) or
> kopete I can see images from my webcam.
>
> Does I miss something
>
> Thank for your help and your contribution for the OpenSource
> World
>
> Maxime Delorme from Paris
>
Maxime,
Thanks for your feedback :) be sure someone will implement VLC soon
Best regards from Melun 
-- 
Michel Xhaard
http://mxhaard.free.fr


From ynutcase-uvc at yahoo.com  Mon Jan  9 03:15:57 2006
From: ynutcase-uvc at yahoo.com (ynutcase-uvc at yahoo.com)
Date: Sun, 8 Jan 2006 18:15:57 -0800 (PST)
Subject: [Linux-uvc-devel] UVC works for me!  Congrats!
Message-ID: <20060109021557.40875.qmail@web36212.mail.mud.yahoo.com>

Hi all,

Just installed the uvcvideo driver from svn (revision
8) and the uvcview 20060107 application, and my
Logitech Quickcam Fusion worked perfectly (given my 5
minutes of testing, that is).  

Thank you all for this wonderful piece of software!  

doodad ~ # lsusb
[deleted]
Bus 001 Device 002: ID 046d:08c1 Logitech, Inc.

Take care,
-- Nick



From jwspring at comcast.net  Mon Jan  9 03:33:03 2006
From: jwspring at comcast.net (James W. Spring)
Date: Sun, 08 Jan 2006 18:33:03 -0800
Subject: [Linux-uvc-devel] Error messages using tvtime
Message-ID: <43C1CB5F.6020901@comcast.net>

I've attached an error file containing a screen capture
and dmesg output after attempting to use tvtime.
tvtime has your patch included
I have the latest version of the driver
I'm running it on a gnome termial
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: error
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060108/91aba48a/attachment.ksh>

From luc at saillard.org  Mon Jan  9 09:11:24 2006
From: luc at saillard.org (Luc Saillard)
Date: Mon, 9 Jan 2006 09:11:24 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <200601082313.41340.laurent.pinchart@skynet.be>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601082313.41340.laurent.pinchart@skynet.be>
Message-ID: <20060109081124.GL15519@sd291.sivit.org>

On Sun, Jan 08, 2006 at 11:13:41PM +0100, Laurent Pinchart wrote:
> 
> You can already use your webcam with uvcview or tvtime (if you apply following 
> patch to tvtime: 
> http://svn.berlios.de/wsvn/linux-uvc/patches/tvtime/tvtime-1.0.2-videoinput.patch?op=file&rev=0&sc=0).
> 
> IM support will come (hopefully) soon. It's "just" a matter of implementing 
> proper v4l2 and MJPEG support in Kopete and Gnomemeeting. Is there someone 
> here who could fix one (or both :-)) of those applications ?

Last week, i've made a patch for gnomemeeting, to add a new format to support
the pwc driver, i can add the mjpeg format. I hope that gnomemeeting is link
to the jpeg library or something like that. I've try to modify the driver,
(and a little mplayer) to support uvc but it crash my kernel seems to be the
bug related with ati chipset. I've not retested with a more recent kernel.

> > Finally what can I do or wil be able to do  with my webcam ?
> 
> You will be able to use your webcam with all Linux video applications. There 
> is no video multimedia framework widely used in Linux applications today, so 
> all applications must implement MJPEG support. Maybe KDE4 will fill a big 

Note that one another webcam is using mjpeg, It's the motion eye (meye) on
some old sony laptop. But it's a v4l1 only app.

> hole. But don't worry, Kopete will support your webcam before KDE4. Is there 
> someone here already involved with the KDE multimedia development team ? It 
> sounds like the right time to raise the video acquisition matter with them.

I've some problem with kopete to at least support my webcam, but i've not
looked the code. Kopete and gnomemeeting is c++ code.

Luc


From laurent.pinchart at skynet.be  Mon Jan  9 11:04:59 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 11:04:59 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <20060109081124.GL15519@sd291.sivit.org>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601082313.41340.laurent.pinchart@skynet.be> <20060109081124.GL15519@sd291.sivit.org>
Message-ID: <200601091104.59818.laurent.pinchart@skynet.be>

Hi Luc,

> Last week, i've made a patch for gnomemeeting, to add a new format to
> support the pwc driver, i can add the mjpeg format.

Great news ! Damien Sandras will be happy. I've had a look at pwlib. The code 
is quite clean, but I don't have time to do it myself, so I'm glad you 
offered your help.

> I hope that gnomemeeting is link to the jpeg library or something like that.

I don't think it will be a problem to link to libjpeg (even if Damien would 
rather avoid it if possible). Remember that the MJPEG data doesn't contain 
the Huffman tables, so you need to add them manually (see the Qt patch I 
posted on this list).

> I've try 
> to modify the driver, (and a little mplayer) to support uvc but it crash my
> kernel seems to be the bug related with ati chipset. I've not retested with
> a more recent kernel.

Why did you need to modify the driver ?

> I've some problem with kopete to at least support my webcam, but i've not
> looked the code. Kopete and gnomemeeting is c++ code.

I'll see if I can code MJPEG support for Kopete in the not-so-distant future. 
I'm currently working on adding proper controls support to the driver.

Laurent Pinchart



From laurent.pinchart at skynet.be  Mon Jan  9 11:10:41 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 11:10:41 +0100
Subject: [Linux-uvc-devel] Error messages using tvtime
In-Reply-To: <43C1CB5F.6020901@comcast.net>
References: <43C1CB5F.6020901@comcast.net>
Message-ID: <200601091110.41683.laurent.pinchart@skynet.be>

Hi James,

> I've attached an error file containing a screen capture
> and dmesg output after attempting to use tvtime.
> tvtime has your patch included
> I have the latest version of the driver
> I'm running it on a gnome termial

> error
>   tvtime messages
>
> Running tvtime 1.0.1.
> Reading configuration from /home/jwspring/.tvtime/tvtime.xml
> videoinput: Driver won't tell us its norm: Invalid argument
> videoinput: Can't get tuner info: Invalid argument
> videoinput: Driver won't tell us its norm: Invalid argument
> videoinput: Can't get tuner info: Invalid argument
>
> ? ? Cannot allocate enough off-screen video memory. ?This may be fixed by:
>
> ? ? ? 1. Closing or restarting large X applications.
> ? ? ? 2. Lowering the input width of tvtime (--inputwidth parameter).
> ? ? ? 3. Lowering your colour depth or highest configured resolution.
> ? ? ? 4. Increasing the amount of video memory in your X config file
> ? ? ? ? ?(for example, if you are using the i810 XFree86 driver.)
>
> ? ? See http://tvtime.net/ for more information.

This doesn't seem related to the driver. The dmesg log seems perfectly normal 
(the 'failed to query control' messages can be ignored for now).

Have you tried to above fixes ? If it fails, can you try to get support from 
tvtime ?

Laurent Pinchart



From luc at saillard.org  Mon Jan  9 11:13:54 2006
From: luc at saillard.org (Luc Saillard)
Date: Mon, 9 Jan 2006 11:13:54 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <200601091104.59818.laurent.pinchart@skynet.be>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601082313.41340.laurent.pinchart@skynet.be> <20060109081124.GL15519@sd291.sivit.org> <200601091104.59818.laurent.pinchart@skynet.be>
Message-ID: <20060109101354.GN15519@sd291.sivit.org>

On Mon, Jan 09, 2006 at 11:04:59AM +0100, Laurent Pinchart wrote:
> Hi Luc,
> 
> > I hope that gnomemeeting is link to the jpeg library or something like that.
> 
> I don't think it will be a problem to link to libjpeg (even if Damien would 
> rather avoid it if possible). Remember that the MJPEG data doesn't contain 
> the Huffman tables, so you need to add them manually (see the Qt patch I 
> posted on this list).

Yes, I've made it to uncompress mjpeg data from an avi, and mov file for my
gallery program (photon) written in python. I known it's not the best langage
to play with bitstream, but it's working i recreate a full jpeg header from
the stream. Else, i dont' known how to decode jpeg data + huffman table
without the libjpeg. I'll look Qt. For now, i only do conversion for the YVY2
format.
 
> Why did you need to modify the driver ?

To support ENUM_STD. Only to not return -EINVAL. But it failed somewhere
after that ... This is why i don't send the patch. Here the patch use:

/mnt/linux/srcs/usb/uvc/linux-uvc>LC_ALL=C svn diff
Index: uvcvideo.c
===================================================================
--- uvcvideo.c  (revision 8)
+++ uvcvideo.c  (working copy)
@@ -2071,12 +2071,34 @@
                return uvc_video_enable(video, 0);
        }
 
-       /* Analog video standards make no sense for digital cameras. */
-       case VIDIOC_ENUMSTD:
-       case VIDIOC_QUERYSTD:
+       /* Analog video standards make no sense for digital cameras, but some
+         * application need it (mplayer for example) */
        case VIDIOC_G_STD:
+       {
+         v4l2_std_id *std = arg;
+         *std = V4L2_STD_UNKNOWN;
+         return 0;
+       }
+
        case VIDIOC_S_STD:
+       {
+         v4l2_std_id *std = arg;
+         if (*std != V4L2_STD_UNKNOWN)
+           return -EINVAL;
+         return 0;
+       }
 
+       case VIDIOC_ENUMSTD:
+       {
+         struct v4l2_standard *std = arg;
+         if (std->index != 0)
+           return -EINVAL;
+         std->id = V4L2_STD_UNKNOWN;
+         strncpy(std->name, "webcam", sizeof(std->name));
+         return 0;
+       }
+       case VIDIOC_QUERYSTD:
+
        case VIDIOC_OVERLAY:
 
        case VIDIOC_ENUMAUDIO:

Wait ... i just receved a patch for pwc, to add these lines after the
strncpy.
                                                                                                                  
                std->frameperiod.numerator = 1;                 // NEW                                            
                std->frameperiod.denominator = pdev->vframes;   // NEW  

Luc


From laurent.pinchart at skynet.be  Mon Jan  9 11:33:25 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 11:33:25 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <20060109101354.GN15519@sd291.sivit.org>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601091104.59818.laurent.pinchart@skynet.be> <20060109101354.GN15519@sd291.sivit.org>
Message-ID: <200601091133.25540.laurent.pinchart@skynet.be>

> Yes, I've made it to uncompress mjpeg data from an avi, and mov file for my
> gallery program (photon) written in python. I known it's not the best
> langage to play with bitstream, but it's working i recreate a full jpeg
> header from the stream. Else, i dont' known how to decode jpeg data +
> huffman table without the libjpeg.

You definitely need a library to decode MJPEG. libjpeg might be a bit too big 
to do the job (MJPEG is a small subset of all possible JPEG formats), but 
it's the easiest to use for prototyping.

> I'll look Qt. For now, i only do conversion for the YVY2 format.

The Qt patch I wrote modifies the Qt JPEG codec which uses libjpeg, so you 
will be able to reuse the code in Gnomemeeting. Be careful about licensing 
issues though. pwlib is licensed under the Mozilla Public License 1.1 and Qt 
under the GNU Public License. You can reuse my code in pwlib (I grant you the 
right to use it under the MPL), but not Qt code.

> > Why did you need to modify the driver ?
>
> To support ENUM_STD. Only to not return -EINVAL. But it failed somewhere
> after that ... This is why i don't send the patch. Here the patch use:

Mmmmm... Shouldn't mplayer be fixed instead ? V4L2 v0.8 doesn't make it 
mandatory to support ENUM_STD:

(1.7. Video Standards)

"Here the driver shall set the std ?eld of struct v4l2_input and struct 
v4l2_output to zero, the VIDIOC_G_STD, VIDIOC_S_STD, VIDIOC_QUERYSTD and 
VIDIOC_ENUMSTD ioctls shall return the EINVAL error code."

Laurent Pinchart



From jwspring at comcast.net  Mon Jan  9 16:50:07 2006
From: jwspring at comcast.net (jwspring at comcast.net)
Date: Mon, 09 Jan 2006 15:50:07 +0000
Subject: [Linux-uvc-devel] Error messages using tvtime
Message-ID: <010920061550.10805.43C2862F0008AAB700002A3522007636920902079D9F9C9906@comcast.net>

I'm attempting to understand what those messages indicate.
One thing I'm not sure I have included is that I'm using the
driver on a labtop, not with an external video card.


From luc at saillard.org  Mon Jan  9 17:10:28 2006
From: luc at saillard.org (Luc Saillard)
Date: Mon, 9 Jan 2006 17:10:28 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <200601091133.25540.laurent.pinchart@skynet.be>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601091104.59818.laurent.pinchart@skynet.be> <20060109101354.GN15519@sd291.sivit.org> <200601091133.25540.laurent.pinchart@skynet.be>
Message-ID: <20060109161028.GO15519@sd291.sivit.org>

On Mon, Jan 09, 2006 at 11:33:25AM +0100, Laurent Pinchart wrote:
> > Yes, I've made it to uncompress mjpeg data from an avi, and mov file for my
> > gallery program (photon) written in python. I known it's not the best
> > langage to play with bitstream, but it's working i recreate a full jpeg
> > header from the stream. Else, i dont' known how to decode jpeg data +
> > huffman table without the libjpeg.
> 
> You definitely need a library to decode MJPEG. libjpeg might be a bit too big 
> to do the job (MJPEG is a small subset of all possible JPEG formats), but 
> it's the easiest to use for prototyping.

Ok i've done the code for gnomemeeting (the easy part). I use the YUY2 format
(so it's not very efficient to convert from 1024x576, but i can be use if
another webcam don't support MJPEG stream. I'll send the patch to damien (one
for v4l2 plugin and the other for ptlib). Next step is to add the mjpeg
codec.
 
> Mmmmm... Shouldn't mplayer be fixed instead ? V4L2 v0.8 doesn't make it 
> mandatory to support ENUM_STD:
> 
> (1.7. Video Standards)
> 
> "Here the driver shall set the std ???eld of struct v4l2_input and struct 
> v4l2_output to zero, the VIDIOC_G_STD, VIDIOC_S_STD, VIDIOC_QUERYSTD and 
> VIDIOC_ENUMSTD ioctls shall return the EINVAL error code."
> 
 
Yes i known, but adding this 3 calls is not very much to help others
applications.

Luc


From laurent.pinchart at skynet.be  Mon Jan  9 17:16:45 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 17:16:45 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <20060109161028.GO15519@sd291.sivit.org>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601091133.25540.laurent.pinchart@skynet.be> <20060109161028.GO15519@sd291.sivit.org>
Message-ID: <200601091716.45668.laurent.pinchart@skynet.be>

> Ok i've done the code for gnomemeeting (the easy part). I use the YUY2
> format (so it's not very efficient to convert from 1024x576, but i can be
> use if another webcam don't support MJPEG stream. I'll send the patch to
> damien (one for v4l2 plugin and the other for ptlib). Next step is to add
> the mjpeg codec.

Damien told me that Craig Southeren might not want to link against libjpeg. 
You should contact him.

> > Mmmmm... Shouldn't mplayer be fixed instead ? V4L2 v0.8 doesn't make it
> > mandatory to support ENUM_STD:
> >
> > (1.7. Video Standards)
> >
> > "Here the driver shall set the std ???eld of struct v4l2_input and struct
> > v4l2_output to zero, the VIDIOC_G_STD, VIDIOC_S_STD, VIDIOC_QUERYSTD and
> > VIDIOC_ENUMSTD ioctls shall return the EINVAL error code."
>
> Yes i known, but adding this 3 calls is not very much to help others
> applications.

When possible, I'd like to avoid adding workarounds for broken applications if 
the applications can be fixed. That way we won't have to care about backward 
bug compatibility during development.

Laurent Pinchart



From mxhaard at magic.fr  Mon Jan  9 19:37:52 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Mon, 9 Jan 2006 19:37:52 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <200601091133.25540.laurent.pinchart@skynet.be>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <20060109101354.GN15519@sd291.sivit.org> <200601091133.25540.laurent.pinchart@skynet.be>
Message-ID: <200601091937.53145.mxhaard@magic.fr>

Le Lundi 9 Janvier 2006 11:33, Laurent Pinchart a ?crit?:
> > Yes, I've made it to uncompress mjpeg data from an avi, and mov file for
> > my gallery program (photon) written in python. I known it's not the best
> > langage to play with bitstream, but it's working i recreate a full jpeg
> > header from the stream. Else, i dont' known how to decode jpeg data +
> > huffman table without the libjpeg.
>
> You definitely need a library to decode MJPEG. libjpeg might be a bit too
> big to do the job (MJPEG is a small subset of all possible JPEG formats),
> but it's the easiest to use for prototyping.

Why don't used the library from uvcview in utils.c 
int jpeg_decode(unsigned char **pic, unsigned char *buf, int *width,
		int *height);
If you need i can patch this function to accept jpeg data without huffman 
table  :)
> > I'll look Qt. For now, i only do conversion for the YVY2 format.
>
> The Qt patch I wrote modifies the Qt JPEG codec which uses libjpeg, so you
> will be able to reuse the code in Gnomemeeting. Be careful about licensing
> issues though. pwlib is licensed under the Mozilla Public License 1.1 and
> Qt under the GNU Public License. You can reuse my code in pwlib (I grant
> you the right to use it under the MPL), but not Qt code.
>
> > > Why did you need to modify the driver ?
> >
> > To support ENUM_STD. Only to not return -EINVAL. But it failed somewhere
> > after that ... This is why i don't send the patch. Here the patch use:
>
> Mmmmm... Shouldn't mplayer be fixed instead ? V4L2 v0.8 doesn't make it
> mandatory to support ENUM_STD:
>
> (1.7. Video Standards)
>
> "Here the driver shall set the std ?eld of struct v4l2_input and struct
> v4l2_output to zero, the VIDIOC_G_STD, VIDIOC_S_STD, VIDIOC_QUERYSTD and
> VIDIOC_ENUMSTD ioctls shall return the EINVAL error code."
>
> Laurent Pinchart
-- 
Michel Xhaard
http://mxhaard.free.fr


From mxhaard at magic.fr  Mon Jan  9 19:43:15 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Mon, 9 Jan 2006 19:43:15 +0100
Subject: [Linux-uvc-devel] test rev:8 smp box :)
Message-ID: <200601091943.15806.mxhaard@magic.fr>

I have tested rev8 with my smp box and a fresh kernel 2.6.15 
the two box:
PIV 64 bits HT
Dual Athlon MP
 are working with all resolutions . so the ehci in 2.6.11 is broken
-- 
Michel Xhaard
http://mxhaard.free.fr


From laurent.pinchart at skynet.be  Mon Jan  9 19:48:10 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 19:48:10 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <200601091937.53145.mxhaard@magic.fr>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601091133.25540.laurent.pinchart@skynet.be> <200601091937.53145.mxhaard@magic.fr>
Message-ID: <200601091948.10734.laurent.pinchart@skynet.be>

> Why don't used the library from uvcview in utils.c
> int jpeg_decode(unsigned char **pic, unsigned char *buf, int *width,
> 		int *height);
> If you need i can patch this function to accept jpeg data without huffman
> table  :)

Because the code is GPLed. pwlib is covered by the MPL-1.1.

Laurent Pinchart


From laurent.pinchart at skynet.be  Mon Jan  9 19:49:36 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 19:49:36 +0100
Subject: [Linux-uvc-devel] test rev:8 smp box :)
In-Reply-To: <200601091943.15806.mxhaard@magic.fr>
References: <200601091943.15806.mxhaard@magic.fr>
Message-ID: <200601091949.36847.laurent.pinchart@skynet.be>

> I have tested rev8 with my smp box and a fresh kernel 2.6.15
> the two box:
> PIV 64 bits HT
> Dual Athlon MP
>  are working with all resolutions . so the ehci in 2.6.11 is broken

Great news. I'm glad the driver is not at fault :-)

Laurent Pinchart


From luc at saillard.org  Mon Jan  9 19:53:16 2006
From: luc at saillard.org (Luc Saillard)
Date: Mon, 9 Jan 2006 19:53:16 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <200601091937.53145.mxhaard@magic.fr>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <20060109101354.GN15519@sd291.sivit.org> <200601091133.25540.laurent.pinchart@skynet.be> <200601091937.53145.mxhaard@magic.fr>
Message-ID: <20060109185316.GQ15519@sd291.sivit.org>

On Mon, Jan 09, 2006 at 07:37:52PM +0100, michel Xhaard wrote:

> > You definitely need a library to decode MJPEG. libjpeg might be a bit too
> > big to do the job (MJPEG is a small subset of all possible JPEG formats),
> > but it's the easiest to use for prototyping.
> 
> Why don't used the library from uvcview in utils.c 
> int jpeg_decode(unsigned char **pic, unsigned char *buf, int *width,
> 		int *height);
> If you need i can patch this function to accept jpeg data without huffman 
> table  :)
 
Because i've not look in this file :)
I'll will try to understand your code and adapt it if necessary, later i'll
ask your permission to put the code under the MPL.

Luc


From laurent.pinchart at skynet.be  Mon Jan  9 19:57:10 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 9 Jan 2006 19:57:10 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <20060109185316.GQ15519@sd291.sivit.org>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601091937.53145.mxhaard@magic.fr> <20060109185316.GQ15519@sd291.sivit.org>
Message-ID: <200601091957.10712.laurent.pinchart@skynet.be>

> > Why don't used the library from uvcview in utils.c
> > int jpeg_decode(unsigned char **pic, unsigned char *buf, int *width,
> > 		int *height);
> > If you need i can patch this function to accept jpeg data without huffman
> > table  :)
>
> Because i've not look in this file :)
> I'll will try to understand your code and adapt it if necessary, later i'll
> ask your permission to put the code under the MPL.

If I'm not mistaken, Michel is not the original author.

Laurent Pinchart


From mxhaard at magic.fr  Mon Jan  9 20:13:37 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Mon, 9 Jan 2006 20:13:37 +0100
Subject: [Linux-uvc-devel] uvcview videograbber with preview available for testing
In-Reply-To: <20060109185316.GQ15519@sd291.sivit.org>
References: <ISSN4M$85852CC5C75F781D91B175408F0892C6@aliceadsl.fr> <200601091937.53145.mxhaard@magic.fr> <20060109185316.GQ15519@sd291.sivit.org>
Message-ID: <200601092013.37220.mxhaard@magic.fr>

Le Lundi 9 Janvier 2006 19:53, Luc Saillard a ?crit?:
> On Mon, Jan 09, 2006 at 07:37:52PM +0100, michel Xhaard wrote:
> > > You definitely need a library to decode MJPEG. libjpeg might be a bit
> > > too big to do the job (MJPEG is a small subset of all possible JPEG
> > > formats), but it's the easiest to use for prototyping.
> >
> > Why don't used the library from uvcview in utils.c
> > int jpeg_decode(unsigned char **pic, unsigned char *buf, int *width,
> > 		int *height);
> > If you need i can patch this function to accept jpeg data without huffman
> > table  :)
>
> Because i've not look in this file :)
> I'll will try to understand your code and adapt it if necessary, later i'll
> ask your permission to put the code under the MPL.
>
> Luc
Luc,
You only need to pass your output buffer to pic, your input buffer to buf 
if the jpeg data width or height in the header are different from *width and 
*height jpeg_decode realloc the pic buffer (that is why we need **pic) and of 
course change *width and *height so the caller can adjust the output windows 
on the fly.
The routine provide YUYV palette in pic 
Of course you can used it .The original code is from the bootstrap project 
adapted by Suse and by me for the UVC need  (YUYV palette) . It should be 
simple for me to patch the routine to get something shortest and able to 
decode the stream without the huffman table, if you need just tell me. 
Regards
-- 
Michel Xhaard
http://mxhaard.free.fr


From mini at nada.kth.se  Tue Jan 10 13:07:07 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Tue, 10 Jan 2006 13:07:07 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
Message-ID: <1136894828.6000.23.camel@yossarian>

Hi!

I wanted to report a partial success with my new QuickCam Fusion.

Bus 002 Device 002: ID 046d:08c1 Logitech, Inc.

I'm running Debian unstable, using kernel 2.6.15. 

Compilation works, the module is however installed
in /lib/modules/2.6.15 and not /lib/modules/2.6.15-1-686 as it should,
and it seems to be because Debian stores the EXTRAVERSION in
$KSRC/.extraversion, and I don't really know a general way around it...

Anyway, trying the test program I get

Device /dev/video0 opened: .
Unable to set format: 22.

(22 is invalid argument)

Trying instead using

        fmt.fmt.pix.width = 640;
        fmt.fmt.pix.height = 480;
        fmt.fmt.pix.pixelformat = V4L2_PIX_FMT_MJPEG;

it seems to work: it creates a number of files that "file *" tells me
are JPEG files, but I cannot view them using regular image tools. Tips
for checking them?

I have not gotten xawtv or tvtime to work (xawtv does not like my Xorg
server: XF86DGANoDirectVideoMode, and tvtime complains about not having
studio quality capture). Other tips on applications I should try?

It seems some of my problems might be related to the fact that this
laptop only has USB 1... 

Thanks for the driver, and please let me know if there is something I
could help debug...

/Mikael
-- 
Plus ?a change, plus c'est la m?me chose



From mini at nada.kth.se  Tue Jan 10 13:19:18 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Tue, 10 Jan 2006 13:19:18 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
In-Reply-To: <1136894828.6000.23.camel@yossarian>
References: <1136894828.6000.23.camel@yossarian>
Message-ID: <1136895559.6000.27.camel@yossarian>

tis 2006-01-10 klockan 13:07 +0100 skrev Mikael Nilsson:
> Hi!
> 
> I wanted to report a partial success with my new QuickCam Fusion.
> 
> Bus 002 Device 002: ID 046d:08c1 Logitech, Inc.
> 
> I'm running Debian unstable, using kernel 2.6.15. 
> 
> Compilation works, the module is however installed
> in /lib/modules/2.6.15 and not /lib/modules/2.6.15-1-686 as it should,
> and it seems to be because Debian stores the EXTRAVERSION in
> $KSRC/.extraversion, and I don't really know a general way around it...

See:

http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=345918

(short version: will probably be fixed in Debian soon)

Quick fix for debian users:

cd /usr/src/linux-headers-2.6.15-1-686   # or wherever...
cp .extraversion localversion

Done!

/Mikael
-- 
Plus ?a change, plus c'est la m?me chose



From libor.klepac at bcom.cz  Tue Jan 10 13:30:54 2006
From: libor.klepac at bcom.cz (Libor =?iso-8859-2?q?Klep=E1=E8?=)
Date: Tue, 10 Jan 2006 13:30:54 +0100
Subject: [Linux-uvc-devel] logitech quickcam 046d:092c
Message-ID: <200601101330.58580.libor.klepac@bcom.cz>

hello,
i have logitech quickcam chat, is it uvc device?
I attached output of lsusb.

i tried (naivelly) to add

       /* Logitech Quickcam Chat */
        { .match_flags          = USB_DEVICE_ID_MATCH_DEVICE
                                | USB_DEVICE_ID_MATCH_INT_INFO,
          .idVendor             = 0x046d,
          .idProduct            = 0x092c,
          .bInterfaceClass      = USB_CLASS_VENDOR_SPEC,
          .bInterfaceSubClass   = 0,
          .bInterfaceProtocol   = 0 },

to list of ids, it finds camera (when .bInterfaceSubClass is 1, it doesn't 
load uvcvideo module on device connection) but dmesg contains

usb 3-1: new full speed USB device using uhci_hcd and address 18
usbvideo: Probing device 1
usbvideo: Found UVC device (0.00)
usbvideo: No valid video chain found.
usbvideo: UVC device initialized.
usbcore: registered new driver usbvideo


can i help somehow? (i'm not kernel hacker ;)

cu

libor
-------------- next part --------------

Bus 003 Device 018: ID 046d:092c Logitech, Inc. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass          255 Vendor Specific Class
  bDeviceSubClass       255 Vendor Specific Subclass
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x046d Logitech, Inc.
  idProduct          0x092c 
  bcdDevice            0.00
  iManufacturer           1         
  iProduct                2 Camera
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          233
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0000  1x 0 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0370  1x 880 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0280  1x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0300  1x 768 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0380  1x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03ff  1x 1023 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       8
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0220  1x 544 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       9
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0290  1x 656 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting      10
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x02c0  1x 704 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting      11
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0360  1x 864 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting      12
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x03c0  1x 960 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting      13
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0 
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x034d  1x 845 bytes
        bInterval               1
Device Status:     0x0000
  (Bus Powered)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060110/0f541073/attachment.pgp>

From laurent.pinchart at skynet.be  Tue Jan 10 15:12:51 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 10 Jan 2006 15:12:51 +0100
Subject: [Linux-uvc-devel] logitech quickcam 046d:092c
In-Reply-To: <200601101330.58580.libor.klepac@bcom.cz>
References: <200601101330.58580.libor.klepac@bcom.cz>
Message-ID: <200601101512.52088.laurent.pinchart@skynet.be>

Hi Libor,

> i have logitech quickcam chat, is it uvc device?

No, the device is not UVC compliant. You need the spca5xx driver available at 
http://mxhaard.free.fr/spca5xx.html

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue Jan 10 15:26:01 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 10 Jan 2006 15:26:01 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
In-Reply-To: <1136894828.6000.23.camel@yossarian>
References: <1136894828.6000.23.camel@yossarian>
Message-ID: <200601101526.01677.laurent.pinchart@skynet.be>

Hi Mikael,

> I wanted to report a partial success with my new QuickCam Fusion.
[...]
> Anyway, trying the test program I get
>
> Device /dev/video0 opened: .
> Unable to set format: 22.

As you mention later, your laptop doesn't support USB 2.0, so uncompressed 
image formats are not available (YUYV). You must instead use the MJPEG 
format, as you found out by yourself.

> Trying instead using
>
>         fmt.fmt.pix.width = 640;
>         fmt.fmt.pix.height = 480;
>         fmt.fmt.pix.pixelformat = V4L2_PIX_FMT_MJPEG;
>
> it seems to work: it creates a number of files that "file *" tells me
> are JPEG files, but I cannot view them using regular image tools. Tips
> for checking them?

The MJPEG files contains standard JPEG data without the Huffman tables, so you 
won't be able to open them in your regular image tools. I posted a patch to 
the video4linux mailing list some time ago to add MJPEG support to Qt (so 
most Qt/KDE based applications will be able to open MJPEG images).

I will create a simple script to add the Huffman tables to an MJPEG image. 
Should I write it in C or in Python ?

> I have not gotten xawtv or tvtime to work (xawtv does not like my Xorg
> server: XF86DGANoDirectVideoMode, and tvtime complains about not having
> studio quality capture). Other tips on applications I should try?

tvtime should work with the patch I posted on the linux-uvc mailing list. Try 
with PAL if NTSC doesn't work (the video standard is irrelevant, but tvtime 
will use another resolution with PAL).

Laurent Pinchart



From libor.klepac at bcom.cz  Tue Jan 10 15:38:04 2006
From: libor.klepac at bcom.cz (Libor =?utf-8?q?Klep=C3=A1=C4=8D?=)
Date: Tue, 10 Jan 2006 15:38:04 +0100
Subject: [Linux-uvc-devel] logitech quickcam 046d:092c
In-Reply-To: <200601101512.52088.laurent.pinchart@skynet.be>
References: <200601101330.58580.libor.klepac@bcom.cz> <200601101512.52088.laurent.pinchart@skynet.be>
Message-ID: <200601101538.07790.libor.klepac@bcom.cz>

Dne ?ter? 10 leden 2006 15:12 Laurent Pinchart napsal(a):
> Hi Libor,
>
> > i have logitech quickcam chat, is it uvc device?
>
> No, the device is not UVC compliant. You need the spca5xx driver available
it' a pity ;) i thought that all usb2 cameras will be uvc compliant (well 
manufactuer says it's usb2 device, when i connect it, it has only 12Mbits 
speed (port is ok, when i plug usb disk, it reports as usb2 device and has 
480Mbits speed))

> at http://mxhaard.free.fr/spca5xx.html
yes i know about this driver, i use it now, but image is not ... great , but 
is getting better in last release ;)

thanks for info

cu

libor

>
> Laurent Pinchart
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060110/b7a3e687/attachment.pgp>

From mini at nada.kth.se  Tue Jan 10 17:21:08 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Tue, 10 Jan 2006 17:21:08 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
In-Reply-To: <200601101526.01677.laurent.pinchart@skynet.be>
References: <1136894828.6000.23.camel@yossarian>
	 <200601101526.01677.laurent.pinchart@skynet.be>
Message-ID: <1136910069.13027.22.camel@yossarian>

tis 2006-01-10 klockan 15:26 +0100 skrev Laurent Pinchart:
> The MJPEG files contains standard JPEG data without the Huffman tables, so you 
> won't be able to open them in your regular image tools. I posted a patch to 
> the video4linux mailing list some time ago to add MJPEG support to Qt (so 
> most Qt/KDE based applications will be able to open MJPEG images).
> 
> I will create a simple script to add the Huffman tables to an MJPEG image. 
> Should I write it in C or in Python ?

I'd prefer interpreted, so python would suit me...

> 
> > I have not gotten xawtv or tvtime to work (xawtv does not like my Xorg
> > server: XF86DGANoDirectVideoMode, and tvtime complains about not having
> > studio quality capture). Other tips on applications I should try?
> 
> tvtime should work with the patch I posted on the linux-uvc mailing list. Try 
> with PAL if NTSC doesn't work (the video standard is irrelevant, but tvtime 
> will use another resolution with PAL).

Will try again. It seems xawtv wants DGA, which is disabled in newer
nvidia drivers. with -nodga it at least launches, but I get 

ioctl: VIDIOC_G_STD(std=0x2a00060b7c58414 [PAL_G,PAL_I,PAL_Nc,?,SECAM_B,SECAM_G,SECAM_L,?ATSC_8_VSB,ATSC_16_VSB,(null),(null),(null),(null),(null),(null),(null),(null),(null),(null)]): Ogiltigt argument
ioctl: VIDIOC_S_STD(std=0x0 []): Ogiltigt argument
no way to get: 384x288 32 bit TrueColor (LE: bgr-)
no way to get: 384x288 24 bit TrueColor (BE: rgb)

Ogiltigt argument = Illegal argument.

and I get no pic whatever I try. It that again because of the USB1
situation? Can I tell xawtv to use MJPEG somehow?

/Mikael

-- 
Plus ?a change, plus c'est la m?me chose



From luc at saillard.org  Tue Jan 10 17:52:08 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 10 Jan 2006 17:52:08 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
In-Reply-To: <1136910069.13027.22.camel@yossarian>
References: <1136894828.6000.23.camel@yossarian> <200601101526.01677.laurent.pinchart@skynet.be> <1136910069.13027.22.camel@yossarian>
Message-ID: <20060110165208.GA22818@sd291.sivit.org>

On Tue, Jan 10, 2006 at 05:21:08PM +0100, Mikael Nilsson wrote:
> 
> I'd prefer interpreted, so python would suit me...
> 
I've removed some code from my project that extract Jpeg image from an Avi
file. Feel free to adapt it. The code is in attachement and written in
python. Just parse the jpeg chunck and if we didn't found the Huffman table,
add it when writting the file.

Luc
-------------- next part --------------
A non-text attachment was scrubbed...
Name: AVI.py
Type: text/x-python
Size: 4022 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060110/77402bd8/attachment.py>

From mini at nada.kth.se  Tue Jan 10 18:23:05 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Tue, 10 Jan 2006 18:23:05 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
In-Reply-To: <20060110165208.GA22818@sd291.sivit.org>
References: <1136894828.6000.23.camel@yossarian>
	 <200601101526.01677.laurent.pinchart@skynet.be>
	 <1136910069.13027.22.camel@yossarian>
	 <20060110165208.GA22818@sd291.sivit.org>
Message-ID: <1136913785.15961.2.camel@yossarian>

Thanks!

With this program, I was able to confirm that my camera takes nice
pictures of me!

/Mikael

tis 2006-01-10 klockan 17:52 +0100 skrev Luc Saillard: 
> On Tue, Jan 10, 2006 at 05:21:08PM +0100, Mikael Nilsson wrote:
> > 
> > I'd prefer interpreted, so python would suit me...
> > 
> I've removed some code from my project that extract Jpeg image from an Avi
> file. Feel free to adapt it. The code is in attachement and written in
> python. Just parse the jpeg chunck and if we didn't found the Huffman table,
> add it when writting the file.
> 
> Luc
-- 
Plus ?a change, plus c'est la m?me chose



From laurent.pinchart at skynet.be  Tue Jan 10 23:40:00 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 10 Jan 2006 23:40:00 +0100
Subject: [Linux-uvc-devel] Partial succes with Logitech QC Fusion
In-Reply-To: <20060110165208.GA22818@sd291.sivit.org>
References: <1136894828.6000.23.camel@yossarian> <1136910069.13027.22.camel@yossarian> <20060110165208.GA22818@sd291.sivit.org>
Message-ID: <200601102340.01028.laurent.pinchart@skynet.be>

Hi Luc,

> I've removed some code from my project that extract Jpeg image from an Avi
> file. Feel free to adapt it. The code is in attachement and written in
> python. Just parse the jpeg chunck and if we didn't found the Huffman
> table, add it when writting the file.

Thanks for the code. I renamed the file to mjpeg2jpeg.py, modified it a bit, 
and commited it to svn at  
http://svn.berlios.de/svnroot/repos/linux-uvc/uvc-utils/trunk

Laurent Pinchart


From Olivier.Bornet at idiap.ch  Wed Jan 11 10:51:26 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Wed, 11 Jan 2006 10:51:26 +0100
Subject: [Linux-uvc-devel] [PATCH] fix mjpeg2jpeg.py when input file is already a jpeg file
Message-ID: <20060111095126.GB16081@idiap.ch>

Hello,

the attached patch fix mjpeg2jpeg.py to prevent file corruption when the
input file has already the huffman table.

Have a nice day.

        Olivier
-- 
Olivier Bornet, IDIAP, CP 592, CH-1920 Martigny
http://www.idiap.ch/~bornet/
http://www.idiap.ch/~bornet/pgp/
PGP-key: 0xC53D9218
-------------- next part --------------
Index: mjpeg2jpeg.py
===================================================================
--- mjpeg2jpeg.py	(revision 10)
+++ mjpeg2jpeg.py	(working copy)
@@ -80,9 +80,12 @@
 
     if not has_dht:
         outstream.write(huffman_table)
+        # write the previous readed header
+        outstream.write(hdr)
 
-    outstream.write(hdr)
+    # read and write the remaining of the file
     outstream.write(instream.read())
+    
     return True
 
 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060111/d7f87871/attachment.pgp>

From laurent.pinchart at skynet.be  Wed Jan 11 15:17:55 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 11 Jan 2006 15:17:55 +0100
Subject: [Linux-uvc-devel] [PATCH] fix mjpeg2jpeg.py when input file is already a jpeg file
In-Reply-To: <20060111095126.GB16081@idiap.ch>
References: <20060111095126.GB16081@idiap.ch>
Message-ID: <200601111517.55916.laurent.pinchart@skynet.be>

> the attached patch fix mjpeg2jpeg.py to prevent file corruption when the
> input file has already the huffman table.

Thanks. Applied.

Laurent Pinchart



From jwspring at comcast.net  Thu Jan 12 05:27:27 2006
From: jwspring at comcast.net (James W. Spring)
Date: Wed, 11 Jan 2006 20:27:27 -0800
Subject: [Linux-uvc-devel] Ccapture frame issue
Message-ID: <43C5DAAF.6050408@comcast.net>

I'm not able to understand what I can` do to with this error
I have the latest version of your driver
The test code does run and capture frames correctly.

kernel 2.6.14-1.1653_FC4 on a labtop with integrated video

Running tvtime 1.0.1.
Reading configuration from /etc/tvtime/tvtime.xml
Reading configuration from /home/jwspring/.tvtime/tvtime.xml
videoinput: Driver won't tell us its norm: Invalid argument
videoinput: Can't get tuner info: Invalid argument

   Your capture card driver: usbvideo [/0000:00:1d.7/256]
   does not support full size studio-quality images required by tvtime.
   This is true for many low-quality webcams.  Please select a
   different video device for tvtime to use with the command line
   option --device.

James


From laurent.pinchart at skynet.be  Thu Jan 12 10:07:09 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 12 Jan 2006 10:07:09 +0100
Subject: [Linux-uvc-devel] Ccapture frame issue
In-Reply-To: <43C5DAAF.6050408@comcast.net>
References: <43C5DAAF.6050408@comcast.net>
Message-ID: <200601121007.09130.laurent.pinchart@skynet.be>

> I'm not able to understand what I can` do to with this error
> I have the latest version of your driver
> The test code does run and capture frames correctly.
>
> kernel 2.6.14-1.1653_FC4 on a labtop with integrated video
>
> Running tvtime 1.0.1.
> Reading configuration from /etc/tvtime/tvtime.xml
> Reading configuration from /home/jwspring/.tvtime/tvtime.xml
> videoinput: Driver won't tell us its norm: Invalid argument
> videoinput: Can't get tuner info: Invalid argument
>
>    Your capture card driver: usbvideo [/0000:00:1d.7/256]
>    does not support full size studio-quality images required by tvtime.
>    This is true for many low-quality webcams.  Please select a
>    different video device for tvtime to use with the command line
>    option --device.

Try to set the video standard to PAL (right-click on the tvtime window, select 
'Input configuration' and 'Television standard'). Please let me know if it 
helps.

Laurent Pinchart


From jwspring at comcast.net  Fri Jan 13 02:01:44 2006
From: jwspring at comcast.net (James W. Spring)
Date: Thu, 12 Jan 2006 17:01:44 -0800
Subject: [Linux-uvc-devel] Capture frame issus
Message-ID: <43C6FBF8.1040202@comcast.net>

After starting tvtime --norm=NORM
It starts sucessfully
I then change to PAL and restart.
It can see the camers for a second then it aborts.

Restarting tvtime.
Reading configuration from /etc/tvtime/tvtime.xml
Reading configuration from /home/jwspring/.tvtime/tvtime.xml
videoinput: Driver won't tell us its norm: Invalid argument
videoinput: Can't get tuner info: Invalid argument
videoinput: Driver won't tell us its norm: Invalid argument
videoinput: Can't get tuner info: Invalid argument

    Cannot allocate enough off-screen video memory.  This may be fixed by:

      1. Closing or restarting large X applications.
      2. Lowering the input width of tvtime (--inputwidth parameter).
      3. Lowering your colour depth or highest configured resolution.
      4. Increasing the amount of video memory in your X config file
         (for example, if you are using the i810 XFree86 driver.)

    See http://tvtime.net/ for more information.

videoinput: Can't read frame. Error was: Invalid argument (0).
videoinput: Can't read frame. Error was: Invalid argument (0).
videoinput: Can't read frame. Error was: Invalid argument (0).
videoinput: Can't read frame. Error was: Invalid argument (0).

    Cannot allocate enough off-screen video memory.  This may be fixed by:

      1. Closing or restarting large X applications.
      2. Lowering the input width of tvtime (--inputwidth parameter).
      3. Lowering your colour depth or highest configured resolution.
      4. Increasing the amount of video memory in your X config file
         (for example, if you are using the i810 XFree86 driver.)

    See http://tvtime.net/ for more information.

Thank you for using tvtime.



From jwspring at comcast.net  Fri Jan 13 04:03:32 2006
From: jwspring at comcast.net (James W. Spring)
Date: Thu, 12 Jan 2006 19:03:32 -0800
Subject: [Linux-uvc-devel] Capture frame issus
In-Reply-To: <43C6FBF8.1040202@comcast.net>
References: <43C6FBF8.1040202@comcast.net>
Message-ID: <43C71884.6020004@comcast.net>

Update
The driver works correctly wen I run the current
uvcview.

James W. Spring wrote:

> After starting tvtime --norm=NORM
> It starts sucessfully
> I then change to PAL and restart.
> It can see the camers for a second then it aborts.
>
> Restarting tvtime.
> Reading configuration from /etc/tvtime/tvtime.xml
> Reading configuration from /home/jwspring/.tvtime/tvtime.xml
> videoinput: Driver won't tell us its norm: Invalid argument
> videoinput: Can't get tuner info: Invalid argument
> videoinput: Driver won't tell us its norm: Invalid argument
> videoinput: Can't get tuner info: Invalid argument
>
>    Cannot allocate enough off-screen video memory.  This may be fixed by:
>
>      1. Closing or restarting large X applications.
>      2. Lowering the input width of tvtime (--inputwidth parameter).
>      3. Lowering your colour depth or highest configured resolution.
>      4. Increasing the amount of video memory in your X config file
>         (for example, if you are using the i810 XFree86 driver.)
>
>    See http://tvtime.net/ for more information.
>
> videoinput: Can't read frame. Error was: Invalid argument (0).
> videoinput: Can't read frame. Error was: Invalid argument (0).
> videoinput: Can't read frame. Error was: Invalid argument (0).
> videoinput: Can't read frame. Error was: Invalid argument (0).
>
>    Cannot allocate enough off-screen video memory.  This may be fixed by:
>
>      1. Closing or restarting large X applications.
>      2. Lowering the input width of tvtime (--inputwidth parameter).
>      3. Lowering your colour depth or highest configured resolution.
>      4. Increasing the amount of video memory in your X config file
>         (for example, if you are using the i810 XFree86 driver.)
>
>    See http://tvtime.net/ for more information.
>
> Thank you for using tvtime.
>
>



From Patrick.Debois at sos.be  Fri Jan 13 12:35:38 2006
From: Patrick.Debois at sos.be (Patrick Debois)
Date: Fri, 13 Jan 2006 12:35:38 +0100
Subject: [Linux-uvc-devel] Other V4l2 viewer/streamer software
Message-ID: <43C7908A.3060703@sos.be>

This might be worth checking, it has some v4l2 viewer, streamer and 
other soft.

http://www.linux-projects.org/modules/mydownloads/


From jwspring at comcast.net  Mon Jan 16 16:31:04 2006
From: jwspring at comcast.net (James Spring)
Date: Mon, 16 Jan 2006 15:31:04 +0000
Subject: [Linux-uvc-devel] Working webcam using tvtime
Message-ID: <011620061531.29655.43CBBC38000C367C000073D722007623020902079D9F9C9906@comcast.net>

I have successfully used tvtime to view images from my webcam.
I was never able to do it while using the Fedora 4 2.6.14_1653 kernel.
I obtained a current kernel from kernel.org version 2.6.15. Customized it
for my hardware. I then recompiled tvtime, with your patch, and the
usbvideo drivers. 

The webcam images are now passed to tvime with only some problems
around the tv standard. Using pal works where ntsc does not. I have
only tried brightness, contrast settings so far, and they have worked.

James

--
James Spring


From marc at mdumontier.com  Mon Jan 16 22:31:23 2006
From: marc at mdumontier.com (Marc Dumontier)
Date: Mon, 16 Jan 2006 16:31:23 -0500
Subject: [Linux-uvc-devel] how to use driver?
Message-ID: <43CC10AB.6070206@mdumontier.com>

Hi,

I was trying to see if my webcam would work with this driver (it's a 
quickcam for notebook deluxe)

Bus 004 Device 001: ID 0000:0000
Bus 003 Device 004: ID 046d:08a9 Logitech, Inc.
Bus 003 Device 001: ID 0000:0000
Bus 002 Device 001: ID 0000:0000
Bus 001 Device 001: ID 0000:0000


I loaded up the driver,

dmesg output:

usbcore: registered new driver usbvideo
USB Video Class driver (v0.1.0)
usb 3-2: new full speed USB device using uhci_hcd and address 4
usb 3-2: USB disconnect, address 4
usb 3-2: new full speed USB device using uhci_hcd and address 5


I don't have a /dev/video* file or anything

where do i go from here to see if my camera works?

thanks,
Marc



From mxhaard at magic.fr  Mon Jan 16 22:51:47 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Mon, 16 Jan 2006 22:51:47 +0100
Subject: [Linux-uvc-devel] how to use driver?
In-Reply-To: <43CC10AB.6070206@mdumontier.com>
References: <43CC10AB.6070206@mdumontier.com>
Message-ID: <200601162251.47397.mxhaard@magic.fr>

Le Lundi 16 Janvier 2006 22:31, Marc Dumontier a ?crit?:
> Hi,
>
> I was trying to see if my webcam would work with this driver (it's a
> quickcam for notebook deluxe)
>
> Bus 004 Device 001: ID 0000:0000
> Bus 003 Device 004: ID 046d:08a9 Logitech, Inc.
> Bus 003 Device 001: ID 0000:0000
> Bus 002 Device 001: ID 0000:0000
> Bus 001 Device 001: ID 0000:0000
>
>
> I loaded up the driver,
>
> dmesg output:
>
> usbcore: registered new driver usbvideo
> USB Video Class driver (v0.1.0)
> usb 3-2: new full speed USB device using uhci_hcd and address 4
> usb 3-2: USB disconnect, address 4
> usb 3-2: new full speed USB device using uhci_hcd and address 5
>
>
> I don't have a /dev/video* file or anything
>
> where do i go from here to see if my camera works?
>
> thanks,
> Marc
Marc,
Your webcam is supported by the spca5xx driver 
Your chipset vimicro zc0302 sensor  Hv7131from Hynix is not UVC compliant.
look here
http://mxhaard.free.fr/spca5xx.html
regards
-- 
Michel Xhaard
http://mxhaard.free.fr


From ynutcase-uvc at yahoo.com  Tue Jan 17 02:35:14 2006
From: ynutcase-uvc at yahoo.com (ynutcase-uvc at yahoo.com)
Date: Mon, 16 Jan 2006 17:35:14 -0800 (PST)
Subject: [Linux-uvc-devel] MythTV / MythPhone UVC patch
Message-ID: <20060117013514.35054.qmail@web36210.mail.mud.yahoo.com>

Hi all,

Please find attached a patch to MythTV / MythPhone to
support MJPEG and UVC.  This patch should apply
cleanly against Myth SVN version 8626.

Some outstanding problems / concerns with this patch:

1) The webcam does not turn off when exiting out of
mythphone. This seems to be a problem with the
VIDIOC_STREAMOFF ioctl() and/or the munmap() functions
of the uvc driver...

2) There's a complete lack of testing for other camera
types besides the Logitech Quickcam Fusion.

Other than that, I'm really happy with how it works. 
:)

Hopefully I can get more people playing with this
patch, and sending me feedback / code.

UVC folks:  I would appreciate it if you could add
this patch to your collection.  Hopefully soon, I'll
be submitting it to the mythtv folks.  I want to wait
until my problems shutting down the webcam are solved
first...

Take care,
-- Nick
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 2006-01-16.uvc.mythphone.patch
Type: text/x-patch
Size: 29292 bytes
Desc: 31746757-2006-01-16.uvc.mythphone.patch
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060116/3002c3c5/attachment.bin>

From scoutts at bcs.org.uk  Thu Jan 19 14:50:50 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Thu, 19 Jan 2006 13:50:50 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
Message-ID: <200601191350.50916.scoutts@bcs.org.uk>

Hello,

Is the driver usable with a Quickcam Pro 5000 yet?

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>


From scoutts at bcs.org.uk  Thu Jan 19 16:36:59 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Thu, 19 Jan 2006 15:36:59 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601191350.50916.scoutts@bcs.org.uk>
References: <200601191350.50916.scoutts@bcs.org.uk>
Message-ID: <200601191537.01832.scoutts@bcs.org.uk>

On Thursday 19 January 2006 13:50, Steven Coutts wrote:
> Hello,
>
> Is the driver usable with a Quickcam Pro 5000 yet?
>
> Regards


Ok, compiled the software and loaded the kernel module, everything seems to be 
recognised -:

usb 1-6: USB disconnect, address 5
usb 1-1: new high speed USB device using ehci_hcd and address 6
usbvideo: Probing device 1
Format MJPEG found
Format Uncompressed found
usbvideo: Found a Status endpoint (addr 87).
usbvideo: Found UVC device (1.00)
usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
usbvideo: Found a valid video chain (1 -> 5).
usbvideo: UVC device initialized.

However, uvcview doesn't work -:
uvcview verion 0.1.3
Video driver: x11
A window manager is available
video /dev/video0
Unable to set format: 5.
 Init v4L2 failed !! exit fatal


Any ideas?


-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060119/f59d62cd/attachment.pgp>

From scoutts at bcs.org.uk  Thu Jan 19 16:45:09 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Thu, 19 Jan 2006 15:45:09 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601191537.01832.scoutts@bcs.org.uk>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191537.01832.scoutts@bcs.org.uk>
Message-ID: <200601191545.11412.scoutts@bcs.org.uk>

On Thursday 19 January 2006 15:36, Steven Coutts wrote:
> Ok, compiled the software and loaded the kernel module, everything seems to
> be recognised -:
>
> usb 1-6: USB disconnect, address 5
> usb 1-1: new high speed USB device using ehci_hcd and address 6
> usbvideo: Probing device 1
> Format MJPEG found
> Format Uncompressed found
> usbvideo: Found a Status endpoint (addr 87).
> usbvideo: Found UVC device (1.00)
> usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
> usbvideo: Found a valid video chain (1 -> 5).
> usbvideo: UVC device initialized.
>
> However, uvcview doesn't work -:
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 5.
>  Init v4L2 failed !! exit fatal
>
>
> Any ideas?

If I unplug the device then plug back in and try again I get a black video 
windows breifly then it fails -:

uvcview verion 0.1.3
Video driver: x11
A window manager is available
video /dev/video0
X Error of failed request:  BadMatch (invalid parameter attributes)
  Major opcode of failed request:  141 (XVideo)
  Minor opcode of failed request:  19 ()
  Serial number of failed request:  23
  Current serial number in output stream:  24

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060119/3776b631/attachment.pgp>

From mirak63 at wanadoo.fr  Thu Jan 19 21:54:17 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Thu, 19 Jan 2006 21:54:17 +0100
Subject: [Linux-uvc-devel] hello
Message-ID: <43CFFC79.5090302@wanadoo.fr>

how to subscribe ?



From szo at ies.hu  Thu Jan 19 23:38:15 2006
From: szo at ies.hu (SZOKOVACS Robert)
Date: Thu, 19 Jan 2006 23:38:15 +0100
Subject: [Linux-uvc-devel] uvcview?
Message-ID: <200601192338.15918.szo@ies.hu>

Hi all,

can anyone tell me where can I find this uvcview thing everyone keeps 
mentioning? google only pointed me to a microsoft program, I guess this 
must be something else...

TIA

br

Szo



From mxhaard at magic.fr  Thu Jan 19 23:46:08 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Thu, 19 Jan 2006 23:46:08 +0100
Subject: [Linux-uvc-devel] uvcview?
In-Reply-To: <200601192338.15918.szo@ies.hu>
References: <200601192338.15918.szo@ies.hu>
Message-ID: <200601192346.08544.mxhaard@magic.fr>

Le Jeudi 19 Janvier 2006 23:38, SZOKOVACS Robert a ?crit?:
> Hi all,
>
> can anyone tell me where can I find this uvcview thing everyone keeps
> mentioning? google only pointed me to a microsoft program, I guess this
> must be something else...
>
> TIA
>
> br
>
> Szo
>
> _______________________________________________
Robert,
Yes on my website,  sorry for the name i did not know M$ use the same :)
http://mxhaard.free.fr/spca50x/Investigation/uvc/
regards
-- 
Michel Xhaard
http://mxhaard.free.fr


From mirak63 at wanadoo.fr  Fri Jan 20 13:33:00 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 13:33:00 +0100
Subject: [Linux-uvc-devel] uvcvideo module install in wrong folder.
Message-ID: <43D0D87C.9070200@wanadoo.fr>

So the problem is that the module is installed in
/lib/modules/2.6.12/usb/media/
instead of
/lib/modules/2.6.12-10-k7/kernel/drivers/usb/media/

The Makefile is below just before there is a make plus a make install.


root at mirak:/usr/src/uvc/linux-uvc/linux-uvc/trunk# LANG=en make
Building USB Video Class driver...
(cd /lib/modules/2.6.12-10-k7/build && make -C 
/lib/modules/2.6.12-10-k7/build 
SUBDIRS=/usr/src/uvc/linux-uvc/linux-uvc/trunk modules)
make[1]: Entering directory `/usr/src/linux-headers-2.6.12-10-k7'
  CC [M]  /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.o
  Building modules, stage 2.
  MODPOST
  CC      /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.mod.o
  LD [M]  /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.ko
make[1]: Leaving directory `/usr/src/linux-headers-2.6.12-10-k7'




root at mirak:/usr/src/uvc/linux-uvc/linux-uvc/trunk# LANG=en make install
Installing USB Video Class driver...
(cd /lib/modules/2.6.12-10-k7/build && make -C 
/lib/modules/2.6.12-10-k7/build 
SUBDIRS=/usr/src/uvc/linux-uvc/linux-uvc/trunk INSTALL_MOD_DIR=usb/media 
modules_install)
make[1]: Entering directory `/usr/src/linux-headers-2.6.12-10-k7'
  INSTALL /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.ko
make[1]: Leaving directory `/usr/src/linux-headers-2.6.12-10-k7'
depmod -ae





root at mirak:/usr/src/uvc/linux-uvc/linux-uvc/trunk# cat Makefile
KERNEL_VERSION  := `uname -r`
KERNEL_DIR      := /lib/modules/$(KERNEL_VERSION)/build
INSTALL_MOD_DIR := usb/media

PWD             := $(shell pwd)

obj-m           := uvcvideo.o

%.o : %.c
        gcc $(TEST_CFLAGS) -c -o $@ $<

all: uvcvideo

uvcvideo:
        @echo "Building USB Video Class driver..."
        @echo "(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) 
modules)"
        @(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) modules)

install:
        @echo "Installing USB Video Class driver..."
        @echo "(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) 
INSTALL_MOD_DIR=$(INSTALL_MOD_DIR) modules_install)"
        @(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) 
INSTALL_MOD_DIR=$(INSTALL_MOD_DIR) modules_install)
        depmod -ae

clean:
        -rm -f *.o *.ko .*.cmd .*.flags *.mod.c
        -rm -rf .tmp_versions



From Olivier.Bornet at idiap.ch  Fri Jan 20 13:53:39 2006
From: Olivier.Bornet at idiap.ch (Olivier Bornet)
Date: Fri, 20 Jan 2006 13:53:39 +0100
Subject: [Linux-uvc-devel] uvcvideo module install in wrong folder.
In-Reply-To: <43D0D87C.9070200@wanadoo.fr>
References: <43D0D87C.9070200@wanadoo.fr>
Message-ID: <20060120125339.GK14113@idiap.ch>

Hello,

On Fri, Jan 20, 2006 at 01:33:00PM +0100, mirak wrote:
> So the problem is that the module is installed in
> /lib/modules/2.6.12/usb/media/
> instead of
> /lib/modules/2.6.12-10-k7/kernel/drivers/usb/media/

already talked here. The answer of Mikael Nilsson was:

  See:

  http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=345918

  (short version: will probably be fixed in Debian soon)

  Quick fix for debian users:

  cd /usr/src/linux-headers-2.6.15-1-686   # or wherever...
  cp .extraversion localversion

HTH.

        Olivier
-- 
Olivier Bornet, IDIAP, CP 592, CH-1920 Martigny
http://www.idiap.ch/~bornet/
http://www.idiap.ch/~bornet/pgp/
PGP-key: 0xC53D9218
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060120/95b7b4d9/attachment.pgp>

From mini at nada.kth.se  Fri Jan 20 13:55:09 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Fri, 20 Jan 2006 13:55:09 +0100
Subject: [Linux-uvc-devel] uvcvideo module install in wrong folder.
In-Reply-To: <43D0D87C.9070200@wanadoo.fr>
References: <43D0D87C.9070200@wanadoo.fr>
Message-ID: <1137761709.9034.16.camel@yossarian>

fre 2006-01-20 klockan 13:33 +0100 skrev mirak:
> So the problem is that the module is installed in
> /lib/modules/2.6.12/usb/media/
> instead of
> /lib/modules/2.6.12-10-k7/kernel/drivers/usb/media/

Are you running debian? In that case:

-----------------------------------
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=345918

(short version: will probably be fixed in Debian soon)

Quick fix for debian users:

cd /usr/src/linux-headers-2.6.15-1-686   # or wherever...
cp .extraversion localversion
-----------------------------------

In short, make sure you have "-10-k7" in a file named localversion in
your kernel build dir (on debian that is linux-headers-*).

Done!

/Mikael

> 
> The Makefile is below just before there is a make plus a make install.
> 
> 
> root at mirak:/usr/src/uvc/linux-uvc/linux-uvc/trunk# LANG=en make
> Building USB Video Class driver...
> (cd /lib/modules/2.6.12-10-k7/build && make -C 
> /lib/modules/2.6.12-10-k7/build 
> SUBDIRS=/usr/src/uvc/linux-uvc/linux-uvc/trunk modules)
> make[1]: Entering directory `/usr/src/linux-headers-2.6.12-10-k7'
>   CC [M]  /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.o
>   Building modules, stage 2.
>   MODPOST
>   CC      /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.mod.o
>   LD [M]  /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.ko
> make[1]: Leaving directory `/usr/src/linux-headers-2.6.12-10-k7'
> 
> 
> 
> 
> root at mirak:/usr/src/uvc/linux-uvc/linux-uvc/trunk# LANG=en make install
> Installing USB Video Class driver...
> (cd /lib/modules/2.6.12-10-k7/build && make -C 
> /lib/modules/2.6.12-10-k7/build 
> SUBDIRS=/usr/src/uvc/linux-uvc/linux-uvc/trunk INSTALL_MOD_DIR=usb/media 
> modules_install)
> make[1]: Entering directory `/usr/src/linux-headers-2.6.12-10-k7'
>   INSTALL /usr/src/uvc/linux-uvc/linux-uvc/trunk/uvcvideo.ko
> make[1]: Leaving directory `/usr/src/linux-headers-2.6.12-10-k7'
> depmod -ae
> 
> 
> 
> 
> 
> root at mirak:/usr/src/uvc/linux-uvc/linux-uvc/trunk# cat Makefile
> KERNEL_VERSION  := `uname -r`
> KERNEL_DIR      := /lib/modules/$(KERNEL_VERSION)/build
> INSTALL_MOD_DIR := usb/media
> 
> PWD             := $(shell pwd)
> 
> obj-m           := uvcvideo.o
> 
> %.o : %.c
>         gcc $(TEST_CFLAGS) -c -o $@ $<
> 
> all: uvcvideo
> 
> uvcvideo:
>         @echo "Building USB Video Class driver..."
>         @echo "(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) 
> modules)"
>         @(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) modules)
> 
> install:
>         @echo "Installing USB Video Class driver..."
>         @echo "(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) 
> INSTALL_MOD_DIR=$(INSTALL_MOD_DIR) modules_install)"
>         @(cd $(KERNEL_DIR) && make -C $(KERNEL_DIR) SUBDIRS=$(PWD) 
> INSTALL_MOD_DIR=$(INSTALL_MOD_DIR) modules_install)
>         depmod -ae
> 
> clean:
>         -rm -f *.o *.ko .*.cmd .*.flags *.mod.c
>         -rm -rf .tmp_versions
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
-- 
Plus ?a change, plus c'est la m?me chose



From mirak63 at wanadoo.fr  Fri Jan 20 14:12:10 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 14:12:10 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
In-Reply-To: <1137761709.9034.16.camel@yossarian>
References: <43D0D87C.9070200@wanadoo.fr> <1137761709.9034.16.camel@yossarian>
Message-ID: <43D0E1AA.7050706@wanadoo.fr>

I have a problem again :)


I can load the module

[4303539.767000] usbvideo: Probing device 1.2
[4303539.767000] Format MJPEG found
[4303539.767000] usbvideo: Found a Status endpoint (addr 87).
[4303539.767000] usbvideo: Found UVC device (1.00)
[4303539.767000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 
<- Unit 2 <- IT 1
[4303539.767000] usbvideo: Found a valid video chain (1 -> 5).
[4303539.787000] usbvideo: UVC device initialized.
[4303539.787000] usbcore: registered new driver usbvideo
[4303539.787000] USB Video Class driver (v0.1.0)

I run uvcview

karim at mirak:~/Prog/src/linux-uvc/uvcview-20060107$ uvcview -d /dev/video1
uvcview verion 0.1.3
Video driver: x11
A window manager is available
video /dev/video1
Unable to start capture: 28.
Error grabbing
 Clean Up done Quit



dmesg says this :

[4304026.620000] usbvideo: uvc_v4l2_open
[4304026.620000] usbvideo: VIDIOC_QUERYCAP
[4304026.620000] usbvideo: VIDIOC_S_FMT
[4304026.620000] usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
[4304026.699000] usbvideo: VIDIOC_REQBUFS
[4304026.699000] usbvideo: VIDIOC_QUERYBUF
[4304026.699000] usbvideo: uvc_v4l2_mmap
[4304026.699000] usbvideo: VIDIOC_QUERYBUF
[4304026.699000] usbvideo: uvc_v4l2_mmap
[4304026.700000] usbvideo: VIDIOC_QUERYBUF
[4304026.700000] usbvideo: uvc_v4l2_mmap
[4304026.700000] usbvideo: VIDIOC_QUERYBUF
[4304026.700000] usbvideo: uvc_v4l2_mmap
[4304026.791000] usbvideo: VIDIOC_STREAMON
[4304026.791000] usbvideo: Failed to submit isoc URB 0 (-28).
[4304026.997000] usbvideo: > uvc_v4l2_release
[4304026.998000] usbvideo: < uvc_v4l2_release


ok I must admit I did not read all the posts yet on that board. :p



From mirak63 at wanadoo.fr  Fri Jan 20 14:21:01 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 14:21:01 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
In-Reply-To: <43D0E1AA.7050706@wanadoo.fr>
References: <43D0D87C.9070200@wanadoo.fr> <1137761709.9034.16.camel@yossarian> <43D0E1AA.7050706@wanadoo.fr>
Message-ID: <43D0E3BD.6090709@wanadoo.fr>

In fact the green led on the cam is not on.

I tried also with
$ uvcview -d /dev/video1 -f jpg -s 640x480
It fails at the same point.

One thing also is that doing
$ LANG=en cat /dev/video1
cat: /dev/video1: No such device

On /dev/video0 wich is my bttv capture card it outputs something.

mirak a ?crit :

> I have a problem again :)
>
>
> I can load the module
>
> [4303539.767000] usbvideo: Probing device 1.2
> [4303539.767000] Format MJPEG found
> [4303539.767000] usbvideo: Found a Status endpoint (addr 87).
> [4303539.767000] usbvideo: Found UVC device (1.00)
> [4303539.767000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 
> 3 <- Unit 2 <- IT 1
> [4303539.767000] usbvideo: Found a valid video chain (1 -> 5).
> [4303539.787000] usbvideo: UVC device initialized.
> [4303539.787000] usbcore: registered new driver usbvideo
> [4303539.787000] USB Video Class driver (v0.1.0)
>
> I run uvcview
>
> karim at mirak:~/Prog/src/linux-uvc/uvcview-20060107$ uvcview -d /dev/video1
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video1
> Unable to start capture: 28.
> Error grabbing
> Clean Up done Quit
>
>
>
> dmesg says this :
>
> [4304026.620000] usbvideo: uvc_v4l2_open
> [4304026.620000] usbvideo: VIDIOC_QUERYCAP
> [4304026.620000] usbvideo: VIDIOC_S_FMT
> [4304026.620000] usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
> [4304026.699000] usbvideo: VIDIOC_REQBUFS
> [4304026.699000] usbvideo: VIDIOC_QUERYBUF
> [4304026.699000] usbvideo: uvc_v4l2_mmap
> [4304026.699000] usbvideo: VIDIOC_QUERYBUF
> [4304026.699000] usbvideo: uvc_v4l2_mmap
> [4304026.700000] usbvideo: VIDIOC_QUERYBUF
> [4304026.700000] usbvideo: uvc_v4l2_mmap
> [4304026.700000] usbvideo: VIDIOC_QUERYBUF
> [4304026.700000] usbvideo: uvc_v4l2_mmap
> [4304026.791000] usbvideo: VIDIOC_STREAMON
> [4304026.791000] usbvideo: Failed to submit isoc URB 0 (-28).
> [4304026.997000] usbvideo: > uvc_v4l2_release
> [4304026.998000] usbvideo: < uvc_v4l2_release
>
>
> ok I must admit I did not read all the posts yet on that board. :p
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>




From mirak63 at wanadoo.fr  Fri Jan 20 14:28:48 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 14:28:48 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
Message-ID: <43D0E590.7070308@wanadoo.fr>

I have a problem again :)


I can load the module

[4303539.767000] usbvideo: Probing device 1.2
[4303539.767000] Format MJPEG found
[4303539.767000] usbvideo: Found a Status endpoint (addr 87).
[4303539.767000] usbvideo: Found UVC device (1.00)
[4303539.767000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 
<- Unit 2 <- IT 1
[4303539.767000] usbvideo: Found a valid video chain (1 -> 5).
[4303539.787000] usbvideo: UVC device initialized.
[4303539.787000] usbcore: registered new driver usbvideo
[4303539.787000] USB Video Class driver (v0.1.0)

I run uvcview

karim at mirak <mailto:karim at mirak>:~/Prog/src/linux-uvc/uvcview-20060107$ uvcview -d /dev/video1
uvcview verion 0.1.3
Video driver: x11
A window manager is available
video /dev/video1
Unable to start capture: 28.
Error grabbing
 Clean Up done Quit



dmesg says this :

[4304026.620000] usbvideo: uvc_v4l2_open
[4304026.620000] usbvideo: VIDIOC_QUERYCAP
[4304026.620000] usbvideo: VIDIOC_S_FMT
[4304026.620000] usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
[4304026.699000] usbvideo: VIDIOC_REQBUFS
[4304026.699000] usbvideo: VIDIOC_QUERYBUF
[4304026.699000] usbvideo: uvc_v4l2_mmap
[4304026.699000] usbvideo: VIDIOC_QUERYBUF
[4304026.699000] usbvideo: uvc_v4l2_mmap
[4304026.700000] usbvideo: VIDIOC_QUERYBUF
[4304026.700000] usbvideo: uvc_v4l2_mmap
[4304026.700000] usbvideo: VIDIOC_QUERYBUF
[4304026.700000] usbvideo: uvc_v4l2_mmap
[4304026.791000] usbvideo: VIDIOC_STREAMON
[4304026.791000] usbvideo: Failed to submit isoc URB 0 (-28).
[4304026.997000] usbvideo: > uvc_v4l2_release
[4304026.998000] usbvideo: < uvc_v4l2_release



In fact the green led on the cam is not on.

I tried also with
$ uvcview -d /dev/video1 -f jpg -s 640x480
It fails at the same point.

One thing also is that doing
$ LANG=en cat /dev/video1
cat: /dev/video1: No such device

On /dev/video0 wich is my bttv capture card it outputs something.






From mirak63 at wanadoo.fr  Fri Jan 20 15:48:55 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 15:48:55 +0100
Subject: [Linux-uvc-devel] [resolved] Error grabing frame on quickcam
 pro 5000 
In-Reply-To: <43D0E590.7070308@wanadoo.fr>
References: <43D0E590.7070308@wanadoo.fr>
Message-ID: <43D0F857.5090803@wanadoo.fr>

So, I don't know why it works but now it works.
Only thing I remember doing was to unplug and replug the camera.

:-D

I am on ubuntu breezy.


mirak a ?crit :

> I have a problem again :)
>
>
> I can load the module
>
> [4303539.767000] usbvideo: Probing device 1.2
> [4303539.767000] Format MJPEG found
> [4303539.767000] usbvideo: Found a Status endpoint (addr 87).
> [4303539.767000] usbvideo: Found UVC device (1.00)
> [4303539.767000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 
> 3 <- Unit 2 <- IT 1
> [4303539.767000] usbvideo: Found a valid video chain (1 -> 5).
> [4303539.787000] usbvideo: UVC device initialized.
> [4303539.787000] usbcore: registered new driver usbvideo
> [4303539.787000] USB Video Class driver (v0.1.0)
>
> I run uvcview
>
> karim at mirak 
> <mailto:karim at mirak>:~/Prog/src/linux-uvc/uvcview-20060107$ uvcview -d 
> /dev/video1
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video1
> Unable to start capture: 28.
> Error grabbing
> Clean Up done Quit
>
>
>
> dmesg says this :
>
> [4304026.620000] usbvideo: uvc_v4l2_open
> [4304026.620000] usbvideo: VIDIOC_QUERYCAP
> [4304026.620000] usbvideo: VIDIOC_S_FMT
> [4304026.620000] usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
> [4304026.699000] usbvideo: VIDIOC_REQBUFS
> [4304026.699000] usbvideo: VIDIOC_QUERYBUF
> [4304026.699000] usbvideo: uvc_v4l2_mmap
> [4304026.699000] usbvideo: VIDIOC_QUERYBUF
> [4304026.699000] usbvideo: uvc_v4l2_mmap
> [4304026.700000] usbvideo: VIDIOC_QUERYBUF
> [4304026.700000] usbvideo: uvc_v4l2_mmap
> [4304026.700000] usbvideo: VIDIOC_QUERYBUF
> [4304026.700000] usbvideo: uvc_v4l2_mmap
> [4304026.791000] usbvideo: VIDIOC_STREAMON
> [4304026.791000] usbvideo: Failed to submit isoc URB 0 (-28).
> [4304026.997000] usbvideo: > uvc_v4l2_release
> [4304026.998000] usbvideo: < uvc_v4l2_release
>
>
>
> In fact the green led on the cam is not on.
>
> I tried also with
> $ uvcview -d /dev/video1 -f jpg -s 640x480
> It fails at the same point.
>
> One thing also is that doing
> $ LANG=en cat /dev/video1
> cat: /dev/video1: No such device
>
> On /dev/video0 wich is my bttv capture card it outputs something.
>
>
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>




From mxhaard at magic.fr  Fri Jan 20 17:57:51 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 20 Jan 2006 17:57:51 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
In-Reply-To: <43D0E590.7070308@wanadoo.fr>
References: <43D0E590.7070308@wanadoo.fr>
Message-ID: <200601201757.51358.mxhaard@magic.fr>

Le Vendredi 20 Janvier 2006 14:28, mirak a ?crit?:
> I have a problem again :)
>
>
> I can load the module
>
> [4303539.767000] usbvideo: Probing device 1.2
> [4303539.767000] Format MJPEG found
> [4303539.767000] usbvideo: Found a Status endpoint (addr 87).
> [4303539.767000] usbvideo: Found UVC device (1.00)
> [4303539.767000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3
> <- Unit 2 <- IT 1
> [4303539.767000] usbvideo: Found a valid video chain (1 -> 5).
> [4303539.787000] usbvideo: UVC device initialized.
> [4303539.787000] usbcore: registered new driver usbvideo
> [4303539.787000] USB Video Class driver (v0.1.0)
>
> I run uvcview
>
> karim at mirak <mailto:karim at mirak>:~/Prog/src/linux-uvc/uvcview-20060107$
> uvcview -d /dev/video1 uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video1
> Unable to start capture: 28.
> Error grabbing
>  Clean Up done Quit
>
>
>
> dmesg says this :
>
> [4304026.620000] usbvideo: uvc_v4l2_open
> [4304026.620000] usbvideo: VIDIOC_QUERYCAP
> [4304026.620000] usbvideo: VIDIOC_S_FMT
> [4304026.620000] usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
> [4304026.699000] usbvideo: VIDIOC_REQBUFS
> [4304026.699000] usbvideo: VIDIOC_QUERYBUF
> [4304026.699000] usbvideo: uvc_v4l2_mmap
> [4304026.699000] usbvideo: VIDIOC_QUERYBUF
> [4304026.699000] usbvideo: uvc_v4l2_mmap
> [4304026.700000] usbvideo: VIDIOC_QUERYBUF
> [4304026.700000] usbvideo: uvc_v4l2_mmap
> [4304026.700000] usbvideo: VIDIOC_QUERYBUF
> [4304026.700000] usbvideo: uvc_v4l2_mmap
> [4304026.791000] usbvideo: VIDIOC_STREAMON
> [4304026.791000] usbvideo: Failed to submit isoc URB 0 (-28).
> [4304026.997000] usbvideo: > uvc_v4l2_release
> [4304026.998000] usbvideo: < uvc_v4l2_release
>
>
>
> In fact the green led on the cam is not on.
>
> I tried also with
> $ uvcview -d /dev/video1 -f jpg -s 640x480
> It fails at the same point.
>
> One thing also is that doing
> $ LANG=en cat /dev/video1
> cat: /dev/video1: No such device
>
> On /dev/video0 wich is my bttv capture card it outputs something.
>
>
Mirak,
Try to unplug all others usb device on the same HCD (like mouse keyboard ...) 
or remove the usb hub between your webcam and the host .
error -28 mean not enought bandwith available on the Usb Host Controller (HCD)
Regards
-- 
Michel Xhaard
http://mxhaard.free.fr


From mirak63 at wanadoo.fr  Fri Jan 20 18:16:38 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 18:16:38 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
In-Reply-To: <200601201757.51358.mxhaard@magic.fr>
References: <43D0E590.7070308@wanadoo.fr> <200601201757.51358.mxhaard@magic.fr>
Message-ID: <43D11AF6.5010805@wanadoo.fr>

michel Xhaard a ?crit :

>Le Vendredi 20 Janvier 2006 14:28, mirak a ?crit :
>  
>
>>I have a problem again :)
>>
>>
>>I can load the module
>>
>>[4303539.767000] usbvideo: Probing device 1.2
>>[4303539.767000] Format MJPEG found
>>[4303539.767000] usbvideo: Found a Status endpoint (addr 87).
>>[4303539.767000] usbvideo: Found UVC device (1.00)
>>[4303539.767000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3
>><- Unit 2 <- IT 1
>>[4303539.767000] usbvideo: Found a valid video chain (1 -> 5).
>>[4303539.787000] usbvideo: UVC device initialized.
>>[4303539.787000] usbcore: registered new driver usbvideo
>>[4303539.787000] USB Video Class driver (v0.1.0)
>>
>>I run uvcview
>>
>>karim at mirak <mailto:karim at mirak>:~/Prog/src/linux-uvc/uvcview-20060107$
>>uvcview -d /dev/video1 uvcview verion 0.1.3
>>Video driver: x11
>>A window manager is available
>>video /dev/video1
>>Unable to start capture: 28.
>>Error grabbing
>> Clean Up done Quit
>>
>>
>>
>>dmesg says this :
>>
>>[4304026.620000] usbvideo: uvc_v4l2_open
>>[4304026.620000] usbvideo: VIDIOC_QUERYCAP
>>[4304026.620000] usbvideo: VIDIOC_S_FMT
>>[4304026.620000] usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
>>[4304026.699000] usbvideo: VIDIOC_REQBUFS
>>[4304026.699000] usbvideo: VIDIOC_QUERYBUF
>>[4304026.699000] usbvideo: uvc_v4l2_mmap
>>[4304026.699000] usbvideo: VIDIOC_QUERYBUF
>>[4304026.699000] usbvideo: uvc_v4l2_mmap
>>[4304026.700000] usbvideo: VIDIOC_QUERYBUF
>>[4304026.700000] usbvideo: uvc_v4l2_mmap
>>[4304026.700000] usbvideo: VIDIOC_QUERYBUF
>>[4304026.700000] usbvideo: uvc_v4l2_mmap
>>[4304026.791000] usbvideo: VIDIOC_STREAMON
>>[4304026.791000] usbvideo: Failed to submit isoc URB 0 (-28).
>>[4304026.997000] usbvideo: > uvc_v4l2_release
>>[4304026.998000] usbvideo: < uvc_v4l2_release
>>
>>
>>
>>In fact the green led on the cam is not on.
>>
>>I tried also with
>>$ uvcview -d /dev/video1 -f jpg -s 640x480
>>It fails at the same point.
>>
>>One thing also is that doing
>>$ LANG=en cat /dev/video1
>>cat: /dev/video1: No such device
>>
>>On /dev/video0 wich is my bttv capture card it outputs something.
>>
>>
>>    
>>
>Mirak,
>Try to unplug all others usb device on the same HCD (like mouse keyboard ...) 
>or remove the usb hub between your webcam and the host .
>error -28 mean not enought bandwith available on the Usb Host Controller (HCD)
>Regards
>  
>
Well this works fine on windows.
The frame rate is better on windows too, but I guess it's because there 
is compression on the signal.
I use a USB 2 powered 8 ports HUB.

I tryed to use camorama but it fails to open the /dev/video1 device.
What's the issue ?
Should it just be compatible if there is a video device in /dev ?




From laurent.pinchart at skynet.be  Fri Jan 20 19:17:49 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jan 2006 19:17:49 +0100
Subject: [Linux-uvc-devel] MythTV / MythPhone UVC patch
In-Reply-To: <20060117013514.35054.qmail@web36210.mail.mud.yahoo.com>
References: <20060117013514.35054.qmail@web36210.mail.mud.yahoo.com>
Message-ID: <200601201917.50362.laurent.pinchart@skynet.be>

Hi Nick,

> Please find attached a patch to MythTV / MythPhone to
> support MJPEG and UVC.  This patch should apply
> cleanly against Myth SVN version 8626.

Thanks.

> Some outstanding problems / concerns with this patch:
>
> 1) The webcam does not turn off when exiting out of
> mythphone. This seems to be a problem with the
> VIDIOC_STREAMOFF ioctl() and/or the munmap() functions
> of the uvc driver...

What do you mean ? The blue light stays on ? That's weird. It should turn off 
when the device is closed. Could you please have a look at dmesg and see if 
either VIDIOC_STREAMOFF or uvc_v4l2_release are printed when exiting from 
mythphone ?

> 2) There's a complete lack of testing for other camera
> types besides the Logitech Quickcam Fusion.

The other Logitech UVC webcams will work too (except maybe the Quickcam Pro 
5000 which is a bit different, but it shouldn't matter too much) as they all 
have the same hardware/firmware.

> UVC folks:  I would appreciate it if you could add
> this patch to your collection.  Hopefully soon, I'll
> be submitting it to the mythtv folks.  I want to wait
> until my problems shutting down the webcam are solved
> first...

Applied. Please try to submit it to mythphone, at least to have their opinion. 
Your patch adds V4L2 support but removes V4L support, I'm not sure the mythtv 
developpers will be very happy with that (but I might be wrong, and I 
certainly hope so, V4L is deprecated anyway).

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 20 19:19:46 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jan 2006 19:19:46 +0100
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601191537.01832.scoutts@bcs.org.uk>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191537.01832.scoutts@bcs.org.uk>
Message-ID: <200601201919.46994.laurent.pinchart@skynet.be>

Hi Steven,

> > Hello,
> >
> > Is the driver usable with a Quickcam Pro 5000 yet?
> >
> > Regards
>
> Ok, compiled the software and loaded the kernel module, everything seems to
> be recognised -:
>
> usb 1-6: USB disconnect, address 5
> usb 1-1: new high speed USB device using ehci_hcd and address 6
> usbvideo: Probing device 1
> Format MJPEG found
> Format Uncompressed found
> usbvideo: Found a Status endpoint (addr 87).
> usbvideo: Found UVC device (1.00)
> usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
> usbvideo: Found a valid video chain (1 -> 5).
> usbvideo: UVC device initialized.
>
> However, uvcview doesn't work -:
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video0
> Unable to set format: 5.
>  Init v4L2 failed !! exit fatal

I don't have a Quickam Pro 5000, so I can only try to guess what goes wrong. 
Could you have a look at the output of dmesg after getting the "Unable to set 
format: 5" error message ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Fri Jan 20 19:28:59 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Fri, 20 Jan 2006 19:28:59 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
In-Reply-To: <43D11AF6.5010805@wanadoo.fr>
References: <43D0E590.7070308@wanadoo.fr> <200601201757.51358.mxhaard@magic.fr> <43D11AF6.5010805@wanadoo.fr>
Message-ID: <200601201928.59813.laurent.pinchart@skynet.be>

> >Mirak,
> >Try to unplug all others usb device on the same HCD (like mouse keyboard
> > ...) or remove the usb hub between your webcam and the host .
> >error -28 mean not enought bandwith available on the Usb Host Controller
> > (HCD) Regards
>
> Well this works fine on windows.
> The frame rate is better on windows too, but I guess it's because there
> is compression on the signal.
> I use a USB 2 powered 8 ports HUB.

I have to work on frame rate issues, there are probably a few problems left. 
What frame size did you select for capture in Linux ? 1024x576 and 1280x960 
use an uncompressed format which needs a much higher bandwidth than smaller 
sizes.

> I tryed to use camorama but it fails to open the /dev/video1 device.
> What's the issue ?
> Should it just be compatible if there is a video device in /dev ?

I haven't checked camorama, but the UVC driver only support V4L2 (V4L1 is 
deprecated), and doesn't support the read() method yet. That's probably why 
camorama failes.

Laurent Pinchart


From mirak63 at wanadoo.fr  Fri Jan 20 20:37:14 2006
From: mirak63 at wanadoo.fr (mirak)
Date: Fri, 20 Jan 2006 20:37:14 +0100
Subject: [Linux-uvc-devel] Error grabing frame on quickcam pro 5000
In-Reply-To: <200601201928.59813.laurent.pinchart@skynet.be>
References: <43D0E590.7070308@wanadoo.fr> <200601201757.51358.mxhaard@magic.fr> <43D11AF6.5010805@wanadoo.fr> <200601201928.59813.laurent.pinchart@skynet.be>
Message-ID: <43D13BEA.5030004@wanadoo.fr>

Laurent Pinchart a ?crit :

>>>Mirak,
>>>Try to unplug all others usb device on the same HCD (like mouse keyboard
>>>...) or remove the usb hub between your webcam and the host .
>>>error -28 mean not enought bandwith available on the Usb Host Controller
>>>(HCD) Regards
>>>      
>>>
>>Well this works fine on windows.
>>The frame rate is better on windows too, but I guess it's because there
>>is compression on the signal.
>>I use a USB 2 powered 8 ports HUB.
>>    
>>
>
>I have to work on frame rate issues, there are probably a few problems left. 
>What frame size did you select for capture in Linux ? 1024x576 and 1280x960 
>use an uncompressed format which needs a much higher bandwidth than smaller 
>sizes.
>  
>
I tried 320x240 and 640x480.

Thanks for that driver :)

>>I tryed to use camorama but it fails to open the /dev/video1 device.
>>What's the issue ?
>>Should it just be compatible if there is a video device in /dev ?
>>    
>>
>
>I haven't checked camorama, but the UVC driver only support V4L2 (V4L1 is 
>deprecated), and doesn't support the read() method yet. That's probably why 
>camorama failes.
>
>Laurent Pinchart
>_______________________________________________
>Linux-uvc-devel mailing list
>Linux-uvc-devel at lists.berlios.de
>http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>  
>




From ynutcase-uvc at yahoo.com  Fri Jan 20 22:34:01 2006
From: ynutcase-uvc at yahoo.com (ynutcase-uvc at yahoo.com)
Date: Fri, 20 Jan 2006 13:34:01 -0800 (PST)
Subject: [Linux-uvc-devel] MythTV / MythPhone UVC patch
In-Reply-To: <200601201917.50362.laurent.pinchart@skynet.be>
Message-ID: <20060120213401.35427.qmail@web36211.mail.mud.yahoo.com>


--- Laurent Pinchart <laurent.pinchart at skynet.be>
wrote:

> > Some outstanding problems / concerns with this
> patch:
> >
> > 1) The webcam does not turn off when exiting out
> of
> > mythphone. This seems to be a problem with the
> > VIDIOC_STREAMOFF ioctl() and/or the munmap()
> functions
> > of the uvc driver...
> 
> What do you mean ? The blue light stays on ? That's
> weird. It should turn off 
> when the device is closed. Could you please have a
> look at dmesg and see if 
> either VIDIOC_STREAMOFF or uvc_v4l2_release are
> printed when exiting from 
> mythphone ?

Actually, part of the problem was a bug in my code. 
OOPS.  :)  I'm still seeing other problems trying to
munmap() memory, but I haven't had time to create a
reproducable test case...  Hopefully I'll have another
e-mail to this mailing list soon.

> Applied. Please try to submit it to mythphone, at
> least to have their opinion. 
> Your patch adds V4L2 support but removes V4L
> support, I'm not sure the mythtv 
> developpers will be very happy with that (but I
> might be wrong, and I 
> certainly hope so, V4L is deprecated anyway).

I submitted the patch to the mythtv developers.

http://cvs.mythtv.org/trac/ticket/1051

It looks like they're targeting a 0.20 release, which,
given mythtv's release schedule, will probably be in 2
years.  :(

-- Nick



From scoutts at bcs.org.uk  Sat Jan 21 10:17:02 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Sat, 21 Jan 2006 09:17:02 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601201919.46994.laurent.pinchart@skynet.be>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191537.01832.scoutts@bcs.org.uk> <200601201919.46994.laurent.pinchart@skynet.be>
Message-ID: <200601210917.05153.scoutts@bcs.org.uk>

On Friday 20 January 2006 18:19, Laurent Pinchart wrote:
>
> I don't have a Quickam Pro 5000, so I can only try to guess what goes
> wrong. Could you have a look at the output of dmesg after getting the
> "Unable to set format: 5" error message ?
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel

Laurent,

After I get this error -:

uvcview verion 0.1.3
Video driver: x11
A window manager is available
video /dev/video0
X Error of failed request:  BadMatch (invalid parameter attributes)
  Major opcode of failed request:  141 (XVideo)
  Minor opcode of failed request:  19 ()
  Serial number of failed request:  23
  Current serial number in output stream:  24

This is in dmesg -:

usbvideo: uvc_v4l2_open
usbvideo: VIDIOC_QUERYCAP
usbvideo: VIDIOC_S_FMT
usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
usbvideo: VIDIOC_REQBUFS
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_STREAMON
usbvideo: > uvc_v4l2_release
usbvideo: < uvc_v4l2_release

The "Unable to set format: 5" error message" seems to have stopped now?

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060121/bb204d6e/attachment.pgp>

From scoutts at bcs.org.uk  Sat Jan 21 10:23:15 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Sat, 21 Jan 2006 09:23:15 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601201919.46994.laurent.pinchart@skynet.be>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191537.01832.scoutts@bcs.org.uk> <200601201919.46994.laurent.pinchart@skynet.be>
Message-ID: <200601210923.18178.scoutts@bcs.org.uk>

On Friday 20 January 2006 18:19, Laurent Pinchart wrote:

>
> I don't have a Quickam Pro 5000, so I can only try to guess what goes
> wrong. Could you have a look at the output of dmesg after getting the
> "Unable to set format: 5" error message ?
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel

Laurent,

Spoke too soon! Just had the error 5 message again and this is what is in 
dmesg -:

usbvideo: uvc_v4l2_open
usbvideo: VIDIOC_QUERYCAP
usbvideo: VIDIOC_S_FMT
usbvideo: Trying format 0x47504a4d (MJPG): 640x480.
usbvideo: Failed to query control 1 (unit 0) : -32.
usbvideo: > uvc_v4l2_release
usbvideo: < uvc_v4l2_release

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060121/37b25d0a/attachment.pgp>

From scoutts at bcs.org.uk  Sat Jan 21 15:50:28 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Sat, 21 Jan 2006 14:50:28 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601210917.05153.scoutts@bcs.org.uk>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601201919.46994.laurent.pinchart@skynet.be> <200601210917.05153.scoutts@bcs.org.uk>
Message-ID: <200601211450.31390.scoutts@bcs.org.uk>

On Saturday 21 January 2006 09:17, Steven Coutts wrote:
>
> Laurent,
>
> After I get this error -:
>
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video0
> X Error of failed request:  BadMatch (invalid parameter attributes)
>   Major opcode of failed request:  141 (XVideo)
>   Minor opcode of failed request:  19 ()
>   Serial number of failed request:  23
>   Current serial number in output stream:  24
>
> This is in dmesg -:
>
> usbvideo: uvc_v4l2_open
> usbvideo: VIDIOC_QUERYCAP
> usbvideo: VIDIOC_S_FMT
> usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
> usbvideo: VIDIOC_REQBUFS
> usbvideo: VIDIOC_QUERYBUF
> usbvideo: uvc_v4l2_mmap
> usbvideo: VIDIOC_QUERYBUF
> usbvideo: uvc_v4l2_mmap
> usbvideo: VIDIOC_QUERYBUF
> usbvideo: uvc_v4l2_mmap
> usbvideo: VIDIOC_QUERYBUF
> usbvideo: uvc_v4l2_mmap
> usbvideo: VIDIOC_STREAMON
> usbvideo: > uvc_v4l2_release
> usbvideo: < uvc_v4l2_release
>

Some more info if it's any use -:

xvinfo -:

X-Video Extension version 2.2
screen #0
  Adaptor #0: "Intel(R) 830M/845G/852GM/855GM/865G/915G Video Overlay"
    number of ports: 1
    port base: 56
    operations supported: PutImage
    supported visuals:
      depth 24, visualID 0x22
      depth 24, visualID 0x23
      depth 24, visualID 0x24
      depth 24, visualID 0x25
    number of attributes: 3
      "XV_COLORKEY" (range 0 to 16777215)
              client settable attribute
              client gettable attribute (current value is 66046)
      "XV_BRIGHTNESS" (range -128 to 127)
              client settable attribute
              client gettable attribute (current value is 0)
      "XV_CONTRAST" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 64)
    maximum XvImage size: 1440 x 1080
    Number of image formats: 4
      id: 0x32595559 (YUY2)
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)
      id: 0x32315659 (YV12)
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x30323449 (I420)
        guid: 49343230-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x59565955 (UYVY)
        guid: 55595659-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)

xdpyinfo -:

name of display:    :0.0
version number:    11.0
vendor string:    Gentoo (The X.Org Foundation 6.8.2, revision r6-0.1.13)
vendor release number:    60802000
X.Org version: 6.8.2
maximum request size:  16777212 bytes
motion buffer size:  256
bitmap unit, bit order, padding:    32, LSBFirst, 32
image byte order:    LSBFirst
number of supported pixmap formats:    7
supported pixmap formats:
    depth 1, bits_per_pixel 1, scanline_pad 32
    depth 4, bits_per_pixel 8, scanline_pad 32
    depth 8, bits_per_pixel 8, scanline_pad 32
    depth 15, bits_per_pixel 16, scanline_pad 32
    depth 16, bits_per_pixel 16, scanline_pad 32
    depth 24, bits_per_pixel 32, scanline_pad 32
    depth 32, bits_per_pixel 32, scanline_pad 32
keycode range:    minimum 8, maximum 255
focus:  window 0x400084, revert to PointerRoot
number of extensions:    32
    BIG-REQUESTS
    Composite
    DAMAGE
    DEC-XTRAP
    DOUBLE-BUFFER
    DPMS
    Extended-Visual-Information
    GLX
    LBX
    MIT-SCREEN-SAVER
    MIT-SHM
    MIT-SUNDRY-NONSTANDARD
    RANDR
    RECORD
    RENDER
    SECURITY
    SGI-GLX
    SHAPE
    SYNC
    TOG-CUP
    X-Resource
    XC-APPGROUP
    XC-MISC
    XFIXES
    XFree86-Bigfont
    XFree86-DGA
    XFree86-Misc
    XFree86-VidModeExtension
    XInputExtension
    XKEYBOARD
    XTEST
    XVideo
default screen number:    0
number of screens:    1

screen #0:
  dimensions:    1280x1024 pixels (433x347 millimeters)
  resolution:    75x75 dots per inch
  depths (7):    24, 1, 4, 8, 15, 16, 32
  root window id:    0x3c
  depth of root window:    24 planes
  number of colormaps:    minimum 1, maximum 1
  default colormap:    0x20
  default number of colormap cells:    256
  preallocated pixels:    black 0, white 16777215
  options:    backing-store NO, save-unders NO
  largest cursor:    64x64
  current input event mask:    0xfa4031
    KeyPressMask             EnterWindowMask          LeaveWindowMask
    KeymapStateMask          StructureNotifyMask      SubstructureNotifyMask
    SubstructureRedirectMask FocusChangeMask          PropertyChangeMask
    ColormapChangeMask
  number of visuals:    5
  default visual id:  0x22
  visual:
    visual id:    0x22
    class:    TrueColor
    depth:    24 planes
    available colormap entries:    256 per subfield
    red, green, blue masks:    0xff0000, 0xff00, 0xff
    significant bits in color specification:    8 bits
  visual:
    visual id:    0x23
    class:    TrueColor
    depth:    24 planes
    available colormap entries:    256 per subfield
    red, green, blue masks:    0xff0000, 0xff00, 0xff
    significant bits in color specification:    8 bits
  visual:
    visual id:    0x24
    class:    TrueColor
    depth:    24 planes
    available colormap entries:    256 per subfield
    red, green, blue masks:    0xff0000, 0xff00, 0xff
    significant bits in color specification:    8 bits
  visual:
    visual id:    0x25
    class:    TrueColor
    depth:    24 planes
    available colormap entries:    256 per subfield
    red, green, blue masks:    0xff0000, 0xff00, 0xff
    significant bits in color specification:    8 bits
  visual:
    visual id:    0x3a
    class:    TrueColor
    depth:    32 planes
    available colormap entries:    256 per subfield
    red, green, blue masks:    0xff0000, 0xff00, 0xff
    significant bits in color specification:    8 bits

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060121/acc66d62/attachment.pgp>

From scoutts at bcs.org.uk  Sat Jan 21 16:07:46 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Sat, 21 Jan 2006 15:07:46 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601201919.46994.laurent.pinchart@skynet.be>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191537.01832.scoutts@bcs.org.uk> <200601201919.46994.laurent.pinchart@skynet.be>
Message-ID: <200601211517.09249.scoutts@bcs.org.uk>

On Friday 20 January 2006 18:19, Laurent Pinchart wrote:
> Hi Steven,
>
>
> I don't have a Quickam Pro 5000, so I can only try to guess what goes
> wrong. Could you have a look at the output of dmesg after getting the
> "Unable to set format: 5" error message ?
>

It works from different hardware (Dell D600 Laptop).

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060121/d6c350d5/attachment.pgp>

From shapa at maxnet.ru  Sun Jan 22 03:37:21 2006
From: shapa at maxnet.ru (Max Shaposhnikov)
Date: Sun, 22 Jan 2006 05:37:21 +0300
Subject: [Linux-uvc-devel] logitech fusion
Message-ID: <0F650845-F639-42C8-AA47-45A011A9806B@maxnet.ru>

Hi
I'm trying to use Logitech Fusion camera (which has outstanding video  
quality ) as Linux web-cam server...
Driver is working Ok, but there is one thing that is requred for  
usage as surveillance solution - it's a still image capture support...
Is there any plans for implementing it?
Maybe some timeline? Anyway, i can help to test a driver...

-------
Thanks, Max Shaposhnikov

e-mail: shapa at mamba.ru
icq:       273777
home page: http://shapa.maxnet.ru
cell phone:  +447798720657
satellite phone: +8821653300761

If life is a stage, I want some better lighting.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060122/f9321b7e/attachment.html>

From ynutcase-uvc at yahoo.com  Sun Jan 22 16:24:49 2006
From: ynutcase-uvc at yahoo.com (ynutcase-uvc at yahoo.com)
Date: Sun, 22 Jan 2006 07:24:49 -0800 (PST)
Subject: [Linux-uvc-devel] MythTV / MythPhone UVC patch
In-Reply-To: <20060120213401.35427.qmail@web36211.mail.mud.yahoo.com>
Message-ID: <20060122152449.79297.qmail@web36209.mail.mud.yahoo.com>

Ok, I created a small test program, and came to the
conclusion that it was another bug in my code.  Doh. 
I was passing in the wrong second argument to
munmap().

Interestingly enough, given that I was passing bad
information to munmap(), it was still succeeding 3 out
of 4 times...  Something else seems wrong here...

-- Nick

--- ynutcase-uvc at yahoo.com wrote:

> Actually, part of the problem was a bug in my code. 
> OOPS.  :)  I'm still seeing other problems trying to
> munmap() memory, but I haven't had time to create a
> reproducable test case...  Hopefully I'll have
> another
> e-mail to this mailing list soon.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvctest.c
Type: text/x-csrc
Size: 2546 bytes
Desc: 1147958423-uvctest.c
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060122/6bdd9eeb/attachment.c>

From laurent.pinchart at skynet.be  Sun Jan 22 20:56:01 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 22 Jan 2006 20:56:01 +0100
Subject: [Linux-uvc-devel] MythTV / MythPhone UVC patch
In-Reply-To: <20060122152449.79297.qmail@web36209.mail.mud.yahoo.com>
References: <20060122152449.79297.qmail@web36209.mail.mud.yahoo.com>
Message-ID: <200601222056.01403.laurent.pinchart@skynet.be>

> Ok, I created a small test program, and came to the
> conclusion that it was another bug in my code.  Doh.
> I was passing in the wrong second argument to
> munmap().
>
> Interestingly enough, given that I was passing bad
> information to munmap(), it was still succeeding 3 out
> of 4 times...  Something else seems wrong here...

The offset of the second buffer is equal to the length of the first buffer, so 
you probably ended up unmapping the second buffer four times. It's fixed 
anyway :-)

Laurent Pinchart


From laurent.pinchart at skynet.be  Sun Jan 22 20:58:57 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sun, 22 Jan 2006 20:58:57 +0100
Subject: [Linux-uvc-devel] logitech fusion
In-Reply-To: <0F650845-F639-42C8-AA47-45A011A9806B@maxnet.ru>
References: <0F650845-F639-42C8-AA47-45A011A9806B@maxnet.ru>
Message-ID: <200601222058.57722.laurent.pinchart@skynet.be>

> I'm trying to use Logitech Fusion camera (which has outstanding video
> quality ) as Linux web-cam server...
> Driver is working Ok, but there is one thing that is requred for
> usage as surveillance solution - it's a still image capture support...
> Is there any plans for implementing it?
> Maybe some timeline? Anyway, i can help to test a driver...

Still image capture ? What do you exactly mean ? The USB Video Class defines 
several methods of still image capture. The one supported by the Logitech 
webcams is simply to capture the next image in the stream when the button is 
pressed. The camera button is supported by the driver, but it currently does 
nothing. Is that what you need ?

Laurent Pinchart


From shade73a at tjohoo.se  Tue Jan 24 21:55:56 2006
From: shade73a at tjohoo.se (Fredrik Trotzig)
Date: Tue, 24 Jan 2006 20:56:56 +01
Subject: [Linux-uvc-devel] MythTV / MythPhone UVC patch
Message-ID: <200601242009.k0OK99x07331@bat.berlios.de>

Hi.

I\'ve tried the patch which applied and compiled nicely.
But i get.
Could not set webcam to 128x96; got 160x120 instead.
mythfrontend: symbol lookup error: /usr/local/lib/mythtv/plugins/libmythphone.so: undefined symbol: _ZN14MJPEGContainerC1Ev
I made distclean, so i dunno. Seems like im missing something..

/Br Fredrik








From bxerroz at gmail.com  Thu Jan 26 08:43:07 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Wed, 25 Jan 2006 23:43:07 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
Message-ID: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>

Hi all, as of late, i have purchased the brand spanking new web cam,
Quickcam pro, finding out in lost hope that it is unsupported by the
traditional drives, my hopes are lifted with this project! :) anyway. I have
compiled all that is needed for the webcam to work, and loaded all the
modules and what not, and can even see myself with uvcview utility. However,
currently, i cannot use it as i intended with aMSN, while at points, tries
to work (indicated by the flickering of the camera, and apparently slow
process) but fails to work. also, xawtv, mplayer, and others also fail to
see the video.

I suppose my question is this, is there any possible way to output the
captured stream of uvcview to another v4l device, so as to provide a more
reliable method of video output. Im sorry if my question is foolish, i am
not well versed in v4l2 or this project. And my C[++] needs updating no
doubt.

Perhaps more clearly, my question is why is it uvcviewer can see it
properly, where as applications using the standard v4l2 cannot, and how, if
possible, can we make the output more standard, as to be seen by the
standard programs, like xawtv, and such.

Also, i would like to know, if needed, what could be done to further aid the
development of this project, i am willing to attempt to learn v4l2, and
relevant USB2 information to possibly help in advancing this project,
although as of now, no promises can be made (working highly odd hours,
unreliable hours really). Also, heh, sorry for this message, as i have spent
the last 12 hours or so working at a computer, my brain is somewhat less
than optimal. so please excuse the poor grammar, punctuation, run on
sentences, etc.

I dont know if dmesg outputs are relevant, but if they are, i shall post
them (didnt want to fill this post with nonsense)

Tanner
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060125/4c79e40b/attachment.html>

From luc at saillard.org  Thu Jan 26 09:41:04 2006
From: luc at saillard.org (Luc Saillard)
Date: Thu, 26 Jan 2006 09:41:04 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
Message-ID: <20060126084104.GN15278@sd291.sivit.org>

On Wed, Jan 25, 2006 at 11:43:07PM -0800, Binary Xerroz wrote:
> Hi all, as of late, i have purchased the brand spanking new web cam,
> Quickcam pro, finding out in lost hope that it is unsupported by the
> traditional drives, my hopes are lifted with this project! :) anyway. I have
> compiled all that is needed for the webcam to work, and loaded all the
> modules and what not, and can even see myself with uvcview utility. However,
> currently, i cannot use it as i intended with aMSN, while at points, tries
> to work (indicated by the flickering of the camera, and apparently slow
> process) but fails to work. also, xawtv, mplayer, and others also fail to
> see the video.

Currently ekiga (aka gnomemeeting) have basic support but soon mjpeg format
will be add. I've fixed a color problem yesterday.

> Perhaps more clearly, my question is why is it uvcviewer can see it
> properly, where as applications using the standard v4l2 cannot, and how, if
> possible, can we make the output more standard, as to be seen by the
> standard programs, like xawtv, and such.

because uvcviewer can decode MJPEG et YUYV stream, and not the others. xawtv
support MJPEG stream (the other device that send this stream is the motion
eye; a webcam found in some Sony laptop). MJPEG is not very popular in
software application because not many device return this format, and the many
driver do the conversion in the driver (bad) so not many application have
developped a support for this format.

> Also, i would like to know, if needed, what could be done to further aid the
> development of this project, i am willing to attempt to learn v4l2, and
> relevant USB2 information to possibly help in advancing this project,

You just need to add support for yet another video format in your favorite
application. I look quickly into mplayer, and not found why he can't decode
the stream.

Luc


From tristil at gmail.com  Thu Jan 26 15:44:54 2006
From: tristil at gmail.com (Joseph Method)
Date: Thu, 26 Jan 2006 09:44:54 -0500
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <20060126084104.GN15278@sd291.sivit.org>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
Message-ID: <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>

Tanner,

I also have the Logitech Quickcam Pro for Notebooks. Gnomemeeting
1.2objected, I think on the basis of a color problem, so it may work
now. The
newest Gnomemeeting, Ekiga, actually displays the video as of last night.
You can find debs here:

http://snapshots.seconix.com/

I needed a library from here:

http://ftp.uni-kl.de/pub/linux/debian/pool/main/e/evolution-data-server/

The next V4L2 application I hope to see work is WengoPhone. I'll be
investigating this tonight.

P.S. This is strictly off-topic, but I don't know how to get 'modprobe
uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
and I have to use 'insmod uvcvideo.ko'.


On 1/26/06, Luc Saillard <luc at saillard.org> wrote:
>
> On Wed, Jan 25, 2006 at 11:43:07PM -0800, Binary Xerroz wrote:
> > Hi all, as of late, i have purchased the brand spanking new web cam,
> > Quickcam pro, finding out in lost hope that it is unsupported by the
> > traditional drives, my hopes are lifted with this project! :) anyway. I
> have
> > compiled all that is needed for the webcam to work, and loaded all the
> > modules and what not, and can even see myself with uvcview utility.
> However,
> > currently, i cannot use it as i intended with aMSN, while at points,
> tries
> > to work (indicated by the flickering of the camera, and apparently slow
> > process) but fails to work. also, xawtv, mplayer, and others also fail
> to
> > see the video.
>
> Currently ekiga (aka gnomemeeting) have basic support but soon mjpeg
> format
> will be add. I've fixed a color problem yesterday.
>
> > Perhaps more clearly, my question is why is it uvcviewer can see it
> > properly, where as applications using the standard v4l2 cannot, and how,
> if
> > possible, can we make the output more standard, as to be seen by the
> > standard programs, like xawtv, and such.
>
> because uvcviewer can decode MJPEG et YUYV stream, and not the others.
> xawtv
> support MJPEG stream (the other device that send this stream is the motion
> eye; a webcam found in some Sony laptop). MJPEG is not very popular in
> software application because not many device return this format, and the
> many
> driver do the conversion in the driver (bad) so not many application have
> developped a support for this format.
>
> > Also, i would like to know, if needed, what could be done to further aid
> the
> > development of this project, i am willing to attempt to learn v4l2, and
> > relevant USB2 information to possibly help in advancing this project,
>
> You just need to add support for yet another video format in your favorite
> application. I look quickly into mplayer, and not found why he can't
> decode
> the stream.
>
> Luc
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>



--
-J. Method
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060126/d70b9f82/attachment.html>

From mini at nada.kth.se  Thu Jan 26 17:23:02 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Thu, 26 Jan 2006 17:23:02 +0100
Subject: [Linux-uvc-devel] Module location (was: Logitech Quickcam for Notebooks Pro)
In-Reply-To: <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
Message-ID: <1138292583.10092.17.camel@yossarian>

tor 2006-01-26 klockan 09:44 -0500 skrev Joseph Method:
> Tanner, 

> 
> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
> uvcvideo' to work; it's in a .../usb/media folder with regular
> permissions, and I have to use 'insmod uvcvideo.ko'.

If the module is in a folder in /lib/modules not matching "uname -r",
that's probably the reason. The fix for Debian is here:

https://lists.berlios.de/pipermail/linux-uvc-devel/2006-January/000073.html

/Mikael

> 
> 
> On 1/26/06, Luc Saillard <luc at saillard.org> wrote:
>         On Wed, Jan 25, 2006 at 11:43:07PM -0800, Binary Xerroz wrote:
>         > Hi all, as of late, i have purchased the brand spanking new
>         web cam,
>         > Quickcam pro, finding out in lost hope that it is
>         unsupported by the
>         > traditional drives, my hopes are lifted with this
>         project! :) anyway. I have 
>         > compiled all that is needed for the webcam to work, and
>         loaded all the
>         > modules and what not, and can even see myself with uvcview
>         utility. However,
>         > currently, i cannot use it as i intended with aMSN, while at
>         points, tries 
>         > to work (indicated by the flickering of the camera, and
>         apparently slow
>         > process) but fails to work. also, xawtv, mplayer, and others
>         also fail to
>         > see the video.
>         
>         Currently ekiga (aka gnomemeeting) have basic support but soon
>         mjpeg format 
>         will be add. I've fixed a color problem yesterday.
>         
>         > Perhaps more clearly, my question is why is it uvcviewer can
>         see it
>         > properly, where as applications using the standard v4l2
>         cannot, and how, if
>         > possible, can we make the output more standard, as to be
>         seen by the
>         > standard programs, like xawtv, and such.
>         
>         because uvcviewer can decode MJPEG et YUYV stream, and not the
>         others. xawtv
>         support MJPEG stream (the other device that send this stream
>         is the motion 
>         eye; a webcam found in some Sony laptop). MJPEG is not very
>         popular in
>         software application because not many device return this
>         format, and the many
>         driver do the conversion in the driver (bad) so not many
>         application have 
>         developped a support for this format.
>         
>         > Also, i would like to know, if needed, what could be done to
>         further aid the
>         > development of this project, i am willing to attempt to
>         learn v4l2, and
>         > relevant USB2 information to possibly help in advancing this
>         project, 
>         
>         You just need to add support for yet another video format in
>         your favorite
>         application. I look quickly into mplayer, and not found why he
>         can't decode
>         the stream.
>         
>         Luc
>         _______________________________________________ 
>         Linux-uvc-devel mailing list
>         Linux-uvc-devel at lists.berlios.de
>         http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
> 
> 
> -- 
> -J. Method
-- 
Plus ?a change, plus c'est la m?me chose



From pbrobinson at gmail.com  Thu Jan 26 17:35:22 2006
From: pbrobinson at gmail.com (Peter Robinson)
Date: Thu, 26 Jan 2006 16:35:22 +0000
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
Message-ID: <5256d0b0601260835q47da2543y5157ea532552a0b8@mail.gmail.com>

On 1/26/06, Joseph Method <tristil at gmail.com> wrote:
> Tanner,
>
> I also have the Logitech Quickcam Pro for Notebooks. Gnomemeeting 1.2
> objected, I think on the basis of a color problem, so it may work now. The
> newest Gnomemeeting, Ekiga, actually displays the video as of last night.
> You can find debs here:
>
> http://snapshots.seconix.com/
>
> I needed a library from here:
>
> http://ftp.uni-kl.de/pub/linux/debian/pool/main/e/evolution-data-server/
>
> The next V4L2 application I hope to see work is WengoPhone. I'll be
> investigating this tonight.
>
> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
> uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
> and I have to use 'insmod uvcvideo.ko'.

You should be able do do a make install which will install it into
/lib/modules. The a depmod -a to redo the modules then a modprobe
uvcvideo

Peter


From espen at marcato.no  Thu Jan 26 19:58:48 2006
From: espen at marcato.no (Espen Holm)
Date: Thu, 26 Jan 2006 19:58:48 +0100
Subject: [Linux-uvc-devel] Reporting cam
Message-ID: <200601261958.48874.espen@marcato.no>

On "http://linux-uvc.berlios.de/" I was asked to report my cam.
I have a Logitech Quickcam Fusion.
I'm a linux user searching for a driver for it.

Quote:
Download
Source code for the Linux UVC kernel driver can be found in the Linux UVC Subversion repository on the BerliOS project page.

I found nothing to download on the link: "http://developer.berlios.de/projects/linux-uvc"

Did I miss something?

Espen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060126/a78f7551/attachment.html>

From bxerroz at gmail.com  Thu Jan 26 21:18:20 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Thu, 26 Jan 2006 12:18:20 -0800
Subject: [Linux-uvc-devel] Reporting cam
In-Reply-To: <200601261958.48874.espen@marcato.no>
References: <200601261958.48874.espen@marcato.no>
Message-ID: <e04f28eb0601261218u6dd7e4dbm2adaa3f1d94d3921@mail.gmail.com>

haha yes, i did that too. you need to use subversion.

(for me, gentoo, emerge subversion)

svn checkout http://svn.berlios.de/svnroot/repos/linux-uvc/linux-uvc/trunk/

that'll do ya

Tanner

PS: dupped (atleast to original sender, forgot to hit reply to all haha)b

On 1/26/06, Espen Holm <espen at marcato.no> wrote:
>
> On "http://linux-uvc.berlios.de/" I was asked to report my cam.
>
> I have a Logitech Quickcam Fusion.
>
> I'm a linux user searching for a driver for it.
>
> Quote:
>
> Download
>
> Source code for the Linux UVC kernel driver can be found in the Linux UVC
> Subversion repository on the BerliOS project page.
>
> I found nothing to download on the link: "
> http://developer.berlios.de/projects/linux-uvc"
>
> Did I miss something?
>
> Espen
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060126/62609f46/attachment.html>

From bxerroz at gmail.com  Thu Jan 26 22:03:06 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Thu, 26 Jan 2006 13:03:06 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
Message-ID: <e04f28eb0601261303q1ba6aebdub2282dfbd3bbe21b@mail.gmail.com>

Hmm, ill look into gnomemeeting (its emering now). however my primary
interest is aMSN and its msn (obviously heh) webcam.
The application supports v4l (v4l2?) and can even see my device, listed as
'V4L-2: ', and when clicked on, displays a 'Error getting capabilities'
message. once engaged in the conversation the light on my camera will start,
but it never seems to be working.

I have tried to look through the source code of both uvcview, and amsn. aMSN
is in tcl (apparent thanks to the extention) and heh, i have no idea how to
work with that, let alone convert the source from uvcview.

Also, i am trying to find the relevant parts of uvcview, mainly the capture,
decode, process.

To be honest, i have no idea how it will be possible to integrate what i
need into aMSN, or even where to start =\

On 1/26/06, Joseph Method <tristil at gmail.com> wrote:
>
> Tanner,
>
> I also have the Logitech Quickcam Pro for Notebooks. Gnomemeeting 1.2objected, I think on the basis of a color problem, so it may work now. The
> newest Gnomemeeting, Ekiga, actually displays the video as of last night.
> You can find debs here:
>
> http://snapshots.seconix.com/
>
> I needed a library from here:
>
> http://ftp.uni-kl.de/pub/linux/debian/pool/main/e/evolution-data-server/
>
> The next V4L2 application I hope to see work is WengoPhone. I'll be
> investigating this tonight.
>
> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
> uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
> and I have to use 'insmod uvcvideo.ko'.
>
>
> On 1/26/06, Luc Saillard <luc at saillard.org> wrote:
>
> > On Wed, Jan 25, 2006 at 11:43:07PM -0800, Binary Xerroz wrote:
> > > Hi all, as of late, i have purchased the brand spanking new web cam,
> > > Quickcam pro, finding out in lost hope that it is unsupported by the
> > > traditional drives, my hopes are lifted with this project! :) anyway.
> > I have
> > > compiled all that is needed for the webcam to work, and loaded all the
> > > modules and what not, and can even see myself with uvcview utility.
> > However,
> > > currently, i cannot use it as i intended with aMSN, while at points,
> > tries
> > > to work (indicated by the flickering of the camera, and apparently
> > slow
> > > process) but fails to work. also, xawtv, mplayer, and others also fail
> > to
> > > see the video.
> >
> > Currently ekiga (aka gnomemeeting) have basic support but soon mjpeg
> > format
> > will be add. I've fixed a color problem yesterday.
> >
> > > Perhaps more clearly, my question is why is it uvcviewer can see it
> > > properly, where as applications using the standard v4l2 cannot, and
> > how, if
> > > possible, can we make the output more standard, as to be seen by the
> > > standard programs, like xawtv, and such.
> >
> > because uvcviewer can decode MJPEG et YUYV stream, and not the others.
> > xawtv
> > support MJPEG stream (the other device that send this stream is the
> > motion
> > eye; a webcam found in some Sony laptop). MJPEG is not very popular in
> > software application because not many device return this format, and the
> > many
> > driver do the conversion in the driver (bad) so not many application
> > have
> > developped a support for this format.
> >
> > > Also, i would like to know, if needed, what could be done to further
> > aid the
> > > development of this project, i am willing to attempt to learn v4l2,
> > and
> > > relevant USB2 information to possibly help in advancing this project,
> >
> > You just need to add support for yet another video format in your
> > favorite
> > application. I look quickly into mplayer, and not found why he can't
> > decode
> > the stream.
> >
> > Luc
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
>
>
>
> --
> -J. Method
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060126/07c21329/attachment.html>

From laurent.pinchart at skynet.be  Thu Jan 26 23:54:52 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 26 Jan 2006 23:54:52 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601261303q1ba6aebdub2282dfbd3bbe21b@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com> <e04f28eb0601261303q1ba6aebdub2282dfbd3bbe21b@mail.gmail.com>
Message-ID: <200601262354.52394.laurent.pinchart@skynet.be>

Hi Tanner,

> Hmm, ill look into gnomemeeting (its emering now). however my primary
> interest is aMSN and its msn (obviously heh) webcam.
> The application supports v4l (v4l2?) and can even see my device, listed as
> 'V4L-2: ', and when clicked on, displays a 'Error getting capabilities'
> message. once engaged in the conversation the light on my camera will
> start, but it never seems to be working.

After a quick look at the source code, aMSN seems to support V4L2 and YUYV but 
not MJPEG. As I have no MSN account there is no way I can test the software. 
Have you tried asking the aMSN developers for support ?

> I have tried to look through the source code of both uvcview, and amsn.
> aMSN is in tcl (apparent thanks to the extention) and heh, i have no idea
> how to work with that, let alone convert the source from uvcview.

Some parts are implemented in tcl, but image capture is implemented in plain 
old C.

> To be honest, i have no idea how it will be possible to integrate what i
> need into aMSN, or even where to start =\

Have a look at utils/linux/capture

Regarding xawtv, I'll try to see if I can get it working with the linux-uvc 
driver this weekend. Has someone else had any success with xawtv so far ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Thu Jan 26 23:56:34 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 26 Jan 2006 23:56:34 +0100
Subject: [Linux-uvc-devel] Reporting cam
In-Reply-To: <200601261958.48874.espen@marcato.no>
References: <200601261958.48874.espen@marcato.no>
Message-ID: <200601262356.34916.laurent.pinchart@skynet.be>

> On "http://linux-uvc.berlios.de/" I was asked to report my cam.
> I have a Logitech Quickcam Fusion.
> I'm a linux user searching for a driver for it.

I meant to ask people to report other UVC cameras than the ones listed on the 
webpage, but thanks anyway :-) I'll change the wording on the web site.

Laurent Pinchart


From bxerroz at gmail.com  Fri Jan 27 00:09:19 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Thu, 26 Jan 2006 15:09:19 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601262354.52394.laurent.pinchart@skynet.be>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
	 <e04f28eb0601261303q1ba6aebdub2282dfbd3bbe21b@mail.gmail.com>
	 <200601262354.52394.laurent.pinchart@skynet.be>
Message-ID: <e04f28eb0601261509p1efca8e4j83fec1a968ebb548@mail.gmail.com>

Hi Laurent,

Yes, upon further looking into the aMSN source code i have discovered the
lovely C code :-D

lol, however, i still cannot seem to find what i need, or again, where to
start.

Also, you say it supports YUYV, am i not correct in assuming the output of
the driver is in either format, MJPEG or YUYV? i thought i saw something of
the sort in uvcview, although i am not certain what it was. assuming it
does. then why cannot the program access it correctly, and if it cant..well
i guess i have to figure out how to add it.

Also, heh, i have snooped around the amsn project pages, but they dont have
any mailing list to send requests to, and lol have not figured out how to on
SF.com so hmm.

On 1/26/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
>
> Hi Tanner,
>
> > Hmm, ill look into gnomemeeting (its emering now). however my primary
> > interest is aMSN and its msn (obviously heh) webcam.
> > The application supports v4l (v4l2?) and can even see my device, listed
> as
> > 'V4L-2: ', and when clicked on, displays a 'Error getting capabilities'
> > message. once engaged in the conversation the light on my camera will
> > start, but it never seems to be working.
>
> After a quick look at the source code, aMSN seems to support V4L2 and YUYV
> but
> not MJPEG. As I have no MSN account there is no way I can test the
> software.
> Have you tried asking the aMSN developers for support ?
>
> > I have tried to look through the source code of both uvcview, and amsn.
> > aMSN is in tcl (apparent thanks to the extention) and heh, i have no
> idea
> > how to work with that, let alone convert the source from uvcview.
>
> Some parts are implemented in tcl, but image capture is implemented in
> plain
> old C.
>
> > To be honest, i have no idea how it will be possible to integrate what i
> > need into aMSN, or even where to start =\
>
> Have a look at utils/linux/capture
>
> Regarding xawtv, I'll try to see if I can get it working with the
> linux-uvc
> driver this weekend. Has someone else had any success with xawtv so far ?
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060126/d5934d1b/attachment.html>

From bxerroz at gmail.com  Fri Jan 27 05:02:10 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Thu, 26 Jan 2006 20:02:10 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601262354.52394.laurent.pinchart@skynet.be>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
	 <e04f28eb0601261303q1ba6aebdub2282dfbd3bbe21b@mail.gmail.com>
	 <200601262354.52394.laurent.pinchart@skynet.be>
Message-ID: <e04f28eb0601262002s83a006ap511a06537f2d7346@mail.gmail.com>

On 1/26/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
>
> Hi Tanner,
>
> > Hmm, ill look into gnomemeeting (its emering now). however my primary
> > interest is aMSN and its msn (obviously heh) webcam.
> > The application supports v4l (v4l2?) and can even see my device, listed
> as
> > 'V4L-2: ', and when clicked on, displays a 'Error getting capabilities'
> > message. once engaged in the conversation the light on my camera will
> > start, but it never seems to be working.
>
> After a quick look at the source code, aMSN seems to support V4L2 and YUYV
> but
> not MJPEG. As I have no MSN account there is no way I can test the
> software.
> Have you tried asking the aMSN developers for support ?


Apparently, it is not v4l2 coded heh. ive looked through a  bunch of the
code, and began placing  debug printf's,  there is a section of note:

>>   struct video_capability vcap;
   shouldnt this be v4l2_capability?  (assuming v4l2 compliant)

>>if (ioctl(fvideo, VIDIOCGCAP, &vcap) < 0) {
      struct v4l2_capability v4l2CAPS; // *********************** mine
      ioctl(fvideo, VIDIOC_QUERYCAP, &v4l2CAPS); // ******************* this
is mine
      printf("HELP!!!!\n%s", v4l2CAPS.capabilities &
V4L2_CAP_VIDEO_CAPTURE); // ************* this is mine
      printf("video_capability[vcap]\n\tName: %s\n\tType: %s\n\tChannels:
%s\n\tAudios: %s\n\tWidth[max,min]: [%s,%s]\n\tHeight[max,min]: [%s,%s]\n",
vcap.name, vcap.type,vcap.channels, vcap.audios, vcap.maxwidth,
vcap.minwidth, vcap.maxheight,vcap.minheight); //*************************
this is mine also, note that program crashes on printf of this function
>>    Tcl_AppendResult(interp, "Error getting capabilities - 1", (char *)
NULL);
>>    close(fvideo);
>>    return TCL_ERROR;

the entire return of test.tcl is:

dlsym[./libng/plugins/drv0-v4l2.so]: ./libng/plugins/drv0-v4l2.so: undefined
symbol: _ng_plugin_init
dlsym[./libng/plugins/drv1-v4l.so]: ./libng/plugins/drv1-v4l.so: undefined
symbol: _ng_plugin_init
WARNING: no plugins found [/home/xerroz/msn]
ioctl: VIDIOCGCAP(name="?O=@???[2@";type=0x403ca160
[CLIPPING,FRAMERAM,MONOCHROME,MJPEG_ENCODER,(null),(null),(null),(null),(null),(null)];channels=1077040529;audios=1077042084;maxwidth=1077766688;maxheight=0;minwidth=0;minheight=134808394):
Invalid argument
HELP!!!!
Segmentation fault

<< now its faulting on the printf for the v4l2CAPS struct i made, output
with those lines commented

dlsym[./libng/plugins/drv0-v4l2.so]: ./libng/plugins/drv0-v4l2.so: undefined
symbol: _ng_plugin_init
dlsym[./libng/plugins/drv1-v4l.so]: ./libng/plugins/drv1-v4l.so: undefined
symbol: _ng_plugin_init
WARNING: no plugins found [/home/xerroz/msn]
ioctl: VIDIOCGCAP(name="?O=@ ???[2@";type=0x403ca160
[CLIPPING,FRAMERAM,MONOCHROME,MJPEG_ENCODER,(null),(null),(null),(null),(null),(null)];channels=1077040529;audios=1077042084;maxwidth=1077766688;maxheight=0;minwidth=0;minheight=134808394):
Invalid argument
video_capability[vcap]
        Name:
        Type: (?
        Channels: h

        Audios: (?
        Width[max,min]: [?B?:?,::device]
Segmentation fault

<<

I am beginning to think that aMSN is NOT v4l2 compliant, judging from the
output of the printf (which should have the capabilities right?) and even
the iotctl message above (which, i cannot figure out where its coming from,
but seems to judge better than the other function, yet still off)

any ideas guys?

> I have tried to look through the source code of both uvcview, and amsn.
> > aMSN is in tcl (apparent thanks to the extention) and heh, i have no
> idea
> > how to work with that, let alone convert the source from uvcview.
>
> Some parts are implemented in tcl, but image capture is implemented in
> plain
> old C.
>
> > To be honest, i have no idea how it will be possible to integrate what i
> > need into aMSN, or even where to start =\
>
> Have a look at utils/linux/capture
>
> Regarding xawtv, I'll try to see if I can get it working with the
> linux-uvc
> driver this weekend. Has someone else had any success with xawtv so far ?
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060126/295435f5/attachment.html>

From mxhaard at magic.fr  Fri Jan 27 10:24:58 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Fri, 27 Jan 2006 10:24:58 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601261509p1efca8e4j83fec1a968ebb548@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601262354.52394.laurent.pinchart@skynet.be> <e04f28eb0601261509p1efca8e4j83fec1a968ebb548@mail.gmail.com>
Message-ID: <200601271024.59121.mxhaard@magic.fr>

Le Vendredi 27 Janvier 2006 00:09, Binary Xerroz a ?crit?:
> Hi Laurent,
>
> Yes, upon further looking into the aMSN source code i have discovered the
> lovely C code :-D
>
> lol, however, i still cannot seem to find what i need, or again, where to
> start.
Seem amsn now use libng from the xawtv package you need to add a converter for 
the MJPEG palette and uncomment the YUYV converter (untested)  set in the 
libng package (I am looking at the CVS code). You can get the MJPEG converter 
from uvcview in the utils.c file.
> Also, you say it supports YUYV, am i not correct in assuming the output of
> the driver is in either format, MJPEG or YUYV? i thought i saw something of
> the sort in uvcview, although i am not certain what it was. assuming it
> does. then why cannot the program access it correctly, and if it cant..well
> i guess i have to figure out how to add it.
uvcview in YUYV grab the stream and forward to the display 
in MJPEG add the missing Huffman table, decompress the jpeg picture to YUYV 
and forward to the display.
> Also, heh, i have snooped around the amsn project pages, but they dont have
> any mailing list to send requests to, and lol have not figured out how to
> on SF.com so hmm.
 #amsn on irc.freenode.net
http://amsn.sourceforge.net/forums/viewforum.php?f=8&sid=0f2fc183f3ae3a339d4ad056868dbebd
> On 1/26/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > Hi Tanner,
> >
> > > Hmm, ill look into gnomemeeting (its emering now). however my primary
> > > interest is aMSN and its msn (obviously heh) webcam.
> > > The application supports v4l (v4l2?) and can even see my device, listed
> >
> > as
> >
> > > 'V4L-2: ', and when clicked on, displays a 'Error getting capabilities'
> > > message. once engaged in the conversation the light on my camera will
> > > start, but it never seems to be working.
> >
> > After a quick look at the source code, aMSN seems to support V4L2 and
> > YUYV but
> > not MJPEG. As I have no MSN account there is no way I can test the
> > software.
> > Have you tried asking the aMSN developers for support ?
> >
> > > I have tried to look through the source code of both uvcview, and amsn.
> > > aMSN is in tcl (apparent thanks to the extention) and heh, i have no
> >
> > idea
> >
> > > how to work with that, let alone convert the source from uvcview.
> >
> > Some parts are implemented in tcl, but image capture is implemented in
> > plain
> > old C.
> >
> > > To be honest, i have no idea how it will be possible to integrate what
> > > i need into aMSN, or even where to start =\
> >
> > Have a look at utils/linux/capture
> >
> > Regarding xawtv, I'll try to see if I can get it working with the
> > linux-uvc
> > driver this weekend. Has someone else had any success with xawtv so far ?
> >
> > Laurent Pinchart
-- 
Michel Xhaard
http://mxhaard.free.fr


From mini at nada.kth.se  Fri Jan 27 22:27:37 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Fri, 27 Jan 2006 22:27:37 +0100
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601191545.11412.scoutts@bcs.org.uk>
References: <200601191350.50916.scoutts@bcs.org.uk>
	 <200601191537.01832.scoutts@bcs.org.uk>
	 <200601191545.11412.scoutts@bcs.org.uk>
Message-ID: <1138397258.11355.13.camel@yossarian>

I see this too, with a QC Fusion on  Dell Inspiron 8200. Is it possible
that it has to do with my USB 1.1-only port?

/Mikael
====================================================0
uvcview verion 0.1.3
Video driver: x11
A window manager is available
video /dev/video0
X Error of failed request:  BadMatch (invalid parameter attributes)
  Major opcode of failed request:  142 (XVideo)
  Minor opcode of failed request:  19 ()
  Serial number of failed request:  23
  Current serial number in output stream:  24


usb 1-1: new full speed USB device using uhci_hcd and address 7
7:3:1: cannot set freq 0 to ep 0x86
7:3:2: cannot set freq 0 to ep 0x86
usbvideo: Probing device 1
Format MJPEG found
usbvideo: Found a Status endpoint (addr 87).
usbvideo: Found UVC device (1.00)
usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
usbvideo: Found a valid video chain (1 -> 5).
usbvideo: UVC device initialized.
usbcore: registered new driver usbvideo
USB Video Class driver (v0.1.0)
usbvideo: uvc_v4l2_open
usbvideo: VIDIOC_QUERYCAP
usbvideo: VIDIOC_S_FMT
usbvideo: Trying format 0x47504a4d (MJPG): 320x240.
usbvideo: VIDIOC_REQBUFS
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_QUERYBUF
usbvideo: uvc_v4l2_mmap
usbvideo: VIDIOC_STREAMON
usbvideo: > uvc_v4l2_release
usbvideo: < uvc_v4l2_release
=======================================================


tor 2006-01-19 klockan 15:45 +0000 skrev Steven Coutts:
> On Thursday 19 January 2006 15:36, Steven Coutts wrote:
> > Ok, compiled the software and loaded the kernel module, everything seems to
> > be recognised -:
> >
> > usb 1-6: USB disconnect, address 5
> > usb 1-1: new high speed USB device using ehci_hcd and address 6
> > usbvideo: Probing device 1
> > Format MJPEG found
> > Format Uncompressed found
> > usbvideo: Found a Status endpoint (addr 87).
> > usbvideo: Found UVC device (1.00)
> > usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 <- Unit 2 <- IT 1
> > usbvideo: Found a valid video chain (1 -> 5).
> > usbvideo: UVC device initialized.
> >
> > However, uvcview doesn't work -:
> > uvcview verion 0.1.3
> > Video driver: x11
> > A window manager is available
> > video /dev/video0
> > Unable to set format: 5.
> >  Init v4L2 failed !! exit fatal
> >
> >
> > Any ideas?
> 
> If I unplug the device then plug back in and try again I get a black video 
> windows breifly then it fails -:
> 
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video0
> X Error of failed request:  BadMatch (invalid parameter attributes)
>   Major opcode of failed request:  141 (XVideo)
>   Minor opcode of failed request:  19 ()
>   Serial number of failed request:  23
>   Current serial number in output stream:  24
> 
> Regards
> 
-- 
Plus ?a change, plus c'est la m?me chose



From bxerroz at gmail.com  Fri Jan 27 22:32:27 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Fri, 27 Jan 2006 13:32:27 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601271024.59121.mxhaard@magic.fr>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <200601262354.52394.laurent.pinchart@skynet.be>
	 <e04f28eb0601261509p1efca8e4j83fec1a968ebb548@mail.gmail.com>
	 <200601271024.59121.mxhaard@magic.fr>
Message-ID: <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com>

On 1/27/06, michel Xhaard <mxhaard at magic.fr> wrote:
>
> Le Vendredi 27 Janvier 2006 00:09, Binary Xerroz a ?crit:
> > Hi Laurent,
> >
> > Yes, upon further looking into the aMSN source code i have discovered
> the
> > lovely C code :-D
> >
> > lol, however, i still cannot seem to find what i need, or again, where
> to
> > start.
> Seem amsn now use libng from the xawtv package you need to add a converter
> for
> the MJPEG palette and uncomment the YUYV converter (untested)  set in the
> libng package (I am looking at the CVS code). You can get the MJPEG
> converter
> from uvcview in the utils.c file.


im currently looking through the libng source code (included in the CVS
version of aMSN, utils/linux/capture/libng), and i really dont know where to
start. I cant find (or  just blind to) the YUYV converter in the code, and
assuming i can find it, still not sure where to put the mjpeg decoder

> Also, you say it supports YUYV, am i not correct in assuming the output of
> > the driver is in either format, MJPEG or YUYV? i thought i saw something
> of
> > the sort in uvcview, although i am not certain what it was. assuming it
> > does. then why cannot the program access it correctly, and if it
> cant..well
> > i guess i have to figure out how to add it.
> uvcview in YUYV grab the stream and forward to the display
> in MJPEG add the missing Huffman table, decompress the jpeg picture to
> YUYV
> and forward to the display.


so are you saying, you would have to take the mjpeg stream, add the huffman
table, decompress it into yuyv, then it would be acceptable format for the
webcam?

if this is the case, would it not be more, um, economical, to then just have
a userland application, which decompresses the stream, and then sends it
back as another v4l2 device? is this even possible? if so, how do you go
about it all?

> Also, heh, i have snooped around the amsn project pages, but they dont
> have
> > any mailing list to send requests to, and lol have not figured out how
> to
> > on SF.com so hmm.
> #amsn on irc.freenode.net
>
> http://amsn.sourceforge.net/forums/viewforum.php?f=8&sid=0f2fc183f3ae3a339d4ad056868dbebd
> > On 1/26/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > > Hi Tanner,
> > >
> > > > Hmm, ill look into gnomemeeting (its emering now). however my
> primary
> > > > interest is aMSN and its msn (obviously heh) webcam.
> > > > The application supports v4l (v4l2?) and can even see my device,
> listed
> > >
> > > as
> > >
> > > > 'V4L-2: ', and when clicked on, displays a 'Error getting
> capabilities'
> > > > message. once engaged in the conversation the light on my camera
> will
> > > > start, but it never seems to be working.
> > >
> > > After a quick look at the source code, aMSN seems to support V4L2 and
> > > YUYV but
> > > not MJPEG. As I have no MSN account there is no way I can test the
> > > software.
> > > Have you tried asking the aMSN developers for support ?
> > >
> > > > I have tried to look through the source code of both uvcview, and
> amsn.
> > > > aMSN is in tcl (apparent thanks to the extention) and heh, i have no
> > >
> > > idea
> > >
> > > > how to work with that, let alone convert the source from uvcview.
> > >
> > > Some parts are implemented in tcl, but image capture is implemented in
> > > plain
> > > old C.
> > >
> > > > To be honest, i have no idea how it will be possible to integrate
> what
> > > > i need into aMSN, or even where to start =\
> > >
> > > Have a look at utils/linux/capture
> > >
> > > Regarding xawtv, I'll try to see if I can get it working with the
> > > linux-uvc
> > > driver this weekend. Has someone else had any success with xawtv so
> far ?
> > >
> > > Laurent Pinchart
> --
> Michel Xhaard
> http://mxhaard.free.fr
>


Tanner
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060127/2e050b8f/attachment.html>

From diaxen at free.fr  Sat Jan 28 06:25:48 2006
From: diaxen at free.fr (Alexandre Becoulet)
Date: Sat, 28 Jan 2006 06:25:48 +0100
Subject: [Linux-uvc-devel] [PATCH] device open counter
Message-ID: <200601280625.48829.diaxen@free.fr>

Hello,

I wrote a quick patch to prevent device open more than once. This will prevent 
kernel crash with the current driver.

--- uvc/uvcvideo.c	2006-01-28 04:39:39.000000000 +0100
+++ uvc2/uvcvideo.c	2006-01-28 04:30:48.000000000 +0100
@@ -295,6 +295,7 @@
 };
 
 struct uvc_video_device {
+	int count;
 	struct uvc_device *dev;
 	struct video_device *vdev;
 
@@ -1543,6 +1544,7 @@
 
 	video->streaming->cur_format = format;
 	video->streaming->cur_frame = frame;
+	video->count = 0;
 
 	return 0;
 }
@@ -1868,13 +1870,24 @@
 	video = video_get_drvdata(vdev);
 
 	if (video->dev->state & UVC_DEV_DISCONNECTED) {
+		uvc_printk(KERN_DEBUG, "uvc_v4l2_open failed: disconnected\n");
 		up(&dev_sem);
 		return -ENODEV;
 	}
 
+	if (video->count > 0) {
+		uvc_printk(KERN_DEBUG, "uvc_v4l2_open failed: count = %u\n", video->count);
+		up(&dev_sem);
+		return -EBUSY;
+	}
+
+	video->count++;
+
 	kref_get(&video->dev->kref);
 	up(&dev_sem);
 
+	uvc_printk(KERN_DEBUG, "uvc_v4l2_open done\n");
+
 	return 0;
 }
 
@@ -1891,7 +1904,11 @@
 		uvc_printk(KERN_DEBUG, "uvc_v4l2_release: Unable to free buffers.\n");
 	up(&video->queue.lock);
 
+	down(&dev_sem);
 	kref_put(&video->dev->kref, uvc_delete);
+	video->count--;
+	up(&dev_sem);
+
 	uvc_printk(KERN_DEBUG, "< uvc_v4l2_release\n");
 	return 0;
 }

-- 
Alexandre


From scoutts at bcs.org.uk  Sat Jan 28 10:42:55 2006
From: scoutts at bcs.org.uk (Steven Coutts)
Date: Sat, 28 Jan 2006 09:42:55 +0000
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <1138397258.11355.13.camel@yossarian>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191545.11412.scoutts@bcs.org.uk> <1138397258.11355.13.camel@yossarian>
Message-ID: <200601280942.58108.scoutts@bcs.org.uk>

On Friday 27 January 2006 21:27, Mikael Nilsson wrote:
> I see this too, with a QC Fusion on  Dell Inspiron 8200. Is it possible
> that it has to do with my USB 1.1-only port?
>
> /Mikael
> ====================================================0
> uvcview verion 0.1.3
> Video driver: x11
> A window manager is available
> video /dev/video0
> X Error of failed request:  BadMatch (invalid parameter attributes)
>   Major opcode of failed request:  142 (XVideo)
>   Minor opcode of failed request:  19 ()
>   Serial number of failed request:  23
>   Current serial number in output stream:  24
>

Mine was on a Dell Optiplex GX270, works fine on a Latitude D600.

Regards

-- 
Steven Coutts B.Sc.(Hons) MBCS
scoutts at bcs.org.uk

PGP Public Key
<http://stevec.couttsnet.com/scoutts.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060128/812f7630/attachment.pgp>

From laurent.pinchart at skynet.be  Sat Jan 28 17:03:40 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Sat, 28 Jan 2006 17:03:40 +0100
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <1138397258.11355.13.camel@yossarian>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601191545.11412.scoutts@bcs.org.uk> <1138397258.11355.13.camel@yossarian>
Message-ID: <200601281703.40389.laurent.pinchart@skynet.be>

Hi Mikael,

> I see this too, with a QC Fusion on  Dell Inspiron 8200. Is it possible
> that it has to do with my USB 1.1-only port?
[snip]

> usb 1-1: new full speed USB device using uhci_hcd and address 7

UHCI and OHCI are USB 1.1 controllers. The USB 2.0 controller is called EHCI. 
So this is definitely a USB 1.1 issue.

Laurent Pinchart


From rvinyard at cs.nmsu.edu  Sat Jan 28 17:40:52 2006
From: rvinyard at cs.nmsu.edu (Rick L Vinyard Jr)
Date: Sat, 28 Jan 2006 09:40:52 -0700
Subject: [Linux-uvc-devel] Anyone already working on pan and tilt control?
In-Reply-To: <200601280625.48829.diaxen@free.fr>
References: <200601280625.48829.diaxen@free.fr>
Message-ID: <1138466452.13376.2.camel@fangorn.local>

Just wondering if anyone is already working on pan and tilt control, and
if so what the status is?

If it hasn't been started, perhaps I can help out.



From mini at nada.kth.se  Sat Jan 28 21:18:15 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Sat, 28 Jan 2006 21:18:15 +0100
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601281703.40389.laurent.pinchart@skynet.be>
References: <200601191350.50916.scoutts@bcs.org.uk>
	 <200601191545.11412.scoutts@bcs.org.uk>
	 <1138397258.11355.13.camel@yossarian>
	 <200601281703.40389.laurent.pinchart@skynet.be>
Message-ID: <1138479496.11704.2.camel@yossarian>

l?r 2006-01-28 klockan 17:03 +0100 skrev Laurent Pinchart:
> Hi Mikael,
> 
> > I see this too, with a QC Fusion on  Dell Inspiron 8200. Is it possible
> > that it has to do with my USB 1.1-only port?
> [snip]
> 
> > usb 1-1: new full speed USB device using uhci_hcd and address 7
> 
> UHCI and OHCI are USB 1.1 controllers. The USB 2.0 controller is called EHCI. 
> So this is definitely a USB 1.1 issue.
> 


Well, then it seems Steven Coutts (who originated this thread) actually
has a USB2 controller:
 
usb 1-1: new high speed USB device using ehci_hcd and address 6

so it does *not* seem to be a USB1.1 issue after all.

The strange thing is that test.c works fine.

/Mikael

> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
-- 
Plus ?a change, plus c'est la m?me chose



From mxhaard at magic.fr  Sat Jan 28 21:34:43 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Sat, 28 Jan 2006 21:34:43 +0100
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <1138479496.11704.2.camel@yossarian>
References: <200601191350.50916.scoutts@bcs.org.uk> <200601281703.40389.laurent.pinchart@skynet.be> <1138479496.11704.2.camel@yossarian>
Message-ID: <200601282134.43847.mxhaard@magic.fr>

Le Samedi 28 Janvier 2006 21:18, Mikael Nilsson a ?crit?:
> l?r 2006-01-28 klockan 17:03 +0100 skrev Laurent Pinchart:
> > Hi Mikael,
> >
> > > I see this too, with a QC Fusion on  Dell Inspiron 8200. Is it possible
> > > that it has to do with my USB 1.1-only port?
> >
> > [snip]
> >
> > > usb 1-1: new full speed USB device using uhci_hcd and address 7
> >
> > UHCI and OHCI are USB 1.1 controllers. The USB 2.0 controller is called
> > EHCI. So this is definitely a USB 1.1 issue.
>
> Well, then it seems Steven Coutts (who originated this thread) actually
> has a USB2 controller:
>
> usb 1-1: new high speed USB device using ehci_hcd and address 6
>
> so it does *not* seem to be a USB1.1 issue after all.
>
> The strange thing is that test.c works fine.
>
> /Mikael
>
> > Laurent Pinchart
> > _______________________________________________

test.c did not alloc overlay surface for the screen and nor xv feature from 
the video adaptator. uvcvideo need a working video adaptator Xserver or Fbdev 
allowing large video surface to be create 1280x960. 
-- 
Michel Xhaard
http://mxhaard.free.fr


From mini at nada.kth.se  Sat Jan 28 23:11:36 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Sat, 28 Jan 2006 23:11:36 +0100
Subject: [Linux-uvc-devel] Quickcam Pro 5000
In-Reply-To: <200601282134.43847.mxhaard@magic.fr>
References: <200601191350.50916.scoutts@bcs.org.uk>
	 <200601281703.40389.laurent.pinchart@skynet.be>
	 <1138479496.11704.2.camel@yossarian>  <200601282134.43847.mxhaard@magic.fr>
Message-ID: <1138486297.11704.5.camel@yossarian>

l?r 2006-01-28 klockan 21:34 +0100 skrev michel Xhaard:
> 
> test.c did not alloc overlay surface for the screen and nor xv feature from 
> the video adaptator. uvcvideo need a working video adaptator Xserver or Fbdev 
> allowing large video surface to be create 1280x960. 

Ok, so you think it's an issue with my video driver? I'm on a GeForce4
440 Go, using the proprietary nvidia driver, most recent version.
Shouldn't it be able to support that? I mean, I can run "mplayer -vo
xv ..." fullscreen, i.e. 1600x1200, so I can't see why this should not
work...

Anything I can do to test this?

/Mikael

-- 
Plus ?a change, plus c'est la m?me chose



From linux-related at web.de  Sun Jan 29 22:13:52 2006
From: linux-related at web.de (Matthias Jauernig)
Date: Sun, 29 Jan 2006 22:13:52 +0100
Subject: [Linux-uvc-devel] Problems with QC 5000 Pro, Ubuntu 5.1, 2.6.12-10-386
Message-ID: <43DD3010.30100@web.de>

Hello there.

I have got a Logitech Quickcam 5000 Pro and want to use it under linux - 
thus I found and downloaded your driver.

I compiled it using Ubuntu Linux 5.1, kernel 2.6.12-10-386, compilation 
and installation worked fine without warnings.
But the driver seems to fail on my configuration.

If I'm connecting the QC 5000, dmesg output is:
=====
[4296804.731000] usb 3-2: new high speed USB device using ehci_hcd and 
address 7[4296805.114000] usbvideo: Probing device 2
[4296805.115000] Format MJPEG found
[4296805.115000] Format Uncompressed found
[4296805.116000] usbvideo: Found a Status endpoint (addr 87).
[4296805.116000] usbvideo: Found UVC device (1.00)
[4296805.117000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3 
<- Unit 2 <- IT 1
[4296805.117000] usbvideo: Found a valid video chain (1 -> 5).
[4296805.213000] usbvideo: UVC device initialized.
=====

With your test program posted in 
https://lists.berlios.de/pipermail/linux-uvc-devel/2006-January/000003.html 
using "test /dev/video0" I'm getting the output:
=====
#Device /dev/video0 opened: .
Video format set: width: 640 height: 480 buffer size: 614400
16 buffers allocated.
length: 614400 offset: 0
Buffer 0 mapped at address 0xb7c63000.
length: 614400 offset: 614400
Buffer 1 mapped at address 0xb7bcd000.
length: 614400 offset: 1228800
Buffer 2 mapped at address 0xb7b37000.
length: 614400 offset: 1843200
Buffer 3 mapped at address 0xb7aa1000.
length: 614400 offset: 2457600
Buffer 4 mapped at address 0xb7a0b000.
length: 614400 offset: 3072000
Buffer 5 mapped at address 0xb7975000.
length: 614400 offset: 3686400
Buffer 6 mapped at address 0xb78df000.
length: 614400 offset: 4300800
Buffer 7 mapped at address 0xb7849000.
length: 614400 offset: 4915200
Buffer 8 mapped at address 0xb77b3000.
length: 614400 offset: 5529600
Buffer 9 mapped at address 0xb771d000.
length: 614400 offset: 6144000
Buffer 10 mapped at address 0xb7687000.
length: 614400 offset: 6758400
Buffer 11 mapped at address 0xb75f1000.
length: 614400 offset: 7372800
Buffer 12 mapped at address 0xb755b000.
length: 614400 offset: 7987200
Buffer 13 mapped at address 0xb74c5000.
length: 614400 offset: 8601600
Buffer 14 mapped at address 0xb742f000.
length: 614400 offset: 9216000
Buffer 15 mapped at address 0xb7399000.
Unable to dequeue buffer (5).
=====

I'm getting no output images from the cam, here's the dmesg output:
=====
[4297530.434000] usbvideo: uvc_v4l2_open
[4297530.447000] usbvideo: VIDIOC_QUERYCAP
[4297530.453000] usbvideo: VIDIOC_S_FMT
[4297530.453000] usbvideo: Trying format 0x56595559 (YUYV): 1280x960.
[4297530.531000] usbvideo: VIDIOC_REQBUFS
[4297530.594000] usbvideo: VIDIOC_QUERYBUF
[4297530.633000] usbvideo: uvc_v4l2_mmap
[4297530.693000] usbvideo: VIDIOC_QUERYBUF
[4297530.730000] usbvideo: uvc_v4l2_mmap
[4297530.777000] usbvideo: VIDIOC_QUERYBUF
[4297530.816000] usbvideo: uvc_v4l2_mmap
[4297530.857000] usbvideo: VIDIOC_QUERYBUF
[4297530.903000] usbvideo: uvc_v4l2_mmap
[4297530.940000] usbvideo: VIDIOC_QUERYBUF
[4297530.986000] usbvideo: uvc_v4l2_mmap
[4297531.025000] usbvideo: VIDIOC_QUERYBUF
[4297531.060000] usbvideo: uvc_v4l2_mmap
[4297531.107000] usbvideo: VIDIOC_QUERYBUF
[4297531.108000] usbvideo: uvc_v4l2_mmap
[4297531.109000] usbvideo: VIDIOC_QUERYBUF
[4297531.189000] usbvideo: uvc_v4l2_mmap
[4297531.192000] usbvideo: VIDIOC_QUERYBUF
[4297531.239000] usbvideo: uvc_v4l2_mmap
[4297531.275000] usbvideo: VIDIOC_QUERYBUF
[4297531.276000] usbvideo: uvc_v4l2_mmap
[4297531.318000] usbvideo: VIDIOC_QUERYBUF
[4297531.320000] usbvideo: uvc_v4l2_mmap
[4297531.362000] usbvideo: VIDIOC_QUERYBUF
[4297531.363000] usbvideo: uvc_v4l2_mmap
[4297531.363000] usbvideo: VIDIOC_QUERYBUF
[4297531.363000] usbvideo: uvc_v4l2_mmap
[4297531.406000] usbvideo: VIDIOC_QUERYBUF
[4297531.406000] usbvideo: uvc_v4l2_mmap
[4297531.448000] usbvideo: VIDIOC_QUERYBUF
[4297531.448000] usbvideo: uvc_v4l2_mmap
[4297531.484000] usbvideo: VIDIOC_QUERYBUF
[4297531.485000] usbvideo: uvc_v4l2_mmap
[4297531.532000] usbvideo: VIDIOC_STREAMON
[4297531.982000] usbvideo: > uvc_v4l2_release
[4297532.060000] usbvideo: < uvc_v4l2_release
=====

Could you help me? It's very important to realize an university roboter 
project using the qc 5000.
Thx for your great work!

Regards, Matthias
---
Leipzig, Germany


From mxhaard at magic.fr  Sun Jan 29 23:00:36 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Sun, 29 Jan 2006 23:00:36 +0100
Subject: [Linux-uvc-devel] Problems with QC 5000 Pro, Ubuntu 5.1, 2.6.12-10-386
In-Reply-To: <43DD3010.30100@web.de>
References: <43DD3010.30100@web.de>
Message-ID: <200601292300.36435.mxhaard@magic.fr>

Le Dimanche 29 Janvier 2006 22:13, Matthias Jauernig a ?crit?:
> Hello there.
>
> I have got a Logitech Quickcam 5000 Pro and want to use it under linux -
> thus I found and downloaded your driver.
>
> I compiled it using Ubuntu Linux 5.1, kernel 2.6.12-10-386, compilation
> and installation worked fine without warnings.
> But the driver seems to fail on my configuration.
>
> If I'm connecting the QC 5000, dmesg output is:
> =====
> [4296804.731000] usb 3-2: new high speed USB device using ehci_hcd and
> address 7[4296805.114000] usbvideo: Probing device 2
> [4296805.115000] Format MJPEG found
> [4296805.115000] Format Uncompressed found
> [4296805.116000] usbvideo: Found a Status endpoint (addr 87).
> [4296805.116000] usbvideo: Found UVC device (1.00)
> [4296805.117000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3
> <- Unit 2 <- IT 1
> [4296805.117000] usbvideo: Found a valid video chain (1 -> 5).
> [4296805.213000] usbvideo: UVC device initialized.
> =====
>
> With your test program posted in
> https://lists.berlios.de/pipermail/linux-uvc-devel/2006-January/000003.html
> using "test /dev/video0" I'm getting the output:
> =====
> #Device /dev/video0 opened: .
> Video format set: width: 640 height: 480 buffer size: 614400
> 16 buffers allocated.
> length: 614400 offset: 0
> Buffer 0 mapped at address 0xb7c63000.
> length: 614400 offset: 614400
> Buffer 1 mapped at address 0xb7bcd000.
> length: 614400 offset: 1228800
> Buffer 2 mapped at address 0xb7b37000.
> length: 614400 offset: 1843200
> Buffer 3 mapped at address 0xb7aa1000.
> length: 614400 offset: 2457600
> Buffer 4 mapped at address 0xb7a0b000.
> length: 614400 offset: 3072000
> Buffer 5 mapped at address 0xb7975000.
> length: 614400 offset: 3686400
> Buffer 6 mapped at address 0xb78df000.
> length: 614400 offset: 4300800
> Buffer 7 mapped at address 0xb7849000.
> length: 614400 offset: 4915200
> Buffer 8 mapped at address 0xb77b3000.
> length: 614400 offset: 5529600
> Buffer 9 mapped at address 0xb771d000.
> length: 614400 offset: 6144000
> Buffer 10 mapped at address 0xb7687000.
> length: 614400 offset: 6758400
> Buffer 11 mapped at address 0xb75f1000.
> length: 614400 offset: 7372800
> Buffer 12 mapped at address 0xb755b000.
> length: 614400 offset: 7987200
> Buffer 13 mapped at address 0xb74c5000.
> length: 614400 offset: 8601600
> Buffer 14 mapped at address 0xb742f000.
> length: 614400 offset: 9216000
> Buffer 15 mapped at address 0xb7399000.
> Unable to dequeue buffer (5).
> =====
>
> I'm getting no output images from the cam, here's the dmesg output:
> =====
> [4297530.434000] usbvideo: uvc_v4l2_open
> [4297530.447000] usbvideo: VIDIOC_QUERYCAP
> [4297530.453000] usbvideo: VIDIOC_S_FMT
> [4297530.453000] usbvideo: Trying format 0x56595559 (YUYV): 1280x960.
> [4297530.531000] usbvideo: VIDIOC_REQBUFS
> [4297530.594000] usbvideo: VIDIOC_QUERYBUF
> [4297530.633000] usbvideo: uvc_v4l2_mmap
> [4297530.693000] usbvideo: VIDIOC_QUERYBUF
> [4297530.730000] usbvideo: uvc_v4l2_mmap
> [4297530.777000] usbvideo: VIDIOC_QUERYBUF
> [4297530.816000] usbvideo: uvc_v4l2_mmap
> [4297530.857000] usbvideo: VIDIOC_QUERYBUF
> [4297530.903000] usbvideo: uvc_v4l2_mmap
> [4297530.940000] usbvideo: VIDIOC_QUERYBUF
> [4297530.986000] usbvideo: uvc_v4l2_mmap
> [4297531.025000] usbvideo: VIDIOC_QUERYBUF
> [4297531.060000] usbvideo: uvc_v4l2_mmap
> [4297531.107000] usbvideo: VIDIOC_QUERYBUF
> [4297531.108000] usbvideo: uvc_v4l2_mmap
> [4297531.109000] usbvideo: VIDIOC_QUERYBUF
> [4297531.189000] usbvideo: uvc_v4l2_mmap
> [4297531.192000] usbvideo: VIDIOC_QUERYBUF
> [4297531.239000] usbvideo: uvc_v4l2_mmap
> [4297531.275000] usbvideo: VIDIOC_QUERYBUF
> [4297531.276000] usbvideo: uvc_v4l2_mmap
> [4297531.318000] usbvideo: VIDIOC_QUERYBUF
> [4297531.320000] usbvideo: uvc_v4l2_mmap
> [4297531.362000] usbvideo: VIDIOC_QUERYBUF
> [4297531.363000] usbvideo: uvc_v4l2_mmap
> [4297531.363000] usbvideo: VIDIOC_QUERYBUF
> [4297531.363000] usbvideo: uvc_v4l2_mmap
> [4297531.406000] usbvideo: VIDIOC_QUERYBUF
> [4297531.406000] usbvideo: uvc_v4l2_mmap
> [4297531.448000] usbvideo: VIDIOC_QUERYBUF
> [4297531.448000] usbvideo: uvc_v4l2_mmap
> [4297531.484000] usbvideo: VIDIOC_QUERYBUF
> [4297531.485000] usbvideo: uvc_v4l2_mmap
> [4297531.532000] usbvideo: VIDIOC_STREAMON
> [4297531.982000] usbvideo: > uvc_v4l2_release
> [4297532.060000] usbvideo: < uvc_v4l2_release
> =====
>
> Could you help me? It's very important to realize an university roboter
> project using the qc 5000.
> Thx for your great work!
>
> Regards, Matthias
> ---
> Leipzig, Germany
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
Mathias,
Try uvcview from here:
http://mxhaard.free.fr/spca50x/Investigation/uvc/
I know the name is not good as M$ used the same i will rename to luvcview when 
i get times :)
regards
-- 
Michel Xhaard
http://mxhaard.free.fr


From karlu at itn.liu.se  Mon Jan 30 16:09:19 2006
From: karlu at itn.liu.se (Karljohan Lundin)
Date: Mon, 30 Jan 2006 16:09:19 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <5256d0b0601260835q47da2543y5157ea532552a0b8@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>	 <20060126084104.GN15278@sd291.sivit.org>	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com> <5256d0b0601260835q47da2543y5157ea532552a0b8@mail.gmail.com>
Message-ID: <43DE2C1F.5070301@itn.liu.se>

>> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
>> uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
>> and I have to use 'insmod uvcvideo.ko'.
> 
> You should be able do do a make install which will install it into
> /lib/modules. The a depmod -a to redo the modules then a modprobe
> uvcvideo

I had the same problem using Ubuntu. It seems that the module ends up in
/lib/modules/2.6.12/usb/media/ and not in
/lib/modules/2.6.12-10-686/kernel/drivers/usb/media/ which is the
correct location for the modules with the kernel version I'm currently
running. I will assume that the UVC driver install procedure is correct,
so there is probably some link missing in the default Ubuntu
installation. Anyhow, manually moving the kernel object to the correct
folder makes modprobe and modinfo working.


/ Karljohan Lundin


From luc at saillard.org  Mon Jan 30 16:19:06 2006
From: luc at saillard.org (Luc Saillard)
Date: Mon, 30 Jan 2006 16:19:06 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
Message-ID: <20060130151906.GE20164@sd291.sivit.org>

Since yesterday, we have another application to use with our webcam. I've
made some tests with the logitech fusion on a x86 system. The decoder has
been tested on an ppc system, but not the application, so if someone have the
hardware to test ...


Luc
[1] ekiga: http://ekiga.org/
           http://snapshots.seconix.com/
           http://www.gnomemeeting.org/


From mini at nada.kth.se  Mon Jan 30 16:20:01 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Mon, 30 Jan 2006 16:20:01 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <43DE2C1F.5070301@itn.liu.se>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
	 <5256d0b0601260835q47da2543y5157ea532552a0b8@mail.gmail.com>
	 <43DE2C1F.5070301@itn.liu.se>
Message-ID: <1138634402.11546.66.camel@yossarian>

m?n 2006-01-30 klockan 16:09 +0100 skrev Karljohan Lundin:
> >> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
> >> uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
> >> and I have to use 'insmod uvcvideo.ko'.
> > 
> > You should be able do do a make install which will install it into
> > /lib/modules. The a depmod -a to redo the modules then a modprobe
> > uvcvideo
> 
> I had the same problem using Ubuntu. It seems that the module ends up in
> /lib/modules/2.6.12/usb/media/ and not in
> /lib/modules/2.6.12-10-686/kernel/drivers/usb/media/ which is the
> correct location for the modules with the kernel version I'm currently
> running. I will assume that the UVC driver install procedure is correct,
> so there is probably some link missing in the default Ubuntu
> installation. Anyhow, manually moving the kernel object to the correct
> folder makes modprobe and modinfo working.

The fix for Debian is here:

https://lists.berlios.de/pipermail/linux-uvc-devel/2006-January/000073.html

The missing file is called "localversion".

/Mikael

> 
> 
> / Karljohan Lundin
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
-- 
Plus ?a change, plus c'est la m?me chose



From mini at nada.kth.se  Mon Jan 30 16:24:30 2006
From: mini at nada.kth.se (Mikael Nilsson)
Date: Mon, 30 Jan 2006 16:24:30 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <20060130151906.GE20164@sd291.sivit.org>
References: <20060130151906.GE20164@sd291.sivit.org>
Message-ID: <1138634671.11546.69.camel@yossarian>

Is someone documenting which applications support this driver (or
rather, enough of the v4l2 API) ??

I'd help if the homepage was a wiki. Hint, hint :-)

/Mikael

m?n 2006-01-30 klockan 16:19 +0100 skrev Luc Saillard:
> Since yesterday, we have another application to use with our webcam. I've
> made some tests with the logitech fusion on a x86 system. The decoder has
> been tested on an ppc system, but not the application, so if someone have the
> hardware to test ...
> 
> 
> Luc
> [1] ekiga: http://ekiga.org/
>            http://snapshots.seconix.com/
>            http://www.gnomemeeting.org/
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 
-- 
Plus ?a change, plus c'est la m?me chose



From pbrobinson at gmail.com  Mon Jan 30 16:25:03 2006
From: pbrobinson at gmail.com (Peter Robinson)
Date: Mon, 30 Jan 2006 15:25:03 +0000
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <43DE2C1F.5070301@itn.liu.se>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
	 <5256d0b0601260835q47da2543y5157ea532552a0b8@mail.gmail.com>
	 <43DE2C1F.5070301@itn.liu.se>
Message-ID: <5256d0b0601300725i5e20ac3k123fad05e368a260@mail.gmail.com>

On 1/30/06, Karljohan Lundin <karlu at itn.liu.se> wrote:
>
> >> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
> >> uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
> >> and I have to use 'insmod uvcvideo.ko'.
> >
> > You should be able do do a make install which will install it into
> > /lib/modules. The a depmod -a to redo the modules then a modprobe
> > uvcvideo
>
> I had the same problem using Ubuntu. It seems that the module ends up in
> /lib/modules/2.6.12/usb/media/ and not in
> /lib/modules/2.6.12-10-686/kernel/drivers/usb/media/ which is the
> correct location for the modules with the kernel version I'm currently
> running. I will assume that the UVC driver install procedure is correct,
> so there is probably some link missing in the default Ubuntu
> installation. Anyhow, manually moving the kernel object to the correct
> folder makes modprobe and modinfo working.

In Fedora mine ends up in /lib/modules/2.6.15-1.1819_FC5/usb/media/
whereas is should be /lib/modules/....../kernel/drivers/usb/media/ so
it seems that part of the problem is in the local Makefile, and part
maybe in the distro (or maybe the way the Makefile calculates the
kernel version and hence the /lib/blah location -> what does a 'uname
-a' report  as the kernel version?).

Pete


From tristil at gmail.com  Mon Jan 30 16:35:16 2006
From: tristil at gmail.com (Joseph Method)
Date: Mon, 30 Jan 2006 10:35:16 -0500
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <43DE2C1F.5070301@itn.liu.se>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <20060126084104.GN15278@sd291.sivit.org>
	 <167b6aa00601260644r68ed5380xbe2a547410159eeb@mail.gmail.com>
	 <5256d0b0601260835q47da2543y5157ea532552a0b8@mail.gmail.com>
	 <43DE2C1F.5070301@itn.liu.se>
Message-ID: <167b6aa00601300735h54eb4a78r27c1760b9b7fe27c@mail.gmail.com>

The problem was fixed for me in Dapper :P

On 1/30/06, Karljohan Lundin <karlu at itn.liu.se> wrote:
>
> >> P.S. This is strictly off-topic, but I don't know how to get 'modprobe
> >> uvcvideo' to work; it's in a .../usb/media folder with regular permissions,
> >> and I have to use 'insmod uvcvideo.ko'.
> >
> > You should be able do do a make install which will install it into
> > /lib/modules. The a depmod -a to redo the modules then a modprobe
> > uvcvideo
>
> I had the same problem using Ubuntu. It seems that the module ends up in
> /lib/modules/2.6.12/usb/media/ and not in
> /lib/modules/2.6.12-10-686/kernel/drivers/usb/media/ which is the
> correct location for the modules with the kernel version I'm currently
> running. I will assume that the UVC driver install procedure is correct,
> so there is probably some link missing in the default Ubuntu
> installation. Anyhow, manually moving the kernel object to the correct
> folder makes modprobe and modinfo working.
>
>
> / Karljohan Lundin
>


--
-J. Method


From tristil at gmail.com  Mon Jan 30 16:54:33 2006
From: tristil at gmail.com (Joseph Method)
Date: Mon, 30 Jan 2006 10:54:33 -0500
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <1138634671.11546.69.camel@yossarian>
References: <20060130151906.GE20164@sd291.sivit.org>
	 <1138634671.11546.69.camel@yossarian>
Message-ID: <167b6aa00601300754t783a468ek9439cfea07312e41@mail.gmail.com>

OpenWengo could if it had an MJPEG codec.

---------- Forwarded message ----------
From: Mikael Nilsson <mini at nada.kth.se>
Date: Jan 30, 2006 10:24 AM
Subject: Re: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
To: Luc Saillard <luc at saillard.org>
Cc: linux-uvc-devel at lists.berlios.de


Is someone documenting which applications support this driver (or
rather, enough of the v4l2 API) ??

I'd help if the homepage was a wiki. Hint, hint :-)

/Mikael

m?n 2006-01-30 klockan 16:19 +0100 skrev Luc Saillard:
> Since yesterday, we have another application to use with our webcam. I've
> made some tests with the logitech fusion on a x86 system. The decoder has
> been tested on an ppc system, but not the application, so if someone have the
> hardware to test ...
>
>
> Luc
> [1] ekiga: http://ekiga.org/
>            http://snapshots.seconix.com/
>            http://www.gnomemeeting.org/
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
--
Plus ?a change, plus c'est la m?me chose

_______________________________________________
Linux-uvc-devel mailing list
Linux-uvc-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/linux-uvc-devel


--
-J. Method


From phil at firestorm.cx  Mon Jan 30 17:15:15 2006
From: phil at firestorm.cx (Philip Heron)
Date: Mon, 30 Jan 2006 16:15:15 +0000
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <1138634671.11546.69.camel@yossarian>
References: <20060130151906.GE20164@sd291.sivit.org>
	 <1138634671.11546.69.camel@yossarian>
Message-ID: <1138637715.2991.10.camel@beastie.firestorm.cx>

On Mon, 2006-01-30 at 16:24 +0100, Mikael Nilsson wrote:
> Is someone documenting which applications support this driver (or
> rather, enough of the v4l2 API) ??
> 
> I'd help if the homepage was a wiki. Hint, hint :-)

Hi all,

 The latest test of fswebcam supports V4L2 devices nicely, and in theory
it should handle MJPEG devices although it not well tested beyond the
CPiA2 driver. If anyone would like to test it I can upload a copy to the
website.

-Phil <phil at firestorm.cx>




From szo at ies.hu  Mon Jan 30 17:18:53 2006
From: szo at ies.hu (SZOKOVACS Robert)
Date: Mon, 30 Jan 2006 17:18:53 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <1138637715.2991.10.camel@beastie.firestorm.cx>
References: <20060130151906.GE20164@sd291.sivit.org> <1138634671.11546.69.camel@yossarian> <1138637715.2991.10.camel@beastie.firestorm.cx>
Message-ID: <200601301718.53151.szo@ies.hu>

On Monday 30 January 2006 17:15, Philip Heron wrote:
> On Mon, 2006-01-30 at 16:24 +0100, Mikael Nilsson wrote:
> > Is someone documenting which applications support this driver (or
> > rather, enough of the v4l2 API) ??
> >
> > I'd help if the homepage was a wiki. Hint, hint :-)
>
> Hi all,
>
>  The latest test of fswebcam supports V4L2 devices nicely, and in theory
> it should handle MJPEG devices although it not well tested beyond the
> CPiA2 driver. If anyone would like to test it I can upload a copy to the
> website.

yes please!

br

Szo



From laurent.pinchart at skynet.be  Tue Jan 31 01:13:19 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:13:19 +0100
Subject: [Linux-uvc-devel] [SVN] Made kernel logging more modular
Message-ID: <200601310113.19754.laurent.pinchart@skynet.be>

Hi everybody,

after receiving a few complains from people who didn't like their kernel log 
being overflowed with UVC-related messages, I rewrote the debug messages in 
the driver in a more modular way.

You can now select which classes of messages you want the driver to print by 
modifying the trace parameter, either when loading the module or at runtime 
through /sys/modules/uvcvideo/parameters/trace.

The default settings are much quieter than before.

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 01:15:35 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:15:35 +0100
Subject: [Linux-uvc-devel] Anyone already working on pan and tilt control?
In-Reply-To: <1138466452.13376.2.camel@fangorn.local>
References: <200601280625.48829.diaxen@free.fr> <1138466452.13376.2.camel@fangorn.local>
Message-ID: <200601310115.35454.laurent.pinchart@skynet.be>

Hi Rick,

> Just wondering if anyone is already working on pan and tilt control, and
> if so what the status is?

I currently have no camera to test that feature, so I haven't implemented it 
yet.

> If it hasn't been started, perhaps I can help out.

Feel free to submit a patch :-) The pan/tilt control has been implemented 
using an Extension Unit, so you need the Logitech specs. I'll ask them if I 
can give publish the information you need.

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 01:27:36 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:27:36 +0100
Subject: [Linux-uvc-devel] [PATCH] device open counter
In-Reply-To: <200601280625.48829.diaxen@free.fr>
References: <200601280625.48829.diaxen@free.fr>
Message-ID: <200601310127.36996.laurent.pinchart@skynet.be>

Hi Alexandre,

thanks for the patch. It has been commited (in a slightly modified form).

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 01:32:09 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:32:09 +0100
Subject: [Linux-uvc-devel] Problems with QC 5000 Pro, Ubuntu 5.1, 2.6.12-10-386
In-Reply-To: <43DD3010.30100@web.de>
References: <43DD3010.30100@web.de>
Message-ID: <200601310132.09737.laurent.pinchart@skynet.be>

Hi Matthias,

> I have got a Logitech Quickcam 5000 Pro and want to use it under linux -
> thus I found and downloaded your driver.
>
> I compiled it using Ubuntu Linux 5.1, kernel 2.6.12-10-386, compilation
> and installation worked fine without warnings.
> But the driver seems to fail on my configuration.
>
> If I'm connecting the QC 5000, dmesg output is:
> =====
> [4296804.731000] usb 3-2: new high speed USB device using ehci_hcd and
> address 7[4296805.114000] usbvideo: Probing device 2
> [4296805.115000] Format MJPEG found
> [4296805.115000] Format Uncompressed found
> [4296805.116000] usbvideo: Found a Status endpoint (addr 87).
> [4296805.116000] usbvideo: Found UVC device (1.00)
> [4296805.117000] usbvideo: Scanning UVC chain: OT 5 <- Unit 4 <- Unit 3
> <- Unit 2 <- IT 1
> [4296805.117000] usbvideo: Found a valid video chain (1 -> 5).
> [4296805.213000] usbvideo: UVC device initialized.
> =====

The device is properly detected as an USB 2.0 peripheral. That's good.

> With your test program posted in
> https://lists.berlios.de/pipermail/linux-uvc-devel/2006-January/000003.html
> using "test /dev/video0" I'm getting the output:
> =====
> #Device /dev/video0 opened: .
> Video format set: width: 640 height: 480 buffer size: 614400
> 16 buffers allocated.
[snip]
> Unable to dequeue buffer (5).
> =====

That's not good.

> I'm getting no output images from the cam, here's the dmesg output:
> =====
> [4297530.434000] usbvideo: uvc_v4l2_open
> [4297530.447000] usbvideo: VIDIOC_QUERYCAP
> [4297530.453000] usbvideo: VIDIOC_S_FMT
> [4297530.453000] usbvideo: Trying format 0x56595559 (YUYV): 1280x960.
> [4297530.531000] usbvideo: VIDIOC_REQBUFS
[snip]
> [4297531.532000] usbvideo: VIDIOC_STREAMON
> [4297531.982000] usbvideo: > uvc_v4l2_release
> [4297532.060000] usbvideo: < uvc_v4l2_release
> =====

Could you try with the latest driver ? Insert the driver and enable capture 
messages with

echo -n 16 > /sys/modules/uvcvideo/parameters/trace

If it fails, try with a newer kernel (2.6.15 or newer). If it still fails, 
please post your dmesg output after running the test program.

> Could you help me? It's very important to realize an university roboter
> project using the qc 5000.

Just a wild guess, will you compete for Eurobot 2006 ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 01:35:06 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:35:06 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <1138634671.11546.69.camel@yossarian>
References: <20060130151906.GE20164@sd291.sivit.org> <1138634671.11546.69.camel@yossarian>
Message-ID: <200601310135.06900.laurent.pinchart@skynet.be>

> Is someone documenting which applications support this driver (or
> rather, enough of the v4l2 API) ??
>
> I'd help if the homepage was a wiki. Hint, hint :-)

Unfortunately I don't currently have time to setup and administrate a wiki. 
Unless someone wants to take the job of webmaster, the website will stay a 
static web page for now. I will try to add a table with supported 
applications if I find some time to do it this week.

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 01:36:00 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:36:00 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <20060130151906.GE20164@sd291.sivit.org>
References: <20060130151906.GE20164@sd291.sivit.org>
Message-ID: <200601310136.00788.laurent.pinchart@skynet.be>

> Since yesterday, we have another application to use with our webcam. I've
> made some tests with the logitech fusion on a x86 system. The decoder has
> been tested on an ppc system, but not the application, so if someone have
> the hardware to test ...

Great ! Thanks for your work Luc. I will test Ekiga before the end of the 
week.

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 01:52:47 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 01:52:47 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601271024.59121.mxhaard@magic.fr> <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com>
Message-ID: <200601310152.47527.laurent.pinchart@skynet.be>

> im currently looking through the libng source code (included in the CVS
> version of aMSN, utils/linux/capture/libng), and i really dont know where
> to start. I cant find (or  just blind to) the YUYV converter in the code,
> and assuming i can find it, still not sure where to put the mjpeg decoder

Try to ask the aMSN developers.

> so are you saying, you would have to take the mjpeg stream, add the huffman
> table, decompress it into yuyv, then it would be acceptable format for the
> webcam?

The webcam produces MJPEG data (JPEG without Huffman tables). To display the 
image on screen, you need to decompress it. The user space application which 
captures the video must implement MJPEG decompression.

> if this is the case, would it not be more, um, economical, to then just
> have a userland application, which decompresses the stream, and then sends
> it back as another v4l2 device? is this even possible? if so, how do you go
> about it all?

The best solution to that problem would probably to have a v4l user-space 
library which would handle decompression in user-space (this would also have 
the benefit to make user-space drivers possible).

Laurent Pinchart


From tristil at gmail.com  Tue Jan 31 02:07:14 2006
From: tristil at gmail.com (Joseph Method)
Date: Mon, 30 Jan 2006 20:07:14 -0500
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <200601310135.06900.laurent.pinchart@skynet.be>
References: <20060130151906.GE20164@sd291.sivit.org>
	 <1138634671.11546.69.camel@yossarian>
	 <200601310135.06900.laurent.pinchart@skynet.be>
Message-ID: <167b6aa00601301707p7d8f2229ib8e60d2e4ef2d2d5@mail.gmail.com>

Are you committed to keeping the berlios URL for the front page? Or is
their hosting such that it could spoof another server? But yeah, I'd
set up a MediaWiki or a MoinMoin... An alternate method would be to
version control the html files and accept patches.

On 1/30/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > Is someone documenting which applications support this driver (or
> > rather, enough of the v4l2 API) ??
> >
> > I'd help if the homepage was a wiki. Hint, hint :-)
>
> Unfortunately I don't currently have time to setup and administrate a wiki.
> Unless someone wants to take the job of webmaster, the website will stay a
> static web page for now. I will try to add a table with supported
> applications if I find some time to do it this week.
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


--
-J. Method


From mxhaard at magic.fr  Tue Jan 31 08:49:08 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Tue, 31 Jan 2006 08:49:08 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <20060130151906.GE20164@sd291.sivit.org>
References: <20060130151906.GE20164@sd291.sivit.org>
Message-ID: <200601310849.08429.mxhaard@magic.fr>

Le Lundi 30 Janvier 2006 16:19, Luc Saillard a ?crit?:
> Since yesterday, we have another application to use with our webcam. I've
> made some tests with the logitech fusion on a x86 system. The decoder has
> been tested on an ppc system, but not the application, so if someone have
> the hardware to test ...
>
>
> Luc
> [1] ekiga: http://ekiga.org/
>            http://snapshots.seconix.com/
>            http://www.gnomemeeting.org/
Luc,
Cool , congratulation :) I am trying to compile the whole dependancies to get 
EKiga working. My Suse gnome setting seem missing some usefull lib :( 
Did you know where libebook come from ?
Regards 
-- 
Michel Xhaard
http://mxhaard.free.fr


From pbrobinson at gmail.com  Tue Jan 31 09:03:52 2006
From: pbrobinson at gmail.com (Peter Robinson)
Date: Tue, 31 Jan 2006 08:03:52 +0000
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <200601310849.08429.mxhaard@magic.fr>
References: <20060130151906.GE20164@sd291.sivit.org>
	 <200601310849.08429.mxhaard@magic.fr>
Message-ID: <5256d0b0601310003o11b353bcjcd5e20dce40a3305@mail.gmail.com>

On 1/31/06, michel Xhaard <mxhaard at magic.fr> wrote:
> Le Lundi 30 Janvier 2006 16:19, Luc Saillard a ?crit:
> > Since yesterday, we have another application to use with our webcam. I've
> > made some tests with the logitech fusion on a x86 system. The decoder has
> > been tested on an ppc system, but not the application, so if someone have
> > the hardware to test ...
> >
> >
> > Luc
> > [1] ekiga: http://ekiga.org/
> >            http://snapshots.seconix.com/
> >            http://www.gnomemeeting.org/
> Luc,
> Cool , congratulation :) I am trying to compile the whole dependancies to get
> EKiga working. My Suse gnome setting seem missing some usefull lib :(
> Did you know where libebook come from ?
> Regards

Evolution-data-server (and you'll need the -devel rpm too)

Pete


From luc at saillard.org  Tue Jan 31 09:21:31 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 09:21:31 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <200601310849.08429.mxhaard@magic.fr>
References: <20060130151906.GE20164@sd291.sivit.org> <200601310849.08429.mxhaard@magic.fr>
Message-ID: <20060131082131.GD25759@sd291.sivit.org>

On Tue, Jan 31, 2006 at 08:49:08AM +0100, michel Xhaard wrote:
> Le Lundi 30 Janvier 2006 16:19, Luc Saillard a ?crit?:
> > Since yesterday, we have another application to use with our webcam. I've
> > made some tests with the logitech fusion on a x86 system. The decoder has
> > been tested on an ppc system, but not the application, so if someone have
> > the hardware to test ...

> Luc,
> Cool , congratulation :) I am trying to compile the whole dependancies to get 
> EKiga working. My Suse gnome setting seem missing some usefull lib :( 
> Did you know where libebook come from ?
 
in evolution-data-xxx.

Some people have (recently) build ekiga without gnome support. ...

Luc


From luc at saillard.org  Tue Jan 31 09:33:00 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 09:33:00 +0100
Subject: [Linux-uvc-devel] [SVN] Made kernel logging more modular
In-Reply-To: <200601310113.19754.laurent.pinchart@skynet.be>
References: <200601310113.19754.laurent.pinchart@skynet.be>
Message-ID: <20060131083300.GE25759@sd291.sivit.org>

On Tue, Jan 31, 2006 at 01:13:19AM +0100, Laurent Pinchart wrote:
> Hi everybody,
> 
> after receiving a few complains from people who didn't like their kernel log 
> being overflowed with UVC-related messages, I rewrote the debug messages in 
> the driver in a more modular way.
> 
> You can now select which classes of messages you want the driver to print by 
> modifying the trace parameter, either when loading the module or at runtime 
> through /sys/modules/uvcvideo/parameters/trace.
 
Is it possible to add a new trace to be able to see the resolution supported
by the webcam. Sometimes the YUYV format is not reported because i've a mouse
on the same usb bus, or i don't remember the resolution.

Why not return -ENOBUFS when the queue is empty (when dequeing frame) ?
Please see the path attached.

Luc


From luc at saillard.org  Tue Jan 31 09:39:17 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 09:39:17 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601310152.47527.laurent.pinchart@skynet.be>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601271024.59121.mxhaard@magic.fr> <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com> <200601310152.47527.laurent.pinchart@skynet.be>
Message-ID: <20060131083917.GF25759@sd291.sivit.org>

On Tue, Jan 31, 2006 at 01:52:47AM +0100, Laurent Pinchart wrote:
> > im currently looking through the libng source code (included in the CVS
> > version of aMSN, utils/linux/capture/libng), and i really dont know where
> > to start. I cant find (or  just blind to) the YUYV converter in the code,
> > and assuming i can find it, still not sure where to put the mjpeg decoder
> 
> Try to ask the aMSN developers.
> 
> The best solution to that problem would probably to have a v4l user-space 
> library which would handle decompression in user-space (this would also have 
> the benefit to make user-space drivers possible).
> 
 
I'm currently trying to change my libpwc to be able to decompress the MJPEG
buffer and convert it in YUV420P or RGB24. So perhaps one day, we will have a
v4l2 library like in the alsa world. As i've a pretty small decoder, this can
be embeded in a lot of applications. But i don't known if more developper
will want to use the tiny library, so for the moment, it's just a small
pixel format convertion library.

Luc


From laurent.pinchart at skynet.be  Tue Jan 31 10:21:20 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 10:21:20 +0100
Subject: [Linux-uvc-devel] [SVN] Made kernel logging more modular
In-Reply-To: <20060131083300.GE25759@sd291.sivit.org>
References: <200601310113.19754.laurent.pinchart@skynet.be> <20060131083300.GE25759@sd291.sivit.org>
Message-ID: <200601311021.20633.laurent.pinchart@skynet.be>

> Is it possible to add a new trace to be able to see the resolution
> supported by the webcam. Sometimes the YUYV format is not reported because
> i've a mouse on the same usb bus, or i don't remember the resolution.

> Why not return -ENOBUFS when the queue is empty (when dequeing frame) ?
> Please see the path attached.

(From the V4L2 specs, VIDIOC_DQBUF)

EINVAL
    The buffer type is not supported, or the index is out of bounds, or no
    buffers have been allocated yet, or the userptr or length are invalid.

That's why :-)

I'll add the supported resolutions to the UVC_TRACE_DESCR trace. You can also 
use lsusb to read the USB descriptors directly.

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 10:23:53 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 10:23:53 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <20060131083917.GF25759@sd291.sivit.org>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601310152.47527.laurent.pinchart@skynet.be> <20060131083917.GF25759@sd291.sivit.org>
Message-ID: <200601311023.53707.laurent.pinchart@skynet.be>

> > > im currently looking through the libng source code (included in the CVS
> > > version of aMSN, utils/linux/capture/libng), and i really dont know
> > > where to start. I cant find (or  just blind to) the YUYV converter in
> > > the code, and assuming i can find it, still not sure where to put the
> > > mjpeg decoder
> >
> > Try to ask the aMSN developers.
> >
> > The best solution to that problem would probably to have a v4l user-space
> > library which would handle decompression in user-space (this would also
> > have the benefit to make user-space drivers possible).
>
> I'm currently trying to change my libpwc to be able to decompress the MJPEG
> buffer and convert it in YUV420P or RGB24. So perhaps one day, we will have
> a v4l2 library like in the alsa world. As i've a pretty small decoder, this
> can be embeded in a lot of applications. But i don't known if more
> developper will want to use the tiny library, so for the moment, it's just
> a small pixel format convertion library.

Should we raise the topic on the video4linux mailing list ?

Laurent Pinchart


From laurent.pinchart at skynet.be  Tue Jan 31 10:28:26 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 10:28:26 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <167b6aa00601301707p7d8f2229ib8e60d2e4ef2d2d5@mail.gmail.com>
References: <20060130151906.GE20164@sd291.sivit.org> <200601310135.06900.laurent.pinchart@skynet.be> <167b6aa00601301707p7d8f2229ib8e60d2e4ef2d2d5@mail.gmail.com>
Message-ID: <200601311028.26943.laurent.pinchart@skynet.be>

> Are you committed to keeping the berlios URL for the front page? Or is
> their hosting such that it could spoof another server? But yeah, I'd
> set up a MediaWiki or a MoinMoin... An alternate method would be to
> version control the html files and accept patches.

We could move away from Berlios for web site hosting, but that would mean 
registering a domain name and finding other hosting facilities. I'd rather 
avoid that if possible. Berlios provides a wiki that we could use at 
http://openfacts.berlios.de/index-en.phtml?title=Linux+UVC. I'm not sure it 
would be the best solution though.

Laurent Pinchart


From tristil at gmail.com  Tue Jan 31 15:52:32 2006
From: tristil at gmail.com (Joseph Method)
Date: Tue, 31 Jan 2006 09:52:32 -0500
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <200601311028.26943.laurent.pinchart@skynet.be>
References: <20060130151906.GE20164@sd291.sivit.org>
	 <200601310135.06900.laurent.pinchart@skynet.be>
	 <167b6aa00601301707p7d8f2229ib8e60d2e4ef2d2d5@mail.gmail.com>
	 <200601311028.26943.laurent.pinchart@skynet.be>
Message-ID: <167b6aa00601310652n34396c26ga6e2e10577c69981@mail.gmail.com>

What about the versioning idea? Would Berlios allow this? What I mean
is open up a project in the svn repository for the website itself.
Then you can easily delegate the responsibility of evaluating patches
to someone you trust to give svn commit rights to.

On 1/31/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
> > Are you committed to keeping the berlios URL for the front page? Or is
> > their hosting such that it could spoof another server? But yeah, I'd
> > set up a MediaWiki or a MoinMoin... An alternate method would be to
> > version control the html files and accept patches.
>
> We could move away from Berlios for web site hosting, but that would mean
> registering a domain name and finding other hosting facilities. I'd rather
> avoid that if possible. Berlios provides a wiki that we could use at
> http://openfacts.berlios.de/index-en.phtml?title=Linux+UVC. I'm not sure it
> would be the best solution though.
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


--
-J. Method


From bxerroz at gmail.com  Tue Jan 31 16:59:36 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Tue, 31 Jan 2006 07:59:36 -0800
Subject: [Linux-uvc-devel] uvcStreamer 0.1 - incomplete
Message-ID: <e04f28eb0601310759h1c405b79uf1e4712b8071a13b@mail.gmail.com>

alright hi everyone!

considering the failure of most applications to contain jpeg
decoding/support i have tried this solution:

a universal solution to convert the mjpeg into something more 'friendly'

as it stands this application 'sorta' works. by sorta i mean, i have managed
to get a streaming image from the device to play with mplayer

however, I am UNEXPERIENCED, lol, emphasis on that, so the image comes out
choppy and incomplete.

Im submitting this code to you guys to see if anyone can help or correct the
errors. this program is mostly taken from uvcview, and vloopback (for v4l2,
included)

TODO:

fix the image
possibly convert the yuv to yv12 (more support?)
figure out why xawtv (etc) cant play it? (and for my purposes, aMSN)
no doubt more...


this project is probably pointless..and is at very very best a cheap, ugly,
dirty hack.
im only trying to get this to work so i can view my webcam in aMSN (which
uses libng from xawtv).
I would just add the jpeg_decoder to xawtv..but im really not experienced
enough or know how.

so let me know what you guys think..


edit: forgot you cant upload files to the mailing list haha! so if anyone
wants to see the code, email me an i will send via email (unless someone
wants to host it)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060131/9af591f1/attachment.html>

From bxerroz at gmail.com  Tue Jan 31 17:07:05 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Tue, 31 Jan 2006 08:07:05 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <20060131083917.GF25759@sd291.sivit.org>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <200601271024.59121.mxhaard@magic.fr>
	 <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com>
	 <200601310152.47527.laurent.pinchart@skynet.be>
	 <20060131083917.GF25759@sd291.sivit.org>
Message-ID: <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com>

On 1/31/06, Luc Saillard <luc at saillard.org> wrote:
>
> On Tue, Jan 31, 2006 at 01:52:47AM +0100, Laurent Pinchart wrote:
> > > im currently looking through the libng source code (included in the
> CVS
> > > version of aMSN, utils/linux/capture/libng), and i really dont know
> where
> > > to start. I cant find (or  just blind to) the YUYV converter in the
> code,
> > > and assuming i can find it, still not sure where to put the mjpeg
> decoder
> >
> > Try to ask the aMSN developers.
> >
> > The best solution to that problem would probably to have a v4l
> user-space
> > library which would handle decompression in user-space (this would also
> have
> > the benefit to make user-space drivers possible).
> >
>
> I'm currently trying to change my libpwc to be able to decompress the
> MJPEG
> buffer and convert it in YUV420P or RGB24. So perhaps one day, we will
> have a
> v4l2 library like in the alsa world. As i've a pretty small decoder, this
> can
> be embeded in a lot of applications. But i don't known if more developper
> will want to use the tiny library, so for the moment, it's just a small
> pixel format convertion library.
>
> Luc
>


Well the jpeg_decoder function found in utils.h seems to be decoding to YUYV
(v4l format 411P shows an uglier picture than with format YUYV, so this is
based on this, even though in the function it says 411 encoding)

Also, <mplayer base dir>/postproc/, contains functions and libraries and
what not to convert YUYV streams into apparently many others.

Im going to try to find an algorithm from mplayer to convert the YUYV stream
into i guess YV12  as im told its more umm supported? if i can ill add it to
my program uvcStreamer and see if it yields any results.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060131/5c3a02e7/attachment.html>

From bxerroz at gmail.com  Tue Jan 31 17:09:03 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Tue, 31 Jan 2006 08:09:03 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601311023.53707.laurent.pinchart@skynet.be>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <200601310152.47527.laurent.pinchart@skynet.be>
	 <20060131083917.GF25759@sd291.sivit.org>
	 <200601311023.53707.laurent.pinchart@skynet.be>
Message-ID: <e04f28eb0601310809l55ef9b65hd4e6b7483d7cee19@mail.gmail.com>

On 1/31/06, Laurent Pinchart <laurent.pinchart at skynet.be> wrote:
>
> > > > im currently looking through the libng source code (included in the
> CVS
> > > > version of aMSN, utils/linux/capture/libng), and i really dont know
> > > > where to start. I cant find (or  just blind to) the YUYV converter
> in
> > > > the code, and assuming i can find it, still not sure where to put
> the
> > > > mjpeg decoder
> > >
> > > Try to ask the aMSN developers.
> > >
> > > The best solution to that problem would probably to have a v4l
> user-space
> > > library which would handle decompression in user-space (this would
> also
> > > have the benefit to make user-space drivers possible).
> >
> > I'm currently trying to change my libpwc to be able to decompress the
> MJPEG
> > buffer and convert it in YUV420P or RGB24. So perhaps one day, we will
> have
> > a v4l2 library like in the alsa world. As i've a pretty small decoder,
> this
> > can be embeded in a lot of applications. But i don't known if more
> > developper will want to use the tiny library, so for the moment, it's
> just
> > a small pixel format convertion library.
>
> Should we raise the topic on the video4linux mailing list ?
>
> Laurent Pinchart


No doubt the mailing list is different than the irc channel, but i doubt the
outcome will be much different. Ive been lurking around the v4l channel and
havent  gotten much response on the matter, a similar 'do it your self' type
answer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060131/40b36e75/attachment.html>

From luc at saillard.org  Tue Jan 31 18:21:48 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 18:21:48 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601271024.59121.mxhaard@magic.fr> <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com> <200601310152.47527.laurent.pinchart@skynet.be> <20060131083917.GF25759@sd291.sivit.org> <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com>
Message-ID: <20060131172148.GA20204@sd291.sivit.org>

On Tue, Jan 31, 2006 at 08:07:05AM -0800, Binary Xerroz wrote:
 
> Well the jpeg_decoder function found in utils.h seems to be decoding to YUYV
> (v4l format 411P shows an uglier picture than with format YUYV, so this is
> based on this, even though in the function it says 411 encoding)

I've not use the jpeg decoder in utils.c for some reasons:

 - GPL licence impcompatible with MPL (pwlib licence on which ekiga is based)
 - use integer precision for DCT (i prefer to use float, or others)
 - readability (i learn a lot in writing my own tools).
 - can convert directly in RGB24, YUV420P, Gray or only return some
   components without decoding the full image.
 - ... because i like only my code :-)
 
> Also, <mplayer base dir>/postproc/, contains functions and libraries and
> what not to convert YUYV streams into apparently many others.

Yes ffmpeg (libavcodec, libavformat) is cool but sometimes you don't want the
full library as a dependancy or for legal reason (patent).

> Im going to try to find an algorithm from mplayer to convert the YUYV stream
> into i guess YV12  as im told its more umm supported? if i can ill add it to
> my program uvcStreamer and see if it yields any results.

YV12 is YUV420 ? Take a look at my tinyjpegdecoder library :-). Ok it's not
released but i'll send you the files.

Luc



From bxerroz at gmail.com  Tue Jan 31 18:27:07 2006
From: bxerroz at gmail.com (Binary Xerroz)
Date: Tue, 31 Jan 2006 09:27:07 -0800
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <20060131172148.GA20204@sd291.sivit.org>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com>
	 <200601271024.59121.mxhaard@magic.fr>
	 <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com>
	 <200601310152.47527.laurent.pinchart@skynet.be>
	 <20060131083917.GF25759@sd291.sivit.org>
	 <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com>
	 <20060131172148.GA20204@sd291.sivit.org>
Message-ID: <e04f28eb0601310927l6f85216dk28d9020cafce094b@mail.gmail.com>

On 1/31/06, Luc Saillard <luc at saillard.org> wrote:
>
> On Tue, Jan 31, 2006 at 08:07:05AM -0800, Binary Xerroz wrote:
>
> > Well the jpeg_decoder function found in utils.h seems to be decoding to
> YUYV
> > (v4l format 411P shows an uglier picture than with format YUYV, so this
> is
> > based on this, even though in the function it says 411 encoding)
>
> I've not use the jpeg decoder in utils.c for some reasons:
>
> - GPL licence impcompatible with MPL (pwlib licence on which ekiga is
> based)
> - use integer precision for DCT (i prefer to use float, or others)
> - readability (i learn a lot in writing my own tools).
> - can convert directly in RGB24, YUV420P, Gray or only return some
>    components without decoding the full image.
> - ... because i like only my code :-)


haha me too :) except my knowledge on the subject is fairly limited, and
couldnt easily create my own (id still be scratching my head with an odd
look on my face ;)


> Also, <mplayer base dir>/postproc/, contains functions and libraries and
> > what not to convert YUYV streams into apparently many others.
>
> Yes ffmpeg (libavcodec, libavformat) is cool but sometimes you don't want
> the
> full library as a dependancy or for legal reason (patent).


good point

> Im going to try to find an algorithm from mplayer to convert the YUYV
> stream
> > into i guess YV12  as im told its more umm supported? if i can ill add
> it to
> > my program uvcStreamer and see if it yields any results.
>
> YV12 is YUV420 ? Take a look at my tinyjpegdecoder library :-). Ok it's
> not
> released but i'll send you the files.
>
> Luc
>
>

Okay :) i look forward to it!

Tanner

PS: take a look at uvcStreamer (if you want) and let me know what you think
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20060131/583416cb/attachment.html>

From mxhaard at magic.fr  Tue Jan 31 19:58:47 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Tue, 31 Jan 2006 19:58:47 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <20060131083917.GF25759@sd291.sivit.org> <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com>
Message-ID: <200601311958.47808.mxhaard@magic.fr>

Le Mardi 31 Janvier 2006 17:07, Binary Xerroz a ?crit?:
> On 1/31/06, Luc Saillard <luc at saillard.org> wrote:
> > On Tue, Jan 31, 2006 at 01:52:47AM +0100, Laurent Pinchart wrote:
> > > > im currently looking through the libng source code (included in the
> >
> > CVS
> >
> > > > version of aMSN, utils/linux/capture/libng), and i really dont know
> >
> > where
> >
> > > > to start. I cant find (or  just blind to) the YUYV converter in the
> >
> > code,
> >
> > > > and assuming i can find it, still not sure where to put the mjpeg
> >
> > decoder
> >
> > > Try to ask the aMSN developers.
> > >
> > > The best solution to that problem would probably to have a v4l
> >
> > user-space
> >
> > > library which would handle decompression in user-space (this would also
> >
> > have
> >
> > > the benefit to make user-space drivers possible).
> >
> > I'm currently trying to change my libpwc to be able to decompress the
> > MJPEG
> > buffer and convert it in YUV420P or RGB24. So perhaps one day, we will
> > have a
> > v4l2 library like in the alsa world. As i've a pretty small decoder, this
> > can
> > be embeded in a lot of applications. But i don't known if more developper
> > will want to use the tiny library, so for the moment, it's just a small
> > pixel format convertion library.
> >
> > Luc
>
> Well the jpeg_decoder function found in utils.h seems to be decoding to
> YUYV (v4l format 411P shows an uglier picture than with format YUYV, so
> this is based on this, even though in the function it says 411 encoding)
>
> Also, <mplayer base dir>/postproc/, contains functions and libraries and
> what not to convert YUYV streams into apparently many others.
>
> Im going to try to find an algorithm from mplayer to convert the YUYV
> stream into i guess YV12  as im told its more umm supported? if i can ill
> add it to my program uvcStreamer and see if it yields any results.

utils.c and utils.h set in uvcview are quick hack to perform YUYV decoding and 
allow people to play with the UVC video class webcams no more no less :)
the jpeg decoding is coming from the GPL bootsplash project with some 
modification as the original one play with rgb components :)
I have try to compile EKiga (thanks for the answer about evolution ) to mutch 
dependancies for me, after evolution i need avahi who need dbus qt4 libdaemon 
gdbm .... sorry Luc i will try EKiga and the tinyjpeg decoder when  Suse 
update a full package :(
-- 
Michel Xhaard
http://mxhaard.free.fr


From laurent.pinchart at skynet.be  Tue Jan 31 21:33:15 2006
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 31 Jan 2006 21:33:15 +0100
Subject: [Linux-uvc-devel] Ekiga (aka gnomemeeting) support MJPEG stream
In-Reply-To: <167b6aa00601310652n34396c26ga6e2e10577c69981@mail.gmail.com>
References: <20060130151906.GE20164@sd291.sivit.org> <200601311028.26943.laurent.pinchart@skynet.be> <167b6aa00601310652n34396c26ga6e2e10577c69981@mail.gmail.com>
Message-ID: <200601312133.16057.laurent.pinchart@skynet.be>

> What about the versioning idea? Would Berlios allow this? What I mean
> is open up a project in the svn repository for the website itself.
> Then you can easily delegate the responsibility of evaluating patches
> to someone you trust to give svn commit rights to.

Berlios would allow that, but the files will have to be uploaded manually to 
the http server. All we need now is someone to take the job :-)

Laurent Pinchart


From luc at saillard.org  Tue Jan 31 22:26:46 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 22:26:46 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601311958.47808.mxhaard@magic.fr>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <20060131083917.GF25759@sd291.sivit.org> <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com> <200601311958.47808.mxhaard@magic.fr>
Message-ID: <20060131212646.GB20204@sd291.sivit.org>

On Tue, Jan 31, 2006 at 07:58:47PM +0100, michel Xhaard wrote:
> 
> utils.c and utils.h set in uvcview are quick hack to perform YUYV decoding and 
> allow people to play with the UVC video class webcams no more no less :)
> the jpeg decoding is coming from the GPL bootsplash project with some 
> modification as the original one play with rgb components :)
> I have try to compile EKiga (thanks for the answer about evolution ) to mutch 
> dependancies for me, after evolution i need avahi who need dbus qt4 libdaemon 
> gdbm .... sorry Luc i will try EKiga and the tinyjpeg decoder when  Suse 
> update a full package :(

Strange, i don't have dbus nor avahi, ... Do you have try this switch for
building ekiga ?
--disable-gnome --disable-avahi

Note: i don't use gnome on my linux, but someone have build ekiga for windows
and linux without gnome.

Luc


From luc at saillard.org  Tue Jan 31 22:54:46 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 22:54:46 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <200601311023.53707.laurent.pinchart@skynet.be>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601310152.47527.laurent.pinchart@skynet.be> <20060131083917.GF25759@sd291.sivit.org> <200601311023.53707.laurent.pinchart@skynet.be>
Message-ID: <20060131215446.GC20204@sd291.sivit.org>

On Tue, Jan 31, 2006 at 10:23:53AM +0100, Laurent Pinchart wrote:
> >
> > I'm currently trying to change my libpwc to be able to decompress the MJPEG
> > buffer and convert it in YUV420P or RGB24. So perhaps one day, we will have
> > a v4l2 library like in the alsa world. As i've a pretty small decoder, this
> > can be embeded in a lot of applications. But i don't known if more
> > developper will want to use the tiny library, so for the moment, it's just
> > a small pixel format convertion library.
> 
> Should we raise the topic on the video4linux mailing list ?
 
I prefer to wait that i've finished some works on the library. Perhaps this
will be used by uvcStreamer :-)

Luc


From luc at saillard.org  Tue Jan 31 23:01:11 2006
From: luc at saillard.org (Luc Saillard)
Date: Tue, 31 Jan 2006 23:01:11 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <e04f28eb0601310927l6f85216dk28d9020cafce094b@mail.gmail.com>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601271024.59121.mxhaard@magic.fr> <e04f28eb0601271332q1d24af17rdc8eb79149594d67@mail.gmail.com> <200601310152.47527.laurent.pinchart@skynet.be> <20060131083917.GF25759@sd291.sivit.org> <e04f28eb0601310807k1ee6b0a7u9aa63a53bbbad46c@mail.gmail.com> <20060131172148.GA20204@sd291.sivit.org> <e04f28eb0601310927l6f85216dk28d9020cafce094b@mail.gmail.com>
Message-ID: <20060131220110.GD20204@sd291.sivit.org>

> >
> > YV12 is YUV420 ? Take a look at my tinyjpegdecoder library :-). Ok it's
> > not released but i'll send you the files.
> >
> 
> Okay :) i look forward to it!

Ok find the lastest snapshot here:

  http://saillard.org/programs_and_patches/tinyjpegdecoder/
 
Luc


From mxhaard at magic.fr  Tue Jan 31 23:58:35 2006
From: mxhaard at magic.fr (michel Xhaard)
Date: Tue, 31 Jan 2006 23:58:35 +0100
Subject: [Linux-uvc-devel] Logitech Quickcam for Notebooks Pro
In-Reply-To: <20060131212646.GB20204@sd291.sivit.org>
References: <e04f28eb0601252343s5f74325fjc0abfe36ed997aa1@mail.gmail.com> <200601311958.47808.mxhaard@magic.fr> <20060131212646.GB20204@sd291.sivit.org>
Message-ID: <200601312358.36036.mxhaard@magic.fr>

Le Mardi 31 Janvier 2006 22:26, Luc Saillard a ?crit?:
> On Tue, Jan 31, 2006 at 07:58:47PM +0100, michel Xhaard wrote:
> > utils.c and utils.h set in uvcview are quick hack to perform YUYV
> > decoding and allow people to play with the UVC video class webcams no
> > more no less :) the jpeg decoding is coming from the GPL bootsplash
> > project with some modification as the original one play with rgb
> > components :)
> > I have try to compile EKiga (thanks for the answer about evolution ) to
> > mutch dependancies for me, after evolution i need avahi who need dbus qt4
> > libdaemon gdbm .... sorry Luc i will try EKiga and the tinyjpeg decoder
> > when  Suse update a full package :(
>
> Strange, i don't have dbus nor avahi, ... Do you have try this switch for
> building ekiga ?
> --disable-gnome --disable-avahi
>
> Note: i don't use gnome on my linux, but someone have build ekiga for
> windows and linux without gnome.
>
> Luc
Luc,
I have try a lot exept this two :)  i will try tomorrow 
thanks
-- 
Michel Xhaard
http://mxhaard.free.fr


