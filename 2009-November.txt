From maximedelorme at laposte.net  Sun Nov  1 11:00:52 2009
From: maximedelorme at laposte.net (Maxime Delorme)
Date: Sun,  1 Nov 2009 11:00:52 +0100 (CET)
Subject: [Linux-uvc-devel] Problems setting manual exposure on Creative
	Live! Cam Optia
Message-ID: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>


This email follows that old one : http://lists.berlios.de/pipermail/linux-uvc-devel/2008-July/003849.html

I 've got the same bug here, 
I can change the exposure on a Windows box, then replug on my Opensuse 11 then exposure is correct on my linux box
As soon as I change the exposure for example with guvciew, then the exposure become very high and the camera show only a white picture of my room.

On windows I can can change the setting of the exposure and the Creative Live! Cam Optia reacts normally 
I use skype on Windows or a dummy soft called "easy webcam" the panel setting for the webcam is the same and with both of them I can change manually the exposure

This bug is according to me a driver bug not an hardware bug

If I can help in any sort please give me a hint

Regards


---------------------------------------------------------------------------- 
Laposte.net f?te ses 10 ans ! 

Gratuite, garantie ? vie et d?j? utilis?e par des millions d'internautes... 
vous aussi, pour votre adresse e-mail, choisissez laposte.net. 

Laposte.net, bien + qu'une messagerie 
----------------------------------------------------------------------------



From pj.assis at gmail.com  Sun Nov  1 13:59:27 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 1 Nov 2009 12:59:27 +0000
Subject: [Linux-uvc-devel] Problems setting manual exposure on Creative
	Live! Cam Optia
In-Reply-To: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>
References: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>
Message-ID: <59cf47a80911010459w12095bbdsd2b1303c0b9c221f@mail.gmail.com>

Maxime,

Can you post your control list, you can get it with 'guvcview --verbose'

Thanks,
Paulo

2009/11/1 Maxime Delorme <maximedelorme at laposte.net>:
>
> This email follows that old one : http://lists.berlios.de/pipermail/linux-uvc-devel/2008-July/003849.html
>
> I 've got the same bug here,
> I can change the exposure on a Windows box, then replug on my Opensuse 11 then exposure is correct on my linux box
> As soon as I change the exposure for example with guvciew, then the exposure become very high and the camera show only a white picture of my room.
>
> On windows I can can change the setting of the exposure and the Creative Live! Cam Optia reacts normally
> I use skype on Windows or a dummy soft called "easy webcam" the panel setting for the webcam is the same and with both of them I can change manually the exposure
>
> This bug is according to me a driver bug not an hardware bug
>
> If I can help in any sort please give me a hint
>
> Regards
>
>
> ----------------------------------------------------------------------------
> Laposte.net f?te ses 10 ans !
>
> Gratuite, garantie ? vie et d?j? utilis?e par des millions d'internautes...
> vous aussi, pour votre adresse e-mail, choisissez laposte.net.
>
> Laposte.net, bien + qu'une messagerie
> ----------------------------------------------------------------------------
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From barsnick at gmx.net  Sun Nov  1 14:47:42 2009
From: barsnick at gmx.net (Moritz Barsnick)
Date: Sun, 1 Nov 2009 14:47:42 +0100
Subject: [Linux-uvc-devel] eb1a:2571 "eMPIA Technology, Inc."  supported
In-Reply-To: <200910312041.32158.laurent.pinchart@ideasonboard.com>
References: <200910291337.42054@rk-nord.at>
	<200910312041.32158.laurent.pinchart@ideasonboard.com>
Message-ID: <20091101134742.GA8537@sunshine.barsnick.net>

Hi,

On Sat, Oct 31, 2009 at 20:41:32 +0100, Laurent Pinchart wrote:

> Your luvcview version defaults to MJPEG and doesn't fall back to YUV 
> automatically. Your camera supports YUV only, so the default won't work. 
> luvcview -f yuv should work.

luvcview being _the_ reference app for UVC should probably be less
confusing to users and automatically try to detect this.

I think guvcview does, but it has even more build dependencies than
luvcview which makes it harder to "just build" it for testing purposes.

Moritz


From barsnick at gmx.net  Sun Nov  1 14:54:58 2009
From: barsnick at gmx.net (Moritz Barsnick)
Date: Sun, 1 Nov 2009 14:54:58 +0100
Subject: [Linux-uvc-devel] eb1a:2571 "eMPIA Technology, Inc."  supported
In-Reply-To: <200910312115.08866@rk-nord.at>
References: <200910291337.42054@rk-nord.at>
	<200910312041.32158.laurent.pinchart@ideasonboard.com>
	<200910312115.08866@rk-nord.at>
Message-ID: <20091101135458.GB8537@sunshine.barsnick.net>

Hi Melchior,

On Sat, Oct 31, 2009 at 21:15:08 +0100, Melchior FRANZ wrote:

> Oh, indeed! Thanks. (BTW: I had also tried the latest version from
> SVN (r19), but that doesn't compile due to missing header files.)

I don't recall where I had the instructions from, but you need these
three additional files:

http://svn.berlios.de/svnroot/repos/linux-uvc/linux-uvc/trunk/uvcvideo.h
http://svn.berlios.de/svnroot/repos/linux-uvc/linux-uvc/trunk/uvc_compat.h
http://svn.quickcamteam.net/svn/qct/Linux/Common/include/dynctrl-logitech.h

Hope this helps,
Moritz


From melchior.franz at gmail.com  Sun Nov  1 15:07:49 2009
From: melchior.franz at gmail.com (Melchior FRANZ)
Date: Sun, 1 Nov 2009 15:07:49 +0100
Subject: [Linux-uvc-devel] eb1a:2571 "eMPIA Technology, Inc."  supported
In-Reply-To: <20091101135458.GB8537@sunshine.barsnick.net>
References: <200910291337.42054@rk-nord.at> <200910312115.08866@rk-nord.at>
	<20091101135458.GB8537@sunshine.barsnick.net>
Message-ID: <200911011507.50292@rk-nord.at>

Hey,

* Moritz Barsnick -- Sunday 01 November 2009:
> On Sat, Oct 31, 2009 at 21:15:08 +0100, Melchior FRANZ wrote:
> [luvcview]
> > Ihad also tried the latest version from
> > SVN (r19), but that doesn't compile due to missing header files.)
> 
> I don't recall where I had the instructions from, but you need these
> three additional files:

Argh ... it even says so in the README. (But who reads READMEs?! :-)
I'm just too used to super-small applications building without having
to resort to wget. That's just weird.

Sorry for the "false alarm", then ...  :-)

m.


From pj.assis at gmail.com  Sun Nov  1 15:48:40 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 1 Nov 2009 14:48:40 +0000
Subject: [Linux-uvc-devel] Problems setting manual exposure on Creative
	Live! Cam Optia
In-Reply-To: <33256903.5334.1257082065713.JavaMail.www@wwinf8302>
References: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>
	<59cf47a80911010459w12095bbdsd2b1303c0b9c221f@mail.gmail.com>
	<33256903.5334.1257082065713.JavaMail.www@wwinf8302>
Message-ID: <59cf47a80911010648y62e9d0b5v7ba073ddbc8f0e21@mail.gmail.com>

Maxime,

> control[8]: 0x9a0902 Exposure (Absolute), 20:1:5000, default 79
> control[9]: 0x9a0903 Exposure, Auto Priority, 0:1:1, default 0

Disable Exposure, Auto Priority


> control[7]: 0x9a0901 Exposure, Auto, 0:1:3, default 0

Set Exposure, Auto to 1 (manual)

Now you should be able to set Exposure (Absolute) and gain to any
value you want.


Best regards,
Paulo


From pj.assis at gmail.com  Mon Nov  2 10:42:19 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 2 Nov 2009 09:42:19 +0000
Subject: [Linux-uvc-devel] Problems setting manual exposure on Creative
	Live! Cam Optia
In-Reply-To: <22275518.24650.1257092027321.JavaMail.www@wwinf8404>
References: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>
	<59cf47a80911010459w12095bbdsd2b1303c0b9c221f@mail.gmail.com>
	<33256903.5334.1257082065713.JavaMail.www@wwinf8302>
	<59cf47a80911010648y62e9d0b5v7ba073ddbc8f0e21@mail.gmail.com>
	<22275518.24650.1257092027321.JavaMail.www@wwinf8404>
Message-ID: <59cf47a80911020142q4ef6fcafq55fcf1617c5953c3@mail.gmail.com>

Hi,

2009/11/1 Maxime Delorme <maximedelorme at laposte.net>:
>
> When I check or unchecked in guvcview the checkbox I've got
>
> VIDIOC_S_CTRL - Unable to set control: Erreur d'entr?e/sortie (Error I/O)
> Exposure, Auto Priority change to 1 failed
> VIDIOC_G_CTRL - Unable to get control: Erreur d'entr?e/sortie (Error I/O)
> hardware get failed
>

This is strange, have you tried to change it after modifying
"Exposure, Auto", try it with all possible combinations,
maybe it needs to be "unlocked" with some special control sequence???

Or maybe the control just doesn't work properly :( since even
VIDIOC_G_CTRL seems to fail.
In any case the default value is reported to be 0, although you can't
be sure what value is actually set.
If you say it works in windows then it would be a good idea to check
how this is handled there.

Best regards,
Paulo


From maximedelorme at laposte.net  Mon Nov  2 22:16:37 2009
From: maximedelorme at laposte.net (Maxime Delorme)
Date: Mon,  2 Nov 2009 22:16:37 +0100 (CET)
Subject: [Linux-uvc-devel] Problems setting manual exposure on Creative
 Live! Cam Optia
In-Reply-To: <59cf47a80911020142q4ef6fcafq55fcf1617c5953c3@mail.gmail.com>
References: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>
	<59cf47a80911010459w12095bbdsd2b1303c0b9c221f@mail.gmail.com>
	<33256903.5334.1257082065713.JavaMail.www@wwinf8302>
	<59cf47a80911010648y62e9d0b5v7ba073ddbc8f0e21@mail.gmail.com>
	<22275518.24650.1257092027321.JavaMail.www@wwinf8404>
	<59cf47a80911020142q4ef6fcafq55fcf1617c5953c3@mail.gmail.com>
Message-ID: <12094761.2883.1257196597150.JavaMail.www@wwinf8202>


Thanks Paulo for your help

Well, I try any sequence and didn't succeed
I can not set the exposure on my Linux Box

Your work is great but sometimes, I fed up with fighting against compatibility hardware on my linux box

On windows I just drag the slider of the exposure setting from 0 to 4, and it just works !

On linux I get with guvciew
VIDIOC_S_CTRL - Unable to set control: Erreur d'entr?e/sortie
Exposure, Auto Priority change to 1 failed
VIDIOC_G_CTRL - Unable to get control: Erreur d'entr?e/sortie
hardware get failed
and with uvcdynctrl --get="Exposure, Auto Priority"
ERROR: Unable to retrieve control value: A Video4Linux2 API call returned an unexpected error 5. (Code: 12)

Tanks again for your help


> Message du 02/11/09 10:42
> De : "Paulo Assis" 

> A : "Maxime Delorme" , "linux-uvc development discussions" 

> Copie ? : 
> Objet : Re: [Linux-uvc-devel] Problems setting manual exposure on Creative Live! Cam Optia
>
> 
> Hi,
> 
> 2009/11/1 Maxime Delorme :
> >
> > When I check or unchecked in guvcview the checkbox I've got
> >
> > VIDIOC_S_CTRL - Unable to set control: Erreur d'entr?e/sortie (Error I/O)
> > Exposure, Auto Priority change to 1 failed
> > VIDIOC_G_CTRL - Unable to get control: Erreur d'entr?e/sortie (Error I/O)
> > hardware get failed
> >
> 
> This is strange, have you tried to change it after modifying
> "Exposure, Auto", try it with all possible combinations,
> maybe it needs to be "unlocked" with some special control sequence???
> 
> Or maybe the control just doesn't work properly :( since even
> VIDIOC_G_CTRL seems to fail.
> In any case the default value is reported to be 0, although you can't
> be sure what value is actually set.
> If you say it works in windows then it would be a good idea to check
> how this is handled there.
> 
> Best regards,
> Paulo
> 
> 

---------------------------------------------------------------------------- 
Laposte.net f?te ses 10 ans ! 

Gratuite, garantie ? vie et d?j? utilis?e par des millions d'internautes... 
vous aussi, pour votre adresse e-mail, choisissez laposte.net. 

Laposte.net, bien + qu'une messagerie 
----------------------------------------------------------------------------



From pj.assis at gmail.com  Tue Nov  3 00:16:58 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 2 Nov 2009 23:16:58 +0000
Subject: [Linux-uvc-devel] Problems setting manual exposure on Creative
	Live! Cam Optia
In-Reply-To: <12094761.2883.1257196597150.JavaMail.www@wwinf8202>
References: <31651288.51488.1257069652178.JavaMail.www@wwinf8214>
	<59cf47a80911010459w12095bbdsd2b1303c0b9c221f@mail.gmail.com>
	<33256903.5334.1257082065713.JavaMail.www@wwinf8302>
	<59cf47a80911010648y62e9d0b5v7ba073ddbc8f0e21@mail.gmail.com>
	<22275518.24650.1257092027321.JavaMail.www@wwinf8404>
	<59cf47a80911020142q4ef6fcafq55fcf1617c5953c3@mail.gmail.com>
	<12094761.2883.1257196597150.JavaMail.www@wwinf8202>
Message-ID: <59cf47a80911021516v7471a9f0tdbe16fcb9ebafd50@mail.gmail.com>

Maxime,

> On windows I just drag the slider of the exposure setting from 0 to 4, and it just works !

this is even stranger, if I remember correctly there are several
exposure controls in the uvc spec:

Exposure, Auto defines the exposure mode:
 0 - "Auto Mode",
 1 - "Manual Mode",
 2 - "Shutter Priority Mode",
 3 - "Aperture Priority Mode"

Exposure, Absolute: the absolute value for the exposure (in your case
from 20 to 5000)

Exposure, Auto Priority: if set bypasses the absolute value given
priority to the hardware exposure algorithm

But you are saying that in windows you get a single slider from 0 to 4 ??
Is this for Exposure, Auto or Exposure, Absolute ?

Best regards,
paulo


From fabtarr at gmail.com  Tue Nov  3 11:09:12 2009
From: fabtarr at gmail.com (Fabiano T)
Date: Tue, 03 Nov 2009 11:09:12 +0100
Subject: [Linux-uvc-devel] Webcam problem, notebook ASUS k50in,
	CN7129 04f2:b071 , more details
Message-ID: <4AF00148.9060809@gmail.com>

Webcam problem, notebook ASUS k50in, CN7129 04f2:b071 , flips image upside
down; wrong brightness, resolution and color tuning.
I have first updated (opensuse update and webcam repository) UVC and libv4l
modules and drivers.
UVCvideo r260, libv4l 0.6.1
luvcview correctly visualize colors and resolution (tune brightness
automatically) but the image is flipped upside down.
I have try updating with opensuse build packages libv4l to 0.6.2.
Nothing has changed.

I have also tried a self compiled libv4l 0.6.3 without success.
The big problem is with Skype, image is totally wrong, flipped upside down at
very low resolution, very dark with a green background tone.
I am able to flip the image right with this workaround:
LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype

but the image is still unusable, wrong colors, wrong resolution, very dark..
Is this an UVCvideo issue or a libv4l , or is caused by strange interactions?

Here are the output of:

lsusb > lsusb.log
dmidecode > dmi.log

Bus 002 Device 002: ID 04f2:b071 Chicony Electronics Co., Ltd.
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub


Handle 0x0002, DMI type 2, 15 bytes
Base Board Information
<------>Manufacturer: ASUSTeK Computer Inc.........
<------>Product Name: K50IN......
<------>Version: 1.0.......
<------>Serial Number: BSN12345678901234567
<------>Asset Tag: ATN12345678901234567
<------>Features:
<------><------>Board is a hosting board
<------><------>Board requires at least one daughter board
<------><------>Board is replaceable
<------>Location In Chassis: MIDDLE..............
<------>Chassis Handle: 0x0003
<------>Type: Motherboard
<------>Contained Object Handles: 0
Reply With Quote

Do you need other data? Have I to add other  command's output?

Regards





From laurent.pinchart at ideasonboard.com  Wed Nov  4 15:12:07 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 4 Nov 2009 15:12:07 +0100
Subject: [Linux-uvc-devel] ViMicro Webcam 0ac8:3420 bug+fix
In-Reply-To: <20091029180249.GA23230@geggus.net>
References: <20091022101355.GA16794@geggus.net>
	<200910281344.57130.laurent.pinchart@ideasonboard.com>
	<20091029180249.GA23230@geggus.net>
Message-ID: <200911041512.07598.laurent.pinchart@ideasonboard.com>

Hi Sven,

On Thursday 29 October 2009 19:02:50 Sven Geggus wrote:
> Laurent Pinchart schrieb am Mittwoch, den 28. Oktober um 13:44 Uhr:
> > Could you please try the following patch ? It disables the quirk for
> > compressed formats.
> 
> This patch does not apply here (Vanilla Kernel Linux 2.6.31.5).
> 
> I suppose this would be equivalent:
> 
> diff --git a/drivers/media/video/uvc/uvc_video.c
> b/drivers/media/video/uvc/uvc_video.c
> index 01b633c..df8a335 100644
> --- a/drivers/media/video/uvc/uvc_video.c
> +++ b/drivers/media/video/uvc/uvc_video.c
> @@ -90,7 +90,8 @@ static void uvc_fixup_video_ctrl(struct uvc_video_device
> *video,
>                 ctrl->dwMaxVideoFrameSize =
>                         frame->dwMaxVideoFrameBufferSize;
> 
> -       if (video->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
> +       if (!(format->flags & UVC_FMT_FLAG_COMPRESSED) &&
> +           video->dev->quirks & UVC_QUIRK_FIX_BANDWIDTH &&
>             video->streaming->intf->num_altsetting > 1) {
>                 u32 interval;
>                 u32 bandwidth;

Yes it is.
 
> The above change _does_ make it work the same as getting rid of the quirks
> altogether. There might be different firmware Version of the devices
> around.

Thanks. I'll apply the patch then.
 
> BTW wouldn't it be better to make the quirks module parameter _overwrite_
> camera specific quirks altogether instead of adding them with xor? This way
> I would have been able to disable the quirks without patching the module.

It could be useful, but quirks activated by mistake (or not doing their job 
properly) shouldn't occur often as those problems result of a driver bug. I 
don't think there's really a need for this.

-- 
Regards,

Laurent Pinchart


From lists at fuchsschwanzdomain.de  Wed Nov  4 15:17:50 2009
From: lists at fuchsschwanzdomain.de (Sven Geggus)
Date: Wed, 4 Nov 2009 15:17:50 +0100
Subject: [Linux-uvc-devel] ViMicro Webcam 0ac8:3420 bug+fix
In-Reply-To: <200911041512.07598.laurent.pinchart@ideasonboard.com>
References: <20091022101355.GA16794@geggus.net>
	<200910281344.57130.laurent.pinchart@ideasonboard.com>
	<20091029180249.GA23230@geggus.net>
	<200911041512.07598.laurent.pinchart@ideasonboard.com>
Message-ID: <20091104141750.GA11445@geggus.net>

Laurent Pinchart schrieb am Mittwoch, den 04. November um 15:12 Uhr:

> Thanks. I'll apply the patch then.

Any Idea if/when these patches are going to hit mainline?

Sven

-- 
"Thinking of using NT for your critical apps?
                                  Isn't there enough suffering in the world?"
                   (Advertisement of Sun Microsystems in Wall Street Journal)
/me is giggls at ircnet, http://sven.gegg.us/ on the Web


From laurent.pinchart at ideasonboard.com  Wed Nov  4 15:34:50 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 4 Nov 2009 15:34:50 +0100
Subject: [Linux-uvc-devel] Asus k50in - upside down camera CNF7129
In-Reply-To: <4AEC406D.8060702@gmail.com>
References: <4AEC406D.8060702@gmail.com>
Message-ID: <200911041534.50808.laurent.pinchart@ideasonboard.com>

Hi Fabiano,

On Saturday 31 October 2009 14:49:33 Fabiano T wrote:
> As stated on the old post:
> [Linux-uvc-devel] Looking for upside down uvc cams

Thanks for the report. I've forwarded your mail to the libv4l maintainer.

> My cam is working well but the image is upside-down, I have a question...
> besides adding all the problematic platform is a solution for sure, is
> there a way to add a configuration(with a flag) file for v4linux libs in
> order to force flipping ?
> This 'll solve the problem while waiting for the device to be added.

I'm not sure about a flag, but you could add the device yourself. Have a look 
at the v4l_control table in libv4lconvert/control/libv4lcontrol.c

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov  4 15:40:56 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 4 Nov 2009 15:40:56 +0100
Subject: [Linux-uvc-devel] Overview of luvcview
In-Reply-To: <9D5E1752379A43408015F7FE9846611504EDD074@CHNEXVS01.VSNLXCHANGE.COM>
References: <9D5E1752379A43408015F7FE9846611504EDD074@CHNEXVS01.VSNLXCHANGE.COM>
Message-ID: <200911041540.56819.laurent.pinchart@ideasonboard.com>

Hi Ananth,

On Saturday 31 October 2009 15:44:31 Anantha Krishnan H wrote:
> Hi
>     I am working on OMAP3530 running Android kernel on top of it.I have
>  Logitech Pro 9000 webcam.I plug-in the webcam and the entry for the device
>  gets created as /dev/video0.I wanted to test my webcam.So i've downloaded
>  'luvcview' and SDL.Can anyone kindly tellme how to cross compile
>  'luvcview' and SDL for my target(ARM)?

I'm not sure about SDL, but luvcview doesn't support cross-compilation 
natively. You'll have to hack the Makefile (and probably the source as well).

If you manage to cross-compile luvcview, could you please post your results to 
the list ? That could be helpful for other developers.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov  4 15:51:55 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 4 Nov 2009 15:51:55 +0100
Subject: [Linux-uvc-devel] eb1a:2571 "eMPIA Technology, Inc."  supported
In-Reply-To: <200910312115.08866@rk-nord.at>
References: <200910291337.42054@rk-nord.at>
	<200910312041.32158.laurent.pinchart@ideasonboard.com>
	<200910312115.08866@rk-nord.at>
Message-ID: <200911041551.55155.laurent.pinchart@ideasonboard.com>

Hi Melchior,

On Saturday 31 October 2009 21:15:08 Melchior FRANZ wrote:
> Hi,
> 
> * Laurent Pinchart -- Saturday 31 October 2009:
> > Could you please tell me the commercial name of the webcam, or in which
> > laptop model it can be found ?
> 
> I didn't mention that because the shop sells it under its own brand as just
> "Conrad Webcam mit Schwanenhals" (engl. "Webcam with Gooseneck") and an
>  article number (97 19 72). There's no producer mentioned or a 'proper'
>  article name. Just see the link that I posted -- that's all there is, and
>  nothing more on the box:
> 
>  
>  http://shop.conrad.at/ce/de/product/971972/CONRADWEBCAMMITSCHWANENHALS/132
> 0051
> 
> This cam is separate, not built into a laptop. Interesting design:
> 
>  
>  http://shop.conrad.at/medias/global/ce/9000_9999/9700/9710/9719/971972_AB_
> 00_FB.EPS_400.jpg
> 
> I assume(d) that it's produced by some "no-name" company (no, I don't mean
> eMPIA), and that every seller just slaps its brand on it. Then it would
> probably also be available under different, possibly better known names.

Thanks for the information.

> > >   $ cat /dev/video0
> > >   cat: /dev/video0: No such device
> > >
> > > although that device node works for video software.
> >
> > That's normal. The uvcvideo driver doesn't support the read() method.
> 
> Well, but the answer is still wrong and misleading. Wouldn't it be better
> to just return no data? IOW: the device *does* exist, but doesn't return
> anything that way.

Good point. The driver currently returns -ENODEV while the V4L2 spec states 
that it should return -EINVAL instead. I'll fix it.
 
> > Your luvcview version defaults to MJPEG and doesn't fall back to YUV
> > automatically. Your camera supports YUV only, so the default won't work.
> > luvcview -f yuv should work.
> 
> Oh, indeed! Thanks. (BTW: I had also tried the latest version from
> SVN (r19), but that doesn't compile due to missing header files.)

Could you complain to the luvcview maintainer on quickcamteam.net ? :-)

> > >    Oh, right. That's *so* going to work well. 500% enlargement through
> > >    interpolation, or "making up 24 pixel for every given pixel".   :-}
> 
> BTW: there are apps which deliver quite reasonable 500% or more
>  enlargement, but they'd be too slow for live pics. This Qt4/GPL3 one, for
>  example:
> 
>   http://imageenlarger.sourceforge.net/
>   $ svn co
>  https://imageenlarger.svn.sourceforge.net/svnroot/imageenlarger/trunk
>  imageenlarger $ qmake && make
> 
> Worth trying out if you are into such things!  :-)

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov  4 15:52:36 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 4 Nov 2009 15:52:36 +0100
Subject: [Linux-uvc-devel] eb1a:2571 "eMPIA Technology, Inc."  supported
In-Reply-To: <200911011507.50292@rk-nord.at>
References: <200910291337.42054@rk-nord.at>
	<20091101135458.GB8537@sunshine.barsnick.net>
	<200911011507.50292@rk-nord.at>
Message-ID: <200911041552.37059.laurent.pinchart@ideasonboard.com>

On Sunday 01 November 2009 15:07:49 Melchior FRANZ wrote:
> Hey,
> 
> * Moritz Barsnick -- Sunday 01 November 2009:
> > On Sat, Oct 31, 2009 at 21:15:08 +0100, Melchior FRANZ wrote:
> > [luvcview]
> >
> > > Ihad also tried the latest version from
> > > SVN (r19), but that doesn't compile due to missing header files.)
> >
> > I don't recall where I had the instructions from, but you need these
> > three additional files:
> 
> Argh ... it even says so in the README. (But who reads READMEs?! :-)
> I'm just too used to super-small applications building without having
> to resort to wget. That's just weird.
> 
> Sorry for the "false alarm", then ...  :-)

And sorry about asking you to complain, please ignore my comment.

-- 
Regards,

Laurent Pinchart


From R.E.Wolff at BitWizard.nl  Thu Nov  5 11:29:36 2009
From: R.E.Wolff at BitWizard.nl (Rogier Wolff)
Date: Thu, 5 Nov 2009 11:29:36 +0100
Subject: [Linux-uvc-devel] ViMicro Webcam 0ac8:3420 bug+fix
In-Reply-To: <200911041512.07598.laurent.pinchart@ideasonboard.com>
References: <20091022101355.GA16794@geggus.net>
	<200910281344.57130.laurent.pinchart@ideasonboard.com>
	<20091029180249.GA23230@geggus.net>
	<200911041512.07598.laurent.pinchart@ideasonboard.com>
Message-ID: <20091105102936.GB14407@bitwizard.nl>

On Wed, Nov 04, 2009 at 03:12:07PM +0100, Laurent Pinchart wrote:
> > BTW wouldn't it be better to make the quirks module parameter _overwrite_
> > camera specific quirks altogether instead of adding them with xor? This way
> > I would have been able to disable the quirks without patching the module.
> 
> It could be useful, but quirks activated by mistake (or not doing their job 
> properly) shouldn't occur often as those problems result of a driver bug. I 
> don't think there's really a need for this.

On the other hand, it is very easy to allow the user to override the
default in the driver. If the driver DOES have a mistake, allowing
people who cannot recompile kernel modules to debug the problem by
executing commands like 

   rmmod <module>
   modprobe <module> quirks=.... 

is much easier than when you have to go through a cycle of how to get
the source code, edit the source code, and then compile a new kernel
module, and then test THAT new module, and not the one in their
distribution.... 

	Roger. 

-- 
** R.E.Wolff at BitWizard.nl ** http://www.BitWizard.nl/ ** +31-15-2600998 **
**    Delftechpark 26 2628 XH  Delft, The Netherlands. KVK: 27239233    **
*-- BitWizard writes Linux device drivers for any device you may have! --*
Q: It doesn't work. A: Look buddy, doesn't work is an ambiguous statement. 
Does it sit on the couch all day? Is it unemployed? Please be specific! 
Define 'it' and what it isn't doing. --------- Adapted from lxrbot FAQ


From lists at fuchsschwanzdomain.de  Thu Nov  5 11:43:16 2009
From: lists at fuchsschwanzdomain.de (Sven Geggus)
Date: Thu, 05 Nov 2009 10:43:16 -0000
Subject: [Linux-uvc-devel] ViMicro Webcam 0ac8:3420 bug+fix
References: <20091022101355.GA16794@geggus.net>
	<200910281344.57130.laurent.pinchart@ideasonboard.com>
	<20091029180249.GA23230@geggus.net>
	<200911041512.07598.laurent.pinchart@ideasonboard.com>
	<20091105102936.GB14407@bitwizard.nl>
Message-ID: <hcua82$4r6$1@ultimate100.geggus.net>

Rogier Wolff <R.E.Wolff at bitwizard.nl> wrote:

> On the other hand, it is very easy to allow the user to override the
> default in the driver. If the driver DOES have a mistake, allowing
> people who cannot recompile kernel modules to debug the problem by
> executing commands like 
> 
>   rmmod <module>
>   modprobe <module> quirks=.... 
> 
> is much easier than when you have to go through a cycle of how to get
> the source code, edit the source code, and then compile a new kernel
> module, and then test THAT new module, and not the one in their
> distribution.... 

Actually using quirks=0 was the first thing I tried (even before looking at
the actual sourcecode) wondering why this did not change the behaviour of
the driver.

Looking at the Code I found that the commandline quirks Option does not take
preference over the hardcoded device-specific quirks. This has been somewhat
unhandy because I needed to patch the driver in order to be able to find the
bug.

Sven

-- 
"Those who do not understand Unix are condemned to reinvent it, poorly"
(Henry Spencer)

/me is giggls at ircnet, http://sven.gegg.us/ on the Web


From maumart2102 at hotmail.com  Thu Nov  5 17:34:54 2009
From: maumart2102 at hotmail.com (Mauricio martinez guerrero)
Date: Thu, 5 Nov 2009 16:34:54 +0000
Subject: [Linux-uvc-devel] reported UVC device
Message-ID: <COL102-W56F5B152AC02CBED180A2BBDB00@phx.gbl>


Hi
I am using  Ubuntu 9.04, I bought the webcam USB device and it
seems that it does not work in my laptop, the webcam is a Creative
Live! Cam Notebook Model VF0470.
I would really appreciate if you are able to help me since I want to install soon

thanks in advance
Chonta
 		 	   		  
_________________________________________________________________
Descubre IE8 con Otto
 www.otto.com.mx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091105/c2484c62/attachment.html>

From xfrancv at cmp.felk.cvut.cz  Fri Nov  6 14:57:26 2009
From: xfrancv at cmp.felk.cvut.cz (Vojtech Franc)
Date: Fri, 06 Nov 2009 14:57:26 +0100
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in the
	highest resolution
Message-ID: <4AF42B46.8030001@cmp.felk.cvut.cz>

Hi,

I have two Logitech Pro9000 cameras. I need to capture images from both
cameras simultaneously. It works perfectly unless I set both cameras to
the highest supported resolution which is 1600x1200 pixels/YUV color
format. Unfortunately, it is exactly the resolution I need in my
application. I tried this in the "luvcview" viewer as well as in
application written by myself which is based on Unicap library. In all
the cases, the behavior is the same: any combination of
resolutions/color formats works perfectly but the one when both cameras
are set to 1600x1200 pixels/YUV format. In this case, the first camera
starts capturing the images, however, the second one rejects to start.
It seems to be a problem on the driver's side.

Does anybody have a similar experience? Could you please advice who is
the author of the particular driver for the Logitech Pro9000 camera so
that I can contact him directly?

Thanks for help,
Vojtech




From pj.assis at gmail.com  Fri Nov  6 17:05:42 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 6 Nov 2009 16:05:42 +0000
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in
	the highest resolution
In-Reply-To: <4AF42B46.8030001@cmp.felk.cvut.cz>
References: <4AF42B46.8030001@cmp.felk.cvut.cz>
Message-ID: <59cf47a80911060805j3912cffbw6b0ba0a9f2a619dc@mail.gmail.com>

Hi,

> It seems to be a problem on the driver's side.

No, this is a usb bandwidth problem ( not enough :D )

Did you plug the cameras into the same usb controller ?

Try using different ones, one for each camera, usually for desktops
the front ports use a different controller from the back ones.

Best regards,
Paulo


From xfrancv at cmp.felk.cvut.cz  Sun Nov  8 22:26:35 2009
From: xfrancv at cmp.felk.cvut.cz (Vojtech Franc)
Date: Sun, 08 Nov 2009 22:26:35 +0100
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in
 the highest resolution
In-Reply-To: <59cf47a80911060805j3912cffbw6b0ba0a9f2a619dc@mail.gmail.com>
References: <4AF42B46.8030001@cmp.felk.cvut.cz>
	<59cf47a80911060805j3912cffbw6b0ba0a9f2a619dc@mail.gmail.com>
Message-ID: <4AF7378B.9080704@cmp.felk.cvut.cz>

Paulo Assis wrote:
> Hi,
>
>   
>> It seems to be a problem on the driver's side.
>>     
>
> No, this is a usb bandwidth problem ( not enough :D )
>
> Did you plug the cameras into the same usb controller ?
>
> Try using different ones, one for each camera, usually for desktops
> the front ports use a different controller from the back ones.
>
> Best regards,
> Paulo
>   
Dear Paolo,

thanks for reply. I tried to run my Logitech cameras in Windows XP and
Ubuntu using exactly the same hardware (I have double boot on my
notebook). Since in Windows it runs (2 x Logitech Pro9000 camera at
1600x1200/YUV) without problems means that it is not the (hardware)
bandwidth problem as you mentioned.

I also found out that both cameras are connected to the same USB 2
controller regardless to which physical port it is plugged:
$ lsusb
Bus 005 Device 004: ID 046d:0990 Logitech, Inc.
Bus 005 Device 002: ID 046d:0990 Logitech, Inc.

Maybe if I use additional (PCMCIA) USB card it will work, however, as I
mentioned in Windows it is not necessary.

If you have any other idea what might cause the problem I'll be obliged
to you for any hint.

Thanks,
Vojtech



From pj.assis at gmail.com  Mon Nov  9 00:04:36 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 8 Nov 2009 23:04:36 +0000
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in
	the highest resolution
In-Reply-To: <4AF7378B.9080704@cmp.felk.cvut.cz>
References: <4AF42B46.8030001@cmp.felk.cvut.cz>
	<59cf47a80911060805j3912cffbw6b0ba0a9f2a619dc@mail.gmail.com>
	<4AF7378B.9080704@cmp.felk.cvut.cz>
Message-ID: <59cf47a80911081504wf1d53c5nda4d6ee29842727b@mail.gmail.com>

Hi,
I tested this in my system and was able to grab two simultaneous YUYV
1600x1200 at 5fps video streams.
The cameras are two different uvc logitech models connected to two
separate usb controllers, my board has plenty of them :)
Connecting both cameras to the same controler (e.g. the two front
ports) will cause the second stream to fail.

I don't know about windows since I don't use it, but are you sure you
aren't getting a zoomed (1600x1200) image from a lower resolution?
maybe the windows driver is playing a trick on you.

BTW with some new camera models that support MJPG in high resolution
you should able to squeeze two MJPG 1600x1200 at 10fps video streams from
the same usb controller.

Best regards,
Paulo


2009/11/8 Vojtech Franc <xfrancv at cmp.felk.cvut.cz>:
> Paulo Assis wrote:
>> Hi,
>>
>>
>>> It seems to be a problem on the driver's side.
>>>
>>
>> No, this is a usb bandwidth problem ( not enough :D )
>>
>> Did you plug the cameras into the same usb controller ?
>>
>> Try using different ones, one for each camera, usually for desktops
>> the front ports use a different controller from the back ones.
>>
>> Best regards,
>> Paulo
>>
> Dear Paolo,
>
> thanks for reply. I tried to run my Logitech cameras in Windows XP and
> Ubuntu using exactly the same hardware (I have double boot on my
> notebook). Since in Windows it runs (2 x Logitech Pro9000 camera at
> 1600x1200/YUV) without problems means that it is not the (hardware)
> bandwidth problem as you mentioned.
>
> I also found out that both cameras are connected to the same USB 2
> controller regardless to which physical port it is plugged:
> $ lsusb
> Bus 005 Device 004: ID 046d:0990 Logitech, Inc.
> Bus 005 Device 002: ID 046d:0990 Logitech, Inc.
>
> Maybe if I use additional (PCMCIA) USB card it will work, however, as I
> mentioned in Windows it is not necessary.
>
> If you have any other idea what might cause the problem I'll be obliged
> to you for any hint.
>
> Thanks,
> Vojtech
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From co2.dehaut at bluewin.ch  Mon Nov  9 09:47:40 2009
From: co2.dehaut at bluewin.ch (co2.dehaut at bluewin.ch)
Date: Mon, 9 Nov 2009 08:47:40 +0000 (GMT)
Subject: [Linux-uvc-devel] Uvcvideo driver problem on Ubuntu Karmic
Message-ID: <372468.49911257756460327.JavaMail.webmail@ps9zhb.bluewin.ch>




Hello ,

I just install Ubuntu Karmic on my Dell Vostro 1710 and I meet a
problem with my integrated camera.

<code>Bus 002 Device 003: ID 0c45:63e0 Microdia Sonix Integrated Webcam</code>


When I was on Ubuntu Jaunty , I never met this problem ,so I installed
the uvcvideo driver with easycam.

And now ,Easycam is not available on Karmic.Dependency problem with python-xml package.



I tried to install the new driver but it's not working .

So I read that on Berlios website :

?Linux 2.6.26 and newer includes the
Linux UVC driver natively.?

?Source code for the Linux UVC kernel driver is maintained in a
Mercurial repository on linuxtv.org.?

?Older versions can still be found in the Linux UVC Subversion
repository on the BerliOS project page. Please do not use those
versions for anything else than historical purpose.?

In
first time ,I installed the driver with subversion and no good
result.In a second time ,I tried with the mercurial and I had the same
thing.......



My questions are : How can I work my camera with the new driver ?
Is it possible to have the latest version of this driver ?


My kernel  version is 2.6.31.14.....for the moment...



Best regards



Olivier DEHAUT 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091109/aa2aef4a/attachment.html>

From stephan.diestelhorst at gmail.com  Tue Nov 10 16:59:04 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Tue, 10 Nov 2009 16:59:04 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
Message-ID: <200911101659.04593.stephan.diestelhorst@gmail.com>

Hi Linux UVC developers,
  apologies for spamming this list with an opened berlios bug item
(#103031), but the bugs
there seem to not get any attention anymore.

This issue is with the built-in Bison web cam in an MSI Wind U100.
Once the camera is enabled (via hotkey), the entire USB
subsystem is not responding anymore, causing
non-detection of freshly attached USB devices and
prevents suspending the box.

The only fix so far is to blacklist the "uvcvideo"
module or to keep the cam disabled (with hotkey).

This is with a stable 2.6.31-14-generic kernel on
Ubuntu Karmic.

A number of related resources:
  https://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352 contains
many user reports.

  http://marc.info/?l=linux-kernel&m=125541673726384&w=2 a stalled
discussion on the LKML with more technical insight

  https://lists.berlios.de/pipermail/linux-uvc-devel/2009-September/005143.html
a stalled discussion on the linux-uvc-devel ML

  https://lists.berlios.de/pipermail/linux-uvc-devel/2009-September/005143.html
is (according to launchpad) the breaking changeset.

This is a very unpleasant bug, as it affects the
usability of the system a lot and is a regression:
Kernel 2.6.28 worked flawless with the webcam.

Keep up the good work!

Many thanks and again, sorry for cross-posting,
  Stephan


From shmera at gmail.com  Tue Nov 10 17:03:50 2009
From: shmera at gmail.com (Ramesh Rajagopal)
Date: Tue, 10 Nov 2009 21:33:50 +0530
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on a
	device? Some doubts need clarification.
Message-ID: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>

Hi,
      I am trying to implement UVC bulk tranfer for my webcam. I am getting
some difficulties.
If anybody has already tried, Can you please send me the enumeration
details.?

Does this same as ISOC transfer or is it different, If so, Please give me
those details.



Thanks & Regards,
Ramesh.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091110/7abb617f/attachment.html>

From stephan.diestelhorst at gmail.com  Tue Nov 10 17:22:37 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Tue, 10 Nov 2009 17:22:37 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <200911101659.04593.stephan.diestelhorst@gmail.com>
References: <200911101659.04593.stephan.diestelhorst@gmail.com>
Message-ID: <200911101722.37373.stephan.diestelhorst@gmail.com>

>   https://lists.berlios.de/pipermail/linux-uvc-devel/2009-September/005143.html
> is (according to launchpad) the breaking changeset.

Sorry, this was a copy & paste error. Correct changeset URL is:
http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=04a37e0f32f9882430bc1899899d2ed91b8aaf5b

Kind regards,
  Stephan


From laurent.pinchart at ideasonboard.com  Tue Nov 10 23:34:45 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 10 Nov 2009 23:34:45 +0100
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in
	the highest resolution
In-Reply-To: <59cf47a80911081504wf1d53c5nda4d6ee29842727b@mail.gmail.com>
References: <4AF42B46.8030001@cmp.felk.cvut.cz>
	<4AF7378B.9080704@cmp.felk.cvut.cz>
	<59cf47a80911081504wf1d53c5nda4d6ee29842727b@mail.gmail.com>
Message-ID: <200911102334.45564.laurent.pinchart@ideasonboard.com>

On Monday 09 November 2009 00:04:36 Paulo Assis wrote:
> Hi,
> I tested this in my system and was able to grab two simultaneous YUYV
> 1600x1200 at 5fps video streams.
> The cameras are two different uvc logitech models connected to two
> separate usb controllers, my board has plenty of them :)
> Connecting both cameras to the same controler (e.g. the two front
> ports) will cause the second stream to fail.
> 
> I don't know about windows since I don't use it, but are you sure you
> aren't getting a zoomed (1600x1200) image from a lower resolution?
> maybe the windows driver is playing a trick on you.

That's one possibility.

If I remember correctly Windows might be violating the USB spec by allowing 
devices to use more than 80% of the available bandwidth for periodic 
(isochronous and interrupt) transfers. Or it might calculate the bandwith 
slightly differently than Linux.

In any case, the problem under Linux comes from the fact that the USB core 
rejects the uvcvideo driver's request to allocate bandwidth for the second 
camera because not enough bandwidth is available. The uvcvideo driver can't do 
much about it.

Now, the camera might lie about the bandwidth it really requires, and it might 
be possible to hack the driver to request less bandwidth and still get away 
with it. I have some doubts that this would work though, but it might be worth 
a try.

As you've written your own userspace software I assume you're familiar with C 
programming so I'll just give you a few pointers to hack on the driver :-)

USB bandwidth allocation is done in the uvc_init_video() function 
(uvc_video.c) by a call to usb_set_interface(). You can check which alternate 
setting the driver requests by printing the value of variable 'i'.

A look at the camera's USB descriptors (lsusb -v) will show you a list of 
alternate settings for the video streaming interface. Each alternate setting 
has different packet sizes for the isochronous endpoint. Locate the alternate 
setting with the biggest packet size below the one requested by the driver, 
and modify uvc_init_video() to hardcode that alternate setting. If that's 
still too much bandwidth, repeat the procedure until you can start streaming 
on both cameras.

The driver will then probably get corrupted data (lost packets), but it could 
be worth a try.

> BTW with some new camera models that support MJPG in high resolution
> you should able to squeeze two MJPG 1600x1200 at 10fps video streams from
> the same usb controller.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Tue Nov 10 23:35:54 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 10 Nov 2009 23:35:54 +0100
Subject: [Linux-uvc-devel] reported UVC device
In-Reply-To: <COL102-W56F5B152AC02CBED180A2BBDB00@phx.gbl>
References: <COL102-W56F5B152AC02CBED180A2BBDB00@phx.gbl>
Message-ID: <200911102335.54866.laurent.pinchart@ideasonboard.com>

Hi Mauricio,

On Thursday 05 November 2009 17:34:54 Mauricio martinez guerrero wrote:
> Hi
> I am using  Ubuntu 9.04, I bought the webcam USB device and it
> seems that it does not work in my laptop, the webcam is a Creative
> Live! Cam Notebook Model VF0470.
> I would really appreciate if you are able to help me since I want to
>  install soon

Could you please send me the USB descriptors for your webcam ? You can 
retrieve them with

lsusb -v

using usbutils 0.72 or newer (0.73+ preferred).

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Tue Nov 10 23:41:34 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 10 Nov 2009 23:41:34 +0100
Subject: [Linux-uvc-devel] ViMicro Webcam 0ac8:3420 bug+fix
In-Reply-To: <20091104141750.GA11445@geggus.net>
References: <20091022101355.GA16794@geggus.net>
	<200911041512.07598.laurent.pinchart@ideasonboard.com>
	<20091104141750.GA11445@geggus.net>
Message-ID: <200911102341.34099.laurent.pinchart@ideasonboard.com>

On Wednesday 04 November 2009 15:17:50 Sven Geggus wrote:
> Laurent Pinchart schrieb am Mittwoch, den 04. November um 15:12 Uhr:
> > Thanks. I'll apply the patch then.
> 
> Any Idea if/when these patches are going to hit mainline?

They're in the linuxtv.org git tree, they should hit mainline ASAP, hopefully 
in time for 2.6.32.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Tue Nov 10 23:43:14 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 10 Nov 2009 23:43:14 +0100
Subject: [Linux-uvc-devel] ViMicro Webcam 0ac8:3420 bug+fix
In-Reply-To: <20091105102936.GB14407@bitwizard.nl>
References: <20091022101355.GA16794@geggus.net>
	<200911041512.07598.laurent.pinchart@ideasonboard.com>
	<20091105102936.GB14407@bitwizard.nl>
Message-ID: <200911102343.14238.laurent.pinchart@ideasonboard.com>

Hi Rogier,

On Thursday 05 November 2009 11:29:36 Rogier Wolff wrote:
> On Wed, Nov 04, 2009 at 03:12:07PM +0100, Laurent Pinchart wrote:
> > > BTW wouldn't it be better to make the quirks module parameter
> > > _overwrite_ camera specific quirks altogether instead of adding them
> > > with xor? This way I would have been able to disable the quirks without
> > > patching the module.
> >
> > It could be useful, but quirks activated by mistake (or not doing their
> > job properly) shouldn't occur often as those problems result of a driver
> > bug. I don't think there's really a need for this.
> 
> On the other hand, it is very easy to allow the user to override the
> default in the driver. If the driver DOES have a mistake, allowing
> people who cannot recompile kernel modules to debug the problem by
> executing commands like
> 
>    rmmod <module>
>    modprobe <module> quirks=....
> 
> is much easier than when you have to go through a cycle of how to get
> the source code, edit the source code, and then compile a new kernel
> module, and then test THAT new module, and not the one in their
> distribution....

You have a point. My concern is that it could break systems with multiple UVC 
devices requiring different quirks, but as setting quirks= is (or at least 
should) be for testing only this isn't really an issue.

I'll prepare and submit a patch.

-- 
Regards,

Laurent Pinchart


From xfrancv at cmp.felk.cvut.cz  Tue Nov 10 23:57:51 2009
From: xfrancv at cmp.felk.cvut.cz (Vojtech Franc)
Date: Tue, 10 Nov 2009 23:57:51 +0100
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in
 the highest resolution
In-Reply-To: <59cf47a80911081504wf1d53c5nda4d6ee29842727b@mail.gmail.com>
References: <4AF42B46.8030001@cmp.felk.cvut.cz>	
	<59cf47a80911060805j3912cffbw6b0ba0a9f2a619dc@mail.gmail.com>	
	<4AF7378B.9080704@cmp.felk.cvut.cz>
	<59cf47a80911081504wf1d53c5nda4d6ee29842727b@mail.gmail.com>
Message-ID: <4AF9EFEF.5050200@cmp.felk.cvut.cz>

Dear Paulo,

Paulo Assis wrote:
> Hi,
> I tested this in my system and was able to grab two simultaneous YUYV
> 1600x1200 at 5fps video streams.
> The cameras are two different uvc logitech models connected to two
> separate usb controllers, my board has plenty of them :)
> Connecting both cameras to the same controler (e.g. the two front
> ports) will cause the second stream to fail.
>   
it turned out that the computer on which we need to run the application
has also two separate USB controllers. The output of the second
controller was hidden on the motherboard and was not connected to the
USB connectors on the case so I needed some cables to connect it. The
important is that when cameras are connect to these separate USB
controllers IT INDEED WORKS in the highest resolution. Thanks a lot for
the hint.

> I don't know about windows since I don't use it, but are you sure you
> aren't getting a zoomed (1600x1200) image from a lower resolution?
> maybe the windows driver is playing a trick on you.
>   
Well, this is still an open question. I'm sure that the computer I used
has just a single USB2 controller. I tested the cameras in an original
Logitech software which allows to setup all camera modes. I would assume
that if one selects 1600x1200 YUYV then the software will use this exact
setting though in Windows one never knowns... It is true that there was
also other "suspicious" modes with resolution higher than 1600x1200. Now
when it runs in Linux I don't have a motivation to investigate this more.

Thanks again for your help.

Best regards,
Vojtech
> BTW with some new camera models that support MJPG in high resolution
> you should able to squeeze two MJPG 1600x1200 at 10fps video streams from
> the same usb controller.
>
> Best regards,
> Paulo
>
>
> 2009/11/8 Vojtech Franc <xfrancv at cmp.felk.cvut.cz>:
>   
>> Paulo Assis wrote:
>>     
>>> Hi,
>>>
>>>
>>>       
>>>> It seems to be a problem on the driver's side.
>>>>
>>>>         
>>> No, this is a usb bandwidth problem ( not enough :D )
>>>
>>> Did you plug the cameras into the same usb controller ?
>>>
>>> Try using different ones, one for each camera, usually for desktops
>>> the front ports use a different controller from the back ones.
>>>
>>> Best regards,
>>> Paulo
>>>
>>>       
>> Dear Paolo,
>>
>> thanks for reply. I tried to run my Logitech cameras in Windows XP and
>> Ubuntu using exactly the same hardware (I have double boot on my
>> notebook). Since in Windows it runs (2 x Logitech Pro9000 camera at
>> 1600x1200/YUV) without problems means that it is not the (hardware)
>> bandwidth problem as you mentioned.
>>
>> I also found out that both cameras are connected to the same USB 2
>> controller regardless to which physical port it is plugged:
>> $ lsusb
>> Bus 005 Device 004: ID 046d:0990 Logitech, Inc.
>> Bus 005 Device 002: ID 046d:0990 Logitech, Inc.
>>
>> Maybe if I use additional (PCMCIA) USB card it will work, however, as I
>> mentioned in Windows it is not necessary.
>>
>> If you have any other idea what might cause the problem I'll be obliged
>> to you for any hint.
>>
>> Thanks,
>> Vojtech
>>
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
>>     
>
>
>   


-- 
--------------------------------------------------------------
Vojtech Franc, Ph.D.
Research fellow

Center for Machine Perception
Department of Cybernetics
Faculty of Electrical Engineering
Czech Technical University in Prague

email: xfrancv at cmp.felk.cvut.cz
www: http://cmp.felk.cvut.cz/~xfrancv
phone: +420 22435 7665
--------------------------------------------------------------



From xfrancv at cmp.felk.cvut.cz  Wed Nov 11 00:11:45 2009
From: xfrancv at cmp.felk.cvut.cz (Vojtech Franc)
Date: Wed, 11 Nov 2009 00:11:45 +0100
Subject: [Linux-uvc-devel] Problem with using two Logitech Pro9000 in
 the highest resolution
In-Reply-To: <200911102334.45564.laurent.pinchart@ideasonboard.com>
References: <4AF42B46.8030001@cmp.felk.cvut.cz>
	<4AF7378B.9080704@cmp.felk.cvut.cz>
	<59cf47a80911081504wf1d53c5nda4d6ee29842727b@mail.gmail.com>
	<200911102334.45564.laurent.pinchart@ideasonboard.com>
Message-ID: <4AF9F331.4000406@cmp.felk.cvut.cz>

Dear Laurent,

Laurent Pinchart wrote:
> On Monday 09 November 2009 00:04:36 Paulo Assis wrote:
>   
>> Hi,
>> I tested this in my system and was able to grab two simultaneous YUYV
>> 1600x1200 at 5fps video streams.
>> The cameras are two different uvc logitech models connected to two
>> separate usb controllers, my board has plenty of them :)
>> Connecting both cameras to the same controler (e.g. the two front
>> ports) will cause the second stream to fail.
>>
>> I don't know about windows since I don't use it, but are you sure you
>> aren't getting a zoomed (1600x1200) image from a lower resolution?
>> maybe the windows driver is playing a trick on you.
>>     
>
> That's one possibility.
>
> If I remember correctly Windows might be violating the USB spec by allowing 
> devices to use more than 80% of the available bandwidth for periodic 
> (isochronous and interrupt) transfers. Or it might calculate the bandwith 
> slightly differently than Linux.
>
> In any case, the problem under Linux comes from the fact that the USB core 
> rejects the uvcvideo driver's request to allocate bandwidth for the second 
> camera because not enough bandwidth is available. The uvcvideo driver can't do 
> much about it.
>
> Now, the camera might lie about the bandwidth it really requires, and it might 
> be possible to hack the driver to request less bandwidth and still get away 
> with it. I have some doubts that this would work though, but it might be worth 
> a try.
>   

This sounds like very likely explanation of my different Linux/Windows
experience.

Thanks also for the hint how to hack the driver. Fortunately, I can
avoid hacking the driver as I solved the problem by using two separate
USB controllers. But I'll look to the code just for curiosity... Thanks
anyway for your reply.

Regards,
Vojtech
> As you've written your own userspace software I assume you're familiar with C 
> programming so I'll just give you a few pointers to hack on the driver :-)
>
> USB bandwidth allocation is done in the uvc_init_video() function 
> (uvc_video.c) by a call to usb_set_interface(). You can check which alternate 
> setting the driver requests by printing the value of variable 'i'.
>
> A look at the camera's USB descriptors (lsusb -v) will show you a list of 
> alternate settings for the video streaming interface. Each alternate setting 
> has different packet sizes for the isochronous endpoint. Locate the alternate 
> setting with the biggest packet size below the one requested by the driver, 
> and modify uvc_init_video() to hardcode that alternate setting. If that's 
> still too much bandwidth, repeat the procedure until you can start streaming 
> on both cameras.
>
> The driver will then probably get corrupted data (lost packets), but it could 
> be worth a try.
>
>   
>> BTW with some new camera models that support MJPG in high resolution
>> you should able to squeeze two MJPG 1600x1200 at 10fps video streams from
>> the same usb controller.
>>     
>
>   


-- 
--------------------------------------------------------------
Vojtech Franc, Ph.D.
Research fellow

Center for Machine Perception
Department of Cybernetics
Faculty of Electrical Engineering
Czech Technical University in Prague

email: xfrancv at cmp.felk.cvut.cz
www: http://cmp.felk.cvut.cz/~xfrancv
phone: +420 22435 7665
--------------------------------------------------------------



From laurent.pinchart at ideasonboard.com  Wed Nov 11 00:26:02 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 11 Nov 2009 00:26:02 +0100
Subject: [Linux-uvc-devel] Uvcvideo driver problem on Ubuntu Karmic
In-Reply-To: <372468.49911257756460327.JavaMail.webmail@ps9zhb.bluewin.ch>
References: <372468.49911257756460327.JavaMail.webmail@ps9zhb.bluewin.ch>
Message-ID: <200911110026.02702.laurent.pinchart@ideasonboard.com>

Hi Olivier,

On Monday 09 November 2009 09:47:40 co2.dehaut at bluewin.ch wrote:
> Hello ,
> 
> I just install Ubuntu Karmic on my Dell Vostro 1710 and I meet a
> problem with my integrated camera.
> 
> <code>Bus 002 Device 003: ID 0c45:63e0 Microdia Sonix Integrated
>  Webcam</code>
> 
> When I was on Ubuntu Jaunty , I never met this problem ,so I installed
> the uvcvideo driver with easycam.
> 
> And now ,Easycam is not available on Karmic.Dependency problem with
>  python-xml package.
> 
> I tried to install the new driver but it's not working .
> 
> So I read that on Berlios website :
> 
> ?Linux 2.6.26 and newer includes the Linux UVC driver natively.?
> 
> ?Source code for the Linux UVC kernel driver is maintained in a
> Mercurial repository on linuxtv.org.?
> 
> ?Older versions can still be found in the Linux UVC Subversion
> repository on the BerliOS project page. Please do not use those
> versions for anything else than historical purpose.?
> 
> In first time, I installed the driver with subversion and no good
> result.In a second time,

The subversion repository is outdated and shouldn't be used.

> I tried with the mercurial and I had the same thing.......

The mercurial repository is where active development happens. You can grab the 
latest source tarball from 
http://linuxtv.org/hg/~pinchartl/uvcvideo/archive/tip.tar.bz2

> My questions are : How can I work my camera with the new driver ?

The uvcvideo driver is available in Ubuntu 9.10. It should detect your camera 
automatically. Does it fail to do so ?

Check if the driver is loaded automatically using the lsmod command. If it 
isn't, try to load it manually with

sudo modprobe uvcvideo

You can use the dmesg command to read the kernel log and search for messages 
printed by the uvcvideo driver.

> Is it possible to have the latest version of this driver ?
> 
> My kernel  version is 2.6.31.14.....for the moment...

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 11 00:39:43 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 11 Nov 2009 00:39:43 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <200911101659.04593.stephan.diestelhorst@gmail.com>
References: <200911101659.04593.stephan.diestelhorst@gmail.com>
Message-ID: <200911110039.43159.laurent.pinchart@ideasonboard.com>

Hi Stephan,

On Tuesday 10 November 2009 16:59:04 Stephan Diestelhorst wrote:
> Hi Linux UVC developers,
>   apologies for spamming this list with an opened berlios bug item
> (#103031), but the bugs there seem to not get any attention anymore.

No need to apologize. The berlios web-based support system is not actively 
used by the project.

> This issue is with the built-in Bison web cam in an MSI Wind U100. Once the
> camera is enabled (via hotkey), the entire USB subsystem is not responding
> anymore, causing non-detection of freshly attached USB devices and prevents
> suspending the box.
> 
> The only fix so far is to blacklist the "uvcvideo" module or to keep the cam
> disabled (with hotkey).
> 
> This is with a stable 2.6.31-14-generic kernel on Ubuntu Karmic.
> 
> A number of related resources:
>   https://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352 contains
> many user reports.
> 
>   http://marc.info/?l=linux-kernel&m=125541673726384&w=2 a stalled
> discussion on the LKML with more technical insight
> 
>  https://lists.berlios.de/pipermail/linux-uvc-devel/2009-September/005143.h
> tml a stalled discussion on the linux-uvc-devel ML
>  
>  https://lists.berlios.de/pipermail/linux-uvc-devel/2009-September/005143.h
> tml is (according to launchpad) the breaking changeset.
> 
> This is a very unpleasant bug, as it affects the usability of the system a
> lot and is a regression: Kernel 2.6.28 worked flawless with the webcam.

Even though the git commit that caused the regression modifies the uvcvideo 
driver, this is an issue that need to be solved at the USB core level. The 
commit's purpose is to enable autosuspend, but a nasty side effect kills USB 
on some (buggy ?) controllers because an interrupt URB is canceled too fast 
after being submitted.

> Keep up the good work!

Thanks.

> Many thanks and again, sorry for cross-posting,

Once again no apologize needed. You should keep cross-posting and report the 
problem to the linux-usb mailing list. I'm not familiar enough with the EHCI 
architecture to work on a fix, so the solution will likely come from linux-usb 
developers.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 11 00:43:54 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 11 Nov 2009 00:43:54 +0100
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
Message-ID: <200911110043.54288.laurent.pinchart@ideasonboard.com>

Hi Ramesh,

On Tuesday 10 November 2009 17:03:50 Ramesh Rajagopal wrote:
> Hi,
> I am trying to implement UVC bulk tranfer for my webcam. I am getting some
> difficulties.
> If anybody has already tried, Can you please send me the enumeration
> details.?

Are you developing a webcam ? Is it Linux-based ? If so, are you using the UVC 
gadget driver I've posted to the linux-usb mailing list some time ago ?

You will find sample USB descriptors for a bulk device attached to this e-
mail.

> Does this same as ISOC transfer or is it different, If so, Please give me
> those details.

What about reading the UVC spec ?

-- 
Regards,

Laurent Pinchart
-------------- next part --------------

Bus 005 Device 002: ID 19ab:1000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x19ab 
  idProduct          0x1000 
  bcdDevice            1.29
  iManufacturer           1 Bodelin
  iProduct                2 ProScope HR
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          274
    bNumInterfaces          3
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              250mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               2 ProScope HR
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              2 ProScope HR
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           51
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0000000a
          Auto-Exposure Mode
          Exposure Time (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x000024df
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          White Balance Temperature
          White Balance Component
          Power Line Frequency
          White Balance Component, Auto
        iProcessing             0 
        bmVideoStandards     0x 9
          None
          SECAM - 625/50
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        1
        wTotalLength                      137
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                3
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 73728000
        dwMaxBitRate                 73728000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)            666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 78643200
        dwMaxBitRate                 78643200
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        2666666
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2666666
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 36864000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass         3 Human Interface Device
      bInterfaceSubClass      0 No Subclass
      bInterfaceProtocol      0 None
      iInterface              0 
      Warning: Descriptor too short
        HID Device Descriptor:
          bLength                 9
          bDescriptorType        33
          bcdHID               1.10
          bCountryCode            0 Not supported
          bNumDescriptors         2
          bDescriptorType        34 Report
          wDescriptorLength      50
          bDescriptorType         0 (null)
          wDescriptorLength       0
          Report Descriptor: (length is 50)
            Item(Global): Usage Page, data= [ 0xa0 0xff ] 65440
                            (null)
            Item(Local ): Usage, data= [ 0x01 ] 1
                            (null)
            Item(Main  ): Collection, data= [ 0x01 ] 1
                            Application
            Item(Local ): Usage, data= [ 0x02 ] 2
                            (null)
            Item(Main  ): Collection, data= [ 0x00 ] 0
                            Physical
            Item(Global): Usage Page, data= [ 0xa1 0xff ] 65441
                            (null)
            Item(Local ): Usage, data= [ 0x03 ] 3
                            (null)
            Item(Local ): Usage, data= [ 0x04 ] 4
                            (null)
            Item(Global): Logical Minimum, data= [ 0x00 ] 0
            Item(Global): Logical Maximum, data= [ 0x01 ] 1
            Item(Global): Report Size, data= [ 0x01 ] 1
            Item(Global): Report Count, data= [ 0x01 ] 1
            Item(Main  ): Input, data= [ 0x02 ] 2
                            Data Variable Absolute No_Wrap Linear
                            Preferred_State No_Null_Position Non_Volatile Bitfield
            Item(Global): Report Size, data= [ 0x07 ] 7
            Item(Global): Report Count, data= [ 0x01 ] 1
            Item(Main  ): Input, data= [ 0x01 ] 1
                            Constant Array Absolute No_Wrap Linear
                            Preferred_State No_Null_Position Non_Volatile Bitfield
            Item(Local ): Usage, data= [ 0x05 ] 5
                            (null)
            Item(Local ): Usage, data= [ 0x06 ] 6
                            (null)
            Item(Global): Logical Minimum, data= [ 0x00 ] 0
            Item(Global): Logical Maximum, data= [ 0xff ] 255
            Item(Global): Report Size, data= [ 0x08 ] 8
            Item(Global): Report Count, data= [ 0x40 ] 64
            Item(Main  ): Output, data= [ 0x02 ] 2
                            Data Variable Absolute No_Wrap Linear
                            Preferred_State No_Null_Position Non_Volatile Bitfield
            Item(Main  ): End Collection, data=none
            Item(Main  ): End Collection, data=none
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval              10
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x06  EP 6 OUT
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval              10
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled

From maumart2102 at hotmail.com  Wed Nov 11 02:12:21 2009
From: maumart2102 at hotmail.com (Mauricio martinez guerrero)
Date: Wed, 11 Nov 2009 01:12:21 +0000
Subject: [Linux-uvc-devel] reported UVC device
In-Reply-To: <200911102335.54866.laurent.pinchart@ideasonboard.com>
References: <COL102-W56F5B152AC02CBED180A2BBDB00@phx.gbl>
Message-ID: <COL102-W37E8325261582CB57BB7C3BDAA0@phx.gbl>


hi Laurent, here I sent the USB descriptors 
sorry if it is too long but I was not able to reduce the size
regards
Mauricio


Bus 005 Device 002: ID 0930:1302 Toshiba Corp. Wireless Broadband (3G HSDPA) SM-Bus Minicard Status Port
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0930 Toshiba Corp.
  idProduct          0x1302 Wireless Broadband (3G HSDPA) SM-Bus Minicard Status Port
  bcdDevice            0.00
  iManufacturer           1 
  iProduct                2 
  iSerial                 2 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          108
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval             128
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x06  EP 6 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x87  EP 7 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x07  EP 7 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
cannot read device status, Operation not permitted (1)

Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  idVendor           0x1d6b Linux Foundation
  idProduct          0x0001 1.1 root hub
  bcdDevice            2.06
  iManufacturer           3 
  iProduct                2 
  iSerial                 1 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
can't get hub descriptor: Operation not permitted
cannot read device status, Operation not permitted (1)

Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  idVendor           0x1d6b Linux Foundation
  idProduct          0x0002 2.0 root hub
  bcdDevice            2.06
  iManufacturer           3 
  iProduct                2 
  iSerial                 1 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval              12
can't get hub descriptor: Operation not permitted
can't get device qualifier: Operation not permitted
can't get debug descriptor: Operation not permitted
cannot read device status, Operation not permitted (1)

Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  idVendor           0x1d6b Linux Foundation
  idProduct          0x0001 1.1 root hub
  bcdDevice            2.06
  iManufacturer           3 
  iProduct                2 
  iSerial                 1 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
can't get hub descriptor: Operation not permitted
cannot read device status, Operation not permitted (1)

Bus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  idVendor           0x1d6b Linux Foundation
  idProduct          0x0001 1.1 root hub
  bcdDevice            2.06
  iManufacturer           3 
  iProduct                2 
  iSerial                 1 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
can't get hub descriptor: Operation not permitted
cannot read device status, Operation not permitted (1)




> From: laurent.pinchart at ideasonboard.com
> To: linux-uvc-devel at lists.berlios.de
> Subject: Re: [Linux-uvc-devel] reported UVC device
> Date: Tue, 10 Nov 2009 23:35:54 +0100
> CC: maumart2102 at hotmail.com
> 
> Hi Mauricio,
> 
> On Thursday 05 November 2009 17:34:54 Mauricio martinez guerrero wrote:
> > Hi
> > I am using  Ubuntu 9.04, I bought the webcam USB device and it
> > seems that it does not work in my laptop, the webcam is a Creative
> > Live! Cam Notebook Model VF0470.
> > I would really appreciate if you are able to help me since I want to
> >  install soon
> 
> Could you please send me the USB descriptors for your webcam ? You can 
> retrieve them with
> 
> lsusb -v
> 
> using usbutils 0.72 or newer (0.73+ preferred).
> 
> -- 
> Regards,
> 
> Laurent Pinchart
 		 	   		  
_________________________________________________________________
Todo lo que te gusta de Internet en un mismo lugar
www.messengernews.com.mx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091111/6ab38837/attachment.html>

From pbaena at gmail.com  Wed Nov 11 11:16:46 2009
From: pbaena at gmail.com (Pablo Baena)
Date: Wed, 11 Nov 2009 07:16:46 -0300
Subject: [Linux-uvc-devel] Problem with MSI StarCam 370i
In-Reply-To: <200910212342.24372.laurent.pinchart@ideasonboard.com>
References: <36be2c7a0910141220h6dbd7a6cn89d203b870bb99b0@mail.gmail.com>
	<200910161122.41916.laurent.pinchart@ideasonboard.com>
	<36be2c7a0910160816nd8a6995ve02e37f92341a012@mail.gmail.com>
	<200910212342.24372.laurent.pinchart@ideasonboard.com>
Message-ID: <36be2c7a0911110216x4afd50e2r45995345b91131e9@mail.gmail.com>

Hi Laurent, I finally got time to test this, but I'm failing to
compile uvcvideo.

I got this error:

/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:21:17:
error: dma.h: No such file or directory
/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:22:21:
error: csr1212.h: No such file or directory
/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:23:23:
error: highlevel.h: No such file or directory
/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:24:19:
error: hosts.h: No such file or directory
/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:25:22:
error: ieee1394.h: No such file or directory
/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:26:17:
error: iso.h: No such file or directory
/home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:27:21:
error: nodemgr.h: No such file or directory

On Wed, Oct 21, 2009 at 6:42 PM, Laurent Pinchart
<laurent.pinchart at ideasonboard.com> wrote:
> Hi Pablo,
>
> On Friday 16 October 2009 17:16:11 Pablo Baena wrote:
>> Hi Laurent:
>> Where can I get the latest driver?
>
> http://linuxtv.org/hg/~pinchartl/uvcvideo
>
>> I upgraded to linux 2.6.31-14 and I still require quirks 2.
>
> I've committed a patch to the uvcvideo repository. You shouldn't need quirks=2
> anymore with the latest driver. Could you please test and confirm ?
>
> --
> Regards,
>
> Laurent Pinchart
>



-- 
"Not possessing the gift of reflection, a dog does not know that he
does not know, and does not understand that he understands nothing;
we, on the other hand, are aware of both. If we behave otherwise, it
is from stupidity, or else from self-deception, to preserve our peace
of mind."


From pj.assis at gmail.com  Wed Nov 11 12:00:21 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 11 Nov 2009 11:00:21 +0000
Subject: [Linux-uvc-devel] Problem with MSI StarCam 370i
In-Reply-To: <36be2c7a0911110216x4afd50e2r45995345b91131e9@mail.gmail.com>
References: <36be2c7a0910141220h6dbd7a6cn89d203b870bb99b0@mail.gmail.com>
	<200910161122.41916.laurent.pinchart@ideasonboard.com>
	<36be2c7a0910160816nd8a6995ve02e37f92341a012@mail.gmail.com>
	<200910212342.24372.laurent.pinchart@ideasonboard.com>
	<36be2c7a0911110216x4afd50e2r45995345b91131e9@mail.gmail.com>
Message-ID: <59cf47a80911110300h431e4446n48d1c259a3ab228d@mail.gmail.com>

Pablo Hi,

Disable firedtv with 'make menuconfig'

Best regards,
Paulo

2009/11/11 Pablo Baena <pbaena at gmail.com>:
> Hi Laurent, I finally got time to test this, but I'm failing to
> compile uvcvideo.
>
> I got this error:
>
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:21:17:
> error: dma.h: No such file or directory
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:22:21:
> error: csr1212.h: No such file or directory
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:23:23:
> error: highlevel.h: No such file or directory
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:24:19:
> error: hosts.h: No such file or directory
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:25:22:
> error: ieee1394.h: No such file or directory
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:26:17:
> error: iso.h: No such file or directory
> /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:27:21:
> error: nodemgr.h: No such file or directory
>
> On Wed, Oct 21, 2009 at 6:42 PM, Laurent Pinchart
> <laurent.pinchart at ideasonboard.com> wrote:
>> Hi Pablo,
>>
>> On Friday 16 October 2009 17:16:11 Pablo Baena wrote:
>>> Hi Laurent:
>>> Where can I get the latest driver?
>>
>> http://linuxtv.org/hg/~pinchartl/uvcvideo
>>
>>> I upgraded to linux 2.6.31-14 and I still require quirks 2.
>>
>> I've committed a patch to the uvcvideo repository. You shouldn't need quirks=2
>> anymore with the latest driver. Could you please test and confirm ?
>>
>> --
>> Regards,
>>
>> Laurent Pinchart
>>
>
>
>
> --
> "Not possessing the gift of reflection, a dog does not know that he
> does not know, and does not understand that he understands nothing;
> we, on the other hand, are aware of both. If we behave otherwise, it
> is from stupidity, or else from self-deception, to preserve our peace
> of mind."
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From shmera at gmail.com  Wed Nov 11 12:43:38 2009
From: shmera at gmail.com (Ramesh Rajagopal)
Date: Wed, 11 Nov 2009 17:13:38 +0530
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <200911110043.54288.laurent.pinchart@ideasonboard.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<200911110043.54288.laurent.pinchart@ideasonboard.com>
Message-ID: <abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>

Hi Laurent,
   Thank you for the reply. The webcam  is linux based and I am using the
UVC gadget driver of linux kernel 2.6.10.
In this kernel I don't see any example doing UVC bulk transfer. It is
working perfectly with ISOC.
Can you please let me know, if there is any example code that does UVC bulk
transfer ? I couldn't find it any.

The uvc specification is not clear enough to distinguish ISOC and BULK
transfer atleast from my understanding.

While doing ISOC transfer, we have an alternate Interface Setting, when we
get a SET_INTERFACE we start transferring the UVC header first alone to
start
the transfer. There after each IN token from host will carry the frames if
any, otherwise header alone goes.

In case of BULK, with alternate settings, the host machine hangs.
SET_INTERFACE (alternateSetting set 1), Why is it like that?

So I removed alternate settings and till enumeration it is proper. Then
After I get VS_PROBE_COMMIT from the host, I start transferring exactly same
like ISOC, but
I don't see any video on the host and no more proceedings from here. The
data is not going from the FIFO, hence I am not getting any more TX
interrupt from my device.

I am attaching my devices descriptor as well as host side logs. Please find
the attachment. Please let me know, is there any link talk about BULK
transfer or example.


Thanks & Regards,
Ramesh.



On Wed, Nov 11, 2009 at 5:13 AM, Laurent Pinchart <
laurent.pinchart at ideasonboard.com> wrote:

> Hi Ramesh,
>
> On Tuesday 10 November 2009 17:03:50 Ramesh Rajagopal wrote:
> > Hi,
> > I am trying to implement UVC bulk tranfer for my webcam. I am getting
> some
> > difficulties.
> > If anybody has already tried, Can you please send me the enumeration
> > details.?
>
> Are you developing a webcam ? Is it Linux-based ? If so, are you using the
> UVC
> gadget driver I've posted to the linux-usb mailing list some time ago ?
>
> You will find sample USB descriptors for a bulk device attached to this e-
> mail.
>
> > Does this same as ISOC transfer or is it different, If so, Please give me
> > those details.
>
> What about reading the UVC spec ?
>
> --
> Regards,
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091111/d5d76300/attachment.html>
-------------- next part --------------

Bus 002 Device 044: ID 1984:0001  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x1984 
  idProduct          0x0001 
  bcdDevice            2.16
  iManufacturer           1 Bison
  iProduct                2 Bison Video
  iSerial                 3 A1AP20B00112
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          636
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          2 Bison Video
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               5 Bison Video
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              5 Bison Video
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           39
        dwClockFrequency       24.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                17
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               5 Bison Video
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  2
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             4
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               5 Bison Video
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              7 Bison Video
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      555
        bEndPointAddress                  131
        bmInfo                              0
        bTerminalLink                       4
        bStillCaptureMethod                 0
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    11
        bmaControls( 1)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                8
        bFlags                              1
          Fixed-size samples: Yes
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            768
        wHeight                           448
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            512
        wHeight                           288
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1024
        wHeight                           576
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         8
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                 65000000
        dwMaxBitRate                 65000000
        dwMaxVideoFrameBufferSize      307200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                5
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            512
        wHeight                           288
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      294912
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  2
        dwFrameInterval( 0)            400000
        dwFrameInterval( 1)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           180
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      115200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 48660480
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            666666
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)
-------------- next part --------------
Script started on Wednesday 11 November 2009 04:34:48 PM IST
<6>[24280.548538] usb 2-3: new high speed USB device using ehci_hcd and address 44
<6>[24280.842397] usb 2-3: configuration #1 chosen from 1 choice
<7>[24280.864670] uvcvideo: Probing generic UVC device 3
<7>[24280.864753] uvcvideo: Found format MJPEG.
<7>[24280.864772] uvcvideo: - 640x480 (30.0 fps)
<7>[24280.864787] uvcvideo: - 160x120 (30.0 fps)
<7>[24280.864800] uvcvideo: - 352x288 (30.0 fps)
<7>[24280.864813] uvcvideo: - 768x448 (30.0 fps)
<7>[24280.864826] uvcvideo: - 512x288 (30.0 fps)
<7>[24280.864838] uvcvideo: - 320x240 (30.0 fps)
<7>[24280.864852] uvcvideo: - 1024x576 (30.0 fps)
<7>[24280.864865] uvcvideo: - 1280x720 (30.0 fps)
<7>[24280.864880] uvcvideo: Found format YUV 4:2:2 (YUYV).
<7>[24280.864894] uvcvideo: - 352x288 (30.0 fps)
<7>[24280.864908] uvcvideo: - 160x120 (30.0 fps)
<7>[24280.864920] uvcvideo: - 512x288 (25.0 fps)
<7>[24280.864933] uvcvideo: - 320x180 (30.0 fps)
<7>[24280.864946] uvcvideo: - 320x240 (30.0 fps)
<6>[24280.895911] uvcvideo: Found UVC 1.00 device Bison Video (1984:0001)
<7>[24280.895933] uvcvideo: Scanning UVC chain: OT 4 <- IT 3
<6>[24280.895941] uvcvideo: Found a valid video chain (3 -> 4).
<7>[24280.915635] uvcvideo: UVC device initialized.
<7>[24280.959475] uvcvideo: uvc_v4l2_open
<7>[24280.959496] uvcvideo: uvc_v4l2_ioctl
<4>[24280.959504] VIDIOC_QUERYCAP<7>uvcvideo: uvc_v4l2_release
<7>[24392.704013] uvcvideo: uvc_v4l2_open
<7>[24392.704013] uvcvideo: uvc_v4l2_ioctl
<4>[24392.704013] VIDIOC_QUERYCAP<7>uvcvideo: uvc_v4l2_ioctl
<4>[24392.704013] VIDIOC_ENUM_FMT<7>uvcvideo: uvc_v4l2_ioctl
<4>[24392.704013] VIDIOC_ENUM_FMT<7>uvcvideo: uvc_v4l2_ioctl
<4>[24392.704013] VIDIOC_ENUM_FMT<7>uvcvideo: uvc_v4l2_ioctl
<4>[24392.704013] VIDIOC_S_FMT<7>uvcvideo: Trying format 0x47504a4d (MJPG): 640x480.
<7>[24392.704013] uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
<7>[24392.776509] uvcvideo: uvc_v4l2_ioctl
<4>[24392.776509] VIDIOC_S_PARM<7>uvcvideo: Setting frame interval to 1/30 (333333).
<7>[24392.840506] uvcvideo: uvc_v4l2_ioctl
<4>[24392.840506] VIDIOC_G_PARM<7>uvcvideo: uvc_v4l2_ioctl
<4>[24392.840736] VIDIOC_REQBUFS<7>uvcvideo: uvc_v4l2_ioctl
<4>[24392.841355] VIDIOC_QUERYBUF<7>uvcvideo: uvc_v4l2_mmap
<7>[24392.841622] uvcvideo: uvc_v4l2_ioctl
<4>[24392.841634] VIDIOC_QUERYBUF<7>uvcvideo: uvc_v4l2_mmap
<7>[24392.841828] uvcvideo: uvc_v4l2_ioctl
<4>[24392.841840] VIDIOC_QUERYBUF<7>uvcvideo: uvc_v4l2_mmap
<7>[24392.842101] uvcvideo: uvc_v4l2_ioctl
<4>[24392.842112] VIDIOC_QUERYBUF<7>uvcvideo: uvc_v4l2_mmap
<7>[24392.842305] uvcvideo: uvc_v4l2_ioctl
<4>[24392.842317] VIDIOC_QBUF<7>uvcvideo: Queuing buffer 0.
<7>[24392.842340] uvcvideo: uvc_v4l2_ioctl
<4>[24392.842351] VIDIOC_QBUF<7>uvcvideo: Queuing buffer 1.
<7>[24392.842370] uvcvideo: uvc_v4l2_ioctl
<4>[24392.842380] VIDIOC_QBUF<7>uvcvideo: Queuing buffer 2.
<7>[24392.842399] uvcvideo: uvc_v4l2_ioctl
<4>[24392.842409] VIDIOC_QBUF<7>uvcvideo: Queuing buffer 3.
<7>[24393.085678] uvcvideo: uvc_v4l2_ioctl
<4>[24393.085693] VIDIOC_STREAMON<7>uvcvideo: uvc_v4l2_ioctl
<4>[24393.105306] VIDIOC_DQBUF^C

Script done on Wednesday 11 November 2009 04:37:43 PM IST

From shaohuang at gmail.com  Thu Nov 12 03:39:23 2009
From: shaohuang at gmail.com (Brian Pin)
Date: Wed, 11 Nov 2009 18:39:23 -0800
Subject: [Linux-uvc-devel] UVC compliance test error: misplaced VS interface
	descriptor
Message-ID: <a81f87bb0911111839t26798a38tdb3c4e88d964d876@mail.gmail.com>

Hello,
This may be a little bit off topic, but I just want to seek for help. Here I
have our self-made UVC web cam. The web cam support 2 formats, 1 is MJPEG,
the other is a private uncomprssed format which is not specified on UVC
spec. We use the program on USB-IF to do UVC compliance test. There is an
error message I can't even know where I went wrong. The message showing that
the ERROR is :

INFO    Start time: 17:57:35
INFO    Configuring device, Set Configuration to 1
INFO    Getting Full Configuration Descriptor
INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
bAlternateSetting under test : 0
INFO    MJPEG Video Format bLength : 11
INFO    MJPEG Video Format bNumFrameDescriptors : 7
INFO    MJPEG Video Format bDefaultFrameIndex : 1
INFO    MJPEG Video Format bmFlags : 0x00
INFO    MJPEG Video Format bmInterlaceFlags : 0x00
INFO    MJPEG Video Format bmInterlaceFlags : 0x00
INFO    MJPEG Video Format bCopyProtect : 0x00
INFO    MJPEG Video Frame bFrameIndex : 1
INFO    MJPEG Video Frame bFrameIndex : 2
INFO    MJPEG Video Frame bFrameIndex : 3
INFO    MJPEG Video Frame bFrameIndex : 4
INFO    MJPEG Video Frame bFrameIndex : 5
INFO    MJPEG Video Frame bFrameIndex : 6
INFO    MJPEG Video Frame bFrameIndex : 7
INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
bAlternateSetting under test : 1
ERROR   The Class Specific VS Interface Descriptor is misplaced
INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
bAlternateSetting under test : 2
ERROR   The Class Specific VS Interface Descriptor is misplaced
INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
bAlternateSetting under test : 3
ERROR   The Class Specific VS Interface Descriptor is misplaced
INFO    Stop time: 17:57:36

The error: "The Class Specific VS Interface Descriptor is misplaced" which
really confused me a lot because I can't see where went wrong on the
location of these VS Interface descriptors. I attached my device descriptor
as a text file in this mail.
Thanks for helping.

-- 
Best Regards
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091111/bfdcf744/attachment.html>
-------------- next part --------------

Bus 001 Device 006: ID 0547:3001 Anchor Chips, Inc. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0547 Anchor Chips, Inc.
  idProduct          0x3001 
  bcdDevice            3.01
  iManufacturer           0 
  iProduct                0 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          963
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          106
        dwClockFrequency        0.090000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0002002e
          Auto-Exposure Mode
          Auto-Exposure Priority
          Exposure Time (Absolute)
          Focus (Absolute)
          Focus, Auto
      VideoControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            3
        bmControls     0x0000157b
          Brightness
          Contrast
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x1b
          None
          NTSC - 525/60
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {342ee8b0-e3ae-8149-9fd4-ed8cdbfb7e19}
        bNumControl             7
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            2
        bmControls( 0)       0x3f
        bmControls( 1)       0x01
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                27
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {a2d6785b-21b1-534d-9abc-ff56bf64096f}
        bNumControl             5
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            2
        bmControls( 0)       0x1f
        bmControls( 1)       0x00
        iExtension              0 
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             7
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval              11
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      762
        bEndPointAddress                  131
        bmInfo                              0
        bTerminalLink                       7
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    11
        bmaControls( 1)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  2304000
        dwMaxBitRate                 13824000
        dwMaxVideoFrameBufferSize       76800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                  6912000
        dwMaxBitRate                 41472000
        dwMaxVideoFrameBufferSize      230400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                   760320
        dwMaxBitRate                  4561920
        dwMaxVideoFrameBufferSize       25344
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                   576000
        dwMaxBitRate                  3456000
        dwMaxVideoFrameBufferSize       19200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                   190080
        dwMaxBitRate                  1140480
        dwMaxVideoFrameBufferSize        6336
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   144000
        dwMaxBitRate                   864000
        dwMaxVideoFrameBufferSize        4800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                 14400000
        dwMaxBitRate                 86400000
        dwMaxVideoFrameBufferSize      480000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1000000
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            35
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               7
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                       1280
        wHeight( 1)                       720
        wWidth( 2)                        352
        wHeight( 2)                       288
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       174
        wWidth( 5)                        160
        wHeight( 5)                       120
        wWidth( 6)                       1600
        wHeight( 6)                      1200
        bNumCompressionPatterns             7
        bCompression( 0)                  255
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                7
        guidFormat                            {51595556-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      12
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 18432000
        dwMaxBitRate                110592000
        dwMaxVideoFrameBufferSize      460800
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                 55296000
        dwMaxBitRate                331776000
        dwMaxVideoFrameBufferSize     1382400
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  6082560
        dwMaxBitRate                 36495360
        dwMaxVideoFrameBufferSize      152064
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  4608000
        dwMaxBitRate                 27648000
        dwMaxVideoFrameBufferSize      115200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1520640
        dwMaxBitRate                  9123840
        dwMaxVideoFrameBufferSize       38016
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            50
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1152000
        dwMaxBitRate                  6912000
        dwMaxVideoFrameBufferSize       28800
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  6
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                115200000
        dwMaxBitRate                691200000
        dwMaxVideoFrameBufferSize     2880000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  2
        dwFrameInterval( 0)           1000000
        dwFrameInterval( 1)           2000000
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0380  1x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0300  1x 768 bytes
        bInterval               1

From shmera at gmail.com  Thu Nov 12 12:31:33 2009
From: shmera at gmail.com (Ramesh Rajagopal)
Date: Thu, 12 Nov 2009 17:01:33 +0530
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<200911110043.54288.laurent.pinchart@ideasonboard.com>
	<abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
Message-ID: <abc44c8d0911120331u88538b0j9855df7bd6391af8@mail.gmail.com>

Hi,

  I am trying to implement UVC bulk transfer for my webcam. The following
what I am doing

1) After I get VS_COMMIT_CONTROL
2) I am waking up my streaming thread, which transmit the data to the FIFO
3) I can see the data coming to the host through USB analyzer.
4) But followed that I am not getting ACK from the host machine.

uvcvideo module gives ERROR (-75). I am attaching log file generated by host
side machine. After this error, the host sends RESET signal
to the device which re-enumerates the device.

My payloadTransferSize is 2048 bytes. I have already sent my descriptor set
about my camera. Is there anything I am doing wrong or
missing something. Can you guys please help on this ?



Thanks & Regards,
Ramesh.

On Wed, Nov 11, 2009 at 5:13 PM, Ramesh Rajagopal <shmera at gmail.com> wrote:

>
> Hi Laurent,
>    Thank you for the reply. The webcam  is linux based and I am using the
> UVC gadget driver of linux kernel 2.6.10.
> In this kernel I don't see any example doing UVC bulk transfer. It is
> working perfectly with ISOC.
> Can you please let me know, if there is any example code that does UVC bulk
> transfer ? I couldn't find it any.
>
> The uvc specification is not clear enough to distinguish ISOC and BULK
> transfer atleast from my understanding.
>
> While doing ISOC transfer, we have an alternate Interface Setting, when we
> get a SET_INTERFACE we start transferring the UVC header first alone to
> start
> the transfer. There after each IN token from host will carry the frames if
> any, otherwise header alone goes.
>
> In case of BULK, with alternate settings, the host machine hangs.
> SET_INTERFACE (alternateSetting set 1), Why is it like that?
>
> So I removed alternate settings and till enumeration it is proper. Then
> After I get VS_PROBE_COMMIT from the host, I start transferring exactly same
> like ISOC, but
> I don't see any video on the host and no more proceedings from here. The
> data is not going from the FIFO, hence I am not getting any more TX
> interrupt from my device.
>
> I am attaching my devices descriptor as well as host side logs. Please find
> the attachment. Please let me know, is there any link talk about BULK
> transfer or example.
>
>
> Thanks & Regards,
> Ramesh.
>
>
>
>
> On Wed, Nov 11, 2009 at 5:13 AM, Laurent Pinchart <
> laurent.pinchart at ideasonboard.com> wrote:
>
>> Hi Ramesh,
>>
>> On Tuesday 10 November 2009 17:03:50 Ramesh Rajagopal wrote:
>> > Hi,
>> > I am trying to implement UVC bulk tranfer for my webcam. I am getting
>> some
>> > difficulties.
>> > If anybody has already tried, Can you please send me the enumeration
>> > details.?
>>
>> Are you developing a webcam ? Is it Linux-based ? If so, are you using the
>> UVC
>> gadget driver I've posted to the linux-usb mailing list some time ago ?
>>
>> You will find sample USB descriptors for a bulk device attached to this e-
>> mail.
>>
>> > Does this same as ISOC transfer or is it different, If so, Please give
>> me
>> > those details.
>>
>> What about reading the UVC spec ?
>>
>> --
>> Regards,
>>
>> Laurent Pinchart
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091112/7b4d6c5f/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: typescript
Type: application/octet-stream
Size: 2705 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091112/7b4d6c5f/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc-bulk.PNG
Type: image/png
Size: 131605 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091112/7b4d6c5f/attachment.png>

From lars.taeuber at gmx.net  Sun Nov 15 21:11:32 2009
From: lars.taeuber at gmx.net (Lars =?UTF-8?B?VMOkdWJlcg==?=)
Date: Sun, 15 Nov 2009 21:11:32 +0100
Subject: [Linux-uvc-devel] SANYO Xacti HD2000 support
Message-ID: <20091115211132.acb7f1ce.lars.taeuber@gmx.net>

Hi there,

with this module option I can use my camcorder as a webcam:

$ cat /etc/modprobe.d/uvc.conf 
options uvcvideo quirks=4

$ lsusb -d 0474:02da
Bus 001 Device 009: ID 0474:02da Sanyo Electric Co., Ltd 

This option is also known to work with 
Sayno Xacti HD 1000: 0474:0238

Regards
Lars


From lars.taeuber at gmx.net  Sun Nov 15 21:12:21 2009
From: lars.taeuber at gmx.net (Lars =?UTF-8?B?VMOkdWJlcg==?=)
Date: Sun, 15 Nov 2009 21:12:21 +0100
Subject: [Linux-uvc-devel] SANYO Xacti HD2000 support
Message-ID: <20091115211221.3c8acb74.lars.taeuber@gmx.net>

Hi there,

with this module option I can use my camcorder as a webcam:

$ cat /etc/modprobe.d/uvc.conf 
options uvcvideo quirks=4

$ lsusb -d 0474:02da
Bus 001 Device 009: ID 0474:02da Sanyo Electric Co., Ltd 

This option is also known to work with 
Sanyo Xacti HD 1000: 0474:0238

Regards
Lars


From shmera at gmail.com  Mon Nov 16 05:32:59 2009
From: shmera at gmail.com (Ramesh Rajagopal)
Date: Mon, 16 Nov 2009 10:02:59 +0530
Subject: [Linux-uvc-devel] Fwd: Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <abc44c8d0911120331u88538b0j9855df7bd6391af8@mail.gmail.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<200911110043.54288.laurent.pinchart@ideasonboard.com>
	<abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
	<abc44c8d0911120331u88538b0j9855df7bd6391af8@mail.gmail.com>
Message-ID: <abc44c8d0911152032s7ac06cd6s51f330b8a9be0431@mail.gmail.com>

Hi,

  I am trying to implement UVC bulk transfer for my webcam. The following
what I am doing

1) After I get VS_COMMIT_CONTROL
2) I am waking up my streaming thread, which transmit the data to the FIFO
3) I can see the data coming to the host through USB analyzer.
4) But followed that I am not getting ACK from the host machine.

uvcvideo module gives ERROR (-75). I am attaching log file generated by host
side machine. After this error, the host sends RESET signal
to the device which re-enumerates the device.

My payloadTransferSize is 2048 bytes. I have already sent my descriptor set
about my camera. Is there anything I am doing wrong or
missing something. Can you guys please help on this ?



Thanks & Regards,
Ramesh.


On Wed, Nov 11, 2009 at 5:13 PM, Ramesh Rajagopal <shmera at gmail.com> wrote:

>
> Hi Laurent,
>    Thank you for the reply. The webcam  is linux based and I am using the
> UVC gadget driver of linux kernel 2.6.10.
> In this kernel I don't see any example doing UVC bulk transfer. It is
> working perfectly with ISOC.
> Can you please let me know, if there is any example code that does UVC bulk
> transfer ? I couldn't find it any.
>
> The uvc specification is not clear enough to distinguish ISOC and BULK
> transfer atleast from my understanding.
>
> While doing ISOC transfer, we have an alternate Interface Setting, when we
> get a SET_INTERFACE we start transferring the UVC header first alone to
> start
> the transfer. There after each IN token from host will carry the frames if
> any, otherwise header alone goes.
>
> In case of BULK, with alternate settings, the host machine hangs.
> SET_INTERFACE (alternateSetting set 1), Why is it like that?
>
> So I removed alternate settings and till enumeration it is proper. Then
> After I get VS_PROBE_COMMIT from the host, I start transferring exactly same
> like ISOC, but
> I don't see any video on the host and no more proceedings from here. The
> data is not going from the FIFO, hence I am not getting any more TX
> interrupt from my device.
>
> I am attaching my devices descriptor as well as host side logs. Please find
> the attachment. Please let me know, is there any link talk about BULK
> transfer or example.
>
>
> Thanks & Regards,
> Ramesh.
>
>
>
>
> On Wed, Nov 11, 2009 at 5:13 AM, Laurent Pinchart <
> laurent.pinchart at ideasonboard.com> wrote:
>
>> Hi Ramesh,
>>
>> On Tuesday 10 November 2009 17:03:50 Ramesh Rajagopal wrote:
>> > Hi,
>> > I am trying to implement UVC bulk tranfer for my webcam. I am getting
>> some
>> > difficulties.
>> > If anybody has already tried, Can you please send me the enumeration
>> > details.?
>>
>> Are you developing a webcam ? Is it Linux-based ? If so, are you using the
>> UVC
>> gadget driver I've posted to the linux-usb mailing list some time ago ?
>>
>> You will find sample USB descriptors for a bulk device attached to this e-
>> mail.
>>
>> > Does this same as ISOC transfer or is it different, If so, Please give
>> me
>> > those details.
>>
>> What about reading the UVC spec ?
>>
>> --
>> Regards,
>>
>> Laurent Pinchart
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091116/d7c6a936/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: typescript
Type: application/octet-stream
Size: 2705 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091116/d7c6a936/attachment.obj>

From stephan.diestelhorst at gmail.com  Tue Nov 17 12:11:39 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Tue, 17 Nov 2009 12:11:39 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911121158520.3000-100000@iolanthe.rowland.org>
References: <Pine.LNX.4.44L0.0911121158520.3000-100000@iolanthe.rowland.org>
Message-ID: <200911171211.42556.stephan.diestelhorst@gmail.com>

Alan Stern wrote:
> On Wed, 11 Nov 2009, Stephan Diestelhorst wrote:
> > > > This issue is with the built-in Bison web cam in an MSI Wind
> > > > U100. Once the camera is enabled (via hotkey), the entire USB
> > > > subsystem is not responding anymore, causing non-detection of
> > > > freshly attached USB devices and prevents suspending the box.
> > >
> > > Once again no apologize needed. You should keep cross-posting and
> > > report the problem to the linux-usb mailing list. I'm not familiar
> > > enough with the EHCI architecture to work on a fix, so the solution
> > > will likely come from linux-usb developers.
> > 
> > Any help?
> 
> There's a temporary solution (in one of the threads mentioned above) 
> described here (the udelay(2000) call):
> You should experiment and see if the 2000 can be replaced with a 
> smaller number.

Several volunteers and me have experimented with the udelay values.
See https://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352/comments/167

udelay(2000) - works (> 2 people)
udelay(1000) - works (knuutsen, catscrash)
udelay(600) - works (catcrash)
udelay(500) - works (deChrLam with method see # 148, stephan d.)
udelay(400)- works (knuutsen, stephan d.)
udelay(375) - breaks (stephan d.)
udelay(350) - breaks (stephan d.)
udelay(300) - breaks (catscrash)
udelay(250) - breaks (stephan d.)
udelay(100) - breaks (catscrash, stephan d.)
udelay(50) - breaks (stephan d., jbob)
udelay(48) - breaks (knuutsen)

It seems that a delay of 400 usec fixes the thing, and that we're
nowhere near the requested 50 usecs.

Seems like someone either adds the udelay(400) or introduces a proper
fix  (with timers). I am too inexperienced in USB things to fully
understand the negative implications of the former or do the latter.

Many thanks,
  Stephan


From oliver at neukum.org  Tue Nov 17 16:04:14 2009
From: oliver at neukum.org (Oliver Neukum)
Date: Tue, 17 Nov 2009 16:04:14 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <200911171211.42556.stephan.diestelhorst@gmail.com>
References: <Pine.LNX.4.44L0.0911121158520.3000-100000@iolanthe.rowland.org>
	<200911171211.42556.stephan.diestelhorst@gmail.com>
Message-ID: <200911171604.14059.oliver@neukum.org>

Am Dienstag, 17. November 2009 12:11:39 schrieb Stephan Diestelhorst:
> Alan Stern wrote:
> > On Wed, 11 Nov 2009, Stephan Diestelhorst wrote:
> > > > > This issue is with the built-in Bison web cam in an MSI Wind
> > > > > U100. Once the camera is enabled (via hotkey), the entire USB
> > > > > subsystem is not responding anymore, causing non-detection of
> > > > > freshly attached USB devices and prevents suspending the box.
> > > >
> > > > Once again no apologize needed. You should keep cross-posting and
> > > > report the problem to the linux-usb mailing list. I'm not familiar
> > > > enough with the EHCI architecture to work on a fix, so the solution
> > > > will likely come from linux-usb developers.
> > >
> > > Any help?
> >
> > There's a temporary solution (in one of the threads mentioned above)
> > described here (the udelay(2000) call):
> > You should experiment and see if the 2000 can be replaced with a
> > smaller number.
> 
> Several volunteers and me have experimented with the udelay values.
> See
>  https://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352/comments/167
> 
> udelay(2000) - works (> 2 people)
> udelay(1000) - works (knuutsen, catscrash)
> udelay(600) - works (catcrash)
> udelay(500) - works (deChrLam with method see # 148, stephan d.)
> udelay(400)- works (knuutsen, stephan d.)
> udelay(375) - breaks (stephan d.)
> udelay(350) - breaks (stephan d.)
> udelay(300) - breaks (catscrash)
> udelay(250) - breaks (stephan d.)
> udelay(100) - breaks (catscrash, stephan d.)
> udelay(50) - breaks (stephan d., jbob)
> udelay(48) - breaks (knuutsen)
> 
> It seems that a delay of 400 usec fixes the thing, and that we're
> nowhere near the requested 50 usecs.
> 
> Seems like someone either adds the udelay(400) or introduces a proper
> fix  (with timers). I am too inexperienced in USB things to fully
> understand the negative implications of the former or do the latter.

Alan,

as this affects only buggy chipsets, I'd prefer to just add the required
udelay conditional on a chipset quirk. Do you concur? Do you want me
to do it and close this bug?

	Regards
		Oliver


From ep at plicht.de  Wed Nov 18 18:18:08 2009
From: ep at plicht.de (Ekki Plicht (DF4OR))
Date: Wed, 18 Nov 2009 18:18:08 +0100
Subject: [Linux-uvc-devel] Chicony CNF8140 in Samsung N510 Netbook not
	working
Message-ID: <200911181818.08519.ep@plicht.de>

Hi.
I am new to this list, not a dev, just a user. Sorry for the long post.

What is required to make the built in webcam in my new Samsung N510 netbook 
work? It's a Chicony, model CNF8140, vid:pid is 04f2:b147. 

Symptom: Camera is recognized during boot (v4l2 driver in kernel), but xawtv, 
ffplay etc. just give some errors like "Device or resource busy". My user is 
member of the "video" group, the rights of the device are set to group=video 
(read). Trying as root produces the same errors.
 
System: N270 Atom processor, NVidia Ion video chip (MCP79). Kernel is 
2.6.30-gentoo-r8, handmade. KDE 4.3.1 by gentoo.

Below is what v4l-info is saying, below that the output of lsusb. I am happy 
to provide other information as required.


TIA,
Ekki

--------------------------------------------------
##################################################
gin ~ # v4l-info > somefile 2>&1
ioctl VIDIOCGCHAN: Invalid argument
ioctl VIDIOCGTUNER: Invalid argument
ioctl VIDIOCGAUDIO: Invalid argument
ioctl VIDIOCGFBUF: Invalid argument

### v4l2 device info [/dev/video0] ###
general info
    VIDIOC_QUERYCAP
	driver                  : "uvcvideo"
	card                    : "CNF8140"
	bus_info                : "usb-0000:00:06.1-2"
	version                 : 0.1.0
	capabilities            : 0x4000001 [VIDEO_CAPTURE,STREAMING]

standards

inputs
    VIDIOC_ENUMINPUT(0)
	index                   : 0
	name                    : "Camera 1"
	type                    : CAMERA
	audioset                : 0
	tuner                   : 0
	std                     : 0x0 []
	status                  : 0x0 []

video capture
    VIDIOC_ENUM_FMT(0,VIDEO_CAPTURE)
	index                   : 0
	type                    : VIDEO_CAPTURE
	flags                   : 0
	description             : "YUV 4:2:2 (YUYV)"
	pixelformat             : 0x56595559 [YUYV]
    VIDIOC_G_FMT(VIDEO_CAPTURE)
	type                    : VIDEO_CAPTURE
	fmt.pix.width           : 352
	fmt.pix.height          : 288
	fmt.pix.pixelformat     : 0x56595559 [YUYV]
	fmt.pix.field           : NONE
	fmt.pix.bytesperline    : 704
	fmt.pix.sizeimage       : 202752
	fmt.pix.colorspace      : SRGB
	fmt.pix.priv            : 0

controls
    VIDIOC_QUERYCTRL(BASE+0)
	id                      : 9963776
	type                    : INTEGER
	name                    : "Brightness"
	minimum                 : -64
	maximum                 : 64
	step                    : 1
	default_value           : 0
	flags                   : 0
    VIDIOC_QUERYCTRL(BASE+1)
	id                      : 9963777
	type                    : INTEGER
	name                    : "Contrast"
	minimum                 : 0
	maximum                 : 95
	step                    : 1
	default_value           : 0
	flags                   : 0
    VIDIOC_QUERYCTRL(BASE+2)
	id                      : 9963778
	type                    : INTEGER
	name                    : "Saturation"
	minimum                 : 0
	maximum                 : 128
	step                    : 1
	default_value           : 64
	flags                   : 0
    VIDIOC_QUERYCTRL(BASE+3)
	id                      : 9963779
	type                    : INTEGER
	name                    : "Hue"
	minimum                 : -40
	maximum                 : 40
	step                    : 1
	default_value           : 0
	flags                   : 0

### video4linux device info [/dev/video0] ###
general info
    VIDIOCGCAP
	name                    : "CNF8140"
	type                    : 0x1 [CAPTURE]
	channels                : 1
	audios                  : 0
	maxwidth                : 1280
	maxheight               : 1024
	minwidth                : 48
	minheight               : 32

channels

tuner

audio

picture
    VIDIOCGPICT
	brightness              : 32768
	hue                     : 32768
	colour                  : 32768
	contrast                : 0
	whiteness               : 4287
	depth                   : 16
	palette                 : YUYV

buffer

window
    VIDIOCGWIN
	x                       : 0
	y                       : 0


##################################################
gin ~ # lsusb -d 04f2:b147 -v

Bus 002 Device 002: ID 04f2:b147 Chicony Electronics Co., Ltd
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x04f2 Chicony Electronics Co., Ltd
  idProduct          0xb147
  bcdDevice           15.81
  iManufacturer           2 Chicony Electronics Co., Ltd.
  iProduct                1 CNF8140
  iSerial                 3 SN0001
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          524
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               5 WebCam SCB-1600C
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              5 WebCam SCB-1600C
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          104
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x0f
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            3
        bmControls     0x0000167f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                      277
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat                            
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 12288000
        dwMaxBitRate                 18432000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  4055040
        dwMaxBitRate                  6082560
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  3072000
        dwMaxBitRate                  4608000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  1013760
        dwMaxBitRate                  1520640
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                   768000
        dwMaxBitRate                  1152000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  2
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                 18350080
        dwMaxBitRate                 18350080
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        1428571
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1428571
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               6
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        wWidth( 1)                        640
        wHeight( 1)                       480
        wWidth( 2)                        352
        wHeight( 2)                       288
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        176
        wHeight( 4)                       144
        wWidth( 5)                        160
        wHeight( 5)                       120
        bNumCompressionPatterns             6
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled


	width                   : 352
	height                  : 288
	chromakey               : 0
	flags                   : 0
--------------------------------------------------





From fragabr at gmail.com  Thu Nov 19 06:25:59 2009
From: fragabr at gmail.com (=?UTF-8?B?RMOibmllbA==?= Fraga)
Date: Thu, 19 Nov 2009 03:25:59 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture lacking
 treble (high frequencies)?
Message-ID: <9g1ft6-18l.ln1@tux.abusar.org.br>

	I know this list doesn' have anything to do with audio capture
on webcam, but as maybe there're some owners of the Logitech Quickcam
Pro 9000 here, I'd like to ask if you feel that the audio capture of
this webcam lacks some treble (lacks high frequencies).

	I mean: my recorded voice seems to be "equalized" with lots of
bass, a bit of medium and almost nothing of high frequencies...  It's
as if I'm talking inside a box :). My voice seems "stuffy".

	Did someone experienced this? Thanks.

-- 
Linux 2.6.31: Man-Eating Seals of Antiquity




From pj.assis at gmail.com  Thu Nov 19 10:31:04 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 19 Nov 2009 09:31:04 +0000
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
	lacking treble (high frequencies)?
In-Reply-To: <9g1ft6-18l.ln1@tux.abusar.org.br>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
Message-ID: <59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>

Hi,
This camera as a sample rate of 16000Hz, so if compared with the usual
42000Hz/48000Hz from a sound board it's obvious it doesn't process
high frequencies so good.

Logitech's latest C models can go up to 48000Hz and that makes all the
difference.

Best regards,
Paulo

2009/11/19 D?niel Fraga <fragabr at gmail.com>:
> ? ? ? ?I know this list doesn' have anything to do with audio capture
> on webcam, but as maybe there're some owners of the Logitech Quickcam
> Pro 9000 here, I'd like to ask if you feel that the audio capture of
> this webcam lacks some treble (lacks high frequencies).
>
> ? ? ? ?I mean: my recorded voice seems to be "equalized" with lots of
> bass, a bit of medium and almost nothing of high frequencies... ?It's
> as if I'm talking inside a box :). My voice seems "stuffy".
>
> ? ? ? ?Did someone experienced this? Thanks.
>
> --
> Linux 2.6.31: Man-Eating Seals of Antiquity
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From fragabr at gmail.com  Thu Nov 19 17:03:55 2009
From: fragabr at gmail.com (=?UTF-8?B?RMOibmllbA==?= Fraga)
Date: Thu, 19 Nov 2009 14:03:55 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
 lacking treble (high frequencies)?
In-Reply-To: <59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
Message-ID: <4b056c6f.e302be0a.1361.23fb@mx.google.com>

On Thu, 19 Nov 2009 09:31:04 +0000
Paulo Assis <pj.assis at gmail.com> wrote:

> Hi,
> This camera as a sample rate of 16000Hz, so if compared with the usual
> 42000Hz/48000Hz from a sound board it's obvious it doesn't process
> high frequencies so good.
> 
> Logitech's latest C models can go up to 48000Hz and that makes all the
> difference.

	Oh, I see. I forgot about this limitation. Thanks ;)

-- 


From stephan.diestelhorst at gmail.com  Fri Nov 20 18:32:41 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Fri, 20 Nov 2009 18:32:41 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <200911171604.14059.oliver@neukum.org>
References: <Pine.LNX.4.44L0.0911121158520.3000-100000@iolanthe.rowland.org>
	<200911171211.42556.stephan.diestelhorst@gmail.com>
	<200911171604.14059.oliver@neukum.org>
Message-ID: <200911201832.44372.stephan.diestelhorst@gmail.com>

Am Dienstag, 17. November 2009 16:04:14 schrieb Oliver Neukum:
> Am Dienstag, 17. November 2009 12:11:39 schrieb Stephan Diestelhorst:
> > Alan Stern wrote:
> > > On Wed, 11 Nov 2009, Stephan Diestelhorst wrote:
> > > > > > This issue is with the built-in Bison web cam in an MSI Wind
> > > > > > U100. Once the camera is enabled (via hotkey), the entire USB
> > > > > > subsystem is not responding anymore, causing non-detection of
> > > > > > freshly attached USB devices and prevents suspending the box.
> > > > >
> > Several volunteers and me have experimented with the udelay values.
> > See
> >  https://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352/comments/167
> > 
> > It seems that a delay of 400 usec fixes the thing, and that we're
> > nowhere near the requested 50 usecs.
> > 
> > Seems like someone either adds the udelay(400) or introduces a proper
> > fix  (with timers). I am too inexperienced in USB things to fully
> > understand the negative implications of the former or do the latter.
>
> as this affects only buggy chipsets, I'd prefer to just add the required
> udelay conditional on a chipset quirk. Do you concur? Do you want me
> to do it and close this bug?

Thanks for looking into this Oliver! Have you had any chance to work
on this, yet?

Many thanks,
  Stephan


From oliver at neukum.org  Fri Nov 20 22:39:48 2009
From: oliver at neukum.org (Oliver Neukum)
Date: Fri, 20 Nov 2009 22:39:48 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911201621330.2903-100000@iolanthe.rowland.org>
References: <Pine.LNX.4.44L0.0911201621330.2903-100000@iolanthe.rowland.org>
Message-ID: <200911202239.48456.oliver@neukum.org>

Am Freitag, 20. November 2009 22:37:32 schrieb Alan Stern:
> > Thanks for looking into this Oliver! Have you had any chance to work
> > on this, yet?
> 
> Ditto.  It's kind of surprising to see such a blatant bug in an Intel 
> chipset.  Is the 82801G family used in anything other than these 
> netbooks?  Do the same problems occur?

I am working on it. A bit busy here.

	Regards
		Oliver


From oliver at neukum.org  Sat Nov 21 15:37:07 2009
From: oliver at neukum.org (Oliver Neukum)
Date: Sat, 21 Nov 2009 15:37:07 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911171105420.3501-100000@iolanthe.rowland.org>
References: <Pine.LNX.4.44L0.0911171105420.3501-100000@iolanthe.rowland.org>
Message-ID: <200911211537.07544.oliver@neukum.org>

Am Dienstag, 17. November 2009 17:10:10 schrieb Alan Stern:

> I'd like it if there was also some way to move the delay into
> disable_periodic(), before the handshake_on_error_set_halt(), and have
> it take effect only if the most recent enable_periodic() call occurred
> less than 400 us previously.  Can you do it that way?

Sure.
Does anybody have a list of affected PCI ids? 

	Regards
		Oliver

--

diff --git a/drivers/usb/host/ehci-hcd.c b/drivers/usb/host/ehci-hcd.c
index 9835e07..ebdfc93 100644
--- a/drivers/usb/host/ehci-hcd.c
+++ b/drivers/usb/host/ehci-hcd.c
@@ -676,6 +676,7 @@ static int ehci_run (struct usb_hcd *hcd)
 	ehci_readl(ehci, &ehci->regs->command);	/* unblock posted writes */
 	msleep(5);
 	up_write(&ehci_cf_port_reset_rwsem);
+	ehci->last_periodic_disable = jiffies;
 
 	temp = HC_VERSION(ehci_readl(ehci, &ehci->caps->hc_capbase));
 	ehci_info (ehci,
diff --git a/drivers/usb/host/ehci-sched.c b/drivers/usb/host/ehci-sched.c
index b25cdea..586e901 100644
--- a/drivers/usb/host/ehci-sched.c
+++ b/drivers/usb/host/ehci-sched.c
@@ -459,6 +459,10 @@ static int enable_periodic (struct ehci_hcd *ehci)
 	if (ehci->periodic_sched++)
 		return 0;
 
+	if (ehci->broken_periodic)
+		if (time_before(jiffies, ehci->last_periodic_disable + msecs_to_jiffies(2))
+			mdelay(500);
+
 	/* did clearing PSE did take effect yet?
 	 * takes effect only at frame boundaries...
 	 */
@@ -499,6 +503,7 @@ static int disable_periodic (struct ehci_hcd *ehci)
 	/* posted write ... */
 
 	ehci->next_uframe = -1;
+	ehci->last_periodic_disable = jiffies;
 	return 0;
 }
 
diff --git a/drivers/usb/host/ehci.h b/drivers/usb/host/ehci.h
index 064e768..ce77f8f 100644
--- a/drivers/usb/host/ehci.h
+++ b/drivers/usb/host/ehci.h
@@ -118,6 +118,7 @@ struct ehci_hcd {			/* one per controller */
 	unsigned		stamp;
 	unsigned		random_frame;
 	unsigned long		next_statechange;
+	unsigned long		last_periodic_disable;
 	u32			command;
 
 	/* SILICON QUIRKS */
@@ -127,6 +128,7 @@ struct ehci_hcd {			/* one per controller */
 	unsigned		big_endian_desc:1;
 	unsigned		has_amcc_usb23:1;
 	unsigned		need_io_watchdog:1;
+	unsigned		broken_periodic:1;
 
 	/* required for usb32 quirk */
 	#define OHCI_CTRL_HCFS          (3 << 6)


From fragabr at gmail.com  Sat Nov 21 23:51:15 2009
From: fragabr at gmail.com (=?UTF-8?B?RMOibmllbA==?= Fraga)
Date: Sat, 21 Nov 2009 20:51:15 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
 lacking treble (high frequencies)?
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
Message-ID: <3g7mt6-f1a.ln1@tux.abusar.org.br>

On Thu, 19 Nov 2009 14:03:55 -0200
D?niel Fraga <fragabr at gmail.com> wrote:

> On Thu, 19 Nov 2009 09:31:04 +0000
> Paulo Assis <pj.assis at gmail.com> wrote:
> 
> > Hi,
> > This camera as a sample rate of 16000Hz, so if compared with the usual
> > 42000Hz/48000Hz from a sound board it's obvious it doesn't process
> > high frequencies so good.
> > 
> > Logitech's latest C models can go up to 48000Hz and that makes all the
> > difference.
> 
> 	Oh, I see. I forgot about this limitation. Thanks ;)

	Paulo, I forgot to ask: how can I know before buying that a
Logitech cam is a "C model"? Is there any reference on the product?

-- 
Linux 2.6.31: Man-Eating Seals of Antiquity




From oliver at neukum.org  Sun Nov 22 01:08:18 2009
From: oliver at neukum.org (Oliver Neukum)
Date: Sun, 22 Nov 2009 01:08:18 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911211143580.6664-100000@netrider.rowland.org>
References: <Pine.LNX.4.44L0.0911211143580.6664-100000@netrider.rowland.org>
Message-ID: <200911220108.18470.oliver@neukum.org>

Am Samstag, 21. November 2009 17:56:30 schrieb Alan Stern:
> Ooh, no.  The delay should be 500 _microseconds_, not _milliseconds_.  
> The precision of a jiffies counter won't be good enough; you'll have to
> use something like do_gettimeofday(), as in mon_get_timestamp().

Damn. One misreading and an unholy mess.
Back to the drawing board.

	Regards
		Oliver


From pj.assis at gmail.com  Sun Nov 22 12:30:56 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 22 Nov 2009 11:30:56 +0000
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
	lacking treble (high frequencies)?
In-Reply-To: <3g7mt6-f1a.ln1@tux.abusar.org.br>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
	<3g7mt6-f1a.ln1@tux.abusar.org.br>
Message-ID: <59cf47a80911220330l78e07521w4e103a933b770e28@mail.gmail.com>

Hi,
The cameras are named C200, C250, ... , just check this list:
http://www.quickcamteam.net/devices/logitech_uvc_device_list.pdf

Best regards,
Paulo


2009/11/21 D?niel Fraga <fragabr at gmail.com>:
> On Thu, 19 Nov 2009 14:03:55 -0200
> D?niel Fraga <fragabr at gmail.com> wrote:
>
>> On Thu, 19 Nov 2009 09:31:04 +0000
>> Paulo Assis <pj.assis at gmail.com> wrote:
>>
>> > Hi,
>> > This camera as a sample rate of 16000Hz, so if compared with the usual
>> > 42000Hz/48000Hz from a sound board it's obvious it doesn't process
>> > high frequencies so good.
>> >
>> > Logitech's latest C models can go up to 48000Hz and that makes all the
>> > difference.
>>
>> ? ? ? Oh, I see. I forgot about this limitation. Thanks ;)
>
> ? ? ? ?Paulo, I forgot to ask: how can I know before buying that a
> Logitech cam is a "C model"? Is there any reference on the product?
>
> --
> Linux 2.6.31: Man-Eating Seals of Antiquity
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From fragabr at gmail.com  Sun Nov 22 13:52:15 2009
From: fragabr at gmail.com (=?UTF-8?B?RMOibmllbA==?= Fraga)
Date: Sun, 22 Nov 2009 10:52:15 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
 lacking treble (high frequencies)?
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
	<3g7mt6-f1a.ln1@tux.abusar.org.br>
	<59cf47a80911220330l78e07521w4e103a933b770e28@mail.gmail.com>
Message-ID: <0pont6-4m3.ln1@tux.abusar.org.br>

On Sun, 22 Nov 2009 11:30:56 +0000
Paulo Assis <pj.assis at gmail.com> wrote:

> Hi,
> The cameras are named C200, C250, ... , just check this list:
> http://www.quickcamteam.net/devices/logitech_uvc_device_list.pdf

	Sorry, but I didn't understand: The C600 for example seems to
be worst than the Quickcam Pro 9000 right? I mean, no Carl Zeis Lens
etc... So there's no advantage in buying some of them.

	It's really strange Logitech opted for using a cheap microphone
on Quickcam Pro 9000 (which should be one of the best webcams in the
world ;).


-- 
Linux 2.6.31: Man-Eating Seals of Antiquity




From pj.assis at gmail.com  Sun Nov 22 15:08:32 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 22 Nov 2009 14:08:32 +0000
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
	lacking treble (high frequencies)?
In-Reply-To: <0pont6-4m3.ln1@tux.abusar.org.br>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
	<3g7mt6-f1a.ln1@tux.abusar.org.br>
	<59cf47a80911220330l78e07521w4e103a933b770e28@mail.gmail.com>
	<0pont6-4m3.ln1@tux.abusar.org.br>
Message-ID: <59cf47a80911220608m368888c5q9937bd96e5bf7add@mail.gmail.com>

The Pro9000 has several versions depending on the year (2007,2008,2009)
At least compared with the older models the c600 seems to have better firmware,
although in terms of lenses, yes the pro9000 is better (also MJPEG frames seem
to have a lower compression ratio producing better pictures, in terms
of audio most
older models, even from other manufactures have a 16000 hz sample ratio)

In the end it just depends on what you want/need from a webcam,
in my case I use a stereo mic connected to my board, so it doesn't
bother me at all
the quality of the camera mic.

Best regards,
Paulo

>
> ? ? ? ?Sorry, but I didn't understand: The C600 for example seems to
> be worst than the Quickcam Pro 9000 right? I mean, no Carl Zeis Lens
> etc... So there's no advantage in buying some of them.
>
> ? ? ? ?It's really strange Logitech opted for using a cheap microphone
> on Quickcam Pro 9000 (which should be one of the best webcams in the
> world ;).
>
>
> --
> Linux 2.6.31: Man-Eating Seals of Antiquity
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From fragabr at gmail.com  Sun Nov 22 15:36:14 2009
From: fragabr at gmail.com (=?UTF-8?B?RMOibmllbA==?= Fraga)
Date: Sun, 22 Nov 2009 12:36:14 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
 lacking treble (high frequencies)?
In-Reply-To: <59cf47a80911220608m368888c5q9937bd96e5bf7add@mail.gmail.com>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
	<3g7mt6-f1a.ln1@tux.abusar.org.br>
	<59cf47a80911220330l78e07521w4e103a933b770e28@mail.gmail.com>
	<0pont6-4m3.ln1@tux.abusar.org.br>
	<59cf47a80911220608m368888c5q9937bd96e5bf7add@mail.gmail.com>
Message-ID: <4b094c62.1402be0a.0c35.7fa3@mx.google.com>

On Sun, 22 Nov 2009 14:08:32 +0000
Paulo Assis <pj.assis at gmail.com> wrote:

> The Pro9000 has several versions depending on the year (2007,2008,2009)
> At least compared with the older models the c600 seems to have better firmware,
> although in terms of lenses, yes the pro9000 is better (also MJPEG frames seem
> to have a lower compression ratio producing better pictures, in terms
> of audio most
> older models, even from other manufactures have a 16000 hz sample ratio)
> 
> In the end it just depends on what you want/need from a webcam,
> in my case I use a stereo mic connected to my board, so it doesn't
> bother me at all
> the quality of the camera mic.

	Yes, you're right. Using a stereo mic is a viable and cheap
workaround.

	Anyway, thanks for the great answer ;)

-- 


From accensi at gmail.com  Sun Nov 22 15:53:40 2009
From: accensi at gmail.com (A. C. Censi)
Date: Sun, 22 Nov 2009 12:53:40 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
	lacking treble (high frequencies)?
In-Reply-To: <4b094c62.1402be0a.0c35.7fa3@mx.google.com>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
	<3g7mt6-f1a.ln1@tux.abusar.org.br>
	<59cf47a80911220330l78e07521w4e103a933b770e28@mail.gmail.com>
	<0pont6-4m3.ln1@tux.abusar.org.br>
	<59cf47a80911220608m368888c5q9937bd96e5bf7add@mail.gmail.com>
	<4b094c62.1402be0a.0c35.7fa3@mx.google.com>
Message-ID: <643ea2b10911220653u7c02da0esf46ba90e48d9acb@mail.gmail.com>

I thiink that there is a new model C905, with Zeiss optics, 2
megapixel, and the new sound support, at the same price of the Quick
Cam Pro 9000. Check the site of Logitech (US).

ACC

On Sun, Nov 22, 2009 at 12:36 PM, D?niel Fraga <fragabr at gmail.com> wrote:
> On Sun, 22 Nov 2009 14:08:32 +0000
> Paulo Assis <pj.assis at gmail.com> wrote:
>
>> The Pro9000 has several versions depending on the year (2007,2008,2009)
>> At least compared with the older models the c600 seems to have better firmware,
>> although in terms of lenses, yes the pro9000 is better (also MJPEG frames seem
>> to have a lower compression ratio producing better pictures, in terms
>> of audio most
>> older models, even from other manufactures have a 16000 hz sample ratio)
>>
>> In the end it just depends on what you want/need from a webcam,
>> in my case I use a stereo mic connected to my board, so it doesn't
>> bother me at all
>> the quality of the camera mic.
>
> ? ? ? ?Yes, you're right. Using a stereo mic is a viable and cheap
> workaround.
>
> ? ? ? ?Anyway, thanks for the great answer ;)
>
> --
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>



-- 
A. C. Censi
accensi [em] gmail [ponto] com
accensi [em] montreal [ponto] com [ponto] br


From fragabr at gmail.com  Sun Nov 22 16:14:34 2009
From: fragabr at gmail.com (=?UTF-8?B?RMOibmllbA==?= Fraga)
Date: Sun, 22 Nov 2009 13:14:34 -0200
Subject: [Linux-uvc-devel] Logitech Quickcam Pro 9000: audio capture
 lacking treble (high frequencies)?
In-Reply-To: <643ea2b10911220653u7c02da0esf46ba90e48d9acb@mail.gmail.com>
References: <9g1ft6-18l.ln1@tux.abusar.org.br>
	<59cf47a80911190131k48eb1fd6r4bfe87b5832e76be@mail.gmail.com>
	<4b056c6f.e302be0a.1361.23fb@mx.google.com>
	<3g7mt6-f1a.ln1@tux.abusar.org.br>
	<59cf47a80911220330l78e07521w4e103a933b770e28@mail.gmail.com>
	<0pont6-4m3.ln1@tux.abusar.org.br>
	<59cf47a80911220608m368888c5q9937bd96e5bf7add@mail.gmail.com>
	<4b094c62.1402be0a.0c35.7fa3@mx.google.com>
	<643ea2b10911220653u7c02da0esf46ba90e48d9acb@mail.gmail.com>
Message-ID: <4b09555d.1402be0a.08d7.ffff8935@mx.google.com>

On Sun, 22 Nov 2009 12:53:40 -0200
"A. C. Censi" <accensi at gmail.com> wrote:

> I thiink that there is a new model C905, with Zeiss optics, 2
> megapixel, and the new sound support, at the same price of the Quick
> Cam Pro 9000. Check the site of Logitech (US).

	Yes, that's right:

http://www.logitech.com/index.cfm/webcam_communications/webcams/devices/5868&cl=us,en

	Although there're some bad reviews there, complaining about
blurry images... ;)

	In my case I'm more than satisfied with the superior image of
the Quickcam Pro 9000. Buying a external stereo mic would be better in
my case ;) Anyway thanks for the info!

-- 


From oliver at neukum.org  Mon Nov 23 10:20:46 2009
From: oliver at neukum.org (Oliver Neukum)
Date: Mon, 23 Nov 2009 10:20:46 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911211143580.6664-100000@netrider.rowland.org>
References: <Pine.LNX.4.44L0.0911211143580.6664-100000@netrider.rowland.org>
Message-ID: <200911231020.46855.oliver@neukum.org>

Am Samstag, 21. November 2009 17:56:30 schrieb Alan Stern:
> A possible optimization would be to delay for (500 us - elapsed time) 
> instead of the full 500 us.  Or the whole thing could be simplified by 
> doing the full delay always, without any regard to the elapsed time -- 
> but this would be less efficient.

OK,

this version should be efficient.
Stephan, please test.

	Regards
		Oliver

--

commit 1d272fa5ec701b8e39ed9e822f25a4c12f50aa71
Author: Oliver Neukum <oliver at neukum.org>
Date:   Mon Nov 23 10:12:55 2009 +0100

    usb:workaround for EHCI with broken periodic schedules
    
    Some controllers must execute a periodic schedule for
    a minimum time before they can disable it.
    This adds a variable delay based on the time of the
    last enablement.

diff --git a/drivers/usb/host/ehci-hcd.c b/drivers/usb/host/ehci-hcd.c
index 9835e07..f5f5601 100644
--- a/drivers/usb/host/ehci-hcd.c
+++ b/drivers/usb/host/ehci-hcd.c
@@ -28,6 +28,7 @@
 #include <linux/errno.h>
 #include <linux/init.h>
 #include <linux/timer.h>
+#include <linux/ktime.h>
 #include <linux/list.h>
 #include <linux/interrupt.h>
 #include <linux/usb.h>
@@ -676,6 +677,7 @@ static int ehci_run (struct usb_hcd *hcd)
 	ehci_readl(ehci, &ehci->regs->command);	/* unblock posted writes */
 	msleep(5);
 	up_write(&ehci_cf_port_reset_rwsem);
+	ehci->last_periodic_enable = ktime_get_real();
 
 	temp = HC_VERSION(ehci_readl(ehci, &ehci->caps->hc_capbase));
 	ehci_info (ehci,
diff --git a/drivers/usb/host/ehci-pci.c b/drivers/usb/host/ehci-pci.c
index 378861b..ead5f4f 100644
--- a/drivers/usb/host/ehci-pci.c
+++ b/drivers/usb/host/ehci-pci.c
@@ -111,6 +111,10 @@ static int ehci_pci_setup(struct usb_hcd *hcd)
 	switch (pdev->vendor) {
 	case PCI_VENDOR_ID_INTEL:
 		ehci->need_io_watchdog = 0;
+		if (pdev->device == 0x27cc) {
+			ehci->broken_periodic = 1;
+			ehci_info(ehci, "using broken periodic workaround\n");
+		}
 		break;
 	case PCI_VENDOR_ID_TDI:
 		if (pdev->device == PCI_DEVICE_ID_TDI_EHCI) {
diff --git a/drivers/usb/host/ehci-sched.c b/drivers/usb/host/ehci-sched.c
index b25cdea..0468e88 100644
--- a/drivers/usb/host/ehci-sched.c
+++ b/drivers/usb/host/ehci-sched.c
@@ -475,6 +475,8 @@ static int enable_periodic (struct ehci_hcd *ehci)
 	/* make sure ehci_work scans these */
 	ehci->next_uframe = ehci_readl(ehci, &ehci->regs->frame_index)
 		% (ehci->periodic_size << 3);
+	if (unlikely(ehci->broken_periodic))
+		ehci->last_periodic_enable = ktime_get_real();
 	return 0;
 }
 
@@ -486,6 +488,15 @@ static int disable_periodic (struct ehci_hcd *ehci)
 	if (--ehci->periodic_sched)
 		return 0;
 
+	if (unlikely(ehci->broken_periodic)) {
+		ktime_t safe = ktime_add_us(ehci->last_periodic_enable, 500);
+		ktime_t now = ktime_get_real();
+		s64 delay = ktime_us_delta(safe, now);
+		
+		if (unlikely(delay > 0))
+			udelay(delay);
+	}
+
 	/* did setting PSE not take effect yet?
 	 * takes effect only at frame boundaries...
 	 */
diff --git a/drivers/usb/host/ehci.h b/drivers/usb/host/ehci.h
index 064e768..2d85e21 100644
--- a/drivers/usb/host/ehci.h
+++ b/drivers/usb/host/ehci.h
@@ -118,6 +118,7 @@ struct ehci_hcd {			/* one per controller */
 	unsigned		stamp;
 	unsigned		random_frame;
 	unsigned long		next_statechange;
+	ktime_t			last_periodic_enable;
 	u32			command;
 
 	/* SILICON QUIRKS */
@@ -127,6 +128,7 @@ struct ehci_hcd {			/* one per controller */
 	unsigned		big_endian_desc:1;
 	unsigned		has_amcc_usb23:1;
 	unsigned		need_io_watchdog:1;
+	unsigned		broken_periodic:1;
 
 	/* required for usb32 quirk */
 	#define OHCI_CTRL_HCFS          (3 << 6)




From liz at huehd.com  Mon Nov 23 17:49:50 2009
From: liz at huehd.com (Liz)
Date: Mon, 23 Nov 2009 16:49:50 -0000
Subject: [Linux-uvc-devel] Linux UVC driver - device not listed
Message-ID: <003401ca6c5c$f99234a0$ecb69de0$@com>

Good afternoon

As per the excellent Linux UVC driver website at linux-uvc.berlios.de I am emailing to advise that our Hue HD webcam is UVC-compliant in its current incarnation, which can be identified by the text www.huehd.com on the silver focusing ring. The very old Clique models came with Windows drivers and were not UVC-compliant, but the current ones are and we plan to continue; we have attained the Windows Vista certification for which UVC is a requirement and we recognise the benefits to the open source and Mac communities as well. We would like to participate in your supported devices list if possible and would like to know how to achieve this. 

The compatible Device ID is 0c45:62f1 and the best way to easily tell is by the text on the focusing ring as above. If the URL is present, it?s the current model.

Many thanks

HueHD

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091123/6802f8f2/attachment.html>

From laurent.pinchart at ideasonboard.com  Wed Nov 25 02:17:19 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 02:17:19 +0100
Subject: [Linux-uvc-devel] Timestamp Accuracy Patch
In-Reply-To: <833B0B09C5041D42A9924A3BA6A12B9A028FB22085@CALMAIL-CMS.smarttech.inc>
References: <833B0B09C5041D42A9924A3BA6A12B9A028FB22085@CALMAIL-CMS.smarttech.inc>
Message-ID: <200911250217.19104.laurent.pinchart@ideasonboard.com>

Hi Jacob,

I'm very sorry for the (very) late review. I barely had time to work on the
UVC driver for the past 4 weeks. Things will hopefully settle down a bit
soon. Please don't believe your contribution isn't appreciated.

On Saturday 31 October 2009 00:07:51 Jacob Fehr wrote:
> Hey Laurent,
> 
> Attached is a changeset that will sync the computer's clock to the camera
> clock.

Thank you very much. I've copied the patch inline for the purpose of
commenting.

> The final result is that uvc_buffer.buf.timestamp is adjusted to compensate
> for the latency that happens on the camera and the latency that happens in
> the USB stack. It seems to work quite nicely. With the patch, I get very
> even timestamp intervals. In fact it's so accurate that I see a 9
> microsecond/frame drift between my camera clock and my computer clock.

Very nice. Do you have a GPS clock to check which one is correct ;-)
 
> There is still +-105 microseconds of latency that could be tweaked out. But
> for now this is should be accurate enough for even the most demanding 
> application... such as watching TV, DVDs, etc. :-) I suspect the remaining
> latency is coming from the interrupt handler and USB stack. Getting that out
> would require that I get down into the HCD code.
> 
> Have a look and let me know what you think.

> diff -r 214c94aa62aa -r 4617ec8de827 linux/drivers/media/video/uvc/uvc_driver.c
> --- a/linux/drivers/media/video/uvc/uvc_driver.c	Sat Oct 10 01:55:23 2009 +0200
> +++ b/linux/drivers/media/video/uvc/uvc_driver.c	Fri Oct 30 16:24:31 2009 -0600
> @@ -198,24 +198,23 @@
>  	kfree(an);
>  }
>  
> -/* Convert a fraction to a frame interval in 100ns multiples. The idea here is
> - * to compute numerator / denominator * 10000000 using 32 bit fixed point
> - * arithmetic only.
> +/* Calculate a crossproduct. The idea here is to compute
> + * numerator / denominator * multiplier using 32 bit fixed point arithmetic
> + * only.
>   */
> -uint32_t uvc_fraction_to_interval(uint32_t numerator, uint32_t denominator)
> +uint32_t uvc_cross_product(uint32_t numerator, uint32_t denominator,
> +	uint32_t multiplier)

Interesting reuse of the function. Are you sure this is called a cross
product ? Both Wikipedia and my algebra classes fail to give me a definition
for cross product that could apply here.

>  {
> -	uint32_t multiplier;
>  
>  	/* Saturate the result if the operation would overflow. */
>  	if (denominator == 0 ||
> -	    numerator/denominator >= ((uint32_t)-1)/10000000)
> +	    numerator/denominator >= ((uint32_t)-1)/multiplier)
>  		return (uint32_t)-1;
>  
>  	/* Divide both the denominator and the multiplier by two until
>  	 * numerator * multiplier doesn't overflow. If anyone knows a better
>  	 * algorithm please let me know.
>  	 */
> -	multiplier = 10000000;
>  	while (numerator > ((uint32_t)-1)/multiplier) {
>  		multiplier /= 2;
>  		denominator /= 2;

[snip]

> diff -r 214c94aa62aa -r 4617ec8de827 linux/drivers/media/video/uvc/uvc_video.c
> --- a/linux/drivers/media/video/uvc/uvc_video.c	Sat Oct 10 01:55:23 2009 +0200
> +++ b/linux/drivers/media/video/uvc/uvc_video.c	Fri Oct 30 16:24:31 2009 -0600
> @@ -373,6 +373,8 @@
>  		struct uvc_buffer *buf, const __u8 *data, int len)
>  {
>  	__u8 fid;
> +	__u32 pts = 0, stc = 0, pts_stc_delta, device_latency = 0;
> +	int i = 0, idx = 2;
>  
>  	/* Sanity checks:
>  	 * - packet must be at least 2 bytes long
> @@ -417,7 +419,44 @@
>  			return -ENODATA;
>  		}
>  
> -		/* TODO: Handle PTS and SCR. */
> +		do_gettimeofday(&buf->buf.timestamp);
> +
> +		if((data[1] & UVC_STREAM_PTS) &&
> +				(data[1] & UVC_STREAM_SCR && 
> +				stream->dev->clock_frequency)) {

Please make sure that your patch conforms with Linux kernel coding style
(Documentation/CodingStyle). You can verify patches using the
scripts/checkpatch.pl before submitting them.

> +
> +                        for(i = 0; i < 4; i++) {
> +                                pts += data[idx+i] << (8*i);
> +                        }
> +
> +			idx += 4;
> +
> +                        for(i = 0; i < 4; i++) {
> +                                stc += data[idx+i] << (8*i);
> +                        }

You should use the le32_to_cpup macros instead of reinventing them:

	pts = le32_to_cpup(&data[2]);
	stc = le32_to_cpup(&data[6]);

> +
> +			if(stc < pts) {
> +				// Camera clock rolled over
> +				pts_stc_delta = UINT_MAX-pts+stc;
> +			}
> +			else {
> +				pts_stc_delta = stc-pts;
> +			}

You don't need to handle the overflow manually,

	pts_stc_delta = stc - pts;

will produce the right value thanks to the integer overflow in all cases.

> +			device_latency = uvc_cross_product(
> +				pts_stc_delta, stream->dev->clock_frequency,
> +				1000000);

You should use stream->ctrl.dwClockFrequency here. The VC Interface Header
Descriptor dwClockFrequency, stored in stream->dev->clock_frequency, has been
deprecated in UVC 1.1.

> +			if(device_latency &&
> +				buf->buf.timestamp.tv_usec < device_latency) {
> +
> +				// borrow a second
> +				buf->buf.timestamp.tv_sec--;
> +				buf->buf.timestamp.tv_usec += 1000000;
> +			}
> +
> +			buf->buf.timestamp.tv_usec -= device_latency;

You're trying to compute device latency by subtracting the PTS field from the
STC field, and then subtracting that latency, converted to microseconds using
the nominal device clock frequency, from the system time acquired when the
first URB of a video frame completes. I'm afraid this is not correct.

First of all, the nominal device clock frequency isn't accurate. Drift and
jitter make the frequency vary over time. Even if it didn't, the device clock
isn't synchronized to the host clock, so you can't use the device clock
frequency to convert a time stamp difference to a host time delta.

The whole purpose of the PTS and SCR fields is to account for the device clock
inaccuracies by offering a mean to match the device and host clock rates over
time in an adaptive way.

The PTS field gives the device time at which the raw frame capture begins. This
is the time that must be copied to the buffer's timestamp after being converted
to host time.

As the device and host clocks are not synchronized and do not slave to a common
clock, conversion from device time to host time requires additional
information. This is the purpose of the SCR field.

The SCR field gives two timestamps sampled from two clocks at the same time.
The 32 low-order bits are sampled from the device clock (System Time Clock or
STC), and the next 10 bits are sampled from the USB bus clock (SOF counter).

As the SOF counter resolution is only 1ms in full-speed USB, an error of up
to 1ms can be present in the SCR field. This error can be mitigated using
statistical analysis on consecutive SCR samples.

Using that information, the relationship between the device clock and the USB
bus clock can be computed, and the PTS field can be converted to USB bus clock
units.

Now, on the host side, a similar process can be done by sampling the USB SOF
counter and the system time at regular intervals, and the relationship between
the USB bus clock and the system clock can be established. The PTS field
converted to USB bus clock units can further be converted to host clock units.

This is what the PTS/SCR support patch should do. With such an algorithm, the
USB latency calculation in uvc_video_decode_isoc() becomes unnecessary. I'm
afraid the version you submitted doesn't perform those operations.

I'm sorry to have to refuse the patch in its current state.

-- 
Best regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 25 02:19:24 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 02:19:24 +0100
Subject: [Linux-uvc-devel] reported UVC device
In-Reply-To: <COL102-W37E8325261582CB57BB7C3BDAA0@phx.gbl>
References: <COL102-W56F5B152AC02CBED180A2BBDB00@phx.gbl>
	<COL102-W37E8325261582CB57BB7C3BDAA0@phx.gbl>
Message-ID: <200911250219.24484.laurent.pinchart@ideasonboard.com>

Hi Mauricio,

On Wednesday 11 November 2009 02:12:21 Mauricio martinez guerrero wrote:
> hi Laurent, here I sent the USB descriptors

Thanks.

> sorry if it is too long but I was not able to reduce the size
> regards

No worries.

I'm afraid there's no USB descriptor for the webcam in what you sent me. Was 
the camera plugged in when you ran 'lsusb -v' ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 25 02:20:48 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 02:20:48 +0100
Subject: [Linux-uvc-devel] Problem with MSI StarCam 370i
In-Reply-To: <59cf47a80911110300h431e4446n48d1c259a3ab228d@mail.gmail.com>
References: <36be2c7a0910141220h6dbd7a6cn89d203b870bb99b0@mail.gmail.com>
	<36be2c7a0911110216x4afd50e2r45995345b91131e9@mail.gmail.com>
	<59cf47a80911110300h431e4446n48d1c259a3ab228d@mail.gmail.com>
Message-ID: <200911250220.48561.laurent.pinchart@ideasonboard.com>

On Wednesday 11 November 2009 12:00:21 Paulo Assis wrote:
> Pablo Hi,
> 
> Disable firedtv with 'make menuconfig'

It could also be caused by missing Linux kernel headers. Make sure you install 
the Linux kernel headers package (the exact package name can vary depending on 
your distribution).

> 2009/11/11 Pablo Baena <pbaena at gmail.com>:
> > Hi Laurent, I finally got time to test this, but I'm failing to
> > compile uvcvideo.
> >
> > I got this error:
> >
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:21:17:
> > error: dma.h: No such file or directory
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:22:21:
> > error: csr1212.h: No such file or directory
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:23:23:
> > error: highlevel.h: No such file or directory
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:24:19:
> > error: hosts.h: No such file or directory
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:25:22:
> > error: ieee1394.h: No such file or directory
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:26:17:
> > error: iso.h: No such file or directory
> > /home/pablo/Downloads/uvcvideo-c57f47cfb0e8/v4l/firedtv-1394.c:27:21:
> > error: nodemgr.h: No such file or directory

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 25 02:45:54 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 02:45:54 +0100
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <abc44c8d0911120331u88538b0j9855df7bd6391af8@mail.gmail.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
	<abc44c8d0911120331u88538b0j9855df7bd6391af8@mail.gmail.com>
Message-ID: <200911250245.54940.laurent.pinchart@ideasonboard.com>

Hi Ramesh,

On Thursday 12 November 2009 12:31:33 Ramesh Rajagopal wrote:
> Hi,
> 
>   I am trying to implement UVC bulk transfer for my webcam. The following
> what I am doing
> 
> 1) After I get VS_COMMIT_CONTROL
> 2) I am waking up my streaming thread, which transmit the data to the FIFO
> 3) I can see the data coming to the host through USB analyzer.
> 4) But followed that I am not getting ACK from the host machine.
> 
> uvcvideo module gives ERROR (-75). I am attaching log file generated by
>  host side machine. After this error, the host sends RESET signal
> to the device which re-enumerates the device.

-75 is -EOVERFLOW, which indicates that the device sends too much data 
(babble). The next error, -71, is -EPROTO, which indicates some low-level 
error (bitstuff error, no response received within the bus turn-around time, 
...).

> My payloadTransferSize is 2048 bytes. I have already sent my descriptor set
> about my camera. Is there anything I am doing wrong or
> missing something. Can you guys please help on this ?

The errors you get are quite low-level. -EOVERFLOW seems to indicate that the 
device sends too much data in a bulk packet. Can you see that with the USB 
analyzer ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 25 03:03:28 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 03:03:28 +0100
Subject: [Linux-uvc-devel] UVC compliance test error: misplaced VS
	interface descriptor
In-Reply-To: <a81f87bb0911111839t26798a38tdb3c4e88d964d876@mail.gmail.com>
References: <a81f87bb0911111839t26798a38tdb3c4e88d964d876@mail.gmail.com>
Message-ID: <200911250303.28204.laurent.pinchart@ideasonboard.com>

Hi Brian,

On Thursday 12 November 2009 03:39:23 Brian Pin wrote:
> Hello,
> This may be a little bit off topic, but I just want to seek for help. Here
>  I have our self-made UVC web cam. The web cam support 2 formats, 1 is
>  MJPEG, the other is a private uncomprssed format which is not specified on
>  UVC spec. We use the program on USB-IF to do UVC compliance test. There is
>  an error message I can't even know where I went wrong.

this is indeed off-topic, but it's barely 3:00am here so I can at least try to 
help you :-)

>  The message showing that the ERROR is :
> 
> INFO    Start time: 17:57:35
> INFO    Configuring device, Set Configuration to 1
> INFO    Getting Full Configuration Descriptor
> INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
> bAlternateSetting under test : 0
> INFO    MJPEG Video Format bLength : 11
> INFO    MJPEG Video Format bNumFrameDescriptors : 7
> INFO    MJPEG Video Format bDefaultFrameIndex : 1
> INFO    MJPEG Video Format bmFlags : 0x00
> INFO    MJPEG Video Format bmInterlaceFlags : 0x00
> INFO    MJPEG Video Format bmInterlaceFlags : 0x00
> INFO    MJPEG Video Format bCopyProtect : 0x00
> INFO    MJPEG Video Frame bFrameIndex : 1
> INFO    MJPEG Video Frame bFrameIndex : 2
> INFO    MJPEG Video Frame bFrameIndex : 3
> INFO    MJPEG Video Frame bFrameIndex : 4
> INFO    MJPEG Video Frame bFrameIndex : 5
> INFO    MJPEG Video Frame bFrameIndex : 6
> INFO    MJPEG Video Frame bFrameIndex : 7
> INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
> bAlternateSetting under test : 1
> ERROR   The Class Specific VS Interface Descriptor is misplaced
> INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
> bAlternateSetting under test : 2
> ERROR   The Class Specific VS Interface Descriptor is misplaced
> INFO    Standard VS Interface  under test bInterfaceNumber : 1  and
> bAlternateSetting under test : 3
> ERROR   The Class Specific VS Interface Descriptor is misplaced
> INFO    Stop time: 17:57:36
> 
> The error: "The Class Specific VS Interface Descriptor is misplaced" which
> really confused me a lot because I can't see where went wrong on the
> location of these VS Interface descriptors. I attached my device descriptor
> as a text file in this mail.

I can't see anything wrong at first glance. However, lsusb my silently dropped 
unsupported descriptors. Could you send me the raw binary descriptors for your 
device ?

cat /proc/bus/usb/001/001 | hexdump

will do the job (replace 001/001 by your camera bus number and device 
address).

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 25 03:08:58 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 03:08:58 +0100
Subject: [Linux-uvc-devel] SANYO Xacti HD2000 support
In-Reply-To: <20091115211221.3c8acb74.lars.taeuber@gmx.net>
References: <20091115211221.3c8acb74.lars.taeuber@gmx.net>
Message-ID: <200911250308.58416.laurent.pinchart@ideasonboard.com>

Hi Lars,

On Sunday 15 November 2009 21:12:21 Lars T?uber wrote:
> Hi there,
> 
> with this module option I can use my camcorder as a webcam:
> 
> $ cat /etc/modprobe.d/uvc.conf
> options uvcvideo quirks=4
> 
> $ lsusb -d 0474:02da
> Bus 001 Device 009: ID 0474:02da Sanyo Electric Co., Ltd
> 
> This option is also known to work with
> Sanyo Xacti HD 1000: 0474:0238

Thanks for the report.

What happens if you don't set the quirks parameter to 4 ? Please report 
messages printed by the uvcvideo driver to the kernel log (without quirks=4, 
for both models).

Could you please also send me the output of

lsusb -v -d 0474:02da

and

lsusb -v -d 0474:0238

(with the relevant devices plugged in) ? Thanks.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Nov 25 02:39:02 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 25 Nov 2009 02:39:02 +0100
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<200911110043.54288.laurent.pinchart@ideasonboard.com>
	<abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
Message-ID: <200911250239.02662.laurent.pinchart@ideasonboard.com>

Hi Ramesh,

sorry for the late reply.

On Wednesday 11 November 2009 12:43:38 Ramesh Rajagopal wrote:
> Hi Laurent,
>
> Thank you for the reply. The webcam  is linux based and I am using the
> UVC gadget driver of linux kernel 2.6.10.
> In this kernel I don't see any example doing UVC bulk transfer. It is
> working perfectly with ISOC.
> Can you please let me know, if there is any example code that does UVC bulk
> transfer ? I couldn't find it any.

The UVC gadget driver I wrote uses isochronous transfers. It should be 
possible to use bulk transfers by modifying the driver, but there's no code 
sample that I'm aware of.

> The uvc specification is not clear enough to distinguish ISOC and BULK
> transfer atleast from my understanding.
> 
> While doing ISOC transfer, we have an alternate Interface Setting, when we
> get a SET_INTERFACE we start transferring the UVC header first alone to
> start the transfer. There after each IN token from host will carry the
> frames if any, otherwise header alone goes.
> 
> In case of BULK, with alternate settings, the host machine hangs.
> SET_INTERFACE (alternateSetting set 1), Why is it like that?

According to the UVC specification, streaming interfaces with bulk endpoints 
don't use alternate settings.

This is actually a problem, as the UVC specification doesn't provide any way 
for bulk devices to detect when the host starts and stops streaming.

> So I removed alternate settings and till enumeration it is proper. Then
> After I get VS_PROBE_COMMIT from the host, I start transferring exactly
>  same like ISOC, but
> I don't see any video on the host and no more proceedings from here. The
> data is not going from the FIFO, hence I am not getting any more TX
> interrupt from my device.
> 
> I am attaching my devices descriptor as well as host side logs. Please find
> the attachment. Please let me know, is there any link talk about BULK
> transfer or example.

The descriptors look correct at first glance. The log shows that the driver 
doesn't receive any bulk packet (assuming the trace parameter has been set to 
255). This seems to indicate a low-level problem, probably on the device side. 
My guess is that the device doesn't sent bulk packets. That would be easy to 
verify if you have access to a USB analyzer. If the assumption is correct, the 
problem is on the device side.

-- 
Regards,

Laurent Pinchart


From shmera at gmail.com  Wed Nov 25 05:43:37 2009
From: shmera at gmail.com (Ramesh Rajagopal)
Date: Wed, 25 Nov 2009 10:13:37 +0530
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <200911250239.02662.laurent.pinchart@ideasonboard.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<200911110043.54288.laurent.pinchart@ideasonboard.com>
	<abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
	<200911250239.02662.laurent.pinchart@ideasonboard.com>
Message-ID: <abc44c8d0911242043t1020c892pb2c66381de47001b@mail.gmail.com>

Hi Laurent,


> sorry for the late reply.
>

 Thats fine.

>
> On Wednesday 11 November 2009 12:43:38 Ramesh Rajagopal wrote:
> > Hi Laurent,
> >
> > Thank you for the reply. The webcam  is linux based and I am using the
> > UVC gadget driver of linux kernel 2.6.10.
> > In this kernel I don't see any example doing UVC bulk transfer. It is
> > working perfectly with ISOC.
> > Can you please let me know, if there is any example code that does UVC
> bulk
> > transfer ? I couldn't find it any.
>
> The UVC gadget driver I wrote uses isochronous transfers. It should be
> possible to use bulk transfers by modifying the driver, but there's no code
> sample that I'm aware of.
>

Does this mean, I have to change the musb gadget driver code? I changed my
driver
which registers with musb. I didn't chane anything on the musb gadget
driver.


>
> > The uvc specification is not clear enough to distinguish ISOC and BULK
> > transfer atleast from my understanding.
> >
> > While doing ISOC transfer, we have an alternate Interface Setting, when
> we
> > get a SET_INTERFACE we start transferring the UVC header first alone to
> > start the transfer. There after each IN token from host will carry the
> > frames if any, otherwise header alone goes.
> >
> > In case of BULK, with alternate settings, the host machine hangs.
> > SET_INTERFACE (alternateSetting set 1), Why is it like that?
>
> According to the UVC specification, streaming interfaces with bulk
> endpoints
> don't use alternate settings.
>
> This is actually a problem, as the UVC specification doesn't provide any
> way
> for bulk devices to detect when the host starts and stops streaming.
>

Do you aware when do I start sending packets to the host? In case of ISOC,
we start sending packets
when get SET_INTERFACE (enabling the alternate setting) request. Please let
me know.


>
> > So I removed alternate settings and till enumeration it is proper. Then
> > After I get VS_PROBE_COMMIT from the host, I start transferring exactly
> >  same like ISOC, but
> > I don't see any video on the host and no more proceedings from here. The
> > data is not going from the FIFO, hence I am not getting any more TX
> > interrupt from my device.
> >
> > I am attaching my devices descriptor as well as host side logs. Please
> find
> > the attachment. Please let me know, is there any link talk about BULK
> > transfer or example.
>
> The descriptors look correct at first glance. The log shows that the driver
> doesn't receive any bulk packet (assuming the trace parameter has been set
> to
> 255). This seems to indicate a low-level problem, probably on the device
> side.
> My guess is that the device doesn't sent bulk packets. That would be easy
> to
> verify if you have access to a USB analyzer. If the assumption is correct,
> the
> problem is on the device side.
>

I see the packets are on the wire. USB Analyzer  shows me the data and even
I verified the header data,
it looks correct, Now I am not getting back the ACK from the host. Thanks
for your Reply.

>
> --
> Regards,
>
> Laurent Pinchart
>

Regards,
Ramesh.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091125/9bddd6d2/attachment.html>

From shmera at gmail.com  Wed Nov 25 13:49:30 2009
From: shmera at gmail.com (Ramesh Rajagopal)
Date: Wed, 25 Nov 2009 18:19:30 +0530
Subject: [Linux-uvc-devel] Has anybody implemented UVC bulk transfer on
	a device? Some doubts need clarification.
In-Reply-To: <abc44c8d0911242043t1020c892pb2c66381de47001b@mail.gmail.com>
References: <abc44c8d0911100803pc9e9b3foee53c92133b0dc52@mail.gmail.com>
	<200911110043.54288.laurent.pinchart@ideasonboard.com>
	<abc44c8d0911110343s7a8bb3e5qfd21a254df8c5d86@mail.gmail.com>
	<200911250239.02662.laurent.pinchart@ideasonboard.com>
	<abc44c8d0911242043t1020c892pb2c66381de47001b@mail.gmail.com>
Message-ID: <abc44c8d0911250449m35937656m6540ba180a7c254c@mail.gmail.com>

Hi Laurent,
     I got little  luck with UVC bulk transfer after changing the uvcvideo
driver. Now I am getting some frames on
the host side.

In the UVC driver, the
dwMaxPayloadSize(stream->ctrl.dwMaxpayloadTransferSize) of streaming control
variable is being assigned during the enumeration stage.
When we start the luvcview on the host side, this variable is being changed
to "0". This is happening in the call of uvc_v4l2_do_ioctl() with
VIDIOC_S_FMT as a "cmd"
variable.

The function uvc_v4l2_try_format function is copying values of
"bFrameIndex", "formatIndex" and "dwMaxFrameVideoSize" . But it does
re-initialize the dwMaxpayloadTransferSize to "0".
This one causes problem in the uvc_init_video_bulk() which takes
dwMaxpayloadSize for calculating number of URB packets which is becoming "0"
because of the above re-initialization.

When I applied the attached patch, I could get some frames on my host side.
Without this patch, it was failing on uvc_init_video_bulk() function.

I am not well familiar with UVC video driver. I don't know whether this is
the correct way of fixing this problem. I may need some help on this issue.
Please find the attachment. Please let me know, how can I proceed from here.



Thanks & Regards,
Ramesh.


On Wed, Nov 25, 2009 at 10:13 AM, Ramesh Rajagopal <shmera at gmail.com> wrote:

> Hi Laurent,
>
>
>> sorry for the late reply.
>>
>
>  Thats fine.
>
>>
>> On Wednesday 11 November 2009 12:43:38 Ramesh Rajagopal wrote:
>> > Hi Laurent,
>> >
>> > Thank you for the reply. The webcam  is linux based and I am using the
>> > UVC gadget driver of linux kernel 2.6.10.
>> > In this kernel I don't see any example doing UVC bulk transfer. It is
>> > working perfectly with ISOC.
>> > Can you please let me know, if there is any example code that does UVC
>> bulk
>> > transfer ? I couldn't find it any.
>>
>> The UVC gadget driver I wrote uses isochronous transfers. It should be
>> possible to use bulk transfers by modifying the driver, but there's no
>> code
>> sample that I'm aware of.
>>
>
> Does this mean, I have to change the musb gadget driver code? I changed my
> driver
> which registers with musb. I didn't chane anything on the musb gadget
> driver.
>
>
>>
>> > The uvc specification is not clear enough to distinguish ISOC and BULK
>> > transfer atleast from my understanding.
>> >
>> > While doing ISOC transfer, we have an alternate Interface Setting, when
>> we
>> > get a SET_INTERFACE we start transferring the UVC header first alone to
>> > start the transfer. There after each IN token from host will carry the
>> > frames if any, otherwise header alone goes.
>> >
>> > In case of BULK, with alternate settings, the host machine hangs.
>> > SET_INTERFACE (alternateSetting set 1), Why is it like that?
>>
>> According to the UVC specification, streaming interfaces with bulk
>> endpoints
>> don't use alternate settings.
>>
>> This is actually a problem, as the UVC specification doesn't provide any
>> way
>> for bulk devices to detect when the host starts and stops streaming.
>>
>
> Do you aware when do I start sending packets to the host? In case of ISOC,
> we start sending packets
> when get SET_INTERFACE (enabling the alternate setting) request. Please let
> me know.
>
>
>>
>> > So I removed alternate settings and till enumeration it is proper. Then
>> > After I get VS_PROBE_COMMIT from the host, I start transferring exactly
>> >  same like ISOC, but
>> > I don't see any video on the host and no more proceedings from here. The
>> > data is not going from the FIFO, hence I am not getting any more TX
>> > interrupt from my device.
>> >
>> > I am attaching my devices descriptor as well as host side logs. Please
>> find
>> > the attachment. Please let me know, is there any link talk about BULK
>> > transfer or example.
>>
>> The descriptors look correct at first glance. The log shows that the
>> driver
>> doesn't receive any bulk packet (assuming the trace parameter has been set
>> to
>> 255). This seems to indicate a low-level problem, probably on the device
>> side.
>> My guess is that the device doesn't sent bulk packets. That would be easy
>> to
>> verify if you have access to a USB analyzer. If the assumption is correct,
>> the
>> problem is on the device side.
>>
>
> I see the packets are on the wire. USB Analyzer  shows me the data and even
> I verified the header data,
> it looks correct, Now I am not getting back the ACK from the host. Thanks
> for your Reply.
>
>>
>> --
>> Regards,
>>
>> Laurent Pinchart
>>
>
> Regards,
> Ramesh.
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091125/92878d0a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc_bulk_transfer_fix.patch
Type: text/x-patch
Size: 797 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091125/92878d0a/attachment.bin>

From stephan.diestelhorst at gmail.com  Thu Nov 26 00:13:23 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Thu, 26 Nov 2009 00:13:23 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911251736100.2812-100000@iolanthe.rowland.org>
References: <Pine.LNX.4.44L0.0911251736100.2812-100000@iolanthe.rowland.org>
Message-ID: <200911260013.23862.stephan.diestelhorst@gmail.com>

Am Mittwoch 25 November 2009 23:38:25 schrieb Alan Stern:
> On Wed, 25 Nov 2009, Stephan Diestelhorst wrote:
> You should add a dump_stack() line to handshake_on_error_set_halt(), 
> just after the ehci_err() call.  Then we'd be able to see the failure 
> pathway and determine whether it really was caused by the delay being 
> too short.

Will do that now and report back.

> > It might well be the case that the delay is too small. I will change
> > to a higher value (this and the device ID should eventually be
> > converted into symbolic constants).
>
> Otherwise a stress test is the only option.

I have bumped the delay up to 1000 us, and could not trigger the
issue, even with doing modprobe uvcvideo; rmmod uvcvideo in a loop for
several hundred interations, with varying delays between the insert
and removal. However, I am not sure, whether this is actually stress
testing anything.

> > Does anybody have a clue how to
> > properly determine the neccessary delay, either with a stress test or
> > by someone (Intel) telling us the hardware delay?
> 
> There hasn't been any feedback from Intel.  If you can find the right 
> person to ask, go ahead.

Nope. 

Cheers,
  Stephan


From stephan.diestelhorst at gmail.com  Wed Nov 25 23:22:26 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Wed, 25 Nov 2009 23:22:26 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <200911231020.46855.oliver@neukum.org>
References: <Pine.LNX.4.44L0.0911211143580.6664-100000@netrider.rowland.org>
	<200911231020.46855.oliver@neukum.org>
Message-ID: <200911252322.27164.stephan.diestelhorst@gmail.com>

Am Montag 23 November 2009 10:20:46 schrieb Oliver Neukum:
> Am Samstag, 21. November 2009 17:56:30 schrieb Alan Stern:
> > A possible optimization would be to delay for (500 us - elapsed time) 
> > instead of the full 500 us.  Or the whole thing could be simplified by 
> > doing the full delay always, without any regard to the elapsed time -- 
> > but this would be less efficient.
>
> this version should be efficient.
> Stephan, please test.

Thanks Oliver for the patch! Sorry for not testing any earlier. In
order to save on re-compilation time, I "backported" the patch to
2.6.31.4 which I had used for previous experiments. Please find my
port attached, for reference.

The patch seemed to work initially, however, after booting several
times and enabling / disabling the cam (through hotkey) and additional
rmmod uvcvideo, I managed to trigger the bug again, see the dmesg
with successful and errorneous attempts attached.

It might well be the case that the delay is too small. I will change
to a higher value (this and the device ID should eventually be
converted into symbolic constants). Does anybody have a clue how to
properly determine the neccessary delay, either with a stress test or
by someone (Intel) telling us the hardware delay?

Cheers,
  Stephan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bison_ehci_lockup_fix_backport.patch
Type: text/x-patch
Size: 3025 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091125/2e3d2518/attachment.bin>
-------------- next part --------------
[    0.000000] Initializing cgroup subsys cpuset
[    0.000000] Initializing cgroup subsys cpu
[    0.000000] Linux version 2.6.31.4-bison-u2000 (syon at m-twain) (gcc version 4.4.1 (Ubuntu 4.4.1-4ubuntu8) ) #12 SMP Wed Nov 25 22:35:57 CET 2009 (Ubuntu 2.6.31-14.48-generic)
[    0.000000] KERNEL supported cpus:
[    0.000000]   Intel GenuineIntel
[    0.000000]   AMD AuthenticAMD
[    0.000000]   NSC Geode by NSC
[    0.000000]   Cyrix CyrixInstead
[    0.000000]   Centaur CentaurHauls
[    0.000000]   Transmeta GenuineTMx86
[    0.000000]   Transmeta TransmetaCPU
[    0.000000]   UMC UMC UMC UMC
[    0.000000] BIOS-provided physical RAM map:
[    0.000000]  BIOS-e820: 0000000000000000 - 000000000009ec00 (usable)
[    0.000000]  BIOS-e820: 000000000009ec00 - 00000000000a0000 (reserved)
[    0.000000]  BIOS-e820: 00000000000e0000 - 0000000000100000 (reserved)
[    0.000000]  BIOS-e820: 0000000000100000 - 000000003f5b2000 (usable)
[    0.000000]  BIOS-e820: 000000003f5b2000 - 000000003f5d5000 (ACPI NVS)
[    0.000000]  BIOS-e820: 000000003f5d5000 - 000000003f5e6000 (reserved)
[    0.000000]  BIOS-e820: 000000003f5e6000 - 000000003f5e9000 (ACPI NVS)
[    0.000000]  BIOS-e820: 000000003f5e9000 - 000000003f605000 (reserved)
[    0.000000]  BIOS-e820: 000000003f605000 - 000000003f606000 (ACPI NVS)
[    0.000000]  BIOS-e820: 000000003f606000 - 000000003f608000 (reserved)
[    0.000000]  BIOS-e820: 000000003f608000 - 000000003f611000 (ACPI data)
[    0.000000]  BIOS-e820: 000000003f611000 - 000000003f617000 (ACPI NVS)
[    0.000000]  BIOS-e820: 000000003f617000 - 000000003f700000 (reserved)
[    0.000000]  BIOS-e820: 00000000ffb00000 - 00000000ffc00000 (reserved)
[    0.000000]  BIOS-e820: 00000000fff00000 - 0000000100000000 (reserved)
[    0.000000] DMI 2.4 present.
[    0.000000] AMI BIOS detected: BIOS may corrupt low RAM, working around it.
[    0.000000] e820 update range: 0000000000000000 - 0000000000010000 (usable) ==> (reserved)
[    0.000000] last_pfn = 0x3f5b2 max_arch_pfn = 0x100000
[    0.000000] MTRR default type: uncachable
[    0.000000] MTRR fixed ranges enabled:
[    0.000000]   00000-9FFFF write-back
[    0.000000]   A0000-BFFFF uncachable
[    0.000000]   C0000-DBFFF write-protect
[    0.000000]   DC000-E7FFF write-through
[    0.000000]   E8000-FFFFF write-protect
[    0.000000] MTRR variable ranges enabled:
[    0.000000]   0 base 000000000 mask 0C0000000 write-back
[    0.000000]   1 base 03F700000 mask 0FFF00000 uncachable
[    0.000000]   2 base 03F800000 mask 0FF800000 uncachable
[    0.000000]   3 disabled
[    0.000000]   4 disabled
[    0.000000]   5 disabled
[    0.000000]   6 disabled
[    0.000000]   7 disabled
[    0.000000] x86 PAT enabled: cpu 0, old 0x7040600070406, new 0x7010600070106
[    0.000000] Scanning 0 areas for low memory corruption
[    0.000000] modified physical RAM map:
[    0.000000]  modified: 0000000000000000 - 0000000000010000 (reserved)
[    0.000000]  modified: 0000000000010000 - 000000000009ec00 (usable)
[    0.000000]  modified: 000000000009ec00 - 00000000000a0000 (reserved)
[    0.000000]  modified: 00000000000e0000 - 0000000000100000 (reserved)
[    0.000000]  modified: 0000000000100000 - 000000003f5b2000 (usable)
[    0.000000]  modified: 000000003f5b2000 - 000000003f5d5000 (ACPI NVS)
[    0.000000]  modified: 000000003f5d5000 - 000000003f5e6000 (reserved)
[    0.000000]  modified: 000000003f5e6000 - 000000003f5e9000 (ACPI NVS)
[    0.000000]  modified: 000000003f5e9000 - 000000003f605000 (reserved)
[    0.000000]  modified: 000000003f605000 - 000000003f606000 (ACPI NVS)
[    0.000000]  modified: 000000003f606000 - 000000003f608000 (reserved)
[    0.000000]  modified: 000000003f608000 - 000000003f611000 (ACPI data)
[    0.000000]  modified: 000000003f611000 - 000000003f617000 (ACPI NVS)
[    0.000000]  modified: 000000003f617000 - 000000003f700000 (reserved)
[    0.000000]  modified: 00000000ffb00000 - 00000000ffc00000 (reserved)
[    0.000000]  modified: 00000000fff00000 - 0000000100000000 (reserved)
[    0.000000] initial memory mapped : 0 - 00c00000
[    0.000000] init_memory_mapping: 0000000000000000-00000000377fe000
[    0.000000] Using x86 segment limits to approximate NX protection
[    0.000000]  0000000000 - 0000400000 page 4k
[    0.000000]  0000400000 - 0037400000 page 2M
[    0.000000]  0037400000 - 00377fe000 page 4k
[    0.000000] kernel direct mapping tables up to 377fe000 @ 10000-15000
[    0.000000] RAMDISK: 33d0d000 - 37feffb7
[    0.000000] Allocated new RAMDISK: 00898000 - 04b7afb7
[    0.000000] Move RAMDISK from 0000000033d0d000 - 0000000037feffb6 to 00898000 - 04b7afb6
[    0.000000] ACPI: RSDP 000f03c0 00024 (v02 MSI_NB)
[    0.000000] ACPI: XSDT 3f60ff10 0005C (v01 MSI_NB MEGABOOK 06222004 MSFT 00010013)
[    0.000000] ACPI: FACP 3f5e6c10 000F4 (v04 MSI_NB MEGABOOK 06222004 MSFT 00010013)
[    0.000000] ACPI Warning: 32/64 FACS address mismatch in FADT - two FACS tables! 20090521 tbfadt-370
[    0.000000] ACPI Warning: 32/64X FACS address mismatch in FADT - 3F611E40/000000003F611D40, using 32 20090521 tbfadt-487
[    0.000000] ACPI: DSDT 3f608010 053DD (v01 MSI_NB MEGABOOK 00000000 INTL 20051117)
[    0.000000] ACPI: FACS 3f611e40 00040
[    0.000000] ACPI: APIC 3f610e90 0005C (v02 MSI_NB MEGABOOK 06222004 MSFT 00010013)
[    0.000000] ACPI: MCFG 3f615c90 0003C (v01 MSI_NB MEGABOOK 06222004 MSFT 00000097)
[    0.000000] ACPI: SLIC 3f612c10 00176 (v01 MSI_NB MEGABOOK 06222004 MSFT 00000097)
[    0.000000] ACPI: SSDT 3f605510 004CE (v02  PmRef    CpuPm 00003000 INTL 20051117)
[    0.000000] ACPI: SSDT 3f5e8a10 00232 (v02  PmRef  Cpu0Tst 00003000 INTL 20051117)
[    0.000000] ACPI: SSDT 3f611a10 000A0 (v02  PmRef  Cpu1Tst 00003000 INTL 20051117)
[    0.000000] ACPI: Local APIC address 0xfee00000
[    0.000000] 125MB HIGHMEM available.
[    0.000000] 887MB LOWMEM available.
[    0.000000]   mapped low ram: 0 - 377fe000
[    0.000000]   low ram: 0 - 377fe000
[    0.000000]   node 0 low ram: 00000000 - 377fe000
[    0.000000]   node 0 bootmap 00011000 - 00017f00
[    0.000000] (9 early reservations) ==> bootmem [0000000000 - 00377fe000]
[    0.000000]   #0 [0000000000 - 0000001000]   BIOS data page ==> [0000000000 - 0000001000]
[    0.000000]   #1 [0000001000 - 0000002000]    EX TRAMPOLINE ==> [0000001000 - 0000002000]
[    0.000000]   #2 [0000006000 - 0000007000]       TRAMPOLINE ==> [0000006000 - 0000007000]
[    0.000000]   #3 [0000100000 - 00008930a0]    TEXT DATA BSS ==> [0000100000 - 00008930a0]
[    0.000000]   #4 [000009ec00 - 0000100000]    BIOS reserved ==> [000009ec00 - 0000100000]
[    0.000000]   #5 [0000894000 - 00008971d4]              BRK ==> [0000894000 - 00008971d4]
[    0.000000]   #6 [0000010000 - 0000011000]          PGTABLE ==> [0000010000 - 0000011000]
[    0.000000]   #7 [0000898000 - 0004b7afb7]      NEW RAMDISK ==> [0000898000 - 0004b7afb7]
[    0.000000]   #8 [0000011000 - 0000018000]          BOOTMAP ==> [0000011000 - 0000018000]
[    0.000000] Zone PFN ranges:
[    0.000000]   DMA      0x00000010 -> 0x00001000
[    0.000000]   Normal   0x00001000 -> 0x000377fe
[    0.000000]   HighMem  0x000377fe -> 0x0003f5b2
[    0.000000] Movable zone start PFN for each node
[    0.000000] early_node_map[2] active PFN ranges
[    0.000000]     0: 0x00000010 -> 0x0000009e
[    0.000000]     0: 0x00000100 -> 0x0003f5b2
[    0.000000] On node 0 totalpages: 259392
[    0.000000] free_area_init_node: node 0, pgdat c076e900, node_mem_map c4b7b200
[    0.000000]   DMA zone: 32 pages used for memmap
[    0.000000]   DMA zone: 0 pages reserved
[    0.000000]   DMA zone: 3950 pages, LIFO batch:0
[    0.000000]   Normal zone: 1744 pages used for memmap
[    0.000000]   Normal zone: 221486 pages, LIFO batch:31
[    0.000000]   HighMem zone: 252 pages used for memmap
[    0.000000]   HighMem zone: 31928 pages, LIFO batch:7
[    0.000000] Using APIC driver default
[    0.000000] ACPI: PM-Timer IO Port: 0x408
[    0.000000] ACPI: Local APIC address 0xfee00000
[    0.000000] ACPI: LAPIC (acpi_id[0x01] lapic_id[0x00] enabled)
[    0.000000] ACPI: LAPIC (acpi_id[0x02] lapic_id[0x01] enabled)
[    0.000000] ACPI: IOAPIC (id[0x02] address[0xfec00000] gsi_base[0])
[    0.000000] IOAPIC[0]: apic_id 2, version 32, address 0xfec00000, GSI 0-23
[    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)
[    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 high level)
[    0.000000] ACPI: IRQ0 used by override.
[    0.000000] ACPI: IRQ2 used by override.
[    0.000000] ACPI: IRQ9 used by override.
[    0.000000] Enabling APIC mode:  Flat.  Using 1 I/O APICs
[    0.000000] Using ACPI (MADT) for SMP configuration information
[    0.000000] SMP: Allowing 2 CPUs, 0 hotplug CPUs
[    0.000000] nr_irqs_gsi: 24
[    0.000000] PM: Registered nosave memory: 000000000009e000 - 000000000009f000
[    0.000000] PM: Registered nosave memory: 000000000009f000 - 00000000000a0000
[    0.000000] PM: Registered nosave memory: 00000000000a0000 - 00000000000e0000
[    0.000000] PM: Registered nosave memory: 00000000000e0000 - 0000000000100000
[    0.000000] Allocating PCI resources starting at 3f700000 (gap: 3f700000:c0400000)
[    0.000000] NR_CPUS:8 nr_cpumask_bits:8 nr_cpu_ids:2 nr_node_ids:1
[    0.000000] PERCPU: Embedded 14 pages at c536f000, static data 35612 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 257364
[    0.000000] Kernel command line: root=/dev/mapper/vg_hdd-root ro quiet splash 
[    0.000000] PID hash table entries: 4096 (order: 12, 16384 bytes)
[    0.000000] Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)
[    0.000000] Inode-cache hash table entries: 65536 (order: 6, 262144 bytes)
[    0.000000] Enabling fast FPU save and restore... done.
[    0.000000] Enabling unmasked SIMD FPU exception support... done.
[    0.000000] Initializing CPU#0
[    0.000000] allocated 5189800 bytes of page_cgroup
[    0.000000] please try 'cgroup_disable=memory' option if you don't want memory cgroups
[    0.000000] Initializing HighMem for node 0 (000377fe:0003f5b2)
[    0.000000] Memory: 946784k/1038024k available (4523k kernel code, 90408k reserved, 2097k data, 544k init, 128720k highmem)
[    0.000000] virtual kernel memory layout:
[    0.000000]     fixmap  : 0xfff1d000 - 0xfffff000   ( 904 kB)
[    0.000000]     pkmap   : 0xff800000 - 0xffc00000   (4096 kB)
[    0.000000]     vmalloc : 0xf7ffe000 - 0xff7fe000   ( 120 MB)
[    0.000000]     lowmem  : 0xc0000000 - 0xf77fe000   ( 887 MB)
[    0.000000]       .init : 0xc0778000 - 0xc0800000   ( 544 kB)
[    0.000000]       .data : 0xc056ad00 - 0xc0777308   (2097 kB)
[    0.000000]       .text : 0xc0100000 - 0xc056ad00   (4523 kB)
[    0.000000] Checking if this processor honours the WP bit even in supervisor mode...Ok.
[    0.000000] SLUB: Genslabs=13, HWalign=64, Order=0-3, MinObjects=0, CPUs=2, Nodes=1
[    0.000000] NR_IRQS:2304 nr_irqs:424
[    0.000000] Extended CMOS year: 2000
[    0.000000] Fast TSC calibration using PIT
[    0.000000] Detected 1600.114 MHz processor.
[    0.001874] Console: colour VGA+ 80x25
[    0.001880] console [tty0] enabled
[    0.004015] spurious 8259A interrupt: IRQ7.
[    0.004027] Calibrating delay loop (skipped), value calculated using timer frequency.. 3200.22 BogoMIPS (lpj=6400456)
[    0.004072] Security Framework initialized
[    0.004106] AppArmor: AppArmor initialized
[    0.004122] Mount-cache hash table entries: 512
[    0.004346] Initializing cgroup subsys ns
[    0.004357] Initializing cgroup subsys cpuacct
[    0.004366] Initializing cgroup subsys memory
[    0.004377] Initializing cgroup subsys freezer
[    0.004382] Initializing cgroup subsys net_cls
[    0.004406] CPU: L1 I cache: 32K, L1 D cache: 24K
[    0.004412] CPU: L2 cache: 512K
[    0.004417] CPU: Physical Processor ID: 0
[    0.004421] CPU: Processor Core ID: 0
[    0.004428] mce: CPU supports 5 MCE banks
[    0.004442] CPU0: Thermal monitoring enabled (TM2)
[    0.004450] using mwait in idle threads.
[    0.004461] Performance Counters: Atom events, Intel PMU driver.
[    0.004476] ... version:                 3
[    0.004480] ... bit width:               40
[    0.004484] ... generic counters:        2
[    0.004488] ... value mask:              000000ffffffffff
[    0.004493] ... max period:              000000007fffffff
[    0.004497] ... fixed-purpose counters:  3
[    0.004502] ... counter mask:            0000000700000003
[    0.004510] Checking 'hlt' instruction... OK.
[    0.023982] ACPI: Core revision 20090521
[    0.037886] ..TIMER: vector=0x30 apic1=0 pin1=2 apic2=0 pin2=0
[    0.077584] CPU0: Intel(R) Atom(TM) CPU N270   @ 1.60GHz stepping 02
[    0.080001] Booting processor 1 APIC 0x1 ip 0x6000
[    0.004000] Initializing CPU#1
[    0.004000] Calibrating delay using timer specific routine.. 3200.19 BogoMIPS (lpj=6400386)
[    0.004000] CPU: L1 I cache: 32K, L1 D cache: 24K
[    0.004000] CPU: L2 cache: 512K
[    0.004000] CPU: Physical Processor ID: 0
[    0.004000] CPU: Processor Core ID: 0
[    0.004000] mce: CPU supports 5 MCE banks
[    0.004000] CPU1: Thermal monitoring enabled (TM2)
[    0.004000] x86 PAT enabled: cpu 1, old 0x7040600070406, new 0x7010600070106
[    0.164998] CPU1: Intel(R) Atom(TM) CPU N270   @ 1.60GHz stepping 02
[    0.165034] checking TSC synchronization [CPU#0 -> CPU#1]: passed.
[    0.168050] Brought up 2 CPUs
[    0.168057] Total of 2 processors activated (6400.42 BogoMIPS).
[    0.168118] CPU0 attaching sched-domain:
[    0.168125]  domain 0: span 0-1 level SIBLING
[    0.168131]   groups: 0 1
[    0.168142] CPU1 attaching sched-domain:
[    0.168147]  domain 0: span 0-1 level SIBLING
[    0.168153]   groups: 1 0
[    0.168306] Booting paravirtualized kernel on bare hardware
[    0.168478] regulator: core version 0.5
[    0.168478] Time: 23:03:14  Date: 11/25/09
[    0.168478] NET: Registered protocol family 16
[    0.168478] EISA bus registered
[    0.168478] ACPI: bus type pci registered
[    0.168576] PCI: MCFG configuration 0: base e0000000 segment 0 buses 0 - 255
[    0.168585] PCI: Not using MMCONFIG.
[    0.255249] PCI: Using configuration type 1 for base access
[    0.257502] bio: create slab <bio-0> at 0
[    0.257502] ACPI: EC: Look up EC in DSDT
[    0.265178] ACPI: BIOS _OSI(Linux) query ignored
[    0.269336] ACPI: Interpreter enabled
[    0.269352] ACPI: (supports S0 S1 S3 S4 S5)
[    0.269404] ACPI: Using IOAPIC for interrupt routing
[    0.269491] PCI: MCFG configuration 0: base e0000000 segment 0 buses 0 - 255
[    0.269808] PCI: MCFG area at e0000000 reserved in ACPI motherboard resources
[    0.269815] PCI: Using MMCONFIG for extended config space
[    0.276622] ACPI: EC: non-query interrupt received, switching to interrupt mode
[    0.284044] ACPI: EC: GPE storm detected, transactions will use polling mode
[    0.361537] ACPI: EC: GPE = 0x17, I/O: command/status = 0x66, data = 0x62
[    0.361544] ACPI: EC: driver started in poll mode
[    0.361996] ACPI: No dock devices found.
[    0.362548] ACPI: PCI Root Bridge [PCI0] (0000:00)
[    0.362703] pci 0000:00:02.0: reg 10 32bit mmio: [0xdfe80000-0xdfefffff]
[    0.362714] pci 0000:00:02.0: reg 14 io port: [0xe0f0-0xe0f7]
[    0.362723] pci 0000:00:02.0: reg 18 32bit mmio: [0xc0000000-0xcfffffff]
[    0.362733] pci 0000:00:02.0: reg 1c 32bit mmio: [0xdff00000-0xdff3ffff]
[    0.362787] pci 0000:00:02.1: reg 10 32bit mmio: [0xdfe00000-0xdfe7ffff]
[    0.362900] pci 0000:00:1b.0: reg 10 64bit mmio: [0xffe00000-0xffe03fff]
[    0.362956] pci 0000:00:1b.0: PME# supported from D0 D3hot D3cold
[    0.362964] pci 0000:00:1b.0: PME# disabled
[    0.363041] pci 0000:00:1c.0: PME# supported from D0 D3hot D3cold
[    0.363049] pci 0000:00:1c.0: PME# disabled
[    0.363128] pci 0000:00:1c.1: PME# supported from D0 D3hot D3cold
[    0.363135] pci 0000:00:1c.1: PME# disabled
[    0.363201] pci 0000:00:1d.0: reg 20 io port: [0xe080-0xe09f]
[    0.363265] pci 0000:00:1d.1: reg 20 io port: [0xe060-0xe07f]
[    0.363330] pci 0000:00:1d.2: reg 20 io port: [0xe040-0xe05f]
[    0.363394] pci 0000:00:1d.3: reg 20 io port: [0xe020-0xe03f]
[    0.363464] pci 0000:00:1d.7: reg 10 32bit mmio: [0xdff40000-0xdff403ff]
[    0.363527] pci 0000:00:1d.7: PME# supported from D0 D3hot D3cold
[    0.363535] pci 0000:00:1d.7: PME# disabled
[    0.363690] pci 0000:00:1f.0: Force enabled HPET at 0xfed03000
[    0.363704] pci 0000:00:1f.0: quirk: region 0400-047f claimed by ICH6 ACPI/GPIO/TCO
[    0.363712] pci 0000:00:1f.0: quirk: region 0500-053f claimed by ICH6 GPIO
[    0.363720] pci 0000:00:1f.0: ICH7 LPC Generic IO decode 1 PIO at 004c (mask 0007)
[    0.363793] pci 0000:00:1f.2: reg 10 io port: [0xe0e0-0xe0e7]
[    0.363803] pci 0000:00:1f.2: reg 14 io port: [0xe0d0-0xe0d3]
[    0.363814] pci 0000:00:1f.2: reg 18 io port: [0xe0c0-0xe0c7]
[    0.363824] pci 0000:00:1f.2: reg 1c io port: [0xe0b0-0xe0b3]
[    0.363835] pci 0000:00:1f.2: reg 20 io port: [0xe0a0-0xe0af]
[    0.363868] pci 0000:00:1f.2: PME# supported from D3hot
[    0.363875] pci 0000:00:1f.2: PME# disabled
[    0.363932] pci 0000:00:1f.3: reg 20 io port: [0xe000-0xe01f]
[    0.364042] pci 0000:01:00.0: reg 10 io port: [0xd000-0xd0ff]
[    0.364069] pci 0000:01:00.0: reg 18 64bit mmio: [0xffd10000-0xffd10fff]
[    0.364088] pci 0000:01:00.0: reg 20 64bit mmio: [0xffd00000-0xffd0ffff]
[    0.364102] pci 0000:01:00.0: reg 30 32bit mmio: [0xdfd00000-0xdfd0ffff]
[    0.364151] pci 0000:01:00.0: supports D1 D2
[    0.364156] pci 0000:01:00.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.364164] pci 0000:01:00.0: PME# disabled
[    0.364236] pci 0000:00:1c.0: bridge io port: [0xd000-0xdfff]
[    0.364244] pci 0000:00:1c.0: bridge 32bit mmio: [0xdfd00000-0xdfdfffff]
[    0.364255] pci 0000:00:1c.0: bridge 64bit mmio pref: [0xffd00000-0xffdfffff]
[    0.364317] pci 0000:02:00.0: reg 10 32bit mmio: [0xdfc00000-0xdfc0ffff]
[    0.364399] pci 0000:02:00.0: PME# supported from D0 D3hot
[    0.364407] pci 0000:02:00.0: PME# disabled
[    0.364469] pci 0000:00:1c.1: bridge 32bit mmio: [0xdfc00000-0xdfcfffff]
[    0.364539] pci 0000:00:1e.0: transparent bridge
[    0.364570] pci_bus 0000:00: on NUMA node 0
[    0.364587] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0._PRT]
[    0.364933] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.P0P4._PRT]
[    0.365066] ACPI: PCI Interrupt Routing Table [\_SB_.PCI0.P0P5._PRT]
[    0.383281] ACPI: PCI Interrupt Link [LNKA] (IRQs 3 4 5 6 7 10 *11 12 14 15)
[    0.383489] ACPI: PCI Interrupt Link [LNKB] (IRQs 3 4 5 6 7 *10 11 12 14 15)
[    0.383691] ACPI: PCI Interrupt Link [LNKC] (IRQs 3 4 5 6 *7 10 11 12 14 15)
[    0.383893] ACPI: PCI Interrupt Link [LNKD] (IRQs *3 4 5 6 7 10 11 12 14 15)
[    0.384112] ACPI: PCI Interrupt Link [LNKE] (IRQs 3 4 5 6 7 10 11 12 14 15) *0, disabled.
[    0.384317] ACPI: PCI Interrupt Link [LNKF] (IRQs 3 4 5 6 7 10 11 12 14 15) *0, disabled.
[    0.384523] ACPI: PCI Interrupt Link [LNKG] (IRQs 3 4 5 6 7 10 11 12 14 15) *0, disabled.
[    0.384727] ACPI: PCI Interrupt Link [LNKH] (IRQs 3 4 *5 6 7 10 11 12 14 15)
[    0.385130] SCSI subsystem initialized
[    0.385207] libata version 3.00 loaded.
[    0.385207] usbcore: registered new interface driver usbfs
[    0.385207] usbcore: registered new interface driver hub
[    0.385207] usbcore: registered new device driver usb
[    0.385207] ACPI: WMI: Mapper loaded
[    0.385207] PCI: Using ACPI for IRQ routing
[    0.396021] Bluetooth: Core ver 2.15
[    0.396065] NET: Registered protocol family 31
[    0.396065] Bluetooth: HCI device and connection manager initialized
[    0.396065] Bluetooth: HCI socket layer initialized
[    0.396065] NetLabel: Initializing
[    0.396065] NetLabel:  domain hash size = 128
[    0.396065] NetLabel:  protocols = UNLABELED CIPSOv4
[    0.396077] NetLabel:  unlabeled traffic allowed by default
[    0.396304] hpet clockevent registered
[    0.396311] HPET: 3 timers in total, 0 timers will be used for per-cpu timer
[    0.396321] hpet0: at MMIO 0xfed03000, IRQs 2, 8, 0
[    0.396332] hpet0: 3 comparators, 64-bit 14.318180 MHz counter
[    0.416028] pnp: PnP ACPI init
[    0.416067] ACPI: bus type pnp registered
[    0.473529] pnp: PnP ACPI: found 11 devices
[    0.473536] ACPI: ACPI bus type pnp unregistered
[    0.473545] PnPBIOS: Disabled by ACPI PNP
[    0.473570] system 00:01: iomem range 0xfed14000-0xfed17fff has been reserved
[    0.473578] system 00:01: iomem range 0xfed19000-0xfed19fff has been reserved
[    0.473585] system 00:01: iomem range 0xfed18000-0xfed18fff has been reserved
[    0.473593] system 00:01: iomem range 0xe0000000-0xefffffff has been reserved
[    0.473609] system 00:05: ioport range 0x4d0-0x4d1 has been reserved
[    0.473624] system 00:09: ioport range 0x400-0x47f has been reserved
[    0.473631] system 00:09: ioport range 0x1180-0x119f has been reserved
[    0.473638] system 00:09: ioport range 0x500-0x53f has been reserved
[    0.473646] system 00:09: iomem range 0xfec00000-0xfec00fff could not be reserved
[    0.473653] system 00:09: iomem range 0xfee00000-0xfee00fff has been reserved
[    0.473661] system 00:09: iomem range 0xfed20000-0xfed23fff has been reserved
[    0.473668] system 00:09: iomem range 0xffb00000-0xffbfffff has been reserved
[    0.473675] system 00:09: iomem range 0xfc800400-0xfc800fff has been reserved
[    0.508530] AppArmor: AppArmor Filesystem Enabled
[    0.508591] pci 0000:00:1c.0: PCI bridge, secondary bus 0000:01
[    0.508599] pci 0000:00:1c.0:   IO window: 0xd000-0xdfff
[    0.508608] pci 0000:00:1c.0:   MEM window: 0xdfd00000-0xdfdfffff
[    0.508617] pci 0000:00:1c.0:   PREFETCH window: 0x000000ffd00000-0x000000ffdfffff
[    0.508628] pci 0000:00:1c.1: PCI bridge, secondary bus 0000:02
[    0.508633] pci 0000:00:1c.1:   IO window: disabled
[    0.508641] pci 0000:00:1c.1:   MEM window: 0xdfc00000-0xdfcfffff
[    0.508648] pci 0000:00:1c.1:   PREFETCH window: disabled
[    0.508656] pci 0000:00:1e.0: PCI bridge, secondary bus 0000:03
[    0.508661] pci 0000:00:1e.0:   IO window: disabled
[    0.508669] pci 0000:00:1e.0:   MEM window: disabled
[    0.508675] pci 0000:00:1e.0:   PREFETCH window: disabled
[    0.508697]   alloc irq_desc for 16 on node -1
[    0.508702]   alloc kstat_irqs on node -1
[    0.508714] pci 0000:00:1c.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16
[    0.508723] pci 0000:00:1c.0: setting latency timer to 64
[    0.508736]   alloc irq_desc for 17 on node -1
[    0.508740]   alloc kstat_irqs on node -1
[    0.508749] pci 0000:00:1c.1: PCI INT B -> GSI 17 (level, low) -> IRQ 17
[    0.508757] pci 0000:00:1c.1: setting latency timer to 64
[    0.508768] pci 0000:00:1e.0: setting latency timer to 64
[    0.508777] pci_bus 0000:00: resource 0 io:  [0x00-0xffff]
[    0.508783] pci_bus 0000:00: resource 1 mem: [0x000000-0xffffffff]
[    0.508790] pci_bus 0000:01: resource 0 io:  [0xd000-0xdfff]
[    0.508796] pci_bus 0000:01: resource 1 mem: [0xdfd00000-0xdfdfffff]
[    0.508802] pci_bus 0000:01: resource 2 pref mem [0xffd00000-0xffdfffff]
[    0.508809] pci_bus 0000:02: resource 1 mem: [0xdfc00000-0xdfcfffff]
[    0.508815] pci_bus 0000:03: resource 3 io:  [0x00-0xffff]
[    0.508821] pci_bus 0000:03: resource 4 mem: [0x000000-0xffffffff]
[    0.508896] NET: Registered protocol family 2
[    0.509104] IP route cache hash table entries: 32768 (order: 5, 131072 bytes)
[    0.509763] TCP established hash table entries: 131072 (order: 8, 1048576 bytes)
[    0.510738] TCP bind hash table entries: 65536 (order: 7, 524288 bytes)
[    0.511187] TCP: Hash tables configured (established 131072 bind 65536)
[    0.511196] TCP reno registered
[    0.511415] NET: Registered protocol family 1
[    0.511548] Trying to unpack rootfs image as initramfs...
[    0.897074] Switched to high resolution mode on CPU 1
[    0.900012] Switched to high resolution mode on CPU 0
[    3.639684] Freeing initrd memory: 68491k freed
[    3.705099] cpufreq-nforce2: No nForce2 chipset.
[    3.705159] Scanning for low memory corruption every 60 seconds
[    3.705368] audit: initializing netlink socket (disabled)
[    3.705396] type=2000 audit(1259190196.704:1): initialized
[    3.722186] highmem bounce pool size: 64 pages
[    3.722199] HugeTLB registered 4 MB page size, pre-allocated 0 pages
[    3.725539] VFS: Disk quotas dquot_6.5.2
[    3.725675] Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
[    3.726954] fuse init (API version 7.12)
[    3.727148] msgmni has been set to 1732
[    3.727633] alg: No test for stdrng (krng)
[    3.727666] io scheduler noop registered
[    3.727671] io scheduler anticipatory registered
[    3.727676] io scheduler deadline registered
[    3.727792] io scheduler cfq registered (default)
[    3.727816] pci 0000:00:02.0: Boot video device
[    3.728225]   alloc irq_desc for 24 on node -1
[    3.728231]   alloc kstat_irqs on node -1
[    3.728247] pcieport-driver 0000:00:1c.0: irq 24 for MSI/MSI-X
[    3.728261] pcieport-driver 0000:00:1c.0: setting latency timer to 64
[    3.728449]   alloc irq_desc for 25 on node -1
[    3.728454]   alloc kstat_irqs on node -1
[    3.728467] pcieport-driver 0000:00:1c.1: irq 25 for MSI/MSI-X
[    3.728480] pcieport-driver 0000:00:1c.1: setting latency timer to 64
[    3.728637] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
[    3.728664] Firmware did not grant requested _OSC control
[    3.728696] Firmware did not grant requested _OSC control
[    3.728755] Firmware did not grant requested _OSC control
[    3.728780] Firmware did not grant requested _OSC control
[    3.728811] pciehp: PCI Express Hot Plug Controller Driver version: 0.4
[    3.784141] ACPI: AC Adapter [ADP1] (on-line)
[    3.784287] input: Power Button as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input0
[    3.784296] ACPI: Power Button [PWRF]
[    3.784411] input: Lid Switch as /devices/LNXSYSTM:00/device:00/PNP0A08:00/device:11/PNP0C09:00/PNP0C0D:00/input/input1
[    3.840075] ACPI: Lid Switch [LID0]
[    3.840181] input: Power Button as /devices/LNXSYSTM:00/device:00/PNP0C0C:00/input/input2
[    3.840188] ACPI: Power Button [PWRB]
[    3.840285] input: Sleep Button as /devices/LNXSYSTM:00/device:00/PNP0C0E:00/input/input3
[    3.840292] ACPI: Sleep Button [SLPB]
[    3.841540] ACPI: SSDT 3f5e8c90 00253 (v02  PmRef  Cpu0Ist 00003000 INTL 20051117)
[    3.842445] ACPI: SSDT 3f5e7690 00653 (v02  PmRef  Cpu0Cst 00003001 INTL 20051117)
[    3.847248] Monitor-Mwait will be used to enter C-1 state
[    3.847322] Monitor-Mwait will be used to enter C-2 state
[    3.847380] Monitor-Mwait will be used to enter C-3 state
[    3.847401] Marking TSC unstable due to TSC halts in idle
[    3.847443] ACPI: CPU0 (power states: C1[C1] C2[C2] C3[C3])
[    3.847503] processor LNXCPU:00: registered as cooling_device0
[    3.847527] ACPI: Processor [CPU0] (supports 8 throttling states)
[    3.848284] ACPI: SSDT 3f5e8f10 000D0 (v02  PmRef  Cpu1Ist 00003000 INTL 20051117)
[    3.848865] ACPI: SSDT 3f611b10 00083 (v02  PmRef  Cpu1Cst 00003000 INTL 20051117)
[    3.850613] ACPI: CPU1 (power states: C1[C1] C2[C2] C3[C3])
[    3.850669] processor LNXCPU:01: registered as cooling_device1
[    3.850679] ACPI: Processor [CPU1] (supports 8 throttling states)
[    4.020151] thermal LNXTHERM:01: registered as thermal_zone0
[    4.020169] ACPI: Thermal Zone [THRM] (53 C)
[    4.020275] isapnp: Scanning for PnP cards...
[    4.373409] isapnp: No Plug & Play device found
[    4.376106] Serial: 8250/16550 driver, 4 ports, IRQ sharing enabled
[    4.378739] brd: module loaded
[    4.379744] loop: module loaded
[    4.379917] input: Macintosh mouse button emulation as /devices/virtual/input/input4
[    4.380193] ata_piix 0000:00:1f.2: version 2.13
[    4.380221]   alloc irq_desc for 19 on node -1
[    4.380226]   alloc kstat_irqs on node -1
[    4.380241] ata_piix 0000:00:1f.2: PCI INT B -> GSI 19 (level, low) -> IRQ 19
[    4.380250] ata_piix 0000:00:1f.2: MAP [ P0 P2 IDE IDE ]
[    4.532037] ata_piix 0000:00:1f.2: setting latency timer to 64
[    4.532188] scsi0 : ata_piix
[    4.532379] scsi1 : ata_piix
[    4.532458] ata1: SATA max UDMA/133 cmd 0x1f0 ctl 0x3f6 bmdma 0xe0a0 irq 14
[    4.532465] ata2: PATA max UDMA/100 cmd 0x170 ctl 0x376 bmdma 0xe0a8 irq 15
[    4.534404] Fixed MDIO Bus: probed
[    4.534490] PPP generic driver version 2.4.2
[    4.534701] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver
[    4.534762]   alloc irq_desc for 23 on node -1
[    4.534767]   alloc kstat_irqs on node -1
[    4.534779] ehci_hcd 0000:00:1d.7: PCI INT A -> GSI 23 (level, low) -> IRQ 23
[    4.534811] ehci_hcd 0000:00:1d.7: setting latency timer to 64
[    4.534818] ehci_hcd 0000:00:1d.7: EHCI Host Controller
[    4.534917] ehci_hcd 0000:00:1d.7: new USB bus registered, assigned bus number 1
[    4.534949] ehci_hcd 0000:00:1d.7: using broken periodic workaround
[    4.538834] ehci_hcd 0000:00:1d.7: debug port 1
[    4.538844] ehci_hcd 0000:00:1d.7: cache line size of 32 is not supported
[    4.538872] ehci_hcd 0000:00:1d.7: irq 23, io mem 0xdff40000
[    4.552034] ehci_hcd 0000:00:1d.7: USB 2.0 started, EHCI 1.00
[    4.552204] usb usb1: configuration #1 chosen from 1 choice
[    4.552276] hub 1-0:1.0: USB hub found
[    4.552300] hub 1-0:1.0: 8 ports detected
[    4.552435] ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver
[    4.552480] uhci_hcd: USB Universal Host Controller Interface driver
[    4.552551] uhci_hcd 0000:00:1d.0: PCI INT A -> GSI 23 (level, low) -> IRQ 23
[    4.552565] uhci_hcd 0000:00:1d.0: setting latency timer to 64
[    4.552572] uhci_hcd 0000:00:1d.0: UHCI Host Controller
[    4.552646] uhci_hcd 0000:00:1d.0: new USB bus registered, assigned bus number 2
[    4.552681] uhci_hcd 0000:00:1d.0: irq 23, io base 0x0000e080
[    4.552856] usb usb2: configuration #1 chosen from 1 choice
[    4.552929] hub 2-0:1.0: USB hub found
[    4.552944] hub 2-0:1.0: 2 ports detected
[    4.553060] uhci_hcd 0000:00:1d.1: PCI INT B -> GSI 19 (level, low) -> IRQ 19
[    4.553072] uhci_hcd 0000:00:1d.1: setting latency timer to 64
[    4.553079] uhci_hcd 0000:00:1d.1: UHCI Host Controller
[    4.553155] uhci_hcd 0000:00:1d.1: new USB bus registered, assigned bus number 3
[    4.553200] uhci_hcd 0000:00:1d.1: irq 19, io base 0x0000e060
[    4.553364] usb usb3: configuration #1 chosen from 1 choice
[    4.553425] hub 3-0:1.0: USB hub found
[    4.553440] hub 3-0:1.0: 2 ports detected
[    4.553531]   alloc irq_desc for 18 on node -1
[    4.553537]   alloc kstat_irqs on node -1
[    4.553550] uhci_hcd 0000:00:1d.2: PCI INT C -> GSI 18 (level, low) -> IRQ 18
[    4.553561] uhci_hcd 0000:00:1d.2: setting latency timer to 64
[    4.553567] uhci_hcd 0000:00:1d.2: UHCI Host Controller
[    4.553636] uhci_hcd 0000:00:1d.2: new USB bus registered, assigned bus number 4
[    4.553678] uhci_hcd 0000:00:1d.2: irq 18, io base 0x0000e040
[    4.553845] usb usb4: configuration #1 chosen from 1 choice
[    4.553907] hub 4-0:1.0: USB hub found
[    4.553922] hub 4-0:1.0: 2 ports detected
[    4.554012] uhci_hcd 0000:00:1d.3: PCI INT D -> GSI 16 (level, low) -> IRQ 16
[    4.554023] uhci_hcd 0000:00:1d.3: setting latency timer to 64
[    4.554030] uhci_hcd 0000:00:1d.3: UHCI Host Controller
[    4.554101] uhci_hcd 0000:00:1d.3: new USB bus registered, assigned bus number 5
[    4.554145] uhci_hcd 0000:00:1d.3: irq 16, io base 0x0000e020
[    4.554311] usb usb5: configuration #1 chosen from 1 choice
[    4.554372] hub 5-0:1.0: USB hub found
[    4.554387] hub 5-0:1.0: 2 ports detected
[    4.554576] PNP: PS/2 Controller [PNP0303:PS2K,PNP0f03:PS2M] at 0x60,0x64 irq 1,12
[    4.575150] serio: i8042 KBD port at 0x60,0x64 irq 1
[    4.575164] serio: i8042 AUX port at 0x60,0x64 irq 12
[    4.575331] mice: PS/2 mouse device common for all mice
[    4.575614] rtc_cmos 00:04: RTC can wake from S4
[    4.575704] rtc_cmos 00:04: rtc core: registered rtc_cmos as rtc0
[    4.575743] rtc0: alarms up to one year, y3k, 114 bytes nvram, hpet irqs
[    4.576087] device-mapper: uevent: version 1.0.3
[    4.576332] device-mapper: ioctl: 4.15.0-ioctl (2009-04-01) initialised: dm-devel at redhat.com
[    4.576513] device-mapper: multipath: version 1.1.0 loaded
[    4.576521] device-mapper: multipath round-robin: version 1.0.0 loaded
[    4.576858] EISA: Probing bus 0 at eisa.0
[    4.576895] EISA: Detected 0 cards.
[    4.577275] cpuidle: using governor ladder
[    4.577526] cpuidle: using governor menu
[    4.578630] TCP cubic registered
[    4.579004] NET: Registered protocol family 10
[    4.579970] lo: Disabled Privacy Extensions
[    4.580697] NET: Registered protocol family 17
[    4.580745] Bluetooth: L2CAP ver 2.13
[    4.580750] Bluetooth: L2CAP socket layer initialized
[    4.580768] Bluetooth: SCO (Voice Link) ver 0.6
[    4.580773] Bluetooth: SCO socket layer initialized
[    4.580863] Bluetooth: RFCOMM TTY layer initialized
[    4.580874] Bluetooth: RFCOMM socket layer initialized
[    4.580881] Bluetooth: RFCOMM ver 1.11
[    4.581986] Using IPI No-Shortcut mode
[    4.582157] PM: Resume from disk failed.
[    4.582182] registered taskstats version 1
[    4.582430]   Magic number: 1:863:100
[    4.582536] rtc_cmos 00:04: setting system clock to 2009-11-25 23:03:18 UTC (1259190198)
[    4.582544] BIOS EDD facility v0.16 2004-Jun-25, 0 devices found
[    4.582548] EDD information not available.
[    4.589506] input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input5
[    4.705417] ata1.00: ATA-8: FUJITSU MHZ2160BH G2, 00000009, max UDMA/100
[    4.705439] ata1.00: 312581808 sectors, multi 16: LBA48 NCQ (depth 0/32)
[    4.721467] ata1.00: configured for UDMA/100
[    4.865169] usb 1-6: new high speed USB device using ehci_hcd and address 2
[    4.896044] Clocksource tsc unstable (delta = -255278161 ns)
[    5.007453] usb 1-6: configuration #1 chosen from 1 choice
[    5.040281] ACPI: Battery Slot [BAT1] (battery present)
[    5.040648] scsi 0:0:0:0: Direct-Access     ATA      FUJITSU MHZ2160B 0000 PQ: 0 ANSI: 5
[    5.040931] sd 0:0:0:0: [sda] 312581808 512-byte logical blocks: (160 GB/149 GiB)
[    5.040956] sd 0:0:0:0: Attached scsi generic sg0 type 0
[    5.041121] sd 0:0:0:0: [sda] Write Protect is off
[    5.041128] sd 0:0:0:0: [sda] Mode Sense: 00 3a 00 00
[    5.041197] sd 0:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA
[    5.041539]  sda: sda1 sda2 sda3
[    5.120673] sd 0:0:0:0: [sda] Attached SCSI disk
[    5.644469] Freeing unused kernel memory: 544k freed
[    5.644963] Write protecting the kernel text: 4524k
[    5.645044] Write protecting the kernel read-only data: 1792k
[    6.067146] Linux agpgart interface v0.103
[    6.123286] agpgart-intel 0000:00:00.0: Intel 945GME Chipset
[    6.123561] agpgart-intel 0000:00:00.0: detected 7932K stolen memory
[    6.126486] agpgart-intel 0000:00:00.0: AGP aperture is 256M @ 0xc0000000
[    6.192784] [drm] Initialized drm 1.1.0 20060810
[    6.204131] r8169 Gigabit Ethernet driver 2.3LK-NAPI loaded
[    6.204177] r8169 0000:01:00.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16
[    6.204244] r8169 0000:01:00.0: setting latency timer to 64
[    6.204307]   alloc irq_desc for 26 on node -1
[    6.204316]   alloc kstat_irqs on node -1
[    6.204343] r8169 0000:01:00.0: irq 26 for MSI/MSI-X
[    6.206864] eth0: RTL8102e at 0xf8174000, 00:21:85:52:08:0b, XID 34a00000 IRQ 26
[    6.222625] Initializing USB Mass Storage driver...
[    6.245056] scsi2 : SCSI emulation for USB Mass Storage devices
[    6.249040] usb-storage: device found at 2
[    6.249047] usb-storage: waiting for device to settle before scanning
[    6.249099] usbcore: registered new interface driver usb-storage
[    6.249108] USB Mass Storage support registered.
[    6.267266] atkbd.c: Unknown key pressed (translated set 2, code 0xf7 on isa0060/serio0).
[    6.267283] atkbd.c: Use 'setkeycodes e077 <keycode>' to make it known.
[    6.270999] atkbd.c: Unknown key released (translated set 2, code 0xf7 on isa0060/serio0).
[    6.271012] atkbd.c: Use 'setkeycodes e077 <keycode>' to make it known.
[    6.336092] atkbd.c: Unknown key pressed (translated set 2, code 0xf7 on isa0060/serio0).
[    6.336108] atkbd.c: Use 'setkeycodes e077 <keycode>' to make it known.
[    6.339790] atkbd.c: Unknown key released (translated set 2, code 0xf7 on isa0060/serio0).
[    6.339803] atkbd.c: Use 'setkeycodes e077 <keycode>' to make it known.
[    6.356373] acpi device:1c: registered as cooling_device2
[    6.356685] input: Video Bus as /devices/LNXSYSTM:00/device:00/PNP0A08:00/device:1a/input/input6
[    6.356800] ACPI: Video Device [IGD] (multi-head: yes  rom: no  post: no)
[    6.372478] i915 0000:00:02.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16
[    6.372494] i915 0000:00:02.0: setting latency timer to 64
[    6.483520] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[    6.483528] [drm:edid_is_valid] *ERROR* Raw EDID:
[    6.483536] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[    6.483542] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[    6.483548] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[    6.483554] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[    6.483560] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[    6.483566] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[    6.483571] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[    6.483577] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[    6.483582] 
[    6.483588] i915 0000:00:02.0: LVDS-1: EDID invalid.
[    6.597797] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[    6.597803] [drm:edid_is_valid] *ERROR* Raw EDID:
[    6.597812] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[    6.597818] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[    6.597824] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[    6.597830] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[    6.597836] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[    6.597841] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[    6.597847] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[    6.597853] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[    6.597857] 
[    6.597864] i915 0000:00:02.0: LVDS-1: EDID invalid.
[    6.602929] [drm] fb0: inteldrmfb frame buffer device
[    6.602949] [drm] Initialized i915 1.6.0 20080730 for 0000:00:02.0 on minor 0
[    6.930995] [drm] LVDS-8: set mode 1024x600 d
[    7.323844] Console: switching to colour frame buffer device 128x37
[    7.702911] md: linear personality registered for level -1
[    7.709137] md: multipath personality registered for level -4
[    7.714534] md: raid0 personality registered for level 0
[    7.726311] md: raid1 personality registered for level 1
[    7.731715] xor: automatically using best checksumming function: pIII_sse
[    7.749025]    pIII_sse  :  3701.000 MB/sec
[    7.749035] xor: using function: pIII_sse (3701.000 MB/sec)
[    7.751057] async_tx: api initialized (async)
[    7.825162] raid6: int32x1    151 MB/s
[    7.893276] raid6: int32x2    208 MB/s
[    7.961199] raid6: int32x4    227 MB/s
[    8.029220] raid6: int32x8    237 MB/s
[    8.097112] raid6: mmxx1      333 MB/s
[    8.165024] raid6: mmxx2      630 MB/s
[    8.233045] raid6: sse1x1     279 MB/s
[    8.301046] raid6: sse1x2     510 MB/s
[    8.369115] raid6: sse2x1     560 MB/s
[    8.437056] raid6: sse2x2    1017 MB/s
[    8.437062] raid6: using algorithm sse2x2 (1017 MB/s)
[    8.445887] md: raid6 personality registered for level 6
[    8.445895] md: raid5 personality registered for level 5
[    8.445900] md: raid4 personality registered for level 4
[    8.463499] md: raid10 personality registered for level 10
[   11.248546] usb-storage: device scan complete
[   11.250683] scsi 2:0:0:0: Direct-Access     Generic- Multi-Card       1.00 PQ: 0 ANSI: 0 CCS
[   11.252052] sd 2:0:0:0: Attached scsi generic sg1 type 0
[   11.258117] sd 2:0:0:0: [sdb] Attached SCSI removable disk
[   46.443462] PM: Starting manual resume from disk
[   46.443472] PM: Resume from partition 252:1
[   46.443476] PM: Checking hibernation image.
[   46.444329] PM: Resume from disk failed.
[   46.469652] REISERFS (device dm-2): found reiserfs format "3.6" with standard journal
[   46.469705] REISERFS (device dm-2): using ordered data mode
[   46.492026] REISERFS (device dm-2): journal params: device dm-2, size 8192, journal first block 18, max trans len 1024, max batch 900, max commit age 30, max trans age 30
[   46.492711] REISERFS (device dm-2): checking transaction log (dm-2)
[   46.558740] REISERFS (device dm-2): Using r5 hash to sort names
[   47.739333] type=1505 audit(1259190241.653:2): operation="profile_load" pid=529 name=/sbin/dhclient3
[   47.739924] type=1505 audit(1259190241.653:3): operation="profile_load" pid=529 name=/usr/lib/NetworkManager/nm-dhcp-client.action
[   47.740263] type=1505 audit(1259190241.653:4): operation="profile_load" pid=529 name=/usr/lib/connman/scripts/dhclient-script
[   47.775785] type=1505 audit(1259190241.690:5): operation="profile_load" pid=531 name=/usr/lib/cups/backend/cups-pdf
[   47.776548] type=1505 audit(1259190241.690:6): operation="profile_load" pid=531 name=/usr/sbin/cupsd
[   47.787097] type=1505 audit(1259190241.702:7): operation="profile_load" pid=532 name=/usr/sbin/mysqld-akonadi
[   47.802752] type=1505 audit(1259190241.718:8): operation="profile_load" pid=533 name=/usr/sbin/tcpdump
[   49.640769] Adding 1998840k swap on /dev/mapper/vg_hdd-swap.  Priority:-1 extents:1 across:1998840k 
[   51.740346] udev: starting version 147
[   58.116625] REISERFS (device dm-3): found reiserfs format "3.6" with standard journal
[   58.116657] REISERFS (device dm-3): using ordered data mode
[   58.432426] REISERFS (device dm-3): journal params: device dm-3, size 8192, journal first block 18, max trans len 1024, max batch 900, max commit age 30, max trans age 30
[   58.433177] REISERFS (device dm-3): checking transaction log (dm-3)
[   59.693106] REISERFS (device dm-3): Using r5 hash to sort names
[   60.338331] rt2860sta: module is from the staging directory, the quality is unknown, you have been warned.
[   60.346469] rt2860 0000:02:00.0: PCI INT A -> GSI 17 (level, low) -> IRQ 17
[   60.347029] 
[   60.347034] 
[   60.347036] === pAd = f8316000, size = 580808 ===
[   60.347039] 
[   60.347047] <-- RTMPAllocAdapterBlock, Status=0
[   60.347128] rt2860 0000:02:00.0: setting latency timer to 64
[   62.020511] psmouse serio1: ID: 10 00 64
[   62.069547] intel_rng: FWH not detected
[   62.078238] ip_tables: (C) 2000-2006 Netfilter Core Team
[   62.287196] lp: driver loaded but no devices found
[   62.713224] input: ImExPS/2 Generic Explorer Mouse as /devices/platform/i8042/serio1/input/input7
[   69.284560] HDA Intel 0000:00:1b.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16
[   69.284624] HDA Intel 0000:00:1b.0: setting latency timer to 64
[   69.372196] hda_codec: Unknown model for ALC1200, trying auto-probe from BIOS...
[   69.372399] input: HDA Digital PCBeep as /devices/pci0000:00/0000:00:1b.0/input/input8
[   70.744128] type=1505 audit(1259186664.661:9): operation="profile_replace" pid=1141 name=/sbin/dhclient3
[   70.744723] type=1505 audit(1259186664.661:10): operation="profile_replace" pid=1141 name=/usr/lib/NetworkManager/nm-dhcp-client.action
[   70.745205] type=1505 audit(1259186664.661:11): operation="profile_replace" pid=1141 name=/usr/lib/connman/scripts/dhclient-script
[   70.753726] type=1505 audit(1259186664.669:12): operation="profile_replace" pid=1143 name=/usr/lib/cups/backend/cups-pdf
[   70.754470] type=1505 audit(1259186664.669:13): operation="profile_replace" pid=1143 name=/usr/sbin/cupsd
[   70.759091] type=1505 audit(1259186664.673:14): operation="profile_replace" pid=1144 name=/usr/sbin/mysqld-akonadi
[   70.762615] type=1505 audit(1259186664.677:15): operation="profile_replace" pid=1145 name=/usr/sbin/tcpdump
[   76.347416] r8169: eth0: link down
[   76.348089] ADDRCONF(NETDEV_UP): eth0: link is not ready
[   76.376616] RX DESC f4b09000  size = 2048
[   76.377088] <-- RTMPAllocTxRxRingMemory, Status=0
[   76.380471] --> Error 2 opening /etc/Wireless/RT2860STA/RT2860STA.dat
[   76.380481] 1. Phy Mode = 0
[   76.380487] 2. Phy Mode = 0
[   76.401786] 3. Phy Mode = 0
[   76.405289] RTMPSetPhyMode: channel is out of range, use first channel=1 
[   76.405299] MCS Set = 00 00 00 00 00
[   76.406876] <==== RTMPInitialize, Status=0
[   76.406946] 0x1300 = 00073200
[   82.815130] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[   82.815143] [drm:edid_is_valid] *ERROR* Raw EDID:
[   82.815153] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[   82.815162] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[   82.815170] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[   82.815178] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[   82.815186] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[   82.815194] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[   82.815202] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[   82.815210] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[   82.815216] 
[   82.815224] i915 0000:00:02.0: LVDS-1: EDID invalid.
[   83.115641] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[   83.115652] [drm:edid_is_valid] *ERROR* Raw EDID:
[   83.115662] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[   83.115670] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[   83.115677] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[   83.115685] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[   83.115692] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[   83.115699] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[   83.115707] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[   83.115714] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[   83.115720] 
[   83.115727] i915 0000:00:02.0: LVDS-1: EDID invalid.
[   83.476701] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[   85.214608] QEMU Accelerator Module version 1.4.0, Copyright (c) 2005-2008 Fabrice Bellard
[   85.214749] KQEMU installed, max_locked_mem=508096kB.
[   85.894714] vboxdrv: Trying to deactivate the NMI watchdog permanently...
[   85.894722] vboxdrv: Successfully done.
[   85.894727] vboxdrv: Found 2 processor cores.
[   85.894883] vboxdrv: fAsync=0 offMin=0x180 offMax=0x28f8
[   85.894971] vboxdrv: TSC mode is 'synchronous', kernel timer mode is 'normal'.
[   85.894976] vboxdrv: Successfully loaded version 3.0.12 (interface 0x00110000).
[   87.388017] ra0: no IPv6 routers present
[   95.623996] ppdev: user-space parallel port driver
[  100.062260] CPU0 attaching NULL sched-domain.
[  100.062273] CPU1 attaching NULL sched-domain.
[  100.076229] CPU0 attaching sched-domain:
[  100.076245]  domain 0: span 0-1 level SIBLING
[  100.076258]   groups: 0 1
[  100.076279] CPU1 attaching sched-domain:
[  100.076289]  domain 0: span 0-1 level SIBLING
[  100.076299]   groups: 1 0
[  104.089116] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  110.195100] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[  110.195111] [drm:edid_is_valid] *ERROR* Raw EDID:
[  110.195121] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[  110.195129] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[  110.195137] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[  110.195144] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[  110.195152] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[  110.195160] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[  110.195168] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[  110.195175] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[  110.195181] 
[  110.195188] i915 0000:00:02.0: LVDS-1: EDID invalid.
[  110.326007] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[  110.326018] [drm:edid_is_valid] *ERROR* Raw EDID:
[  110.326028] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[  110.326036] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[  110.326044] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[  110.326052] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[  110.326060] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[  110.326067] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[  110.326075] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[  110.326083] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[  110.326089] 
[  110.326096] i915 0000:00:02.0: LVDS-1: EDID invalid.
[  134.089153] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  142.727466] CPU0 attaching NULL sched-domain.
[  142.727479] CPU1 attaching NULL sched-domain.
[  142.740278] CPU0 attaching sched-domain:
[  142.740295]  domain 0: span 0-1 level SIBLING
[  142.740309]   groups: 0 1
[  142.740330] CPU1 attaching sched-domain:
[  142.740340]  domain 0: span 0-1 level SIBLING
[  142.740351]   groups: 1 0
[  144.787044] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[  144.787061] [drm:edid_is_valid] *ERROR* Raw EDID:
[  144.787076] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[  144.787089] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[  144.787101] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[  144.787113] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[  144.787125] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[  144.787137] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[  144.787148] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[  144.787160] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[  144.787169] 
[  144.787179] i915 0000:00:02.0: LVDS-1: EDID invalid.
[  145.444637] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[  145.444654] [drm:edid_is_valid] *ERROR* Raw EDID:
[  145.444668] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[  145.444681] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[  145.444693] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[  145.444705] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[  145.444717] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[  145.444728] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[  145.444740] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[  145.444752] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[  145.444761] 
[  145.444771] i915 0000:00:02.0: LVDS-1: EDID invalid.
[  174.089650] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  177.496768] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[  177.496779] [drm:edid_is_valid] *ERROR* Raw EDID:
[  177.496788] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[  177.496796] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[  177.496803] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[  177.496811] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[  177.496818] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[  177.496825] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[  177.496833] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[  177.496840] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[  177.496846] 
[  177.496853] i915 0000:00:02.0: LVDS-1: EDID invalid.
[  177.639806] [drm:edid_is_valid] *ERROR* EDID checksum is invalid, remainder is 192
[  177.639825] [drm:edid_is_valid] *ERROR* Raw EDID:
[  177.639842] <3>00 ff ff ff ff ff ff 00 22 64 e9 03 07 b8 01 00  ........"d......
[  177.639857] <3>12 12 01 03 80 16 0d 78 0a 80 36 9a 5e 5d 91 28  .......x..6.^].(
[  177.639872] <3>20 4f 54 00 00 00 01 01 01 01 01 01 01 01 01 01   OT.............
[  177.639887] <3>01 01 01 01 01 01 94 11 00 b0 40 58 19 20 35 23  .......... at X. 5#
[  177.639902] <3>45 00 dc 81 00 00 00 19 00 00 00 fd 00 37 41 22  E............7A"
[  177.639917] <3>29 05 00 0a 20 20 20 20 20 20 00 00 00 fc 00 48  )...      .....H
[  177.639931] <3>53 44 31 30 30 49 46 57 31 0a 20 20 00 00 00 10  SD100IFW1.  ....
[  177.639946] <3>00 0a 20 20 20 20 20 20 20 20 20 20 20 20 00 81  ..            ..
[  177.639957] 
[  177.639971] i915 0000:00:02.0: LVDS-1: EDID invalid.
[  224.091025] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  344.097127] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  404.101148] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  464.104218] ===>rt_ioctl_giwscan. 4(4) BSS returned, data->length = 420
[  496.321329] RX DESC f589b000  size = 2048
[  496.321876] <-- RTMPAllocTxRxRingMemory, Status=0
[  496.325444] --> Error 2 opening /etc/Wireless/RT2860STA/RT2860STA.dat
[  496.325456] 1. Phy Mode = 0
[  496.325461] 2. Phy Mode = 0
[  496.347132] 3. Phy Mode = 0
[  496.350524] MCS Set = 00 00 00 00 00
[  496.352118] <==== RTMPInitialize, Status=0
[  496.352194] 0x1300 = 00073200
[  506.949022] ra0: no IPv6 routers present
[  534.959638] atkbd.c: Unknown key pressed (translated set 2, code 0xee on isa0060/serio0).
[  534.959658] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  534.963061] atkbd.c: Unknown key released (translated set 2, code 0xee on isa0060/serio0).
[  534.963072] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  536.077140] usb 1-5: new high speed USB device using ehci_hcd and address 3
[  536.438278] usb 1-5: configuration #1 chosen from 1 choice
[  536.615430] Linux video capture interface: v2.00
[  536.639037] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  536.652589] input: BisonCam, NB Pro as /devices/pci0000:00/0000:00:1d.7/usb1/1-5/1-5:1.0/input/input9
[  536.652740] usbcore: registered new interface driver uvcvideo
[  536.652752] USB Video Class driver (v0.1.0)
[  559.255264] usb 1-5: USB disconnect, address 3
[  559.257516] atkbd.c: Unknown key pressed (translated set 2, code 0xee on isa0060/serio0).
[  559.257535] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  559.261296] atkbd.c: Unknown key released (translated set 2, code 0xee on isa0060/serio0).
[  559.261318] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  562.622038] usbcore: deregistering interface driver uvcvideo
[  566.460092] atkbd.c: Unknown key pressed (translated set 2, code 0xee on isa0060/serio0).
[  566.460109] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  566.463644] atkbd.c: Unknown key released (translated set 2, code 0xee on isa0060/serio0).
[  566.463657] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  567.576158] usb 1-5: new high speed USB device using ehci_hcd and address 4
[  567.925100] usb 1-5: configuration #1 chosen from 1 choice
[  567.981373] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  567.989064] input: BisonCam, NB Pro as /devices/pci0000:00/0000:00:1d.7/usb1/1-5/1-5:1.0/input/input10
[  567.989226] usbcore: registered new interface driver uvcvideo
[  567.989237] USB Video Class driver (v0.1.0)
[  568.030281] ehci_hcd 0000:00:1d.7: force halt; handhake f8042024 00004000 00000000 -> -110
[  568.086375] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086390] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086400] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086409] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086419] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086427] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  568.086437] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  568.086449] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086459] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086468] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086478] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086487] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086494] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  568.086505] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  568.086516] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086526] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086536] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086545] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086554] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086561] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  568.086572] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  568.086583] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086593] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086602] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086611] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086621] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  568.086628] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  568.086639] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  568.086650] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  568.087032] hub 1-0:1.0: hub_port_status failed (err = -108)
[  591.921857] atkbd.c: Unknown key pressed (translated set 2, code 0xee on isa0060/serio0).
[  591.921878] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.
[  591.925560] atkbd.c: Unknown key released (translated set 2, code 0xee on isa0060/serio0).
[  591.925580] atkbd.c: Use 'setkeycodes e06e <keycode>' to make it known.

From stephan.diestelhorst at gmail.com  Thu Nov 26 01:38:00 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Thu, 26 Nov 2009 01:38:00 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
Message-ID: <200911260138.00802.stephan.diestelhorst@gmail.com>

Again with proper sender. Sorry.
Am Donnerstag 26 November 2009 00:13:23 schrieb Stephan Diestelhorst:
> Am Mittwoch 25 November 2009 23:38:25 schrieb Alan Stern:
> > On Wed, 25 Nov 2009, Stephan Diestelhorst wrote:
> > You should add a dump_stack() line to handshake_on_error_set_halt(), 
> > just after the ehci_err() call.  Then we'd be able to see the failure 
> > pathway and determine whether it really was caused by the delay being 
> > too short.
> 
> Will do that now and report back.
>
> I have bumped the delay up to 1000 us, and could not trigger the
> issue, even with doing modprobe uvcvideo; rmmod uvcvideo in a loop for
> several hundred interations, with varying delays between the insert
> and removal. However, I am not sure, whether this is actually stress
> testing anything.

Gotcha. Tried again with 500 us delay and the repeated modprobe/rmmod.
Crashed the thing quite quickly, see attachment for the relevant
excerpt (including call stack) from dmesg.

Now back to bumping up the value. rant { The compilation speed on this
machine does not help, though. Partly thanks to the disk encryption
eating some of the few Atom-FLOPS. Maybe compiling on an unencrypted
USB key does the trick. Erm, no. For that the USB system should work
:-/ }

Cheers,
  Stephan
-------------- next part --------------
[  208.638789] usbcore: deregistering interface driver uvcvideo
[  246.782150] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  246.786416] input: BisonCam, NB Pro as /devices/pci0000:00/0000:00:1d.7/usb1/1-5/1-5:1.0/input/input10
[  246.786612] usbcore: registered new interface driver uvcvideo
[  246.786621] USB Video Class driver (v0.1.0)
[  246.820018] ehci_hcd 0000:00:1d.7: force halt; handhake f8042024 00004000 00000000 -> -110
[  246.820018] Pid: 2332, comm: hald-probe-vide Tainted: G         C 2.6.31.4-bison-u2000 #14
[  246.820018] Call Trace:
[  246.820018]  [<c0563aa1>] ? printk+0x18/0x1f
[  246.820018]  [<c04174fc>] handshake_on_error_set_halt+0x8c/0xa0
[  246.820018]  [<c0417651>] enable_periodic+0x51/0xa0
[  246.820018]  [<c0418df6>] qh_schedule+0x236/0x300
[  246.820018]  [<c041cc01>] ehci_urb_enqueue+0x631/0xc80
[  246.820018]  [<c040616f>] usb_hcd_submit_urb+0x13f/0xaf0
[  246.820018]  [<c013ac21>] ? enqueue_task_fair+0x31/0x70
[  246.820018]  [<c011b911>] ? native_smp_send_reschedule+0x31/0x50
[  246.820018]  [<c013012e>] ? resched_task+0x5e/0x70
[  246.820018]  [<c0139977>] ? try_to_wake_up+0xf7/0x350
[  246.820018]  [<c0566338>] ? _spin_lock+0x8/0x10
[  246.820018]  [<c01f4612>] ? __d_lookup+0x102/0x110
[  246.820018]  [<c0406f4d>] usb_submit_urb+0xdd/0x240
[  246.820018]  [<f837eea5>] ? uvc_v4l2_open+0x75/0x160 [uvcvideo]
[  246.820018]  [<c040aeb2>] ? usb_autopm_do_interface+0x82/0xf0
[  246.820018]  [<f838241b>] uvc_status_start+0x1b/0x20 [uvcvideo]
[  246.820018]  [<f837eedc>] uvc_v4l2_open+0xac/0x160 [uvcvideo]
[  246.820018]  [<c01e60ca>] ? exact_lock+0xa/0x20
[  246.820018]  [<f8112932>] v4l2_open+0x62/0xa0 [videodev]
[  246.820018]  [<c01e631d>] chrdev_open+0xcd/0x190
[  246.820018]  [<c01e14d9>] __dentry_open+0xb9/0x230
[  246.820018]  [<c01e1735>] nameidata_to_filp+0x55/0x70
[  246.820018]  [<c01e6250>] ? chrdev_open+0x0/0x190
[  246.820018]  [<c01ef0da>] do_filp_open+0x53a/0x920
[  246.820018]  [<c01af591>] ? unlock_page+0x41/0x50
[  246.820018]  [<c01c7038>] ? __do_fault+0x388/0x470
[  246.820018]  [<c01e1270>] do_sys_open+0x50/0x150
[  246.820018]  [<c01e13d9>] sys_open+0x29/0x40
[  246.820018]  [<c01033ac>] syscall_call+0x7/0xb
[  247.079713] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.087168] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.094976] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.102383] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.109743] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.113368] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  247.117367] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  247.120767] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.124569] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.127725] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.130755] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.134138] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.136794] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  247.139802] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  247.142394] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.145476] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.148030] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.150844] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.153222] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.155875] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  247.158207] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  247.160913] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.163136] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.165388] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.168111] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.170241] hub 1-0:1.0: cannot reset port 6 (err = -108)
[  247.172308] hub 1-0:1.0: Cannot enable port 6.  Maybe the USB cable is bad?
[  247.174908] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  247.177043] hub 1-0:1.0: cannot disable port 6 (err = -108)
[  247.179673] hub 1-0:1.0: hub_port_status failed (err = -108)
[  247.829353] usbcore: deregistering interface driver uvcvideo
[  247.908608] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  247.908661] uvcvideo: UVC non compliance - GET_DEF(PROBE) not supported. Enabling workaround.
[  247.908678] uvcvideo: Failed to query (129) UVC probe control : -108 (exp. 26).
[  247.911117] uvcvideo: Failed to initialize the device (-5).
[  247.913213] usbcore: registered new interface driver uvcvideo
[  247.913224] USB Video Class driver (v0.1.0)
[  248.948360] usbcore: deregistering interface driver uvcvideo
[  248.987338] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  248.987410] uvcvideo: UVC non compliance - GET_DEF(PROBE) not supported. Enabling workaround.
[  248.987432] uvcvideo: Failed to query (129) UVC probe control : -108 (exp. 26).
[  248.991170] uvcvideo: Failed to initialize the device (-5).
[  248.996860] usbcore: registered new interface driver uvcvideo
[  248.996873] USB Video Class driver (v0.1.0)
[  250.027311] usbcore: deregistering interface driver uvcvideo
[  250.065112] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  250.065166] uvcvideo: UVC non compliance - GET_DEF(PROBE) not supported. Enabling workaround.
[  250.065184] uvcvideo: Failed to query (129) UVC probe control : -108 (exp. 26).
[  250.067093] uvcvideo: Failed to initialize the device (-5).
[  250.069135] usbcore: registered new interface driver uvcvideo
[  250.069147] USB Video Class driver (v0.1.0)
[  251.105638] usbcore: deregistering interface driver uvcvideo
[  251.142583] uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0203)
[  251.142623] uvcvideo: UVC non compliance - GET_DEF(PROBE) not supported. Enabling workaround.
[  251.142634] uvcvideo: Failed to query (129) UVC probe control : -108 (exp. 26).
[  251.144805] uvcvideo: Failed to initialize the device (-5).
[  251.147469] usbcore: registered new interface driver uvcvideo
[  251.147481] USB Video Class driver (v0.1.0)

From stephan.diestelhorst at gmail.com  Thu Nov 26 01:38:17 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Thu, 26 Nov 2009 01:38:17 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
Message-ID: <200911260138.17231.stephan.diestelhorst@gmail.com>

Again with proper sender. Sorry.
Am Donnerstag 26 November 2009 00:45:14 schrieb Stephan Diestelhorst:
> Now back to bumping up the value.

900 us seems to do the trick. Tested with:
  500 us broken
 1000 us works
  600 us broken
  800 us broken
  900 us works

Please see the dmesgs of the 500 - 900 us runs in the attached
archive. The 900 us have been tested with more than 80 modprobe /
rmmod rounds, with 1.0 s and 0.5 s delay.

All these runs had a working cam initially, that's what fooled us in
the initial estimation.

I am curious, if I understand correctly that this is a chipset issue?
If so, why has it not been triggered with other USB devices?

Thanks,
  Stephan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg_bison_testing.tar.bz2
Type: application/x-bzip-compressed-tar
Size: 6822 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20091126/74ae77f9/attachment.bin>

From pj.assis at gmail.com  Fri Nov 27 12:04:40 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 27 Nov 2009 11:04:40 +0000
Subject: [Linux-uvc-devel] Timestamp Accuracy Patch
In-Reply-To: <200911250217.19104.laurent.pinchart@ideasonboard.com>
References: <833B0B09C5041D42A9924A3BA6A12B9A028FB22085@CALMAIL-CMS.smarttech.inc>
	<200911250217.19104.laurent.pinchart@ideasonboard.com>
Message-ID: <59cf47a80911270304i19c8eb17je35ed648c04065a4@mail.gmail.com>

Laurent,
I've notice that the buffer timestamps are obtained with
do_gettimeofday, this makes me a bit worried, if the system time
changes while streaming I believe this can cause a major error in the
time stamps, also on many systems gettimeofday uses the TSC, but on
some multicore systems the TSC on each core may be out of sync, in
which case the cpu you are running on may give a different
gettimeofday result than another cpu (this may explain the time drift
between consecutive frames in my quad processor)
You should use clock_gettime(CLOCK_MONOTONIC) instead of
gettimeofday() for interval timing, or just do like gspca and use
jiffies, this works very well since it's reference is boot time and
it's monotonic, it also seems more accurate than uvc, at least I don't
notice the same clock drift between consecutive clock frames.
The change for uvc should be easy enough:

--- uvc_queue.c 2009-11-27 00:26:13 +0000
+++ uvc_queue_patched.c 2009-11-27 10:06:47 +0000
@@ -20,6 +20,7 @@
 #include <linux/vmalloc.h>
 #include <linux/wait.h>
 #include <asm/atomic.h>
+#include <linux/jiffies.h>

 #include "uvcvideo.h"

@@ -497,7 +498,8 @@
        spin_unlock_irqrestore(&queue->irqlock, flags);

        buf->buf.sequence = queue->sequence++;
-       do_gettimeofday(&buf->buf.timestamp);
+       jiffies_to_timeval(get_jiffies_64(),
+                                  &buf->buf.timestamp);

        wake_up(&buf->wait);
        return nextbuf;

This change would be very much appreciated, since I'm struggling a bit
with matroska files in some video players (mplayer, vlc) they seem to
require perfectly synced timestamps, I guess they set the internal
clock to the given fps, gstreamer in the other hand works without
problems, it probably uses a higher and fixed resolution clock ( 1ms
??).
Video Captures from the few gspca cameras I've tested work without
major problems in any of these players.
AVI since it doesn't contain time stamps also works without issues.

Best regards,
Paulo


From stephan.diestelhorst at gmail.com  Fri Nov 27 12:10:17 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Fri, 27 Nov 2009 12:10:17 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911252149010.8284-100000@netrider.rowland.org>
References: <Pine.LNX.4.44L0.0911252149010.8284-100000@netrider.rowland.org>
Message-ID: <200911271210.22289.stephan.diestelhorst@gmail.com>

Am Donnerstag, 26. November 2009 03:51:42 schrieb Alan Stern:
> On Thu, 26 Nov 2009, Stephan Diestelhorst wrote:
> 
> > Gotcha. Tried again with 500 us delay and the repeated modprobe/rmmod.
> > Crashed the thing quite quickly, see attachment for the relevant
> > excerpt (including call stack) from dmesg.
> 
> Yes, that's the same as before: enable_periodic().  In other words, the 
> preceding call to disable_periodic() didn't have the desired effect, 
> thanks to the hardware bug.

Alright. It seems that we have nailed it now.

> > Now back to bumping up the value. rant { The compilation speed on this
> > machine does not help, though. Partly thanks to the disk encryption
> > eating some of the few Atom-FLOPS. Maybe compiling on an unencrypted
> > USB key does the trick. Erm, no. For that the USB system should work
> > :-/ }
> 
> Compilation speed should not be a big issue.  After all, you're only 
> rebuilding a single file.  Does it really take more than (say) 30 
> seconds?

It does. It is more on the order of (felt) 5 - 10 mins, thanks to make
running through the whole source tree, a fairly large config. Linking
and the other necessary compile steps (call syms etc.) take quite some
time.

Anyways, we all know about the possible remedies and this was OT
anyways.

Cheers,
  Stephan


From pj.assis at gmail.com  Fri Nov 27 20:21:36 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 27 Nov 2009 19:21:36 +0000
Subject: [Linux-uvc-devel] Timestamp Accuracy Patch
In-Reply-To: <59cf47a80911270304i19c8eb17je35ed648c04065a4@mail.gmail.com>
References: <833B0B09C5041D42A9924A3BA6A12B9A028FB22085@CALMAIL-CMS.smarttech.inc>
	<200911250217.19104.laurent.pinchart@ideasonboard.com>
	<59cf47a80911270304i19c8eb17je35ed648c04065a4@mail.gmail.com>
Message-ID: <59cf47a80911271121v3a678adeud78e638fc51dadc6@mail.gmail.com>

I've just tested my assumption on do_gettimeofday and as expected  the
buffer timestamps do some time traveling when changing the system time
:D
using jiffies is not an ideal option since it has a lower resolution
but since it's monotonic changing system time doesn't affect the time
stamps.
The ideal would be to use a highres monotonic clock and construct the
timestamp from there.
This is a major problem for anyone running ntp servers or with any
type of automatic time sync.

Best regards,
Paulo

2009/11/27 Paulo Assis <pj.assis at gmail.com>:
> Laurent,
> I've notice that the buffer timestamps are obtained with
> do_gettimeofday, this makes me a bit worried, if the system time
> changes while streaming I believe this can cause a major error in the
> time stamps, also on many systems gettimeofday uses the TSC, but on
> some multicore systems the TSC on each core may be out of sync, in
> which case the cpu you are running on may give a different
> gettimeofday result than another cpu (this may explain the time drift
> between consecutive frames in my quad processor)
> You should use clock_gettime(CLOCK_MONOTONIC) instead of
> gettimeofday() for interval timing, or just do like gspca and use
> jiffies, this works very well since it's reference is boot time and
> it's monotonic, it also seems more accurate than uvc, at least I don't
> notice the same clock drift between consecutive clock frames.
> The change for uvc should be easy enough:
>
> --- uvc_queue.c 2009-11-27 00:26:13 +0000
> +++ uvc_queue_patched.c 2009-11-27 10:06:47 +0000
> @@ -20,6 +20,7 @@
> ?#include <linux/vmalloc.h>
> ?#include <linux/wait.h>
> ?#include <asm/atomic.h>
> +#include <linux/jiffies.h>
>
> ?#include "uvcvideo.h"
>
> @@ -497,7 +498,8 @@
> ? ? ? ?spin_unlock_irqrestore(&queue->irqlock, flags);
>
> ? ? ? ?buf->buf.sequence = queue->sequence++;
> - ? ? ? do_gettimeofday(&buf->buf.timestamp);
> + ? ? ? jiffies_to_timeval(get_jiffies_64(),
> + ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?&buf->buf.timestamp);
>
> ? ? ? ?wake_up(&buf->wait);
> ? ? ? ?return nextbuf;
>
> This change would be very much appreciated, since I'm struggling a bit
> with matroska files in some video players (mplayer, vlc) they seem to
> require perfectly synced timestamps, I guess they set the internal
> clock to the given fps, gstreamer in the other hand works without
> problems, it probably uses a higher and fixed resolution clock ( 1ms
> ??).
> Video Captures from the few gspca cameras I've tested work without
> major problems in any of these players.
> AVI since it doesn't contain time stamps also works without issues.
>
> Best regards,
> Paulo
>


From palmax at gmail.com  Mon Nov 30 12:02:46 2009
From: palmax at gmail.com (palmax at gmail.com)
Date: Mon, 30 Nov 2009 12:02:46 +0100
Subject: [Linux-uvc-devel] [UVC] Resuming: What are controls necessary
	resume when I suspend and resume video streaming?
Message-ID: <209499a0911300302x199ffb5flaff8010ee0658b8b@mail.gmail.com>

Hello

I want to write a resume and suspend functions for building the
basement of still image support. I read that resume is written but I
want to know what controls are necessaries for doing "suspend+resume"
functionality.

Could you help me?

Thanks
Palmax


From pj.assis at gmail.com  Mon Nov 30 17:49:24 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 30 Nov 2009 16:49:24 +0000
Subject: [Linux-uvc-devel] Timestamp Accuracy Patch
In-Reply-To: <59cf47a80911271121v3a678adeud78e638fc51dadc6@mail.gmail.com>
References: <833B0B09C5041D42A9924A3BA6A12B9A028FB22085@CALMAIL-CMS.smarttech.inc>
	<200911250217.19104.laurent.pinchart@ideasonboard.com>
	<59cf47a80911270304i19c8eb17je35ed648c04065a4@mail.gmail.com>
	<59cf47a80911271121v3a678adeud78e638fc51dadc6@mail.gmail.com>
Message-ID: <59cf47a80911300849u2d2bb009ue7f7030586c56df3@mail.gmail.com>

Hi,
using ktime_get (hrtimer.h) should provide a nice monotonic high res
timer as a replacement for do_gettimeofday:

ktime_to_timeval (ktime_get()) should return the timeval struct for
buf->buf.timestamp.

This seems the best aproach for video frame time-stamping; it's
monotonic and it has a more than adequate resolution.

Best regards,
Paulo





2009/11/27 Paulo Assis <pj.assis at gmail.com>:
> I've just tested my assumption on do_gettimeofday and as expected ?the
> buffer timestamps do some time traveling when changing the system time
> :D
> using jiffies is not an ideal option since it has a lower resolution
> but since it's monotonic changing system time doesn't affect the time
> stamps.
> The ideal would be to use a highres monotonic clock and construct the
> timestamp from there.
> This is a major problem for anyone running ntp servers or with any
> type of automatic time sync.
>


From stephan.diestelhorst at gmail.com  Mon Nov 30 22:15:04 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Mon, 30 Nov 2009 22:15:04 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <200911231020.46855.oliver@neukum.org>
References: <Pine.LNX.4.44L0.0911211143580.6664-100000@netrider.rowland.org>
	<200911231020.46855.oliver@neukum.org>
Message-ID: <200911302215.04555.stephan.diestelhorst@gmail.com>

Am Montag 23 November 2009 10:20:46 schrieb Oliver Neukum:
> Am Samstag, 21. November 2009 17:56:30 schrieb Alan Stern:
> this version should be efficient.
> Stephan, please test.

I have increased the delay to 1000us, as discussed and added a
tested-by notice.

Is my back-port of interest to anyone?

Cheers,
  Stephan
--
commit 1d272fa5ec701b8e39ed9e822f25a4c12f50aa71
Author: Oliver Neukum <oliver at neukum.org>
Date:   Mon Nov 23 10:12:55 2009 +0100

    usb:workaround for EHCI with broken periodic schedules
    
    Some controllers must execute a periodic schedule for
    a minimum time before they can disable it.
    This adds a variable delay based on the time of the
    last enablement.

    Tested-by: stephan.diestelhorst at gmail.com

diff --git a/drivers/usb/host/ehci-hcd.c b/drivers/usb/host/ehci-hcd.c
index 9835e07..f5f5601 100644
--- a/drivers/usb/host/ehci-hcd.c
+++ b/drivers/usb/host/ehci-hcd.c
@@ -28,6 +28,7 @@
 #include <linux/errno.h>
 #include <linux/init.h>
 #include <linux/timer.h>
+#include <linux/ktime.h>
 #include <linux/list.h>
 #include <linux/interrupt.h>
 #include <linux/usb.h>
@@ -676,6 +677,7 @@ static int ehci_run (struct usb_hcd *hcd)
 	ehci_readl(ehci, &ehci->regs->command);	/* unblock posted writes */
 	msleep(5);
 	up_write(&ehci_cf_port_reset_rwsem);
+	ehci->last_periodic_enable = ktime_get_real();
 
 	temp = HC_VERSION(ehci_readl(ehci, &ehci->caps->hc_capbase));
 	ehci_info (ehci,
diff --git a/drivers/usb/host/ehci-pci.c b/drivers/usb/host/ehci-pci.c
index 378861b..ead5f4f 100644
--- a/drivers/usb/host/ehci-pci.c
+++ b/drivers/usb/host/ehci-pci.c
@@ -111,6 +111,10 @@ static int ehci_pci_setup(struct usb_hcd *hcd)
 	switch (pdev->vendor) {
 	case PCI_VENDOR_ID_INTEL:
 		ehci->need_io_watchdog = 0;
+		if (pdev->device == 0x27cc) {
+			ehci->broken_periodic = 1;
+			ehci_info(ehci, "using broken periodic workaround\n");
+		}
 		break;
 	case PCI_VENDOR_ID_TDI:
 		if (pdev->device == PCI_DEVICE_ID_TDI_EHCI) {
diff --git a/drivers/usb/host/ehci-sched.c b/drivers/usb/host/ehci-sched.c
index b25cdea..0468e88 100644
--- a/drivers/usb/host/ehci-sched.c
+++ b/drivers/usb/host/ehci-sched.c
@@ -475,6 +475,8 @@ static int enable_periodic (struct ehci_hcd *ehci)
 	/* make sure ehci_work scans these */
 	ehci->next_uframe = ehci_readl(ehci, &ehci->regs->frame_index)
 		% (ehci->periodic_size << 3);
+	if (unlikely(ehci->broken_periodic))
+		ehci->last_periodic_enable = ktime_get_real();
 	return 0;
 }
 
@@ -486,6 +488,15 @@ static int disable_periodic (struct ehci_hcd *ehci)
 	if (--ehci->periodic_sched)
 		return 0;
 
+	if (unlikely(ehci->broken_periodic)) {
+		ktime_t safe = ktime_add_us(ehci->last_periodic_enable, 1000);
+		ktime_t now = ktime_get_real();
+		s64 delay = ktime_us_delta(safe, now);
+		
+		if (unlikely(delay > 0))
+			udelay(delay);
+	}
+
 	/* did setting PSE not take effect yet?
 	 * takes effect only at frame boundaries...
 	 */
diff --git a/drivers/usb/host/ehci.h b/drivers/usb/host/ehci.h
index 064e768..2d85e21 100644
--- a/drivers/usb/host/ehci.h
+++ b/drivers/usb/host/ehci.h
@@ -118,6 +118,7 @@ struct ehci_hcd {			/* one per controller */
 	unsigned		stamp;
 	unsigned		random_frame;
 	unsigned long		next_statechange;
+	ktime_t			last_periodic_enable;
 	u32			command;
 
 	/* SILICON QUIRKS */
@@ -127,6 +128,7 @@ struct ehci_hcd {			/* one per controller */
 	unsigned		big_endian_desc:1;
 	unsigned		has_amcc_usb23:1;
 	unsigned		need_io_watchdog:1;
+	unsigned		broken_periodic:1;
 
 	/* required for usb32 quirk */
 	#define OHCI_CTRL_HCFS          (3 << 6)







From stephan.diestelhorst at gmail.com  Mon Nov 30 22:18:04 2009
From: stephan.diestelhorst at gmail.com (Stephan Diestelhorst)
Date: Mon, 30 Nov 2009 22:18:04 +0100
Subject: [Linux-uvc-devel] BisonCam 5986:0203 kills USB
In-Reply-To: <Pine.LNX.4.44L0.0911271243250.30903-100000@netrider.rowland.org>
References: <Pine.LNX.4.44L0.0911271243250.30903-100000@netrider.rowland.org>
Message-ID: <200911302218.04696.stephan.diestelhorst@gmail.com>

Am Freitag 27 November 2009 18:47:10 schrieb Alan Stern:
> > That would be fine with me. Are there any adverse effects one should
> > watch out for?
> 
> Well, you wouldn't want this to kick in if you were running a very busy
> server, or if you wanted to guarantee low latency or use a realtime
> (RT) kernel.  None of these is likely to crop up with a netbook.  :-)

Actually I have an RT kernel installed on this machine. AFAICS, these
delays could actually be made interruptible, at least this particular
one.

> > Is there anything left for me todo at the moment?
> 
> Just verify that Oliver's patch is okay, and let other people 
> experiencing this problem know where to find it.

Will do.

Thanks,
  Stephan


