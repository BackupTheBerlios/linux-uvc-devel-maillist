From khomitchr at gmail.com  Wed Sep  2 03:11:53 2009
From: khomitchr at gmail.com (roman_khomitch@hotmail.com)
Date: Tue, 1 Sep 2009 15:11:53 -1000
Subject: [Linux-uvc-devel]  Looking for upside down uvc cams
In-Reply-To: <6da05db80909010243j523ad5a7rc8e4fd89152e754f@mail.gmail.com>
References: <6da05db80909010243j523ad5a7rc8e4fd89152e754f@mail.gmail.com>
Message-ID: <6da05db80909011811s7bf5066cm4c0aabc26a42083@mail.gmail.com>

Hans,

Here is the log files that you need for your project.  Thank you for taking
the time to provide ubuntu support for all of us out there.
Do by chance know how long it will take for this to be implemented, so I
could benefit from the fix?

Sincerely,

Roman K.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090901/b724bee0/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmi.log
Type: application/octet-stream
Size: 11822 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090901/b724bee0/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.log
Type: application/octet-stream
Size: 982 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090901/b724bee0/attachment-0001.obj>

From bo-liu at hotmail.com  Thu Sep  3 06:00:34 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Thu, 3 Sep 2009 12:00:34 +0800
Subject: [Linux-uvc-devel] uvcvideo: Failed to query (129) UVC control 1
Message-ID: <COL115-W21F75762E050FB931BBC549FEF0@phx.gbl>


Hi, ALL 
 
      I?have this question when use my webcam
 
uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
uvcvideo: Failed to initialize the device (-5).
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v0.1.0)

     http://lists.berlios.de/pipermail/linux-uvc-devel/2007-September/002129.html
     This link tell me 
"
Kernel 2.6.22 includes bug fixes in the usbaudio driver that can trigger 
another firmware bug in the webcam. Fortunately this one seems to have a 
workaround, although not a pretty one.
"
 
     But I am using kernel 2.6.23. Still have this bug. Is there any detail message
about it(eg..the src code) both in the kernel and uvc driver.
 
     Thanks a lot!

---

Best regards
Bo Liu
_________________________________________________________________
Show them the way! Add maps and directions to your party invites. 
http://www.microsoft.com/windows/windowslive/products/events.aspx


From Marcel.Glacki at stud.fh-swf.de  Fri Sep  4 23:37:56 2009
From: Marcel.Glacki at stud.fh-swf.de (Marcel Glacki)
Date: Fri, 4 Sep 2009 21:37:56 -00
Subject: [Linux-uvc-devel]  Any progress on ARKMICRO (18ec:3288) ?
Message-ID: <jUsT.aNoTheR.mEsSaGe.iD.12521005909032@www.fh-swf.de>

Hi there,

I got a very cheap webcam in order to test some CV stuff. But as 
the cam didn't cooperate I started researching why and finally encountered 
this mailing list.

The first thread I saw was:
http://lists.berlios.de/pipermail/linux-uvc-devel/2008-December/004410.
html
I tried setting quirks=2 as mentioned there et voila I got a beautiful 
picture with VLC and cheese. (Didn't try other programs yet.)

Now there are some things I don't understand:
1. When I do a `cat /dev/video1` while the cam is connected the shell 
tells me: "cat: /dev/video1: No such device"
If the cam is not connected the shell returns "cat: /dev/video1: 
No such file or directory"
2. I tried some code-snippets from http://www.c-plusplus.de/forum/viewtopic-
var-p-is-1626217.html but they all either abort with the "No such 
device" error when they try to "read(...)" or return a picture with 
an almost black picture and very few mixed colored pixels at the 
top.
3. When starting cheese from shell it frequently says: "libv4l2: 
error converting / decoding frame data: v4l-convert: error parsing 
JPEG header: Not a JPG file ?" but I get a picture.

Next thread I saw was:
http://lists.berlios.de/pipermail/linux-uvc-devel/2009-April/004741.html
That is the one I'm about to response to. You, Laurent, said you 
need some consecutives frames. When you give me a code-snippet to 
capture some I'll try. (I don't know how to as the snippets mentioned 
above IMHO don't work).

Regards,
Marcel








From comsoft at xmission.com  Sun Sep  6 11:09:46 2009
From: comsoft at xmission.com (Will Blaylock)
Date: Sun, 06 Sep 2009 03:09:46 -0600
Subject: [Linux-uvc-devel] 04f2:a216 Chicony Electronics Co., Ltd
Message-ID: <4AA37C5A.6020109@xmission.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I *believe* this is an appropriate camera to be added, may just need to
kick the user a couple of times and get the correct stuff loaded.

Bus 001 Device 029: ID 04f2:a216 Chicony Electronics Co., Ltd

Looking at the camera it states
Jazz HDV188 HDMI HiD

In a previous lifetime the following cameras were found by accident to
be the same Windows driver and both look very similar physically
(especially when you open them up)

Vivitar dvr 710
Vivitar dvr 865hd

I have no idea if this camera is UVC ready or not.

My only access to the original drivers is on a virtualbox.

I am running Ubuntu 9.04 if that makes any difference.

I am subscribed to the list and will gladly respond with any further
information I am asked for.

I am trying to gain access once again to the vivitar 965 to see what it
IDs as but I STRONGLY suspect it will be the same camera with a few
cosmetic changes and different name tags

I have installed nothing but cheese, luvcview, v4l-conf and previously
had skype, VLC installed.

All recognize my wifes logitech none recognize mine.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkqjfE4ACgkQHVZOm4O6jpRvawCdEH0IVyCXCd60FmjYqOlhxf4k
Y7kAnRTuHOj/92E9dMwXLmxI8MDDa1rM
=tViI
-----END PGP SIGNATURE-----


From shrisha_18 at hotmail.com  Mon Sep  7 08:51:27 2009
From: shrisha_18 at hotmail.com (SHRISHA PRASAD R)
Date: Mon, 7 Sep 2009 12:21:27 +0530
Subject: [Linux-uvc-devel] help needed- UVC driver for PC camera controller
Message-ID: <BAY109-W46BB0DAD865329445F6166E3EB0@phx.gbl>


Hi, 
I am actually new to linux world. I recently started working on USB 2.0 Video Class
PC Camera Controller SN9C230 board. I see that it is supported on the linux UVC  drivers list
Also I confirmed this from the SN9C230 data sheet.

Now I want to observe video data from my digital camera that has this IC by connecting to the PC.
I shall connect this board that has USB to the PC .I want to know what do I need to do for this?

things that  I should install and run to observe UVC driver for USB, please help me.

Regards,

_________________________________________________________________
News, sports, entertainment and fine living?learn the ropes on MSN India
http://in.msn.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090907/73194fcb/attachment.html>

From mannemerak at gmail.com  Mon Sep  7 09:22:21 2009
From: mannemerak at gmail.com (Manne Merak)
Date: Mon, 07 Sep 2009 09:22:21 +0200
Subject: [Linux-uvc-devel] help needed- UVC driver for PC camera
	controller
In-Reply-To: <BAY109-W46BB0DAD865329445F6166E3EB0@phx.gbl>
References: <BAY109-W46BB0DAD865329445F6166E3EB0@phx.gbl>
Message-ID: <4AA4B4AD.90201@gmail.com>

SHRISHA PRASAD R wrote:
> Hi,
> I am actually new to linux world. I recently started working on USB 
> 2.0 Video Class
> PC Camera Controller SN9C230 board. I see that it is supported on the 
> linux UVC  drivers list
> Also I confirmed this from the SN9C230 data sheet.
>
> Now I want to observe video data from my digital camera that has this 
> IC by connecting to the PC.
> I shall connect this board that has USB to the PC .I want to know what 
> do I need to do for this?
>
> things that  I should install and run to observe UVC driver for USB, 
> please help me.
>
> Regards,

Welcome.

You say: "observe video data" - just to be clear, do you want to see 
video from the camera displayed on the screen OR capture the raw data 
coming from the  controller board?

Manne



From shrisha_18 at hotmail.com  Mon Sep  7 09:33:58 2009
From: shrisha_18 at hotmail.com (SHRISHA PRASAD R)
Date: Mon, 7 Sep 2009 13:03:58 +0530
Subject: [Linux-uvc-devel] help needed- UVC driver for PC camera
	controller
Message-ID: <BAY109-W9FD1B6F3347FB4C0FD12CE3EB0@phx.gbl>



"You say: "observe video data" - just to be clear, do you want to see 
video from the camera displayed on the screen OR capture the raw data 
coming from the  controller board?",

Hi,
I want to capture raw data coming from my controller board like USB data packet format 
having endP and other info at this moment.

For this , what do I need to set up ans install and use?

regards,

From: shrisha_18 at hotmail.com
To: linux-uvc-devel at lists.berlios.de
Subject: help needed- UVC driver for PC camera controller
Date: Mon, 7 Sep 2009 12:21:27 +0530








Hi, 
I am actually new to linux world. I recently started working on USB 2.0 Video Class
PC Camera Controller SN9C230 board. I see that it is supported on the linux UVC  drivers list
Also I confirmed this from the SN9C230 data sheet.

Now I want to observe video data from my digital camera that has this IC by connecting to the PC.
I shall connect this board that has USB to the PC .I want to know what do I need to do for this?

things that  I should install and run to observe UVC driver for USB, please help me.

Regards,

Date India?s Teen Diva. Find out if you hit it off with her or are her fiery opposite. Drag n? drop
_________________________________________________________________
Sports, news, fashion and entertainment. Pick it all up in a package called MSN India
http://in.msn.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090907/8033dfab/attachment.html>

From mannemerak at gmail.com  Mon Sep  7 09:42:59 2009
From: mannemerak at gmail.com (Manne Merak)
Date: Mon, 07 Sep 2009 09:42:59 +0200
Subject: [Linux-uvc-devel] help needed- UVC driver for PC
	camera	controller
In-Reply-To: <BAY109-W9FD1B6F3347FB4C0FD12CE3EB0@phx.gbl>
References: <BAY109-W9FD1B6F3347FB4C0FD12CE3EB0@phx.gbl>
Message-ID: <4AA4B983.5070304@gmail.com>

SHRISHA PRASAD R wrote:
>
> "You say: "observe video data" - just to be clear, do you want to see 
> video from the camera displayed on the screen OR capture the raw data 
> coming from the  controller board?",
>
> Hi,
> I want to capture raw data coming from my controller board like USB data packet format 
> having endP and other info at this moment.
>
> For this , what do I need to set up ans install and use?
>
> regards,
>   

Unfortunately I do not know, but I am sure others on the list may be 
able to help?

Manne



From shrisha_18 at hotmail.com  Mon Sep  7 11:37:07 2009
From: shrisha_18 at hotmail.com (SHRISHA PRASAD R)
Date: Mon, 7 Sep 2009 15:07:07 +0530
Subject: [Linux-uvc-devel] help needed- UVC driver for PC camera controller
Message-ID: <BAY109-W33F433A941BD00C5A0C1F4E3EB0@phx.gbl>


Hi,

We have a digital camera module that has a camera controller on board , its data sheet confirm that we can use UVC linux drivers for platform support. We would like to observe USB communication happening between the PC and the board in which the SN9C230
is present.

I see that it is supported on the linux UVC  drivers list
Also I confirmed this from the SN9C230 data sheet.

I wanted to know how to use UVC driver to access and observe the 
SN9C230 transmitting and receiving.

Can anyone suggest me ?

Regards





_________________________________________________________________
One stop at MSN India to catch up with what?s hot in the world around you today
http://in.msn.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090907/da934ffb/attachment.html>

From bo-liu at hotmail.com  Thu Sep 10 09:46:59 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Thu, 10 Sep 2009 15:46:59 +0800
Subject: [Linux-uvc-devel] Help,
 after replug the webcam the dev node changed from video0 to video1
Message-ID: <COL115-W1B01B2E86EA248A0455269FE80@phx.gbl>


Hi, All
 
      There is a problem when I use my webcam.
      First, every thing is ok. I use gstreamer play video from /dev/video0
      Then, I unpluged my webcam(but didn't stop gstreamer).
 
      Replug camera again. dev node is changed to video1. And Gstreamser can't play video any more,because it's still use video0.
 
      I think because gstreamer is using the /dev/video0, so when unplug the device,udev can't rmmod dev node /dev/video0.
      And it must make a new node /dev/video1 after replug.
 
      So, My question is is there any way to rm dev node /dev/video0 when unplug the webcam while gstreamer(or maybe mplayer..) still 
      running,  and after replug webcam gstreamer can continue to work.

Thanks !

---

Best regards
Bo Liu
_________________________________________________________________
Drag n? drop?Get easy photo sharing with Windows Live? Photos.

http://www.microsoft.com/windows/windowslive/products/photos.aspx

From david at watzke.cz  Sat Sep 12 22:20:19 2009
From: david at watzke.cz (David Watzke)
Date: Sat, 12 Sep 2009 22:20:19 +0200
Subject: [Linux-uvc-devel] yet another upside down camera (asus k70io)
Message-ID: <200909122220.19157.david@watzke.cz>

hello there,
 
I've got this asus k70io notebook with upside-down mounted camera... so I'm 
sending you lsusb and dmidecode output... I hope it helps - please let me know 
so that I can fix it for myself
 
thanks


From david at watzke.cz  Sat Sep 12 22:54:49 2009
From: david at watzke.cz (David Watzke)
Date: Sat, 12 Sep 2009 22:54:49 +0200
Subject: [Linux-uvc-devel] yet another upside down camera (asus k70io)
Message-ID: <200909122254.49635.david@watzke.cz>

> hello there,
> 
> I've got this asus k70io notebook with upside-down mounted camera... so I'm
> sending you lsusb and dmidecode output... I hope it helps - please let me
>  know so that I can fix it for myself
> 
> thanks

oh my god, I've forgot to attach the files... so here they are
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmi.log
Type: text/x-log
Size: 11888 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090912/3dbfadaf/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.log
Type: text/x-log
Size: 479 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090912/3dbfadaf/attachment-0001.bin>

From pj.assis at gmail.com  Sun Sep 13 15:32:20 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 13 Sep 2009 14:32:20 +0100
Subject: [Linux-uvc-devel] control string localization
Message-ID: <59cf47a80909130632t77042b99u59eb5842a078367d@mail.gmail.com>

Hi,
Currently, uvc driver and I guess all other v4l2 video drivers use
internal stored control strings.
This poses a problem when adding localization for this strings, since
they can change between drivers.
Even if driver developers are careful enough to return the same string
for the correspondent control ID, a slight difference: Brightness or
brightness is enough for a failed translation.
Since the control ID's are defined in the V4L2 API is there any
special reason why the correspondent control strings are not.
I may be failing to see this correctly but at least for me it seems
much logical that if all standard control IDs are already defined
there, then also the name string should be made available through this
central public API, making it exactly the same for all drivers.

If I'm wrong please feel free to shut me up, and kick me in the but. :-)

Best regards,
Paulo


From bo-liu at hotmail.com  Tue Sep 15 10:01:03 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Tue, 15 Sep 2009 16:01:03 +0800
Subject: [Linux-uvc-devel] Always polling atfer unplug the usb webcam, BUG ?
Message-ID: <COL115-W1C67269FD9E10DBE108679FE30@phx.gbl>


Hi, 
 
     I found a problem when using my webcam. First, it's ok, but after I unplug it. Systerm call poll() will not return.
 
I looked at the src code, and found that uvc_queue_poll() always return 0, it didn't know the webcam have unpluged at that time.
 
     And I saw in funtion uvc_video_complete(), if urb->status is -ESHUTDOWN,uvc_queue_cancel(queue, urb->status == -ESHUTDOWN);
will be called.
 
     But, if just when in uvc_video_complete()> usb_submit_urb() , the webcam is unpluged, the usb_submit_urb() will failed, but just with a printk. Won't call uvc_queue_cancel(). So, uvc_queue_poll() will always return 0.  And, I add uvc_queue_cancel() after usb_submit_urb()  failed ,erverything is ok.
 
     Is this a bug ? 
 
 
Funtions uvc_video_complete():
 
716         if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
717                 uvc_printk(KERN_ERR, "Failed to resubmit video URB (%d).\n",
718                         ret);
719         }
 
 
     
Thanks!

---

Best regards
Bo Liu
_________________________________________________________________
With Windows Live, you can organize, edit, and share your photos.
http://www.microsoft.com/middleeast/windows/windowslive/products/photo-gallery-edit.aspx


From olegorov at gmail.com  Thu Sep 17 16:43:02 2009
From: olegorov at gmail.com (=?KOI8-R?B?78zFxyDlx8/Sz9c=?=)
Date: Thu, 17 Sep 2009 18:43:02 +0400
Subject: [Linux-uvc-devel] Upside down webcamera
In-Reply-To: <3eea157a0909170732n423f8b16u916b49572036ee1e@mail.gmail.com>
References: <3eea157a0909170732n423f8b16u916b49572036ee1e@mail.gmail.com>
Message-ID: <3eea157a0909170743u50c656abqf023c3545c59cb73@mail.gmail.com>

Hello! I have got laptop ASUS K50AB with upside down webcamera and have read
this
https://lists.berlios.de/pipermail/linux-uvc-devel/2009-June/004886.html

So, there are logs

Hope you will help. Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090917/28920ac0/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.log
Type: text/x-log
Size: 540 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090917/28920ac0/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmi.log
Type: text/x-log
Size: 13479 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090917/28920ac0/attachment-0001.bin>

From laurent.pinchart at ideasonboard.com  Fri Sep 18 12:41:21 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 12:41:21 +0200
Subject: [Linux-uvc-devel] Omnivision integrated into Dell Inspiron -
	Garbled Video
In-Reply-To: <1a1e29240908260449n1003fd87xa97fa8c692be04da@mail.gmail.com>
References: <1a1e29240908260449n1003fd87xa97fa8c692be04da@mail.gmail.com>
Message-ID: <200909181241.21517.laurent.pinchart@ideasonboard.com>

Hi Mark,

sorry for the late reply, I've been traveling a lot lately, and holidays don't 
feel like holidays unless you have no e-mail access.

On Wednesday 26 August 2009 13:49:03 Mark Williams wrote:
> Hi,
> 
> I was following a thread about the same camera from a while back but I
>  never saw any resolution.  My camera displays garbled video in luvcview
>  such that I feel like it might cause a siezure if i stare at it for too
>  long.  It looks like "noise" mostly.
> 
> I have a Dell Inspiron 1420 with the built in Omnivision camera.
> lsusb reports:  Bus 002 Device 002: ID 05a9:2640 OmniVision Technologies,
> Inc.
> 
> I am running Ubuntu 9.04 with kernel 2.6.28-15.  I am happy to provide any
> information.   I would happily provide any debugging information if I only
> knew how!   Thanks.

Could you please provide a screenshot (or a short video if the screenshot 
isn't explicit enough) ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 12:57:05 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 12:57:05 +0200
Subject: [Linux-uvc-devel] Multiple camera USB bandwidth calculation
	question
In-Reply-To: <4A971A6B.1050400@irobot.com>
References: <4A835106.30707@irobot.com>
	<200908141116.09009.laurent.pinchart@ideasonboard.com>
	<4A971A6B.1050400@irobot.com>
Message-ID: <200909181257.05438.laurent.pinchart@ideasonboard.com>

On Friday 28 August 2009 01:44:43 Tim Harvey wrote:
> Laurent Pinchart wrote:
> > On Thursday 13 August 2009 01:32:22 Tim Harvey wrote:
> > > I'm looking at using multiple UVC cameras which likely will not support
> > > MJPEG.  I'm curious how to calculate my max framerate for a given
> > > resolution and number of cameras based on a single USB 2.0 bus and thus
> > > am trying to understand the calculation and the architecture of UVC and
> > > the uvcvideo driver.
> > >
> > > I recall reading somewhere (perhaps the uvccapture source) the uvcvideo
> > > driver (or perhaps UVC itself, or perhaps a limitation of uvccapture)
> > > was not able to capture still images from cameras and instead it would
> > > put the camera in streaming mode and grab frames as directed.
> >
> > UVC specifies 3 different methods to support still capture. The most
> > simple one (method 1) is to just take the next frame from a video stream.
> > There's nothing required on the camera side for this, making it a very
> > simple and popular method among camera developers.
> >
> > Two other methods are also possible. One of them (method 2) involves
> > temporarily stopping the video stream, negotiating still image capture
> > parameters, get a still image from the camera through the video stream
> > and then resuming video streaming. The other (method 3) uses a separate
> > bulk endpoint to stream the still image.
> >
> > I've never seen any camera implementing the last method. Method 2 is
> > supported by several webcams, but not by the UVC driver. One main
> > obstacle to getting that supported by the driver is the lack of a still
> > image capture API in v4l2.
> 
> Great explanation - thanks!
> 
> What would the risks be in using method 1 but turning streaming on/off
> on a device that may support a min framerate of 30fps fast enough to
> grab say 1fps and thus conserve USB bus bandwidth?  Is there a rather
> long latency in being able to start/stop streaming from the current UVC
> devices?

It really depends on the device. For instance, on the Logitech Quickcam Pro 
for Notebooks that I use as my primary testing device, turning streaming on 
the first time after plugging the device in takes a few seconds.

> How can I determine what the USB bus utilization is for a specific
> device that I'm testing?  I'm not quite clear if there is anything in
> /proc/bus/usb/devices that can be decrypted to provide this
> information.  I'm up for hacking in some printk's into usbcore if thats
> what it would take.

If you apply the following patch just set the module trace parameter to 1024. 
The driver will print the bandwidth requested by the device (in bytes per 
microframe) when you start video streaming.

http://linuxtv.org/hg/~pinchartl/uvcvideo/rev/4533a406fddb

There are 8000 microframes per second for USB high speed devices, and periodic 
(isochronous+interrupt) transfers are limited to 80% of the overall USB 
bandwidth.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:00:44 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:00:44 +0200
Subject: [Linux-uvc-devel] 18ec:3290 doesnt work (no subject)
In-Reply-To: <193070.97271.qm@web51908.mail.re2.yahoo.com>
References: <193070.97271.qm@web51908.mail.re2.yahoo.com>
Message-ID: <200909181300.44151.laurent.pinchart@ideasonboard.com>

Hi Kieran,

On Saturday 29 August 2009 00:13:30 kieran levin wrote:
> Hi Laurent,
> 
> [snip]
> 
> > If I load the module with quirks=2 I get the following.
> >
> > uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA (18ec:3290)
> > uvcvideo: Forcing device quirks 0x2 by module parameter for testing
> > purpose.
> > uvcvideo: Please report required quirks to the linux-uvc-devel mailing
> > list.
> > uvcvideo: Failed to query (135) UVC control 1 (unit 0) : 0 (exp. 26).
> > input: USB2.0 PC CAMERA as
> > /devices/pci0000:00/0000:00:0b.0/usb2/2-2/2-2.1/2-2.1:1.0/input/input11
> >
> > usbcore: registered new interface driver uvcvideo
> > USB Video Class driver (v0.1.0)
> >
> > Does the camera work then ?
> 
> No the camera doesn't create a video device in /dev/videoX
> 
> I think if ubuntu fails to initialize a device many times it will register
>  the device as a generic input device using HAL, but it will not be
>  usable...

My bad, could you please retry with quirks=512 ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:05:47 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:05:47 +0200
Subject: [Linux-uvc-devel] HP Webcam Suyin 064e:a104
In-Reply-To: <643ea2b10908301629n36a35bf4tbab543885cf7cd08@mail.gmail.com>
References: <643ea2b10908301629n36a35bf4tbab543885cf7cd08@mail.gmail.com>
Message-ID: <200909181305.47301.laurent.pinchart@ideasonboard.com>

Hi,

On Monday 31 August 2009 01:29:25 A. C. Censi wrote:
> Hi
> 
> I have an HP Touchsmart TX2-1020us, with a Suyin camera with USB Id
> 064e:a104. It is supposed to be an 1.3 Mpixel camera, from specs.

Maybe from the specs, but the descriptors report 320x240 at 5fps and 
160x120 at 20fps at most.
 
> It is not working with several programs, luvcview, fswebcam,
> uvccapture. With luvcview, it freezes the program with a borked image;
> even with a Ctrl-C it does not end, must be killed from command line,
> in another terminal. Output of execution is
> 
> luvcview 0.2.4
> 
> SDL information:
>   Video driver: x11
>   A window manager is available
> Device information:
>   Device path:  /dev/video0
> Stream settings:
>   Frame format: YUYV (MJPG is not supported by device)
>   Frame size:   320x240 (requested size 640x480 is not supported by device)
>   Frame rate:   5/1 fps (requested frame rate 30 fps is not supported by
>  device)

Does the driver print any message to the kernel log (dmesg) ?

Thanks for the USB descriptors.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:09:01 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:09:01 +0200
Subject: [Linux-uvc-devel] wait_event_interruptible
In-Reply-To: <E1Mi6Do-00079c-00.iodine-mail-ru@f152.mail.ru>
References: <E1Mi6Do-00079c-00.iodine-mail-ru@f152.mail.ru>
Message-ID: <200909181309.01580.laurent.pinchart@ideasonboard.com>

On Monday 31 August 2009 14:42:56 Iodine wrote:
> Hello!
> 
> I have a usb webcam A4 TECH USB2.0 PC Camera J (0ac8:c40a).

Please send me the output of

lsusb -v -d 0ac8:c40a

> OS: Ubuntu 9.04 kernel 2.6.28-11-generic
> It's work fine, but I want install new version of uvc driver.
> I downloaded
>  http://linuxtv.org/hg/~pinchartl/uvcvideo/archive/4533a406fddb.tar.gz and
>  compiled it.
> When I runinng mjpg-streamer or motion after calls
> 
> ret = ioctl(vd->fd, VIDIOC_DQBUF, &vd->buf);
> 
> uvc driver stops on
> 
> return wait_event_interruptible(buf->wait,
>    buf->state != UVC_BUF_STATE_QUEUED &&
>    buf->state != UVC_BUF_STATE_ACTIVE);
> 
> in function uvc_queue_waiton (uvc_queue.c).
> 
> At first I thought that patched driver is used in ubuntu, but when i
>  downloaded source codes of a kernel I was convinced that in these parts it
>  is invariable.
> 
> Please, help me!

There's nothing wrong as such. This means that the driver doesn't receive 
complete images from the camera. Are you capturing MJPEG or YUYV data ? Does 
the driver print anything to the kernel log ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:10:22 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:10:22 +0200
Subject: [Linux-uvc-devel] 18ec:3290 doesnt work (no subject)
In-Reply-To: <200909181300.44151.laurent.pinchart@ideasonboard.com>
References: <193070.97271.qm@web51908.mail.re2.yahoo.com>
	<200909181300.44151.laurent.pinchart@ideasonboard.com>
Message-ID: <200909181310.22158.laurent.pinchart@ideasonboard.com>

On Friday 18 September 2009 13:00:44 Laurent Pinchart wrote:
> Hi Kieran,
> 
> On Saturday 29 August 2009 00:13:30 kieran levin wrote:
> > Hi Laurent,
> >
> > [snip]
> >
> > > If I load the module with quirks=2 I get the following.
> > >
> > > uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA (18ec:3290)
> > > uvcvideo: Forcing device quirks 0x2 by module parameter for testing
> > > purpose.
> > > uvcvideo: Please report required quirks to the linux-uvc-devel mailing
> > > list.
> > > uvcvideo: Failed to query (135) UVC control 1 (unit 0) : 0 (exp. 26).
> > > input: USB2.0 PC CAMERA as
> > > /devices/pci0000:00/0000:00:0b.0/usb2/2-2/2-2.1/2-2.1:1.0/input/input11
> > >
> > > usbcore: registered new interface driver uvcvideo
> > > USB Video Class driver (v0.1.0)
> > >
> > > Does the camera work then ?
> >
> > No the camera doesn't create a video device in /dev/videoX
> >
> > I think if ubuntu fails to initialize a device many times it will
> > register the device as a generic input device using HAL, but it will not
> > be usable...
> 
> My bad, could you please retry with quirks=512 ?

256, sorry. We'll get there :-) 

-- 
Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:14:50 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:14:50 +0200
Subject: [Linux-uvc-devel] uvc driver under linux 2.4
In-Reply-To: <200909010033.15269.dmit10@gmail.com>
References: <200909010033.15269.dmit10@gmail.com>
Message-ID: <200909181314.50360.laurent.pinchart@ideasonboard.com>

Hi Dmitry,

On Monday 31 August 2009 22:33:15 Dmitry wrote:
> Hi all.
> 
> I tried to port UVC linux driver for using with 2.4 kernel by replacing new
> 2.6 usb functions into their 2.4-analogs. The code is attached.
> 
> Module can be loaded successfully (on my 2.4.32) and it detects v4l2-device
> correctly. But fails in initialization with message (in dmesg)
> 
> uvcvideo: Found UVC 1.00 device <unnamed> (05a9:2640)
> uvcvideo: Failed to query (135) UVC control 1 (unit 0) : 0 (exp. 26).

quirks=256 might help for this.

> uvcvideo: Unable to initialize the status endpoint (-22), status interrupt
> will not be supported.
> 
> -22 (EINVAL) occurs at usb_submit_urb at
> static void uvc_status_complete(struct urb *urb) function
> 
> According to Documentation/usb/URB.txt this can mean "bad interval". I
>  don't know which interval to use. I tried several values from little to
>  large, no effect.

The interval is reported by the camera in the USB descriptors.

> All mmap() calls from any programs fail too (in dmesg). On my OmniVision
> Technologies (05a9:2640) it shows
> 
> uvcvideo: Failed to resubmit video URB (-19).
> 
> With other cameras the messages are different. I suppose this is caused by
>  bad initialization.
> 
> And I have no idea how to cope with it. I'm not specialist in usb
>  programming but I hope you can help me.

2.4 is old. Very old. Way too old. I haven't touched 2.4 for a long time, I 
have no 2.4 kernel running on any of my machines and I don't even have a copy 
of the 2.4 source code. I'm afraid you'll be on your own there. I develop the 
UVC driver in my (limited) spare time for fun, and backporting to old kernels 
is the kind of job Linux developers do for money, not for fun. If you really 
need support you will probably have to buy it.

Sorry.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:21:23 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:21:23 +0200
Subject: [Linux-uvc-devel] uvcvideo: Failed to query (129) UVC control 1
In-Reply-To: <COL115-W21F75762E050FB931BBC549FEF0@phx.gbl>
References: <COL115-W21F75762E050FB931BBC549FEF0@phx.gbl>
Message-ID: <200909181321.23142.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 03 September 2009 06:00:34 Bo Liu wrote:
> Hi, ALL
> 
>       I have this question when use my webcam

What webcam is that ?

> uvcvideo: Failed to query (129) UVC control 1 (unit 0) : -32 (exp. 26).
> uvcvideo: Failed to initialize the device (-5).
> usbcore: registered new interface driver uvcvideo
> USB Video Class driver (v0.1.0) 
>     
>  http://lists.berlios.de/pipermail/linux-uvc-devel/2007-
September/002129.html
>
> This link tell me
> "
> Kernel 2.6.22 includes bug fixes in the usbaudio driver that can trigger
> another firmware bug in the webcam. Fortunately this one seems to have a
> workaround, although not a pretty one.
> "
> 
> But I am using kernel 2.6.23. Still have this bug. Is there any detail
> message about it(eg..the src code) both in the kernel and uvc driver.

Have you tried the workaround explained in the mail thread you mentioned ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:25:55 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:25:55 +0200
Subject: [Linux-uvc-devel] Any progress on ARKMICRO (18ec:3288) ?
In-Reply-To: <jUsT.aNoTheR.mEsSaGe.iD.12521005909032@www.fh-swf.de>
References: <jUsT.aNoTheR.mEsSaGe.iD.12521005909032@www.fh-swf.de>
Message-ID: <200909181325.55376.laurent.pinchart@ideasonboard.com>

Hi Marcel,

On Friday 04 September 2009 23:37:56 Marcel Glacki wrote:
> Hi there,
> 
> I got a very cheap webcam in order to test some CV stuff. But as
> the cam didn't cooperate I started researching why and finally encountered
> this mailing list.
> 
> The first thread I saw was:
> http://lists.berlios.de/pipermail/linux-uvc-devel/2008-December/004410.
> html
> I tried setting quirks=2 as mentioned there et voila I got a beautiful
> picture with VLC and cheese. (Didn't try other programs yet.)

I've submitted a patch to the kernel some time ago, quirks=2 isn't needed with 
2.6.31 anymore.
 
> Now there are some things I don't understand:
> 1. When I do a `cat /dev/video1` while the cam is connected the shell
> tells me: "cat: /dev/video1: No such device"
> If the cam is not connected the shell returns "cat: /dev/video1:
> No such file or directory"

The uvcvideo driver doesn't support the read method. You just can't cat 
/dev/video1.

> 2. I tried some code-snippets from
>  http://www.c-plusplus.de/forum/viewtopic-var-p-is-1626217.html but they
>  all either abort with the "No such device" error when they try to
>  "read(...)" or return a picture with an almost black picture and very few
>  mixed colored pixels at the top.

Same problem, read is simply not supported.

> 3. When starting cheese from shell it frequently says: "libv4l2:
> error converting / decoding frame data: v4l-convert: error parsing
> JPEG header: Not a JPG file ?" but I get a picture.

That's a libv4l2 issue. It could be caused by corrupted JPEG data coming from 
the webcam from time to time, in which case libv4l2 might just give you the 
previous image (to be checked).

> Next thread I saw was:
> http://lists.berlios.de/pipermail/linux-uvc-devel/2009-April/004741.html
> That is the one I'm about to response to. You, Laurent, said you
> need some consecutives frames. When you give me a code-snippet to
> capture some I'll try. (I don't know how to as the snippets mentioned
> above IMHO don't work).

Not a snippet, but you can try the attached application. That's what I use for 
testing.

-- 
Regards,

Laurent Pinchart
-------------- next part --------------
A non-text attachment was scrubbed...
Name: yavta.c
Type: text/x-csrc
Size: 23324 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090918/3638dc08/attachment.c>

From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:27:47 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:27:47 +0200
Subject: [Linux-uvc-devel] 04f2:a216 Chicony Electronics Co., Ltd
In-Reply-To: <4AA37C5A.6020109@xmission.com>
References: <4AA37C5A.6020109@xmission.com>
Message-ID: <200909181327.48062.laurent.pinchart@ideasonboard.com>

Hi Will,

On Sunday 06 September 2009 11:09:46 Will Blaylock wrote:
> I *believe* this is an appropriate camera to be added, may just need to
> kick the user a couple of times and get the correct stuff loaded.
> 
> Bus 001 Device 029: ID 04f2:a216 Chicony Electronics Co., Ltd
> 
> Looking at the camera it states
> Jazz HDV188 HDMI HiD
> 
> In a previous lifetime the following cameras were found by accident to
> be the same Windows driver and both look very similar physically
> (especially when you open them up)
> 
> Vivitar dvr 710
> Vivitar dvr 865hd
> 
> I have no idea if this camera is UVC ready or not.

Do you still have (at least some of) the cameras ? If so, can you send me the 
USB descriptors (using lsusb -v) ?

> My only access to the original drivers is on a virtualbox.
> 
> I am running Ubuntu 9.04 if that makes any difference.
> 
> I am subscribed to the list and will gladly respond with any further
> information I am asked for.
> 
> I am trying to gain access once again to the vivitar 965 to see what it
> IDs as but I STRONGLY suspect it will be the same camera with a few
> cosmetic changes and different name tags
> 
> I have installed nothing but cheese, luvcview, v4l-conf and previously
> had skype, VLC installed.
> 
> All recognize my wifes logitech none recognize mine.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:31:44 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:31:44 +0200
Subject: [Linux-uvc-devel] help needed- UVC driver for PC camera
	controller
In-Reply-To: <BAY109-W33F433A941BD00C5A0C1F4E3EB0@phx.gbl>
References: <BAY109-W33F433A941BD00C5A0C1F4E3EB0@phx.gbl>
Message-ID: <200909181331.44199.laurent.pinchart@ideasonboard.com>

Hi,

On Monday 07 September 2009 11:37:07 SHRISHA PRASAD R wrote:
> Hi,
> 
> We have a digital camera module that has a camera controller on board , its
>  data sheet confirm that we can use UVC linux drivers for platform support.
>  We would like to observe USB communication happening between the PC and
>  the board in which the SN9C230 is present.
> 
> I see that it is supported on the linux UVC  drivers list
> Also I confirmed this from the SN9C230 data sheet.
> 
> I wanted to know how to use UVC driver to access and observe the
> SN9C230 transmitting and receiving.
> 
> Can anyone suggest me ?

If you want to capture raw frames to files, uvccapture 
(http://www.quickcamteam.net/software/linux/v4l2-software/uvccapture) should 
do the job.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 13:40:55 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 13:40:55 +0200
Subject: [Linux-uvc-devel] Help,
	after replug the webcam the dev node changed from video0 to video1
In-Reply-To: <COL115-W1B01B2E86EA248A0455269FE80@phx.gbl>
References: <COL115-W1B01B2E86EA248A0455269FE80@phx.gbl>
Message-ID: <200909181340.55067.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 10 September 2009 09:46:59 Bo Liu wrote:
> Hi, All
> 
>       There is a problem when I use my webcam.
>       First, every thing is ok. I use gstreamer play video from /dev/video0
>       Then, I unpluged my webcam(but didn't stop gstreamer).
> 
>       Replug camera again. dev node is changed to video1. And Gstreamser
>  can't play video any more,because it's still use video0.
> 
>       I think because gstreamer is using the /dev/video0, so when unplug
>  the device,udev can't rmmod dev node /dev/video0. And it must make a new
>  node /dev/video1 after replug.

It's actually not a matter of udev being unable to rmmod /dev/video0, but 
rather udev not noticing that the device goes away. V4L2 unregisters the video 
device only when the last reference to the device is released. That means that 
udev will only notice that the device goes away when gstreamer closes 
/dev/video0.

>       So, My question is is there any way to rm dev node /dev/video0 when
>  unplug the webcam while gstreamer(or maybe mplayer..) still running,

It should be possible to do so with udev rules, but I'm familiar enough with 
them to help you.

>  and after replug webcam gstreamer can continue to work.

It depends what you mean by "can continue to work". gstreamer will not 
magically resume video streaming on the new device. At best you will have to 
manually stop and restart the video stream.

-- 
Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Sep 18 15:27:20 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 18 Sep 2009 15:27:20 +0200
Subject: [Linux-uvc-devel] control string localization
In-Reply-To: <59cf47a80909130632t77042b99u59eb5842a078367d@mail.gmail.com>
References: <59cf47a80909130632t77042b99u59eb5842a078367d@mail.gmail.com>
Message-ID: <200909181527.20687.laurent.pinchart@ideasonboard.com>

Hi Paulo,

On Sunday 13 September 2009 15:32:20 Paulo Assis wrote:
> Hi,
> Currently, uvc driver and I guess all other v4l2 video drivers use
> internal stored control strings.
> This poses a problem when adding localization for this strings, since
> they can change between drivers.
> Even if driver developers are careful enough to return the same string
> for the correspondent control ID, a slight difference: Brightness or
> brightness is enough for a failed translation.
> Since the control ID's are defined in the V4L2 API is there any
> special reason why the correspondent control strings are not.
> I may be failing to see this correctly but at least for me it seems
> much logical that if all standard control IDs are already defined
> there, then also the name string should be made available through this
> central public API, making it exactly the same for all drivers.
> 
> If I'm wrong please feel free to shut me up, and kick me in the but. :-)

You're right, and there's already such a central public API. Have a look at 
v4l2_ctrl_get_name in drivers/media/video/v4l2-common.c.

I'll try to switch the uvcvideo driver to v4l2_ctrl_get_name when I'll find 
some free time.

-- 
Regards,

Laurent Pinchart


From a.grandi at gmail.com  Fri Sep 18 17:18:16 2009
From: a.grandi at gmail.com (Andrea Grandi)
Date: Fri, 18 Sep 2009 17:18:16 +0200
Subject: [Linux-uvc-devel] Acer HD Crystal Eye webcam (064e:a117 Suyin
	Corp.) and Ubuntu 9.04 problems
Message-ID: <9cf0f07b0909180818s6ccf7225hf43e7aa912e492dd@mail.gmail.com>

Hi all,

I've an Acer Aspire 5930G notebook, with this webcam: Acer HD Crystal
Eye webcam (064e:a117 Suyin Corp.)
I'm using Ubuntu 9.04 (32 bit) and I've this problem.

While my webcam is well recognized by the system (I've the /dev/video0
device, I can see my self in Cheese preview, I can see myself in Skype
option panel ecc....), I've problems when I start recording something,
for example:

- when I click on "Record" button of Cheese
- when I start a video call on Skype
- when I try to stream something with Flash plugin on web

all three situations have the same problem: the framerate is very
low... something like 1-2 frame every 5 or 6 seconds.
In Skype people tell me "I see you moving very very slow... I see the
image changing every 5 or 6 seconds..."
This happens in all three situations I talked about before...

This is the complete lsusb -v output: http://pastebin.com/m7e9e94d7

and this is the kern.log output when I try to record on Cheese:
http://pastebin.com/m79c906ae

Any idea how to fix this?

p.s: I've tried this tips I've found in Cheese documentation:

5.1.?The video is sluggish/has a slow response. What can I do?

      You may have set "ximagesink" (X Window System (No Xv)) as video-output.
      This means, that your cpu is doing all the work. Change it to
"xvimagesink"
      (X Window System (X11/XShm/Xv)) in order to let your graphics
card do the work.

      To change the settings, run gstreamer-properties,
      click the Video tab
      and change the appropriate settings.

but it doesn't work anyway....

-- 
Andrea Grandi
email: a.grandi [AT] gmail [DOT] com
website: http://www.andreagrandi.it
PGP Key: http://www.andreagrandi.it/pgp_key.asc


From iodine at mail.ru  Wed Sep 23 15:51:51 2009
From: iodine at mail.ru (Iodine)
Date: Wed, 23 Sep 2009 17:51:51 +0400
Subject: [Linux-uvc-devel] =?koi8-r?b?d2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxl?=
In-Reply-To: <200909181309.01580.laurent.pinchart@ideasonboard.com>
References: <200909181309.01580.laurent.pinchart@ideasonboard.com>
Message-ID: <E1MqSG7-0007Wr-00.iodine-mail-ru@f37.mail.ru>

Hello, Laurent!

> > I have a usb webcam A4 TECH USB2.0 PC Camera J (0ac8:c40a).
> Please send me the output of
> lsusb -v -d 0ac8:c40a

See it in attach.
 
> There's nothing wrong as such. This means that the driver doesn't receive 
> complete images from the camera. 

But why "native" Ubuntu 9.04 uvcvideo driver does receive it and "new" driver doesn't?

> Are you capturing MJPEG or YUYV data ? 

This camera support only MJPEG:
[1] cap.driver: "uvcvideo"
[1] cap.card: "A4 TECH USB2.0 PC Camera J"
[1] cap.bus_info: "usb-0000:00:1f.2-2"
[1] cap.capabilities=0x04000001
[1] - VIDEO_CAPTURE
[1] - STREAMING
[1] Supported palettes:
[1] 0: MJPG (MJPEG)

> Does the driver print anything to the kernel log ?

There is nothing interesting :(

Sep 23 17:26:06 webca kernel: [ 7727.098574] Linux video capture interface: v2.00
Sep 23 17:26:06 webca kernel: [ 7727.365076] uvcvideo: Found UVC 1.00 device A4 TECH USB2.0 PC Camera J (0ac8:c40a)
Sep 23 17:26:06 webca kernel: [ 7727.365255]  (-> XU 4)<7>uvcvideo: Found a valid video chain (1 -> 3).
Sep 23 17:26:06 webca kernel: [ 7727.393845] input: A4 TECH USB2.0 PC Camera J as /devices/pci0000:00/0000:00:1f.2/usb1/1-2/1-2:1.0/input/input11
Sep 23 17:26:06 webca kernel: [ 7727.460330] usbcore: registered new interface driver uvcvideo
Sep 23 17:26:06 webca kernel: [ 7727.460340] USB Video Class driver (v0.1.0)

Laurent, what OS are you using for developing this driver? I can try to install it and test this webcam.

-- 
Best regards, 
iodine
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0ac8_c40a.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090923/b5d9ec27/attachment.txt>

From otartics.a at gmail.com  Wed Sep 23 18:51:59 2009
From: otartics.a at gmail.com (=?UTF-8?B?T3TDoXJ0aWNzIEFuZHLDoXM=?=)
Date: Wed, 23 Sep 2009 18:51:59 +0200
Subject: [Linux-uvc-devel] Logitech E 3500
Message-ID: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>

Dear Everyone,

  will I be able to capture pictures from this cam to jpg format at high
frame rate (pref. 30fps)?

  I am thinking on buying a Logitech e3500 webcam for a supervisory system.
It has already its program so I need the camera driver to be able to save me
frames in jpg format and preferably 30fps.

Thank you in advance.

Best wishes,
Andras

-- 
Ot?rtics Andr?s
Villamosm?rn?k
E-mail: otartics D.O.T a AT gmail D.O.T com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090923/93d4f622/attachment.html>

From pj.assis at gmail.com  Wed Sep 23 23:29:07 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 23 Sep 2009 22:29:07 +0100
Subject: [Linux-uvc-devel] Logitech E 3500
In-Reply-To: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
References: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
Message-ID: <59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>

Hi,
According to logitech:
http://www.quickcamteam.net/devices/logitech_uvc_frame_format_list.pdf

both MJPG and YUYV modes support up to 640x480 at 30fps.

Best regards,
Paulo

2009/9/23 Ot?rtics Andr?s <otartics.a at gmail.com>:
> Dear Everyone,
>
> ? will I be able to capture pictures from this cam to jpg format at high
> frame rate (pref. 30fps)?
>
> ? I am thinking on buying a Logitech e3500 webcam for a supervisory system.
> It has already its program so I need the camera driver to be able to save me
> frames in jpg format and preferably 30fps.
>
> Thank you in advance.
>
> Best wishes,
> Andras
>
> --
> Ot?rtics Andr?s
> Villamosm?rn?k
> E-mail: otartics D.O.T a AT gmail D.O.T com
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>


From laurent.pinchart at ideasonboard.com  Thu Sep 24 08:20:54 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 08:20:54 +0200
Subject: [Linux-uvc-devel] [PATCH] uvc: kmalloc failure ignored in
	uvc_ctrl_add_ctrl()
In-Reply-To: <4AB43041.6050001@gmail.com>
References: <4AB43041.6050001@gmail.com>
Message-ID: <200909240820.54291.laurent.pinchart@ideasonboard.com>

Hi Roel,

thanks for noticing the problem and providing a patch. Some comments inlined.

On Saturday 19 September 2009 03:13:37 Roel Kluin wrote:
> Produce an error if kmalloc() fails.
> 
> Signed-off-by: Roel Kluin <roel.kluin at gmail.com>
> ---
> Found with sed: http://kernelnewbies.org/roelkluin
> 
> Build tested. Please review
> 
> diff --git a/drivers/media/video/uvc/uvc_ctrl.c
>  b/drivers/media/video/uvc/uvc_ctrl.c index c3225a5..dda80b5 100644
> --- a/drivers/media/video/uvc/uvc_ctrl.c
> +++ b/drivers/media/video/uvc/uvc_ctrl.c
> @@ -1189,7 +1189,7 @@ int uvc_ctrl_resume_device(struct uvc_device *dev)
>   * Control and mapping handling
>   */
> 
> -static void uvc_ctrl_add_ctrl(struct uvc_device *dev,
> +static int uvc_ctrl_add_ctrl(struct uvc_device *dev,
>  	struct uvc_control_info *info)
>  {
>  	struct uvc_entity *entity;
> @@ -1214,7 +1214,7 @@ static void uvc_ctrl_add_ctrl(struct uvc_device *dev,
>  	}
> 
>  	if (!found)
> -		return;
> +		return 0;
> 
>  	if (UVC_ENTITY_TYPE(entity) == UVC_VC_EXTENSION_UNIT) {
>  		/* Check if the device control information and length match
> @@ -1231,7 +1231,7 @@ static void uvc_ctrl_add_ctrl(struct uvc_device *dev,
>  				"control " UVC_GUID_FORMAT "/%u (%d).\n",
>  				UVC_GUID_ARGS(info->entity), info->selector,
>  				ret);
> -			return;
> +			return -EINVAL;

uvc_query_ctrl returns an error code on failure, so

return ret;

might be more appropriate.

>  		}
> 
>  		if (info->size != le16_to_cpu(size)) {
> @@ -1239,7 +1239,7 @@ static void uvc_ctrl_add_ctrl(struct uvc_device *dev,
>  				"/%u size doesn't match user supplied "
>  				"value.\n", UVC_GUID_ARGS(info->entity),
>  				info->selector);
> -			return;
> +			return -EINVAL;
>  		}
> 
>  		ret = uvc_query_ctrl(dev, UVC_GET_INFO, ctrl->entity->id,
> @@ -1249,7 +1249,7 @@ static void uvc_ctrl_add_ctrl(struct uvc_device *dev,
>  				"control " UVC_GUID_FORMAT "/%u (%d).\n",
>  				UVC_GUID_ARGS(info->entity), info->selector,
>  				ret);
> -			return;
> +			return -EINVAL;
>  		}

Ditto,

return ret;
 
>  		flags = info->flags;
> @@ -1259,15 +1259,18 @@ static void uvc_ctrl_add_ctrl(struct uvc_device
>  *dev, UVC_GUID_FORMAT "/%u flags don't match "
>  				"supported operations.\n",
>  				UVC_GUID_ARGS(info->entity), info->selector);
> -			return;
> +			return -EINVAL;
>  		}
>  	}
> 
>  	ctrl->info = info;
>  	ctrl->data = kmalloc(ctrl->info->size * UVC_CTRL_NDATA, GFP_KERNEL);
> +	if (ctrl->data == NULL)
> +		return -ENOMEM;

That's not enough to prevent a kernel crash. The driver can try to dereference 
ctrl->data if ctrl->info isn't NULL. You should only set ctrl->info if 
allocationg succeeds. Something like

  	ctrl->data = kmalloc(ctrl->info->size * UVC_CTRL_NDATA, GFP_KERNEL);
	if (ctrl->data == NULL)
		return -ENOMEM;

  	ctrl->info = info;

>  	uvc_trace(UVC_TRACE_CONTROL, "Added control " UVC_GUID_FORMAT "/%u "
>  		"to device %s entity %u\n", UVC_GUID_ARGS(ctrl->info->entity),
>  		ctrl->info->selector, dev->udev->devpath, entity->id);
> +	return 0;
>  }
> 
>  /*
> @@ -1309,8 +1312,11 @@ int uvc_ctrl_add_info(struct uvc_control_info *info)
>  		}
>  	}
> 
> -	list_for_each_entry(dev, &uvc_driver.devices, list)
> -		uvc_ctrl_add_ctrl(dev, info);
> +	list_for_each_entry(dev, &uvc_driver.devices, list) {
> +		ret = uvc_ctrl_add_ctrl(dev, info);
> +		if (ret == -ENOMEM)
> +			goto end;
> +	}

This could lead to a memory leak.

Let's suppose you have two connected devices and try to add a control that 
both devices support. Let's also suppose the call to uvc_ctrl_add_ctrl() 
succeeds for the first device, but fails with -ENOMEM for the second. 
UVCIOC_CTRL_ADD will then return with an error without adding the control 
information to the uvc_driver.controls list.

The userspace application receives an -ENOMEM error an retries the call. 
uvc_ctrl_add_ctrl() will then overwrite ctrl->data with newly kmalloc'ed 
memory, leaking the previously allocated instance.

I'm not sure if we should really bail out here. The current situation is 
clearly not optimal, in the sense that UVCIOC_CTRL_ADD will succeed even if 
allocation fails for some control instances. On the other hand, your patch 
introduces a memory leak, which is not good either.

If we decide to bail out with an error we probably need to free ctrl->data 
memory allocated by the UVCIOC_CTRL_ADD call (and reset ctrl->info to NULL), 
or at least make sure we properly kfree ctrl->data on the next call if it's 
not NULL. We would also need to handle other errors, I don't see why -ENOMEM 
should get a special treatment.

This might be a bit too complex. It would be simpler just to keep on looping 
over devices and adding controls even if an error occurs.

>  	INIT_LIST_HEAD(&info->mappings);
>  	list_add_tail(&info->list, &uvc_driver.controls);
> 

uvc_ctrl_add_ctrl() is also called in uvc_ctrl_init_device(). If we're going 
to handle errors in uvc_ctrl_add_info(), they should be handled in 
uvc_ctrl_init_device() as well.

My opinion is that we should probably not care about uvc_ctrl_add_ctrl() 
errors, but we certainly need to prevent ctrl->info from being modified if 
ctrl->data allocation fails. In that case uvc_ctrl_add_ctrl() can still be a 
void function, all we would need to do would be

-  	ctrl->info = info;
  	ctrl->data = kmalloc(ctrl->info->size * UVC_CTRL_NDATA, GFP_KERNEL);
+	if (ctrl->data == NULL)
+		return -ENOMEM;
+
+  	ctrl->info = info;

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 24 08:34:49 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 08:34:49 +0200
Subject: [Linux-uvc-devel] Logitech E 3500
In-Reply-To: <59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>
References: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
	<59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>
Message-ID: <200909240834.50054.laurent.pinchart@ideasonboard.com>

On Wednesday 23 September 2009 23:29:07 Paulo Assis wrote:
> Hi,
> According to logitech:
> http://www.quickcamteam.net/devices/logitech_uvc_frame_format_list.pdf
> 
> both MJPG and YUYV modes support up to 640x480 at 30fps.

Be careful that the actual frame rate will depend on the exposure settings. 
When using auto-exposure in low-light conditions the frame rate will drop 
pretty dramatically.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 24 08:46:34 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 08:46:34 +0200
Subject: [Linux-uvc-devel] wait_event_interruptible
In-Reply-To: <E1MqSG7-0007Wr-00.iodine-mail-ru@f37.mail.ru>
References: <200909181309.01580.laurent.pinchart@ideasonboard.com>
	<E1MqSG7-0007Wr-00.iodine-mail-ru@f37.mail.ru>
Message-ID: <200909240846.34351.laurent.pinchart@ideasonboard.com>

Hi,

On Wednesday 23 September 2009 15:51:51 Iodine wrote:
> Hello, Laurent!
> 
> > > I have a usb webcam A4 TECH USB2.0 PC Camera J (0ac8:c40a).
> >
> > Please send me the output of
> > lsusb -v -d 0ac8:c40a
> 
> See it in attach.

Thanks.
 
> > There's nothing wrong as such. This means that the driver doesn't receive
> > complete images from the camera.
> 
> But why "native" Ubuntu 9.04 uvcvideo driver does receive it and "new"
>  driver doesn't?

Good question :-)
 
> > Are you capturing MJPEG or YUYV data ?
> 
> This camera support only MJPEG:
> [1] cap.driver: "uvcvideo"
> [1] cap.card: "A4 TECH USB2.0 PC Camera J"
> [1] cap.bus_info: "usb-0000:00:1f.2-2"
> [1] cap.capabilities=0x04000001
> [1] - VIDEO_CAPTURE
> [1] - STREAMING
> [1] Supported palettes:
> [1] 0: MJPG (MJPEG)
> 
> > Does the driver print anything to the kernel log ?
> 
> There is nothing interesting :(

[snip]

> Laurent, what OS are you using for developing this driver? I can try to
>  install it and test this webcam.

I'm using Gentoo, but I don't think your problem is distribution-related.

I've checked the Ubuntu 2.6.28-11-generic kernel and it adds two patches to 
the 2.6.28 uvcvideo driver. One of them sets a quirk for an unrelated webcam, 
and the other one is https://lists.ubuntu.com/archives/kernel-team/2008-
November/003563.html.

Your problem is then probably caused by a regression in the uvcvideo driver 
between 2.6.28 and now. Could you try bisect the problem ? If you're not 
familiar with the concept it will be easier to start by trying vanilla kernels 
2.6.28, 2.6.29, 2.6.30 and 2.6.31, and tell me at which version your webcam 
starts failing (2.6.28 should work).

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 24 08:50:31 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 08:50:31 +0200
Subject: [Linux-uvc-devel] Report new webcam not in the list
In-Reply-To: <1253741781.15278.2.camel@ubuntu.ubuntu-domain>
References: <1253741781.15278.2.camel@ubuntu.ubuntu-domain>
Message-ID: <200909240850.31304.laurent.pinchart@ideasonboard.com>

Hi Octi,

On Wednesday 23 September 2009 23:36:21 Octi wrote:
> Hi there,
> Since the other guy did not reply, I have a similar situation here is my
> lsusb -v -d

Thanks for the information. The previous poster actually sent me the 
information I asked for, but (like you :-)) forgot to CC the list. See inline 
comments.
 
> Bus 001 Device 003: ID 0458:704c KYE Systems Corp. (Mouse Systems)
> Genius i-Look 1321
> Device Descriptor:
>   bLength                18
>   bDescriptorType         1
>   bcdUSB               2.00
>   bDeviceClass            0 (Defined at Interface level)
>   bDeviceSubClass         0
>   bDeviceProtocol         0
>   bMaxPacketSize0        64
>   idVendor           0x0458 KYE Systems Corp. (Mouse Systems)
>   idProduct          0x704c Genius i-Look 1321
>   bcdDevice            1.00
>   iManufacturer           0
>   iProduct                1 USB20 Camera
>   iSerial                 0
>   bNumConfigurations      1

[snip]

>     Interface Descriptor:
>       bLength                 9
>       bDescriptorType         4
>       bInterfaceNumber        0
>       bAlternateSetting       0
>       bNumEndpoints           3
>       bInterfaceClass       255 Vendor Specific Class
>       bInterfaceSubClass    255 Vendor Specific Subclass
>       bInterfaceProtocol    255 Vendor Specific Protocol

That's not a UVC camera, so it will never be supported by the uvcvideo driver. 
You might have more luck with the gspca driver.

-- 
Regards,

Laurent Pinchart


From otartics.a at gmail.com  Thu Sep 24 08:57:10 2009
From: otartics.a at gmail.com (=?UTF-8?B?T3TDoXJ0aWNzIEFuZHLDoXM=?=)
Date: Thu, 24 Sep 2009 08:57:10 +0200
Subject: [Linux-uvc-devel] Logitech E 3500
In-Reply-To: <200909240834.50054.laurent.pinchart@ideasonboard.com>
References: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
	<59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>
	<200909240834.50054.laurent.pinchart@ideasonboard.com>
Message-ID: <1bcdeb1f0909232357i478dbbbfsaad4e9caf8b6dfce@mail.gmail.com>

Hello,

  thank you four your comment.

  Though, my real problem is that I dont know if there is a program that can
save indivdual frames in separate jpg file?

Thank you,
Andras

2009/9/24 Laurent Pinchart <laurent.pinchart at ideasonboard.com>

> On Wednesday 23 September 2009 23:29:07 Paulo Assis wrote:
> > Hi,
> > According to logitech:
> > http://www.quickcamteam.net/devices/logitech_uvc_frame_format_list.pdf
> >
> > both MJPG and YUYV modes support up to 640x480 at 30fps.
>
> Be careful that the actual frame rate will depend on the exposure settings.
> When using auto-exposure in low-light conditions the frame rate will drop
> pretty dramatically.
>
> --
> Regards,
>
> Laurent Pinchart
>



-- 
Ot?rtics Andr?s
Villamosm?rn?k
Telefon: +3630-418-1606
E-mail: otartics.a at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/9fd0813e/attachment.html>

From pj.assis at gmail.com  Thu Sep 24 10:25:16 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Sep 2009 09:25:16 +0100
Subject: [Linux-uvc-devel] Logitech E 3500
In-Reply-To: <1bcdeb1f0909232357i478dbbbfsaad4e9caf8b6dfce@mail.gmail.com>
References: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
	<59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>
	<200909240834.50054.laurent.pinchart@ideasonboard.com>
	<1bcdeb1f0909232357i478dbbbfsaad4e9caf8b6dfce@mail.gmail.com>
Message-ID: <59cf47a80909240125k5cad601dt1f6d30ba7ab230f4@mail.gmail.com>

Hi,
Please try guvcview or cheese, any one of these support frame capture
to jpeg files.
In the case of guvcview you can capture individual frames
automatically every x seconds.
If you need to capture 30 frames per second then individual frames is
not a good idea, it's better to capture a video stream, and convert
the frames to jpeg latter.

Best regards,
Paulo


2009/9/24 Ot?rtics Andr?s <otartics.a at gmail.com>:
> Hello,
>
> ? thank you four your comment.
>
> ? Though, my real problem is that I dont know if there is a program that can
> save indivdual frames in separate jpg file?
>
> Thank you,
> Andras
>
> 2009/9/24 Laurent Pinchart <laurent.pinchart at ideasonboard.com>
>>
>> On Wednesday 23 September 2009 23:29:07 Paulo Assis wrote:
>> > Hi,
>> > According to logitech:
>> > http://www.quickcamteam.net/devices/logitech_uvc_frame_format_list.pdf
>> >
>> > both MJPG and YUYV modes support up to 640x480 at 30fps.
>>
>> Be careful that the actual frame rate will depend on the exposure
>> settings.
>> When using auto-exposure in low-light conditions the frame rate will drop
>> pretty dramatically.
>>
>> --
>> Regards,
>>
>> Laurent Pinchart
>
>
>
> --
> Ot?rtics Andr?s
> Villamosm?rn?k
> Telefon: +3630-418-1606
> E-mail: otartics.a at gmail.com
>


From otartics.a at gmail.com  Thu Sep 24 10:33:19 2009
From: otartics.a at gmail.com (=?UTF-8?B?T3TDoXJ0aWNzIEFuZHLDoXM=?=)
Date: Thu, 24 Sep 2009 10:33:19 +0200
Subject: [Linux-uvc-devel] Logitech E 3500
In-Reply-To: <59cf47a80909240125k5cad601dt1f6d30ba7ab230f4@mail.gmail.com>
References: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
	<59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>
	<200909240834.50054.laurent.pinchart@ideasonboard.com>
	<1bcdeb1f0909232357i478dbbbfsaad4e9caf8b6dfce@mail.gmail.com>
	<59cf47a80909240125k5cad601dt1f6d30ba7ab230f4@mail.gmail.com>
Message-ID: <1bcdeb1f0909240133r4f06faa9uc75d285326ca1ba5@mail.gmail.com>

Hi,

  thank you for your help.
  Actually I would need it as a video at the and, but my problem is that it
is unknown when to start the recording. The recording is triggered by a push
button and at that time we have to save the previous eg 10 minutes and
continue recording to eg 20 minutes. If I start a stream recording than how
will I be able to stay in a 10 minute window?

Thanks.

Andras

2009. szeptember 24. 10:25 Paulo Assis ?rta, <pj.assis at gmail.com>:

> Hi,
> Please try guvcview or cheese, any one of these support frame capture
> to jpeg files.
> In the case of guvcview you can capture individual frames
> automatically every x seconds.
> If you need to capture 30 frames per second then individual frames is
> not a good idea, it's better to capture a video stream, and convert
> the frames to jpeg latter.
>
> Best regards,
> Paulo
>
>
> 2009/9/24 Ot?rtics Andr?s <otartics.a at gmail.com>:
> > Hello,
> >
> >   thank you four your comment.
> >
> >   Though, my real problem is that I dont know if there is a program that
> can
> > save indivdual frames in separate jpg file?
> >
> > Thank you,
> > Andras
> >
> > 2009/9/24 Laurent Pinchart <laurent.pinchart at ideasonboard.com>
> >>
> >> On Wednesday 23 September 2009 23:29:07 Paulo Assis wrote:
> >> > Hi,
> >> > According to logitech:
> >> >
> http://www.quickcamteam.net/devices/logitech_uvc_frame_format_list.pdf
> >> >
> >> > both MJPG and YUYV modes support up to 640x480 at 30fps.
> >>
> >> Be careful that the actual frame rate will depend on the exposure
> >> settings.
> >> When using auto-exposure in low-light conditions the frame rate will
> drop
> >> pretty dramatically.
> >>
> >> --
> >> Regards,
> >>
> >> Laurent Pinchart
> >
> >
> >
> > --
> > Ot?rtics Andr?s
> > Villamosm?rn?k
> > Telefon: +3630-418-1606
> > E-mail: otartics.a at gmail.com
> >
>



-- 
Ot?rtics Andr?s
Villamosm?rn?k
Telefon: +3630-418-1606
E-mail: otartics.a at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/5c4681aa/attachment.html>

From jjchico at gmail.com  Thu Sep 24 10:42:06 2009
From: jjchico at gmail.com (Jorge Juan)
Date: Thu, 24 Sep 2009 10:42:06 +0200
Subject: [Linux-uvc-devel] Bison webcam (5986:0203) error "cannot reset por"
	with 2.6.31 kernel
In-Reply-To: <648098c10909240138r722ddd51xbe4e90773e516a4b@mail.gmail.com>
References: <648098c10909240138r722ddd51xbe4e90773e516a4b@mail.gmail.com>
Message-ID: <648098c10909240142o2ef58caara2f1a8a59a278e08@mail.gmail.com>

Hi!

I am an Ubuntu user running the developing version (karmic, kernel
2.6.31) on a MSI Wind netbook. I am getting this in dmesg most of the
time I boot:

...
[ ?127.156016] ehci_hcd 0000:00:1d.7: force halt; handhake f8046424
00004000 00000000 -> -110
[ ?127.724247] hub 1-0:1.0: cannot reset port 6 (err = -108)
[ ?127.724262] hub 1-0:1.0: cannot reset port 6 (err = -108)
[ ?127.724273] hub 1-0:1.0: cannot reset port 6 (err = -108)
[ ?127.724283] hub 1-0:1.0: cannot reset port 6 (err = -108)
[ ?127.724292] hub 1-0:1.0: cannot reset port 6 (err = -108)
[ ?127.724300] hub 1-0:1.0: Cannot enable port 6. ?Maybe the USB cable is bad?
...

and USB mass storage does not work. Also I get this one when trying to suspend:

...
[ ?185.881554] PM: Entering mem sleep
[ ?185.881575] Suspending console(s) (use no_console_suspend to debug)
[ ?185.900175] uvcvideo: Failed to set UVC commit control : -108 (exp. 26).
[ ?185.900190] uvcvideo 1-5:1.1: resume error -5
[ ?185.900213] pm_op(): usb_dev_suspend+0x0/0x10 returns -108
[ ?185.900223] PM: Device 1-5 failed to suspend: error -108
[ ?185.900231] PM: Some devices failed to suspend
...

Disabling the uvcvideo module (blacklisted) solves the problem
(scarifying webcam functionality).

The stable ubuntu (jaunty) with kernel 2.6.28 works well. You can find
a more detailed report at Ubuntu's bug tracking system:

http://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352

I know I should try the last uvcvideo driver but, do you know if it is
a known regression in the driver? Is it solved in the current
development version?

Thanks for your great work.

jorge.
--
Jorge Juan


From pj.assis at gmail.com  Thu Sep 24 10:50:39 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Sep 2009 09:50:39 +0100
Subject: [Linux-uvc-devel] [PATCH] uvc: kmalloc failure ignored in
	uvc_ctrl_add_ctrl()
In-Reply-To: <200909240820.54291.laurent.pinchart@ideasonboard.com>
References: <4AB43041.6050001@gmail.com>
	<200909240820.54291.laurent.pinchart@ideasonboard.com>
Message-ID: <59cf47a80909240150w3127ed51j48f81e157b49dc0c@mail.gmail.com>

Laurent,


> That's not enough to prevent a kernel crash. The driver can try to dereference
> ctrl->data if ctrl->info isn't NULL. You should only set ctrl->info if
> allocationg succeeds. Something like
>
> ? ? ? ?ctrl->data = kmalloc(ctrl->info->size * UVC_CTRL_NDATA, GFP_KERNEL);
> ? ? ? ?if (ctrl->data == NULL)
> ? ? ? ? ? ? ? ?return -ENOMEM;
>
> ? ? ? ?ctrl->info = info;

Without reading any code this doesn't seem correct, how can you use
ctrl->info->size if you haven't set ctrl->info yet?

Did you mean something like this:

 ctrl->data = kmalloc(info->size * UVC_CTRL_NDATA, GFP_KERNEL);
 if (ctrl->data == NULL)
         return -ENOMEM;

 ctrl->info = info;


Like I said I haven't read the code but this looks better.

Best regards,
Paulo


From pj.assis at gmail.com  Thu Sep 24 11:08:10 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Sep 2009 10:08:10 +0100
Subject: [Linux-uvc-devel] Logitech E 3500
In-Reply-To: <1bcdeb1f0909240133r4f06faa9uc75d285326ca1ba5@mail.gmail.com>
References: <1bcdeb1f0909230951q1492f77fk4687d5891a3c973e@mail.gmail.com>
	<59cf47a80909231429p6f8146b6ic4399aef33584871@mail.gmail.com>
	<200909240834.50054.laurent.pinchart@ideasonboard.com>
	<1bcdeb1f0909232357i478dbbbfsaad4e9caf8b6dfce@mail.gmail.com>
	<59cf47a80909240125k5cad601dt1f6d30ba7ab230f4@mail.gmail.com>
	<1bcdeb1f0909240133r4f06faa9uc75d285326ca1ba5@mail.gmail.com>
Message-ID: <59cf47a80909240208o11a11664rcd76b701508727b3@mail.gmail.com>

Hi,


2009/9/24 Ot?rtics Andr?s <otartics.a at gmail.com>:
> Hi,
>
> ? thank you for your help.
> ? Actually I would need it as a video at the and, but my problem is that it
> is unknown when to start the recording. The recording is triggered by a push
> button and at that time we have to save the previous eg 10 minutes and
> continue recording to eg 20 minutes. If I start a stream recording than how
> will I be able to stay in a 10 minute window?
>

You can only record from the the point were you actually start
capturing, I know this looks like a pretty dumb answer ;)

I don't know any software that can guess when to start capturing, or
that can (while capturing) clean anything prior to that 10 min window.

timed capture is easy with guvcview :

guvcview --video=FILENAME --vid_time=1200 --exit_on_close

this will capture 20m = 1200s of video to FILENAME and exit.

For the behaviour you are asking for maybe you need to develop
something yourself,
or for the easy way just push that button 10m earlier ;-)

Best regards,
Paulo


From bo-liu at hotmail.com  Thu Sep 24 11:14:35 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Thu, 24 Sep 2009 17:14:35 +0800
Subject: [Linux-uvc-devel] Why can't set format after VIDIOC_STREAMINGOFF ?
Message-ID: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>


Hi, All
 
     I have a question about VIDIOC_S_FMT?
 
     Gstreamer will ioctl(VIDIOC_STREAMINGOFF?? then ioctl(VIDIOC_S_FMT), then ioctl(VIDIOC_STREAMINGON)
 
     The newest's code have these patch:
 
diff --git a/drivers/media/video/uvc/uvc_v4l2.c b/drivers/media/video/uvc/uvc_v4l2.c
index 507542d..f8b94d6 100644 (file)
--- a/drivers/media/video/uvc/uvc_v4l2.c
+++ b/drivers/media/video/uvc/uvc_v4l2.c
@@ -251,7 +251,7 @@ static int uvc_v4l2_set_format(struct uvc_video_device *video,
        if (fmt->type != video->streaming->type)
                return -EINVAL;
 
-       if (uvc_queue_streaming(&video->queue))
+       if (uvc_queue_allocated(&video->queue))
                return -EBUSY;
 
        ret = uvc_v4l2_try_format(video, fmt, &probe, &format, &frame);
 

 
      And, I found after this patch ioctl(VIDIOC_S_FMT) will failed at uvc_queue_allocated(it won't failed at uvc_queue_streaming).
 
      So, Now Can Gstreamer set the format(use ioctl(VIDIOC_STREAMINGOFF?? then ioctl(VIDIOC_S_FMT), then ioctl(VIDIOC_STREAMINGON)) after open the device(doesn't close) ? 
      If not, How to implement this?
 
Thanks a lot!

---

Best regards
Bo Liu 		 	   		  
_________________________________________________________________
Invite your mail contacts to join your friends list with Windows Live Spaces. It's easy!
http://spaces.live.com/spacesapi.aspx?wx_action=create&wx_url=/friends.aspx&mkt=en-us


From pj.assis at gmail.com  Thu Sep 24 11:23:27 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Sep 2009 10:23:27 +0100
Subject: [Linux-uvc-devel] Bison webcam (5986:0203) error "cannot reset
	por" with 2.6.31 kernel
In-Reply-To: <648098c10909240142o2ef58caara2f1a8a59a278e08@mail.gmail.com>
References: <648098c10909240138r722ddd51xbe4e90773e516a4b@mail.gmail.com>
	<648098c10909240142o2ef58caara2f1a8a59a278e08@mail.gmail.com>
Message-ID: <59cf47a80909240223m63880f2dq60d134046048da97@mail.gmail.com>

Juan,
I'm also using karmic, and all my uvc cameras work just fine with the
latest kernel (2.6.31-10)

Could this be related to your usb hub ?
Have you tried booting with the camera disconnected and plugging it
after booting (hot plug)
Do you see similar the errors in this case?

Karmic upstart/initscripts have been causing some problems, I had the
boot process broken at least two times now. Udev also has had is share
of problems, the latest updates have fixed most of these issues, but
please remember that karmic is still under heavy development and is
far from stable.

Best regards,
Paulo

2009/9/24 Jorge Juan <jjchico at gmail.com>:
> Hi!
>
> I am an Ubuntu user running the developing version (karmic, kernel
> 2.6.31) on a MSI Wind netbook. I am getting this in dmesg most of the
> time I boot:
>
> ...
> [ ?127.156016] ehci_hcd 0000:00:1d.7: force halt; handhake f8046424
> 00004000 00000000 -> -110
> [ ?127.724247] hub 1-0:1.0: cannot reset port 6 (err = -108)
> [ ?127.724262] hub 1-0:1.0: cannot reset port 6 (err = -108)
> [ ?127.724273] hub 1-0:1.0: cannot reset port 6 (err = -108)
> [ ?127.724283] hub 1-0:1.0: cannot reset port 6 (err = -108)
> [ ?127.724292] hub 1-0:1.0: cannot reset port 6 (err = -108)
> [ ?127.724300] hub 1-0:1.0: Cannot enable port 6. ?Maybe the USB cable is bad?
> ...
>
> and USB mass storage does not work. Also I get this one when trying to suspend:
>
> ...
> [ ?185.881554] PM: Entering mem sleep
> [ ?185.881575] Suspending console(s) (use no_console_suspend to debug)
> [ ?185.900175] uvcvideo: Failed to set UVC commit control : -108 (exp. 26).
> [ ?185.900190] uvcvideo 1-5:1.1: resume error -5
> [ ?185.900213] pm_op(): usb_dev_suspend+0x0/0x10 returns -108
> [ ?185.900223] PM: Device 1-5 failed to suspend: error -108
> [ ?185.900231] PM: Some devices failed to suspend
> ...
>
> Disabling the uvcvideo module (blacklisted) solves the problem
> (scarifying webcam functionality).
>
> The stable ubuntu (jaunty) with kernel 2.6.28 works well. You can find
> a more detailed report at Ubuntu's bug tracking system:
>
> http://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352
>
> I know I should try the last uvcvideo driver but, do you know if it is
> a known regression in the driver? Is it solved in the current
> development version?
>
> Thanks for your great work.
>
> jorge.
> --
> Jorge Juan
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From laurent.pinchart at ideasonboard.com  Thu Sep 24 22:44:18 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 22:44:18 +0200
Subject: [Linux-uvc-devel] Always polling atfer unplug the usb webcam,
	BUG ?
In-Reply-To: <COL115-W1C67269FD9E10DBE108679FE30@phx.gbl>
References: <COL115-W1C67269FD9E10DBE108679FE30@phx.gbl>
Message-ID: <200909242244.18382.laurent.pinchart@ideasonboard.com>

Hi,

On Tuesday 15 September 2009 10:01:03 Bo Liu wrote:
> Hi,
> 
> I found a problem when using my webcam. First, it's ok, but after I unplug
> it. Systerm call poll() will not return.
> 
> I looked at the src code, and found that uvc_queue_poll() always return 0,
> it didn't know the webcam have unpluged at that time.
> 
> And I saw in funtion uvc_video_complete(), if urb->status is
> -ESHUTDOWN,uvc_queue_cancel(queue, urb->status == -ESHUTDOWN); will be
> called.

That's right, and then uvc_queue_poll() should return POLLERR, making poll() 
return.

> But, if just when in uvc_video_complete()> usb_submit_urb() , the webcam is
> unpluged, the usb_submit_urb() will failed, but just with a printk. Won't
> call uvc_queue_cancel(). So, uvc_queue_poll() will always return 0.  And, I
> add uvc_queue_cancel() after usb_submit_urb()  failed,erverything is ok.
> 
> Is this a bug ?

This is weird. The uvcvideo driver submits several URBs, so even if the device 
is disconnected during the completion handler, the next URBs should get a -
ESHUTDOWN status (at least with EHCI USB controllers).

Are you using the latest driver ? What status do you get when the completion 
handler is called for the next URB after usb_submit_urb() returns -ESHUTDOWN ? 
What USB controller are you using ?

> Funtions uvc_video_complete():
> 
> 716     if ((ret = usb_submit_urb(urb, GFP_ATOMIC)) < 0) {
> 717             uvc_printk(KERN_ERR, "Failed to resubmit video URB (%d).\n",
> 718                        ret);
> 719     }

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 24 22:57:26 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 22:57:26 +0200
Subject: [Linux-uvc-devel] Why can't set format after
	VIDIOC_STREAMINGOFF ?
In-Reply-To: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>
References: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>
Message-ID: <200909242257.26990.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 24 September 2009 11:14:35 Bo Liu wrote:
> Hi, All
> 
>      I have a question about VIDIOC_S_FMT?
> 
>      Gstreamer will ioctl(VIDIOC_STREAMINGOFF?? then ioctl(VIDIOC_S_FMT),
>  then ioctl(VIDIOC_STREAMINGON)
> 
>      The newest's code have these patch:
> 
> diff --git a/drivers/media/video/uvc/uvc_v4l2.c
>  b/drivers/media/video/uvc/uvc_v4l2.c index 507542d..f8b94d6 100644 (file)
> --- a/drivers/media/video/uvc/uvc_v4l2.c
> +++ b/drivers/media/video/uvc/uvc_v4l2.c
> @@ -251,7 +251,7 @@ static int uvc_v4l2_set_format(struct uvc_video_device
>  *video, if (fmt->type != video->streaming->type)
>                 return -EINVAL;
> 
> -       if (uvc_queue_streaming(&video->queue))
> +       if (uvc_queue_allocated(&video->queue))
>                 return -EBUSY;
> 
>         ret = uvc_v4l2_try_format(video, fmt, &probe, &format, &frame);
> 
> 
> 
>       And, I found after this patch ioctl(VIDIOC_S_FMT) will failed at
>  uvc_queue_allocated(it won't failed at uvc_queue_streaming).
> 
>       So, Now Can Gstreamer set the format(use ioctl(VIDIOC_STREAMINGOFF??
>  then ioctl(VIDIOC_S_FMT), then ioctl(VIDIOC_STREAMINGON)) after open the
>  device(doesn't close) ? If not, How to implement this?

You can't change the format while buffers are allocated. You need to free the 
buffers before, using VIDIOC_REQBUFS with a buffer count of 0.

-- 
Regards,

Laurent Pinchart


From mjtrac at gmail.com  Thu Sep 24 22:49:47 2009
From: mjtrac at gmail.com (Mitch Trachtenberg)
Date: Thu, 24 Sep 2009 13:49:47 -0700
Subject: [Linux-uvc-devel] hp elite 6x607aa / ubuntu
Message-ID: <6c52fee0909241349n5e155475w44f4c54fa8b472e7@mail.gmail.com>

Hi,

I'm running Ubuntu with 2.6.28-15.49 generic on a Mac Mini, and having
problems with a new HP Elite Autofocus webcam GX607AA.

The device shows up in dmesg output, and appears to be recognized by
luvcview, but give me a black screen.  When I try to quit luvcview, it
hangs.  When I run camstream I also get the camera recognized but
blackscreen; when I try to exit, I get a message that it's waiting for the
capture thread to terminate.  kill -9 to both.  I'm using the Ubuntu
uvccapture 0.5-1 and luvcview 1:0.2.4-2 packages.  luvcview -L does show
that whatever it's talking to is willing to send at up to about 3MP.

Any suggestions?  (The shutter is open. :)) I'm providing output below and
would be happy to send anything additional that might be of use.

Thanks for any help you can provide.

Mitch Trachtenberg

 Linux version 2.6.28-15-generic (buildd at palmer) (gcc version 4.3.3 (Ubuntu
4.3.3-5ubuntu4) ) #49-Ubuntu SMP Tue Aug 18 18:40:08 UTC 2009 (Ubuntu
2.6.28-15.49-generic)

[    3.864065] usb 3-1: new low speed USB device using uhci_hcd and address
2
[    4.041863] usb 3-1: configuration #1 chosen from 1 choice
[    4.268217] ieee1394: Host added: ID:BUS[0-00:1023]
GUID[002332fffe16fc52]
[    4.304056] usb 5-1: new full speed USB device using uhci_hcd and address
2
[    4.483417] usb 5-1: configuration #1 chosen from 1 choice
[    4.724060] usb 5-2: new full speed USB device using uhci_hcd and address
3
[    4.903439] usb 5-2: configuration #1 chosen from 1 choice
[   13.638715] udev: starting version 141
[   14.458171] input: PC Speaker as /devices/platform/pcspkr/input/input3
[   14.529103] usbcore: registered new interface driver hiddev
[   14.550361] input: M02 1.6 as
/devices/pci0000:00/0000:00:1d.1/usb3/3-1/3-1:1
.0/input/input4
[   14.553197] generic-usb 0003:10D5:0116.0001: input,hidraw0: USB HID v1.10
Key
:board [M02 1.6] on usb-0000:00:1d.1-1/input0
[   14.583651] input: M02 1.6 as
/devices/pci0000:00/0000:00:1d.1/usb3/3-1/3-1:1.1/input/input5
[   14.588130] generic-usb 0003:10D5:0116.0002: input,hidraw1: USB HID v1.10
Mouse [M02 1.6] on usb-0000:00:1d.1-1/input1
[   14.588151] usbhid 5-1:1.0: couldn't find an input interrupt endpoint
[   14.593918] generic-usb 0003:05AC:8240.0003: hiddev96,hidraw2: USB HID
v1.11 Device [Apple Computer, Inc. IR Receiver] on usb-0000:00:1d.3-2/input0
[   14.593939] usbcore: registered new interface driver usbhid
[   14.594056] usbhid: v2.6:USB HID core driver
[   14.595967] usblp0: USB Bidirectional printer dev 4 if 0 alt 0 proto 2
vid 0x0924 pid 0x3D59
[   14.595990] usbcore: registered new interface driver usblp
[   14.689784] Linux video capture interface: v2.00
[   14.861113] cfg80211: Calling CRDA to update world regulatory domain
[   15.337193] cfg80211: World regulatory domain updated:
[   15.337197]  (start_freq - end_freq @ bandwidth), (max_antenna_gain,
max_eirp)
[   15.337200]  (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   15.337202]  (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[   15.337205]  (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[   15.337207]  (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   15.337210]  (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   15.342070] Linux agpgart interface v0.103
[   15.372751] agpgart-intel 0000:00:00.0: Intel 945GM Chipset
[   15.373502] agpgart-intel 0000:00:00.0: detected 16124K stolen memory
[   15.376598] agpgart-intel 0000:00:00.0: AGP aperture is 256M @ 0x40000000
[   15.385289] intel_rng: FWH not detected
[   15.462139] usbcore: registered new interface driver appleir
[   15.462144] appleir: v1.1:USB Apple MacMini IR Receiver driver
[   15.670800] input: Video Bus as
/devices/LNXSYSTM:00/device:00/PNP0A08:00/device:01/input/input6
[   15.676163] ACPI: Video Device [GFX0] (multi-head: yes  rom: no  post:
no)
*[   15.757088] uvcvideo: Found UVC 1.00 device HP 3-MegaPixel Webcam
GX607AA (0ac8:c315)
[   15.760131] input: HP 3-MegaPixel Webcam GX607AA as
/devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input7
[   15.764296] usbcore: registered new interface driver uvcvideo
[   15.764301] USB Video Class driver (v0.1.0)
*[   15.777153] applesmc: Apple Macmini detected:



$ luvcview -l
luvcview 0.2.4

SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
Stream settings:
  Frame format: MJPG
  Frame size:   640x480
  Frame rate:   30 fps
Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean 3=Menu
4=Button)
V4L2_CID_BASE         (predefined controls):
 index:9963776    name:Brightness                       type:1 min:-16
max:16    step:1     def:0     now:5
 index:9963777    name:Contrast                         type:1 min:1
max:32    step:1     def:16    now:21
 index:9963778    name:Saturation                       type:1 min:0
max:15    step:1     def:5     now:10
 index:9963779    name:Hue                              type:1 min:-45
max:45    step:1     def:0     now:14
 index:9963788    name:White Balance Temperature, Auto  type:2 min:0
max:1     step:1     def:1     now:1
 index:9963792    name:Gamma                            type:1 min:100
max:200   step:10    def:170   now:150
 index:9963795    name:Gain                             type:1 min:64
max:160   step:1     def:96    now:96
V4L2_CID_PRIVATE_BASE (driver specific controls):

^C
Quit signal received.
^C
(kill -9)

mitch at mitch-desktop:~$ luvcview -L
luvcview 0.2.4

SDL information:
  Video driver: x11
  A window manager is available
Device information:
  Device path:  /dev/video0
/dev/video0 does not support read i/o
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 1024, height = 768 }
    Time interval between frame: 2/15,
{ discrete: width = 1280, height = 1024 }
    Time interval between frame: 1/5,
{ discrete: width = 1600, height = 1200 }
    Time interval between frame: 1/5,
{ discrete: width = 2048, height = 1536 }
    Time interval between frame: 1/3,
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 640, height = 480 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 352, height = 288 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 320, height = 240 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 176, height = 144 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 160, height = 120 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 1024, height = 768 }
    Time interval between frame: 1/30, 1/15, 2/15,
{ discrete: width = 1280, height = 1024 }
    Time interval between frame: 1/15, 2/15,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/10898cb1/attachment.html>

From laurent.pinchart at ideasonboard.com  Thu Sep 24 23:01:01 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 23:01:01 +0200
Subject: [Linux-uvc-devel] Acer HD Crystal Eye webcam (064e:a117 Suyin
	Corp.) and Ubuntu 9.04 problems
In-Reply-To: <9cf0f07b0909180818s6ccf7225hf43e7aa912e492dd@mail.gmail.com>
References: <9cf0f07b0909180818s6ccf7225hf43e7aa912e492dd@mail.gmail.com>
Message-ID: <200909242301.01740.laurent.pinchart@ideasonboard.com>

Hi Andrea,

On Friday 18 September 2009 17:18:16 Andrea Grandi wrote:
> Hi all,
> 
> I've an Acer Aspire 5930G notebook, with this webcam: Acer HD Crystal
> Eye webcam (064e:a117 Suyin Corp.)
> I'm using Ubuntu 9.04 (32 bit) and I've this problem.
> 
> While my webcam is well recognized by the system (I've the /dev/video0
> device, I can see my self in Cheese preview, I can see myself in Skype
> option panel ecc....), I've problems when I start recording something,
> for example:
> 
> - when I click on "Record" button of Cheese
> - when I start a video call on Skype
> - when I try to stream something with Flash plugin on web
> 
> all three situations have the same problem: the framerate is very
> low... something like 1-2 frame every 5 or 6 seconds.
> In Skype people tell me "I see you moving very very slow... I see the
> image changing every 5 or 6 seconds..."
> This happens in all three situations I talked about before...
> 
> This is the complete lsusb -v output: http://pastebin.com/m7e9e94d7
> 
> and this is the kern.log output when I try to record on Cheese:
> http://pastebin.com/m79c906ae

Your log is truncated. Can you set the trace parameter to 127 and capture the 
kernel log again ?
 
> Any idea how to fix this?
> 
> p.s: I've tried this tips I've found in Cheese documentation:
> 
> 5.1.?The video is sluggish/has a slow response. What can I do?
> 
>       You may have set "ximagesink" (X Window System (No Xv)) as
>  video-output. This means, that your cpu is doing all the work. Change it
>  to "xvimagesink"
>       (X Window System (X11/XShm/Xv)) in order to let your graphics
> card do the work.
> 
>       To change the settings, run gstreamer-properties,
>       click the Video tab
>       and change the appropriate settings.
> 
> but it doesn't work anyway....

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 24 23:04:26 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 23:04:26 +0200
Subject: [Linux-uvc-devel] 093a:2700 camera not work
In-Reply-To: <afbba5040908251931w10467e89wc36aea19d4263ff4@mail.gmail.com>
References: <afbba5040908152121k9ca6ddbj68ac4950cf1f8427@mail.gmail.com>
	<59cf47a80908201035mbdfe024s4345cad0487af787@mail.gmail.com>
	<afbba5040908251931w10467e89wc36aea19d4263ff4@mail.gmail.com>
Message-ID: <200909242304.26563.laurent.pinchart@ideasonboard.com>

Hi,

On Wednesday 26 August 2009 04:31:51 laiyujun wrote:
> Hi,
> Thanks Laurent and Paulo.
> Sorry for my poor english.
> 
> It seems I made mistaken somewhere.
> My camera plug in a command-line only Debian server, so, luvcview
> isn't the corect choise, because it requires X environment.
> 
> So I try to streamer:
> somebody @ debian: ~ $ streamer-c / dev/video0-b 16-o test.jpeg
> files / video: JPEG (JFIF) / audio: none
> no way to get: 320x240 JPEG (JFIF)
> movie writer initialisation failed

streamer tries to capture MJPEG and your camera only supports YUV, so that 
fails.
 
> Then I try to camE:
> somebody @ debian: ~ $ sudo camE
> somebody @ debian: ~ $ can't load font FreeSans/10
> can't load font FreeSans/10
> can't load offline image / home / laiyujun / .block.jpg, ignoring
> setting cam pic: Invalid argument
> No supported palette found, please report your device to the author

camE uses the deprecated V4L1 API, and the uvcvideo driver only supports V4L2, 
so that fails.
 
> And then I try webcam:
> somebody @ debian: ~ $ sudo webcam
> reading config file: / home / somebody / .webcamrc
> can't get rgb24 data

webcam tries to capture RGB24 and your camera only supports YUV, so that 
fails.

> It must be a basic problem somewhere which I haven't resolved. All my
> try above are wasting time.
> Where the problem lies? I don't know which direction will I go.

You're just using the wrong applications :-)

-- 
Regards,

Laurent Pinchart


From a.grandi at gmail.com  Thu Sep 24 23:03:17 2009
From: a.grandi at gmail.com (Andrea Grandi)
Date: Thu, 24 Sep 2009 23:03:17 +0200
Subject: [Linux-uvc-devel] Acer HD Crystal Eye webcam (064e:a117 Suyin
	Corp.) and Ubuntu 9.04 problems
In-Reply-To: <200909242301.01740.laurent.pinchart@ideasonboard.com>
References: <9cf0f07b0909180818s6ccf7225hf43e7aa912e492dd@mail.gmail.com>
	<200909242301.01740.laurent.pinchart@ideasonboard.com>
Message-ID: <9cf0f07b0909241403s302cacb7s78e84032e71e232b@mail.gmail.com>

Hi,

2009/9/24 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> Hi Andrea,
> Your log is truncated. Can you set the trace parameter to 127 and capture the
> kernel log again ?

sorry, this was the right link: http://pastebin.com/m18f4f623

I hope this is ok.

Thanks!

-- 
Andrea Grandi
email: a.grandi [AT] gmail [DOT] com
website: http://www.andreagrandi.it
PGP Key: http://www.andreagrandi.it/pgp_key.asc


From laurent.pinchart at ideasonboard.com  Thu Sep 24 23:06:34 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 23:06:34 +0200
Subject: [Linux-uvc-devel] [PATCH] uvc: kmalloc failure ignored in
	uvc_ctrl_add_ctrl()
In-Reply-To: <59cf47a80909240150w3127ed51j48f81e157b49dc0c@mail.gmail.com>
References: <4AB43041.6050001@gmail.com>
	<200909240820.54291.laurent.pinchart@ideasonboard.com>
	<59cf47a80909240150w3127ed51j48f81e157b49dc0c@mail.gmail.com>
Message-ID: <200909242306.34733.laurent.pinchart@ideasonboard.com>

On Thursday 24 September 2009 10:50:39 Paulo Assis wrote:
> Laurent,
> 
> > That's not enough to prevent a kernel crash. The driver can try to
> > dereference ctrl->data if ctrl->info isn't NULL. You should only set
> > ctrl->info if allocationg succeeds. Something like
> >
> >        ctrl->data = kmalloc(ctrl->info->size * UVC_CTRL_NDATA,
> > GFP_KERNEL); if (ctrl->data == NULL)
> >                return -ENOMEM;
> >
> >        ctrl->info = info;
> 
> Without reading any code this doesn't seem correct, how can you use
> ctrl->info->size if you haven't set ctrl->info yet?
> 
> Did you mean something like this:
> 
>  ctrl->data = kmalloc(info->size * UVC_CTRL_NDATA, GFP_KERNEL);
>  if (ctrl->data == NULL)
>          return -ENOMEM;
> 
>  ctrl->info = info;
> 
> 
> Like I said I haven't read the code but this looks better.

Oops, you're right. My bad. Thanks for catching this.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Sep 24 23:10:46 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 23:10:46 +0200
Subject: [Linux-uvc-devel] hp elite 6x607aa / ubuntu
In-Reply-To: <6c52fee0909241349n5e155475w44f4c54fa8b472e7@mail.gmail.com>
References: <6c52fee0909241349n5e155475w44f4c54fa8b472e7@mail.gmail.com>
Message-ID: <200909242310.46889.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 24 September 2009 22:49:47 Mitch Trachtenberg wrote:
> Hi,
> 
> I'm running Ubuntu with 2.6.28-15.49 generic on a Mac Mini, and having
> problems with a new HP Elite Autofocus webcam GX607AA.

Could you send me the lsusb -v output for your device ? Thanks.
 
> The device shows up in dmesg output, and appears to be recognized by
> luvcview, but give me a black screen.  When I try to quit luvcview, it
> hangs.  When I run camstream I also get the camera recognized but
> blackscreen; when I try to exit, I get a message that it's waiting for the
> capture thread to terminate.  kill -9 to both.  I'm using the Ubuntu
> uvccapture 0.5-1 and luvcview 1:0.2.4-2 packages.  luvcview -L does show
> that whatever it's talking to is willing to send at up to about 3MP.
> 
> Any suggestions?  (The shutter is open. :)) I'm providing output below and
> would be happy to send anything additional that might be of use.

It sounds like the uvcvideo driver doesn't get enough data from the webcam. 
Could you set the trace parameter to 255, start luvcview and send me the 
content of the kernel log ? The driver will get pretty verbose, so you should 
kill luvcview within a few seconds otherwise the kernel log will likely 
overflow (please paste the content of the log to pastebin.com, it would be a 
bit too big for the list). If the log overflows, get it from /var/log/whatever 
instead of dmesg.

-- 
Regards,

Laurent Pinchart


From mjtrac at gmail.com  Thu Sep 24 23:10:04 2009
From: mjtrac at gmail.com (Mitch Trachtenberg)
Date: Thu, 24 Sep 2009 14:10:04 -0700
Subject: [Linux-uvc-devel] HP elite GX607AA, lsusb -v output
Message-ID: <6c52fee0909241410w3f68d946x9d0e0df1e82b625b@mail.gmail.com>

Continuing my previous question w/r/t the HP Elite GX607AA, I've attached
the lsusb -v output.

Thanks,

Mitch
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/ddd9646e/attachment.html>
-------------- next part --------------

Bus 001 Device 002: ID 0ac8:c315 Z-Star Microelectronics Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0ac8 Z-Star Microelectronics Corp.
  idProduct          0xc315 
  bcdDevice            1.00
  iManufacturer           1 
  iProduct                2 
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength         1033
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              320mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               2 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              2 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           79
        dwClockFrequency       48.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0006002e
          Auto-Exposure Mode
          Auto-Exposure Priority
          Exposure Time (Absolute)
          Focus (Absolute)
          Focus, Auto
          Privacy
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000177f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0 
        bmVideoStandards     0x 9
          None
          SECAM - 625/50
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
      VideoControl Interface Descriptor:
        bLength                28
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {5dc717a9-1941-da11-ae0e-000d56ac7b4c}
        bNumControl            14
        bNrPins                 1
        baSourceID( 0)          1
        bControlSize            3
        bmControls( 0)       0xf9
        bmControls( 1)       0x1f
        bmControls( 2)       0x80
        iExtension              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x000a  1x 10 bytes
        bInterval               5
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      637
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                9
        guidFormat                            {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 36864000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x01
          Still image supported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 12165120
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  9216000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x01
          Still image supported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  3041280
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x01
          Still image supported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  2304000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 11796480
        dwMaxBitRate                 11796480
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval        1333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                104857600
        dwMaxBitRate                104857600
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         8
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1600
        wHeight                          1200
        dwMinBitRate                153600000
        dwMaxBitRate                153600000
        dwMaxVideoFrameBufferSize     3840000
        dwDefaultFrameInterval        2000000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         9
        bmCapabilities                   0x01
          Still image supported
        wWidth                           2048
        wHeight                          1536
        dwMinBitRate                 18874368
        dwMaxBitRate                 18874368
        dwMaxVideoFrameBufferSize     6291456
        dwDefaultFrameInterval        3333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)           3333333
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        2
        bNumFrameDescriptors                7
        bFlags                              0
          Fixed-size samples: No
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 36864000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x01
          Still image supported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                 12165120
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  9216000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x01
          Still image supported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  3041280
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x01
          Still image supported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  2304000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1024
        wHeight                           768
        dwMinBitRate                 11796480
        dwMaxBitRate                 11796480
        dwMaxVideoFrameBufferSize     1572864
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  3
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            666667
        dwFrameInterval( 2)           1333333
      VideoStreaming Interface Descriptor:
        bLength                            34
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x01
          Still image supported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                157286400
        dwMaxBitRate                157286400
        dwMaxVideoFrameBufferSize     2621440
        dwDefaultFrameInterval         666667
        bFrameIntervalType                  2
        dwFrameInterval( 0)            666667
        dwFrameInterval( 1)           1333333
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b00  2x 768 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0c00  2x 1024 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       2 Streaming
      bFunctionProtocol       0 
      iFunction               2 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0 
      iInterface              2 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           40
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0205 Microphone Array
        bAssocTerminal          0
        bNrChannels             2
        wChannelConfig     0x0003
          Left Front (L)
          Right Front (R)
        iChannelNames           0 
        iTerminal               0 
      AudioControl Interface Descriptor:
        bLength                10
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 2
        bSourceID               1
        bControlSize            1
        bmaControls( 0)      0x00
        bmaControls( 1)      0x03
          Mute
          Volume
        bmaControls( 2)      0x03
          Mute
          Volume
        iFeature                0 
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          1
        bSourceID               2
        iTerminal               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                14
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            2 Discrete
        tSamFreq[ 0]        44100
        tSamFreq[ 1]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0062  1x 98 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                14
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             2
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            2 Discrete
        tSamFreq[ 0]        44100
        tSamFreq[ 1]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x00c4  1x 196 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined

From laurent.pinchart at ideasonboard.com  Thu Sep 24 23:44:11 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 24 Sep 2009 23:44:11 +0200
Subject: [Linux-uvc-devel] Acer HD Crystal Eye webcam (064e:a117 Suyin
	Corp.) and Ubuntu 9.04 problems
In-Reply-To: <9cf0f07b0909241403s302cacb7s78e84032e71e232b@mail.gmail.com>
References: <9cf0f07b0909180818s6ccf7225hf43e7aa912e492dd@mail.gmail.com>
	<200909242301.01740.laurent.pinchart@ideasonboard.com>
	<9cf0f07b0909241403s302cacb7s78e84032e71e232b@mail.gmail.com>
Message-ID: <200909242344.11214.laurent.pinchart@ideasonboard.com>

Hi Andrea,

On Thursday 24 September 2009 23:03:17 Andrea Grandi wrote:
> Hi,
> 
> 2009/9/24 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> > Hi Andrea,
> > Your log is truncated. Can you set the trace parameter to 127 and capture
> > the kernel log again ?
> 
> sorry, this was the right link: http://pastebin.com/m18f4f623
> 
> I hope this is ok.

Yes it is, thanks.

The log shows the Cheese opens the device four times to stream video data.

[ 2222.650758] uvcvideo: Trying format 0x56595559 (YUYV): 1280x800.
[ 2222.650761] uvcvideo: Using default frame interval 111111.1 us (9.0 fps).
...
[ 2224.759563] uvcvideo: Trying format 0x47504a4d (MJPG): 1280x800.
[ 2224.759566] uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
...
[ 2230.361550] uvcvideo: Trying format 0x47504a4d (MJPG): 1280x800.
[ 2230.361553] uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
...
[ 2241.682398] uvcvideo: Trying format 0x47504a4d (MJPG): 1280x800.
[ 2241.682401] uvcvideo: Using default frame interval 33333.3 us (30.0 fps).

The first time it captures a single YUV 1280x800 frame, the next three times 
it captures several MJPG 1280x800 frames.

The third capture run gets quite slow after some time:

[ 2232.317576] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[ 2232.317586] uvcvideo: Queuing buffer 1.
[ 2232.317835] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[ 2232.317840] uvcvideo: Dequeuing buffer 0 (3, 154384 bytes).
[ 2232.382032] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[ 2232.382041] uvcvideo: Queuing buffer 0.

There's a two seconds delay here between the time when buffer 0 is queued and 
the time the next buffer is dequeued. If the application waits two seconds 
before calling VIDIOC_DQBUF the driver can't do much about it.

[ 2234.067161] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[ 2234.067170] uvcvideo: Dequeuing buffer 1 (3, 157576 bytes).
[ 2234.119014] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[ 2234.119024] uvcvideo: Queuing buffer 1.
[ 2234.561870] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[ 2234.561879] uvcvideo: Dequeuing buffer 0 (3, 161384 bytes).
[ 2234.613641] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[ 2234.613650] uvcvideo: Queuing buffer 0.
[ 2235.859377] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[ 2235.859385] uvcvideo: Dequeuing buffer 1 (3, 159096 bytes).
[ 2235.910547] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[ 2235.910555] uvcvideo: Queuing buffer 1.
[ 2235.910742] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[ 2235.910747] uvcvideo: Dequeuing buffer 0 (3, 146648 bytes).
[ 2236.005059] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[ 2236.005068] uvcvideo: Queuing buffer 0.

I suspect that you're running into different issues with Cheese and Skype. As 
Skype is closed source, you should probably try to solve the Cheese problem 
first. I suspect it comes from userspace so you'll have to look there (either 
in Cheese itself, in gstreamer or in libv4l). strace might help.

-- 
Regards,

Laurent Pinchart


From mjtrac at gmail.com  Thu Sep 24 23:51:34 2009
From: mjtrac at gmail.com (Mitch Trachtenberg)
Date: Thu, 24 Sep 2009 14:51:34 -0700
Subject: [Linux-uvc-devel] hp elite 6x607aa / ubuntu
In-Reply-To: <200909242342.59735.laurent.pinchart@ideasonboard.com>
References: <6c52fee0909241349n5e155475w44f4c54fa8b472e7@mail.gmail.com> 
	<200909242310.46889.laurent.pinchart@ideasonboard.com>
	<6c52fee0909241433v3af885b0p7d48efa62529e947@mail.gmail.com> 
	<200909242342.59735.laurent.pinchart@ideasonboard.com>
Message-ID: <6c52fee0909241451h73d75d6bnde98e311cd46e60c@mail.gmail.com>

I've pasted the lsusb -v output and the kernel messages from running
luvcview with trace 255 to:

lsusb: http://pastebin.com/m1620fb4
/var/log/kern.log: http://pastebin.com/m3c1b39d9

Thanks, Laurent,

Mitch
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/e7422fbc/attachment.html>

From mjtrac at gmail.com  Fri Sep 25 02:22:10 2009
From: mjtrac at gmail.com (Mitch Trachtenberg)
Date: Thu, 24 Sep 2009 17:22:10 -0700
Subject: [Linux-uvc-devel] hp elite 6x607aa / ubuntu (lights)
Message-ID: <6c52fee0909241722ldec1d90h7b097cf93071bf97@mail.gmail.com>

One more probably quite relevant bit of info... I used the camera on a
Windows XP machine to make sure there was no problem with the camera
itself.  The camera has LEDs that light up on Windows.  They didn't light on
Linux, at least for me.

On Thu, Sep 24, 2009 at 2:51 PM, Mitch Trachtenberg <mjtrac at gmail.com>wrote:

> I've pasted the lsusb -v output and the kernel messages from running
> luvcview with trace 255 to:
>
> lsusb: http://pastebin.com/m1620fb4
> /var/log/kern.log: http://pastebin.com/m3c1b39d9
>
> Thanks, Laurent,
>
> Mitch
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/da4a27c0/attachment.html>

From bo-liu at hotmail.com  Fri Sep 25 03:49:53 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Fri, 25 Sep 2009 09:49:53 +0800
Subject: [Linux-uvc-devel] Why can't set format after
 VIDIOC_STREAMINGOFF ?
In-Reply-To: <200909242257.26990.laurent.pinchart@ideasonboard.com>
References: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>
Message-ID: <COL115-W3016FFF31FF4409D44BC169FD90@phx.gbl>


 <200909242257.26990.laurent.pinchart at ideasonboard.com>
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0


>
> On Thursday 24 September 2009 11:14:35 Bo Liu wrote:
>> Hi, All
>>
>> I have a question about VIDIOC_S_FMT?
>>
>> Gstreamer will ioctl(VIDIOC_STREAMINGOFF???? then ioctl(VIDIOC_S_FMT),
>> then ioctl(VIDIOC_STREAMINGON)
>>
>> The newest's code have these patch:
>>
>> diff --git a/drivers/media/video/uvc/uvc_v4l2.c
>> b/drivers/media/video/uvc/uvc_v4l2.c index 507542d..f8b94d6 100644 (file)
>> --- a/drivers/media/video/uvc/uvc_v4l2.c
>> +++ b/drivers/media/video/uvc/uvc_v4l2.c
>> @@ -251,7 +251,7 @@ static int uvc_v4l2_set_format(struct uvc_video_device
>> *video, if (fmt->type != video->streaming->type)
>> return -EINVAL;
>>
>> - if (uvc_queue_streaming(&video->queue))
>> + if (uvc_queue_allocated(&video->queue))
>> return -EBUSY;
>>
>> ret = uvc_v4l2_try_format(video, fmt, &probe, &format, &frame);
>>
>>
>>
>> And, I found after this patch ioctl(VIDIOC_S_FMT) will failed at
>> uvc_queue_allocated(it won't failed at uvc_queue_streaming).
>>
>> So, Now Can Gstreamer set the format(use ioctl(VIDIOC_STREAMINGOFF????
>> then ioctl(VIDIOC_S_FMT), then ioctl(VIDIOC_STREAMINGON)) after open the
>> device(doesn't close) ? If not, How to implement this?
>
> You can't change the format while buffers are allocated. You need to free the
> buffers before, using VIDIOC_REQBUFS with a buffer count of 0.
>
 
Thanks for your reply, uvc_v4l2_try_format() success now. 
But gstreamer still failed while dequeue buffer, I think maybe it doesn't realloc buffer and add to queue.
Then, How and where to realloc the buffer after change the format?
I try to use VIDIOC_REQBUFS with a buffer count. But it seems no useage.
 

> --
> Regards,
>
> Laurent Pinchart 		 	   		  
_________________________________________________________________
Invite your mail contacts to join your friends list with Windows Live Spaces. It's easy!
http://spaces.live.com/spacesapi.aspx?wx_action=create&wx_url=/friends.aspx&mkt=en-us


From bo-liu at hotmail.com  Fri Sep 25 04:14:36 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Fri, 25 Sep 2009 10:14:36 +0800
Subject: [Linux-uvc-devel] Always polling atfer unplug the usb webcam,
	BUG ?
In-Reply-To: <200909242244.18382.laurent.pinchart@ideasonboard.com>
References: <COL115-W1C67269FD9E10DBE108679FE30@phx.gbl>
Message-ID: <COL115-W451B09A7F1E585F5DDF7D99FD90@phx.gbl>


 <200909242244.18382.laurent.pinchart at ideasonboard.com>
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0


>
> On Tuesday 15 September 2009 10:01:03 Bo Liu wrote:
>> Hi=2C
>>
>> I found a problem when using my webcam. First=2C it's ok=2C but after I =
unplug
>> it. Systerm call poll() will not return.
>>
>> I looked at the src code=2C and found that uvc_queue_poll() always retur=
n 0=2C
>> it didn't know the webcam have unpluged at that time.
>>
>> And I saw in funtion uvc_video_complete()=2C if urb->status is
>> -ESHUTDOWN=2Cuvc_queue_cancel(queue=2C urb->status =3D=3D -ESHUTDOWN)=3B=
 will be
>> called.
>
> That's right=2C and then uvc_queue_poll() should return POLLERR=2C making=
 poll()
> return.
>
>> But=2C if just when in uvc_video_complete()> usb_submit_urb() =2C the we=
bcam is
>> unpluged=2C the usb_submit_urb() will failed=2C but just with a printk. =
Won't
>> call uvc_queue_cancel(). So=2C uvc_queue_poll() will always return 0. An=
d=2C I
>> add uvc_queue_cancel() after usb_submit_urb() failed=2Cerverything is ok=
.
>>
>> Is this a bug ?
>
> This is weird. The uvcvideo driver submits several URBs=2C so even if the=
 device
> is disconnected during the completion handler=2C the next URBs should get=
 a -
> ESHUTDOWN status (at least with EHCI USB controllers).
>
> Are you using the latest driver ? What status do you get when the complet=
ion
> handler is called for the next URB after usb_submit_urb() returns -ESHUTD=
OWN ?
> What USB controller are you using ?
=20
The driver version is about last month.
The status sometimes is -ESHUTDOWN=2C then uvc_queue_poll() can return POLL=
ERR.
But most of the time urb->status is 0=2C and I got several "Failed to resub=
mit video URB (-19)" error.
=20
So=2C I must add uvc_queue_cancel() to make poll() alwasy can return.
=20
716 if ((ret =3D usb_submit_urb(urb=2C GFP_ATOMIC)) < 0) {
    //added=20
    uvc_queue_cancel()=3B
717 uvc_printk(KERN_ERR=2C "Failed to resubmit video URB (%d).\n"=2C
718 ret)=3B
719 }
=20
usb controller is intel's ECHI.
=20

>
>> Funtions uvc_video_complete():
>>
>> 716 if ((ret =3D usb_submit_urb(urb=2C GFP_ATOMIC)) < 0) {
>> 717 uvc_printk(KERN_ERR=2C "Failed to resubmit video URB (%d).\n"=2C
>> 718 ret)=3B
>> 719 }
>
> --
> Regards=2C
>
> Laurent Pinchart 		 	   		  =0A=
_________________________________________________________________=0A=
Drag n=92 drop=97Get easy photo sharing with Windows Live=99 Photos.
=0A=
http://www.microsoft.com/windows/windowslive/products/photos.aspx=


From bo-liu at hotmail.com  Fri Sep 25 04:21:02 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Fri, 25 Sep 2009 10:21:02 +0800
Subject: [Linux-uvc-devel] Always polling atfer unplug the usb webcam,
	BUG ?
In-Reply-To: <200909242244.18382.laurent.pinchart@ideasonboard.com>
References: <COL115-W1C67269FD9E10DBE108679FE30@phx.gbl>
Message-ID: <COL115-W22A985FC6F53C6CC9B934E9FD90@phx.gbl>


 <200909242244.18382.laurent.pinchart at ideasonboard.com>
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0


>
> On Tuesday 15 September 2009 10:01:03 Bo Liu wrote:
>> Hi=2C
>>
>> I found a problem when using my webcam. First=2C it's ok=2C but after I =
unplug
>> it. Systerm call poll() will not return.
>>
>> I looked at the src code=2C and found that uvc_queue_poll() always retur=
n 0=2C
>> it didn't know the webcam have unpluged at that time.
>>
>> And I saw in funtion uvc_video_complete()=2C if urb->status is
>> -ESHUTDOWN=2Cuvc_queue_cancel(queue=2C urb->status =3D=3D -ESHUTDOWN)=3B=
 will be
>> called.
>
> That's right=2C and then uvc_queue_poll() should return POLLERR=2C making=
 poll()
> return.
>
>> But=2C if just when in uvc_video_complete()> usb_submit_urb() =2C the we=
bcam is
>> unpluged=2C the usb_submit_urb() will failed=2C but just with a printk. =
Won't
>> call uvc_queue_cancel(). So=2C uvc_queue_poll() will always return 0. An=
d=2C I
>> add uvc_queue_cancel() after usb_submit_urb() failed=2Cerverything is ok=
.
>>
>> Is this a bug ?
>
> This is weird. The uvcvideo driver submits several URBs=2C so even if the=
 device
> is disconnected during the completion handler=2C the next URBs should get=
 a -
> ESHUTDOWN status (at least with EHCI USB controllers).
>
> Are you using the latest driver ? What status do you get when the complet=
ion
> handler is called for the next URB after usb_submit_urb() returns -ESHUTD=
OWN ?
> What USB controller are you using ?
=20
The driver version is about last month.
The status sometimes is -ESHUTDOWN then uvc_queue_poll() can return POLLERR=
.
But most of the time urb->status is 0 and I got several "Failed to resubmit=
=20
video URB (-19)" error.
So I must add uvc_queue_cancel() to make poll() alwasy can return.

> 716 if ((ret =3D usb_submit_urb(urb=2CGFP_ATOMIC)) < 0) {
>     //added
>     uvc_queue_cancel()
> 717 uvc_printk(KERN_ERR=2C "Failed to resubmit video URB (%d).\n"
> 718 ret)=3B
> 719 }

usb controller is intel's ECHI.


>
>> Funtions uvc_video_complete():
>>
>> 716 if ((ret =3D usb_submit_urb(urb=2C GFP_ATOMIC)) < 0) {
>> 717 uvc_printk(KERN_ERR=2C "Failed to resubmit video URB (%d).\n"=2C
>> 718 ret)=3B
>> 719 }
>
> --
> Regards=2C
>
> Laurent Pinchart 		 	   		  =0A=
_________________________________________________________________=0A=
Drag n=92 drop=97Get easy photo sharing with Windows Live=99 Photos.
=0A=
http://www.microsoft.com/windows/windowslive/products/photos.aspx=


From bo-liu at hotmail.com  Fri Sep 25 04:23:48 2009
From: bo-liu at hotmail.com (Bo Liu)
Date: Fri, 25 Sep 2009 10:23:48 +0800
Subject: [Linux-uvc-devel] Always polling atfer unplug the usb webcam,
	BUG ?
In-Reply-To: <COL115-W22A985FC6F53C6CC9B934E9FD90@phx.gbl>
References: <COL115-W1C67269FD9E10DBE108679FE30@phx.gbl>
Message-ID: <COL115-W5567219FED96E563CE26189FD90@phx.gbl>


 <COL115-W22A985FC6F53C6CC9B934E9FD90 at phx.gbl>
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0


Sorry=2C I don't know why my format always error.

>
>>
>> On Tuesday 15 September 2009 10:01:03 Bo Liu wrote:
>>> Hi=3D2C
>>>
>>> I found a problem when using my webcam. First=3D2C it's ok=3D2C but aft=
er I =3D
> unplug
>>> it. Systerm call poll() will not return.
>>>
>>> I looked at the src code=3D2C and found that uvc_queue_poll() always re=
tur=3D
> n 0=3D2C
>>> it didn't know the webcam have unpluged at that time.
>>>
>>> And I saw in funtion uvc_video_complete()=3D2C if urb->status is
>>> -ESHUTDOWN=3D2Cuvc_queue_cancel(queue=3D2C urb->status =3D3D=3D3D -ESHU=
TDOWN)=3D3B=3D
> will be
>>> called.
>>
>> That's right=3D2C and then uvc_queue_poll() should return POLLERR=3D2C m=
aking=3D
> poll()
>> return.
>>
>>> But=3D2C if just when in uvc_video_complete()> usb_submit_urb() =3D2C t=
he we=3D
> bcam is
>>> unpluged=3D2C the usb_submit_urb() will failed=3D2C but just with a pri=
ntk. =3D
> Won't
>>> call uvc_queue_cancel(). So=3D2C uvc_queue_poll() will always return 0.=
 An=3D
> d=3D2C I
>>> add uvc_queue_cancel() after usb_submit_urb() failed=3D2Cerverything is=
 ok=3D
> .
>>>
>>> Is this a bug ?
>>
>> This is weird. The uvcvideo driver submits several URBs=3D2C so even if =
the=3D
> device
>> is disconnected during the completion handler=3D2C the next URBs should =
get=3D
> a -
>> ESHUTDOWN status (at least with EHCI USB controllers).
>>
>> Are you using the latest driver ? What status do you get when the comple=
t=3D
> ion
>> handler is called for the next URB after usb_submit_urb() returns -ESHUT=
D=3D
> OWN ?
>> What USB controller are you using ?
> =3D20
> The driver version is about last month.
> The status sometimes is -ESHUTDOWN then uvc_queue_poll() can return POLLE=
RR=3D
> .
> But most of the time urb->status is 0 and I got several "Failed to resubm=
it=3D
> =3D20
> video URB (-19)" error.
> So I must add uvc_queue_cancel() to make poll() alwasy can return.
>
>> 716 if ((ret =3D3D usb_submit_urb(urb=3D2CGFP_ATOMIC)) < 0) {
>> //added
>> uvc_queue_cancel()
>> 717 uvc_printk(KERN_ERR=3D2C "Failed to resubmit video URB (%d).\n"
>> 718 ret)=3D3B
>> 719 }
>
> usb controller is intel's ECHI.
>
>
>>
>>> Funtions uvc_video_complete():
>>>
>>> 716 if ((ret =3D3D usb_submit_urb(urb=3D2C GFP_ATOMIC)) < 0) {
>>> 717 uvc_printk(KERN_ERR=3D2C "Failed to resubmit video URB (%d).\n"=3D2=
C
>>> 718 ret)=3D3B
>>> 719 }
>> 		 	   		  =0A=
_________________________________________________________________=0A=
More than messages=96check out the rest of the Windows Live=99.=0A=
http://www.microsoft.com/windows/windowslive/=


From mjtrac at gmail.com  Fri Sep 25 06:30:43 2009
From: mjtrac at gmail.com (Mitch Trachtenberg)
Date: Thu, 24 Sep 2009 21:30:43 -0700
Subject: [Linux-uvc-devel] hp elite gx607aa / ubuntu
Message-ID: <6c52fee0909242130v34af4082qb37c7d5925eeb6a3@mail.gmail.com>

Very strange.  After running the camera on Windows and restarting Linux, the
camera works.  I'm still curious as to what the issue might have been but
obviously the urgency has gone down.  Thanks.

Mitch

On Thu, Sep 24, 2009 at 2:42 PM, Laurent Pinchart <
laurent.pinchart at ideasonboard.com> wrote:

> Hi Mitch,
>
> On Thursday 24 September 2009 23:33:00 Mitch Trachtenberg wrote:
> > Thanks, Laurent.  I've pasted the lsusb -v output and the output of
> >  luvcview to pastebin.com under the name "Mitch Trachtenberg" after
> >  executing the following command: "sudo modprobe uvcvideo trace=255".
> >  Please let me know if that's not what you had in mind, and thanks again.
>
> I'll need the link, pastebin.com can't be searched. Please keep the
> linux-uvc-
> devel list CC'ed in your answer.
>
> --
> Regards,
>
> Laurent Pinchart
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090924/84f98eab/attachment.html>

From a.grandi at gmail.com  Fri Sep 25 08:56:14 2009
From: a.grandi at gmail.com (Andrea Grandi)
Date: Fri, 25 Sep 2009 08:56:14 +0200
Subject: [Linux-uvc-devel] Acer HD Crystal Eye webcam (064e:a117 Suyin
	Corp.) and Ubuntu 9.04 problems
In-Reply-To: <200909242344.11214.laurent.pinchart@ideasonboard.com>
References: <9cf0f07b0909180818s6ccf7225hf43e7aa912e492dd@mail.gmail.com>
	<200909242301.01740.laurent.pinchart@ideasonboard.com>
	<9cf0f07b0909241403s302cacb7s78e84032e71e232b@mail.gmail.com>
	<200909242344.11214.laurent.pinchart@ideasonboard.com>
Message-ID: <9cf0f07b0909242356m429e8396pef5e84b5fda90305@mail.gmail.com>

Hi,

2009/9/24 Laurent Pinchart <laurent.pinchart at ideasonboard.com>:
> I suspect that you're running into different issues with Cheese and Skype. As
> Skype is closed source, you should probably try to solve the Cheese problem
> first. I suspect it comes from userspace so you'll have to look there (either
> in Cheese itself, in gstreamer or in libv4l). strace might help.

the problem is I don't have enough tech skill to debug a similar application.
I really have no experience at all with v4l, gstreamer stuff.

Can you suggest me other opensource applications I could try to use,
to see if they have the same problem?

Thanks!

p.s: even the webcam preview of "emesene" works perfectly fine!

-- 
Andrea Grandi
email: a.grandi [AT] gmail [DOT] com
website: http://www.andreagrandi.it
PGP Key: http://www.andreagrandi.it/pgp_key.asc


From jjchico at gmail.com  Fri Sep 25 10:14:50 2009
From: jjchico at gmail.com (Jorge Juan)
Date: Fri, 25 Sep 2009 10:14:50 +0200
Subject: [Linux-uvc-devel] Bison webcam (5986:0203) error "cannot reset
	por" with 2.6.31 kernel
In-Reply-To: <59cf47a80909240223m63880f2dq60d134046048da97@mail.gmail.com>
References: <648098c10909240138r722ddd51xbe4e90773e516a4b@mail.gmail.com>
	<648098c10909240142o2ef58caara2f1a8a59a278e08@mail.gmail.com>
	<59cf47a80909240223m63880f2dq60d134046048da97@mail.gmail.com>
Message-ID: <648098c10909250114o33488250ode20ae23c9c2b219@mail.gmail.com>

Hi Paulo,

2009/9/24 Paulo Assis <pj.assis at gmail.com>:
> Juan,
> I'm also using karmic, and all my uvc cameras work just fine with the
> latest kernel (2.6.31-10)
>
> Could this be related to your usb hub ?
> Have you tried booting with the camera disconnected and plugging it
> after booting (hot plug)
> Do you see similar the errors in this case?

This is the camera integrated in a MSI Wind Netbook. I cannot
physically plug/unplug it. I can enable/disable the camera by pressing
FN+F6, which I do not know if it's exactly like (un)plugging the
camera. In case I disable the camera and reboot, it is no longer
listed by lsusb. I can then enable the camera and the same problem
will appear most of the times (in very rare occasions the system will
work well)

I also thought it was a hub problem, but it works perfectly in jaunty
and also in karmic as long as I do not load the uvcvideo module. I am
not a developer, but I would say that some initialization made by
uvcvideo makes the hub to hung, maybe because the hardware is also
buggy.

I think the best option now is to know if:
1) Other MSI wind user are having the same problem
2) If uvcvideo initialization has changed from 2.6.28 to 2.6.31

>
> Karmic upstart/initscripts have been causing some problems, I had the
> boot process broken at least two times now. Udev also has had is share
> of problems, the latest updates have fixed most of these issues, but
> please remember that karmic is still under heavy development and is
> far from stable.

I know.

>
> Best regards,
> Paulo

Thanks.

jorge.

>
> 2009/9/24 Jorge Juan <jjchico at gmail.com>:
>> Hi!
>>
>> I am an Ubuntu user running the developing version (karmic, kernel
>> 2.6.31) on a MSI Wind netbook. I am getting this in dmesg most of the
>> time I boot:
>>
>> ...
>> [ ?127.156016] ehci_hcd 0000:00:1d.7: force halt; handhake f8046424
>> 00004000 00000000 -> -110
>> [ ?127.724247] hub 1-0:1.0: cannot reset port 6 (err = -108)
>> [ ?127.724262] hub 1-0:1.0: cannot reset port 6 (err = -108)
>> [ ?127.724273] hub 1-0:1.0: cannot reset port 6 (err = -108)
>> [ ?127.724283] hub 1-0:1.0: cannot reset port 6 (err = -108)
>> [ ?127.724292] hub 1-0:1.0: cannot reset port 6 (err = -108)
>> [ ?127.724300] hub 1-0:1.0: Cannot enable port 6. ?Maybe the USB cable is bad?
>> ...
>>
>> and USB mass storage does not work. Also I get this one when trying to suspend:
>>
>> ...
>> [ ?185.881554] PM: Entering mem sleep
>> [ ?185.881575] Suspending console(s) (use no_console_suspend to debug)
>> [ ?185.900175] uvcvideo: Failed to set UVC commit control : -108 (exp. 26).
>> [ ?185.900190] uvcvideo 1-5:1.1: resume error -5
>> [ ?185.900213] pm_op(): usb_dev_suspend+0x0/0x10 returns -108
>> [ ?185.900223] PM: Device 1-5 failed to suspend: error -108
>> [ ?185.900231] PM: Some devices failed to suspend
>> ...
>>
>> Disabling the uvcvideo module (blacklisted) solves the problem
>> (scarifying webcam functionality).
>>
>> The stable ubuntu (jaunty) with kernel 2.6.28 works well. You can find
>> a more detailed report at Ubuntu's bug tracking system:
>>
>> http://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352
>>
>> I know I should try the last uvcvideo driver but, do you know if it is
>> a known regression in the driver? Is it solved in the current
>> development version?
>>
>> Thanks for your great work.
>>
>> jorge.
>> --
>> Jorge Juan
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>
>



-- 
Jorge Juan


From pj.assis at gmail.com  Fri Sep 25 10:35:42 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Fri, 25 Sep 2009 09:35:42 +0100
Subject: [Linux-uvc-devel] Bison webcam (5986:0203) error "cannot reset
	por" with 2.6.31 kernel
In-Reply-To: <648098c10909250114o33488250ode20ae23c9c2b219@mail.gmail.com>
References: <648098c10909240138r722ddd51xbe4e90773e516a4b@mail.gmail.com>
	<648098c10909240142o2ef58caara2f1a8a59a278e08@mail.gmail.com>
	<59cf47a80909240223m63880f2dq60d134046048da97@mail.gmail.com>
	<648098c10909250114o33488250ode20ae23c9c2b219@mail.gmail.com>
Message-ID: <59cf47a80909250135v29c7716aicef5cc1eeff09748@mail.gmail.com>

Juan,
After last night updates I had a broken boot again, this time I
noticed it stopped while setting the camera input. It just hang for a
while and then jumped to initramfs prompt with a timeout message that
it couldn't load the root drive ( the specified uuid device could not
be found).
I unplugged the camera, rebooted and it worked fine.
This also happened last week, now it works even with the camera
plugged in, so I guess this is a bit random.

Best regards,
Paulo

2009/9/25 Jorge Juan <jjchico at gmail.com>:
> Hi Paulo,
>
> 2009/9/24 Paulo Assis <pj.assis at gmail.com>:
>> Juan,
>> I'm also using karmic, and all my uvc cameras work just fine with the
>> latest kernel (2.6.31-10)
>>
>> Could this be related to your usb hub ?
>> Have you tried booting with the camera disconnected and plugging it
>> after booting (hot plug)
>> Do you see similar the errors in this case?
>
> This is the camera integrated in a MSI Wind Netbook. I cannot
> physically plug/unplug it. I can enable/disable the camera by pressing
> FN+F6, which I do not know if it's exactly like (un)plugging the
> camera. In case I disable the camera and reboot, it is no longer
> listed by lsusb. I can then enable the camera and the same problem
> will appear most of the times (in very rare occasions the system will
> work well)
>
> I also thought it was a hub problem, but it works perfectly in jaunty
> and also in karmic as long as I do not load the uvcvideo module. I am
> not a developer, but I would say that some initialization made by
> uvcvideo makes the hub to hung, maybe because the hardware is also
> buggy.
>
> I think the best option now is to know if:
> 1) Other MSI wind user are having the same problem
> 2) If uvcvideo initialization has changed from 2.6.28 to 2.6.31
>
>>
>> Karmic upstart/initscripts have been causing some problems, I had the
>> boot process broken at least two times now. Udev also has had is share
>> of problems, the latest updates have fixed most of these issues, but
>> please remember that karmic is still under heavy development and is
>> far from stable.
>
> I know.
>
>>
>> Best regards,
>> Paulo
>
> Thanks.
>
> jorge.
>
>>
>> 2009/9/24 Jorge Juan <jjchico at gmail.com>:
>>> Hi!
>>>
>>> I am an Ubuntu user running the developing version (karmic, kernel
>>> 2.6.31) on a MSI Wind netbook. I am getting this in dmesg most of the
>>> time I boot:
>>>
>>> ...
>>> [ ?127.156016] ehci_hcd 0000:00:1d.7: force halt; handhake f8046424
>>> 00004000 00000000 -> -110
>>> [ ?127.724247] hub 1-0:1.0: cannot reset port 6 (err = -108)
>>> [ ?127.724262] hub 1-0:1.0: cannot reset port 6 (err = -108)
>>> [ ?127.724273] hub 1-0:1.0: cannot reset port 6 (err = -108)
>>> [ ?127.724283] hub 1-0:1.0: cannot reset port 6 (err = -108)
>>> [ ?127.724292] hub 1-0:1.0: cannot reset port 6 (err = -108)
>>> [ ?127.724300] hub 1-0:1.0: Cannot enable port 6. ?Maybe the USB cable is bad?
>>> ...
>>>
>>> and USB mass storage does not work. Also I get this one when trying to suspend:
>>>
>>> ...
>>> [ ?185.881554] PM: Entering mem sleep
>>> [ ?185.881575] Suspending console(s) (use no_console_suspend to debug)
>>> [ ?185.900175] uvcvideo: Failed to set UVC commit control : -108 (exp. 26).
>>> [ ?185.900190] uvcvideo 1-5:1.1: resume error -5
>>> [ ?185.900213] pm_op(): usb_dev_suspend+0x0/0x10 returns -108
>>> [ ?185.900223] PM: Device 1-5 failed to suspend: error -108
>>> [ ?185.900231] PM: Some devices failed to suspend
>>> ...
>>>
>>> Disabling the uvcvideo module (blacklisted) solves the problem
>>> (scarifying webcam functionality).
>>>
>>> The stable ubuntu (jaunty) with kernel 2.6.28 works well. You can find
>>> a more detailed report at Ubuntu's bug tracking system:
>>>
>>> http://bugs.launchpad.net/ubuntu/+source/linux/+bug/435352
>>>
>>> I know I should try the last uvcvideo driver but, do you know if it is
>>> a known regression in the driver? Is it solved in the current
>>> development version?
>>>
>>> Thanks for your great work.
>>>
>>> jorge.
>>> --
>>> Jorge Juan
>>> _______________________________________________
>>> Linux-uvc-devel mailing list
>>> Linux-uvc-devel at lists.berlios.de
>>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>>>
>>
>
>
>
> --
> Jorge Juan
>


From emberez at gmail.com  Fri Sep 25 18:55:02 2009
From: emberez at gmail.com (Pedro Fragoso)
Date: Fri, 25 Sep 2009 17:55:02 +0100
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5996:0241) not working
Message-ID: <4e4248cd0909250955s11f06143v335cd3b3df8dd322@mail.gmail.com>

Hi all.

I'm unable to get a BisonCam to work on Linux.

dmesg says:

uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0241)
uvcvideo: No valid video chain found.


I'm using kernel 2.6.30, and already tried the latest tarball from uvcvideo.

Any hints?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090925/81a0f5bc/attachment.html>

From laurent.pinchart at ideasonboard.com  Tue Sep 29 00:55:17 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 29 Sep 2009 00:55:17 +0200
Subject: [Linux-uvc-devel] Why can't set format after
	VIDIOC_STREAMINGOFF ?
In-Reply-To: <COL115-W3016FFF31FF4409D44BC169FD90@phx.gbl>
References: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>
	<COL115-W3016FFF31FF4409D44BC169FD90@phx.gbl>
Message-ID: <200909290055.17588.laurent.pinchart@ideasonboard.com>

Hi,

On Friday 25 September 2009 03:49:53 Bo Liu wrote:
>  <200909242257.26990.laurent.pinchart at ideasonboard.com>
> Content-Type: text/plain; charset="gb2312"
> Content-Transfer-Encoding: 8bit
> MIME-Version: 1.0

Please try to fix your mail client. This is really annoying.
 
> > On Thursday 24 September 2009 11:14:35 Bo Liu wrote:
> > > Hi, All
> > >
> > > I have a question about VIDIOC_S_FMT?
> > >
> > > Gstreamer will ioctl(VIDIOC_STREAMINGOFF) then ioctl(VIDIOC_S_FMT),
> > > then ioctl(VIDIOC_STREAMINGON)
> > >
> > > The newest's code have these patch:
> > >
> > > diff --git a/drivers/media/video/uvc/uvc_v4l2.c 
> > > b/drivers/media/video/uvc/uvc_v4l2.c index 507542d..f8b94d6 100644
> > > (file)
> > > --- a/drivers/media/video/uvc/uvc_v4l2.c
> > > +++ b/drivers/media/video/uvc/uvc_v4l2.c
> > > @@ -251,7 +251,7 @@ static int uvc_v4l2_set_format(struct
> > > uvc_video_device *video, if (fmt->type != video->streaming->type)
> > > return -EINVAL;
> > >
> > > - if (uvc_queue_streaming(&video->queue))
> > > + if (uvc_queue_allocated(&video->queue))
> > > return -EBUSY;
> > >
> > > ret = uvc_v4l2_try_format(video, fmt, &probe, &format, &frame);
> > >
> > >
> > > And, I found after this patch ioctl(VIDIOC_S_FMT) will failed at
> > > uvc_queue_allocated(it won't failed at uvc_queue_streaming).
> > >
> > > So, Now Can Gstreamer set the format(use ioctl(VIDIOC_STREAMINGOFF????
> > > then ioctl(VIDIOC_S_FMT), then ioctl(VIDIOC_STREAMINGON)) after open the
> > > device(doesn't close) ? If not, How to implement this?
> >
> > You can't change the format while buffers are allocated. You need to free
> > the buffers before, using VIDIOC_REQBUFS with a buffer count of 0.
> 
> Thanks for your reply, uvc_v4l2_try_format() success now.

I suppose you mean uvc_v4l2_set_format().

> But gstreamer still failed while dequeue buffer, I think maybe it doesn't
> realloc buffer and add to queue. Then, How and where to realloc the buffer
> after change the format? I try to use VIDIOC_REQBUFS with a buffer count.
> But it seems no useage.

That's the right way to do it, and it should work.

ioctl(VIDIOC_S_FMT)
ioctl(VIDIOC_REQBUFS - n buffers)
mmap()
ioctl(VIDIOC_QBUF)
ioctl(VIDIOC_STREAMON)
ioctl(VIDIOC_DQBUF)
ioctl(VIDIOC_QBUF)
...
ioctl(VIDIOC_STREAMOFF)
munmap()
ioctl(VIDIOC_REQBUFS - 0 buffers)

At this point the buffers are free and you should be able to start over, 
setting a new format, requesting the buffers, mapping them, ...

If you get an error from the driver please report it.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Tue Sep 29 00:59:59 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 29 Sep 2009 00:59:59 +0200
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5996:0241) not working
In-Reply-To: <4e4248cd0909250955s11f06143v335cd3b3df8dd322@mail.gmail.com>
References: <4e4248cd0909250955s11f06143v335cd3b3df8dd322@mail.gmail.com>
Message-ID: <200909290100.00043.laurent.pinchart@ideasonboard.com>

On Friday 25 September 2009 18:55:02 Pedro Fragoso wrote:
> Hi all.
> 
> I'm unable to get a BisonCam to work on Linux.
> 
> dmesg says:
> 
> uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0241)
> uvcvideo: No valid video chain found.
> 
> I'm using kernel 2.6.30, and already tried the latest tarball from
>  uvcvideo.
> 
> Any hints?

Could you please send me the output of

lsusb -v -d 5986:0241

with usbutils 0.72 or newer (0.73+ preferred) ? Thanks.

-- 
Regards,

Laurent Pinchart


From hdegoede at redhat.com  Tue Sep 29 09:04:04 2009
From: hdegoede at redhat.com (Hans de Goede)
Date: Tue, 29 Sep 2009 09:04:04 +0200
Subject: [Linux-uvc-devel] Why can't set format
 after	VIDIOC_STREAMINGOFF ?
In-Reply-To: <200909290055.17588.laurent.pinchart@ideasonboard.com>
References: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>	<COL115-W3016FFF31FF4409D44BC169FD90@phx.gbl>
	<200909290055.17588.laurent.pinchart@ideasonboard.com>
Message-ID: <4AC1B164.1010104@redhat.com>

Hi,

On 09/29/2009 12:55 AM, Laurent Pinchart wrote:
> Hi,
>
> On Friday 25 September 2009 03:49:53 Bo Liu wrote:
>>   <200909242257.26990.laurent.pinchart at ideasonboard.com>
>> Content-Type: text/plain; charset="gb2312"
>> Content-Transfer-Encoding: 8bit
>> MIME-Version: 1.0
>
> Please try to fix your mail client. This is really annoying.
>
>>> On Thursday 24 September 2009 11:14:35 Bo Liu wrote:
>>>> Hi, All
>>>>
>>>> I have a question about VIDIOC_S_FMT?
>>>>
>>>> Gstreamer will ioctl(VIDIOC_STREAMINGOFF) then ioctl(VIDIOC_S_FMT),
>>>> then ioctl(VIDIOC_STREAMINGON)
>>>>
>>>> The newest's code have these patch:
>>>>
>>>> diff --git a/drivers/media/video/uvc/uvc_v4l2.c
>>>> b/drivers/media/video/uvc/uvc_v4l2.c index 507542d..f8b94d6 100644
>>>> (file)
>>>> --- a/drivers/media/video/uvc/uvc_v4l2.c
>>>> +++ b/drivers/media/video/uvc/uvc_v4l2.c
>>>> @@ -251,7 +251,7 @@ static int uvc_v4l2_set_format(struct
>>>> uvc_video_device *video, if (fmt->type != video->streaming->type)
>>>> return -EINVAL;
>>>>
>>>> - if (uvc_queue_streaming(&video->queue))
>>>> + if (uvc_queue_allocated(&video->queue))
>>>> return -EBUSY;
>>>>
>>>> ret = uvc_v4l2_try_format(video, fmt,&probe,&format,&frame);
>>>>
>>>>
>>>> And, I found after this patch ioctl(VIDIOC_S_FMT) will failed at
>>>> uvc_queue_allocated(it won't failed at uvc_queue_streaming).
>>>>
>>>> So, Now Can Gstreamer set the format(use ioctl(VIDIOC_STREAMINGOFF????
>>>> then ioctl(VIDIOC_S_FMT), then ioctl(VIDIOC_STREAMINGON)) after open the
>>>> device(doesn't close) ? If not, How to implement this?
>>>
>>> You can't change the format while buffers are allocated. You need to free
>>> the buffers before, using VIDIOC_REQBUFS with a buffer count of 0.
>>
>> Thanks for your reply, uvc_v4l2_try_format() success now.
>
> I suppose you mean uvc_v4l2_set_format().
>
>> But gstreamer still failed while dequeue buffer, I think maybe it doesn't
>> realloc buffer and add to queue. Then, How and where to realloc the buffer
>> after change the format? I try to use VIDIOC_REQBUFS with a buffer count.
>> But it seems no useage.
>
> That's the right way to do it, and it should work.
>
> ioctl(VIDIOC_S_FMT)
> ioctl(VIDIOC_REQBUFS - n buffers)
> mmap()
> ioctl(VIDIOC_QBUF)
> ioctl(VIDIOC_STREAMON)
> ioctl(VIDIOC_DQBUF)
> ioctl(VIDIOC_QBUF)
> ...
> ioctl(VIDIOC_STREAMOFF)
> munmap()
> ioctl(VIDIOC_REQBUFS - 0 buffers)
>

Note that the need for this last call (VIDIOC_REQBUFS - 0 buffers), also known
as unrequesting the buffers, is a bit ambiguous. Not all drivers need this, and
some even return an EINVAL if the number of requested buffers < 0.

I think we need to clarify the V4L2 API specification on this point.

libv4l currently does do the unrequest the buffers thingie (when it is managing
the buffers itself), but ignores the return value.

Regards,

Hans


From emberez at gmail.com  Tue Sep 29 10:55:40 2009
From: emberez at gmail.com (Pedro Fragoso)
Date: Tue, 29 Sep 2009 09:55:40 +0100
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5996:0241) not working
In-Reply-To: <200909290100.00043.laurent.pinchart@ideasonboard.com>
References: <4e4248cd0909250955s11f06143v335cd3b3df8dd322@mail.gmail.com>
	<200909290100.00043.laurent.pinchart@ideasonboard.com>
Message-ID: <1254214540.2382.4.camel@obsolete>

Hi Laurent,

Here's the output of lsusb:


        Bus 002 Device 003: ID 5986:0241 Acer, Inc 
        Device Descriptor:
          bLength                18
          bDescriptorType         1
          bcdUSB               2.00
          bDeviceClass          239 Miscellaneous Device
          bDeviceSubClass         2 ?
          bDeviceProtocol         1 Interface Association
          bMaxPacketSize0        64
          idVendor           0x5986 Acer, Inc
          idProduct          0x0241 
          bcdDevice            6.05
          iManufacturer           3 BISON Corporation
          iProduct                1 BisonCam, NB Pro
          iSerial                 0 
          bNumConfigurations      1
          Configuration Descriptor:
            bLength                 9
            bDescriptorType         2
            wTotalLength          459
            bNumInterfaces          2
            bConfigurationValue     1
            iConfiguration          0 
            bmAttributes         0x80
              (Bus Powered)
            MaxPower              500mA
            Interface Association:
              bLength                 8
              bDescriptorType        11
              bFirstInterface         0
              bInterfaceCount         2
              bFunctionClass         14 Video
              bFunctionSubClass       3 Video Interface Collection
              bFunctionProtocol       0 
              iFunction               1 BisonCam, NB Pro
            Interface Descriptor:
              bLength                 9
              bDescriptorType         4
              bInterfaceNumber        0
              bAlternateSetting       0
              bNumEndpoints           1
              bInterfaceClass        14 Video
              bInterfaceSubClass      1 Video Control
              bInterfaceProtocol      0 
              iInterface              1 BisonCam, NB Pro
              VideoControl Interface Descriptor:
                bLength                13
                bDescriptorType        36
                bDescriptorSubtype      1 (HEADER)
                bcdUVC               1.00
                wTotalLength           85
                dwClockFrequency       30.000000MHz
                bInCollection           1
                baInterfaceNr( 0)       1
              VideoControl Interface Descriptor:
                bLength                18
                bDescriptorType        36
                bDescriptorSubtype      2 (INPUT_TERMINAL)
                bTerminalID             1
                wTerminalType      0x0201 Camera Sensor
                bAssocTerminal          0
                iTerminal               0 
                wObjectiveFocalLengthMin      0
                wObjectiveFocalLengthMax      0
                wOcularFocalLength            0
                bControlSize                  3
                bmControls           0x00000000
              VideoControl Interface Descriptor:
                bLength                 9
                bDescriptorType        36
                bDescriptorSubtype      3 (OUTPUT_TERMINAL)
                bTerminalID             3
                wTerminalType      0x0101 USB Streaming
                bAssocTerminal          0
                bSourceID               6
                iTerminal               0 
              VideoControl Interface Descriptor:
                bLength                 7
                bDescriptorType        36
                bDescriptorSubtype      4 (SELECTOR_UNIT)
                bUnitID                 4
                bNrInPins               1
                baSource( 0)            1
                iSelector               0 
              VideoControl Interface Descriptor:
                bLength                11
                bDescriptorType        36
                bDescriptorSubtype      5 (PROCESSING_UNIT)
              Warning: Descriptor too short
                bUnitID                 5
                bSourceID               4
                wMaxMultiplier          0
                bControlSize            2
                bmControls     0x0000043f
                  Brightness
                  Contrast
                  Hue
                  Saturation
                  Sharpness
                  Gamma
                  Power Line Frequency
                iProcessing             0 
                bmVideoStandards     0x1b
                  None
                  NTSC - 525/60
                  SECAM - 625/50
                  NTSC - 625/50
              VideoControl Interface Descriptor:
                bLength                27
                bDescriptorType        36
                bDescriptorSubtype      6 (EXTENSION_UNIT)
                bUnitID                 6
                guidExtensionCode
        {564c97a7-7ea7-904b-8cbf-1c71ec303000}
                bNumControl            16
                bNrPins                 1
                baSourceID( 0)          5
                bControlSize            2
                bmControls( 0)       0xff
                bmControls( 1)       0xff
                iExtension              0 
              Endpoint Descriptor:
                bLength                 7
                bDescriptorType         5
                bEndpointAddress     0x82  EP 2 IN
                bmAttributes            3
                  Transfer Type            Interrupt
                  Synch Type               None
                  Usage Type               Data
                wMaxPacketSize     0x0008  1x 8 bytes
                bInterval              15
            Interface Descriptor:
              bLength                 9
              bDescriptorType         4
              bInterfaceNumber        1
              bAlternateSetting       0
              bNumEndpoints           0
              bInterfaceClass        14 Video
              bInterfaceSubClass      2 Video Streaming
              bInterfaceProtocol      0 
              iInterface              0 
              VideoStreaming Interface Descriptor:
                bLength                            14
                bDescriptorType                    36
                bDescriptorSubtype                  1 (INPUT_HEADER)
                bNumFormats                         1
                wTotalLength                      291
                bEndPointAddress                  129
                bmInfo                              0
                bTerminalLink                       3
                bStillCaptureMethod                 0
                bTriggerSupport                     0
                bTriggerUsage                       0
                bControlSize                        1
                bmaControls( 0)                    27
              VideoStreaming Interface Descriptor:
                bLength                            27
                bDescriptorType                    36
                bDescriptorSubtype                  4
        (FORMAT_UNCOMPRESSED)
                bFormatIndex                        1
                bNumFrameDescriptors                6
                guidFormat
         {59555932-0000-1000-8000-00aa00389b71}
                bBitsPerPixel                      16
                bDefaultFrameIndex                  1
                bAspectRatioX                       0
                bAspectRatioY                       0
                bmInterlaceFlags                 0x00
                  Interlaced stream or variable: No
                  Fields per frame: 1 fields
                  Field 1 first: No
                  Field pattern: Field 1 only
                  bCopyProtect                      0
              VideoStreaming Interface Descriptor:
                bLength                            38
                bDescriptorType                    36
                bDescriptorSubtype                  5
        (FRAME_UNCOMPRESSED)
                bFrameIndex                         1
                bmCapabilities                   0x01
                  Still image supported
                wWidth                            640
                wHeight                           480
                dwMinBitRate                 12288000
                dwMaxBitRate                 12288000
                dwMaxVideoFrameBufferSize      614400
                dwDefaultFrameInterval         555555
                bFrameIntervalType                  3
                dwFrameInterval( 0)            555555
                dwFrameInterval( 1)            666666
                dwFrameInterval( 2)           1000000
              VideoStreaming Interface Descriptor:
                bLength                            38
                bDescriptorType                    36
                bDescriptorSubtype                  5
        (FRAME_UNCOMPRESSED)
                bFrameIndex                         2
                bmCapabilities                   0x01
                  Still image supported
                wWidth                            320
                wHeight                           240
                dwMinBitRate                  3072000
                dwMaxBitRate                  3072000
                dwMaxVideoFrameBufferSize      153600
                dwDefaultFrameInterval         333333
                bFrameIntervalType                  3
                dwFrameInterval( 0)            333333
                dwFrameInterval( 1)            666666
                dwFrameInterval( 2)           1000000
              VideoStreaming Interface Descriptor:
                bLength                            38
                bDescriptorType                    36
                bDescriptorSubtype                  5
        (FRAME_UNCOMPRESSED)
                bFrameIndex                         3
                bmCapabilities                   0x01
                  Still image supported
                wWidth                            160
                wHeight                           120
                dwMinBitRate                   768000
                dwMaxBitRate                   768000
                dwMaxVideoFrameBufferSize       38400
                dwDefaultFrameInterval         333333
                bFrameIntervalType                  3
                dwFrameInterval( 0)            333333
                dwFrameInterval( 1)            666666
                dwFrameInterval( 2)           1000000
              VideoStreaming Interface Descriptor:
                bLength                            38
                bDescriptorType                    36
                bDescriptorSubtype                  5
        (FRAME_UNCOMPRESSED)
                bFrameIndex                         4
                bmCapabilities                   0x01
                  Still image supported
                wWidth                            352
                wHeight                           288
                dwMinBitRate                  4055040
                dwMaxBitRate                  4055040
                dwMaxVideoFrameBufferSize      202752
                dwDefaultFrameInterval         333333
                bFrameIntervalType                  3
                dwFrameInterval( 0)            333333
                dwFrameInterval( 1)            666666
                dwFrameInterval( 2)           1000000
              VideoStreaming Interface Descriptor:
                bLength                            38
                bDescriptorType                    36
                bDescriptorSubtype                  5
        (FRAME_UNCOMPRESSED)
                bFrameIndex                         5
                bmCapabilities                   0x01
                  Still image supported
                wWidth                            176
                wHeight                           144
                dwMinBitRate                  1013760
                dwMaxBitRate                  1013760
                dwMaxVideoFrameBufferSize       50688
                dwDefaultFrameInterval         333333
                bFrameIntervalType                  3
                dwFrameInterval( 0)            333333
                dwFrameInterval( 1)            666666
                dwFrameInterval( 2)           1000000
              VideoStreaming Interface Descriptor:
                bLength                            30
                bDescriptorType                    36
                bDescriptorSubtype                  5
        (FRAME_UNCOMPRESSED)
                bFrameIndex                         6
                bmCapabilities                   0x01
                  Still image supported
                wWidth                           1280
                wHeight                          1024
                dwMinBitRate                 26214400
                dwMaxBitRate                 26214400
                dwMaxVideoFrameBufferSize     2621440
                dwDefaultFrameInterval        1333333
                bFrameIntervalType                  1
                dwFrameInterval( 0)           1333333
              ** UNRECOGNIZED:  12 98 05 02 76 2f 12 98 05 02 76 2f 90
        91 97 e0 b4 05
            Interface Descriptor:
              bLength                 9
              bDescriptorType         4
              bInterfaceNumber        1
              bAlternateSetting       1
              bNumEndpoints           1
              bInterfaceClass        14 Video
              bInterfaceSubClass      2 Video Streaming
              bInterfaceProtocol      0 
              iInterface              0 
              Endpoint Descriptor:
                bLength                 7
                bDescriptorType         5
                bEndpointAddress     0x81  EP 1 IN
                bmAttributes            5
                  Transfer Type            Isochronous
                  Synch Type               Asynchronous
                  Usage Type               Data
                wMaxPacketSize     0x1400  3x 1024 bytes
                bInterval               1
            Interface Descriptor:
              bLength                 9
              bDescriptorType         4
              bInterfaceNumber        1
              bAlternateSetting       2
              bNumEndpoints           1
              bInterfaceClass        14 Video
              bInterfaceSubClass      2 Video Streaming
              bInterfaceProtocol      0 
              iInterface              0 
              Endpoint Descriptor:
                bLength                 7
                bDescriptorType         5
                bEndpointAddress     0x81  EP 1 IN
                bmAttributes            5
                  Transfer Type            Isochronous
                  Synch Type               Asynchronous
                  Usage Type               Data
                wMaxPacketSize     0x1400  3x 1024 bytes
                bInterval               1
            Interface Descriptor:
              bLength                 9
              bDescriptorType         4
              bInterfaceNumber        1
              bAlternateSetting       3
              bNumEndpoints           1
              bInterfaceClass        14 Video
              bInterfaceSubClass      2 Video Streaming
              bInterfaceProtocol      0 
              iInterface              0 
              Endpoint Descriptor:
                bLength                 7
                bDescriptorType         5
                bEndpointAddress     0x81  EP 1 IN
                bmAttributes            5
                  Transfer Type            Isochronous
                  Synch Type               Asynchronous
                  Usage Type               Data
                wMaxPacketSize     0x1400  3x 1024 bytes
                bInterval               1
        Device Qualifier (for other device speed):
          bLength                10
          bDescriptorType         6
          bcdUSB               2.00
          bDeviceClass          239 Miscellaneous Device
          bDeviceSubClass         2 ?
          bDeviceProtocol         1 Interface Association
          bMaxPacketSize0        64
          bNumConfigurations      1
        Device Status:     0x0000
          (Bus Powered)
        
This seems to be a invalid format for this Bison, output of dmesg with
trace 2:

Linux video capture interface: v2.00
        uvcvideo: Found format YUV 4:2:2 (YUYV).
        uvcvideo: - 640x480 (18.0 fps)
        uvcvideo: - 320x240 (30.0 fps)
        uvcvideo: - 160x120 (30.0 fps)
        uvcvideo: - 352x288 (30.0 fps)
        uvcvideo: - 176x144 (30.0 fps)
        uvcvideo: - 1280x1024 (7.5 fps)
        uvcvideo: device 3 videostreaming interface 1 FRAME error
        uvcvideo: Found a Status endpoint (addr 82).
        uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0241)
        uvcvideo: No valid video chain found.

On Tue, 2009-09-29 at 00:59 +0200, Laurent Pinchart wrote:
> On Friday 25 September 2009 18:55:02 Pedro Fragoso wrote:
> > Hi all.
> > 
> > I'm unable to get a BisonCam to work on Linux.
> > 
> > dmesg says:
> > 
> > uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0241)
> > uvcvideo: No valid video chain found.
> > 
> > I'm using kernel 2.6.30, and already tried the latest tarball from
> >  uvcvideo.
> > 
> > Any hints?
> 
> Could you please send me the output of
> 
> lsusb -v -d 5986:0241
> 
> with usbutils 0.72 or newer (0.73+ preferred) ? Thanks.
> 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090929/539ba467/attachment.pgp>

From oregon.mick at gmail.com  Wed Sep 30 04:07:57 2009
From: oregon.mick at gmail.com (Mick Reed)
Date: Tue, 29 Sep 2009 19:07:57 -0700
Subject: [Linux-uvc-devel] Hardware report
Message-ID: <d0bd00bf0909291907v17ab83cbkfec5752e14e2ce71@mail.gmail.com>

Working:

1871:01f0  Aveo Technology Corp. USB2.0 Webcam

This is a generic unit from China, has 6 white LEDs with dimmer and a
microphone with an audio (3.5mm) connector.  It looks like a Microsoft
Lifecam, and has a button on top, which I haven't tested.

I chose this because it claimed to be "driver-free."  Tested with
Skype, kopete, luvcview  using 2.6.31-gentoo-bfs222, kde-4.3.1,
gcc-4.4.1-r2 hardened...

Thank you,
Mick Reed


From laiyujun at gmail.com  Wed Sep 30 09:04:25 2009
From: laiyujun at gmail.com (laiyujun)
Date: Wed, 30 Sep 2009 15:04:25 +0800
Subject: [Linux-uvc-devel] 093a:2700 camera not work
In-Reply-To: <200909242304.26563.laurent.pinchart@ideasonboard.com>
References: <afbba5040908152121k9ca6ddbj68ac4950cf1f8427@mail.gmail.com>
	<59cf47a80908201035mbdfe024s4345cad0487af787@mail.gmail.com>
	<afbba5040908251931w10467e89wc36aea19d4263ff4@mail.gmail.com>
	<200909242304.26563.laurent.pinchart@ideasonboard.com>
Message-ID: <afbba5040909300004y634ddeb0v7153d9376f10c79b@mail.gmail.com>

Hi,
    Thanks Laurent.
    It works!
    Ploblem seems to be solved days ago. I purchased another mainboard
with CPU. All software remain not change. I try some applications. At
least "webcam" and "motion" work well. Maybe the basic reason is the
obsolete hardware(include CPU and slow USB 1.1).
----------------
~$ uname -a
Linux 2.6.26-2-486 #1 Wed Aug 19 05:40:02 UTC 2009 i686 GNU/Linux

~$ sudo webcam
[sudo] password for somebody:
reading config file: /home/somebody/.webcamrc
video4linux webcam v1.5 - (c) 1998-2002 Gerd Knorr
grabber config:
  size 640x480 [16 bit YUV 4:2:2 (packed, YUYV)]
  input (null), norm (null), jpeg quality 75
  rotate=0, top=0, left=0, bottom=480, right=640
write config [ftp]:
  local transfer /var/www/imageup.jpg => /var/www/webcam.jpg

~$ motion
[0] Processing thread 0 - config file motion.conf
[0] Unknown config option "v4l2_palette"
[0] Motion 3.2.9 Started
[0] ffmpeg LIBAVCODEC_BUILD 3355136 LIBAVFORMAT_BUILD 3409664
[0] Thread 1 is from motion.conf
[1] Thread 1 started
[1] cap.driver: "uvcvideo"
[1] cap.card: "USB2.0_Camera"
[1] cap.bus_info: "0000:00:10.3"
[1] cap.capabilities=0x04000001
[1] - VIDEO_CAPTURE
[1] - STREAMING
[1] Supported palettes:
[1] 0: YUYV (YUV 4:2:2 (YUYV))
[0] motion-httpd/3.2.9 running, accepting connections
[0] motion-httpd: waiting for data on port TCP 8080
[1] Test palette YUYV (352x288)
[1] Using palette YUYV (352x288) bytesperlines 704 sizeimage 202752
colorspace 00000008
[1] found control 0x00980900, "Brightness", range 0,255
[1]     "Brightness", default 125, current 125
[1] found control 0x00980901, "Contrast", range 0,100
[1]     "Contrast", default 20, current 20
[1] found control 0x00980902, "Saturation", range 0,200
[1]     "Saturation", default 195, current 195
[1] found control 0x00980903, "Hue", range -180,180
[1]     "Hue", default 0, current 0
[1] found control 0x00980910, "Gamma", range 40,100
[1]     "Gamma", default 80, current 80
[1] mmap information:
[1] frames=4
[1] 0 length=202752
[1] 1 length=202752
[1] 2 length=202752
[1] 3 length=202752
[1] Using V4L2
----------------
Thanks all linux uvc driver developers!

Regards,
Laiyujun


From deadpan110 at gmail.com  Wed Sep 30 08:44:32 2009
From: deadpan110 at gmail.com (Deadpan110)
Date: Wed, 30 Sep 2009 16:14:32 +0930
Subject: [Linux-uvc-devel] Acer Wide LCD Monitor H243HX with inbuilt Acer
	Crystal Eye Web Cam 0458:7066
Message-ID: <2a7fc2e80909292344r5413fcd5m2acbb6322a16ea62@mail.gmail.com>

Hello list,

Not sure if this web cam is on the list yet so I figured I would post it anyway.

Distro: Ubuntu 9.04


uname -a
Linux sky 2.6.30-02063003-generic #02063003 SMP Sat Jul 25 10:57:13
UTC 2009 i686 GNU/Linux


cheese -v
Cheese 2.26.0
Probing devices with HAL...
Found device 0458:7066, getting capabilities...
Detected v4l2 device: Acer Crystal Eye Webcam
Driver: uvcvideo, version: 256
Capabilities: 0x04000001

Probing supported video formats...
libv4l2: error turning on stream: Input/output error


luvcview
luvcview version 0.2.1
Video driver: x11
A window manager is available
video /dev/video0
Unable to start capture: 5.
Error grabbing
 Clean Up done Quit


dmesg | egrep -i uvc
[    8.632246] uvcvideo: Found UVC 1.00 device Acer Crystal Eye Webcam
(0458:7066)
[    8.819419] usbcore: registered new interface driver uvcvideo
[  170.525661] uvcvideo: Failed to set UVC probe control : -32 (exp. 26).
[  170.628834] uvcvideo: Failed to set UVC commit control : -32 (exp. 26).
[  183.334338] uvcvideo: Failed to set UVC commit control : -32 (exp. 26).
[  222.627742] uvcvideo: Failed to set UVC commit control : -32 (exp. 26).

lsusb -d  0458:7066 -v

Bus 001 Device 005: ID 0458:7066 KYE Systems Corp. (Mouse Systems)
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x0458 KYE Systems Corp. (Mouse Systems)
  idProduct          0x7066
  bcdDevice            0.01
  iManufacturer           1 KYE
  iProduct                2 Acer Crystal Eye Webcam
  iSerial                 3 KYE01-M522-OV01-A1-B200903271
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength         1573
    bNumInterfaces          4
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               2 Acer Crystal Eye Webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              2 Acer Crystal Eye Webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           80
        dwClockFrequency       48.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0000000a
          Auto-Exposure Mode
          Exposure Time (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000157f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x1d
          None
          PAL - 625/50
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                29
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 3
        guidExtensionCode         {82066163-7050-ab49-b8cc-b3855e8d221d}
        bNumControl             0
        bNrPins                 1
        baSourceID( 0)          2
        bControlSize            4
        bmControls( 0)       0x3e
        bmControls( 1)       0x00
        bmControls( 2)       0x86
        bmControls( 3)       0x07
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             4
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               3
        iTerminal               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x87  EP 7 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               8
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      862
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       4
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                7
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           400
        dwMinBitRate                 20480000
        dwMaxBitRate                122880000
        dwMaxVideoFrameBufferSize      512000
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1536000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  2027520
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  6144000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                 73728000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize     1843200
        dwDefaultFrameInterval        1000000
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1000000
        dwFrameInterval( 1)           1333333
        dwFrameInterval( 2)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           800
        dwMinBitRate                 98304000
        dwMaxBitRate                163840000
        dwMaxVideoFrameBufferSize     2457600
        dwDefaultFrameInterval        1000000
        bFrameIntervalType                  3
        dwFrameInterval( 0)           1000000
        dwFrameInterval( 1)           1333333
        dwFrameInterval( 2)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            35
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               7
        wWidth( 0)                       1280
        wHeight( 0)                       720
        wWidth( 1)                        160
        wHeight( 1)                       120
        wWidth( 2)                        176
        wHeight( 2)                       144
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        640
        wHeight( 4)                       400
        wWidth( 5)                        640
        wHeight( 5)                       480
        wWidth( 6)                       1280
        wHeight( 6)                       800
        bNumCompressionPatterns             7
        bCompression( 0)                    1
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        2
        bNumFrameDescriptors                7
        bFlags                              1
          Fixed-size samples: Yes
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           400
        dwMinBitRate                 20480000
        dwMaxBitRate                122880000
        dwMaxVideoFrameBufferSize      512000
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1536000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  2027520
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  6144000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           720
        dwMinBitRate                 73728000
        dwMaxBitRate                442368000
        dwMaxVideoFrameBufferSize     1843200
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            54
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         7
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                           800
        dwMinBitRate                 81920000
        dwMaxBitRate                491520000
        dwMaxVideoFrameBufferSize     2048000
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  7
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            400000
        dwFrameInterval( 2)            500000
        dwFrameInterval( 3)            666666
        dwFrameInterval( 4)           1000000
        dwFrameInterval( 5)           1333333
        dwFrameInterval( 6)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            38
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               7
        wWidth( 0)                       1280
        wHeight( 0)                       720
        wWidth( 1)                        160
        wHeight( 1)                       120
        wWidth( 2)                        176
        wHeight( 2)                       144
        wWidth( 3)                        320
        wHeight( 3)                       240
        wWidth( 4)                        640
        wHeight( 4)                       400
        wWidth( 5)                        640
        wHeight( 5)                       480
        wWidth( 6)                       1280
        wHeight( 6)                       800
        bNumCompressionPatterns             7
        bCompression( 0)                    1
        bCompression( 1)                    5
        bCompression( 2)                   10
        bCompression( 3)                   20
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x00c0  1x 192 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0180  1x 384 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0280  1x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x03b0  1x 944 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0a80  2x 640 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       8
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       9
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0be0  2x 992 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting      10
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1380  3x 896 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting      11
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x13fc  3x 1020 bytes
        bInterval               1
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         2
      bInterfaceCount         2
      bFunctionClass          1 Audio
      bFunctionSubClass       2 Streaming
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      1 Control Device
      bInterfaceProtocol      0
      iInterface              0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdADC               1.00
        wTotalLength           38
        bInCollection           1
        baInterfaceNr( 0)       3
      AudioControl Interface Descriptor:
        bLength                12
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Microphone
        bAssocTerminal          0
        bNrChannels             1
        wChannelConfig     0x0000
        iChannelNames           0
        iTerminal               0
      AudioControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      AudioControl Interface Descriptor:
        bLength                 8
        bDescriptorType        36
        bDescriptorSubtype      6 (FEATURE_UNIT)
        bUnitID                 5
        bSourceID               1
        bControlSize            1
        bmaControls( 0)      0x03
          Mute
          Volume
        iFeature                0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]         8000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0012  1x 18 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        11025
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x001a  1x 26 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        16000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0022  1x 34 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        22050
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0030  1x 48 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        24000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0032  1x 50 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        32000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0042  1x 66 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       7
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        44100
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x005c  1x 92 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       8
      bNumEndpoints           1
      bInterfaceClass         1 Audio
      bInterfaceSubClass      2 Streaming
      bInterfaceProtocol      0
      iInterface              0
      AudioStreaming Interface Descriptor:
        bLength                 7
        bDescriptorType        36
        bDescriptorSubtype      1 (AS_GENERAL)
        bTerminalLink           3
        bDelay                  1 frames
        wFormatTag              1 PCM
      AudioStreaming Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      2 (FORMAT_TYPE)
        bFormatType             1 (FORMAT_TYPE_I)
        bNrChannels             1
        bSubframeSize           2
        bBitResolution         16
        bSamFreqType            1 Discrete
        tSamFreq[ 0]        48000
      Endpoint Descriptor:
        bLength                 9
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0062  1x 98 bytes
        bInterval               4
        bRefresh                0
        bSynchAddress           0
        AudioControl Endpoint Descriptor:
          bLength                 7
          bDescriptorType        37
          bDescriptorSubtype      1 (EP_GENERAL)
          bmAttributes         0x01
            Sampling Frequency
          bLockDelayUnits         0 Undefined
          wLockDelay              0 Undefined
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


If you require any more info, please let me know

Martin


From laurent.pinchart at ideasonboard.com  Wed Sep 30 10:07:08 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 30 Sep 2009 10:07:08 +0200
Subject: [Linux-uvc-devel] Hardware report
In-Reply-To: <d0bd00bf0909291907v17ab83cbkfec5752e14e2ce71@mail.gmail.com>
References: <d0bd00bf0909291907v17ab83cbkfec5752e14e2ce71@mail.gmail.com>
Message-ID: <200909301007.08922.laurent.pinchart@ideasonboard.com>

Hi Mick,

On Wednesday 30 September 2009 04:07:57 Mick Reed wrote:
> Working:
> 
> 1871:01f0  Aveo Technology Corp. USB2.0 Webcam
> 
> This is a generic unit from China, has 6 white LEDs with dimmer and a
> microphone with an audio (3.5mm) connector.  It looks like a Microsoft
> Lifecam, and has a button on top, which I haven't tested.
> 
> I chose this because it claimed to be "driver-free."  Tested with
> Skype, kopete, luvcview  using 2.6.31-gentoo-bfs222, kde-4.3.1,
> gcc-4.4.1-r2 hardened...

Thanks for the report. Could you please send me the output of

lsusb -v -d 1871:01f0

? Thanks.

-- 
Regards,

Laurent Pinchart


From emberez at gmail.com  Wed Sep 30 11:09:59 2009
From: emberez at gmail.com (Pedro Fragoso)
Date: Wed, 30 Sep 2009 10:09:59 +0100
Subject: [Linux-uvc-devel] BisonCam, NB Pro (5996:0241) not working
In-Reply-To: <1254214540.2382.4.camel@obsolete>
References: <4e4248cd0909250955s11f06143v335cd3b3df8dd322@mail.gmail.com>
	<200909290100.00043.laurent.pinchart@ideasonboard.com>
	<1254214540.2382.4.camel@obsolete>
Message-ID: <1254301799.2408.2.camel@obsolete>

Is there any workaround or patch for this ?


Thanks!


On Tue, 2009-09-29 at 09:55 +0100, Pedro Fragoso wrote:
> Hi Laurent,
> 
> Here's the output of lsusb:
> 
> 
>         Bus 002 Device 003: ID 5986:0241 Acer, Inc 
>         Device Descriptor:
>           bLength                18
>           bDescriptorType         1
>           bcdUSB               2.00
>           bDeviceClass          239 Miscellaneous Device
>           bDeviceSubClass         2 ?
>           bDeviceProtocol         1 Interface Association
>           bMaxPacketSize0        64
>           idVendor           0x5986 Acer, Inc
>           idProduct          0x0241 
>           bcdDevice            6.05
>           iManufacturer           3 BISON Corporation
>           iProduct                1 BisonCam, NB Pro
>           iSerial                 0 
>           bNumConfigurations      1
>           Configuration Descriptor:
>             bLength                 9
>             bDescriptorType         2
>             wTotalLength          459
>             bNumInterfaces          2
>             bConfigurationValue     1
>             iConfiguration          0 
>             bmAttributes         0x80
>               (Bus Powered)
>             MaxPower              500mA
>             Interface Association:
>               bLength                 8
>               bDescriptorType        11
>               bFirstInterface         0
>               bInterfaceCount         2
>               bFunctionClass         14 Video
>               bFunctionSubClass       3 Video Interface Collection
>               bFunctionProtocol       0 
>               iFunction               1 BisonCam, NB Pro
>             Interface Descriptor:
>               bLength                 9
>               bDescriptorType         4
>               bInterfaceNumber        0
>               bAlternateSetting       0
>               bNumEndpoints           1
>               bInterfaceClass        14 Video
>               bInterfaceSubClass      1 Video Control
>               bInterfaceProtocol      0 
>               iInterface              1 BisonCam, NB Pro
>               VideoControl Interface Descriptor:
>                 bLength                13
>                 bDescriptorType        36
>                 bDescriptorSubtype      1 (HEADER)
>                 bcdUVC               1.00
>                 wTotalLength           85
>                 dwClockFrequency       30.000000MHz
>                 bInCollection           1
>                 baInterfaceNr( 0)       1
>               VideoControl Interface Descriptor:
>                 bLength                18
>                 bDescriptorType        36
>                 bDescriptorSubtype      2 (INPUT_TERMINAL)
>                 bTerminalID             1
>                 wTerminalType      0x0201 Camera Sensor
>                 bAssocTerminal          0
>                 iTerminal               0 
>                 wObjectiveFocalLengthMin      0
>                 wObjectiveFocalLengthMax      0
>                 wOcularFocalLength            0
>                 bControlSize                  3
>                 bmControls           0x00000000
>               VideoControl Interface Descriptor:
>                 bLength                 9
>                 bDescriptorType        36
>                 bDescriptorSubtype      3 (OUTPUT_TERMINAL)
>                 bTerminalID             3
>                 wTerminalType      0x0101 USB Streaming
>                 bAssocTerminal          0
>                 bSourceID               6
>                 iTerminal               0 
>               VideoControl Interface Descriptor:
>                 bLength                 7
>                 bDescriptorType        36
>                 bDescriptorSubtype      4 (SELECTOR_UNIT)
>                 bUnitID                 4
>                 bNrInPins               1
>                 baSource( 0)            1
>                 iSelector               0 
>               VideoControl Interface Descriptor:
>                 bLength                11
>                 bDescriptorType        36
>                 bDescriptorSubtype      5 (PROCESSING_UNIT)
>               Warning: Descriptor too short
>                 bUnitID                 5
>                 bSourceID               4
>                 wMaxMultiplier          0
>                 bControlSize            2
>                 bmControls     0x0000043f
>                   Brightness
>                   Contrast
>                   Hue
>                   Saturation
>                   Sharpness
>                   Gamma
>                   Power Line Frequency
>                 iProcessing             0 
>                 bmVideoStandards     0x1b
>                   None
>                   NTSC - 525/60
>                   SECAM - 625/50
>                   NTSC - 625/50
>               VideoControl Interface Descriptor:
>                 bLength                27
>                 bDescriptorType        36
>                 bDescriptorSubtype      6 (EXTENSION_UNIT)
>                 bUnitID                 6
>                 guidExtensionCode
>         {564c97a7-7ea7-904b-8cbf-1c71ec303000}
>                 bNumControl            16
>                 bNrPins                 1
>                 baSourceID( 0)          5
>                 bControlSize            2
>                 bmControls( 0)       0xff
>                 bmControls( 1)       0xff
>                 iExtension              0 
>               Endpoint Descriptor:
>                 bLength                 7
>                 bDescriptorType         5
>                 bEndpointAddress     0x82  EP 2 IN
>                 bmAttributes            3
>                   Transfer Type            Interrupt
>                   Synch Type               None
>                   Usage Type               Data
>                 wMaxPacketSize     0x0008  1x 8 bytes
>                 bInterval              15
>             Interface Descriptor:
>               bLength                 9
>               bDescriptorType         4
>               bInterfaceNumber        1
>               bAlternateSetting       0
>               bNumEndpoints           0
>               bInterfaceClass        14 Video
>               bInterfaceSubClass      2 Video Streaming
>               bInterfaceProtocol      0 
>               iInterface              0 
>               VideoStreaming Interface Descriptor:
>                 bLength                            14
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  1 (INPUT_HEADER)
>                 bNumFormats                         1
>                 wTotalLength                      291
>                 bEndPointAddress                  129
>                 bmInfo                              0
>                 bTerminalLink                       3
>                 bStillCaptureMethod                 0
>                 bTriggerSupport                     0
>                 bTriggerUsage                       0
>                 bControlSize                        1
>                 bmaControls( 0)                    27
>               VideoStreaming Interface Descriptor:
>                 bLength                            27
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  4
>         (FORMAT_UNCOMPRESSED)
>                 bFormatIndex                        1
>                 bNumFrameDescriptors                6
>                 guidFormat
>          {59555932-0000-1000-8000-00aa00389b71}
>                 bBitsPerPixel                      16
>                 bDefaultFrameIndex                  1
>                 bAspectRatioX                       0
>                 bAspectRatioY                       0
>                 bmInterlaceFlags                 0x00
>                   Interlaced stream or variable: No
>                   Fields per frame: 1 fields
>                   Field 1 first: No
>                   Field pattern: Field 1 only
>                   bCopyProtect                      0
>               VideoStreaming Interface Descriptor:
>                 bLength                            38
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  5
>         (FRAME_UNCOMPRESSED)
>                 bFrameIndex                         1
>                 bmCapabilities                   0x01
>                   Still image supported
>                 wWidth                            640
>                 wHeight                           480
>                 dwMinBitRate                 12288000
>                 dwMaxBitRate                 12288000
>                 dwMaxVideoFrameBufferSize      614400
>                 dwDefaultFrameInterval         555555
>                 bFrameIntervalType                  3
>                 dwFrameInterval( 0)            555555
>                 dwFrameInterval( 1)            666666
>                 dwFrameInterval( 2)           1000000
>               VideoStreaming Interface Descriptor:
>                 bLength                            38
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  5
>         (FRAME_UNCOMPRESSED)
>                 bFrameIndex                         2
>                 bmCapabilities                   0x01
>                   Still image supported
>                 wWidth                            320
>                 wHeight                           240
>                 dwMinBitRate                  3072000
>                 dwMaxBitRate                  3072000
>                 dwMaxVideoFrameBufferSize      153600
>                 dwDefaultFrameInterval         333333
>                 bFrameIntervalType                  3
>                 dwFrameInterval( 0)            333333
>                 dwFrameInterval( 1)            666666
>                 dwFrameInterval( 2)           1000000
>               VideoStreaming Interface Descriptor:
>                 bLength                            38
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  5
>         (FRAME_UNCOMPRESSED)
>                 bFrameIndex                         3
>                 bmCapabilities                   0x01
>                   Still image supported
>                 wWidth                            160
>                 wHeight                           120
>                 dwMinBitRate                   768000
>                 dwMaxBitRate                   768000
>                 dwMaxVideoFrameBufferSize       38400
>                 dwDefaultFrameInterval         333333
>                 bFrameIntervalType                  3
>                 dwFrameInterval( 0)            333333
>                 dwFrameInterval( 1)            666666
>                 dwFrameInterval( 2)           1000000
>               VideoStreaming Interface Descriptor:
>                 bLength                            38
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  5
>         (FRAME_UNCOMPRESSED)
>                 bFrameIndex                         4
>                 bmCapabilities                   0x01
>                   Still image supported
>                 wWidth                            352
>                 wHeight                           288
>                 dwMinBitRate                  4055040
>                 dwMaxBitRate                  4055040
>                 dwMaxVideoFrameBufferSize      202752
>                 dwDefaultFrameInterval         333333
>                 bFrameIntervalType                  3
>                 dwFrameInterval( 0)            333333
>                 dwFrameInterval( 1)            666666
>                 dwFrameInterval( 2)           1000000
>               VideoStreaming Interface Descriptor:
>                 bLength                            38
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  5
>         (FRAME_UNCOMPRESSED)
>                 bFrameIndex                         5
>                 bmCapabilities                   0x01
>                   Still image supported
>                 wWidth                            176
>                 wHeight                           144
>                 dwMinBitRate                  1013760
>                 dwMaxBitRate                  1013760
>                 dwMaxVideoFrameBufferSize       50688
>                 dwDefaultFrameInterval         333333
>                 bFrameIntervalType                  3
>                 dwFrameInterval( 0)            333333
>                 dwFrameInterval( 1)            666666
>                 dwFrameInterval( 2)           1000000
>               VideoStreaming Interface Descriptor:
>                 bLength                            30
>                 bDescriptorType                    36
>                 bDescriptorSubtype                  5
>         (FRAME_UNCOMPRESSED)
>                 bFrameIndex                         6
>                 bmCapabilities                   0x01
>                   Still image supported
>                 wWidth                           1280
>                 wHeight                          1024
>                 dwMinBitRate                 26214400
>                 dwMaxBitRate                 26214400
>                 dwMaxVideoFrameBufferSize     2621440
>                 dwDefaultFrameInterval        1333333
>                 bFrameIntervalType                  1
>                 dwFrameInterval( 0)           1333333
>               ** UNRECOGNIZED:  12 98 05 02 76 2f 12 98 05 02 76 2f 90
>         91 97 e0 b4 05
>             Interface Descriptor:
>               bLength                 9
>               bDescriptorType         4
>               bInterfaceNumber        1
>               bAlternateSetting       1
>               bNumEndpoints           1
>               bInterfaceClass        14 Video
>               bInterfaceSubClass      2 Video Streaming
>               bInterfaceProtocol      0 
>               iInterface              0 
>               Endpoint Descriptor:
>                 bLength                 7
>                 bDescriptorType         5
>                 bEndpointAddress     0x81  EP 1 IN
>                 bmAttributes            5
>                   Transfer Type            Isochronous
>                   Synch Type               Asynchronous
>                   Usage Type               Data
>                 wMaxPacketSize     0x1400  3x 1024 bytes
>                 bInterval               1
>             Interface Descriptor:
>               bLength                 9
>               bDescriptorType         4
>               bInterfaceNumber        1
>               bAlternateSetting       2
>               bNumEndpoints           1
>               bInterfaceClass        14 Video
>               bInterfaceSubClass      2 Video Streaming
>               bInterfaceProtocol      0 
>               iInterface              0 
>               Endpoint Descriptor:
>                 bLength                 7
>                 bDescriptorType         5
>                 bEndpointAddress     0x81  EP 1 IN
>                 bmAttributes            5
>                   Transfer Type            Isochronous
>                   Synch Type               Asynchronous
>                   Usage Type               Data
>                 wMaxPacketSize     0x1400  3x 1024 bytes
>                 bInterval               1
>             Interface Descriptor:
>               bLength                 9
>               bDescriptorType         4
>               bInterfaceNumber        1
>               bAlternateSetting       3
>               bNumEndpoints           1
>               bInterfaceClass        14 Video
>               bInterfaceSubClass      2 Video Streaming
>               bInterfaceProtocol      0 
>               iInterface              0 
>               Endpoint Descriptor:
>                 bLength                 7
>                 bDescriptorType         5
>                 bEndpointAddress     0x81  EP 1 IN
>                 bmAttributes            5
>                   Transfer Type            Isochronous
>                   Synch Type               Asynchronous
>                   Usage Type               Data
>                 wMaxPacketSize     0x1400  3x 1024 bytes
>                 bInterval               1
>         Device Qualifier (for other device speed):
>           bLength                10
>           bDescriptorType         6
>           bcdUSB               2.00
>           bDeviceClass          239 Miscellaneous Device
>           bDeviceSubClass         2 ?
>           bDeviceProtocol         1 Interface Association
>           bMaxPacketSize0        64
>           bNumConfigurations      1
>         Device Status:     0x0000
>           (Bus Powered)
>         
> This seems to be a invalid format for this Bison, output of dmesg with
> trace 2:
> 
> Linux video capture interface: v2.00
>         uvcvideo: Found format YUV 4:2:2 (YUYV).
>         uvcvideo: - 640x480 (18.0 fps)
>         uvcvideo: - 320x240 (30.0 fps)
>         uvcvideo: - 160x120 (30.0 fps)
>         uvcvideo: - 352x288 (30.0 fps)
>         uvcvideo: - 176x144 (30.0 fps)
>         uvcvideo: - 1280x1024 (7.5 fps)
>         uvcvideo: device 3 videostreaming interface 1 FRAME error
>         uvcvideo: Found a Status endpoint (addr 82).
>         uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0241)
>         uvcvideo: No valid video chain found.
> 
> On Tue, 2009-09-29 at 00:59 +0200, Laurent Pinchart wrote:
> > On Friday 25 September 2009 18:55:02 Pedro Fragoso wrote:
> > > Hi all.
> > > 
> > > I'm unable to get a BisonCam to work on Linux.
> > > 
> > > dmesg says:
> > > 
> > > uvcvideo: Found UVC 1.00 device BisonCam, NB Pro (5986:0241)
> > > uvcvideo: No valid video chain found.
> > > 
> > > I'm using kernel 2.6.30, and already tried the latest tarball from
> > >  uvcvideo.
> > > 
> > > Any hints?
> > 
> > Could you please send me the output of
> > 
> > lsusb -v -d 5986:0241
> > 
> > with usbutils 0.72 or newer (0.73+ preferred) ? Thanks.
> > 
> 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090930/7b2ccbe2/attachment.pgp>

From iodine at mail.ru  Wed Sep 30 12:14:16 2009
From: iodine at mail.ru (Iodine)
Date: Wed, 30 Sep 2009 14:14:16 +0400
Subject: [Linux-uvc-devel] =?koi8-r?b?d2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxl?=
In-Reply-To: <200909240846.34351.laurent.pinchart@ideasonboard.com>
References: <200909240846.34351.laurent.pinchart@ideasonboard.com>
Message-ID: <E1MswCO-0005yb-00.iodine-mail-ru@f240.mail.ru>

Hello, Laurent!

> Your problem is then probably caused by a regression in the uvcvideo driver 
> between 2.6.28 and now. Could you try bisect the problem ? If you're not 
> familiar with the concept it will be easier to start by trying vanilla kernels 
> 2.6.28, 2.6.29, 2.6.30 and 2.6.31, and tell me at which version your webcam 
> starts failing (2.6.28 should work).

Before doing this I have installed the cam on another comp (also Ubuntu 9.04). Download and compile driver... and it's work!!!

I think problem in hardware or in usb-driver, but not in uvcvideo driver. First old comp have only usb 1.0 ports, second new comp have usb 2.0 ports, may be problem is there...

BTW, it's strange, on old comp (usb 1.0) the cam supports only MJPEG, and on new (usb 2.0) only YUYV:

[1] cap.driver: "uvcvideo"
[1] cap.card: "A4 TECH USB2.0 PC Camera J"
[1] cap.bus_info: "0000:00:1d.7"
[1] cap.capabilities=0x04000001
[1] - VIDEO_CAPTURE
[1] - STREAMING
[1] Supported palettes:
[1] 0: YUYV (YUV 4:2:2 (YUYV))
[1] index_format 6 Test palette YUYV (640x480)

Thanks for the help, question it is closed.

Best regards,

Iodine


From barsnick at gmx.net  Wed Sep 30 15:57:59 2009
From: barsnick at gmx.net (Moritz Barsnick)
Date: Wed, 30 Sep 2009 15:57:59 +0200
Subject: [Linux-uvc-devel] 093a:2700 camera not work
In-Reply-To: <afbba5040909300004y634ddeb0v7153d9376f10c79b@mail.gmail.com>
References: <afbba5040908152121k9ca6ddbj68ac4950cf1f8427@mail.gmail.com>
	<59cf47a80908201035mbdfe024s4345cad0487af787@mail.gmail.com>
	<afbba5040908251931w10467e89wc36aea19d4263ff4@mail.gmail.com>
	<200909242304.26563.laurent.pinchart@ideasonboard.com>
	<afbba5040909300004y634ddeb0v7153d9376f10c79b@mail.gmail.com>
Message-ID: <20090930135759.GA10677@sunshine.barsnick.net>

Hi,

On Wed, Sep 30, 2009 at 15:04:25 +0800, laiyujun wrote:
> least "webcam" and "motion" work well. Maybe the basic reason is the
> obsolete hardware(include CPU and slow USB 1.1).

Exactly. Cameras tend to reduce their features when connected via USB
1.1 instead of 2.0 (or 3.0 ;->). That's why you probably got only
MJPEG.

luvcview -L
would have been the reference application to use to see what this
camera supports. You would then now note the difference with your new
hardware. :)

Moritz


From laurent.pinchart at ideasonboard.com  Wed Sep 30 17:38:09 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 30 Sep 2009 17:38:09 +0200
Subject: [Linux-uvc-devel] Acer Wide LCD Monitor H243HX with inbuilt
	Acer Crystal Eye Web Cam 0458:7066
In-Reply-To: <2a7fc2e80909292344r5413fcd5m2acbb6322a16ea62@mail.gmail.com>
References: <2a7fc2e80909292344r5413fcd5m2acbb6322a16ea62@mail.gmail.com>
Message-ID: <200909301738.09676.laurent.pinchart@ideasonboard.com>

Hi,

On Wednesday 30 September 2009 08:44:32 Deadpan110 wrote:
> Hello list,
> 
> Not sure if this web cam is on the list yet so I figured I would post it
>  anyway.

Nope it's not on the list. Thanks for the report.

[snip]

> dmesg | egrep -i uvc
> [    8.632246] uvcvideo: Found UVC 1.00 device Acer Crystal Eye Webcam 
> (0458:7066)
> [    8.819419] usbcore: registered new interface driver uvcvideo
> [  170.525661] uvcvideo: Failed to set UVC probe control : -32 (exp. 26).
> [  170.628834] uvcvideo: Failed to set UVC commit control : -32 (exp. 26).
> [  183.334338] uvcvideo: Failed to set UVC commit control : -32 (exp. 26).
> [  222.627742] uvcvideo: Failed to set UVC commit control : -32 (exp. 26).

Now this one is bad :-( The camera seems to be pretty broken. It stall a set 
UVC probe control request and that definitely shouldn't happen.

The stall might be caused by a camera firmware crash during the processing of 
the previous request. Could you please unplug the camera, replug it and run 
luvcview ? Please report luvcview's log as well as the content of the kernel 
log. If the problem still occurs, taking a USB trace under Windows would 
probably be the easiest way to debug it.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Wed Sep 30 17:59:04 2009
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Wed, 30 Sep 2009 17:59:04 +0200
Subject: [Linux-uvc-devel]
 =?iso-8859-15?q?Why_can=27t_set_format_after=09?=
 =?iso-8859-15?q?VIDIOC=5FSTREAMINGOFF=3F?=
In-Reply-To: <4AC1B164.1010104@redhat.com>
References: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>
	<200909290055.17588.laurent.pinchart@ideasonboard.com>
	<4AC1B164.1010104@redhat.com>
Message-ID: <200909301759.04436.laurent.pinchart@ideasonboard.com>

Hi Hans,

On Tuesday 29 September 2009 09:04:04 Hans de Goede wrote:
> On 09/29/2009 12:55 AM, Laurent Pinchart wrote:
[snip]
> > That's the right way to do it, and it should work.
> >
> > ioctl(VIDIOC_S_FMT)
> > ioctl(VIDIOC_REQBUFS - n buffers)
> > mmap()
> > ioctl(VIDIOC_QBUF)
> > ioctl(VIDIOC_STREAMON)
> > ioctl(VIDIOC_DQBUF)
> > ioctl(VIDIOC_QBUF)
> > ...
> > ioctl(VIDIOC_STREAMOFF)
> > munmap()
> > ioctl(VIDIOC_REQBUFS - 0 buffers)
> 
> Note that the need for this last call (VIDIOC_REQBUFS - 0 buffers), also
> known as unrequesting the buffers, is a bit ambiguous. Not all drivers
> need this, and some even return an EINVAL if the number of requested
> buffers < 0.

The number of buffers can't be < 0 as it's a __u32. Drivers will see a huge 
integer, and should lower the number of requested buffers instead of returning 
-EINVAL.

Or did you mean they return EINVAL when the number of buffers is == 0 ? In 
that case they should really be fixed to free the buffers.

> I think we need to clarify the V4L2 API specification on this point.

I agree. v4l2_requestbuffers::count is documented as being used for 
V4L2_MEMORY_MMAP only, and drivers use it for V4L2_MEMORY_USERPTR as well. 
This needs to be fixed in the spec too.

> libv4l currently does do the unrequest the buffers thingie (when it is
>  managing the buffers itself), but ignores the return value.

Do you know which drivers fail to free the buffers when the requested value is 
equal to zero ?

-- 
Regards,

Laurent Pinchart


From hdegoede at redhat.com  Wed Sep 30 22:11:43 2009
From: hdegoede at redhat.com (Hans de Goede)
Date: Wed, 30 Sep 2009 22:11:43 +0200
Subject: [Linux-uvc-devel] Why can't set format after
	VIDIOC_STREAMINGOFF?
In-Reply-To: <200909301759.04436.laurent.pinchart@ideasonboard.com>
References: <COL115-W4429F4952FF75AD106AA3F9FDA0@phx.gbl>
	<200909290055.17588.laurent.pinchart@ideasonboard.com>
	<4AC1B164.1010104@redhat.com>
	<200909301759.04436.laurent.pinchart@ideasonboard.com>
Message-ID: <4AC3BB7F.8080000@redhat.com>

Hi,

On 09/30/2009 05:59 PM, Laurent Pinchart wrote:
> Hi Hans,
>
> On Tuesday 29 September 2009 09:04:04 Hans de Goede wrote:
>> On 09/29/2009 12:55 AM, Laurent Pinchart wrote:
> [snip]
>>> That's the right way to do it, and it should work.
>>>
>>> ioctl(VIDIOC_S_FMT)
>>> ioctl(VIDIOC_REQBUFS - n buffers)
>>> mmap()
>>> ioctl(VIDIOC_QBUF)
>>> ioctl(VIDIOC_STREAMON)
>>> ioctl(VIDIOC_DQBUF)
>>> ioctl(VIDIOC_QBUF)
>>> ...
>>> ioctl(VIDIOC_STREAMOFF)
>>> munmap()
>>> ioctl(VIDIOC_REQBUFS - 0 buffers)
>>
>> Note that the need for this last call (VIDIOC_REQBUFS - 0 buffers), also
>> known as unrequesting the buffers, is a bit ambiguous. Not all drivers
>> need this, and some even return an EINVAL if the number of requested
>> buffers<  0.
>
> The number of buffers can't be<  0 as it's a __u32. Drivers will see a huge
> integer, and should lower the number of requested buffers instead of returning
> -EINVAL.
>
> Or did you mean they return EINVAL when the number of buffers is == 0 ? In
> that case they should really be fixed to free the buffers.
>

Yes I meant < 1, so == 0, sorry.

>> I think we need to clarify the V4L2 API specification on this point.
>
> I agree. v4l2_requestbuffers::count is documented as being used for
> V4L2_MEMORY_MMAP only, and drivers use it for V4L2_MEMORY_USERPTR as well.
> This needs to be fixed in the spec too.
>
>> libv4l currently does do the unrequest the buffers thingie (when it is
>>   managing the buffers itself), but ignores the return value.
>
> Do you know which drivers fail to free the buffers when the requested value is
> equal to zero ?
>

I wanted to answer atleast gspca, but that seems to have been fixed :)
So maybe I'm wrong and now a days most drivers do support the unrequest.

Regards,

Hans


