From juhovh at iki.fi  Wed Apr  1 14:40:29 2009
From: juhovh at iki.fi (Juho V?h?-Herttua)
Date: Wed,  1 Apr 2009 15:40:29 +0300
Subject: [Linux-uvc-devel] SiGma Micro webcam and skype
In-Reply-To: <200903302313.27896.laurent.pinchart@skynet.be>
References: <784432.59425.qm@web111507.mail.gq1.yahoo.com>
	<200903302313.27896.laurent.pinchart@skynet.be>
Message-ID: <20090401154029.qg31lckv4ko0k0go@webmail1.tkk.fi>

?? Laurent Pinchart <laurent.pinchart at skynet.be>?
>> I got the latest source of uvcvideo in here and compiled then install it.
>>
>> http://linuxtv.org/hg/~pinchartl/uvcvideo/archive/tip.tar.gz
>>
>> Afterwards cheese was already ok, ekiga works as before.
>
> So this is an improvement :-)

I believe this is because of the latest auto control patch that is  
missing from Ubuntu 8.10. By the way could mention contributors in the  
patch comments, that's what I try to do in other projects at least if  
I commit patches modified or sent by others.

>> But i do hope to be able to use it with skype though.
>
> Skype is a closed-source software. As such it can't be properly supported by
> open-source software developers. You should contact Skype's technical support
> for help. You might also want to search through the mailing list archive, I
> know that several people had issues with Skype and were able to solve them.

The problem is that this camera only supports MJPEG and Skype wants  
YUV format. I have got Skype working on Ubuntu 8.10 by using the  
gstfakevideo hack (google for more info), but even then it doesn't  
work perfectly. Also the sound input needs to be set to ALSA because  
pulseaudio+skype sucks as well. In general Skype is a bit crappy.


Juho




From caioromao at gmail.com  Thu Apr  9 21:39:46 2009
From: caioromao at gmail.com (=?ISO-8859-1?Q?Caio_Rom=E3o?=)
Date: Thu, 9 Apr 2009 16:39:46 -0300
Subject: [Linux-uvc-devel] Working unlisted UVC device
In-Reply-To: <9b6f17eb0904091233n362f694as61fe7655c23c354b@mail.gmail.com>
References: <9b6f17eb0904091233n362f694as61fe7655c23c354b@mail.gmail.com>
Message-ID: <9b6f17eb0904091239x592aa64dl8bcb931f21d42411@mail.gmail.com>

Hello there,

I've just received a netbook which has a built-in usb camera.

$ dmesg
uvcvideo: Found UVC 1.00 device <unnamed> (eb1a:2771)
input: UVC Camera (eb1a:2771) as
/devices/pci0000:00/0000:00:1d.7/usb1/1-3/1-3:1.0/input/input12

It's an Intelbras Iplug branded netbook which I belive is simply a
rebrand from the AMtek Elego.

Testing with luvcview worked without any tweak. Are there any tests I
should do to check whether it's fully working?

Regards,


-- 
Caio Rom?o


From kevin.1506 at gmail.com  Sat Apr 11 20:52:00 2009
From: kevin.1506 at gmail.com (Kevin)
Date: Sat, 11 Apr 2009 14:52:00 -0400
Subject: [Linux-uvc-devel] Lenovo U330 WebCam Issue
Message-ID: <e73935a80904111152o4f011305xcf24b061be654496@mail.gmail.com>

Greetings All,

I've got a question for the list:  I've got a Lenovo U330 that I've been
trying to get the webcam working correctly - it displays an image (see
below) but it is inverted.   By reloading the uvcvideo module with the
quirks=2 parameter I've managed to get output with luvcview, cheese and
ekiga, but the image is upside down.

I've been researching the issue and my best guess is that this particular
webcam (sometimes called an Acer Bison) is too new to have actual support
(the Device ID isn't listed, but 5986:0203 is) and I came to a couple of
posts on this list where Laurent seemed to indicate that you a userspace fix
to this may have been implemented  in the libv4l(2) library, but I can't
seem to find it.  Do I need to grab the latest source and/or patches and
custom compile a module or is this something coming or <gasp> impossible.

Thanks for your time.

Kevin Reis

Kernel: 2.6.28-11-generic #41-Ubuntu SMP Wed Apr 8 04:39:23 UTC 2009 x86_64
GNU/Linux.
lsub -v:
Bus 001 Device 002: ID 5986:0205 Acer, Inc
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x5986 Acer, Inc
  idProduct          0x0205
  bcdDevice            0.09
  iManufacturer           2 USB Audio Device
  iProduct                1 Lenovo EasyCamera
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          438
    bNumInterfaces          2
    bConfigurationValue     1
:



Thanks for your time.

Regards,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090411/2f6fcc9d/attachment.html>

From jice at free.fr  Mon Apr 13 01:40:12 2009
From: jice at free.fr (Jean-Christophe Jice Cardot)
Date: Sun, 12 Apr 2009 20:40:12 -0300
Subject: [Linux-uvc-devel] SiGma Micro webcam and skype
In-Reply-To: <20090401154029.qg31lckv4ko0k0go@webmail1.tkk.fi>
References: <784432.59425.qm@web111507.mail.gq1.yahoo.com>
	<200903302313.27896.laurent.pinchart@skynet.be>
	<20090401154029.qg31lckv4ko0k0go@webmail1.tkk.fi>
Message-ID: <200904122040.17902.jice@free.fr>

Le mercredi 1 avril 2009, Juho V?h?-Herttua a ?crit :
> ?? Laurent Pinchart <laurent.pinchart at skynet.be>?
>
> >> I got the latest source of uvcvideo in here and compiled then install
> >> it.
> >>
> >> http://linuxtv.org/hg/~pinchartl/uvcvideo/archive/tip.tar.gz
> >>
> >> Afterwards cheese was already ok, ekiga works as before.
> >
> > So this is an improvement :-)
>
> I believe this is because of the latest auto control patch that is
> missing from Ubuntu 8.10. By the way could mention contributors in the
> patch comments, that's what I try to do in other projects at least if
> I commit patches modified or sent by others.
>
> >> But i do hope to be able to use it with skype though.
> >
> > Skype is a closed-source software. As such it can't be properly supported
> > by open-source software developers. You should contact Skype's technical
> > support for help. You might also want to search through the mailing list
> > archive, I know that several people had issues with Skype and were able
> > to solve them.
>
> The problem is that this camera only supports MJPEG and Skype wants
> YUV format. I have got Skype working on Ubuntu 8.10 by using the
> gstfakevideo hack (google for more info), but even then it doesn't
> work perfectly. Also the sound input needs to be set to ALSA because
> pulseaudio+skype sucks as well. In general Skype is a bit crappy.

try libv4l2. works like a charm for me.

export LD_LIBRARY_PATH=/home/fred/compil/libv4l-0.5.0/lib
LD_PRELOAD=/home/fred/compil/libv4l-0.5.0/lib/v4l2convert.so skype

++

-- 
Jean-Christophe "Jic?" Cardot - cofondateur de http://lea-linux.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090412/dfec788b/attachment.pgp>

From laurent.pinchart at skynet.be  Tue Apr 14 16:50:07 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 14 Apr 2009 16:50:07 +0200
Subject: [Linux-uvc-devel] Camera name - what encoding?
In-Reply-To: <49D1387F.4040000@pu-pm.univ-fcomte.fr>
References: <49D0E4B9.3040005@pu-pm.univ-fcomte.fr>
	<200903302311.36239.laurent.pinchart@skynet.be>
	<49D1387F.4040000@pu-pm.univ-fcomte.fr>
Message-ID: <200904141650.08169.laurent.pinchart@skynet.be>

Hi Eugen,

On Monday 30 March 2009 23:24:15 Eugen Dedu wrote:
> Laurent Pinchart wrote:
> > Hi Eugen,
> >
> > On Monday 30 March 2009 17:26:49 Eugen Dedu wrote:
> >> Hi,
> >>
> >> (This e-mail is because we have a bug about a camera name which seems
> >> not to be in utf-8,
> >> https://bugs.launchpad.net/ubuntu/+source/ekiga/+bug/345192?comments=all
> >>)
> >>
> >> For example, I see at
> >>
> >> http://www.mail-archive.com/linux-uvc-
devel at lists.berlios.de/msg01225.html:
> >>> uvcvideo: Found UVC 1.00 device Microsoft? LifeCam NX-6000 (045e:00f8)
> >>
> >> The character ? is in fact trademark/registered.
> >>
> >> My questions: Is this string (camera name) found in the camera or is it
> >> created by uvcvideo?  Is it in utf-8 or another encoding?
> >
> > The string comes directly from the camera where it is encoded in UTF-16.
> > The kernel USB subsystem transcodes it to ISO-8859-1, hence the '?'.
>
> Thanks, Laurent, for the fast reply.

To compensate for the fast reply, here's a late reply :-) Just kidding, I was 
on holidays last week away from my mailbox.

> - Is it true that the name for all the camera come from the camera itself?

It is, unless the camera doesn't provide a name, in which case the driver uses 
the VID:PID.

> - Is it true that all the camera store their name in utf-16?

That's right.

> - Why the kernel usb subsystem transcode them to latin-1 and not to utf-8?

You will have to ask the USB subsystem developers.

> - Do the linux kernel transcodes to latin-1 or it depends on how it was
> configured?  Is it the same for linux, windows and macos?  It's because
> I want to retranscode it to utf-8, and I need to know its current encoding.

The USB subsystem transcodes the UTF-16 strings to Latin-1 regardless of 
configuration options. I have no idea how Windows and MacOS handle that.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue Apr 14 17:03:26 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 14 Apr 2009 17:03:26 +0200
Subject: [Linux-uvc-devel] Working unlisted UVC device
In-Reply-To: <9b6f17eb0904091239x592aa64dl8bcb931f21d42411@mail.gmail.com>
References: <9b6f17eb0904091233n362f694as61fe7655c23c354b@mail.gmail.com>
	<9b6f17eb0904091239x592aa64dl8bcb931f21d42411@mail.gmail.com>
Message-ID: <200904141703.26519.laurent.pinchart@skynet.be>

Hi Caio,

On Thursday 09 April 2009 21:39:46 Caio Rom?o wrote:
> Hello there,
>
> I've just received a netbook which has a built-in usb camera.
>
> $ dmesg
> uvcvideo: Found UVC 1.00 device <unnamed> (eb1a:2771)
> input: UVC Camera (eb1a:2771) as
> /devices/pci0000:00/0000:00:1d.7/usb1/1-3/1-3:1.0/input/input12
>
> It's an Intelbras Iplug branded netbook which I belive is simply a
> rebrand from the AMtek Elego.
>
> Testing with luvcview worked without any tweak. Are there any tests I
> should do to check whether it's fully working?

Thanks for the report. If the camera works properly with luvcview it should 
work with (most) other applications.

Could you please provide me with the output of

lsusb -v -d eb1a:2771

using usbutils 0.72 or newer (0.73+ preferred) ? I will then update the 
supported devices list.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Tue Apr 14 17:15:31 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 14 Apr 2009 17:15:31 +0200
Subject: [Linux-uvc-devel] Lenovo U330 WebCam Issue
In-Reply-To: <e73935a80904111152o4f011305xcf24b061be654496@mail.gmail.com>
References: <e73935a80904111152o4f011305xcf24b061be654496@mail.gmail.com>
Message-ID: <200904141715.31687.laurent.pinchart@skynet.be>

Hi Kevin,

On Saturday 11 April 2009 20:52:00 Kevin wrote:
> Greetings All,
>
> I've got a question for the list:  I've got a Lenovo U330 that I've been
> trying to get the webcam working correctly - it displays an image (see
> below) but it is inverted.   By reloading the uvcvideo module with the
> quirks=2 parameter I've managed to get output with luvcview, cheese and
> ekiga, but the image is upside down.

Could you please provide me with the complete output of

lsusb -v -d 5986:0205

using usbutils 0.72 or newer (0.73+ preferred) ?

Which version of the uvcvideo driver are you using ? Quirk 2 shouldn't be 
needed for most "Bison" webcams anymore. Could you try the latest driver ? 
Instructions to download and compile the driver from sources are available at 
http://linux-uvc.berlios.de/

> I've been researching the issue and my best guess is that this particular
> webcam (sometimes called an Acer Bison) is too new to have actual support
> (the Device ID isn't listed, but 5986:0203 is) and I came to a couple of
> posts on this list where Laurent seemed to indicate that you a userspace
> fix to this may have been implemented  in the libv4l(2) library, but I
> can't seem to find it.  Do I need to grab the latest source and/or patches
> and custom compile a module or is this something coming or <gasp>
> impossible.

Some webcams are mounted upside down, and while they usually support hardware-
based image rotation, that function is most of the time not exposed through 
USB :-/

A userspace library handles image rotation (and more). It might need to be 
updated for your particular webcam model though. You should contact Hans de 
Goede, the libv4l2 author (please CC linux-media at vger.kernel.org).

> Thanks for your time.

You're welcome.

Best regards,

Laurent Pinchart



From caioromao at gmail.com  Wed Apr 15 18:17:04 2009
From: caioromao at gmail.com (=?ISO-8859-1?Q?Caio_Rom=E3o?=)
Date: Wed, 15 Apr 2009 13:17:04 -0300
Subject: [Linux-uvc-devel] Working unlisted UVC device
In-Reply-To: <200904141703.26519.laurent.pinchart@skynet.be>
References: <9b6f17eb0904091233n362f694as61fe7655c23c354b@mail.gmail.com>
	<9b6f17eb0904091239x592aa64dl8bcb931f21d42411@mail.gmail.com>
	<200904141703.26519.laurent.pinchart@skynet.be>
Message-ID: <9b6f17eb0904150917g4ce7d0f8qb44a33c3b15f371@mail.gmail.com>

Hello there,

On Tue, Apr 14, 2009 at 12:03 PM, Laurent Pinchart
<laurent.pinchart at skynet.be> wrote:
<snip>
> Could you please provide me with the output of
>
> lsusb -v -d eb1a:2771
>
> using usbutils 0.72 or newer (0.73+ preferred) ? I will then update the
> supported devices list.
>

Here it is:

# lsusb --version
lsusb (usbutils) 0.73

# lsusb -v -d eb1a:2771
Bus 001 Device 002: ID eb1a:2771 eMPIA Technology, Inc.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0xeb1a eMPIA Technology, Inc.
  idProduct          0x2771
  bcdDevice            3.28
  iManufacturer           0
  iProduct                0
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          591
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              0
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           80
        dwClockFrequency        6.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x000200a2
          Auto-Exposure Mode
          Focus (Absolute)
          Iris (Absolute)
          Focus, Auto
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000147f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x1d
          None
          PAL - 625/50
          SECAM - 625/50
          NTSC - 625/50
      VideoControl Interface Descriptor:
        bLength                29
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {2652215a-8932-5641-894a-5c557cdf9664}
        bNumControl             4
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            4
        bmControls( 0)       0xff
        bmControls( 1)       0xff
        bmControls( 2)       0xff
        bmControls( 3)       0xff
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               4
        iTerminal               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                        2
        wTotalLength                      457
        bEndPointAddress                  130
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     1
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
        bmaControls( 1)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                6
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                3389521920
        dwMaxBitRate                3389521920
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                3103785120
        dwMaxBitRate                3103785120
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                2348810400
        dwMaxBitRate                2348810400
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                3858890880
        dwMaxBitRate                3858890880
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                   655360
        dwMaxBitRate                   655360
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval        1250000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1250000
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                6
        guidFormat
{55595659-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                3389521920
        dwMaxBitRate                3389521920
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                838992000
        dwMaxBitRate                838992000
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                3103785120
        dwMaxBitRate                3103785120
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                2348810400
        dwMaxBitRate                2348810400
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                3858890880
        dwMaxBitRate                3858890880
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  1
        dwFrameInterval( 0)            333333
      VideoStreaming Interface Descriptor:
        bLength                            30
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         6
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                           1280
        wHeight                          1024
        dwMinBitRate                   655360
        dwMaxBitRate                   655360
        dwMaxVideoFrameBufferSize     2752512
        dwDefaultFrameInterval        1250000
        bFrameIntervalType                  1
        dwFrameInterval( 0)           1250000
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               1
        wWidth( 0)                       1280
        wHeight( 0)                      1024
        bNumCompressionPatterns             1
        bCompression( 0)                    0
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)


Regards,

-- 
Caio Rom?o


From khashayar.lists at gmail.com  Fri Apr 17 20:32:21 2009
From: khashayar.lists at gmail.com (Khashayar Naderehvandi)
Date: Fri, 17 Apr 2009 20:32:21 +0200
Subject: [Linux-uvc-devel] rotate image quirk
In-Reply-To: <200903241509.02579.laurent.pinchart@skynet.be>
References: <78f5d6bf0903240023j7b2a35a7w2144543b3c7ed4d7@mail.gmail.com>
	<200903241405.43310.laurent.pinchart@skynet.be>
	<78f5d6bf0903240654m7b5a61d3i581fef610c8f485a@mail.gmail.com>
	<200903241509.02579.laurent.pinchart@skynet.be>
Message-ID: <fca60f3a0904171132o935cf93jd58943930c1fa51e@mail.gmail.com>

>> Is there any way to rotate image globally for whole system from userspace?
>
> The goal was, if I remember well, to have rotation implemented in a completely
> transparent way for userspace applications. The applications will, of course,
> have to use libv4l(2).
>
> libv4l(2) should detect that the device requires rotation (based on the USB
> VID:PID) and rotate the image in software if hardware rotation isn't
> supported.
>
That is great news!

Is this already implemented? I'm using Ubuntu 9.04 right now, and
there is no webcam application that automatically rotates the image
from my camera. I'm not sure which applications use libv4l2, but I've
tried at least cheese and skype. If the function indeed is
implemented, I assume the libv4l2 people are not aware of this camera.
How can I forward the information needed to them? FYI, the laptop I'm
using is an Asus N20A, and the camera is identified as:
Bus 002 Device 003: ID 064e:a116 Suyin Corp.

Thanks a lot!

Regards, K.


From lescopc at esiee.fr  Sat Apr 18 19:29:32 2009
From: lescopc at esiee.fr (lescopc at esiee.fr)
Date: Sat, 18 Apr 2009 19:29:32 +0200 (CEST)
Subject: [Linux-uvc-devel] URBs and user buffers (uvc_queue.c)
In-Reply-To: <200903191430.32112.laurent.pinchart@skynet.be>
References: <60402.194.3.40.246.1237211015.squirrel@mail2.esiee.fr>
	<200903181352.30555.laurent.pinchart@skynet.be>
	<34834.194.3.40.246.1237451227.squirrel@mail2.esiee.fr>
	<200903191430.32112.laurent.pinchart@skynet.be>
Message-ID: <49301.81.185.151.144.1240075772.squirrel@mail2.esiee.fr>

Hello everyone,

I am using the webcam to do some traking. I noticed some latency during
fast motion.

For example, with luvcview, when I do a movement with my hand and stop, I
can see my hand on the screen trying to catch up and stops about 1 sec
after I actually stopped.

In the source code, I saw that Laurent Pinchart uses 4 user buffers. I am
pretty sure they are not the main reason of this latency. So, I went
through the uvcvideo driver source code and I saw that is is also 5 URBs.

If I understood well, URBs are for IRQs.
Is there a minimum of URBs to use?

Is there a way to not use any user buffer (in the queue->mainqueue)?
Or basically, what is the minimale configuration?
(2URBs & 2user buffers)?
(2URBs & 0user buffers)?
(0URBs & 2user buffers)?
(1URBs & 1user buffers)?

Thank you very much again!


C?dric Lescop



From pj.assis at gmail.com  Sun Apr 19 01:05:47 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Sun, 19 Apr 2009 00:05:47 +0100
Subject: [Linux-uvc-devel] Fwd:  rotate image quirk
In-Reply-To: <59cf47a80904181602h7ee6120drf9195639a3715ec0@mail.gmail.com>
References: <78f5d6bf0903240023j7b2a35a7w2144543b3c7ed4d7@mail.gmail.com>
	<200903241405.43310.laurent.pinchart@skynet.be>
	<78f5d6bf0903240654m7b5a61d3i581fef610c8f485a@mail.gmail.com>
	<200903241509.02579.laurent.pinchart@skynet.be>
	<fca60f3a0904171132o935cf93jd58943930c1fa51e@mail.gmail.com>
	<59cf47a80904181602h7ee6120drf9195639a3715ec0@mail.gmail.com>
Message-ID: <59cf47a80904181605l44fe4604vcbc76bd8d320e6f6@mail.gmail.com>

Baah, I did it again,
Here's copy to the list,

PS: Can someone configure the list so that a reply goes to the list and not
the original sender?
Other mailing lists do this, so it shouldn't be that hard.


Hi,


> >
> That is great news!
>
> Is this already implemented? I'm using Ubuntu 9.04 right now, and
> there is no webcam application that automatically rotates the image
> from my camera.


This is not true, guvcview can rotate, flip and do a lot of other stuff. You
can grab a jaunty deb from my ppa, just check guvcview home page for
details, and change the intrepid references to jaunty.

Best regards,
Paulo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090419/6f49608b/attachment.html>

From Eugen.Dedu at pu-pm.univ-fcomte.fr  Mon Apr 20 16:25:13 2009
From: Eugen.Dedu at pu-pm.univ-fcomte.fr (Eugen Dedu)
Date: Mon, 20 Apr 2009 16:25:13 +0200
Subject: [Linux-uvc-devel] Camera name - what encoding?
In-Reply-To: <200904141650.08169.laurent.pinchart@skynet.be>
References: <49D0E4B9.3040005@pu-pm.univ-fcomte.fr>
	<200903302311.36239.laurent.pinchart@skynet.be>
	<49D1387F.4040000@pu-pm.univ-fcomte.fr>
	<200904141650.08169.laurent.pinchart@skynet.be>
Message-ID: <49EC85C9.9010302@pu-pm.univ-fcomte.fr>

Laurent Pinchart wrote:
> Hi Eugen,
> 
> On Monday 30 March 2009 23:24:15 Eugen Dedu wrote:
>> Laurent Pinchart wrote:
>>> Hi Eugen,
>>>
>>> On Monday 30 March 2009 17:26:49 Eugen Dedu wrote:
>>>> Hi,
>>>>
>>>> (This e-mail is because we have a bug about a camera name which seems
>>>> not to be in utf-8,
>>>> https://bugs.launchpad.net/ubuntu/+source/ekiga/+bug/345192?comments=all
>>>> )
>>>>
>>>> For example, I see at
>>>>
>>>> http://www.mail-archive.com/linux-uvc-
> devel at lists.berlios.de/msg01225.html:
>>>>> uvcvideo: Found UVC 1.00 device Microsoft? LifeCam NX-6000 (045e:00f8)
>>>> The character ? is in fact trademark/registered.
>>>>
>> - Why the kernel usb subsystem transcode them to latin-1 and not to utf-8?
> 
> You will have to ask the USB subsystem developers.

Hi Laurent,

Thanks again for your answer!

Answer: "Because the code was written that way originally and nobody has 
ever
changed it.  This may sound facetious, but it is the simple truth."

You can see the answer at http://news.gmane.org/gmane.linux.usb.general, 
look at "latin-1 encoding" thread.

>> - Do the linux kernel transcodes to latin-1 or it depends on how it was
>> configured?  Is it the same for linux, windows and macos?  It's because
>> I want to retranscode it to utf-8, and I need to know its current encoding.
> 
> The USB subsystem transcodes the UTF-16 strings to Latin-1 regardless of 
> configuration options. I have no idea how Windows and MacOS handle that.

For info, Windows uses utf-8.

Cheers!
-- 
Eugen


From khashayar.lists at gmail.com  Mon Apr 20 18:29:59 2009
From: khashayar.lists at gmail.com (Khashayar Naderehvandi)
Date: Mon, 20 Apr 2009 18:29:59 +0200
Subject: [Linux-uvc-devel] Fwd: rotate image quirk
In-Reply-To: <59cf47a80904181605l44fe4604vcbc76bd8d320e6f6@mail.gmail.com>
References: <78f5d6bf0903240023j7b2a35a7w2144543b3c7ed4d7@mail.gmail.com>
	<200903241405.43310.laurent.pinchart@skynet.be>
	<78f5d6bf0903240654m7b5a61d3i581fef610c8f485a@mail.gmail.com>
	<200903241509.02579.laurent.pinchart@skynet.be>
	<fca60f3a0904171132o935cf93jd58943930c1fa51e@mail.gmail.com>
	<59cf47a80904181602h7ee6120drf9195639a3715ec0@mail.gmail.com>
	<59cf47a80904181605l44fe4604vcbc76bd8d320e6f6@mail.gmail.com>
Message-ID: <fca60f3a0904200929j66a59316ldad8f4ca02c2cd0b@mail.gmail.com>

On Sun, Apr 19, 2009 at 1:05 AM, Paulo Assis <pj.assis at gmail.com> wrote:
>
> Baah, I did it again,
> Here's copy to the list,
>
> PS: Can someone configure the list so that a reply goes to the list and not
> the original sender?
> Other mailing lists do this, so it shouldn't be that hard.
>
>
> Hi,
>
>>
>> >
>> That is great news!
>>
>> Is this already implemented? I'm using Ubuntu 9.04 right now, and
>> there is no webcam application that automatically rotates the image
>> from my camera.
>
> This is not true, guvcview can rotate, flip and do a lot of other stuff. You
> can grab a jaunty deb from my ppa, just check guvcview home page for
> details, and change the intrepid references to jaunty.
>
I might have misunderstood something, but I thought the idea was that
any application that makes use of libv4l2, would _automatically_ flip
the image if the camera is known to be mounted upside down.

Some applications can obviously flip the image as a sort of effect,
but other applications don't have that as an option. And even if they
do, they at least default to showing an upside-down image. I was
hoping for a system that takes care of the image transparently and
out-of-the-box, so to speak. But that's not supposed to be the case
then?

Regards,
K.


From laurent.pinchart at skynet.be  Mon Apr 20 19:41:33 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 20 Apr 2009 19:41:33 +0200
Subject: [Linux-uvc-devel] URBs and user buffers (uvc_queue.c)
In-Reply-To: <49301.81.185.151.144.1240075772.squirrel@mail2.esiee.fr>
References: <60402.194.3.40.246.1237211015.squirrel@mail2.esiee.fr>
	<200903191430.32112.laurent.pinchart@skynet.be>
	<49301.81.185.151.144.1240075772.squirrel@mail2.esiee.fr>
Message-ID: <200904201941.33931.laurent.pinchart@skynet.be>

Hi C?dric,

On Saturday 18 April 2009 19:29:32 lescopc at esiee.fr wrote:
> Hello everyone,
>
> I am using the webcam to do some traking. I noticed some latency during
> fast motion.
>
> For example, with luvcview, when I do a movement with my hand and stop, I
> can see my hand on the screen trying to catch up and stops about 1 sec
> after I actually stopped.
>
> In the source code, I saw that Laurent Pinchart uses 4 user buffers. I am
> pretty sure they are not the main reason of this latency. So, I went
> through the uvcvideo driver source code and I saw that is is also 5 URBs.
>
> If I understood well, URBs are for IRQs.
> Is there a minimum of URBs to use?

URB stands for USB Request Block. See 
http://www.mjmwired.net/kernel/Documentation/usb/URB.txt for more information.

> Is there a way to not use any user buffer (in the queue->mainqueue)?
> Or basically, what is the minimale configuration?
> (2URBs & 2user buffers)?
> (2URBs & 0user buffers)?
> (0URBs & 2user buffers)?
> (1URBs & 1user buffers)?

You definitely need both URBs and V4L2 buffers, otherwise no data will be 
transferred at all (this will get rid of latency, but probably not the way you 
want it to :-)).

Decreasing the number of URBs or buffers will not reduce latency per se. 
Isochronous URBs (I assume your device uses an isochronous endpoint to stream 
video data) group several isochronous packet transfers. The more packets per 
URB, the bigger the delay between uvcvideo driver video completion callbacks. 
However, this only matters for the last URB of each frame, as the driver has 
to wait until the end of frame before handing it to the application.

For example, when using 32 packets per URB, there can be at most a 31 packets 
delay between the last packet of a frame and the time the completion callback 
is called. This introduces latency.

Lowering the number of packets per URB will reduce latency, but will also eats 
CPU cycles. Make sure you increase the number of URBs if you reduce the number 
of packets, otherwise you might lose packets if the CPU doesn't cope with the 
higher number of interrupts.

Similarly, V4L2 buffers don't introduce latency. They are used to transfer 
video data between the driver and the userspace application in such a way that 
short temporary increases in the userspace processing delay doesn't result in 
frame loss. The buffer queue can, however, hold frames, making latency more 
noticeable if the application can't cope with incoming data fast enough.

As a summary, latency is the sum of

- camera latency
- USB transfer time
- interrupt latency on the host (lowering the number of packets per URB can 
reduce this)
- userspace application latency

The first thing to do, before hacking the driver, is to make sure the 
userspace application is fast enough and can cope with the frame rate. If it 
can't, you could drop a frame from times to times.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Mon Apr 20 20:04:31 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Mon, 20 Apr 2009 20:04:31 +0200
Subject: [Linux-uvc-devel] Fwd:  rotate image quirk
In-Reply-To: <59cf47a80904181605l44fe4604vcbc76bd8d320e6f6@mail.gmail.com>
References: <78f5d6bf0903240023j7b2a35a7w2144543b3c7ed4d7@mail.gmail.com>
	<59cf47a80904181602h7ee6120drf9195639a3715ec0@mail.gmail.com>
	<59cf47a80904181605l44fe4604vcbc76bd8d320e6f6@mail.gmail.com>
Message-ID: <200904202004.31421.laurent.pinchart@skynet.be>

On Sunday 19 April 2009 01:05:47 Paulo Assis wrote:
> Baah, I did it again,
> Here's copy to the list,
>
> PS: Can someone configure the list so that a reply goes to the list and not
> the original sender?
> Other mailing lists do this, so it shouldn't be that hard.

http://www.unicom.com/pw/reply-to-harmful.html
http://www.metasystema.net/essays/reply-to.mhtml

Even simple questions can turn into a hot flame war :-)

Laurent Pinchart



From pj.assis at gmail.com  Tue Apr 21 11:00:25 2009
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 21 Apr 2009 10:00:25 +0100
Subject: [Linux-uvc-devel] Fwd: rotate image quirk
In-Reply-To: <200904202004.31421.laurent.pinchart@skynet.be>
References: <78f5d6bf0903240023j7b2a35a7w2144543b3c7ed4d7@mail.gmail.com>
	<59cf47a80904181602h7ee6120drf9195639a3715ec0@mail.gmail.com>
	<59cf47a80904181605l44fe4604vcbc76bd8d320e6f6@mail.gmail.com>
	<200904202004.31421.laurent.pinchart@skynet.be>
Message-ID: <59cf47a80904210200y469fbdc8gb68f8b9b8341bc94@mail.gmail.com>

Laurent,

2009/4/20 Laurent Pinchart <laurent.pinchart at skynet.be>

> On Sunday 19 April 2009 01:05:47 Paulo Assis wrote:
> > Baah, I did it again,
> > Here's copy to the list,
> >
> > PS: Can someone configure the list so that a reply goes to the list and
> not
> > the original sender?
> > Other mailing lists do this, so it shouldn't be that hard.
>
> http://www.unicom.com/pw/reply-to-harmful.html
> http://www.metasystema.net/essays/reply-to.mhtml
>
> Even simple questions can turn into a hot flame war :-)
>
> Laurent Pinchart
>
>
I don't want to start any type of war here, I'm really a very peace loving
guy.
If I'm the only one that misses this, than let it be.
Gmail and firefox have a reply to all button, but if I use it (like I'm
doing right now), the original sender will receive the message twice. It's
OK for me, but I doubt the sender will feel the same way.

Best regards,
Paulo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090421/297ba123/attachment.html>

From laurent.pinchart at skynet.be  Tue Apr 21 20:46:12 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Tue, 21 Apr 2009 20:46:12 +0200
Subject: [Linux-uvc-devel] Working unlisted UVC device
In-Reply-To: <9b6f17eb0904150917g4ce7d0f8qb44a33c3b15f371@mail.gmail.com>
References: <9b6f17eb0904091233n362f694as61fe7655c23c354b@mail.gmail.com>
	<200904141703.26519.laurent.pinchart@skynet.be>
	<9b6f17eb0904150917g4ce7d0f8qb44a33c3b15f371@mail.gmail.com>
Message-ID: <200904212046.13342.laurent.pinchart@skynet.be>

Hi,

On Wednesday 15 April 2009 18:17:04 Caio Rom?o wrote:
> Hello there,
>
> On Tue, Apr 14, 2009 at 12:03 PM, Laurent Pinchart
> <laurent.pinchart at skynet.be> wrote:
> <snip>
>
> > Could you please provide me with the output of
> >
> > lsusb -v -d eb1a:2771
> >
> > using usbutils 0.72 or newer (0.73+ preferred) ? I will then update the
> > supported devices list.
>
> Here it is:

[snip]

Device list updated, thanks.

Regards,

Laurent Pinchart



From fabian-linuxuvc at progra.de  Wed Apr 22 12:14:32 2009
From: fabian-linuxuvc at progra.de (Fabian)
Date: Wed, 22 Apr 2009 12:14:32 +0200
Subject: [Linux-uvc-devel] HP 3 Megapixelcamera working but how to control
	the focus?
Message-ID: <49EEEE08.4050303@progra.de>

Hi,

I just bought a HP Elite Autofocus Webcam and it works out of the box
on Ubuntu Intrepid Ibex!
Now I'm trying to manually control the focus/exposure with no success so 
far.
I believe its the same as with the Quickcam Pro 9000 where one has to 
dynamically add the controls at runtime. Unfortunately there is no
documentation from HP about anything. :(
Is there any chance on finding out the correct parameters to add the 
vendor specific controls?
The focus and exposure can be controlled under windows with the software 
that ships with the camera (ArcSoft Webcam Companion). Furthermore I was 
able to control the focus through the DirectShow IAMCameraControl interface.
Any tips on how to reverse engineer this?

Cheers,
Fabian
==========================
Output from dmesg:

> [1818455.977368] uvcvideo: Found UVC 1.00 device HP 3-MegaPixel Webcam GX607AA (0ac8:c315)
> [1818455.978045] input: HP 3-MegaPixel Webcam GX607AA as /devices/pci0000:00/0000:00:1a.7/usb3/3-3/3-3:1.0/input/input9

Output from luvcview -l:
 > [...]
> Available controls of device 'Camera 1' (Type 1=Integer 2=Boolean 3=Menu 4=Button)
> V4L2_CID_BASE         (predefined controls):                                      
>  index:9963776    name:Brightness                       type:1 min:-16   max:16    step:1     def:0     now:0
>  index:9963777    name:Contrast                         type:1 min:1     max:32    step:1     def:16    now:16
>  index:9963778    name:Saturation                       type:1 min:0     max:15    step:1     def:5     now:5 
>  index:9963779    name:Hue                              type:1 min:-45   max:45    step:1     def:0     now:0 
>  index:9963788    name:White Balance Temperature, Auto  type:2 min:0     max:1     step:1     def:1     now:1 
>  index:9963792    name:Gamma                            type:1 min:100   max:200   step:10    def:170   now:170
>  index:9963795    name:Gain                             type:1 min:64    max:160   step:1     def:96    now:96 
> V4L2_CID_PRIVATE_BASE (driver specific controls):                                                              
> Ignoring empty buffer ...                                                                                      
> find DRI                                                                                                       
> find DRI                
> [...]




From chengh06 at gmail.com  Wed Apr 22 18:20:29 2009
From: chengh06 at gmail.com (chengh06)
Date: Thu, 23 Apr 2009 00:20:29 +0800
Subject: [Linux-uvc-devel] hello
Message-ID: <200904230020276871931@gmail.com>

Hello!
     I am a student from china. Now I need your help.
     My OS is ubuntu and I use Philips SPC 1300NC, I set three parameters "white balance, exposure and gain" to the camera.(we use to use logitech Pro 5000 before, and we set the three parameters). But there were some errors.
     "uvcvideo: Failed to query (1) UVC control 10 (unit 3) : -32(exp.2) ."
     Do you know about the problems?
     I am waiting for your answers.

Best regards
Cheng

2009-04-23 



chengh06 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090423/81502325/attachment.html>

From dag at newtech.fi  Thu Apr 23 08:35:22 2009
From: dag at newtech.fi (Dag Nygren)
Date: Thu, 23 Apr 2009 09:35:22 +0300
Subject: [Linux-uvc-devel] Any progress on ARKMICRO (18ec:3288) ?
Message-ID: <20090423093522.6ndjml20skc0c8kc@www.newtech.fi>

Hi there

  Found a tread from Jan 09 about this webcam. I now have one here and  
it also generates
  invalid jpeg data.
  Has there been any progress on this recetly?

  Best
  Dag

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From zorgh at koysevox.org  Sun Apr 26 09:22:30 2009
From: zorgh at koysevox.org (Zorgh)
Date: Sun, 26 Apr 2009 09:22:30 +0200
Subject: [Linux-uvc-devel] VIDIOC_DQBUF<7>uvcvideo: Dropping payload (out of
	sync)
Message-ID: <49F40BB6.3020906@koysevox.org>

Hi,

I'm trying to install ARtoolkit on Ubuntu 8.10 "Intrepid" (Linux 
2.6.27-11-generic on x86_64).

The uvcvideo driver implements the Video4Linux 2 (V4L2) API. V4L1 is not 
supported.

I applied a patch to add support for Video 4 Linux 2 devices into the 
artoolkit based on the artk 2.72.1 tarball.

ubuntu at ubuntu:/tmp$ v4l-info

### v4l2 device info [/dev/video0] ###
general info
    VIDIOC_QUERYCAP
    driver                  : "uvcvideo"
    card                    : "Philips SPC 1330NC"
    bus_info                : "0000:00:1d.7"
    version                 : 0.1.0
    capabilities            : 0x4000001 [VIDEO_CAPTURE,STREAMING]

I succeeded to compile but I get a black window screen :

/ubuntu at ubuntu:/usr/local/ARToolKit/bin$ ./simpleLite
Control 9963793 is not supported
Camera image size (x,y) = (640,480)
*** Camera Parameter ***
--------------------------------------
SIZE = 640, 480
Distortion factor = 318.500000 263.500000 26.200000 1.012757
700.95147 0.00000 316.50000 0.00000
0.00000 726.09418 241.50000 0.00000
0.00000 0.00000 1.00000 0.00000
--------------------------------------
FittingMode (Z): COMPENSATED IMAGE
ProcMode (X)   : FULL IMAGE
DrawMode (C)   : TEXTURE MAPPING (FULL RESOLUTION)
TemplateMatchingMode (M)   : Color Template
MatchingPCAMode (P)   : Without PCA
ar2VideoCapNext: Error calling VIDIOC_QBUF: 22
ar2VideoCapNext: Error calling VIDIOC_QBUF: 22/


A test is not validated in source code :

/if (-1 == ioctl (fd, VIDIOC_QUERYCTRL, &queryctrl)) {
    if (errno != EINVAL) {
      fprintf(stderr, "Error calling VIDIOC_QUERYCTRL\n");
      return 1;
     } else {
       printf ("Control %d is not supported\n", type);
       return 1;
     }
   } else if (queryctrl.flags & V4L2_CTRL_FLAG_DISABLED) {
     printf ("Control %s is not supported\n", queryctrl.name);
     return 1;
   } else {


/In dmesg, I get :

/[98915.123356] uvcvideo: Dropping payload (out of sync).
[98915.123358] uvcvideo: Dropping payload (out of sync).
[98915.125794] uvcvideo: uvc_v4l2_ioctl
[98915.125798] VIDIOC_QBUF<7>uvcvideo: Queuing buffer 1.
[98915.125854] uvcvideo: uvc_v4l2_ioctl
[98915.125856] VIDIOC_DQBUF<7>uvcvideo: Dropping payload (out of sync).
[98915.128281] uvcvideo: Dropping payload (out of sync)./


How can I fix it ?

Thank you very much for your help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090426/a775379a/attachment.html>

From msanchez at eeng.nuim.ie  Wed Apr 29 16:37:33 2009
From: msanchez at eeng.nuim.ie (Magdalena Sanchez)
Date: Wed, 29 Apr 2009 16:37:33 +0200
Subject: [Linux-uvc-devel] uvcvideo r263 does not work in ARM TS-7800
Message-ID: <49F8662D.8030108@eeng.nuim.ie>

Hi all,

I am trying to install uvcvideo for Logitech Webcam Pro 9000 in arm 
linux kernel 2.6.21-ts.

I have used a cross compilation tool to generate the kernel module for 
the target system. But when I tried to load it into the kernel then I 
get the messages at the bottom of this email (system log output). I 
would really appreciate some help.
Does uvcvideo r263 have incompatibilities with ARM architectures?

PLS do not hesitate in contact me if you need further information.

Many thanks,

Magda

SYSTEM LOG OUTPUT:
Unable to handle kernel NULL pointer dereference at virtual address 00000409
pgd = c64d8000
[00000409] *pgd=064d0031, *pte=00000000, *ppte=00000000
Internal error: Oops: 17 [#1]
Modules linked in: uvcvideo videodev v4l1_compat v4l2_common 
compat_ioctl32 zd1211rw firmware_class ieee80211softmac ieee80
211 ieee80211_crypt mvsata vfat fat usbhid sd_mod usb_storage scsi_mod 
libusual tsuart7800 tsuart1 tssdcard ehci_hcd ts7800
 usbcore
CPU: 0
PC is at strncpy+0x18/0x34
LR is at uvc_probe+0x130/0xa3c [uvcvideo]
pc : [<c01639d4>]    lr : [<bf0c5b98>]    Not tainted
sp : c6481d28  ip : c7f32014  fp : c6481d34
r10: c02c8da0  r9 : c10a221c  r8 : c7a06bc0
r7 : c7f32000  r6 : ffffffed  r5 : bf0d05e8  r4 : bf0d0860
r3 : 00000000  r2 : 00000020  r1 : 00000409  r0 : c7f32014
Flags: nzCv  IRQs on  FIQs on  Mode SVC_32  Segment user
Control: B005317F
Table: 064D8000  DAC: 00000015
Process modprobe (pid: 943, stack limit = 0xc6480258)
Stack: (0xc6481d28 to 0xc6482000)
1d20:                   c6481d88 c6481d38 bf0c5b98 c01639cc c6481d44 
c00d4dd0
1d40: c00d4c64 c6481d70 c6481d54 bf007c58 c7f32038 c7f3204c c780b400 
c7e65800
1d60: c7e65800 bf0d05e8 ffffffed 00000000 c7a06bc0 c10a221c c02c8da0 
c6481da8
1d80: c6481d8c bf007e98 bf0c5a78 c7e65818 00000000 c7e65818 bf0d0614 
c6481dd0
1da0: c6481dac c0190b34 bf007e00 bf0d0614 c7a06bc0 c7e65818 00000000 
00000016
1dc0: c88ce000 c6481df0 c6481dd4 c0190cc8 c0190a94 c7e658f0 c7e65818 
c0190d98
1de0: bf0d0614 c6481e08 c6481df4 c0190e1c c0190c20 00000000 c6481e0c 
c6481e38
1e00: c6481e0c c018fcb4 c0190da8 bf01b7dc bf01b7dc c7e65860 c6481e24 
00000000
1e20: bf0d0614 bf0d0628 bf01b6dc c6481e48 c6481e3c c0190ea0 c018fc78 
c6481e70
1e40: c6481e4c c0190318 c0190e8c bf0d0614 00000000 bf0d16e0 bf0cbf68 
00000016
1e60: c88ce000 c6481e88 c6481e74 c01913a4 c01902bc bf0d16d0 bf0d05e8 
c6481eb0
1e80: c6481e8c bf008248 c0191320 bf0cb7e8 bf0cb320 bf0d06c8 00000000 
bf0d16e0
1ea0: c88d9c00 c6481ec4 c6481eb4 bf0d3060 bf0081e4 bf0d16e0 c6481fa4 
c6481ec8
1ec0: c006b834 bf0d3010 00000000 c7e8f1d8 c6481f04 00000348 c0081e14 
c022b930
1ee0: c022b930 00000016 00001650 bf0cf7e4 00000000 00000166 00000166 
00000054
1f00: 00000050 0000003c c6480000 00000000 00000000 00000000 00000000 
00000000
1f20: 00000000 00000000 00000000 00000000 00000000 00000008 00000000 
0000000f
1f40: 00000000 00000000 00000009 00000015 00000014 c88dedd0 c7a06ba0 
c88d9b50
1f60: c6481fa4 c6481f70 00000000 bf01bf00 000001ec 00000034 49f7c346 
0000a8c8
1f80: 0000d0bc 00000000 00000080 c00235e4 c6480000 00900080 00000000 
c6481fa8
1fa0: c0022e00 c006a3ec 0000a8c8 0000d0bc 40132000 00011ba3 00017d60 
00000000
1fc0: 0000a8c8 0000d0bc 00000000 0001a8c8 0001abf0 00000000 0001abfc 
00016050
1fe0: 000158b0 befd7ac8 0000b250 400d418c 60000010 40132000 00000000 
00000000
Backtrace:
[<c01639bc>] (strncpy+0x0/0x34) from [<bf0c5b98>] (uvc_probe+0x130/0xa3c 
[uvcvideo])
[<bf0c5a68>] (uvc_probe+0x0/0xa3c [uvcvideo]) from [<bf007e98>] 
(usb_probe_interface+0xa8/0xe4 [usbcore])
[<bf007df0>] (usb_probe_interface+0x0/0xe4 [usbcore]) from [<c0190b34>] 
(really_probe+0xb0/0x164)
 r7 = BF0D0614  r6 = C7E65818  r5 = 00000000  r4 = C7E65818
[<c0190a84>] (really_probe+0x0/0x164) from [<c0190cc8>] 
(driver_probe_device+0xb8/0xd0)
[<c0190c10>] (driver_probe_device+0x0/0xd0) from [<c0190e1c>] 
(__driver_attach+0x84/0xe4)
 r7 = BF0D0614  r6 = C0190D98  r5 = C7E65818  r4 = C7E658F0
[<c0190d98>] (__driver_attach+0x0/0xe4) from [<c018fcb4>] 
(bus_for_each_dev+0x4c/0x84)
 r5 = C6481E0C  r4 = 00000000
[<c018fc68>] (bus_for_each_dev+0x0/0x84) from [<c0190ea0>] 
(driver_attach+0x24/0x2c)
 r7 = BF01B6DC  r6 = BF0D0628  r5 = BF0D0614  r4 = 00000000
[<c0190e7c>] (driver_attach+0x0/0x2c) from [<c0190318>] 
(bus_add_driver+0x6c/0x1c0)
[<c01902ac>] (bus_add_driver+0x0/0x1c0) from [<c01913a4>] 
(driver_register+0x94/0x9c)
[<c0191310>] (driver_register+0x0/0x9c) from [<bf008248>] 
(usb_register_driver+0x74/0x104 [usbcore])
 r4 = BF0D05E8
[<bf0081d4>] (usb_register_driver+0x0/0x104 [usbcore]) from [<bf0d3060>] 
(uvc_init+0x60/0xbc [uvcvideo])
 r7 = C88D9C00  r6 = BF0D16E0  r5 = 00000000  r4 = BF0D06C8
[<bf0d3000>] (uvc_init+0x0/0xbc [uvcvideo]) from [<c006b834>] 
(sys_init_module+0x1458/0x14f4)
 r4 = BF0D16E0
[<c006a3dc>] (sys_init_module+0x0/0x14f4) from [<c0022e00>] 
(ret_fast_syscall+0x0/0x2c)
Code: e24cb004 e3520000 e1a0c000 089da800 (e5d13000)


From laurent.pinchart at skynet.be  Wed Apr 29 17:04:20 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 17:04:20 +0200
Subject: [Linux-uvc-devel] Fwd: rotate image quirk
In-Reply-To: <59cf47a80904210200y469fbdc8gb68f8b9b8341bc94@mail.gmail.com>
References: <78f5d6bf0903240023j7b2a35a7w2144543b3c7ed4d7@mail.gmail.com>
	<200904202004.31421.laurent.pinchart@skynet.be>
	<59cf47a80904210200y469fbdc8gb68f8b9b8341bc94@mail.gmail.com>
Message-ID: <200904291704.20887.laurent.pinchart@skynet.be>

Hi Paulo,

On Tuesday 21 April 2009 11:00:25 Paulo Assis wrote:
> Laurent,
>
> 2009/4/20 Laurent Pinchart <laurent.pinchart at skynet.be>
>
> > On Sunday 19 April 2009 01:05:47 Paulo Assis wrote:
> > > Baah, I did it again,
> > > Here's copy to the list,
> > >
> > > PS: Can someone configure the list so that a reply goes to the list and
> >
> > not
> >
> > > the original sender?
> > > Other mailing lists do this, so it shouldn't be that hard.
> >
> > http://www.unicom.com/pw/reply-to-harmful.html
> > http://www.metasystema.net/essays/reply-to.mhtml
> >
> > Even simple questions can turn into a hot flame war :-)
> >
> > Laurent Pinchart
>
> I don't want to start any type of war here, I'm really a very peace loving
> guy.

Don't worry, I wasn't implying you were a warlord :-)

> If I'm the only one that misses this, than let it be.
> Gmail and firefox have a reply to all button, but if I use it (like I'm
> doing right now), the original sender will receive the message twice. It's
> OK for me, but I doubt the sender will feel the same way.

That's something each subscribe can configure individually. Berlios mailing 
list preferences have the following parameter:

"Avoid duplicate copies of messages?

When you are listed explicitly in the To: or Cc: headers of a list message, 
you can opt to not receive another copy from the mailing list. Select Yes to 
avoid receiving copies from the mailing list; select No to receive copies. 

If the list has member personalized messages enabled, and you elect to receive 
copies, every copy will have a X-Mailman-Copy: yes header added to it."

This can be used to avoid duplicates. I personally prefer receiving duplicates 
in most cases, as I process personal e-mails faster than mailing list e-mails. 
Other people might not have the same preferences.

Cheers,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Apr 29 17:11:32 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 17:11:32 +0200
Subject: [Linux-uvc-devel] HP 3 Megapixelcamera working but how to
	control the focus?
In-Reply-To: <49EEEE08.4050303@progra.de>
References: <49EEEE08.4050303@progra.de>
Message-ID: <200904291711.32790.laurent.pinchart@skynet.be>

Hi Fabian,

On Wednesday 22 April 2009 12:14:32 Fabian wrote:
> Hi,
>
> I just bought a HP Elite Autofocus Webcam and it works out of the box
> on Ubuntu Intrepid Ibex!
> Now I'm trying to manually control the focus/exposure with no success so
> far.
> I believe its the same as with the Quickcam Pro 9000 where one has to
> dynamically add the controls at runtime. Unfortunately there is no
> documentation from HP about anything. :(
> Is there any chance on finding out the correct parameters to add the
> vendor specific controls?
> The focus and exposure can be controlled under windows with the software
> that ships with the camera (ArcSoft Webcam Companion). Furthermore I was
> able to control the focus through the DirectShow IAMCameraControl
> interface. Any tips on how to reverse engineer this?

First of all, could you please send me the output of

lsusb -v -d 0ac8:c315

using usbutils 0.72 or newer (0.73+ preferred) ? With that information I'll 
see if reverse engineering is required.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Apr 29 17:13:08 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 17:13:08 +0200
Subject: [Linux-uvc-devel] hello
In-Reply-To: <200904230020276871931@gmail.com>
References: <200904230020276871931@gmail.com>
Message-ID: <200904291713.09055.laurent.pinchart@skynet.be>

Hi Cheng,

On Wednesday 22 April 2009 18:20:29 chengh06 wrote:
> Hello!
>      I am a student from china. Now I need your help.
>      My OS is ubuntu and I use Philips SPC 1300NC, I set three parameters
> "white balance, exposure and gain" to the camera.(we use to use logitech
> Pro 5000 before, and we set the three parameters). But there were some
> errors. "uvcvideo: Failed to query (1) UVC control 10 (unit 3) : -32(exp.2)
> ." Do you know about the problems?
>      I am waiting for your answers.

I suppose the same application worked with the Logitech QuickCam Pro 5000 and 
doesn't work anymore with the Philips SPC 1300NC. Is that right ?

Does the same problem occur every time you try to set the control ? Can you 
check which one fails ?

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Apr 29 17:15:40 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 17:15:40 +0200
Subject: [Linux-uvc-devel] Any progress on ARKMICRO (18ec:3288) ?
In-Reply-To: <20090423093522.6ndjml20skc0c8kc@www.newtech.fi>
References: <20090423093522.6ndjml20skc0c8kc@www.newtech.fi>
Message-ID: <200904291715.40714.laurent.pinchart@skynet.be>

On Thursday 23 April 2009 08:35:22 Dag Nygren wrote:
> Hi there
>
> Found a tread from Jan 09 about this webcam. I now have one here and
> it also generates invalid jpeg data.
> Has there been any progress on this recetly?

None that I'm aware of. Could you please capture a few consecutive frames and 
send them to me ? I'd like to have a look at the headers.

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Apr 29 17:28:26 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 17:28:26 +0200
Subject: [Linux-uvc-devel] VIDIOC_DQBUF<7>uvcvideo: Dropping payload
	(out of sync)
In-Reply-To: <49F40BB6.3020906@koysevox.org>
References: <49F40BB6.3020906@koysevox.org>
Message-ID: <200904291728.26751.laurent.pinchart@skynet.be>

Hi,

On Sunday 26 April 2009 09:22:30 Zorgh wrote:
> Hi,
>
> I'm trying to install ARtoolkit on Ubuntu 8.10 "Intrepid" (Linux
> 2.6.27-11-generic on x86_64).
>
> The uvcvideo driver implements the Video4Linux 2 (V4L2) API. V4L1 is not
> supported.
>
> I applied a patch to add support for Video 4 Linux 2 devices into the
> artoolkit based on the artk 2.72.1 tarball.
>
> ubuntu at ubuntu:/tmp$ v4l-info
>
> ### v4l2 device info [/dev/video0] ###
> general info
>     VIDIOC_QUERYCAP
>     driver                  : "uvcvideo"
>     card                    : "Philips SPC 1330NC"
>     bus_info                : "0000:00:1d.7"
>     version                 : 0.1.0
>     capabilities            : 0x4000001 [VIDEO_CAPTURE,STREAMING]
>
> I succeeded to compile but I get a black window screen :
>
> /ubuntu at ubuntu:/usr/local/ARToolKit/bin$ ./simpleLite
> Control 9963793 is not supported
> Camera image size (x,y) = (640,480)
> *** Camera Parameter ***
> --------------------------------------
> SIZE = 640, 480
> Distortion factor = 318.500000 263.500000 26.200000 1.012757
> 700.95147 0.00000 316.50000 0.00000
> 0.00000 726.09418 241.50000 0.00000
> 0.00000 0.00000 1.00000 0.00000
> --------------------------------------
> FittingMode (Z): COMPENSATED IMAGE
> ProcMode (X)   : FULL IMAGE
> DrawMode (C)   : TEXTURE MAPPING (FULL RESOLUTION)
> TemplateMatchingMode (M)   : Color Template
> MatchingPCAMode (P)   : Without PCA
> ar2VideoCapNext: Error calling VIDIOC_QBUF: 22
> ar2VideoCapNext: Error calling VIDIOC_QBUF: 22/



> A test is not validated in source code :
>
> /if (-1 == ioctl (fd, VIDIOC_QUERYCTRL, &queryctrl)) {
>     if (errno != EINVAL) {
>       fprintf(stderr, "Error calling VIDIOC_QUERYCTRL\n");
>       return 1;
>      } else {
>        printf ("Control %d is not supported\n", type);
>        return 1;
>      }
>    } else if (queryctrl.flags & V4L2_CTRL_FLAG_DISABLED) {
>      printf ("Control %s is not supported\n", queryctrl.name);
>      return 1;
>    } else {

ARtoolkit tries to set the V4L2_CID_BLACK_LEVEL control. That control isn't 
supported by your camera (it's actually deprecated), and the driver returns an 
error. Nothing unexpected or wrong here.

> /In dmesg, I get :
>
> /[98915.123356] uvcvideo: Dropping payload (out of sync).
> [98915.123358] uvcvideo: Dropping payload (out of sync).
> [98915.125794] uvcvideo: uvc_v4l2_ioctl
> [98915.125798] VIDIOC_QBUF<7>uvcvideo: Queuing buffer 1.
> [98915.125854] uvcvideo: uvc_v4l2_ioctl
> [98915.125856] VIDIOC_DQBUF<7>uvcvideo: Dropping payload (out of sync).
> [98915.128281] uvcvideo: Dropping payload (out of sync)./
>
> How can I fix it ?

First of all, have you tested your camera with a supported application ? 
luvcview is a good candidate.

The "Dropping payload (out of sync)" messages do not necessarily indicate an 
error. A few of them can be printed when starting video capture, the driver 
just needs to synchronize to the video stream. Do they keep being printed over 
and over or are there only a few of them ?

Best regards,

Laurent Pinchart



From laurent.pinchart at skynet.be  Wed Apr 29 17:36:03 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 17:36:03 +0200
Subject: [Linux-uvc-devel] uvcvideo r263 does not work in ARM TS-7800
In-Reply-To: <49F8662D.8030108@eeng.nuim.ie>
References: <49F8662D.8030108@eeng.nuim.ie>
Message-ID: <200904291736.03604.laurent.pinchart@skynet.be>

Hi Magdalena,

On Wednesday 29 April 2009 16:37:33 Magdalena Sanchez wrote:
> Hi all,
>
> I am trying to install uvcvideo for Logitech Webcam Pro 9000 in arm
> linux kernel 2.6.21-ts.
>
> I have used a cross compilation tool to generate the kernel module for
> the target system. But when I tried to load it into the kernel then I
> get the messages at the bottom of this email (system log output). I
> would really appreciate some help.
> Does uvcvideo r263 have incompatibilities with ARM architectures?

None that I know off (ARM-specific issues have been fixed in r182). However, 
note that the SVN repository is deprecated. Please use a recent version of the 
uvcvideo driver from the hg tree (instructions available from http://linux-
uvc.berlios.de) and try to reproduce the proble.

Best regards,

Laurent Pinchart



From fabian-linuxuvc at progra.de  Wed Apr 29 17:49:59 2009
From: fabian-linuxuvc at progra.de (Fabian)
Date: Wed, 29 Apr 2009 17:49:59 +0200
Subject: [Linux-uvc-devel] HP 3 Megapixelcamera working but how to
 control the focus?
In-Reply-To: <200904291711.32790.laurent.pinchart@skynet.be>
References: <49EEEE08.4050303@progra.de>
	<200904291711.32790.laurent.pinchart@skynet.be>
Message-ID: <49F87727.8090902@progra.de>

Hi,

Laurent Pinchart wrote:
> First of all, could you please send me the output of
> 
> lsusb -v -d 0ac8:c315
> 
> using usbutils 0.72 or newer (0.73+ preferred) ? With that information I'll 
> see if reverse engineering is required.
Et voil?.
This was captured with usbutils 0.73 with root priveleges.

Cheers,
Fabian
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: hp3mp.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090429/528417a1/attachment.txt>

From laurent.pinchart at skynet.be  Wed Apr 29 18:26:20 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Wed, 29 Apr 2009 18:26:20 +0200
Subject: [Linux-uvc-devel] HP 3 Megapixelcamera working but how to
	control the focus?
In-Reply-To: <49F87727.8090902@progra.de>
References: <49EEEE08.4050303@progra.de>
	<200904291711.32790.laurent.pinchart@skynet.be>
	<49F87727.8090902@progra.de>
Message-ID: <200904291826.20392.laurent.pinchart@skynet.be>

Hi Fabian,

On Wednesday 29 April 2009 17:49:59 Fabian wrote:
> Hi,
>
> Laurent Pinchart wrote:
> > First of all, could you please send me the output of
> >
> > lsusb -v -d 0ac8:c315
> >
> > using usbutils 0.72 or newer (0.73+ preferred) ? With that information
> > I'll see if reverse engineering is required.
>
> Et voil?.
> This was captured with usbutils 0.73 with root priveleges.

Thanks.

Your device exposes standard UVC focus and exposure controls. Those should be 
supported out of the box by the driver. Could you please load the uvcvideo 
module with trace set to 15 and send me the messages printed to the kernel log 
after plugging your camera ?

Best regards,

Laurent Pinchart



From dag at newtech.fi  Wed Apr 29 23:07:29 2009
From: dag at newtech.fi (Dag Nygren)
Date: Thu, 30 Apr 2009 00:07:29 +0300
Subject: [Linux-uvc-devel] Any progress on ARKMICRO (18ec:3288) ?
In-Reply-To: <200904291715.40714.laurent.pinchart@skynet.be>
References: <20090423093522.6ndjml20skc0c8kc@www.newtech.fi>
	<200904291715.40714.laurent.pinchart@skynet.be>
Message-ID: <200904300007.29983.dag@newtech.fi>

onsdag 29 april 2009 18:15:40 skrev  Laurent Pinchart:
> On Thursday 23 April 2009 08:35:22 Dag Nygren wrote:
> > Hi there
> >
> > Found a tread from Jan 09 about this webcam. I now have one here and
> > it also generates invalid jpeg data.
> > Has there been any progress on this recetly?
>
> None that I'm aware of. Could you please capture a few consecutive frames
> and send them to me ? I'd like to have a look at the headers.

OK,

I am sorry to say that I already exchanged the camera to one that did work 
directly and so have no possibility of doing it.

Thanks
Dag



From legrain at crans.org  Thu Apr 30 08:00:03 2009
From: legrain at crans.org (Gregory LEGRAIN)
Date: Thu, 30 Apr 2009 08:00:03 +0200
Subject: [Linux-uvc-devel] Strange issue with Hercules Dualpix Infinite
Message-ID: <200904300800.04057.legrain@crans.org>

Hi Laurent,
it seems that my previous mail was buried under tons of other mails during 
your holidays :-)

You asked me to set the trace parameter to 255 when loading the driver. I did 
it, and attached the output with this mail.

Best regards,
Gregory


-------------- next part --------------
uvcvideo: Adding mapping Brightness to control 00000000-0000-0000-0000-000000000101/2.                                                                          
uvcvideo: Adding mapping Contrast to control 00000000-0000-0000-0000-000000000101/3.                                                                            
uvcvideo: Adding mapping Hue to control 00000000-0000-0000-0000-000000000101/6. 
uvcvideo: Adding mapping Saturation to control 00000000-0000-0000-0000-000000000101/7.                                                                          
uvcvideo: Adding mapping Sharpness to control 00000000-0000-0000-0000-000000000101/8.                                                                           
uvcvideo: Adding mapping Gamma to control 00000000-0000-0000-0000-000000000101/9.                                                                               
uvcvideo: Adding mapping Backlight Compensation to control 00000000-0000-0000-0000-000000000101/1.                                                              
uvcvideo: Adding mapping Gain to control 00000000-0000-0000-0000-000000000101/4.
uvcvideo: Adding mapping Power Line Frequency to control 00000000-0000-0000-0000-000000000101/5.                                                                
uvcvideo: Adding mapping Hue, Auto to control 00000000-0000-0000-0000-000000000101/16.                                                                          
uvcvideo: Adding mapping Exposure, Auto to control 00000000-0000-0000-0000-000000000001/2.                                                                      
uvcvideo: Adding mapping Exposure, Auto Priority to control 00000000-0000-0000-0000-000000000001/3.                                                             
uvcvideo: Adding mapping Exposure (Absolute) to control 00000000-0000-0000-0000-000000000001/4.                                                                 
uvcvideo: Adding mapping White Balance Temperature, Auto to control 00000000-0000-0000-0000-000000000101/11.                                                    
uvcvideo: Adding mapping White Balance Temperature to control 00000000-0000-0000-0000-000000000101/10.                                                          
uvcvideo: Adding mapping White Balance Component, Auto to control 00000000-0000-0000-0000-000000000101/13.                                                      
uvcvideo: Adding mapping White Balance Blue Component to control 00000000-0000-0000-0000-000000000101/12.                                                       
uvcvideo: Adding mapping White Balance Red Component to control 00000000-0000-0000-0000-000000000101/12.                                                        
uvcvideo: Adding mapping Focus (absolute) to control 00000000-0000-0000-0000-000000000001/6.                                                                    
uvcvideo: Adding mapping Focus, Auto to control 00000000-0000-0000-0000-000000000001/8.                                                                         
uvcvideo: Adding mapping Zoom, Absolute to control 00000000-0000-0000-0000-000000000001/11.                                                                     
uvcvideo: Adding mapping Zoom, Continuous to control 00000000-0000-0000-0000-000000000001/12.                                                                   
uvcvideo: Adding mapping Privacy to control 00000000-0000-0000-0000-000000000001/17.                                                                            
usbcore: registered new interface driver uvcvideo                               
USB Video Class driver (v0.1.0)                                                 
usb 2-5: new high speed USB device using ehci_hcd and address 3                 
usb 2-5: configuration #1 chosen from 1 choice                                  
uvcvideo: Probing generic UVC device 5                                          
uvcvideo: Found format YUV 4:2:2 (YUYV).                                        
uvcvideo: - 320x240 (30.0 fps)                                                  
uvcvideo: - 160x120 (30.0 fps)                                                  
uvcvideo: - 176x144 (30.0 fps)                                                  
uvcvideo: - 352x288 (30.0 fps)                                                  
uvcvideo: - 640x480 (30.0 fps)                                                  
uvcvideo: - 800x600 (20.0 fps)                                                  
uvcvideo: device 3 videostreaminginterface 1 frame index 8 out of range         
uvcvideo: Found a Status endpoint (addr 83).                                    
uvcvideo: Found UVC 1.00 device Hercules Dualpix Infinite (06f8:300a)           
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/2 to device 5 entity 3                                                                             
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/3 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/6 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/7 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/8 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/9 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/10 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/1 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/4 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/5 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000101/11 to device 5 entity 3
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/2 to device 5 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/3 to device 5 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/4 to device 5 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/11 to device 5 entity 1
uvcvideo: Added control 00000000-0000-0000-0000-000000000001/13 to device 5 entity 1
uvcvideo: Scanning UVC chain: OT 2 <- XU 5 <- XU 4 <- PU 3 <- IT 1
uvcvideo: No valid video chain found.
ALSA sound/usb/usbaudio.c:1298: 3:3:1: cannot get freq at ep 0x84
usb 2-5: New USB device found, idVendor=06f8, idProduct=300a
usb 2-5: New USB device strings: Mfr=2, Product=1, SerialNumber=0
usb 2-5: Product: Hercules Dualpix Infinite
usb 2-5: Manufacturer: Guillemot Corporation
ALSA sound/usb/usbaudio.c:1298: 3:3:1: cannot get freq at ep 0x84

From fabian-linuxuvc at progra.de  Thu Apr 30 15:53:16 2009
From: fabian-linuxuvc at progra.de (Fabian)
Date: Thu, 30 Apr 2009 15:53:16 +0200
Subject: [Linux-uvc-devel] HP 3 Megapixelcamera working but how to
 control the focus?
In-Reply-To: <200904291826.20392.laurent.pinchart@skynet.be>
References: <49EEEE08.4050303@progra.de>
	<200904291711.32790.laurent.pinchart@skynet.be>
	<49F87727.8090902@progra.de>
	<200904291826.20392.laurent.pinchart@skynet.be>
Message-ID: <49F9AD4C.5010801@progra.de>

Hi Laurent,

Laurent Pinchart wrote:

> Your device exposes standard UVC focus and exposure controls. Those should be 
> supported out of the box by the driver.
This sounds very promising... :)

> Could you please load the uvcvideo 
> module with trace set to 15 and send me the messages printed to the kernel log 
> after plugging your camera ?
The requested kernel log is attached.

Btw this was done on Ubuntu 9.04:
> robocup at multitouch:~$ uname -a
> Linux multitouch 2.6.28-11-generic #42-Ubuntu SMP Fri Apr 17 01:58:03 UTC 2009 x86_64 GNU/Linux

I also tried using the newest uvcvideo source from 
http://linuxtv.org/hg/~pinchartl/uvcvideo/
but the resulting kernel module won't load with an "Unknown symbol in 
module, or unknown parameter" error.

Anything else I could try out?

Cheers,
Fabian
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: kern.log
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090430/68c97877/attachment.ksh>

From laurent.pinchart at skynet.be  Thu Apr 30 17:26:13 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 30 Apr 2009 17:26:13 +0200
Subject: [Linux-uvc-devel] Strange issue with Hercules Dualpix Infinite
In-Reply-To: <200904300800.04057.legrain@crans.org>
References: <200904300800.04057.legrain@crans.org>
Message-ID: <200904301726.13693.laurent.pinchart@skynet.be>

Hi Gregory,

On Thursday 30 April 2009 08:00:03 Gregory LEGRAIN wrote:
> Hi Laurent,
> it seems that my previous mail was buried under tons of other mails during
> your holidays :-)

Seems my attempt to escape from your attention didn't went unnoticed :-)

> You asked me to set the trace parameter to 255 when loading the driver. I
> did it, and attached the output with this mail.

Thanks. I see what's wrong. Your device is not UVC compliant :-S

There's a small error in the UVC descriptors that prevent the driver from 
detecting the device correctly. The uncompressed frame descriptors should be 
numbered from 1 to 7, but they are instead numbered from 1 to 8 with number 7 
missing.

According to the UVC specification, the bFrameIndex field "selects the video 
frame resolution from the array of resolutions supported by the selected 
stream. The index value ranges from 1 to the number of Frame descriptors 
following a particular Format descriptor." The device is thus not UVC 
compliant.

Here's a patch that should fix the issue. It hasn't been stress-tested, so it 
might crash your kernel. Please let me know if it helps.

Best regards,

Laurent Pinchart

-------------- next part --------------
A non-text attachment was scrubbed...
Name: hercules.patch
Type: text/x-patch
Size: 5734 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20090430/8526c2fa/attachment.bin>

From laurent.pinchart at skynet.be  Thu Apr 30 17:42:00 2009
From: laurent.pinchart at skynet.be (Laurent Pinchart)
Date: Thu, 30 Apr 2009 17:42:00 +0200
Subject: [Linux-uvc-devel] HP 3 Megapixelcamera working but how to
	control the focus?
In-Reply-To: <49F9AD4C.5010801@progra.de>
References: <49EEEE08.4050303@progra.de>
	<200904291826.20392.laurent.pinchart@skynet.be>
	<49F9AD4C.5010801@progra.de>
Message-ID: <200904301742.00590.laurent.pinchart@skynet.be>

Hi Fabian,

On Thursday 30 April 2009 15:53:16 Fabian wrote:
> Hi Laurent,
>
> Laurent Pinchart wrote:
> > Your device exposes standard UVC focus and exposure controls. Those
> > should be supported out of the box by the driver.
>
> This sounds very promising... :)
>
> > Could you please load the uvcvideo
> > module with trace set to 15 and send me the messages printed to the
> > kernel log after plugging your camera ?
>
> The requested kernel log is attached.

Thanks.

> Btw this was done on Ubuntu 9.04:
> > robocup at multitouch:~$ uname -a
> > Linux multitouch 2.6.28-11-generic #42-Ubuntu SMP Fri Apr 17 01:58:03 UTC
> > 2009 x86_64 GNU/Linux
>
> I also tried using the newest uvcvideo source from
> http://linuxtv.org/hg/~pinchartl/uvcvideo/
> but the resulting kernel module won't load with an "Unknown symbol in
> module, or unknown parameter" error.

That's because you need to load the v4l1-compat and videodev modules that come 
from the same source tree.

> Anything else I could try out?

The exposure and focus controls should be supported. luvcview can't list them 
because it doesn't implement controls enumeration properly, but you should be 
able to access them.

Best regards,

Laurent Pinchart



