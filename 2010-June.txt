From a.auer at zydacron.com  Tue Jun  1 16:14:35 2010
From: a.auer at zydacron.com (Andreas Auer)
Date: Tue, 01 Jun 2010 16:14:35 +0200
Subject: [Linux-uvc-devel] UVC userpointer  streaming (memory mapping)
In-Reply-To: <201005311206.01156.laurent.pinchart@ideasonboard.com>
References: <hto12i$62q$1@dough.gmane.org>
	<201005311206.01156.laurent.pinchart@ideasonboard.com>
Message-ID: <hu34g3$h3b$1@dough.gmane.org>

Thanks for the answer. I'll try to add this changes by myself.

Right now, I can get the physical pfn of the user pointer. The first 
approach that came into my mind was to get a pointer to the page struct 
with the pfn_to_page(...) function.
You already added a new function called uvc_buffer_write which maps 
(kmap_atomic) the pfn associated with the page struct into the kernel 
space (basically the logical kernel address is returned). And then the 
data from the uvc cam is copied to the buffer and finally, the pfn is 
unmapped with kunmap_atomic.

So, I thought this should work. But, I'm getting a paging error:
"Unable to handle kernel paging request at virtual address cdf46000"

Could that paging error occur because the physical page resides outside 
of the physical memory that linux holds. That means I specified 216MB 
for Linux. The memory from 216MB to 256MB is reserved for the DSP. And 
the user pointer passed to the UVC driver points to 223MB which is above 
the memory of Linux.
So, maybe the MMU doesn't know that there are physical pages and has no 
mapping for it!?

Thanks,
Andreas


Laurent Pinchart schrieb:
> Hi Andreas,
> 
> I've just answered your private e-mail, here's a copy for the list.
> 
> On Friday 28 May 2010 11:08:19 Andreas Auer wrote:
>> Hi,
>>
>> I'm trying to get user pointer streaming with UVC webcams working. I
>> already got a patch from Laurent Pinchart (thanks) which enables user
>> pointer streaming. This patch works if I pass malloc()'d memory to the
>> driver.
>> My problem is that I want to use mmap()'d memory (via /dev/mem) and this
>> type of memory (flags VM_IO and VM_PFNMAP are set) is not supported to
>> be used with get_user_pages to map the memory to the kernel space.
>>
>> So, is there another way to map the pages into the kernel space to be
>> used for user pointer streaming?? I had a look at kmap (kmap_atomic)...
>> would this be possible??
> 
> PFNMAP memory has no page struct associated with it, it can't be handled the 
> same way as regular main memory in the uvcvideo driver.
> 
> The DSP driver probably reserves memory at system startup. That memory isn't 
> managed by the Linux kernel memory manager.
> 
> The uvcvideo driver doesn't support PFNMAP memory at the moment. That 
> shouldn't be too difficult to fix though, but I'm afraid I don't have time to 
> work on it right now.
> 



From claunia at claunia.com  Fri Jun  4 16:53:56 2010
From: claunia at claunia.com (Natalia Portillo)
Date: Fri, 04 Jun 2010 16:53:56 +0200
Subject: [Linux-uvc-devel] How to mark a payload end
Message-ID: <1275663236.13411.22.camel@claunia-laptop>

Hi,

I'm programming an emulated UVC webcam in QEMU and I've found a little
problem.

While I'm trying to send a bulk payload made from a JPEG sized 5809
bytes, uvcvideo never detects the payload ends and continue asking
frames until buffer (~53KiB) overflows.

I attach the code snippet that generates the payload (code is under
GLPv2) as snippet.c

Trace from uvcvideo as dmesg.txt

Crash of uvccapture as uvccapture.txt

I've checked the specifications and I'm unable to find what I'm doing
wrong or how should be done the payload to get it working.

Any help will be thanked.

Regards,
Natalia Portillo

-------------- next part --------------
A non-text attachment was scrubbed...
Name: snippet.c
Type: text/x-csrc
Size: 1247 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100604/72a65ab5/attachment.c>
-------------- next part --------------
root at debian:~# uvccapture
 format asked unavailable get width 176 height 144 
ioctl querycontrol error 22 
ioctl querycontrol error 22 
ioctl querycontrol error 22 
*** glibc detected *** uvccapture: free(): invalid next size (normal): 0x085172f0 ***
======= Backtrace: =========
/lib/i686/cmov/libc.so.6(+0x6c104)[0xb76b9104]
/lib/i686/cmov/libc.so.6(+0x6d983)[0xb76ba983]
/lib/i686/cmov/libc.so.6(cfree+0x6d)[0xb76bd96d]
uvccapture[0x804a353]
uvccapture[0x80498f0]
/lib/i686/cmov/libc.so.6(__libc_start_main+0xe5)[0xb7663c85]
uvccapture[0x8048bc1]
======= Memory map: ========
08048000-0804c000 r-xp 00000000 08:01 28786673   /usr/bin/uvccapture
0804c000-0804d000 rw-p 00003000 08:01 28786673   /usr/bin/uvccapture
08517000-08538000 rw-p 00000000 00:00 0          [heap]
b7500000-b7521000 rw-p 00000000 00:00 0 
b7521000-b7600000 ---p 00000000 00:00 0 
b762d000-b764a000 r-xp 00000000 08:01 16987594   /lib/libgcc_s.so.1
b764a000-b764b000 rw-p 0001c000 08:01 16987594   /lib/libgcc_s.so.1
b764b000-b764d000 rw-p 00000000 00:00 0 
b764d000-b7793000 r-xp 00000000 08:01 195780     /lib/i686/cmov/libc-2.11.1.so
b7793000-b7795000 r--p 00146000 08:01 195780     /lib/i686/cmov/libc-2.11.1.so
b7795000-b7796000 rw-p 00148000 08:01 195780     /lib/i686/cmov/libc-2.11.1.so
b7796000-b7799000 rw-p 00000000 00:00 0 
b7799000-b77b8000 r-xp 00000000 08:01 412590     /usr/lib/libjpeg.so.62.0.0
b77b8000-b77b9000 rw-p 0001e000 08:01 412590     /usr/lib/libjpeg.so.62.0.0
b77c9000-b77cb000 rw-p 00000000 00:00 0 
b77cb000-b77cc000 r-xp 00000000 00:00 0          [vdso]
b77cc000-b77e8000 r-xp 00000000 08:01 16839934   /lib/ld-2.11.1.so
b77e8000-b77e9000 r--p 0001b000 08:01 16839934   /lib/ld-2.11.1.so
b77e9000-b77ea000 rw-p 0001c000 08:01 16839934   /lib/ld-2.11.1.so
bfaa8000-bfabd000 rw-p 00000000 00:00 0          [stack]
Exiting...
Aborted

-------------- next part --------------
[   56.142980] uvcvideo: Control 0x00980901 not found.
[   56.143020] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYCTRL)
[   56.143027] uvcvideo: Control 0x00980902 not found.
[   56.143039] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYCTRL)
[   56.143045] uvcvideo: Control 0x00980913 not found.
[   56.143070] uvcvideo: uvc_v4l2_ioctl(VIDIOC_STREAMON)
[   56.151168] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[   57.260706] uvcvideo: Frame complete (overflow).
[   57.302511] uvcvideo: Frame complete (overflow).
[   57.336522] uvcvideo: Frame complete (overflow).
[   57.336598] uvcvideo: Dequeuing buffer 0 (3, 52850 bytes).
[   57.336678] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[   57.336685] uvcvideo: Queuing buffer 0.
[   57.372937] uvcvideo: uvc_v4l2_ioctl(VIDIOC_STREAMOFF)
[   57.734405] uvcvideo: uvc_v4l2_release

From laurent.pinchart at ideasonboard.com  Mon Jun  7 10:31:31 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 7 Jun 2010 10:31:31 +0200
Subject: [Linux-uvc-devel] UVC userpointer  streaming (memory mapping)
In-Reply-To: <hu34g3$h3b$1@dough.gmane.org>
References: <hto12i$62q$1@dough.gmane.org>
	<201005311206.01156.laurent.pinchart@ideasonboard.com>
	<hu34g3$h3b$1@dough.gmane.org>
Message-ID: <201006071031.32169.laurent.pinchart@ideasonboard.com>

Hi Andreas,

On Tuesday 01 June 2010 16:14:35 Andreas Auer wrote:
> Thanks for the answer. I'll try to add this changes by myself.
> 
> Right now, I can get the physical pfn of the user pointer. The first
> approach that came into my mind was to get a pointer to the page struct
> with the pfn_to_page(...) function.
> You already added a new function called uvc_buffer_write which maps
> (kmap_atomic) the pfn associated with the page struct into the kernel
> space (basically the logical kernel address is returned). And then the
> data from the uvc cam is copied to the buffer and finally, the pfn is
> unmapped with kunmap_atomic.
> 
> So, I thought this should work. But, I'm getting a paging error:
> "Unable to handle kernel paging request at virtual address cdf46000"
> 
> Could that paging error occur because the physical page resides outside
> of the physical memory that linux holds. That means I specified 216MB
> for Linux. The memory from 216MB to 256MB is reserved for the DSP. And
> the user pointer passed to the UVC driver points to 223MB which is above
> the memory of Linux.

That's correct. Linux doesn't handle that memory, and didn't create any struct 
page for it. pfn_to_page() on such memory isn't valid, which means you can't 
call kmap_atomic in that case.

> So, maybe the MMU doesn't know that there are physical pages and has no
> mapping for it!?

The MMU has mappings for that memory, but I don't think those can be easily 
accessed from the UVC driver interrupt handler. The userspace mapping (created 
through mmap on the DSP driver) is specific to the userspace application, and 
the kernel mapping (created through ioremap in the DSP driver), if it exists, 
isn't easily accessible.

I can think of two ways to solve the problem. The first one would be to 
ioremap() the memory using its physical address. You would then get a kernel 
virtual mapping. I'm not sure if that would work though (cache coherency 
issues come to mind). The second way is to change the way the UVC interrupt 
handler works, and add completed URBs to a list instead of decoding them. A 
workqueue would then decode the URBs, using copy_to_user instead of 
kmap/memcpy/kunmap. That approach will introduce more delay in URB processing 
and might thus require an increased number of URBs. It would be nice to 
experiment with it.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Mon Jun  7 10:37:21 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Mon, 7 Jun 2010 10:37:21 +0200
Subject: [Linux-uvc-devel] How to mark a payload end
In-Reply-To: <1275663236.13411.22.camel@claunia-laptop>
References: <1275663236.13411.22.camel@claunia-laptop>
Message-ID: <201006071037.22774.laurent.pinchart@ideasonboard.com>

Hi Natalia,

On Friday 04 June 2010 16:53:56 Natalia Portillo wrote:
> Hi,
> 
> I'm programming an emulated UVC webcam in QEMU and I've found a little
> problem.

Nice project ! Please let me know how it works out.

> While I'm trying to send a bulk payload made from a JPEG sized 5809
> bytes, uvcvideo never detects the payload ends and continue asking
> frames until buffer (~53KiB) overflows.
> 
> I attach the code snippet that generates the payload (code is under
> GLPv2) as snippet.c

Shouldn't

	p->data[1] = 0x82 & frame_id;

be

	p->data[1] = 0x82 | frame_id;

?

> Trace from uvcvideo as dmesg.txt
> 
> Crash of uvccapture as uvccapture.txt
> 
> I've checked the specifications and I'm unable to find what I'm doing
> wrong or how should be done the payload to get it working.
> 
> Any help will be thanked.

-- 
Regards,

Laurent Pinchart


From a.auer at zydacron.com  Mon Jun  7 14:31:24 2010
From: a.auer at zydacron.com (Andreas Auer)
Date: Mon, 07 Jun 2010 14:31:24 +0200
Subject: [Linux-uvc-devel] UVC userpointer  streaming (memory mapping)
In-Reply-To: <201006071031.32169.laurent.pinchart@ideasonboard.com>
References: <hto12i$62q$1@dough.gmane.org>	<201005311206.01156.laurent.pinchart@ideasonboard.com>	<hu34g3$h3b$1@dough.gmane.org>
	<201006071031.32169.laurent.pinchart@ideasonboard.com>
Message-ID: <4C0CE69C.9010902@zydacron.com>


Hi Laurent,

thanks for your help. I got it working. I tried it with the first 
approach you suggested: In the "uvc_lock_buffer" function, I do the 
ioremap of the physical address range and store the pointer in the 
uvc_buffer struct in a new variable (ioremap is not working in the 
"uvc_buffer_write" function because we are in an interrupt).
Then, the "uvc_buffer_write" function writes the data to the memory. 
"iounmap" is done in "uvc_unlock_buffer".
I hope that's the right way!?

Cheers,
Andreas

Laurent Pinchart schrieb:
> Hi Andreas,
> 
> On Tuesday 01 June 2010 16:14:35 Andreas Auer wrote:
>> Thanks for the answer. I'll try to add this changes by myself.
>>
>> Right now, I can get the physical pfn of the user pointer. The first
>> approach that came into my mind was to get a pointer to the page struct
>> with the pfn_to_page(...) function.
>> You already added a new function called uvc_buffer_write which maps
>> (kmap_atomic) the pfn associated with the page struct into the kernel
>> space (basically the logical kernel address is returned). And then the
>> data from the uvc cam is copied to the buffer and finally, the pfn is
>> unmapped with kunmap_atomic.
>>
>> So, I thought this should work. But, I'm getting a paging error:
>> "Unable to handle kernel paging request at virtual address cdf46000"
>>
>> Could that paging error occur because the physical page resides outside
>> of the physical memory that linux holds. That means I specified 216MB
>> for Linux. The memory from 216MB to 256MB is reserved for the DSP. And
>> the user pointer passed to the UVC driver points to 223MB which is above
>> the memory of Linux.
> 
> That's correct. Linux doesn't handle that memory, and didn't create any struct 
> page for it. pfn_to_page() on such memory isn't valid, which means you can't 
> call kmap_atomic in that case.
> 
>> So, maybe the MMU doesn't know that there are physical pages and has no
>> mapping for it!?
> 
> The MMU has mappings for that memory, but I don't think those can be easily 
> accessed from the UVC driver interrupt handler. The userspace mapping (created 
> through mmap on the DSP driver) is specific to the userspace application, and 
> the kernel mapping (created through ioremap in the DSP driver), if it exists, 
> isn't easily accessible.
> 
> I can think of two ways to solve the problem. The first one would be to 
> ioremap() the memory using its physical address. You would then get a kernel 
> virtual mapping. I'm not sure if that would work though (cache coherency 
> issues come to mind). The second way is to change the way the UVC interrupt 
> handler works, and add completed URBs to a list instead of decoding them. A 
> workqueue would then decode the URBs, using copy_to_user instead of 
> kmap/memcpy/kunmap. That approach will introduce more delay in URB processing 
> and might thus require an increased number of URBs. It would be nice to 
> experiment with it.
> 



From claunia at claunia.com  Tue Jun  8 00:25:07 2010
From: claunia at claunia.com (Natalia Portillo)
Date: Mon, 7 Jun 2010 23:25:07 +0100
Subject: [Linux-uvc-devel] How to mark a payload end
In-Reply-To: <201006071037.22774.laurent.pinchart@ideasonboard.com>
References: <1275663236.13411.22.camel@claunia-laptop>
	<201006071037.22774.laurent.pinchart@ideasonboard.com>
Message-ID: <539605A8-6586-4EC3-A1DF-5A727138F6A7@claunia.com>

Hi Laurent,

Regards,
Natalia Portillo

>> I attach the code snippet that generates the payload (code is under
>> GLPv2) as snippet.c
> 
> Shouldn't
> 
> 	p->data[1] = 0x82 & frame_id;
> 
> be
> 
> 	p->data[1] = 0x82 | frame_id;
> 
> ?

Yes I saw it a couple of minutes from when I sent the email.

I still need to clean up a little the code and handle when the real v4l2 device does not send JPEGs but uncompressed frames, converting them to JPEG and feeding the emulated device with them.

Stay tuned, this week I'll make public the code.



From linux.newbie79 at gmail.com  Tue Jun  8 02:09:39 2010
From: linux.newbie79 at gmail.com (linux newbie)
Date: Tue, 8 Jun 2010 10:09:39 +1000
Subject: [Linux-uvc-devel] cam max width and height
Message-ID: <AANLkTimh-FVg9yspF6ASGrlY5kd5Puppa7VlKA6NljQ5@mail.gmail.com>

Hi,

I am using linux 2.6.26.3. I connected "microsoft live cam" and its
max supported resolution is 1280x800. If I use VIDIOC_G_FMT,
fmt.fmt.pix.width, fmt.fmt.pix.height returns 640x480.

How to get the maximum supported resolution??

Thanks


From claunia at claunia.com  Tue Jun  8 02:17:17 2010
From: claunia at claunia.com (Natalia Portillo)
Date: Tue, 8 Jun 2010 01:17:17 +0100
Subject: [Linux-uvc-devel] cam max width and height
In-Reply-To: <AANLkTimh-FVg9yspF6ASGrlY5kd5Puppa7VlKA6NljQ5@mail.gmail.com>
References: <AANLkTimh-FVg9yspF6ASGrlY5kd5Puppa7VlKA6NljQ5@mail.gmail.com>
Message-ID: <E009656A-B664-4339-B127-B6A71EC13192@claunia.com>

Hi,

El 08/06/2010, a las 01:09, linux newbie escribi?:

> Hi,
> 
> I am using linux 2.6.26.3. I connected "microsoft live cam" and its
> max supported resolution is 1280x800. If I use VIDIOC_G_FMT,
> fmt.fmt.pix.width, fmt.fmt.pix.height returns 640x480.
> 
> How to get the maximum supported resolution??

You should check in Microsoft's webpage or included documentation that 1280x800 is a video resolution and not only a still image resolution.

It is common for many cameras to do that.

> Thanks
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel



From laurent.pinchart at ideasonboard.com  Tue Jun  8 03:07:01 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Tue, 8 Jun 2010 03:07:01 +0200
Subject: [Linux-uvc-devel] cam max width and height
In-Reply-To: <AANLkTimh-FVg9yspF6ASGrlY5kd5Puppa7VlKA6NljQ5@mail.gmail.com>
References: <AANLkTimh-FVg9yspF6ASGrlY5kd5Puppa7VlKA6NljQ5@mail.gmail.com>
Message-ID: <201006080307.02170.laurent.pinchart@ideasonboard.com>

Hi,

On Tuesday 08 June 2010 02:09:39 linux newbie wrote:
> Hi,
> 
> I am using linux 2.6.26.3. I connected "microsoft live cam" and its
> max supported resolution is 1280x800. If I use VIDIOC_G_FMT,
> fmt.fmt.pix.width, fmt.fmt.pix.height returns 640x480.
> 
> How to get the maximum supported resolution??

You can use VIDIOC_ENUM_FRAMESIZES to enumeration all the supported 
resolutions.

-- 
Regards,

Laurent Pinchart


From ctarwater at gmail.com  Tue Jun  8 16:12:25 2010
From: ctarwater at gmail.com (C Tarwater)
Date: Tue, 8 Jun 2010 10:12:25 -0400
Subject: [Linux-uvc-devel] 064e:a136 Not Supported
In-Reply-To: <201005311152.27344.laurent.pinchart@ideasonboard.com>
References: <AANLkTikUXL3gn_7rQ8ouSIwFPduays6TKAC2p4mw7eSP@mail.gmail.com>
	<201005311152.27344.laurent.pinchart@ideasonboard.com>
Message-ID: <AANLkTilr6I0rq6QO6EpvNlnBEN6qEX6Y5eUaQFiAjCu_@mail.gmail.com>

Thanks!

*lsusb -v -d 064e:a136*

Bus 002 Device 003: ID 064e:a136 Suyin Corp.
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x064e Suyin Corp.
  idProduct          0xa136
  bcdDevice            1.11
  iManufacturer           2 SuYin
  iProduct                1 USB 2.0 UVC 0.3M Webcam
  iSerial                 3 CN031B-S233-MI01-VS-R01.01.01
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          549
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0
      iFunction               4 USB 2.0 UVC 0.3M Webcam
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0
      iInterface              4 USB 2.0 UVC 0.3M Webcam
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength          103
        dwClockFrequency       15.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             2
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               5
        iTerminal               0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 4
        guidExtensionCode         {7033f028-1163-2e4a-ba2c-6890eb334016}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          3
        bControlSize            1
        bmControls( 0)       0x1f
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                26
        bDescriptorType        36
        bDescriptorSubtype      6 (EXTENSION_UNIT)
        bUnitID                 5
        guidExtensionCode         {3fae1228-d7bc-114e-a357-6f1edef7d61d}
        bNumControl             8
        bNrPins                 1
        baSourceID( 0)          4
        bControlSize            1
        bmControls( 0)       0xff
        iExtension              0
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x00000000
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 3
        bSourceID               1
        wMaxMultiplier          0
        bControlSize            2
        bmControls     0x0000177f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          White Balance Temperature
          Backlight Compensation
          Gain
          Power Line Frequency
          White Balance Temperature, Auto
        iProcessing             0
        bmVideoStandards     0x 0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               6
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      VideoStreaming Interface Descriptor:
        bLength                            14
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         1
        wTotalLength                      303
        bEndPointAddress                  129
        bmInfo                              0
        bTerminalLink                       2
        bStillCaptureMethod                 2
        bTriggerSupport                     0
        bTriggerUsage                       0
        bControlSize                        1
        bmaControls( 0)                    27
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        1
        bNumFrameDescriptors                5
        guidFormat
 {59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 24576000
        dwMaxBitRate                147456000
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         2
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            352
        wHeight                           288
        dwMinBitRate                  8110080
        dwMaxBitRate                 48660480
        dwMaxVideoFrameBufferSize      202752
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         3
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  6144000
        dwMaxBitRate                 36864000
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         4
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            176
        wHeight                           144
        dwMinBitRate                  2027520
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize       50688
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            46
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         5
        bmCapabilities                   0x00
          Still image unsupported
        wWidth                            160
        wHeight                           120
        dwMinBitRate                  1536000
        dwMaxBitRate                  9216000
        dwMaxVideoFrameBufferSize       38400
        dwDefaultFrameInterval         333333
        bFrameIntervalType                  5
        dwFrameInterval( 0)            333333
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
        dwFrameInterval( 4)           2000000
      VideoStreaming Interface Descriptor:
        bLength                            26
        bDescriptorType                    36
        bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
        bEndpointAddress                    0
        bNumImageSizePatterns               5
        wWidth( 0)                        640
        wHeight( 0)                       480
        wWidth( 1)                        352
        wHeight( 1)                       288
        wWidth( 2)                        320
        wHeight( 2)                       240
        wWidth( 3)                        176
        wHeight( 3)                       144
        wWidth( 4)                        160
        wHeight( 4)                       120
        bNumCompressionPatterns             5
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     1 (BT.709,sRGB)
        bTransferCharacteristics            1 (BT.709)
        bMatrixCoefficients                 4 (SMPTE 170M (BT.601))
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0080  1x 128 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       2
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0100  1x 256 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       3
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0320  1x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       4
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0b20  2x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       5
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1320  3x 800 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       6
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x1400  3x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0002
  (Bus Powered)
  Remote Wakeup Enabled

*///////////////////////////////////////////////////*
*
*
* dmidecode*
# dmidecode 2.10
SMBIOS 2.5 present.
34 structures occupying 1791 bytes.
Table at 0x000FD150.

Handle 0x0000, DMI type 0, 24 bytes
BIOS Information
Vendor: American Megatrends Inc.
Version: 215
Release Date: 10/01/2009
Address: 0xF0000
Runtime Size: 64 kB
ROM Size: 1024 kB
Characteristics:
ISA is supported
PCI is supported
PNP is supported
BIOS is upgradeable
BIOS shadowing is allowed
ESCD support is available
Boot from CD is supported
Selectable boot is supported
EDD is supported
5.25"/1.2 MB floppy services are supported (int 13h)
3.5"/720 kB floppy services are supported (int 13h)
3.5"/2.88 MB floppy services are supported (int 13h)
Print screen service is supported (int 5h)
8042 keyboard services are supported (int 9h)
Printer services are supported (int 17h)
CGA/mono video services are supported (int 10h)
ACPI is supported
USB legacy is supported
Smart battery is supported
BIOS boot specification is supported
Function key-initiated network boot is supported
Targeted content distribution is supported
BIOS Revision: 2.15
Firmware Revision: 163.1

Handle 0x0001, DMI type 1, 27 bytes
System Information
Manufacturer: ASUSTeK Computer Inc.
Product Name: UL50VT
Version: 1.0
Serial Number: 102570480004
UUID: 422281DE-CC16-5714-7980-90E6BA7D89CA
Wake-up Type: Power Switch
SKU Number:
Family:

Handle 0x0002, DMI type 2, 15 bytes
Base Board Information
Manufacturer: ASUSTeK Computer Inc.
Product Name: UL50VT
Version: 1.0
Serial Number: BSN12345678901234567
Asset Tag: ATN12345678901234567
Features:
Board is a hosting board
Board requires at least one daughter board
Board is replaceable
Location In Chassis: MIDDLE
Chassis Handle: 0x0003
Type: Motherboard
Contained Object Handles: 0

Handle 0x0003, DMI type 3, 21 bytes
Chassis Information
Manufacturer: ASUSTeK Computer Inc.
Type: Notebook
Lock: Not Present
Version: 1.0
Serial Number: CSN12345678901234567
Asset Tag: ATN12345678901234567
Boot-up State: Safe
Power Supply State: Safe
Thermal State: Other
Security Status: Other
OEM Information: 0x00000000
Height: Unspecified
Number Of Power Cords: 1
Contained Elements: 0

Handle 0x0004, DMI type 4, 40 bytes
Processor Information
Socket Designation: Socket 478
Type: Central Processor
Family: Other
Manufacturer: Intel
ID: 7A 06 01 00 FF FB EB BF
Version: Genuine Intel(R) CPU U7300 @ 1.30GHz
Voltage: 1.0 V
External Clock: 200 MHz
Max Speed: 1300 MHz
Current Speed: 1300 MHz
Status: Populated, Enabled
Upgrade: Socket 478
L1 Cache Handle: 0x0005
L2 Cache Handle: 0x0007
L3 Cache Handle: Not Provided
Serial Number: PSN12345678901234567
Asset Tag: PATN1234567890123456
Part Number: PPN12345678901234567
Core Count: 2
Core Enabled: 2
Thread Count: 2
Characteristics:
64-bit capable

Handle 0x0005, DMI type 7, 19 bytes
Cache Information
Socket Designation: L1-Cache
Configuration: Enabled, Not Socketed, Level 1
Operational Mode: Write Back
Location: Internal
Installed Size: 64 kB
Maximum Size: 64 kB
Supported SRAM Types:
Other
Installed SRAM Type: Other
Speed: Unknown
Error Correction Type: Single-bit ECC
System Type: Data
Associativity: 8-way Set-associative

Handle 0x0006, DMI type 7, 19 bytes
Cache Information
Socket Designation: L1-Cache
Configuration: Enabled, Not Socketed, Level 1
Operational Mode: Write Back
Location: Internal
Installed Size: 64 kB
Maximum Size: 64 kB
Supported SRAM Types:
Other
Installed SRAM Type: Other
Speed: Unknown
Error Correction Type: Single-bit ECC
System Type: Instruction
Associativity: 8-way Set-associative

Handle 0x0007, DMI type 7, 19 bytes
Cache Information
Socket Designation: L2-Cache
Configuration: Enabled, Not Socketed, Level 2
Operational Mode: Write Back
Location: Internal
Installed Size: 3072 kB
Maximum Size: 3072 kB
Supported SRAM Types:
Other
Installed SRAM Type: Other
Speed: Unknown
Error Correction Type: Single-bit ECC
System Type: Unified
Associativity: Other

Handle 0x0008, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J1A1
Internal Connector Type: None
External Reference Designator: Keyboard
External Connector Type: PS/2
Port Type: Keyboard Port

Handle 0x0009, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J2A2
Internal Connector Type: None
External Reference Designator: USB1
External Connector Type: Access Bus (USB)
Port Type: USB

Handle 0x000A, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J2A2
Internal Connector Type: None
External Reference Designator: USB2
External Connector Type: Access Bus (USB)
Port Type: USB

Handle 0x000B, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J4A1
Internal Connector Type: None
External Reference Designator: HDMI
External Connector Type: Other
Port Type: Other

Handle 0x000C, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J2A1
Internal Connector Type: None
External Reference Designator: ESATA
External Connector Type: SAS/SATA Plug Receptacle
Port Type: SATA

Handle 0x000D, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J6A1
Internal Connector Type: None
External Reference Designator: Audio Mic In
External Connector Type: Mini Jack (headphones)
Port Type: Audio Port

Handle 0x000E, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J6A1
Internal Connector Type: None
External Reference Designator: Audio Line In
External Connector Type: Mini Jack (headphones)
Port Type: Audio Port

Handle 0x000F, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J6A1
Internal Connector Type: None
External Reference Designator: Audio Line Out
External Connector Type: Mini Jack (headphones)
Port Type: Audio Port

Handle 0x0010, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J5A1
Internal Connector Type: None
External Reference Designator: USB3
External Connector Type: Access Bus (USB)
Port Type: USB

Handle 0x0011, DMI type 8, 9 bytes
Port Connector Information
Internal Reference Designator: J5A1
Internal Connector Type: None
External Reference Designator: LAN
External Connector Type: RJ-45
Port Type: Network Port

Handle 0x0012, DMI type 9, 13 bytes
System Slot Information
Designation: PCI Express Card
Type: 64-bit PCI Express
Current Usage: In Use
Length: Short
ID: 0
Characteristics:
3.3 V is provided
Opening is shared
PME signal is supported

Handle 0x0013, DMI type 10, 6 bytes
On Board Device Information
Type: Video
Status: Enabled
Description:   To Be Filled By O.E.M.

Handle 0x0014, DMI type 10, 6 bytes
On Board Device Information
Type: SATA Controller
Status: Enabled
Description:  To Be Filled By O.E.M.

Handle 0x0015, DMI type 10, 6 bytes
On Board Device Information
Type: Ethernet
Status: Enabled
Description: To Be Filled By O.E.M.

Handle 0x0016, DMI type 10, 6 bytes
On Board Device Information
Type: Token Ring
Status: Enabled
Description:  To Be Filled By O.E.M.

Handle 0x0017, DMI type 13, 22 bytes
BIOS Language Information
Installable Languages: 1
en|US|iso8859-1
Currently Installed Language: en|US|iso8859-1

Handle 0x0018, DMI type 16, 15 bytes
Physical Memory Array
Location: System Board Or Motherboard
Use: System Memory
Error Correction Type: None
Maximum Capacity: 8 GB
Error Information Handle: Not Provided
Number Of Devices: 2

Handle 0x0019, DMI type 19, 15 bytes
Memory Array Mapped Address
Starting Address: 0x00000000000
Ending Address: 0x000FFFFFFFF
Range Size: 4 GB
Physical Array Handle: 0x0018
Partition Width: 0

Handle 0x001A, DMI type 17, 27 bytes
Memory Device
Array Handle: 0x0018
Error Information Handle: Not Provided
Total Width: 64 bits
Data Width: 64 bits
Size: 2048 MB
Form Factor: SODIMM
Set: None
Locator: SODIMM0
Bank Locator: BANK0
Type: Other
Type Detail: Synchronous
Speed: 1066 MHz
Manufacturer: N/A
Serial Number: N/A
Asset Tag: N/A
Part Number: N/A

Handle 0x001B, DMI type 20, 19 bytes
Memory Device Mapped Address
Starting Address: 0x00000000000
Ending Address: 0x0007FFFFFFF
Range Size: 2 GB
Physical Device Handle: 0x001A
Memory Array Mapped Address Handle: 0x0019
Partition Row Position: Unknown
Interleave Position: Unknown
Interleaved Data Depth: Unknown

Handle 0x001C, DMI type 17, 27 bytes
Memory Device
Array Handle: 0x0018
Error Information Handle: Not Provided
Total Width: 64 bits
Data Width: 64 bits
Size: 2048 MB
Form Factor: SODIMM
Set: None
Locator: SODIMM1
Bank Locator: BANK1
Type: Other
Type Detail: Synchronous
Speed: 1066 MHz
Manufacturer: N/A
Serial Number: N/A
Asset Tag: N/A
Part Number: N/A

Handle 0x001D, DMI type 20, 19 bytes
Memory Device Mapped Address
Starting Address: 0x00080000000
Ending Address: 0x000FFFFFFFF
Range Size: 2 GB
Physical Device Handle: 0x001C
Memory Array Mapped Address Handle: 0x0019
Partition Row Position: Unknown
Interleave Position: Unknown
Interleaved Data Depth: Unknown

Handle 0x001E, DMI type 22, 26 bytes
Portable Battery
Location: In the back
Manufacturer: AS1C7Fb2FF
Manufacture Date: 09/10/23
Serial Number: @800
Name: UL50-58
Chemistry: Other
Design Capacity: 5800 mWh
Design Voltage: 14400 mV
SBDS Version: SMART Ver 0123
Maximum Error: Unknown
OEM-specific Information: 0x00000000

Handle 0x001F, DMI type 129, 8 bytes
OEM-specific Type
Header and Data:
81 08 1F 00 01 01 02 01
Strings:
Intel_ASF
Intel_ASF_001

Handle 0x0020, DMI type 200, 27 bytes
OEM-specific Type
Header and Data:
C8 1B 20 00 01 02 03 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00
Strings:
ASUSTeK Computer Inc.
Notebook
1.0

Handle 0x0021, DMI type 127, 4 bytes

On Mon, May 31, 2010 at 5:52 AM, Laurent Pinchart <
laurent.pinchart at ideasonboard.com> wrote:

> Hi,
>
> On Sunday 23 May 2010 20:39:16 C Tarwater wrote:
> > 064e:a136 (Suyin) is mounted in my Asus UL50vt notebook and is mounted
> > upside down.
> > The website says to post if we have a device that is not supported, so
> here
> > I am.
>
> Could you please post the output of 'lsusb -v -d 064e:a136' and 'dmidecode'
> ?
> Thanks.
>
> --
> Regards,
>
> Laurent Pinchart
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100608/1bb37363/attachment.html>

From public_filter at yahoo.com  Wed Jun  9 02:59:30 2010
From: public_filter at yahoo.com (P F)
Date: Tue, 8 Jun 2010 17:59:30 -0700 (PDT)
Subject: [Linux-uvc-devel] [RFC] Discard overrun (corrupted) RX images
Message-ID: <314384.29017.qm@web120001.mail.ne1.yahoo.com>

Hi,

First of all, thank you for providing such great Linux support for webcams.? I have encountered an issue in this area that I hope you experts can help with.

I am using UVC/V4L on an embedded system, and I am experiencing a problem with corrupted camera images.? The system consists of a custom ASIC with an ARM926EJ-S and OHCI USB host controller connected to a UVC camera which supports only MJPEG.

The problem I have is that buffers dequeued in user space occasionally contain corrupted JPEGs.? This corruption ranges from slight, with a row of macroblocks shifted, to severe, with the JPEG being totally undecompressible.

If I enable UVC_TRACE_FRAME, I see several instances of:
"uvcvideo: USB isochronous frame lost (-70)."
in dmesg.? I have noticed a correlation between the presence of this message and visual corruption in captured JPEGs.

I see that this error code corresponds to -ECOMM, which in turn corresponds to TD_BUFFEROVERRUN in the isochronous packet status.? I assume that this is caused by CPU starvation, which should just manifest as dropped frames.

However, I think these overrun frames are not being dropped, and instead are being passed to user space in an indeterminate state, leading to the visual corruption that I've witnessed.

The attached patch (against 2.6.31) is my na?ve attempt at fixing the problem.? It does appear to resolve the corruption, but I am not entirely sure it's the correct thing to do.? Does it look reasonable?? I would appreciate any feedback.

Thank you,
Filter


      
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uvc.patch
Type: text/x-diff
Size: 593 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100608/e82ebd13/attachment.patch>

From ashoyeh at gmail.com  Wed Jun  9 04:18:42 2010
From: ashoyeh at gmail.com (=?Big5?B?QXNobyBZZWggLSCq/KtI?=)
Date: Wed, 9 Jun 2010 10:18:42 +0800
Subject: [Linux-uvc-devel] XVideo support?
Message-ID: <AANLkTil4yxFRr4xnSLU8TOlrq2bCWiHzijiwylXDnt9m@mail.gmail.com>

Hi,

    I am new to the UVC project. Currently I am working on video
conferencing on Linux and met some performance issues. I hope you experts
can help me to solve these.

    My target board is

VIA CLE266 which onboard an VIA C3 1Ghz CPU.
512MB DDR333 Dimm.
Logitech C100 webcam.

    480p mpeg2 video playback with mplayer and xvideo costs 20~30% of CPU
powers. 50~70% of CPU powers with 720p mpeg2 video file.

    However, when I execute luvcvideo, the console shows

  Video driver: x11
  A window manager is available

    I was wondering that luvcview lacks XVideo support or UVCVideo doesn't
provide the video format that supports XVideo?

    Another problem is skype. In skype chat & video window, it ate 100% of
CPU powers and A/V was out of sync. I didn't know which one is the
bottleneck in skype. That's why I asked for help here.

    I am new to the video processing in Linux, so some problems are
conceptual. Any information and wikis are welcome.

    Thanks for reading this mail.

Best regards,
Asho
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100609/dd764acc/attachment.html>

From asergiu at yahoo.co.uk  Wed Jun  9 11:18:17 2010
From: asergiu at yahoo.co.uk (Adrian Sergiu DARABANT)
Date: Wed, 9 Jun 2010 12:18:17 +0300
Subject: [Linux-uvc-devel] XVideo support?
In-Reply-To: <AANLkTil4yxFRr4xnSLU8TOlrq2bCWiHzijiwylXDnt9m@mail.gmail.com>
References: <AANLkTil4yxFRr4xnSLU8TOlrq2bCWiHzijiwylXDnt9m@mail.gmail.com>
Message-ID: <B85D3DCFCADB439BBD695957534DC0F3@core2>

Hello

   Luvcview uses SDL if I remember well since a few months when I looked
into the sources. As I know there is no direct support or control in SDL
over which rendering engine is used behind the scenes. With XVideo you
normally get yuv formats and sometimes and for some video drivers/cards you
also get RGB. 

 

Mpeg2 is a compressed format that is decompressed most of the times into an
accelerated YUV format. YUV formats can be directly sent to the video card
using XVideo - if that's available.

 

You should look in your case what part: mpeg2 decompression or display takes
up the CPU time. 

 

Now on the other side if your card uses the vesa drivers to display to the
screen XVideo extension is never available for that driver. 

UVC does provide 2D accelerated formats (it mostly provides only those and
MJPEG) 

 

1)       Take a look into Xorg.0.log and check the video used driver.

2)       Check the times spent by the mpeg decompression task.

3)       xvinfo - should help you see if XVideo can be used at all and what
formats are available.

 

XVideo is just a way to pass let's say a video format encoded on (for
example) 2 bytes/pixels YUV instead of 4 (RGBA) - to the video card. The
video card then knows to display those video formats and knows how to scale
them as well (eating only GPU processing time and not CPU). Usually this
means passing just pointers to the video frame (as got from the video
capture device) to the video card for display.

 

 

Adrian

  _____  

From: linux-uvc-devel-bounces at lists.berlios.de
[mailto:linux-uvc-devel-bounces at lists.berlios.de] On Behalf Of Asho Yeh - ??
Sent: Wednesday, June 09, 2010 5:19 AM
To: Linux-uvc-devel at lists.berlios.de
Subject: [Linux-uvc-devel] XVideo support?

 

Hi,

 

    I am new to the UVC project. Currently I am working on video
conferencing on Linux and met some performance issues. I hope you experts
can help me to solve these.

 

    My target board is 

 

VIA CLE266 which onboard an VIA C3 1Ghz CPU. 

512MB DDR333 Dimm.

Logitech C100 webcam.

 

    480p mpeg2 video playback with mplayer and xvideo costs 20~30% of CPU
powers. 50~70% of CPU powers with 720p mpeg2 video file.

 

    However, when I execute luvcvideo, the console shows 

 

  Video driver: x11

  A window manager is available

 

    I was wondering that luvcview lacks XVideo support or UVCVideo doesn't
provide the video format that supports XVideo?

 

    Another problem is skype. In skype chat & video window, it ate 100% of
CPU powers and A/V was out of sync. I didn't know which one is the
bottleneck in skype. That's why I asked for help here.

 

    I am new to the video processing in Linux, so some problems are
conceptual. Any information and wikis are welcome.

 

    Thanks for reading this mail.

 

Best regards,

Asho

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100609/e5d8a95a/attachment.html>

From pj.assis at gmail.com  Wed Jun  9 10:57:56 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 9 Jun 2010 09:57:56 +0100
Subject: [Linux-uvc-devel] XVideo support?
In-Reply-To: <AANLkTil4yxFRr4xnSLU8TOlrq2bCWiHzijiwylXDnt9m@mail.gmail.com>
References: <AANLkTil4yxFRr4xnSLU8TOlrq2bCWiHzijiwylXDnt9m@mail.gmail.com>
Message-ID: <AANLkTilaqRHsfshD1nxDr2RWWZuMs3Ih_dAcxCE1kz4a@mail.gmail.com>

Hi,

2010/6/9 Asho Yeh - ?? <ashoyeh at gmail.com>:
> Hi,
> ?? ?I am new to the UVC project. Currently I am working on video
> conferencing on Linux and met some performance issues. I hope you experts
> can help me to solve these.
> ?? ?My target board is
> VIA CLE266 which onboard an VIA C3 1Ghz CPU.
> 512MB DDR333 Dimm.
> Logitech C100 webcam.
> ?? ?480p mpeg2 video playback with mplayer and xvideo costs 20~30% of CPU
> powers. 50~70% of CPU powers with 720p mpeg2 video file.
> ?? ?However, when I execute luvcvideo, the console shows
> ??Video driver: x11
> ??A window manager is available
> ?? ?I was wondering that luvcview lacks XVideo support or UVCVideo doesn't
> provide the video format that supports XVideo?

luvcview uses SDL for rendering (yuv overlay), this in turn uses
xvideo internally.
I actually did some tests a while back and I couldn't find any
difference in terms
of performance between SDL and xv direct rendering, other people may have
a different idea.

uvcvideo doesn't provide any formats, it just supplies whatever is
available in the
hardware, usually MJPG or YUYV

> ?? ?Another problem is skype. In skype chat & video window, it ate 100% of
> CPU powers and A/V was out of sync. I didn't know which one is the
> bottleneck in skype. That's why I asked for help here.

Skype is closed source so I don't know anything about its internals, sorry.


Best Regards,
Paulo Assis

> ?? ?I am new to the video processing in Linux, so some problems are
> conceptual. Any information and wikis are welcome.
> ?? ?Thanks for reading this mail.
> Best regards,
> Asho
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>


From public_filter at yahoo.com  Wed Jun  9 22:14:04 2010
From: public_filter at yahoo.com (P F)
Date: Wed, 9 Jun 2010 13:14:04 -0700 (PDT)
Subject: [Linux-uvc-devel] [RFC] Discard overrun (corrupted) RX images
In-Reply-To: <314384.29017.qm@web120001.mail.ne1.yahoo.com>
Message-ID: <945576.56175.qm@web120017.mail.ne1.yahoo.com>

--- On Wed, 6/9/10, P F <public_filter at yahoo.com> wrote:

> From: P F <public_filter at yahoo.com>
> Subject: [Linux-uvc-devel] [RFC] Discard overrun (corrupted) RX images
> To: linux-uvc-devel at lists.berlios.de
> Date: Wednesday, June 9, 2010, 12:59 AM
> Hi,
> 
> First of all, thank you for providing such great Linux
> support for webcams.? I have encountered an issue in this
> area that I hope you experts can help with.
> 
> I am using UVC/V4L on an embedded system, and I am
> experiencing a problem with corrupted camera images.? The
> system consists of a custom ASIC with an ARM926EJ-S and OHCI
> USB host controller connected to a UVC camera which supports
> only MJPEG.
> 
> The problem I have is that buffers dequeued in user space
> occasionally contain corrupted JPEGs.? This corruption
> ranges from slight, with a row of macroblocks shifted, to
> severe, with the JPEG being totally undecompressible.
> 
> If I enable UVC_TRACE_FRAME, I see several instances of:
> "uvcvideo: USB isochronous frame lost (-70)."
> in dmesg.? I have noticed a correlation between the
> presence of this message and visual corruption in captured
> JPEGs.
> 
> I see that this error code corresponds to -ECOMM, which in
> turn corresponds to TD_BUFFEROVERRUN in the isochronous
> packet status.? I assume that this is caused by CPU
> starvation, which should just manifest as dropped frames.
> 
> However, I think these overrun frames are not being
> dropped, and instead are being passed to user space in an
> indeterminate state, leading to the visual corruption that
> I've witnessed.
> 
> The attached patch (against 2.6.31) is my na?ve attempt at
> fixing the problem.? It does appear to resolve the
> corruption, but I am not entirely sure it's the correct
> thing to do.? Does it look reasonable?? I would appreciate
> any feedback.
> 
> Thank you,
> Filter
> 
> 
> ? ? ? 
> -----Inline Attachment Follows-----
> 
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> 

I have discovered that the previous patch works only when some
significant amount of tracing is active. e.g., UVC_TRACE_FRAME or
UVC_TRACE_IOCTL.  With tracing completely disabled, the patch has no
effect.  Activating tracing without the patch also does not resolve the
corruption.

Clearly, I have more investigation to do.  If anybody has ideas about what
might be occurring, I would like to hear them.

Thank you,
Filter


      


From senada at t-online.de  Thu Jun 10 17:38:04 2010
From: senada at t-online.de (seno)
Date: Thu, 10 Jun 2010 15:38:04 +0000 (UTC)
Subject: [Linux-uvc-devel] 0402:5606 ALi Corp. USB 2.0 Camera - NO FULL
	SIZED OUTPUT
Message-ID: <loom.20100610T163437-102@post.gmane.org>

Hi,

I have the problem that all webcam applications show only about half of the 
real picture (or even less).

I have tried
- LUVCview
- UCView
- Skype
- Cheese
- MPlayer
- Adobe Flash webcam access in webbrowser

lsusb output is 
ID 0402:5606 ALi Corp. USB 2.0 Camera

The cam is integrated into a Clevo M72SR notebook running Mandriva 2010.0 
x86_64, but the issue exists also on Mandriva 2010.0 x86 and 2009.1 and 2009.0 
etc...

I updated the Bios 1 or 2 years ago and can't say for sure if the cam worked 
properly before, but I think it did...
Can a Bios update bring up webcam malfunction?

The default driver in Win 7 had similar problems and I had to download the Win 
7 driver from Clevo website to get the cam working
ftp://cftp.clevo.com.tw/M72xSR/Optional/Camera_all.zip
After this driver is installed on Win 7, the webcam shows up as "Bison NB Pro" 
in the device manager and works flawlessly.

I also noticed slow performance in Linux, the cam makes 2 - 5 fps, even at good 
exposure.

dmesg output when cam is detected:

usb 1-8: new high speed USB device using ehci_hcd and address 6
usb 1-8: New USB device found, idVendor=0402, idProduct=5606
usb 1-8: New USB device strings: Mfr=0, Product=1, SerialNumber=0
usb 1-8: Product: USB2.0 Camera
usb 1-8: configuration #1 chosen from 1 choice
uvcvideo: Found UVC 1.00 device USB2.0 Camera (0402:5606)
input: USB2.0 Camera as /devices/pci0000:00/0000:00:03.3/usb1/1-8/1-8:1.0/input/
input15

dmesg output when accessing device:

uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to lowest.
uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to lowest.
uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to lowest.
uvcvideo: Failed to query (129) UVC control 2 (unit 5) : -110 (exp. 2).
uvcvideo: Failed to query (129) UVC control 2 (unit 5) : -110 (exp. 2).
uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -32 (exp. 1).
uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -32 (exp. 1).
uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -32 (exp. 1).
uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to lowest.
uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to lowest.
uvcvideo: Failed to query (129) UVC control 6 (unit 5) : -110 (exp. 2).
uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -110 (exp. 1).
uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -32 (exp. 1).
uvcvideo: Failed to query (129) UVC control 3 (unit 1) : -32 (exp. 1).
uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to lowest.

Any idea how to get this cam working?



From ashoyeh at gmail.com  Fri Jun 11 04:51:30 2010
From: ashoyeh at gmail.com (=?Big5?B?QXNobyBZZWggLSCq/KtI?=)
Date: Fri, 11 Jun 2010 10:51:30 +0800
Subject: [Linux-uvc-devel] XVideo support?
In-Reply-To: <B85D3DCFCADB439BBD695957534DC0F3@core2>
References: <AANLkTil4yxFRr4xnSLU8TOlrq2bCWiHzijiwylXDnt9m@mail.gmail.com>
	<B85D3DCFCADB439BBD695957534DC0F3@core2>
Message-ID: <AANLkTikBy4dAWtH2IC5-uM9hCTG1OalXDLCH5Q-apeT2@mail.gmail.com>

Hi Adrian

Thanks for you great help for me to understand the relations between Xvideo
and UVC devices.
I did some tests and comments below.

2010/6/9 Adrian Sergiu DARABANT <asergiu at yahoo.co.uk>

>  Hello
>
>    Luvcview uses SDL if I remember well since a few months when I looked
> into the sources. As I know there is no direct support or control in SDL
> over which rendering engine is used behind the scenes. With XVideo you
> normally get yuv formats and sometimes and for some video drivers/cards you
> also get RGB.
>
 Besides luvcview, I also tested the mplayer/vlc to capture/playback the
video frames from webcam. Video output were set to Xvideo mode and frame
size were 640x480/YUV format.
The CPU usages were low to 20~30%, so I think the bottleneck is not uvc
devices.

> Mpeg2 is a compressed format that is decompressed most of the times into an
> accelerated YUV format. YUV formats can be directly sent to the video card
> using XVideo ? if that's available.
>
Thanks for the explanation of video extraction flow. I searched the wiki
page of Xvideo(http://en.wikipedia.org/wiki/X_video_extension) ,
it mentions "The feature is known as *hardware scaling andYUV </wiki/YUV>
 acceleration* or sometimes as *2D hardware acceleration*."

As the explanation tells, I think the XVideo is work because the video frame
I got is pure YUV format.

>
>
> You should look in your case what part: mpeg2 decompression or display
> takes up the CPU time.
>
>
>
> Now on the other side if your card uses the vesa drivers to display to the
> screen XVideo extension is never available for that driver.
>
> UVC does provide 2D accelerated formats (it mostly provides only those and
> MJPEG)
>
>
>
> 1)       Take a look into Xorg.0.log and check the video used driver.
>
The video driver is openchrome and xvinfo shows
 X-Video Extension version 2.2
screen #0
  Adaptor #0: "XV_SWOV"
    number of ports: 1
    port base: 68
    operations supported: PutImage
    supported visuals:
      depth 24, visualID 0x22
      depth 24, visualID 0x23
      depth 24, visualID 0x24
      depth 24, visualID 0x25
      depth 24, visualID 0x26
      depth 24, visualID 0x27
      depth 24, visualID 0x28
      depth 24, visualID 0x29
      depth 24, visualID 0x2a
      depth 24, visualID 0x2b
      depth 24, visualID 0x2c
      depth 24, visualID 0x2d
    number of attributes: 6
      "XV_COLORKEY" (range 0 to 16777215)
              client settable attribute
              client gettable attribute (current value is 2081)
      "XV_BRIGHTNESS" (range 0 to 10000)
              client settable attribute
              client gettable attribute (current value is 5000)
      "XV_CONTRAST" (range 0 to 20000)
              client settable attribute
              client gettable attribute (current value is 10000)
      "XV_SATURATION" (range 0 to 20000)
              client settable attribute
              client gettable attribute (current value is 10000)
      "XV_HUE" (range -180 to 180)
              client settable attribute
              client gettable attribute (current value is 0)
      "XV_AUTOPAINT_COLORKEY" (range 0 to 1)
              client settable attribute
              client gettable attribute (current value is 1)
    maximum XvImage size: 1920 x 1200
    Number of image formats: 6
      id: 0x32595559 (YUY2)
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)
      id: 0x32315659 (YV12)
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x434d5658 (XVMC)
        guid: 56494100-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 1
        type: YUV (planar)
      id: 0x35315652 (RV15)
        guid: 52563135-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)

2)       Check the times spent by the mpeg decompression task.
>
> 3)       xvinfo ? should help you see if XVideo can be used at all and
> what formats are available.
>
>
>
> XVideo is just a way to pass let's say a video format encoded on (for
> example) 2 bytes/pixels YUV instead of 4 (RGBA) ? to the video card. The
> video card then knows to display those video formats and knows how to scale
> them as well (eating only GPU processing time and not CPU). Usually this
> means passing just pointers to the video frame (as got from the video
> capture device) to the video card for display.
>
> As a conclusion, I think the bottleneck is  skype, thought I don't know how
to improve it.

Asho
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100611/a9ba1c7b/attachment.html>

From jesse.jaara at gmail.com  Sat Jun 12 20:06:43 2010
From: jesse.jaara at gmail.com (Gmail)
Date: Sat, 12 Jun 2010 21:06:43 +0300
Subject: [Linux-uvc-devel] Supported devoces list missing device
Message-ID: <201006122106.44251.jesse.jaara@gmail.com>

Creative's LIVE! CAM Socialize HD, works as faar as I have tested it flawlesly. 
audio also works. Tested whit 2.6.34 kernel


From pigritor at gmail.com  Sun Jun 13 16:47:14 2010
From: pigritor at gmail.com (Kabakov Boris)
Date: Sun, 13 Jun 2010 17:47:14 +0300
Subject: [Linux-uvc-devel] UL30VT+064e:a136 Suyin Corp
Message-ID: <AANLkTimPnktqvzn-hEd3HW4y3xNor7fd_ptxsX2_bU16@mail.gmail.com>

Hi,
Maybe it sounds weird but Ii did find a combination, that you don''t have n
list:
Bus 001 Device 003: ID 064e:a136 Suyin Corp. + Asus UL30VT

You have both of them, but separate from each other.

>From v4l-utils-0.7.91/lib/libv4lconvert/control/libv4lcontrol.c:

{ 0x04f2, 0xb036, 0, "ASUSTeK Computer Inc.        ", "UL30VT    ",
>   V4LCONTROL_HFLIPPED|V4LCONTROL_VFLIPPED },
>
   { 0x064e, 0xa136, 0, "ASUSTeK Computer Inc.        ", "UL30A     ",
>     V4LCONTROL_HFLIPPED|V4LCONTROL_VFLIPPED },
>   { 0x064e, 0xa136, 0, "ASUSTeK Computer Inc.        ", "UL50A     ",
>     V4LCONTROL_HFLIPPED|V4LCONTROL_VFLIPPED },
>   { 0x064e, 0xa136, 0, "ASUSTeK Computer Inc.        ", "UL50Ag    ",
>     V4LCONTROL_HFLIPPED|V4LCONTROL_VFLIPPED },
>   { 0x064e, 0xa136, 0, "ASUSTeK Computer Inc.        ", "UL50Vg    ",
>     V4LCONTROL_HFLIPPED|V4LCONTROL_VFLIPPED },
>   { 0x064e, 0xa136, 0, "ASUSTeK Computer Inc.        ", "UL50VT    ",
>     V4LCONTROL_HFLIPPED|V4LCONTROL_VFLIPPED },
>

But when I tried to add 2 strings with my combination notebook\webcam or
just edit webcam id in existing one - happens nothing.
 I still can't get vertical flip check-box in v4l2ucp. Maybe because I don't
understand how it actually works.
Please help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100613/8df7ee05/attachment.html>
-------------- next part --------------
Bus 008 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 003 Device 002: ID 0b05:1751 ASUSTek Computer, Inc. 
Bus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 001 Device 003: ID 064e:a136 Suyin Corp. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
-------------- next part --------------
# dmidecode 2.10
SMBIOS 2.5 present.
34 structures occupying 1791 bytes.
Table at 0x000FCFE0.

Handle 0x0000, DMI type 0, 24 bytes
BIOS Information
	Vendor: American Megatrends Inc.
	Version: 210    
	Release Date: 03/02/2010
	Address: 0xF0000
	Runtime Size: 64 kB
	ROM Size: 1024 kB
	Characteristics:
		ISA is supported
		PCI is supported
		PNP is supported
		BIOS is upgradeable
		BIOS shadowing is allowed
		ESCD support is available
		Boot from CD is supported
		Selectable boot is supported
		EDD is supported
		5.25"/1.2 MB floppy services are supported (int 13h)
		3.5"/720 kB floppy services are supported (int 13h)
		3.5"/2.88 MB floppy services are supported (int 13h)
		Print screen service is supported (int 5h)
		8042 keyboard services are supported (int 9h)
		Printer services are supported (int 17h)
		CGA/mono video services are supported (int 10h)
		ACPI is supported
		USB legacy is supported
		Smart battery is supported
		BIOS boot specification is supported
		Function key-initiated network boot is supported
		Targeted content distribution is supported
	BIOS Revision: 2.10
	Firmware Revision: 176.1

Handle 0x0001, DMI type 1, 27 bytes
System Information
	Manufacturer: ASUSTeK Computer Inc.        
	Product Name: UL30VT              
	Version: 1.0       
	Serial Number: A2N0AS226383076     
	UUID: 804F5AE9-6E15-DF81-36D6-E0CB4EAE5EB6
	Wake-up Type: Power Switch
	SKU Number:                     
	Family:                     

Handle 0x0002, DMI type 2, 15 bytes
Base Board Information
	Manufacturer: ASUSTeK Computer Inc.        
	Product Name: UL30VT    
	Version: 1.0       
	Serial Number: BSN12345678901234567
	Asset Tag: ATN12345678901234567
	Features:
		Board is a hosting board
		Board requires at least one daughter board
		Board is replaceable
	Location In Chassis: MIDDLE              
	Chassis Handle: 0x0003
	Type: Motherboard
	Contained Object Handles: 0

Handle 0x0003, DMI type 3, 21 bytes
Chassis Information
	Manufacturer: ASUSTeK Computer Inc.        
	Type: Notebook
	Lock: Not Present
	Version: 1.0       
	Serial Number: CSN12345678901234567
	Asset Tag: ATN12345678901234567
	Boot-up State: Safe
	Power Supply State: Safe
	Thermal State: Other
	Security Status: Other
	OEM Information: 0x00000000
	Height: Unspecified
	Number Of Power Cords: 1
	Contained Elements: 0

Handle 0x0004, DMI type 4, 40 bytes
Processor Information
	Socket Designation: Socket 478
	Type: Central Processor
	Family: Other
	Manufacturer: Intel            
	ID: 7A 06 01 00 FF FB EB BF
	Version: Genuine Intel(R) CPU U7300 @ 1.30GHz                
	Voltage: 1.0 V
	External Clock: 200 MHz
	Max Speed: 1300 MHz
	Current Speed: 1300 MHz
	Status: Populated, Enabled
	Upgrade: Socket 478
	L1 Cache Handle: 0x0005
	L2 Cache Handle: 0x0007
	L3 Cache Handle: Not Provided
	Serial Number: PSN12345678901234567
	Asset Tag: PATN1234567890123456
	Part Number: PPN12345678901234567
	Core Count: 2
	Core Enabled: 2
	Thread Count: 2
	Characteristics:
		64-bit capable

Handle 0x0005, DMI type 7, 19 bytes
Cache Information
	Socket Designation: L1-Cache
	Configuration: Enabled, Not Socketed, Level 1
	Operational Mode: Write Back
	Location: Internal
	Installed Size: 64 kB
	Maximum Size: 64 kB
	Supported SRAM Types:
		Other
	Installed SRAM Type: Other
	Speed: Unknown
	Error Correction Type: Single-bit ECC
	System Type: Data
	Associativity: 8-way Set-associative

Handle 0x0006, DMI type 7, 19 bytes
Cache Information
	Socket Designation: L1-Cache
	Configuration: Enabled, Not Socketed, Level 1
	Operational Mode: Write Back
	Location: Internal
	Installed Size: 64 kB
	Maximum Size: 64 kB
	Supported SRAM Types:
		Other
	Installed SRAM Type: Other
	Speed: Unknown
	Error Correction Type: Single-bit ECC
	System Type: Instruction
	Associativity: 8-way Set-associative

Handle 0x0007, DMI type 7, 19 bytes
Cache Information
	Socket Designation: L2-Cache
	Configuration: Enabled, Not Socketed, Level 2
	Operational Mode: Write Back
	Location: Internal
	Installed Size: 3072 kB
	Maximum Size: 3072 kB
	Supported SRAM Types:
		Other
	Installed SRAM Type: Other
	Speed: Unknown
	Error Correction Type: Single-bit ECC
	System Type: Unified
	Associativity: Other

Handle 0x0008, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J1A1
	Internal Connector Type: None
	External Reference Designator: Keyboard
	External Connector Type: PS/2
	Port Type: Keyboard Port

Handle 0x0009, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J2A2
	Internal Connector Type: None
	External Reference Designator: USB1
	External Connector Type: Access Bus (USB)
	Port Type: USB

Handle 0x000A, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J2A2
	Internal Connector Type: None
	External Reference Designator: USB2
	External Connector Type: Access Bus (USB)
	Port Type: USB

Handle 0x000B, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J4A1
	Internal Connector Type: None
	External Reference Designator: HDMI
	External Connector Type: Other
	Port Type: Other

Handle 0x000C, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J2A1
	Internal Connector Type: None
	External Reference Designator: ESATA
	External Connector Type: SAS/SATA Plug Receptacle
	Port Type: SATA

Handle 0x000D, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J6A1
	Internal Connector Type: None
	External Reference Designator: Audio Mic In
	External Connector Type: Mini Jack (headphones)
	Port Type: Audio Port

Handle 0x000E, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J6A1
	Internal Connector Type: None
	External Reference Designator: Audio Line In
	External Connector Type: Mini Jack (headphones)
	Port Type: Audio Port

Handle 0x000F, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J6A1
	Internal Connector Type: None
	External Reference Designator: Audio Line Out
	External Connector Type: Mini Jack (headphones)
	Port Type: Audio Port

Handle 0x0010, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J5A1
	Internal Connector Type: None
	External Reference Designator: USB3
	External Connector Type: Access Bus (USB)
	Port Type: USB

Handle 0x0011, DMI type 8, 9 bytes
Port Connector Information
	Internal Reference Designator: J5A1
	Internal Connector Type: None
	External Reference Designator: LAN
	External Connector Type: RJ-45
	Port Type: Network Port

Handle 0x0012, DMI type 9, 13 bytes
System Slot Information
	Designation: PCI Express Card
	Type: 64-bit PCI Express
	Current Usage: In Use
	Length: Short
	ID: 0
	Characteristics:
		3.3 V is provided
		Opening is shared
		PME signal is supported

Handle 0x0013, DMI type 10, 6 bytes
On Board Device Information
	Type: Video
	Status: Enabled
	Description:   To Be Filled By O.E.M.

Handle 0x0014, DMI type 10, 6 bytes
On Board Device Information
	Type: SATA Controller
	Status: Enabled
	Description:  To Be Filled By O.E.M.

Handle 0x0015, DMI type 10, 6 bytes
On Board Device Information
	Type: Ethernet
	Status: Enabled
	Description: To Be Filled By O.E.M.

Handle 0x0016, DMI type 10, 6 bytes
On Board Device Information
	Type: Token Ring
	Status: Enabled
	Description:  To Be Filled By O.E.M.

Handle 0x0017, DMI type 13, 22 bytes
BIOS Language Information
	Installable Languages: 1
		en|US|iso8859-1
	Currently Installed Language: en|US|iso8859-1

Handle 0x0018, DMI type 16, 15 bytes
Physical Memory Array
	Location: System Board Or Motherboard
	Use: System Memory
	Error Correction Type: None
	Maximum Capacity: 8 GB
	Error Information Handle: Not Provided
	Number Of Devices: 2

Handle 0x0019, DMI type 19, 15 bytes
Memory Array Mapped Address
	Starting Address: 0x00000000000
	Ending Address: 0x000BFFFFFFF
	Range Size: 3 GB
	Physical Array Handle: 0x0018
	Partition Width: 0

Handle 0x001A, DMI type 17, 27 bytes
Memory Device
	Array Handle: 0x0018
	Error Information Handle: Not Provided
	Total Width: 64 bits
	Data Width: 64 bits
	Size: 2048 MB
	Form Factor: SODIMM
	Set: None
	Locator: SODIMM0
	Bank Locator: BANK0
	Type: Other
	Type Detail: Synchronous
	Speed: 1066 MHz
	Manufacturer: N/A                           
	Serial Number: N/A                           
	Asset Tag: N/A                           
	Part Number: N/A                           

Handle 0x001B, DMI type 20, 19 bytes
Memory Device Mapped Address
	Starting Address: 0x00000000000
	Ending Address: 0x0007FFFFFFF
	Range Size: 2 GB
	Physical Device Handle: 0x001A
	Memory Array Mapped Address Handle: 0x0019
	Partition Row Position: Unknown
	Interleave Position: Unknown
	Interleaved Data Depth: Unknown

Handle 0x001C, DMI type 17, 27 bytes
Memory Device
	Array Handle: 0x0018
	Error Information Handle: Not Provided
	Total Width: 64 bits
	Data Width: 64 bits
	Size: 1024 MB
	Form Factor: SODIMM
	Set: None
	Locator: SODIMM1
	Bank Locator: BANK1
	Type: Other
	Type Detail: Synchronous
	Speed: 1066 MHz
	Manufacturer: N/A                           
	Serial Number: N/A                           
	Asset Tag: N/A                           
	Part Number: N/A                           

Handle 0x001D, DMI type 20, 19 bytes
Memory Device Mapped Address
	Starting Address: 0x00080000000
	Ending Address: 0x000BFFFFFFF
	Range Size: 1 GB
	Physical Device Handle: 0x001C
	Memory Array Mapped Address Handle: 0x0019
	Partition Row Position: Unknown
	Interleave Position: Unknown
	Interleaved Data Depth: Unknown

Handle 0x001E, DMI type 22, 26 bytes
Portable Battery
	Location: In the back
	Manufacturer: AS176OC2KF
	Manufacture Date: 09/11/15
	Serial Number: A200
	Name: UL50-56         
	Chemistry: Other
	Design Capacity: 5600 mWh
	Design Voltage: 15000 mV
	SBDS Version: SMART Ver 0123
	Maximum Error: Unknown
	OEM-specific Information: 0x00000000

Handle 0x001F, DMI type 129, 8 bytes
OEM-specific Type
	Header and Data:
		81 08 1F 00 01 01 02 01
	Strings:
		Intel_ASF
		Intel_ASF_001

Handle 0x0020, DMI type 200, 27 bytes
OEM-specific Type
	Header and Data:
		C8 1B 20 00 01 02 03 00 00 00 00 00 00 00 00 00
		00 00 00 00 00 00 00 00 00 00 00
	Strings:
		ASUSTeK Computer Inc.        
		Notebook  
		1.0       

Handle 0x0021, DMI type 127, 4 bytes
End Of Table

From pigritor at gmail.com  Mon Jun 14 21:46:04 2010
From: pigritor at gmail.com (banderlog)
Date: Mon, 14 Jun 2010 22:46:04 +0300
Subject: [Linux-uvc-devel] UL30VT+064e:a136 Suyin Corp
In-Reply-To: <AANLkTimPnktqvzn-hEd3HW4y3xNor7fd_ptxsX2_bU16@mail.gmail.com>
References: <AANLkTimPnktqvzn-hEd3HW4y3xNor7fd_ptxsX2_bU16@mail.gmail.com>
Message-ID: <4C1686FC.4050907@gmail.com>

I'm terribly sorry, this combination included in  v4l-utils-0.8.0

Source code easily compiles and everirhing working except bloody 
vertical flip.
qv4l2 hasn't such option (I did try LD_PRELOAD), v4l2-ucp alsa doesn't 
have it, and webcam image upside-down everywhere except guvcview, 
because it has VFlip filter.

I read /*libv4l testing instructions */it didn't help.

I don't have a  dmi folder in `/sys/devices/virtual/' maybe this is a 
problem?

13.06.2010 17:47, Kabakov Boris ?????:
> Hi,
> Maybe it sounds weird but Ii did find a combination, that you don''t 
> have n list:
> Bus 001 Device 003: ID 064e:a136 Suyin Corp. + Asus UL30VT
>
> You have both of them, but separate from each other.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100614/16985868/attachment.html>

From ctarwater at gmail.com  Mon Jun 14 23:35:55 2010
From: ctarwater at gmail.com (C Tarwater)
Date: Mon, 14 Jun 2010 17:35:55 -0400
Subject: [Linux-uvc-devel] Please test latest libv4l with your upside
	down uvc webcam
In-Reply-To: <4C0F536F.1060101@redhat.com>
References: <4C0F536F.1060101@redhat.com>
Message-ID: <AANLkTim1_Jkq8m_TvlGPkYclNSwnGoVh-fhC7rxX5nDR@mail.gmail.com>

Everything compiles fine and programs like cheese are flipped but I cannot
get skype to flip the image even with LD_PRELOAD.  Granted, I am running a
64 bit system so my distro (Arch Linux) offers custom PKGBUILDS for
skype<http://aur.archlinux.org/packages.php?ID=7914>and
libv4l <http://aur.archlinux.org/packages.php?ID=20859> on 64-bit systems so
that could be the problem as well.


On Wed, Jun 9, 2010 at 4:40 AM, Hans de Goede <hdegoede at redhat.com> wrote:

> Hi,
>
> Thanks for providing the requested information. I've just made
> a new (test) release of v4l-utils (which includes libv4l) which
> contains your laptop info in its upside down table, and as such
> should fix (work around) the upside down issue for you.
>
> You can download this new version here:
> http://people.fedoraproject.org/~jwrdegoede/v4l-utils-0.8.1-test.tar.gz
>
> 1. Install
> ===========
>
> Howto install and test v4l-utils depends on your system. There are
> different instructions for if you have a 32 bit system or a 64 bit system.
> which is using multilib. A 64 bit system without multilib is the same as
> a 32 bit system.
>
> To find out what you have do:
> ls -d /usr/lib64
>
> If this command gives a "No such file or directory" error, use the
> Non multilib instructions, if the second command is successfull, you have
> multilib,
> to find out which version (dubbed Fedora and Ubuntu multilib, because those
> are
> the most well known examples, do):
>
> ls -d /usr/lib32
> If this command gives a "No such file or directory" error, use the Fedora
> multilib
> instructions. If this command succeeds use the Ubuntu multilib
> instructions. Note
> the ubuntu multilib instructions also apply to gentoo.
>
> Non multilib instructions:
> -------------------------------
> tar xvfz v4l-utils-<version>.tar.gz
> cd v4l-utils-<version>/lib
> make PREFIX=/usr
> sudo make install PREFIX=/usr
>
> Fedora Multilib instructions:
> -----------------------------------
> Basic 64 bit install:
> tar xvfz v4l-utils-<version>.tar.gz
> cd v4l-utils-<version>/lib
> make PREFIX=/usr LIBDIR=/usr/lib64
> sudo make install PREFIX=/usr LIBDIR=/usr/lib64
>
> If you also want to use 32 bit apps (such as skype), you
> will need to have the 32 bit libc headers installed, on Fedora
> this can be done like this:
> Fedora 10-: "sudo yum install glibc-devel.i386"
> Fedora 11:  "sudo yum install glibc-devel.i586"
> Fedora 12+: "sudo yum install glibc-devel.i686"
> Then do:
> make clean
> make PREFIX=/usr CFLAGS=-m32 LDFLAGS=-m32
> sudo make install PREFIX=/usr
>
> Ubuntu Multilib instructions:
> -----------------------------------
> tar xvfz v4l-utils-<version>.tar.gz
> cd v4l-utils-<version>/lib
> make PREFIX=/usr
> sudo make install PREFIX=/usr
>
> If you also want to use 32 bit apps (such as skype), you
> will need to have the 32 bit libc headers installed, on Ubuntu
> this can be done like this:
> sudo apt-get install libc6-dev-i386
> On gentoo this can be done like this:
> sudo emerge -v app-emulation/emul-linux-x86-compat
> Then do:
> make clean
> make PREFIX=/usr CFLAGS=-m32 LDFLAGS=-m32 LIBDIR=/usr/lib32
> sudo make install PREFIX=/usr LIBDIR=/usr/lib32
>
>
> 2. Testing
> ========
> You have a chance that your webcam app use libv4l or have an appropriate
> script starting it. In that case you don't have to do anything. Just run
> the application. This is the most common situation with Ubuntu and Fedora
> packages. If your problem remains unsolved, then your app might not use
> libv4l.
> In that case start the application from a terminal like this:
>
> Non multilib:
> ----------------
> LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so <your favorite webcam app>
>
> Note on Ubuntu sometimes skype is using a wrapper script, so if skype
> does not work try:
> LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype.real
>
> Fedora multilib:
> --------------------
> For 64 bit applications (allmost all apps):
> LD_PRELOAD=/usr/lib64/libv4l/v4l1compat.so <your favorite webcam app>
>
> For 32 bit applications (you only need it for proprietary softwares, which
> don't have a 64 bit version, like skype):
> LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype
>
> Ubuntu multilib:
> --------------------
> For 64 bit applications (allmost all apps):
> LD_PRELOAD=/usr/lib64/libv4l/v4l1compat.so skype
>
> For 32 bit applications (you only need it for proprietary softwares, which
> don't have a 64 bit version, like skype):
> LD_PRELOAD=/usr/lib32/libv4l/v4l1compat.so skype
>
> Note on Ubuntu sometimes skype is using a wrapper script, so if skype
> does not work try:
> LD_PRELOAD=/usr/lib32/libv4l/v4l1compat.so skype.real
>
>
>
> Please let me know if this version of v4l-utils turns the image the
> right way up for you.
>
> Thanks & Regards,
>
> Hans
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100614/cdca27bf/attachment.html>

From pigritor at gmail.com  Mon Jun 14 23:49:56 2010
From: pigritor at gmail.com (banderlog)
Date: Tue, 15 Jun 2010 00:49:56 +0300
Subject: [Linux-uvc-devel] UL30VT+064e:a136 Suyin Corp
In-Reply-To: <4C1686FC.4050907@gmail.com>
References: <AANLkTimPnktqvzn-hEd3HW4y3xNor7fd_ptxsX2_bU16@mail.gmail.com>
	<4C1686FC.4050907@gmail.com>
Message-ID: <4C16A404.10103@gmail.com>

Yep, as I thought X)

I had to enable this in kernel to make vflip work:

Symbol: DMIID [=y]
Prompt: Export DMI identification via sysfs to userspace
Defined at drivers/firmware/Kconfig:106
Depends on: DMI [=y]
Location:
->  Firmware Drivers


As I understood libv4l getting vars from '/sys/devices/virtual/dmi', not 
from dmidecode's OUT


14.06.2010 22:46, banderlog ?????:
> I don't have a  dmi folder in `/sys/devices/virtual/' maybe this is a 
> problem?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100615/3924e533/attachment.html>

From franz.trierweiler.ingenieur at gmail.com  Tue Jun 15 18:20:03 2010
From: franz.trierweiler.ingenieur at gmail.com (Franz TRIERWEILER)
Date: Tue, 15 Jun 2010 18:20:03 +0200
Subject: [Linux-uvc-devel] uvcvideo.h not available in linux header but in
	linux sources
Message-ID: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>

Hi,

I am porting a library based on uvc to an ARM core and am creating a RPM
package.

My library build needs uvcvideo.h. I expected this header file to be simply
available from Linux headers /usr/src/linux/include. In fact it is only
availabe from the kernel sources, nested in my cross toolchain BUILD
directory. Why is not it available through the kernel header since it can be
built-in the kernel?

Maybe do I misunderstand what Linux headers are really.

Regards,
Franz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100615/c500bfbb/attachment.html>

From pj.assis at gmail.com  Tue Jun 15 18:36:00 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Tue, 15 Jun 2010 17:36:00 +0100
Subject: [Linux-uvc-devel] uvcvideo.h not available in linux header but
	in linux sources
In-Reply-To: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
References: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
Message-ID: <AANLkTikJg6IBAev5bTNo2mc97TQ-1goCsJ7axwr3d3i_@mail.gmail.com>

Hi,

2010/6/15 Franz TRIERWEILER <franz.trierweiler.ingenieur at gmail.com>:
> Hi,
>
> I am porting a library based on uvc to an ARM core and am creating a RPM
> package.
>
> My library build needs uvcvideo.h. I expected this header file to be simply
> available from Linux headers /usr/src/linux/include. In fact it is only
> availabe from the kernel sources, nested in my cross toolchain BUILD
> directory. Why is not it available through the kernel header since it can be
> built-in the kernel?
>

This is supposed to become available in upcoming kernels, I'm not sure
when exactly (2.6.35 ?? )
Laurent is the best person to answer this question.

Regards,
Paulo

> Maybe do I misunderstand what Linux headers are really.
>
> Regards,
> Franz
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>
>


From claunia at claunia.com  Wed Jun 16 15:00:09 2010
From: claunia at claunia.com (Natalia Portillo)
Date: Wed, 16 Jun 2010 14:00:09 +0100
Subject: [Linux-uvc-devel] YUYV/YUY2 between USB payload and v4l2.
In-Reply-To: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
References: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
Message-ID: <12F48541-204E-48EA-896F-CC1192C236CB@claunia.com>

Hi,

Continue with my creation of a UVC webcam inside the QEMU emulator, I've found a behavior that makes me ask myself.
"Is the payload altered in anyway by the uvcvideo driver or the video4linux api?"

What I'm currently doing is, opening the host device (also UVC in my test computer), setting format as 320x240 YUYV/YUY2, getting a frame (153600 bytes), sending a payload header to the emulated system (2 bytes only, no timestamp etc), sending the frame in 64 bytes chunks.

However in the emulated system I'm getting a whole black frame (and really slow).

There seems to be any kind of difference between what a real camera is sending me, and what I'm really getting, so I need one of two solutions:

1.- Getting that YUYV/YUY2 payload without differences, so I can resend it "as is".
2.- An easy way to convert it to MJPEG format.

While I suppose something can be done with libjpeg, my first priority is to avoid any external dependency, and I'm totally unfamiliar with that library.

Any help, guidance, etc, will be greatly thanked.

Regards,
Natalia Portillo

From pj.assis at gmail.com  Wed Jun 16 15:24:57 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 16 Jun 2010 14:24:57 +0100
Subject: [Linux-uvc-devel] YUYV/YUY2 between USB payload and v4l2.
In-Reply-To: <12F48541-204E-48EA-896F-CC1192C236CB@claunia.com>
References: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
	<12F48541-204E-48EA-896F-CC1192C236CB@claunia.com>
Message-ID: <AANLkTiniLv1ZuoSPgGTRWXmQbj6pwDhErr-GR4qw1E4j@mail.gmail.com>

Natalia Hi,
Please check guvcview source code: jpgenc.c; dct.c; huffman.c and also
vcodecs.c(compress_frame) for a built in MJPG/JPG encoder.

Regards,
Paulo

2010/6/16 Natalia Portillo <claunia at claunia.com>:
> Hi,
>
> Continue with my creation of a UVC webcam inside the QEMU emulator, I've found a behavior that makes me ask myself.
> "Is the payload altered in anyway by the uvcvideo driver or the video4linux api?"
>
> What I'm currently doing is, opening the host device (also UVC in my test computer), setting format as 320x240 YUYV/YUY2, getting a frame (153600 bytes), sending a payload header to the emulated system (2 bytes only, no timestamp etc), sending the frame in 64 bytes chunks.
>
> However in the emulated system I'm getting a whole black frame (and really slow).
>
> There seems to be any kind of difference between what a real camera is sending me, and what I'm really getting, so I need one of two solutions:
>
> 1.- Getting that YUYV/YUY2 payload without differences, so I can resend it "as is".
> 2.- An easy way to convert it to MJPEG format.
>
> While I suppose something can be done with libjpeg, my first priority is to avoid any external dependency, and I'm totally unfamiliar with that library.
>
> Any help, guidance, etc, will be greatly thanked.
>
> Regards,
> Natalia Portillo
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From claunia at claunia.com  Wed Jun 16 15:33:37 2010
From: claunia at claunia.com (Natalia Portillo)
Date: Wed, 16 Jun 2010 14:33:37 +0100
Subject: [Linux-uvc-devel] YUYV/YUY2 between USB payload and v4l2.
In-Reply-To: <AANLkTiniLv1ZuoSPgGTRWXmQbj6pwDhErr-GR4qw1E4j@mail.gmail.com>
References: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
	<12F48541-204E-48EA-896F-CC1192C236CB@claunia.com>
	<AANLkTiniLv1ZuoSPgGTRWXmQbj6pwDhErr-GR4qw1E4j@mail.gmail.com>
Message-ID: <F70F1208-4021-4163-A196-308B1B3329AF@claunia.com>

Thank Paulo,

I'll check it right now.

El 16/06/2010, a las 14:24, Paulo Assis escribi?:

> Natalia Hi,
> Please check guvcview source code: jpgenc.c; dct.c; huffman.c and also
> vcodecs.c(compress_frame) for a built in MJPG/JPG encoder.
> 
> Regards,
> Paulo
> 
> 2010/6/16 Natalia Portillo <claunia at claunia.com>:
>> Hi,
>> 
>> Continue with my creation of a UVC webcam inside the QEMU emulator, I've found a behavior that makes me ask myself.
>> "Is the payload altered in anyway by the uvcvideo driver or the video4linux api?"
>> 
>> What I'm currently doing is, opening the host device (also UVC in my test computer), setting format as 320x240 YUYV/YUY2, getting a frame (153600 bytes), sending a payload header to the emulated system (2 bytes only, no timestamp etc), sending the frame in 64 bytes chunks.
>> 
>> However in the emulated system I'm getting a whole black frame (and really slow).
>> 
>> There seems to be any kind of difference between what a real camera is sending me, and what I'm really getting, so I need one of two solutions:
>> 
>> 1.- Getting that YUYV/YUY2 payload without differences, so I can resend it "as is".
>> 2.- An easy way to convert it to MJPEG format.
>> 
>> While I suppose something can be done with libjpeg, my first priority is to avoid any external dependency, and I'm totally unfamiliar with that library.
>> 
>> Any help, guidance, etc, will be greatly thanked.
>> 
>> Regards,
>> Natalia Portillo
>> _______________________________________________
>> Linux-uvc-devel mailing list
>> Linux-uvc-devel at lists.berlios.de
>> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>> 



From laurent.pinchart at ideasonboard.com  Thu Jun 17 09:56:46 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 17 Jun 2010 09:56:46 +0200
Subject: [Linux-uvc-devel] UVC userpointer  streaming (memory mapping)
In-Reply-To: <4C0CE69C.9010902@zydacron.com>
References: <hto12i$62q$1@dough.gmane.org>
	<201006071031.32169.laurent.pinchart@ideasonboard.com>
	<4C0CE69C.9010902@zydacron.com>
Message-ID: <201006170956.47187.laurent.pinchart@ideasonboard.com>

Hi Andreas,

On Monday 07 June 2010 14:31:24 Andreas Auer wrote:
> Hi Laurent,
> 
> thanks for your help. I got it working. I tried it with the first
> approach you suggested: In the "uvc_lock_buffer" function, I do the
> ioremap of the physical address range and store the pointer in the
> uvc_buffer struct in a new variable (ioremap is not working in the
> "uvc_buffer_write" function because we are in an interrupt).
> Then, the "uvc_buffer_write" function writes the data to the memory.
> "iounmap" is done in "uvc_unlock_buffer".
> I hope that's the right way!?

Yes that's the right way, but I'd like to experiment with the workqueue 
solution. If it doesn't introduce performance issues it might be better to do 
it that way.

Could you send me the ioremap patch ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Jun 17 12:07:06 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 17 Jun 2010 12:07:06 +0200
Subject: [Linux-uvc-devel] [RFC] Discard overrun (corrupted) RX images
In-Reply-To: <314384.29017.qm@web120001.mail.ne1.yahoo.com>
References: <314384.29017.qm@web120001.mail.ne1.yahoo.com>
Message-ID: <201006171207.08894.laurent.pinchart@ideasonboard.com>

Hi,

On Wednesday 09 June 2010 02:59:30 P F wrote:
> 
> First of all, thank you for providing such great Linux support for webcams.

You're welcome.

> I have encountered an issue in this area that I hope you experts can help
> with.
> 
> I am using UVC/V4L on an embedded system, and I am experiencing a problem
> with corrupted camera images.  The system consists of a custom ASIC with
> an ARM926EJ-S and OHCI USB host controller connected to a UVC camera which
> supports only MJPEG.
> 
> The problem I have is that buffers dequeued in user space occasionally
> contain corrupted JPEGs.  This corruption ranges from slight, with a row
> of macroblocks shifted, to severe, with the JPEG being totally
> undecompressible.
> 
> If I enable UVC_TRACE_FRAME, I see several instances of:
> "uvcvideo: USB isochronous frame lost (-70)."
> in dmesg.  I have noticed a correlation between the presence of this
> message and visual corruption in captured JPEGs.
>
> I see that this error code corresponds to -ECOMM, which in turn corresponds
> to TD_BUFFEROVERRUN in the isochronous packet status.  I assume that this
> is caused by CPU starvation, which should just manifest as dropped frames.

That's correct. One or more packets will then be missing from the frame,
resulting in a corrupt image.

> However, I think these overrun frames are not being dropped, and instead
> are being passed to user space in an indeterminate state, leading to the
> visual corruption that I've witnessed.

Right. The UVC driver drops frames that are missing data due to a packet
loss for uncompressed formats only, based on the frame size (although this
behaviour is overrideable by a module parameter for users interested in
getting bad frames).

The driver should also drop corrupted corrupt frames if a packet loss has been detected.

> The attached patch (against 2.6.31) is my na?ve attempt at fixing the
> problem.  It does appear to resolve the corruption, but I am not entirely
> sure it's the correct thing to do.  Does it look reasonable?  I would
> appreciate any feedback.

Could you please try the following patch ?

diff --git a/drivers/media/video/uvc/uvc_queue.c b/drivers/media/video/uvc/uvc_queue.c
index 133c78d..580b76e 100644
--- a/drivers/media/video/uvc/uvc_queue.c
+++ b/drivers/media/video/uvc/uvc_queue.c
@@ -78,12 +78,14 @@
  *
  */
 
-void uvc_queue_init(struct uvc_video_queue *queue, enum v4l2_buf_type type)
+void uvc_queue_init(struct uvc_video_queue *queue, enum v4l2_buf_type type,
+		    int drop_corrupted)
 {
 	mutex_init(&queue->mutex);
 	spin_lock_init(&queue->irqlock);
 	INIT_LIST_HEAD(&queue->mainqueue);
 	INIT_LIST_HEAD(&queue->irqqueue);
+	queue->flags = drop_corrupted ? UVC_QUEUE_DROP_CORRUPTED : 0;
 	queue->type = type;
 }
 
@@ -435,8 +437,10 @@ int uvc_queue_enable(struct uvc_video_queue *queue, int enable)
 		uvc_queue_cancel(queue, 0);
 		INIT_LIST_HEAD(&queue->mainqueue);
 
-		for (i = 0; i < queue->count; ++i)
+		for (i = 0; i < queue->count; ++i) {
+			queue->buffer[i].error = 0;
 			queue->buffer[i].state = UVC_BUF_STATE_IDLE;
+		}
 
 		queue->flags &= ~UVC_QUEUE_STREAMING;
 	}
@@ -488,8 +492,7 @@ struct uvc_buffer *uvc_queue_next_buffer(struct uvc_video_queue *queue,
 	struct uvc_buffer *nextbuf;
 	unsigned long flags;
 
-	if ((queue->flags & UVC_QUEUE_DROP_INCOMPLETE) &&
-	    buf->buf.length != buf->buf.bytesused) {
+	if ((queue->flags & UVC_QUEUE_DROP_CORRUPTED) && buf->error) {
 		buf->state = UVC_BUF_STATE_QUEUED;
 		buf->buf.bytesused = 0;
 		return buf;
@@ -497,6 +500,7 @@ struct uvc_buffer *uvc_queue_next_buffer(struct uvc_video_queue *queue,
 
 	spin_lock_irqsave(&queue->irqlock, flags);
 	list_del(&buf->queue);
+	buf->error = 0;
 	buf->state = UVC_BUF_STATE_DONE;
 	if (!list_empty(&queue->irqqueue))
 		nextbuf = list_first_entry(&queue->irqqueue, struct uvc_buffer,
diff --git a/drivers/media/video/uvc/uvc_video.c b/drivers/media/video/uvc/uvc_video.c
index 53f3ef4..e27cf0d 100644
--- a/drivers/media/video/uvc/uvc_video.c
+++ b/drivers/media/video/uvc/uvc_video.c
@@ -555,6 +555,9 @@ static void uvc_video_decode_isoc(struct urb *urb, struct uvc_streaming *stream,
 		if (urb->iso_frame_desc[i].status < 0) {
 			uvc_trace(UVC_TRACE_FRAME, "USB isochronous frame "
 				"lost (%d).\n", urb->iso_frame_desc[i].status);
+			/* Mark the buffer as faulty. */
+			if (buf != NULL)
+				buf->error = 1;
 			continue;
 		}
 
@@ -579,8 +582,14 @@ static void uvc_video_decode_isoc(struct urb *urb, struct uvc_streaming *stream,
 		uvc_video_decode_end(stream, buf, mem,
 			urb->iso_frame_desc[i].actual_length);
 
-		if (buf->state == UVC_BUF_STATE_READY)
+		if (buf->state == UVC_BUF_STATE_READY) {
+			if (buf->buf.length != buf->buf.bytesused &&
+			    !(stream->cur_format->flags &
+			      UVC_FMT_FLAG_COMPRESSED))
+				buf->error = 1;
+
 			buf = uvc_queue_next_buffer(&stream->queue, buf);
+		}
 	}
 }
 
@@ -1104,7 +1113,7 @@ int uvc_video_init(struct uvc_streaming *stream)
 	atomic_set(&stream->active, 0);
 
 	/* Initialize the video buffers queue. */
-	uvc_queue_init(&stream->queue, stream->type);
+	uvc_queue_init(&stream->queue, stream->type, !uvc_no_drop_param);
 
 	/* Alternate setting 0 should be the default, yet the XBox Live Vision
 	 * Cam (and possibly other devices) crash or otherwise misbehave if
@@ -1197,12 +1206,6 @@ int uvc_video_enable(struct uvc_streaming *stream, int enable)
 		return 0;
 	}
 
-	if ((stream->cur_format->flags & UVC_FMT_FLAG_COMPRESSED) ||
-	    uvc_no_drop_param)
-		stream->queue.flags &= ~UVC_QUEUE_DROP_INCOMPLETE;
-	else
-		stream->queue.flags |= UVC_QUEUE_DROP_INCOMPLETE;
-
 	ret = uvc_queue_enable(&stream->queue, 1);
 	if (ret < 0)
 		return ret;
diff --git a/drivers/media/video/uvc/uvcvideo.h b/drivers/media/video/uvc/uvcvideo.h
index d1f8840..398e65a 100644
--- a/drivers/media/video/uvc/uvcvideo.h
+++ b/drivers/media/video/uvc/uvcvideo.h
@@ -385,11 +385,12 @@ struct uvc_buffer {
 	struct list_head queue;
 	wait_queue_head_t wait;
 	enum uvc_buffer_state state;
+	unsigned int error;
 };
 
 #define UVC_QUEUE_STREAMING		(1 << 0)
 #define UVC_QUEUE_DISCONNECTED		(1 << 1)
-#define UVC_QUEUE_DROP_INCOMPLETE	(1 << 2)
+#define UVC_QUEUE_DROP_CORRUPTED	(1 << 2)
 
 struct uvc_video_queue {
 	enum v4l2_buf_type type;
@@ -568,7 +569,7 @@ extern struct uvc_driver uvc_driver;
 
 /* Video buffers queue management. */
 extern void uvc_queue_init(struct uvc_video_queue *queue,
-		enum v4l2_buf_type type);
+		enum v4l2_buf_type type, int drop_corrupted);
 extern int uvc_alloc_buffers(struct uvc_video_queue *queue,
 		unsigned int nbuffers, unsigned int buflength);
 extern int uvc_free_buffers(struct uvc_video_queue *queue);
-- 
1.6.4.4

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Jun 17 12:11:02 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 17 Jun 2010 12:11:02 +0200
Subject: [Linux-uvc-devel] Supported devoces list missing device
In-Reply-To: <201006122106.44251.jesse.jaara@gmail.com>
References: <201006122106.44251.jesse.jaara@gmail.com>
Message-ID: <201006171211.02893.laurent.pinchart@ideasonboard.com>

Hi,

On Saturday 12 June 2010 20:06:43 Gmail wrote:
> Creative's LIVE! CAM Socialize HD, works as faar as I have tested it
> flawlesly. audio also works. Tested whit 2.6.34 kernel

Thanks for the report. Could you please send me the output of 'lsusb -v' for 
your webcam ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Jun 17 13:08:58 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 17 Jun 2010 13:08:58 +0200
Subject: [Linux-uvc-devel] 0402:5606 ALi Corp. USB 2.0 Camera - NO FULL
	SIZED OUTPUT
In-Reply-To: <loom.20100610T163437-102@post.gmane.org>
References: <loom.20100610T163437-102@post.gmane.org>
Message-ID: <201006171308.59325.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 10 June 2010 17:38:04 seno wrote:
> 
> I have the problem that all webcam applications show only about half of the
> real picture (or even less).

Could you post a screenshot ? Does that happen at all resolutions ?

> I have tried
> - LUVCview
> - UCView
> - Skype
> - Cheese
> - MPlayer
> - Adobe Flash webcam access in webbrowser
> 
> lsusb output is
> ID 0402:5606 ALi Corp. USB 2.0 Camera
> 
> The cam is integrated into a Clevo M72SR notebook running Mandriva 2010.0
> x86_64, but the issue exists also on Mandriva 2010.0 x86 and 2009.1 and
> 2009.0 etc...
> 
> I updated the Bios 1 or 2 years ago and can't say for sure if the cam
> worked properly before, but I think it did...
> Can a Bios update bring up webcam malfunction?

Yes, a BIOS update can even reflash the webcam firmware.

Could you please send me the output of 'lsusb -v -d 0402:5606' ? I've got a 
copy already, but the BIOS update might have modified it.

> The default driver in Win 7 had similar problems and I had to download the
> Win 7 driver from Clevo website to get the cam working
> ftp://cftp.clevo.com.tw/M72xSR/Optional/Camera_all.zip
> After this driver is installed on Win 7, the webcam shows up as "Bison NB
> Pro" in the device manager and works flawlessly.

That's bad news. The driver might use proprietary USB commands to configure 
the camera.

> I also noticed slow performance in Linux, the cam makes 2 - 5 fps, even at
> good exposure.
> 
> dmesg output when cam is detected:
> 
> usb 1-8: new high speed USB device using ehci_hcd and address 6
> usb 1-8: New USB device found, idVendor=0402, idProduct=5606
> usb 1-8: New USB device strings: Mfr=0, Product=1, SerialNumber=0
> usb 1-8: Product: USB2.0 Camera
> usb 1-8: configuration #1 chosen from 1 choice
> uvcvideo: Found UVC 1.00 device USB2.0 Camera (0402:5606)
> input: USB2.0 Camera as
> /devices/pci0000:00/0000:00:03.3/usb1/1-8/1-8:1.0/input/ input15
> 
> dmesg output when accessing device:
> 
> uvcvideo: device USB2.0 Camera requested null bandwidth, defaulting to
> lowest. uvcvideo: device USB2.0 Camera requested null bandwidth,
> defaulting to lowest. uvcvideo: device USB2.0 Camera requested null
> bandwidth, defaulting to lowest. uvcvideo: Failed to query (129) UVC
> control 2 (unit 5) : -110 (exp. 2). uvcvideo: Failed to query (129) UVC
> control 2 (unit 5) : -110 (exp. 2). uvcvideo: Failed to query (129) UVC
> control 3 (unit 1) : -32 (exp. 1). uvcvideo: Failed to query (129) UVC
> control 3 (unit 1) : -32 (exp. 1). uvcvideo: Failed to query (129) UVC
> control 3 (unit 1) : -32 (exp. 1). uvcvideo: device USB2.0 Camera
> requested null bandwidth, defaulting to lowest. uvcvideo: device USB2.0
> Camera requested null bandwidth, defaulting to lowest. uvcvideo: Failed to
> query (129) UVC control 6 (unit 5) : -110 (exp. 2). uvcvideo: Failed to
> query (129) UVC control 3 (unit 1) : -110 (exp. 1). uvcvideo: Failed to
> query (129) UVC control 3 (unit 1) : -32 (exp. 1). uvcvideo: Failed to
> query (129) UVC control 3 (unit 1) : -32 (exp. 1). uvcvideo: device USB2.0
> Camera requested null bandwidth, defaulting to lowest.
> 
> Any idea how to get this cam working?

The "Camera requested null bandwidth" error message shouldn't be an issue, at 
least if the camera has a single alternate setting like the model I know about 
has. This can be checked with the lsusb output.

The "Failed to query" messages definitely indicate a firmware bug. It might or 
might not be related to the bad picture issue you have. Would you be able to 
capture a USB trace on Windows if required ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Thu Jun 17 13:22:31 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Thu, 17 Jun 2010 13:22:31 +0200
Subject: [Linux-uvc-devel] uvcvideo.h not available in linux header but
	in linux sources
In-Reply-To: <AANLkTikJg6IBAev5bTNo2mc97TQ-1goCsJ7axwr3d3i_@mail.gmail.com>
References: <AANLkTinhsUZ0n8S-f79gMkC4zyLs_xZpMuWEXYM6zn2Y@mail.gmail.com>
	<AANLkTikJg6IBAev5bTNo2mc97TQ-1goCsJ7axwr3d3i_@mail.gmail.com>
Message-ID: <201006171322.32245.laurent.pinchart@ideasonboard.com>

Hi,

On Tuesday 15 June 2010 18:36:00 Paulo Assis wrote:
> 2010/6/15 Franz TRIERWEILER <franz.trierweiler.ingenieur at gmail.com>:
> > 
> > I am porting a library based on uvc to an ARM core and am creating a RPM
> > package.
> > 
> > My library build needs uvcvideo.h. I expected this header file to be
> > simply available from Linux headers /usr/src/linux/include. In fact it
> > is only availabe from the kernel sources, nested in my cross toolchain
> > BUILD directory. Why is not it available through the kernel header since
> > it can be built-in the kernel?
> 
> This is supposed to become available in upcoming kernels, I'm not sure
> when exactly (2.6.35 ?? )
> Laurent is the best person to answer this question.

The header should indeed be available in include/linux. I've been planning to 
move it to include/linux, but there are API changes that need to be made 
first. This won't go in 2.6.35 as we missed the merge window already, but it 
will be available for 2.6.36.

-- 
Regards,

Laurent Pinchart


From public_filter at yahoo.com  Fri Jun 18 21:26:01 2010
From: public_filter at yahoo.com (P F)
Date: Fri, 18 Jun 2010 12:26:01 -0700 (PDT)
Subject: [Linux-uvc-devel] [RFC] Discard overrun (corrupted) RX images
Message-ID: <93992.3425.qm@web120013.mail.ne1.yahoo.com>

--- On Thu, 6/17/10, Laurent Pinchart <laurent.pinchart at ideasonboard.com> wrote:

> From: Laurent Pinchart <laurent.pinchart at ideasonboard.com>
> Subject: Re: [Linux-uvc-devel] [RFC] Discard overrun (corrupted) RX images
> To: linux-uvc-devel at lists.berlios.de
> Cc: "P F" <public_filter at yahoo.com>
> Date: Thursday, June 17, 2010, 10:07 AM
> Hi,
> 
> On Wednesday 09 June 2010 02:59:30 P F wrote:
> > 
> > First of all, thank you for providing such great Linux
> support for webcams.
> 
> You're welcome.
> 
> > I have encountered an issue in this area that I hope
> you experts can help
> > with.
> > 
> > I am using UVC/V4L on an embedded system, and I am
> experiencing a problem
> > with corrupted camera images.? The system
> consists of a custom ASIC with
> > an ARM926EJ-S and OHCI USB host controller connected
> to a UVC camera which
> > supports only MJPEG.
> > 
> > The problem I have is that buffers dequeued in user
> space occasionally
> > contain corrupted JPEGs.? This corruption ranges
> from slight, with a row
> > of macroblocks shifted, to severe, with the JPEG being
> totally
> > undecompressible.
> > 
> > If I enable UVC_TRACE_FRAME, I see several instances
> of:
> > "uvcvideo: USB isochronous frame lost (-70)."
> > in dmesg.? I have noticed a correlation between
> the presence of this
> > message and visual corruption in captured JPEGs.
> >
> > I see that this error code corresponds to -ECOMM,
> which in turn corresponds
> > to TD_BUFFEROVERRUN in the isochronous packet
> status.? I assume that this
> > is caused by CPU starvation, which should just
> manifest as dropped frames.
> 
> That's correct. One or more packets will then be missing
> from the frame,
> resulting in a corrupt image.
> 
> > However, I think these overrun frames are not being
> dropped, and instead
> > are being passed to user space in an indeterminate
> state, leading to the
> > visual corruption that I've witnessed.
> 
> Right. The UVC driver drops frames that are missing data
> due to a packet
> loss for uncompressed formats only, based on the frame size
> (although this
> behaviour is overrideable by a module parameter for users
> interested in
> getting bad frames).
> 
> The driver should also drop corrupted corrupt frames if a
> packet loss has been detected.
> 
> > The attached patch (against 2.6.31) is my na?ve
> attempt at fixing the
> > problem.? It does appear to resolve the
> corruption, but I am not entirely
> > sure it's the correct thing to do.? Does it look
> reasonable?? I would
> > appreciate any feedback.
> 
> Could you please try the following patch ?
> 
> diff --git a/drivers/media/video/uvc/uvc_queue.c
> b/drivers/media/video/uvc/uvc_queue.c
> index 133c78d..580b76e 100644
> --- a/drivers/media/video/uvc/uvc_queue.c
> +++ b/drivers/media/video/uvc/uvc_queue.c
> @@ -78,12 +78,14 @@
> ? *
> ? */
>? 
> -void uvc_queue_init(struct uvc_video_queue *queue, enum
> v4l2_buf_type type)
> +void uvc_queue_init(struct uvc_video_queue *queue, enum
> v4l2_buf_type type,
> +??? ??? ? ? int
> drop_corrupted)
>? {
>? ??? mutex_init(&queue->mutex);
>? ???
> spin_lock_init(&queue->irqlock);
>? ???
> INIT_LIST_HEAD(&queue->mainqueue);
>? ???
> INIT_LIST_HEAD(&queue->irqqueue);
> +??? queue->flags = drop_corrupted ?
> UVC_QUEUE_DROP_CORRUPTED : 0;
>? ??? queue->type = type;
>? }
>? 
> @@ -435,8 +437,10 @@ int uvc_queue_enable(struct
> uvc_video_queue *queue, int enable)
>? ??? ???
> uvc_queue_cancel(queue, 0);
>? ??? ???
> INIT_LIST_HEAD(&queue->mainqueue);
>? 
> -??? ??? for (i = 0; i <
> queue->count; ++i)
> +??? ??? for (i = 0; i <
> queue->count; ++i) {
> +??? ??? ???
> queue->buffer[i].error = 0;
>? ??? ??? ???
> queue->buffer[i].state = UVC_BUF_STATE_IDLE;
> +??? ??? }
>? 
>? ??? ??? queue->flags
> &= ~UVC_QUEUE_STREAMING;
>? ??? }
> @@ -488,8 +492,7 @@ struct uvc_buffer
> *uvc_queue_next_buffer(struct uvc_video_queue *queue,
>? ??? struct uvc_buffer *nextbuf;
>? ??? unsigned long flags;
>? 
> -??? if ((queue->flags &
> UVC_QUEUE_DROP_INCOMPLETE) &&
> -??? ? ? buf->buf.length !=
> buf->buf.bytesused) {
> +??? if ((queue->flags &
> UVC_QUEUE_DROP_CORRUPTED) && buf->error) {
>? ??? ??? buf->state =
> UVC_BUF_STATE_QUEUED;
>? ??? ???
> buf->buf.bytesused = 0;
>? ??? ??? return buf;
> @@ -497,6 +500,7 @@ struct uvc_buffer
> *uvc_queue_next_buffer(struct uvc_video_queue *queue,
>? 
>? ???
> spin_lock_irqsave(&queue->irqlock, flags);
>? ??? list_del(&buf->queue);
> +??? buf->error = 0;
>? ??? buf->state = UVC_BUF_STATE_DONE;
>? ??? if
> (!list_empty(&queue->irqqueue))
>? ??? ??? nextbuf =
> list_first_entry(&queue->irqqueue, struct
> uvc_buffer,
> diff --git a/drivers/media/video/uvc/uvc_video.c
> b/drivers/media/video/uvc/uvc_video.c
> index 53f3ef4..e27cf0d 100644
> --- a/drivers/media/video/uvc/uvc_video.c
> +++ b/drivers/media/video/uvc/uvc_video.c
> @@ -555,6 +555,9 @@ static void
> uvc_video_decode_isoc(struct urb *urb, struct uvc_streaming
> *stream,
>? ??? ??? if
> (urb->iso_frame_desc[i].status < 0) {
>? ??? ??? ???
> uvc_trace(UVC_TRACE_FRAME, "USB isochronous frame "
>? ??? ??? ???
> ??? "lost (%d).\n",
> urb->iso_frame_desc[i].status);
> +??? ??? ???
> /* Mark the buffer as faulty. */
> +??? ??? ???
> if (buf != NULL)
> +??? ??? ???
> ??? buf->error = 1;
>? ??? ??? ???
> continue;
>? ??? ??? }
>? 
> @@ -579,8 +582,14 @@ static void
> uvc_video_decode_isoc(struct urb *urb, struct uvc_streaming
> *stream,
>? ??? ???
> uvc_video_decode_end(stream, buf, mem,
>? ??? ??? ???
> urb->iso_frame_desc[i].actual_length);
>? 
> -??? ??? if (buf->state ==
> UVC_BUF_STATE_READY)
> +??? ??? if (buf->state ==
> UVC_BUF_STATE_READY) {
> +??? ??? ???
> if (buf->buf.length != buf->buf.bytesused &&
> +??? ??? ???
> ? ? !(stream->cur_format->flags &
> +??? ??? ???
> ? ? ? UVC_FMT_FLAG_COMPRESSED))
> +??? ??? ???
> ??? buf->error = 1;
> +
>? ??? ??? ???
> buf = uvc_queue_next_buffer(&stream->queue, buf);
> +??? ??? }
>? ??? }
>? }
>? 
> @@ -1104,7 +1113,7 @@ int uvc_video_init(struct
> uvc_streaming *stream)
>? ??? atomic_set(&stream->active, 0);
>? 
>? ??? /* Initialize the video buffers queue.
> */
> -??? uvc_queue_init(&stream->queue,
> stream->type);
> +??? uvc_queue_init(&stream->queue,
> stream->type, !uvc_no_drop_param);
>? 
>? ??? /* Alternate setting 0 should be the
> default, yet the XBox Live Vision
>? ?????* Cam (and possibly other
> devices) crash or otherwise misbehave if
> @@ -1197,12 +1206,6 @@ int uvc_video_enable(struct
> uvc_streaming *stream, int enable)
>? ??? ??? return 0;
>? ??? }
>? 
> -??? if ((stream->cur_format->flags
> & UVC_FMT_FLAG_COMPRESSED) ||
> -??? ? ? uvc_no_drop_param)
> -??? ???
> stream->queue.flags &= ~UVC_QUEUE_DROP_INCOMPLETE;
> -??? else
> -??? ???
> stream->queue.flags |= UVC_QUEUE_DROP_INCOMPLETE;
> -
>? ??? ret =
> uvc_queue_enable(&stream->queue, 1);
>? ??? if (ret < 0)
>? ??? ??? return ret;
> diff --git a/drivers/media/video/uvc/uvcvideo.h
> b/drivers/media/video/uvc/uvcvideo.h
> index d1f8840..398e65a 100644
> --- a/drivers/media/video/uvc/uvcvideo.h
> +++ b/drivers/media/video/uvc/uvcvideo.h
> @@ -385,11 +385,12 @@ struct uvc_buffer {
>? ??? struct list_head queue;
>? ??? wait_queue_head_t wait;
>? ??? enum uvc_buffer_state state;
> +??? unsigned int error;
>? };
>? 
>? #define UVC_QUEUE_STREAMING???
> ??? (1 << 0)
>? #define UVC_QUEUE_DISCONNECTED???
> ??? (1 << 1)
> -#define UVC_QUEUE_DROP_INCOMPLETE??? (1
> << 2)
> +#define UVC_QUEUE_DROP_CORRUPTED??? (1
> << 2)
>? 
>? struct uvc_video_queue {
>? ??? enum v4l2_buf_type type;
> @@ -568,7 +569,7 @@ extern struct uvc_driver uvc_driver;
>? 
>? /* Video buffers queue management. */
>? extern void uvc_queue_init(struct uvc_video_queue *queue,
> -??? ??? enum v4l2_buf_type
> type);
> +??? ??? enum v4l2_buf_type
> type, int drop_corrupted);
>? extern int uvc_alloc_buffers(struct uvc_video_queue
> *queue,
>? ??? ??? unsigned int
> nbuffers, unsigned int buflength);
>? extern int uvc_free_buffers(struct uvc_video_queue
> *queue);
> -- 
> 1.6.4.4
> 
> -- 
> Regards,
> 
> Laurent Pinchart
> 

Hi Laurent.? Thank you for your attention on this issue.

I upgraded my uvcvideo driver from 2.6.31 to 2.6.34, and the corrupted
frames were still present.? I then applied your patch to 2.6.34, but the
corrupted frames are still present.

I originally noticed this problem with a custom application, but in the
process of debugging, I have been able to reproduce it with a modified
version of luvcview as well.? My patch for luvcview is attached.? The
patch disables JPEG decoding and drawing to the display.? It also reduces
the number of v4l2 buffers to 1.? These changes are not required to trigger
the frame corruption, but they seem to exacerbate the problem.  I realize
that 1 v4l2 buffer might be unreasonable, but I can produce this problem
with 2 or 3 buffers as well.

Counterintuitively, having more CPU available (by disabling rendering)
seems to worsen the problem.? Also, adding printks for debugging almost
always masks the problem.? For these reasons, I think maybe there might be
some cache coherency issue, but my attempts at sprinkling
flush_dcache_page() in the OHCI driver have not helped.  (For reference:
http://thread.gmane.org/gmane.linux.usb.general/27072/focus=944990)

I extracted some JPEGs from an AVI generated by luvcview to give you an
idea of what I'm seeing.? I shook the camera while filming some color bars
(shaking also seems to trigger the problem).  The files are named by
timestamp, and the middle one shows the characteristic corruption.

I have seen this behavior consistently on two different models of UVC
camera.? I am going to try a non-UVC v4l2 camera to see if this is
actually a platform issue as opposed to a uvcvideo one.

I will be on holiday next week, so if you have another patch I won't be
able to test it until June 28.

Regards,

Filter


      
-------------- next part --------------
A non-text attachment was scrubbed...
Name: luvcview.patch
Type: text/x-diff
Size: 1531 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100618/515237e8/attachment.patch>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 000007.5714286.jpg
Type: image/jpeg
Size: 2936 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100618/515237e8/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 000007.6428572.jpg
Type: image/jpeg
Size: 3260 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100618/515237e8/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 000007.7142858.jpg
Type: image/jpeg
Size: 3412 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100618/515237e8/attachment-0002.jpg>

From satzklauer at googlemail.com  Sat Jun 19 16:22:27 2010
From: satzklauer at googlemail.com (Satz Klauer)
Date: Sat, 19 Jun 2010 16:22:27 +0200
Subject: [Linux-uvc-devel] uvcvideo detects wrong resolution on vanilla
	kernel
Message-ID: <AANLkTimI6bZo5HGdGV73-DdRTJ_q0_2nmvxHRy0KVRsO@mail.gmail.com>

Hi,

I have a strange problem here with a Logitech C200 webcam.

Using a standard Fedora 13 system with a kernel 2.6.33.5-112.fc13.i686.PAE
the uvcvideo-module detects everything correctly:

uvcvideo: Found format YUV 4:2:2 (YUYV).
uvcvideo: - 640x480 (30.0 fps)
uvcvideo: - 160x120 (30.0 fps)
uvcvideo: - 176x144 (30.0 fps)
uvcvideo: - 320x240 (30.0 fps)
uvcvideo: - 352x288 (30.0 fps)
uvcvideo: - 640x360 (30.0 fps)
uvcvideo: - 640x400 (30.0 fps)

Now I have second system with a stripped down Fedora 8 and a handmade
vanilla kernel 2.6.33.5. There uvcvideo is not able to detect the maximum
resolution of 640x480, the trace output only gives me some resolutions:

uvcvideo: Found format YUV 4:2:2 (YUYV).
uvcvideo: - 160x120 (15.0 fps)
uvcvideo: - 176x144 (15.0 fps)

What's going on here, what could be the reason for these problems?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100619/e26321f3/attachment.html>

From freegate at mail.ru  Sun Jun 20 23:00:05 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Mon, 21 Jun 2010 01:00:05 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
Message-ID: <1277067605.2985.5.camel@kuzmin-desktop>

Hello!

Got problems with work of webcam MANTA MM353 Plako on chip ARK3188
 in linux 2.6.32 Ubuntu 10.04		

The device seen in lsusb:

Bus 001 Device 015: ID 18ec:3188 Arkmicro Technologies Inc. 

The device seen in dmesg

[ 6127.384018] usb 1-1: new high speed USB device using ehci_hcd and
address 15
[ 6127.517772] usb 1-1: configuration #1 chosen from 1 choice
[ 6127.518351] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
(18ec:3188)
[ 6127.518630] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
supported. Enabling workaround.
[ 6127.519034] input: USB2.0 PC CAMERA
as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input12
[ 6404.415648] uvcvideo: Failed to query (130) UVC probe control : 0
(exp. 26).

But stream doesn't show in mplayer:


root at kuzmin-desktop:/home/kuzmin# mplayer tv://
MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009 MPlayer Team
mplayer: could not connect to socket
mplayer: No such file or directory
Failed to open LIRC support. You will not be able to use your remote
control.

Playing tv://.
TV file format detected.
Selected driver: v4l2
 name: Video 4 Linux 2 input
 author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
 comment: first try, more to come ;-)
v4l2: your device driver does not support VIDIOC_G_STD ioctl,
VIDIOC_G_PARM was used instead.
Selected device: USB2.0 PC CAMERA
 Capabilites:  video capture  streaming
 supported norms:
 inputs: 0 = Camera 1;
 Current input: 0
 Current format: MJPEG
v4l2: ioctl set format failed: Input/output error
v4l2: ioctl set mute failed: Invalid argument
v4l2: 0 frames successfully processed, 0 frames dropped.


Exiting... (End of file)
root at kuzmin-desktop:/home/kuzmin# 






From pj.assis at gmail.com  Mon Jun 21 10:25:39 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Mon, 21 Jun 2010 09:25:39 +0100
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <1277067605.2985.5.camel@kuzmin-desktop>
References: <1277067605.2985.5.camel@kuzmin-desktop>
Message-ID: <AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>

Hi,
have you tried with other apps (luvcview or guvcview) ?
You may also try with other formats, like YUYV, maybe the camera just
doesn't support MJPG.
Camera supported formats can also be checked with lsusb.

Regards,
Paulo

2010/6/20 Andrew V Kuzmin <freegate at mail.ru>:
> Hello!
>
> Got problems with work of webcam MANTA MM353 Plako on chip ARK3188
> ?in linux 2.6.32 Ubuntu 10.04
>
> The device seen in lsusb:
>
> Bus 001 Device 015: ID 18ec:3188 Arkmicro Technologies Inc.
>
> The device seen in dmesg
>
> [ 6127.384018] usb 1-1: new high speed USB device using ehci_hcd and
> address 15
> [ 6127.517772] usb 1-1: configuration #1 chosen from 1 choice
> [ 6127.518351] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> (18ec:3188)
> [ 6127.518630] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> supported. Enabling workaround.
> [ 6127.519034] input: USB2.0 PC CAMERA
> as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input12
> [ 6404.415648] uvcvideo: Failed to query (130) UVC probe control : 0
> (exp. 26).
>
> But stream doesn't show in mplayer:
>
>
> root at kuzmin-desktop:/home/kuzmin# mplayer tv://
> MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009 MPlayer Team
> mplayer: could not connect to socket
> mplayer: No such file or directory
> Failed to open LIRC support. You will not be able to use your remote
> control.
>
> Playing tv://.
> TV file format detected.
> Selected driver: v4l2
> ?name: Video 4 Linux 2 input
> ?author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
> ?comment: first try, more to come ;-)
> v4l2: your device driver does not support VIDIOC_G_STD ioctl,
> VIDIOC_G_PARM was used instead.
> Selected device: USB2.0 PC CAMERA
> ?Capabilites: ?video capture ?streaming
> ?supported norms:
> ?inputs: 0 = Camera 1;
> ?Current input: 0
> ?Current format: MJPEG
> v4l2: ioctl set format failed: Input/output error
> v4l2: ioctl set mute failed: Invalid argument
> v4l2: 0 frames successfully processed, 0 frames dropped.
>
>
> Exiting... (End of file)
> root at kuzmin-desktop:/home/kuzmin#
>
>
>
>
> _______________________________________________
> Linux-uvc-devel mailing list
> Linux-uvc-devel at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
>


From josecarlosv.aguiar at gmail.com  Mon Jun 21 18:03:02 2010
From: josecarlosv.aguiar at gmail.com (=?ISO-8859-1?Q?Jos=E9_Carlos?=)
Date: Mon, 21 Jun 2010 13:03:02 -0300
Subject: [Linux-uvc-devel] Web Cam HP tx2 1275
In-Reply-To: <AANLkTilTQFyzpGjIc_Fkn_Z9szLHuemQuhDUg94CjQCt@mail.gmail.com>
References: <AANLkTilTQFyzpGjIc_Fkn_Z9szLHuemQuhDUg94CjQCt@mail.gmail.com>
Message-ID: <AANLkTileJKkkWtmvOPQiiJMKjjXopm8cDwCAnAMWXgG9@mail.gmail.com>

Hello

I would like to request the checks of the device ID - 064e:a103 Manufactor
by SuYin

devices ID that is not in the list.

Thank you for attention

-- 
Cordialmente - Cordially


Jos? Carlos V. Aguiar

Email
josecarlosv.aguiar at gmail.com
josecarlosaguiar_ at hotmail.com

Skype
josecarlosv.aguiar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100621/a32c6ea9/attachment.html>

From freegate at mail.ru  Tue Jun 22 21:02:19 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Tue, 22 Jun 2010 23:02:19 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
Message-ID: <1277233339.2092.14.camel@kuzmin-desktop>

Hi! VLC got this

vlc v4l2:// 

captures ok

but skype and programs like you mean doesn't

it seems that kernel do support V4L all modes - both 1 and 2...

root at kuzmin-desktop:/home/kuzmin# grep -i
v4l /usr/src/linux-headers-2.6.32-22-generic/.config 
CONFIG_VIDEO_V4L2_COMMON=m
CONFIG_VIDEO_ALLOW_V4L1=y
CONFIG_VIDEO_V4L1_COMPAT=y
CONFIG_VIDEO_V4L2=m
CONFIG_VIDEO_V4L1=m
CONFIG_V4L_USB_DRIVERS=y

Another way to do is to preload some modules:

LD_PRELOAD=/usr/lib/libv4l/v4l2convert.so skype
LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype

But it doesn't work to - skype does not show, mplayer does not capture -
as if the /dev/video0 return's datafile of null length

Have some idea's workaround?

? ???, 21/06/2010 ? 09:25 +0100, Paulo Assis ?????:
> Hi,
> have you tried with other apps (luvcview or guvcview) ?
> You may also try with other formats, like YUYV, maybe the camera just
> doesn't support MJPG.
> Camera supported formats can also be checked with lsusb.
> 
> Regards,
> Paulo
> 
> 2010/6/20 Andrew V Kuzmin <freegate at mail.ru>:
> > Hello!
> >
> > Got problems with work of webcam MANTA MM353 Plako on chip ARK3188
> >  in linux 2.6.32 Ubuntu 10.04
> >
> > The device seen in lsusb:
> >
> > Bus 001 Device 015: ID 18ec:3188 Arkmicro Technologies Inc.
> >
> > The device seen in dmesg
> >
> > [ 6127.384018] usb 1-1: new high speed USB device using ehci_hcd and
> > address 15
> > [ 6127.517772] usb 1-1: configuration #1 chosen from 1 choice
> > [ 6127.518351] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> > (18ec:3188)
> > [ 6127.518630] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> > supported. Enabling workaround.
> > [ 6127.519034] input: USB2.0 PC CAMERA
> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input12
> > [ 6404.415648] uvcvideo: Failed to query (130) UVC probe control : 0
> > (exp. 26).
> >
> > But stream doesn't show in mplayer:
> >
> >
> > root at kuzmin-desktop:/home/kuzmin# mplayer tv://
> > MPlayer SVN-r1.0~rc3+svn20090426-4.4.3 (C) 2000-2009 MPlayer Team
> > mplayer: could not connect to socket
> > mplayer: No such file or directory
> > Failed to open LIRC support. You will not be able to use your remote
> > control.
> >
> > Playing tv://.
> > TV file format detected.
> > Selected driver: v4l2
> >  name: Video 4 Linux 2 input
> >  author: Martin Olschewski <olschewski at zpr.uni-koeln.de>
> >  comment: first try, more to come ;-)
> > v4l2: your device driver does not support VIDIOC_G_STD ioctl,
> > VIDIOC_G_PARM was used instead.
> > Selected device: USB2.0 PC CAMERA
> >  Capabilites:  video capture  streaming
> >  supported norms:
> >  inputs: 0 = Camera 1;
> >  Current input: 0
> >  Current format: MJPEG
> > v4l2: ioctl set format failed: Input/output error
> > v4l2: ioctl set mute failed: Invalid argument
> > v4l2: 0 frames successfully processed, 0 frames dropped.
> >
> >
> > Exiting... (End of file)
> > root at kuzmin-desktop:/home/kuzmin#
> >
> >
> >
> >
> > _______________________________________________
> > Linux-uvc-devel mailing list
> > Linux-uvc-devel at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/linux-uvc-devel
> >
> 




From senada at t-online.de  Thu Jun 24 00:16:18 2010
From: senada at t-online.de (seno)
Date: Wed, 23 Jun 2010 22:16:18 +0000 (UTC)
Subject: [Linux-uvc-devel]
	=?utf-8?q?0402=3A5606_ALi_Corp=2E_USB_2=2E0_Cam?=
	=?utf-8?q?era_-_NO_FULL=09SIZED_OUTPUT?=
References: <loom.20100610T163437-102@post.gmane.org>
	<201006171308.59325.laurent.pinchart@ideasonboard.com>
Message-ID: <loom.20100624T001430-502@post.gmane.org>

Laurent Pinchart <laurent.pinchart <at> ideasonboard.com> writes:



> > show only about half of the

> > real picture (or even less).

> 

> Could you post a screenshot ? Does that happen at all resolutions ?



Hi Laurent,

thanks for your response.

I did some tests and it happens at all resolutions except 1280x1024; at least 

the image is centered at that resolution.

I put an object in front of the notebook and took a screenshot in linux and w7, 

without moving anything between the screenshots, resolution was set to 640x480 

each time. 



http://img10.imageshack.us/img10/1583/bisoncam640x480w7.png

http://img706.imageshack.us/img706/7683/uvc640x480mdv20100.png





> > Can a Bios update bring up webcam malfunction?

> 

> Yes, a BIOS update can even reflash the webcam firmware.



As said, I don't remember for sure if and how good the cam worked before the 

bios update...

However, I won't to go back to an old bios because the new one has some 

improvements to fan control and sata (ahci) configuration and there is always a 

risk to brick a notebook while flashing bios :)





> Could you please send me the output of 'lsusb -v -d 0402:5606' ? I've got a 

> copy already, but the BIOS update might have modified it.



Uploaded here (looks same as one that has been previously posted here):

http://www.loaditup.de/files/509608.txt



 

> The "Camera requested null bandwidth" error message shouldn't be an issue, at 

> least if the camera has a single alternate setting like the model I know bout 

> has. This can be checked with the lsusb output.

> 

> The "Failed to query" messages definitely indicate a firmware bug. It might 

> or might not be related to the bad picture issue you have. Would you be able  

> to capture a USB trace on Windows if required ?





Today I noticed again a poor webcam performance in Linux, while I get max. 7 

fps at full sun exposure, the video runs smooth in win 7, even at lower 

exposure (at least 15 fps). Furthermore, the image is more bright and sharp on 

Windows, but I would be happy if I can get a full sized output at all.



If required, I can capture a USB trace  on win 7 (would SysNucleus USBTrace be 

a good software for that? (Have already installed it)



From gwpublic at wp.pl  Wed Jun 23 00:01:11 2010
From: gwpublic at wp.pl (gwpl)
Date: Tue, 22 Jun 2010 22:01:11 +0000 (UTC)
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
Message-ID: <loom.20100623T000055-580@post.gmane.org>

Andrew V Kuzmin <freegate <at> mail.ru> writes:

> Hi! VLC got this
> 
> vlc v4l2:// 
> 
> captures ok


Hi !

I have same problems with my Manta mm 353 Plako.

Thanks to you, I can at least see myself in vlc.

Earlier I've tried all tricks you've mentioned without success.

Can't wait for solution to make this webcam usable with other linux programs.

Here are I provide " luvcview -L " for curious :

$ luvcview -L
luvcview version 0.2.1 
Video driver: x11
A window manager is available
video /dev/video0 
/dev/video0 does not support read i/o
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 640, height = 480 }
        Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 320, height = 240 }
        Time interval between frame: 1/25, 1/20, 1/15, 1/10, 

And some kernel info:
$ uname -r -s -m
Linux 2.6.34-ARCH x86_64

And luvcview version.

$ luvcview -h | head -n 1
luvcview version 0.2.1 






From pj.assis at gmail.com  Thu Jun 24 00:52:09 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Wed, 23 Jun 2010 23:52:09 +0100
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <1277311470.3060.10.camel@kuzmin-desktop>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
Message-ID: <AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>

Andrew Hi,
By default vlc uses libv4l, just like most other software, when this
fails it reverts to direct v4l2 access, (you probably should also
check your libv4l version and update it if needed)
vlc seems to be able to open a MJPG stream after a few failed
attempts, I can't really understand why it fails with the other
software (it returns a I/O error when trying to set the stream
format).
Can you increase the driver verbosity and check for error messages with dmesg ?

Regards,
Paulo

2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
> Got the latest version, but error still happened (logs below)
> Have you seen the vlc logs?
> It seems that cam not supported by ??? drivers - direct kernel v4l2 ?-
> what does it means?
>
>
> [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
> libv4l2: error setting pixformat: Input/output error
> libv4l2: error setting pixformat: Input/output error
> libv4l2: error setting pixformat: Input/output error
> [0x8e24368] v4l2 demux warning: Could not select any of the default
> chromas; attempting to open as MPEG encoder card (access)
> [0x8e24368] main demux warning: no access_demux module matching "v4l2"
> could be loaded
> [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
> 55.611 ms / 1 intvls (Avg 55.611 ms)
> [0x8bdfa98] main input debug: creating access 'v4l2' path=''
> [0x8e28398] main access debug: looking for access module: 1 candidate
> [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
> [0x8e28398] v4l2 access debug: opening device '/dev/video0'
>
>
>
> kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
> guvcview 1.4.1
>
> (process:4154): Gtk-WARNING **: Locale not supported by C library.
> ? ? ? ?Using the fallback 'C' locale.
> unexpected integer value (0) for vid_mux
> Strings must be quoted
> unexpected integer value (1) for snd_numsec
> Strings must be quoted
> unexpected integer value (160) for snd_bitrate
> Strings must be quoted
> unexpected integer value (2) for Pan_Step
> Strings must be quoted
> unexpected integer value (2) for Tilt_Step
> Strings must be quoted
> bt_audio_service_open: connect() failed: Connection refused (111)
> bt_audio_service_open: connect() failed: Connection refused (111)
> bt_audio_service_open: connect() failed: Connection refused (111)
> bt_audio_service_open: connect() failed: Connection refused (111)
> video device: /dev/video0
> /dev/video0 - device 1
> Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> { pixelformat = 'MJPG', description = 'MJPEG' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'RGB3', description = 'RGB3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'BGR3', description = 'BGR3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YU12', description = 'YU12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YV12', description = 'YV12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> vid:18ec
> pid:3188
> driver:uvcvideo
> checking format: 1448695129
> VIDIOC_S_FORMAT - Unable to set format: Input/output error
> Init v4L2 failed !!
> Init video returned -2
> trying minimum setup ...
> video device: /dev/video0
> /dev/video0 - device 1
> Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> { pixelformat = 'MJPG', description = 'MJPEG' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'RGB3', description = 'RGB3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'BGR3', description = 'BGR3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YU12', description = 'YU12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YV12', description = 'YV12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> vid:18ec
> pid:3188
> driver:uvcvideo
> checking format: 1196444237
> VIDIOC_S_FORMAT - Unable to set format: Input/output error
> Init v4L2 failed !!
> ERROR: Minimum Setup Failed.
> ?Exiting...
> VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> cleaned allocations - 100%
> Closing portaudio ...O
>
> ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
>> guvcview --format yuyv
>
>


From freegate at mail.ru  Thu Jun 24 05:48:32 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Thu, 24 Jun 2010 07:48:32 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
Message-ID: <1277351312.3060.14.camel@kuzmin-desktop>

Hi, I did not fully inderstand how to seperverbose driver logs,
the key in guvcview -v only, not like -vvv in vlc.
DMESG once again

when camera plugged in

46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
address 7
[46064.158039] usb 1-1: configuration #1 chosen from 1 choice
[46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
(18ec:3188)
[46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
supported. Enabling workaround.
[46064.159391] input: USB2.0 PC CAMERA
as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10

then when guvcview called

[46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
(exp. 26).
[46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
(exp. 26).




kuzmin at kuzmin-desktop:~$ guvcview -v
guvcview 1.4.1

(process:13812): Gtk-WARNING **: Locale not supported by C library.
	Using the fallback 'C' locale.
unexpected integer value (0) for vid_mux
Strings must be quoted
unexpected integer value (1) for snd_numsec
Strings must be quoted
unexpected integer value (160) for snd_bitrate
Strings must be quoted
unexpected integer value (2) for Pan_Step
Strings must be quoted
unexpected integer value (2) for Tilt_Step
Strings must be quoted
video_device: /dev/video0
vid_sleep: 0
cap_meth: 1
resolution: 640 x 480
windowsize: 480 x 700
vert pane: 0
spin behavior: 0
mode: mjpg
fps: 1/25
Display Fps: 0
bpp: 0
hwaccel: 1
avi_format: 0
sound: 1
sound Device: 0
sound samp rate: 0
sound Channels: 0
Sound delay: 0 nanosec
Sound Format: 80 
Pan Step: 2 degrees
Tilt Step: 2 degrees
Video Filter Flags: 0
image inc: 0
profile(default):/home/kuzmin/default.gpfl
starting portaudio...
bt_audio_service_open: connect() failed: Connection refused (111)
bt_audio_service_open: connect() failed: Connection refused (111)
bt_audio_service_open: connect() failed: Connection refused (111)
bt_audio_service_open: connect() failed: Connection refused (111)
language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
cat:guvcview.mo
mjpg: setting format to 1196444237
capture method = 1
video device: /dev/video0 
/dev/video0 - device 1
Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'RGB3', description = 'RGB3' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'BGR3', description = 'BGR3' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YU12', description = 'YU12' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YV12', description = 'YV12' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
vid:18ec 
pid:3188 
driver:uvcvideo
checking format: 1196444237
VIDIOC_S_FORMAT - Unable to set format: Input/output error
Init v4L2 failed !! 
Init video returned -2
trying minimum setup ...
capture method = 1
video device: /dev/video0 
/dev/video0 - device 1
Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
{ pixelformat = 'MJPG', description = 'MJPEG' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'RGB3', description = 'RGB3' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'BGR3', description = 'BGR3' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YU12', description = 'YU12' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ pixelformat = 'YV12', description = 'YV12' }
{ discrete: width = 640, height = 480 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
{ discrete: width = 320, height = 240 }
	Time interval between frame: 1/25, 1/20, 1/15, 1/10, 
vid:18ec 
pid:3188 
driver:uvcvideo
checking format: 1196444237
VIDIOC_S_FORMAT - Unable to set format: Input/output error
Init v4L2 failed !! 
ERROR: Minimum Setup Failed.
 Exiting...
free audio mutex
VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
closed v4l2 strutures
free controls - vidState
cleaned allocations - 100%
Closing portaudio ...OK
Terminated.



? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
> Andrew Hi,
> By default vlc uses libv4l, just like most other software, when this
> fails it reverts to direct v4l2 access, (you probably should also
> check your libv4l version and update it if needed)
> vlc seems to be able to open a MJPG stream after a few failed
> attempts, I can't really understand why it fails with the other
> software (it returns a I/O error when trying to set the stream
> format).
> Can you increase the driver verbosity and check for error messages with dmesg ?
> 
> Regards,
> Paulo
> 
> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
> > Got the latest version, but error still happened (logs below)
> > Have you seen the vlc logs?
> > It seems that cam not supported by ??? drivers - direct kernel v4l2  -
> > what does it means?
> >
> >
> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
> > libv4l2: error setting pixformat: Input/output error
> > libv4l2: error setting pixformat: Input/output error
> > libv4l2: error setting pixformat: Input/output error
> > [0x8e24368] v4l2 demux warning: Could not select any of the default
> > chromas; attempting to open as MPEG encoder card (access)
> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
> > could be loaded
> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
> > 55.611 ms / 1 intvls (Avg 55.611 ms)
> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
> > [0x8e28398] main access debug: looking for access module: 1 candidate
> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
> >
> >
> >
> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
> > guvcview 1.4.1
> >
> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
> >        Using the fallback 'C' locale.
> > unexpected integer value (0) for vid_mux
> > Strings must be quoted
> > unexpected integer value (1) for snd_numsec
> > Strings must be quoted
> > unexpected integer value (160) for snd_bitrate
> > Strings must be quoted
> > unexpected integer value (2) for Pan_Step
> > Strings must be quoted
> > unexpected integer value (2) for Tilt_Step
> > Strings must be quoted
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > video device: /dev/video0
> > /dev/video0 - device 1
> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> > { pixelformat = 'MJPG', description = 'MJPEG' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'RGB3', description = 'RGB3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'BGR3', description = 'BGR3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YU12', description = 'YU12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YV12', description = 'YV12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > vid:18ec
> > pid:3188
> > driver:uvcvideo
> > checking format: 1448695129
> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> > Init v4L2 failed !!
> > Init video returned -2
> > trying minimum setup ...
> > video device: /dev/video0
> > /dev/video0 - device 1
> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> > { pixelformat = 'MJPG', description = 'MJPEG' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'RGB3', description = 'RGB3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'BGR3', description = 'BGR3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YU12', description = 'YU12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YV12', description = 'YV12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > vid:18ec
> > pid:3188
> > driver:uvcvideo
> > checking format: 1196444237
> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> > Init v4L2 failed !!
> > ERROR: Minimum Setup Failed.
> >  Exiting...
> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> > cleaned allocations - 100%
> > Closing portaudio ...O
> >
> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
> >> guvcview --format yuyv
> >
> >
> 




From pj.assis at gmail.com  Thu Jun 24 11:31:57 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Jun 2010 10:31:57 +0100
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <1277351312.3060.14.camel@kuzmin-desktop>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
Message-ID: <AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>

Andrew Hi,
you can increase the driver verbosity by setting the trace parameter:
rmmod uvcvideo
modprobe uvcvideo trace=65535

trace level is given by grouping several flags so you can set it to
something like 0xffffff and get a huge amount of information on the
logs (just don't forget to reset it after you finish debugging)

after this dmesg should be a lot more verbose.

Some cameras require a quirks value to function properly, but you
really need to check what's going on first.

Best regards,
Paulo

2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> Hi, I did not fully inderstand how to seperverbose driver logs,
> the key in guvcview -v only, not like -vvv in vlc.
> DMESG once again
>
> when camera plugged in
>
> 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
> address 7
> [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
> [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> (18ec:3188)
> [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> supported. Enabling workaround.
> [46064.159391] input: USB2.0 PC CAMERA
> as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
>
> then when guvcview called
>
> [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
> (exp. 26).
> [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
> (exp. 26).
>
>
>
>
> kuzmin at kuzmin-desktop:~$ guvcview -v
> guvcview 1.4.1
>
> (process:13812): Gtk-WARNING **: Locale not supported by C library.
> ? ? ? ?Using the fallback 'C' locale.
> unexpected integer value (0) for vid_mux
> Strings must be quoted
> unexpected integer value (1) for snd_numsec
> Strings must be quoted
> unexpected integer value (160) for snd_bitrate
> Strings must be quoted
> unexpected integer value (2) for Pan_Step
> Strings must be quoted
> unexpected integer value (2) for Tilt_Step
> Strings must be quoted
> video_device: /dev/video0
> vid_sleep: 0
> cap_meth: 1
> resolution: 640 x 480
> windowsize: 480 x 700
> vert pane: 0
> spin behavior: 0
> mode: mjpg
> fps: 1/25
> Display Fps: 0
> bpp: 0
> hwaccel: 1
> avi_format: 0
> sound: 1
> sound Device: 0
> sound samp rate: 0
> sound Channels: 0
> Sound delay: 0 nanosec
> Sound Format: 80
> Pan Step: 2 degrees
> Tilt Step: 2 degrees
> Video Filter Flags: 0
> image inc: 0
> profile(default):/home/kuzmin/default.gpfl
> starting portaudio...
> bt_audio_service_open: connect() failed: Connection refused (111)
> bt_audio_service_open: connect() failed: Connection refused (111)
> bt_audio_service_open: connect() failed: Connection refused (111)
> bt_audio_service_open: connect() failed: Connection refused (111)
> language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
> cat:guvcview.mo
> mjpg: setting format to 1196444237
> capture method = 1
> video device: /dev/video0
> /dev/video0 - device 1
> Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> { pixelformat = 'MJPG', description = 'MJPEG' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'RGB3', description = 'RGB3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'BGR3', description = 'BGR3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YU12', description = 'YU12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YV12', description = 'YV12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> vid:18ec
> pid:3188
> driver:uvcvideo
> checking format: 1196444237
> VIDIOC_S_FORMAT - Unable to set format: Input/output error
> Init v4L2 failed !!
> Init video returned -2
> trying minimum setup ...
> capture method = 1
> video device: /dev/video0
> /dev/video0 - device 1
> Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> { pixelformat = 'MJPG', description = 'MJPEG' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'RGB3', description = 'RGB3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'BGR3', description = 'BGR3' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YU12', description = 'YU12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { pixelformat = 'YV12', description = 'YV12' }
> { discrete: width = 640, height = 480 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> { discrete: width = 320, height = 240 }
> ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> vid:18ec
> pid:3188
> driver:uvcvideo
> checking format: 1196444237
> VIDIOC_S_FORMAT - Unable to set format: Input/output error
> Init v4L2 failed !!
> ERROR: Minimum Setup Failed.
> ?Exiting...
> free audio mutex
> VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> closed v4l2 strutures
> free controls - vidState
> cleaned allocations - 100%
> Closing portaudio ...OK
> Terminated.
>
>
>
> ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
>> Andrew Hi,
>> By default vlc uses libv4l, just like most other software, when this
>> fails it reverts to direct v4l2 access, (you probably should also
>> check your libv4l version and update it if needed)
>> vlc seems to be able to open a MJPG stream after a few failed
>> attempts, I can't really understand why it fails with the other
>> software (it returns a I/O error when trying to set the stream
>> format).
>> Can you increase the driver verbosity and check for error messages with dmesg ?
>>
>> Regards,
>> Paulo
>>
>> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
>> > Got the latest version, but error still happened (logs below)
>> > Have you seen the vlc logs?
>> > It seems that cam not supported by ??? drivers - direct kernel v4l2 ?-
>> > what does it means?
>> >
>> >
>> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
>> > libv4l2: error setting pixformat: Input/output error
>> > libv4l2: error setting pixformat: Input/output error
>> > libv4l2: error setting pixformat: Input/output error
>> > [0x8e24368] v4l2 demux warning: Could not select any of the default
>> > chromas; attempting to open as MPEG encoder card (access)
>> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
>> > could be loaded
>> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
>> > 55.611 ms / 1 intvls (Avg 55.611 ms)
>> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
>> > [0x8e28398] main access debug: looking for access module: 1 candidate
>> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
>> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
>> >
>> >
>> >
>> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
>> > guvcview 1.4.1
>> >
>> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
>> > ? ? ? ?Using the fallback 'C' locale.
>> > unexpected integer value (0) for vid_mux
>> > Strings must be quoted
>> > unexpected integer value (1) for snd_numsec
>> > Strings must be quoted
>> > unexpected integer value (160) for snd_bitrate
>> > Strings must be quoted
>> > unexpected integer value (2) for Pan_Step
>> > Strings must be quoted
>> > unexpected integer value (2) for Tilt_Step
>> > Strings must be quoted
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > video device: /dev/video0
>> > /dev/video0 - device 1
>> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'RGB3', description = 'RGB3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'BGR3', description = 'BGR3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YU12', description = 'YU12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YV12', description = 'YV12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > vid:18ec
>> > pid:3188
>> > driver:uvcvideo
>> > checking format: 1448695129
>> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> > Init v4L2 failed !!
>> > Init video returned -2
>> > trying minimum setup ...
>> > video device: /dev/video0
>> > /dev/video0 - device 1
>> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'RGB3', description = 'RGB3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'BGR3', description = 'BGR3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YU12', description = 'YU12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YV12', description = 'YV12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > vid:18ec
>> > pid:3188
>> > driver:uvcvideo
>> > checking format: 1196444237
>> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> > Init v4L2 failed !!
>> > ERROR: Minimum Setup Failed.
>> > ?Exiting...
>> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
>> > cleaned allocations - 100%
>> > Closing portaudio ...O
>> >
>> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
>> >> guvcview --format yuyv
>> >
>> >
>>
>
>
>


From freegate at mail.ru  Thu Jun 24 16:32:27 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Thu, 24 Jun 2010 18:32:27 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
	<AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
Message-ID: <1277389947.1777.6.camel@kuzmin-desktop>

Hi, Paulo, logs in attached archive


? ???, 24/06/2010 ? 10:31 +0100, Paulo Assis ?????:
> Andrew Hi,
> you can increase the driver verbosity by setting the trace parameter:
> rmmod uvcvideo
> modprobe uvcvideo trace=65535
> 
> trace level is given by grouping several flags so you can set it to
> something like 0xffffff and get a huge amount of information on the
> logs (just don't forget to reset it after you finish debugging)
> 
> after this dmesg should be a lot more verbose.
> 
> Some cameras require a quirks value to function properly, but you
> really need to check what's going on first.
> 
> Best regards,
> Paulo
> 
> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> > Hi, I did not fully inderstand how to seperverbose driver logs,
> > the key in guvcview -v only, not like -vvv in vlc.
> > DMESG once again
> >
> > when camera plugged in
> >
> > 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
> > address 7
> > [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
> > [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> > (18ec:3188)
> > [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> > supported. Enabling workaround.
> > [46064.159391] input: USB2.0 PC CAMERA
> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
> >
> > then when guvcview called
> >
> > [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
> > (exp. 26).
> > [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
> > (exp. 26).
> >
> >
> >
> >
> > kuzmin at kuzmin-desktop:~$ guvcview -v
> > guvcview 1.4.1
> >
> > (process:13812): Gtk-WARNING **: Locale not supported by C library.
> >        Using the fallback 'C' locale.
> > unexpected integer value (0) for vid_mux
> > Strings must be quoted
> > unexpected integer value (1) for snd_numsec
> > Strings must be quoted
> > unexpected integer value (160) for snd_bitrate
> > Strings must be quoted
> > unexpected integer value (2) for Pan_Step
> > Strings must be quoted
> > unexpected integer value (2) for Tilt_Step
> > Strings must be quoted
> > video_device: /dev/video0
> > vid_sleep: 0
> > cap_meth: 1
> > resolution: 640 x 480
> > windowsize: 480 x 700
> > vert pane: 0
> > spin behavior: 0
> > mode: mjpg
> > fps: 1/25
> > Display Fps: 0
> > bpp: 0
> > hwaccel: 1
> > avi_format: 0
> > sound: 1
> > sound Device: 0
> > sound samp rate: 0
> > sound Channels: 0
> > Sound delay: 0 nanosec
> > Sound Format: 80
> > Pan Step: 2 degrees
> > Tilt Step: 2 degrees
> > Video Filter Flags: 0
> > image inc: 0
> > profile(default):/home/kuzmin/default.gpfl
> > starting portaudio...
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
> > cat:guvcview.mo
> > mjpg: setting format to 1196444237
> > capture method = 1
> > video device: /dev/video0
> > /dev/video0 - device 1
> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> > { pixelformat = 'MJPG', description = 'MJPEG' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'RGB3', description = 'RGB3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'BGR3', description = 'BGR3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YU12', description = 'YU12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YV12', description = 'YV12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > vid:18ec
> > pid:3188
> > driver:uvcvideo
> > checking format: 1196444237
> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> > Init v4L2 failed !!
> > Init video returned -2
> > trying minimum setup ...
> > capture method = 1
> > video device: /dev/video0
> > /dev/video0 - device 1
> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> > { pixelformat = 'MJPG', description = 'MJPEG' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'RGB3', description = 'RGB3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'BGR3', description = 'BGR3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YU12', description = 'YU12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YV12', description = 'YV12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > vid:18ec
> > pid:3188
> > driver:uvcvideo
> > checking format: 1196444237
> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> > Init v4L2 failed !!
> > ERROR: Minimum Setup Failed.
> >  Exiting...
> > free audio mutex
> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> > closed v4l2 strutures
> > free controls - vidState
> > cleaned allocations - 100%
> > Closing portaudio ...OK
> > Terminated.
> >
> >
> >
> > ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
> >> Andrew Hi,
> >> By default vlc uses libv4l, just like most other software, when this
> >> fails it reverts to direct v4l2 access, (you probably should also
> >> check your libv4l version and update it if needed)
> >> vlc seems to be able to open a MJPG stream after a few failed
> >> attempts, I can't really understand why it fails with the other
> >> software (it returns a I/O error when trying to set the stream
> >> format).
> >> Can you increase the driver verbosity and check for error messages with dmesg ?
> >>
> >> Regards,
> >> Paulo
> >>
> >> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
> >> > Got the latest version, but error still happened (logs below)
> >> > Have you seen the vlc logs?
> >> > It seems that cam not supported by ??? drivers - direct kernel v4l2  -
> >> > what does it means?
> >> >
> >> >
> >> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
> >> > libv4l2: error setting pixformat: Input/output error
> >> > libv4l2: error setting pixformat: Input/output error
> >> > libv4l2: error setting pixformat: Input/output error
> >> > [0x8e24368] v4l2 demux warning: Could not select any of the default
> >> > chromas; attempting to open as MPEG encoder card (access)
> >> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
> >> > could be loaded
> >> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
> >> > 55.611 ms / 1 intvls (Avg 55.611 ms)
> >> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
> >> > [0x8e28398] main access debug: looking for access module: 1 candidate
> >> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
> >> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
> >> >
> >> >
> >> >
> >> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
> >> > guvcview 1.4.1
> >> >
> >> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
> >> >        Using the fallback 'C' locale.
> >> > unexpected integer value (0) for vid_mux
> >> > Strings must be quoted
> >> > unexpected integer value (1) for snd_numsec
> >> > Strings must be quoted
> >> > unexpected integer value (160) for snd_bitrate
> >> > Strings must be quoted
> >> > unexpected integer value (2) for Pan_Step
> >> > Strings must be quoted
> >> > unexpected integer value (2) for Tilt_Step
> >> > Strings must be quoted
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > video device: /dev/video0
> >> > /dev/video0 - device 1
> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > vid:18ec
> >> > pid:3188
> >> > driver:uvcvideo
> >> > checking format: 1448695129
> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> > Init v4L2 failed !!
> >> > Init video returned -2
> >> > trying minimum setup ...
> >> > video device: /dev/video0
> >> > /dev/video0 - device 1
> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > vid:18ec
> >> > pid:3188
> >> > driver:uvcvideo
> >> > checking format: 1196444237
> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> > Init v4L2 failed !!
> >> > ERROR: Minimum Setup Failed.
> >> >  Exiting...
> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> >> > cleaned allocations - 100%
> >> > Closing portaudio ...O
> >> >
> >> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
> >> >> guvcview --format yuyv
> >> >
> >> >
> >>
> >
> >
> >
> 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: logs.20100624.tar.gz
Type: application/x-compressed-tar
Size: 14427 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100624/b5b3f1ef/attachment.bin>

From pj.assis at gmail.com  Thu Jun 24 16:44:00 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Jun 2010 15:44:00 +0100
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <1277389761.1777.5.camel@kuzmin-desktop>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
	<AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
	<1277389761.1777.5.camel@kuzmin-desktop>
Message-ID: <AANLkTim4Qwuk0Q87vBX26bDC_rigembs0zIjJJcH8P09@mail.gmail.com>

Andrew Hi,
Can you try setting quirks to 2:

rmmod uvcvideo
modprobe uvcvideo quirks=2 trace=65535

please post also a working dmesg log (from vlc)

Regards,
Paulo

2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> Hi Paulo! Requested logs in attach
> dmesg - all from the system cold boot
>
>
>
>
>
> ? ???, 24/06/2010 ? 10:31 +0100, Paulo Assis ?????:
>> Andrew Hi,
>> you can increase the driver verbosity by setting the trace parameter:
>> rmmod uvcvideo
>> modprobe uvcvideo trace=65535
>>
>> trace level is given by grouping several flags so you can set it to
>> something like 0xffffff and get a huge amount of information on the
>> logs (just don't forget to reset it after you finish debugging)
>>
>> after this dmesg should be a lot more verbose.
>>
>> Some cameras require a quirks value to function properly, but you
>> really need to check what's going on first.
>>
>> Best regards,
>> Paulo
>>
>> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
>> > Hi, I did not fully inderstand how to seperverbose driver logs,
>> > the key in guvcview -v only, not like -vvv in vlc.
>> > DMESG once again
>> >
>> > when camera plugged in
>> >
>> > 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
>> > address 7
>> > [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
>> > [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
>> > (18ec:3188)
>> > [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
>> > supported. Enabling workaround.
>> > [46064.159391] input: USB2.0 PC CAMERA
>> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
>> >
>> > then when guvcview called
>> >
>> > [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
>> > (exp. 26).
>> > [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
>> > (exp. 26).
>> >
>> >
>> >
>> >
>> > kuzmin at kuzmin-desktop:~$ guvcview -v
>> > guvcview 1.4.1
>> >
>> > (process:13812): Gtk-WARNING **: Locale not supported by C library.
>> > ? ? ? ?Using the fallback 'C' locale.
>> > unexpected integer value (0) for vid_mux
>> > Strings must be quoted
>> > unexpected integer value (1) for snd_numsec
>> > Strings must be quoted
>> > unexpected integer value (160) for snd_bitrate
>> > Strings must be quoted
>> > unexpected integer value (2) for Pan_Step
>> > Strings must be quoted
>> > unexpected integer value (2) for Tilt_Step
>> > Strings must be quoted
>> > video_device: /dev/video0
>> > vid_sleep: 0
>> > cap_meth: 1
>> > resolution: 640 x 480
>> > windowsize: 480 x 700
>> > vert pane: 0
>> > spin behavior: 0
>> > mode: mjpg
>> > fps: 1/25
>> > Display Fps: 0
>> > bpp: 0
>> > hwaccel: 1
>> > avi_format: 0
>> > sound: 1
>> > sound Device: 0
>> > sound samp rate: 0
>> > sound Channels: 0
>> > Sound delay: 0 nanosec
>> > Sound Format: 80
>> > Pan Step: 2 degrees
>> > Tilt Step: 2 degrees
>> > Video Filter Flags: 0
>> > image inc: 0
>> > profile(default):/home/kuzmin/default.gpfl
>> > starting portaudio...
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > bt_audio_service_open: connect() failed: Connection refused (111)
>> > language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
>> > cat:guvcview.mo
>> > mjpg: setting format to 1196444237
>> > capture method = 1
>> > video device: /dev/video0
>> > /dev/video0 - device 1
>> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'RGB3', description = 'RGB3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'BGR3', description = 'BGR3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YU12', description = 'YU12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YV12', description = 'YV12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > vid:18ec
>> > pid:3188
>> > driver:uvcvideo
>> > checking format: 1196444237
>> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> > Init v4L2 failed !!
>> > Init video returned -2
>> > trying minimum setup ...
>> > capture method = 1
>> > video device: /dev/video0
>> > /dev/video0 - device 1
>> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'RGB3', description = 'RGB3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'BGR3', description = 'BGR3' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YU12', description = 'YU12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { pixelformat = 'YV12', description = 'YV12' }
>> > { discrete: width = 640, height = 480 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > { discrete: width = 320, height = 240 }
>> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> > vid:18ec
>> > pid:3188
>> > driver:uvcvideo
>> > checking format: 1196444237
>> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> > Init v4L2 failed !!
>> > ERROR: Minimum Setup Failed.
>> > ?Exiting...
>> > free audio mutex
>> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
>> > closed v4l2 strutures
>> > free controls - vidState
>> > cleaned allocations - 100%
>> > Closing portaudio ...OK
>> > Terminated.
>> >
>> >
>> >
>> > ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
>> >> Andrew Hi,
>> >> By default vlc uses libv4l, just like most other software, when this
>> >> fails it reverts to direct v4l2 access, (you probably should also
>> >> check your libv4l version and update it if needed)
>> >> vlc seems to be able to open a MJPG stream after a few failed
>> >> attempts, I can't really understand why it fails with the other
>> >> software (it returns a I/O error when trying to set the stream
>> >> format).
>> >> Can you increase the driver verbosity and check for error messages with dmesg ?
>> >>
>> >> Regards,
>> >> Paulo
>> >>
>> >> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
>> >> > Got the latest version, but error still happened (logs below)
>> >> > Have you seen the vlc logs?
>> >> > It seems that cam not supported by ??? drivers - direct kernel v4l2 ?-
>> >> > what does it means?
>> >> >
>> >> >
>> >> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
>> >> > libv4l2: error setting pixformat: Input/output error
>> >> > libv4l2: error setting pixformat: Input/output error
>> >> > libv4l2: error setting pixformat: Input/output error
>> >> > [0x8e24368] v4l2 demux warning: Could not select any of the default
>> >> > chromas; attempting to open as MPEG encoder card (access)
>> >> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
>> >> > could be loaded
>> >> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
>> >> > 55.611 ms / 1 intvls (Avg 55.611 ms)
>> >> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
>> >> > [0x8e28398] main access debug: looking for access module: 1 candidate
>> >> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
>> >> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
>> >> >
>> >> >
>> >> >
>> >> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
>> >> > guvcview 1.4.1
>> >> >
>> >> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
>> >> > ? ? ? ?Using the fallback 'C' locale.
>> >> > unexpected integer value (0) for vid_mux
>> >> > Strings must be quoted
>> >> > unexpected integer value (1) for snd_numsec
>> >> > Strings must be quoted
>> >> > unexpected integer value (160) for snd_bitrate
>> >> > Strings must be quoted
>> >> > unexpected integer value (2) for Pan_Step
>> >> > Strings must be quoted
>> >> > unexpected integer value (2) for Tilt_Step
>> >> > Strings must be quoted
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > video device: /dev/video0
>> >> > /dev/video0 - device 1
>> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'RGB3', description = 'RGB3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'BGR3', description = 'BGR3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YU12', description = 'YU12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YV12', description = 'YV12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > vid:18ec
>> >> > pid:3188
>> >> > driver:uvcvideo
>> >> > checking format: 1448695129
>> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> >> > Init v4L2 failed !!
>> >> > Init video returned -2
>> >> > trying minimum setup ...
>> >> > video device: /dev/video0
>> >> > /dev/video0 - device 1
>> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'RGB3', description = 'RGB3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'BGR3', description = 'BGR3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YU12', description = 'YU12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YV12', description = 'YV12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > vid:18ec
>> >> > pid:3188
>> >> > driver:uvcvideo
>> >> > checking format: 1196444237
>> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> >> > Init v4L2 failed !!
>> >> > ERROR: Minimum Setup Failed.
>> >> > ?Exiting...
>> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
>> >> > cleaned allocations - 100%
>> >> > Closing portaudio ...O
>> >> >
>> >> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
>> >> >> guvcview --format yuyv
>> >> >
>> >> >
>> >>
>> >
>> >
>> >
>>
>
>


From freegate at mail.ru  Thu Jun 24 17:15:28 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Thu, 24 Jun 2010 19:15:28 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTim4Qwuk0Q87vBX26bDC_rigembs0zIjJJcH8P09@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
	<AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
	<1277389761.1777.5.camel@kuzmin-desktop>
	<AANLkTim4Qwuk0Q87vBX26bDC_rigembs0zIjJJcH8P09@mail.gmail.com>
Message-ID: <1277392528.1777.13.camel@kuzmin-desktop>

Paulo, the miracle is happened, it's now works!

as in

 mplayer tv://

also with preload lib with skype

LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype

what means quirks=2???
did you need more logs, or now we can close this problem?



? ???, 24/06/2010 ? 15:44 +0100, Paulo Assis ?????:
> Andrew Hi,
> Can you try setting quirks to 2:
> 
> rmmod uvcvideo
> modprobe uvcvideo quirks=2 trace=65535
> 
> please post also a working dmesg log (from vlc)
> 
> Regards,
> Paulo
> 
> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> > Hi Paulo! Requested logs in attach
> > dmesg - all from the system cold boot
> >
> >
> >
> >
> >
> > ? ???, 24/06/2010 ? 10:31 +0100, Paulo Assis ?????:
> >> Andrew Hi,
> >> you can increase the driver verbosity by setting the trace parameter:
> >> rmmod uvcvideo
> >> modprobe uvcvideo trace=65535
> >>
> >> trace level is given by grouping several flags so you can set it to
> >> something like 0xffffff and get a huge amount of information on the
> >> logs (just don't forget to reset it after you finish debugging)
> >>
> >> after this dmesg should be a lot more verbose.
> >>
> >> Some cameras require a quirks value to function properly, but you
> >> really need to check what's going on first.
> >>
> >> Best regards,
> >> Paulo
> >>
> >> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> >> > Hi, I did not fully inderstand how to seperverbose driver logs,
> >> > the key in guvcview -v only, not like -vvv in vlc.
> >> > DMESG once again
> >> >
> >> > when camera plugged in
> >> >
> >> > 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
> >> > address 7
> >> > [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
> >> > [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> >> > (18ec:3188)
> >> > [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> >> > supported. Enabling workaround.
> >> > [46064.159391] input: USB2.0 PC CAMERA
> >> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
> >> >
> >> > then when guvcview called
> >> >
> >> > [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
> >> > (exp. 26).
> >> > [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
> >> > (exp. 26).
> >> >
> >> >
> >> >
> >> >
> >> > kuzmin at kuzmin-desktop:~$ guvcview -v
> >> > guvcview 1.4.1
> >> >
> >> > (process:13812): Gtk-WARNING **: Locale not supported by C library.
> >> >        Using the fallback 'C' locale.
> >> > unexpected integer value (0) for vid_mux
> >> > Strings must be quoted
> >> > unexpected integer value (1) for snd_numsec
> >> > Strings must be quoted
> >> > unexpected integer value (160) for snd_bitrate
> >> > Strings must be quoted
> >> > unexpected integer value (2) for Pan_Step
> >> > Strings must be quoted
> >> > unexpected integer value (2) for Tilt_Step
> >> > Strings must be quoted
> >> > video_device: /dev/video0
> >> > vid_sleep: 0
> >> > cap_meth: 1
> >> > resolution: 640 x 480
> >> > windowsize: 480 x 700
> >> > vert pane: 0
> >> > spin behavior: 0
> >> > mode: mjpg
> >> > fps: 1/25
> >> > Display Fps: 0
> >> > bpp: 0
> >> > hwaccel: 1
> >> > avi_format: 0
> >> > sound: 1
> >> > sound Device: 0
> >> > sound samp rate: 0
> >> > sound Channels: 0
> >> > Sound delay: 0 nanosec
> >> > Sound Format: 80
> >> > Pan Step: 2 degrees
> >> > Tilt Step: 2 degrees
> >> > Video Filter Flags: 0
> >> > image inc: 0
> >> > profile(default):/home/kuzmin/default.gpfl
> >> > starting portaudio...
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
> >> > cat:guvcview.mo
> >> > mjpg: setting format to 1196444237
> >> > capture method = 1
> >> > video device: /dev/video0
> >> > /dev/video0 - device 1
> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > vid:18ec
> >> > pid:3188
> >> > driver:uvcvideo
> >> > checking format: 1196444237
> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> > Init v4L2 failed !!
> >> > Init video returned -2
> >> > trying minimum setup ...
> >> > capture method = 1
> >> > video device: /dev/video0
> >> > /dev/video0 - device 1
> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > vid:18ec
> >> > pid:3188
> >> > driver:uvcvideo
> >> > checking format: 1196444237
> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> > Init v4L2 failed !!
> >> > ERROR: Minimum Setup Failed.
> >> >  Exiting...
> >> > free audio mutex
> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> >> > closed v4l2 strutures
> >> > free controls - vidState
> >> > cleaned allocations - 100%
> >> > Closing portaudio ...OK
> >> > Terminated.
> >> >
> >> >
> >> >
> >> > ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
> >> >> Andrew Hi,
> >> >> By default vlc uses libv4l, just like most other software, when this
> >> >> fails it reverts to direct v4l2 access, (you probably should also
> >> >> check your libv4l version and update it if needed)
> >> >> vlc seems to be able to open a MJPG stream after a few failed
> >> >> attempts, I can't really understand why it fails with the other
> >> >> software (it returns a I/O error when trying to set the stream
> >> >> format).
> >> >> Can you increase the driver verbosity and check for error messages with dmesg ?
> >> >>
> >> >> Regards,
> >> >> Paulo
> >> >>
> >> >> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
> >> >> > Got the latest version, but error still happened (logs below)
> >> >> > Have you seen the vlc logs?
> >> >> > It seems that cam not supported by ??? drivers - direct kernel v4l2  -
> >> >> > what does it means?
> >> >> >
> >> >> >
> >> >> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
> >> >> > libv4l2: error setting pixformat: Input/output error
> >> >> > libv4l2: error setting pixformat: Input/output error
> >> >> > libv4l2: error setting pixformat: Input/output error
> >> >> > [0x8e24368] v4l2 demux warning: Could not select any of the default
> >> >> > chromas; attempting to open as MPEG encoder card (access)
> >> >> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
> >> >> > could be loaded
> >> >> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
> >> >> > 55.611 ms / 1 intvls (Avg 55.611 ms)
> >> >> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
> >> >> > [0x8e28398] main access debug: looking for access module: 1 candidate
> >> >> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
> >> >> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
> >> >> >
> >> >> >
> >> >> >
> >> >> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
> >> >> > guvcview 1.4.1
> >> >> >
> >> >> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
> >> >> >        Using the fallback 'C' locale.
> >> >> > unexpected integer value (0) for vid_mux
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (1) for snd_numsec
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (160) for snd_bitrate
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (2) for Pan_Step
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (2) for Tilt_Step
> >> >> > Strings must be quoted
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > video device: /dev/video0
> >> >> > /dev/video0 - device 1
> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > vid:18ec
> >> >> > pid:3188
> >> >> > driver:uvcvideo
> >> >> > checking format: 1448695129
> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> >> > Init v4L2 failed !!
> >> >> > Init video returned -2
> >> >> > trying minimum setup ...
> >> >> > video device: /dev/video0
> >> >> > /dev/video0 - device 1
> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > vid:18ec
> >> >> > pid:3188
> >> >> > driver:uvcvideo
> >> >> > checking format: 1196444237
> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> >> > Init v4L2 failed !!
> >> >> > ERROR: Minimum Setup Failed.
> >> >> >  Exiting...
> >> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> >> >> > cleaned allocations - 100%
> >> >> > Closing portaudio ...O
> >> >> >
> >> >> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
> >> >> >> guvcview --format yuyv
> >> >> >
> >> >> >
> >> >>
> >> >
> >> >
> >> >
> >>
> >
> >
> 




From pj.assis at gmail.com  Thu Jun 24 17:58:01 2010
From: pj.assis at gmail.com (Paulo Assis)
Date: Thu, 24 Jun 2010 16:58:01 +0100
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <1277392528.1777.13.camel@kuzmin-desktop>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
	<AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
	<1277389761.1777.5.camel@kuzmin-desktop>
	<AANLkTim4Qwuk0Q87vBX26bDC_rigembs0zIjJJcH8P09@mail.gmail.com>
	<1277392528.1777.13.camel@kuzmin-desktop>
Message-ID: <AANLkTin-hS-jigJtyU6NujGMzUMd4AP-qUhjovLyarEW@mail.gmail.com>

Andrew Hi,

You should now make this change more permanent in the driver configuration,
create a file named uvcvideo.conf in /etc/modprobe.d
add the following line:
options uvcvideo quirks=2

the quirks parameter bypasses some problems originated by faulty or
non fully compliant hardware.
In your case the camera fails when getting the min and max values for
the compression settings during probe,
quirks=2 bypasses this.

Laurent, you should add this camera to the uvc_ids list and hard code
the quirk there.
(This list just keeps getting bigger and bigger)

Regards,
Paulo

2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> Paulo, the miracle is happened, it's now works!
>
> as in
>
> ?mplayer tv://
>
> also with preload lib with skype
>
> LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype
>
> what means quirks=2???
> did you need more logs, or now we can close this problem?
>
>
>
> ? ???, 24/06/2010 ? 15:44 +0100, Paulo Assis ?????:
>> Andrew Hi,
>> Can you try setting quirks to 2:
>>
>> rmmod uvcvideo
>> modprobe uvcvideo quirks=2 trace=65535
>>
>> please post also a working dmesg log (from vlc)
>>
>> Regards,
>> Paulo
>>
>> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
>> > Hi Paulo! Requested logs in attach
>> > dmesg - all from the system cold boot
>> >
>> >
>> >
>> >
>> >
>> > ? ???, 24/06/2010 ? 10:31 +0100, Paulo Assis ?????:
>> >> Andrew Hi,
>> >> you can increase the driver verbosity by setting the trace parameter:
>> >> rmmod uvcvideo
>> >> modprobe uvcvideo trace=65535
>> >>
>> >> trace level is given by grouping several flags so you can set it to
>> >> something like 0xffffff and get a huge amount of information on the
>> >> logs (just don't forget to reset it after you finish debugging)
>> >>
>> >> after this dmesg should be a lot more verbose.
>> >>
>> >> Some cameras require a quirks value to function properly, but you
>> >> really need to check what's going on first.
>> >>
>> >> Best regards,
>> >> Paulo
>> >>
>> >> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
>> >> > Hi, I did not fully inderstand how to seperverbose driver logs,
>> >> > the key in guvcview -v only, not like -vvv in vlc.
>> >> > DMESG once again
>> >> >
>> >> > when camera plugged in
>> >> >
>> >> > 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
>> >> > address 7
>> >> > [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
>> >> > [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
>> >> > (18ec:3188)
>> >> > [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
>> >> > supported. Enabling workaround.
>> >> > [46064.159391] input: USB2.0 PC CAMERA
>> >> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
>> >> >
>> >> > then when guvcview called
>> >> >
>> >> > [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
>> >> > (exp. 26).
>> >> > [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
>> >> > (exp. 26).
>> >> >
>> >> >
>> >> >
>> >> >
>> >> > kuzmin at kuzmin-desktop:~$ guvcview -v
>> >> > guvcview 1.4.1
>> >> >
>> >> > (process:13812): Gtk-WARNING **: Locale not supported by C library.
>> >> > ? ? ? ?Using the fallback 'C' locale.
>> >> > unexpected integer value (0) for vid_mux
>> >> > Strings must be quoted
>> >> > unexpected integer value (1) for snd_numsec
>> >> > Strings must be quoted
>> >> > unexpected integer value (160) for snd_bitrate
>> >> > Strings must be quoted
>> >> > unexpected integer value (2) for Pan_Step
>> >> > Strings must be quoted
>> >> > unexpected integer value (2) for Tilt_Step
>> >> > Strings must be quoted
>> >> > video_device: /dev/video0
>> >> > vid_sleep: 0
>> >> > cap_meth: 1
>> >> > resolution: 640 x 480
>> >> > windowsize: 480 x 700
>> >> > vert pane: 0
>> >> > spin behavior: 0
>> >> > mode: mjpg
>> >> > fps: 1/25
>> >> > Display Fps: 0
>> >> > bpp: 0
>> >> > hwaccel: 1
>> >> > avi_format: 0
>> >> > sound: 1
>> >> > sound Device: 0
>> >> > sound samp rate: 0
>> >> > sound Channels: 0
>> >> > Sound delay: 0 nanosec
>> >> > Sound Format: 80
>> >> > Pan Step: 2 degrees
>> >> > Tilt Step: 2 degrees
>> >> > Video Filter Flags: 0
>> >> > image inc: 0
>> >> > profile(default):/home/kuzmin/default.gpfl
>> >> > starting portaudio...
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> > language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
>> >> > cat:guvcview.mo
>> >> > mjpg: setting format to 1196444237
>> >> > capture method = 1
>> >> > video device: /dev/video0
>> >> > /dev/video0 - device 1
>> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'RGB3', description = 'RGB3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'BGR3', description = 'BGR3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YU12', description = 'YU12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YV12', description = 'YV12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > vid:18ec
>> >> > pid:3188
>> >> > driver:uvcvideo
>> >> > checking format: 1196444237
>> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> >> > Init v4L2 failed !!
>> >> > Init video returned -2
>> >> > trying minimum setup ...
>> >> > capture method = 1
>> >> > video device: /dev/video0
>> >> > /dev/video0 - device 1
>> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'RGB3', description = 'RGB3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'BGR3', description = 'BGR3' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YU12', description = 'YU12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { pixelformat = 'YV12', description = 'YV12' }
>> >> > { discrete: width = 640, height = 480 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > { discrete: width = 320, height = 240 }
>> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> > vid:18ec
>> >> > pid:3188
>> >> > driver:uvcvideo
>> >> > checking format: 1196444237
>> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> >> > Init v4L2 failed !!
>> >> > ERROR: Minimum Setup Failed.
>> >> > ?Exiting...
>> >> > free audio mutex
>> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
>> >> > closed v4l2 strutures
>> >> > free controls - vidState
>> >> > cleaned allocations - 100%
>> >> > Closing portaudio ...OK
>> >> > Terminated.
>> >> >
>> >> >
>> >> >
>> >> > ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
>> >> >> Andrew Hi,
>> >> >> By default vlc uses libv4l, just like most other software, when this
>> >> >> fails it reverts to direct v4l2 access, (you probably should also
>> >> >> check your libv4l version and update it if needed)
>> >> >> vlc seems to be able to open a MJPG stream after a few failed
>> >> >> attempts, I can't really understand why it fails with the other
>> >> >> software (it returns a I/O error when trying to set the stream
>> >> >> format).
>> >> >> Can you increase the driver verbosity and check for error messages with dmesg ?
>> >> >>
>> >> >> Regards,
>> >> >> Paulo
>> >> >>
>> >> >> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
>> >> >> > Got the latest version, but error still happened (logs below)
>> >> >> > Have you seen the vlc logs?
>> >> >> > It seems that cam not supported by ??? drivers - direct kernel v4l2 ?-
>> >> >> > what does it means?
>> >> >> >
>> >> >> >
>> >> >> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
>> >> >> > libv4l2: error setting pixformat: Input/output error
>> >> >> > libv4l2: error setting pixformat: Input/output error
>> >> >> > libv4l2: error setting pixformat: Input/output error
>> >> >> > [0x8e24368] v4l2 demux warning: Could not select any of the default
>> >> >> > chromas; attempting to open as MPEG encoder card (access)
>> >> >> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
>> >> >> > could be loaded
>> >> >> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
>> >> >> > 55.611 ms / 1 intvls (Avg 55.611 ms)
>> >> >> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
>> >> >> > [0x8e28398] main access debug: looking for access module: 1 candidate
>> >> >> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
>> >> >> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
>> >> >> > guvcview 1.4.1
>> >> >> >
>> >> >> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
>> >> >> > ? ? ? ?Using the fallback 'C' locale.
>> >> >> > unexpected integer value (0) for vid_mux
>> >> >> > Strings must be quoted
>> >> >> > unexpected integer value (1) for snd_numsec
>> >> >> > Strings must be quoted
>> >> >> > unexpected integer value (160) for snd_bitrate
>> >> >> > Strings must be quoted
>> >> >> > unexpected integer value (2) for Pan_Step
>> >> >> > Strings must be quoted
>> >> >> > unexpected integer value (2) for Tilt_Step
>> >> >> > Strings must be quoted
>> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
>> >> >> > video device: /dev/video0
>> >> >> > /dev/video0 - device 1
>> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'YU12', description = 'YU12' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'YV12', description = 'YV12' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > vid:18ec
>> >> >> > pid:3188
>> >> >> > driver:uvcvideo
>> >> >> > checking format: 1448695129
>> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> >> >> > Init v4L2 failed !!
>> >> >> > Init video returned -2
>> >> >> > trying minimum setup ...
>> >> >> > video device: /dev/video0
>> >> >> > /dev/video0 - device 1
>> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
>> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'YU12', description = 'YU12' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { pixelformat = 'YV12', description = 'YV12' }
>> >> >> > { discrete: width = 640, height = 480 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > { discrete: width = 320, height = 240 }
>> >> >> > ? ? ? ?Time interval between frame: 1/25, 1/20, 1/15, 1/10,
>> >> >> > vid:18ec
>> >> >> > pid:3188
>> >> >> > driver:uvcvideo
>> >> >> > checking format: 1196444237
>> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
>> >> >> > Init v4L2 failed !!
>> >> >> > ERROR: Minimum Setup Failed.
>> >> >> > ?Exiting...
>> >> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
>> >> >> > cleaned allocations - 100%
>> >> >> > Closing portaudio ...O
>> >> >> >
>> >> >> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
>> >> >> >> guvcview --format yuyv
>> >> >> >
>> >> >> >
>> >> >>
>> >> >
>> >> >
>> >> >
>> >>
>> >
>> >
>>
>
>
>


From freegate at mail.ru  Thu Jun 24 19:27:57 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Thu, 24 Jun 2010 21:27:57 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTin-hS-jigJtyU6NujGMzUMd4AP-qUhjovLyarEW@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
	<AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
	<1277389761.1777.5.camel@kuzmin-desktop>
	<AANLkTim4Qwuk0Q87vBX26bDC_rigembs0zIjJJcH8P09@mail.gmail.com>
	<1277392528.1777.13.camel@kuzmin-desktop>
	<AANLkTin-hS-jigJtyU6NujGMzUMd4AP-qUhjovLyarEW@mail.gmail.com>
Message-ID: <1277400477.1786.0.camel@kuzmin-desktop>

Thank you, guys!!!


? ???, 24/06/2010 ? 16:58 +0100, Paulo Assis ?????:
> Andrew Hi,
> 
> You should now make this change more permanent in the driver configuration,
> create a file named uvcvideo.conf in /etc/modprobe.d
> add the following line:
> options uvcvideo quirks=2
> 
> the quirks parameter bypasses some problems originated by faulty or
> non fully compliant hardware.
> In your case the camera fails when getting the min and max values for
> the compression settings during probe,
> quirks=2 bypasses this.
> 
> Laurent, you should add this camera to the uvc_ids list and hard code
> the quirk there.
> (This list just keeps getting bigger and bigger)
> 
> Regards,
> Paulo
> 
> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> > Paulo, the miracle is happened, it's now works!
> >
> > as in
> >
> >  mplayer tv://
> >
> > also with preload lib with skype
> >
> > LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so skype
> >
> > what means quirks=2???
> > did you need more logs, or now we can close this problem?
> >
> >
> >
> > ? ???, 24/06/2010 ? 15:44 +0100, Paulo Assis ?????:
> >> Andrew Hi,
> >> Can you try setting quirks to 2:
> >>
> >> rmmod uvcvideo
> >> modprobe uvcvideo quirks=2 trace=65535
> >>
> >> please post also a working dmesg log (from vlc)
> >>
> >> Regards,
> >> Paulo
> >>
> >> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> >> > Hi Paulo! Requested logs in attach
> >> > dmesg - all from the system cold boot
> >> >
> >> >
> >> >
> >> >
> >> >
> >> > ? ???, 24/06/2010 ? 10:31 +0100, Paulo Assis ?????:
> >> >> Andrew Hi,
> >> >> you can increase the driver verbosity by setting the trace parameter:
> >> >> rmmod uvcvideo
> >> >> modprobe uvcvideo trace=65535
> >> >>
> >> >> trace level is given by grouping several flags so you can set it to
> >> >> something like 0xffffff and get a huge amount of information on the
> >> >> logs (just don't forget to reset it after you finish debugging)
> >> >>
> >> >> after this dmesg should be a lot more verbose.
> >> >>
> >> >> Some cameras require a quirks value to function properly, but you
> >> >> really need to check what's going on first.
> >> >>
> >> >> Best regards,
> >> >> Paulo
> >> >>
> >> >> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> >> >> > Hi, I did not fully inderstand how to seperverbose driver logs,
> >> >> > the key in guvcview -v only, not like -vvv in vlc.
> >> >> > DMESG once again
> >> >> >
> >> >> > when camera plugged in
> >> >> >
> >> >> > 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
> >> >> > address 7
> >> >> > [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
> >> >> > [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> >> >> > (18ec:3188)
> >> >> > [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> >> >> > supported. Enabling workaround.
> >> >> > [46064.159391] input: USB2.0 PC CAMERA
> >> >> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
> >> >> >
> >> >> > then when guvcview called
> >> >> >
> >> >> > [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
> >> >> > (exp. 26).
> >> >> > [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
> >> >> > (exp. 26).
> >> >> >
> >> >> >
> >> >> >
> >> >> >
> >> >> > kuzmin at kuzmin-desktop:~$ guvcview -v
> >> >> > guvcview 1.4.1
> >> >> >
> >> >> > (process:13812): Gtk-WARNING **: Locale not supported by C library.
> >> >> >        Using the fallback 'C' locale.
> >> >> > unexpected integer value (0) for vid_mux
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (1) for snd_numsec
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (160) for snd_bitrate
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (2) for Pan_Step
> >> >> > Strings must be quoted
> >> >> > unexpected integer value (2) for Tilt_Step
> >> >> > Strings must be quoted
> >> >> > video_device: /dev/video0
> >> >> > vid_sleep: 0
> >> >> > cap_meth: 1
> >> >> > resolution: 640 x 480
> >> >> > windowsize: 480 x 700
> >> >> > vert pane: 0
> >> >> > spin behavior: 0
> >> >> > mode: mjpg
> >> >> > fps: 1/25
> >> >> > Display Fps: 0
> >> >> > bpp: 0
> >> >> > hwaccel: 1
> >> >> > avi_format: 0
> >> >> > sound: 1
> >> >> > sound Device: 0
> >> >> > sound samp rate: 0
> >> >> > sound Channels: 0
> >> >> > Sound delay: 0 nanosec
> >> >> > Sound Format: 80
> >> >> > Pan Step: 2 degrees
> >> >> > Tilt Step: 2 degrees
> >> >> > Video Filter Flags: 0
> >> >> > image inc: 0
> >> >> > profile(default):/home/kuzmin/default.gpfl
> >> >> > starting portaudio...
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> > language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
> >> >> > cat:guvcview.mo
> >> >> > mjpg: setting format to 1196444237
> >> >> > capture method = 1
> >> >> > video device: /dev/video0
> >> >> > /dev/video0 - device 1
> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > vid:18ec
> >> >> > pid:3188
> >> >> > driver:uvcvideo
> >> >> > checking format: 1196444237
> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> >> > Init v4L2 failed !!
> >> >> > Init video returned -2
> >> >> > trying minimum setup ...
> >> >> > capture method = 1
> >> >> > video device: /dev/video0
> >> >> > /dev/video0 - device 1
> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> >> > { discrete: width = 640, height = 480 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > { discrete: width = 320, height = 240 }
> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> > vid:18ec
> >> >> > pid:3188
> >> >> > driver:uvcvideo
> >> >> > checking format: 1196444237
> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> >> > Init v4L2 failed !!
> >> >> > ERROR: Minimum Setup Failed.
> >> >> >  Exiting...
> >> >> > free audio mutex
> >> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> >> >> > closed v4l2 strutures
> >> >> > free controls - vidState
> >> >> > cleaned allocations - 100%
> >> >> > Closing portaudio ...OK
> >> >> > Terminated.
> >> >> >
> >> >> >
> >> >> >
> >> >> > ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
> >> >> >> Andrew Hi,
> >> >> >> By default vlc uses libv4l, just like most other software, when this
> >> >> >> fails it reverts to direct v4l2 access, (you probably should also
> >> >> >> check your libv4l version and update it if needed)
> >> >> >> vlc seems to be able to open a MJPG stream after a few failed
> >> >> >> attempts, I can't really understand why it fails with the other
> >> >> >> software (it returns a I/O error when trying to set the stream
> >> >> >> format).
> >> >> >> Can you increase the driver verbosity and check for error messages with dmesg ?
> >> >> >>
> >> >> >> Regards,
> >> >> >> Paulo
> >> >> >>
> >> >> >> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
> >> >> >> > Got the latest version, but error still happened (logs below)
> >> >> >> > Have you seen the vlc logs?
> >> >> >> > It seems that cam not supported by ??? drivers - direct kernel v4l2  -
> >> >> >> > what does it means?
> >> >> >> >
> >> >> >> >
> >> >> >> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
> >> >> >> > libv4l2: error setting pixformat: Input/output error
> >> >> >> > libv4l2: error setting pixformat: Input/output error
> >> >> >> > libv4l2: error setting pixformat: Input/output error
> >> >> >> > [0x8e24368] v4l2 demux warning: Could not select any of the default
> >> >> >> > chromas; attempting to open as MPEG encoder card (access)
> >> >> >> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
> >> >> >> > could be loaded
> >> >> >> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
> >> >> >> > 55.611 ms / 1 intvls (Avg 55.611 ms)
> >> >> >> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
> >> >> >> > [0x8e28398] main access debug: looking for access module: 1 candidate
> >> >> >> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
> >> >> >> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
> >> >> >> >
> >> >> >> >
> >> >> >> >
> >> >> >> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
> >> >> >> > guvcview 1.4.1
> >> >> >> >
> >> >> >> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
> >> >> >> >        Using the fallback 'C' locale.
> >> >> >> > unexpected integer value (0) for vid_mux
> >> >> >> > Strings must be quoted
> >> >> >> > unexpected integer value (1) for snd_numsec
> >> >> >> > Strings must be quoted
> >> >> >> > unexpected integer value (160) for snd_bitrate
> >> >> >> > Strings must be quoted
> >> >> >> > unexpected integer value (2) for Pan_Step
> >> >> >> > Strings must be quoted
> >> >> >> > unexpected integer value (2) for Tilt_Step
> >> >> >> > Strings must be quoted
> >> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> >> >> > video device: /dev/video0
> >> >> >> > /dev/video0 - device 1
> >> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > vid:18ec
> >> >> >> > pid:3188
> >> >> >> > driver:uvcvideo
> >> >> >> > checking format: 1448695129
> >> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> >> >> > Init v4L2 failed !!
> >> >> >> > Init video returned -2
> >> >> >> > trying minimum setup ...
> >> >> >> > video device: /dev/video0
> >> >> >> > /dev/video0 - device 1
> >> >> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> >> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> >> >> > { discrete: width = 640, height = 480 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > { discrete: width = 320, height = 240 }
> >> >> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> >> >> > vid:18ec
> >> >> >> > pid:3188
> >> >> >> > driver:uvcvideo
> >> >> >> > checking format: 1196444237
> >> >> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> >> >> > Init v4L2 failed !!
> >> >> >> > ERROR: Minimum Setup Failed.
> >> >> >> >  Exiting...
> >> >> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> >> >> >> > cleaned allocations - 100%
> >> >> >> > Closing portaudio ...O
> >> >> >> >
> >> >> >> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
> >> >> >> >> guvcview --format yuyv
> >> >> >> >
> >> >> >> >
> >> >> >>
> >> >> >
> >> >> >
> >> >> >
> >> >>
> >> >
> >> >
> >>
> >
> >
> >
> 




From freegate at mail.ru  Thu Jun 24 16:29:21 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Thu, 24 Jun 2010 18:29:21 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<AANLkTinzoggbaaUs5wtU1OxE1SPprWMlM1HPxYQQKzOx@mail.gmail.com>
	<1277233339.2092.14.camel@kuzmin-desktop>
	<AANLkTin0E-u-sxL25CHlkxwMHe2kGX08JQBEY-PNk0aP@mail.gmail.com>
	<1277305867.3060.1.camel@kuzmin-desktop>
	<AANLkTilCh-af-xQn2PWPVDt23G_TDLQmTTgaxSUtaF2o@mail.gmail.com>
	<1277311470.3060.10.camel@kuzmin-desktop>
	<AANLkTikwgIlgs3uS_UBIAn4oVItoCikWGvm7WG__eXRB@mail.gmail.com>
	<1277351312.3060.14.camel@kuzmin-desktop>
	<AANLkTim2rl3mg_s99_hZcEoZDgiYSzQ1SMBT6j-Vqein@mail.gmail.com>
Message-ID: <1277389761.1777.5.camel@kuzmin-desktop>

Hi Paulo! Requested logs in attach
dmesg - all from the system cold boot





? ???, 24/06/2010 ? 10:31 +0100, Paulo Assis ?????:
> Andrew Hi,
> you can increase the driver verbosity by setting the trace parameter:
> rmmod uvcvideo
> modprobe uvcvideo trace=65535
> 
> trace level is given by grouping several flags so you can set it to
> something like 0xffffff and get a huge amount of information on the
> logs (just don't forget to reset it after you finish debugging)
> 
> after this dmesg should be a lot more verbose.
> 
> Some cameras require a quirks value to function properly, but you
> really need to check what's going on first.
> 
> Best regards,
> Paulo
> 
> 2010/6/24 Andrew V Kuzmin <freegate at mail.ru>:
> > Hi, I did not fully inderstand how to seperverbose driver logs,
> > the key in guvcview -v only, not like -vvv in vlc.
> > DMESG once again
> >
> > when camera plugged in
> >
> > 46064.024031] usb 1-1: new high speed USB device using ehci_hcd and
> > address 7
> > [46064.158039] usb 1-1: configuration #1 chosen from 1 choice
> > [46064.158652] uvcvideo: Found UVC 1.00 device USB2.0 PC CAMERA
> > (18ec:3188)
> > [46064.158900] uvcvideo: UVC non compliance - GET_DEF(PROBE) not
> > supported. Enabling workaround.
> > [46064.159391] input: USB2.0 PC CAMERA
> > as /devices/pci0000:00/0000:00:1d.7/usb1/1-1/1-1:1.0/input/input10
> >
> > then when guvcview called
> >
> > [46206.284313] uvcvideo: Failed to query (130) UVC probe control : 0
> > (exp. 26).
> > [46206.287686] uvcvideo: Failed to query (130) UVC probe control : 0
> > (exp. 26).
> >
> >
> >
> >
> > kuzmin at kuzmin-desktop:~$ guvcview -v
> > guvcview 1.4.1
> >
> > (process:13812): Gtk-WARNING **: Locale not supported by C library.
> >        Using the fallback 'C' locale.
> > unexpected integer value (0) for vid_mux
> > Strings must be quoted
> > unexpected integer value (1) for snd_numsec
> > Strings must be quoted
> > unexpected integer value (160) for snd_bitrate
> > Strings must be quoted
> > unexpected integer value (2) for Pan_Step
> > Strings must be quoted
> > unexpected integer value (2) for Tilt_Step
> > Strings must be quoted
> > video_device: /dev/video0
> > vid_sleep: 0
> > cap_meth: 1
> > resolution: 640 x 480
> > windowsize: 480 x 700
> > vert pane: 0
> > spin behavior: 0
> > mode: mjpg
> > fps: 1/25
> > Display Fps: 0
> > bpp: 0
> > hwaccel: 1
> > avi_format: 0
> > sound: 1
> > sound Device: 0
> > sound samp rate: 0
> > sound Channels: 0
> > Sound delay: 0 nanosec
> > Sound Format: 80
> > Pan Step: 2 degrees
> > Tilt Step: 2 degrees
> > Video Filter Flags: 0
> > image inc: 0
> > profile(default):/home/kuzmin/default.gpfl
> > starting portaudio...
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > bt_audio_service_open: connect() failed: Connection refused (111)
> > language catalog=> dir:/usr/share/locale type:(null) lang:en_EN
> > cat:guvcview.mo
> > mjpg: setting format to 1196444237
> > capture method = 1
> > video device: /dev/video0
> > /dev/video0 - device 1
> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> > { pixelformat = 'MJPG', description = 'MJPEG' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'RGB3', description = 'RGB3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'BGR3', description = 'BGR3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YU12', description = 'YU12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YV12', description = 'YV12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > vid:18ec
> > pid:3188
> > driver:uvcvideo
> > checking format: 1196444237
> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> > Init v4L2 failed !!
> > Init video returned -2
> > trying minimum setup ...
> > capture method = 1
> > video device: /dev/video0
> > /dev/video0 - device 1
> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> > { pixelformat = 'MJPG', description = 'MJPEG' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'RGB3', description = 'RGB3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'BGR3', description = 'BGR3' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YU12', description = 'YU12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { pixelformat = 'YV12', description = 'YV12' }
> > { discrete: width = 640, height = 480 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > { discrete: width = 320, height = 240 }
> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> > vid:18ec
> > pid:3188
> > driver:uvcvideo
> > checking format: 1196444237
> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> > Init v4L2 failed !!
> > ERROR: Minimum Setup Failed.
> >  Exiting...
> > free audio mutex
> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> > closed v4l2 strutures
> > free controls - vidState
> > cleaned allocations - 100%
> > Closing portaudio ...OK
> > Terminated.
> >
> >
> >
> > ? ???, 23/06/2010 ? 23:52 +0100, Paulo Assis ?????:
> >> Andrew Hi,
> >> By default vlc uses libv4l, just like most other software, when this
> >> fails it reverts to direct v4l2 access, (you probably should also
> >> check your libv4l version and update it if needed)
> >> vlc seems to be able to open a MJPG stream after a few failed
> >> attempts, I can't really understand why it fails with the other
> >> software (it returns a I/O error when trying to set the stream
> >> format).
> >> Can you increase the driver verbosity and check for error messages with dmesg ?
> >>
> >> Regards,
> >> Paulo
> >>
> >> 2010/6/23 Andrew V Kuzmin <freegate at mail.ru>:
> >> > Got the latest version, but error still happened (logs below)
> >> > Have you seen the vlc logs?
> >> > It seems that cam not supported by ??? drivers - direct kernel v4l2  -
> >> > what does it means?
> >> >
> >> >
> >> > [0x8e24368] v4l2 demux debug: will try to find optimal width and height.
> >> > libv4l2: error setting pixformat: Input/output error
> >> > libv4l2: error setting pixformat: Input/output error
> >> > libv4l2: error setting pixformat: Input/output error
> >> > [0x8e24368] v4l2 demux warning: Could not select any of the default
> >> > chromas; attempting to open as MPEG encoder card (access)
> >> > [0x8e24368] main demux warning: no access_demux module matching "v4l2"
> >> > could be loaded
> >> > [0x8e24368] main demux debug: TIMER module_need() : 55.611 ms - Total
> >> > 55.611 ms / 1 intvls (Avg 55.611 ms)
> >> > [0x8bdfa98] main input debug: creating access 'v4l2' path=''
> >> > [0x8e28398] main access debug: looking for access module: 1 candidate
> >> > [0x8e28398] v4l2 access debug: Trying direct kernel v4l2
> >> > [0x8e28398] v4l2 access debug: opening device '/dev/video0'
> >> >
> >> >
> >> >
> >> > kuzmin at kuzmin-desktop:~$ guvcview --format yuyv
> >> > guvcview 1.4.1
> >> >
> >> > (process:4154): Gtk-WARNING **: Locale not supported by C library.
> >> >        Using the fallback 'C' locale.
> >> > unexpected integer value (0) for vid_mux
> >> > Strings must be quoted
> >> > unexpected integer value (1) for snd_numsec
> >> > Strings must be quoted
> >> > unexpected integer value (160) for snd_bitrate
> >> > Strings must be quoted
> >> > unexpected integer value (2) for Pan_Step
> >> > Strings must be quoted
> >> > unexpected integer value (2) for Tilt_Step
> >> > Strings must be quoted
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > bt_audio_service_open: connect() failed: Connection refused (111)
> >> > video device: /dev/video0
> >> > /dev/video0 - device 1
> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > vid:18ec
> >> > pid:3188
> >> > driver:uvcvideo
> >> > checking format: 1448695129
> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> > Init v4L2 failed !!
> >> > Init video returned -2
> >> > trying minimum setup ...
> >> > video device: /dev/video0
> >> > /dev/video0 - device 1
> >> > Init. USB2.0 PC CAMERA (location: usb-0000:00:1d.7-1)
> >> > { pixelformat = 'MJPG', description = 'MJPEG' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YUYV', description = 'YUV 4:2:2 (YUYV)' }
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'RGB3', description = 'RGB3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'BGR3', description = 'BGR3' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YU12', description = 'YU12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { pixelformat = 'YV12', description = 'YV12' }
> >> > { discrete: width = 640, height = 480 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > { discrete: width = 320, height = 240 }
> >> >        Time interval between frame: 1/25, 1/20, 1/15, 1/10,
> >> > vid:18ec
> >> > pid:3188
> >> > driver:uvcvideo
> >> > checking format: 1196444237
> >> > VIDIOC_S_FORMAT - Unable to set format: Input/output error
> >> > Init v4L2 failed !!
> >> > ERROR: Minimum Setup Failed.
> >> >  Exiting...
> >> > VIDIOC_REQBUFS - Failed to delete buffers: Invalid argument (errno 22)
> >> > cleaned allocations - 100%
> >> > Closing portaudio ...O
> >> >
> >> > ? ???, 23/06/2010 ? 17:05 +0100, Paulo Assis ?????:
> >> >> guvcview --format yuyv
> >> >
> >> >
> >>
> >
> >
> >
> 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: guvcview.20100624.log
Type: text/x-log
Size: 5078 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100624/97c94640/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmesg.20100624.log
Type: text/x-log
Size: 54450 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100624/97c94640/attachment-0001.bin>

From laurent.pinchart at ideasonboard.com  Fri Jun 25 09:46:31 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 25 Jun 2010 09:46:31 +0200
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <AANLkTin-hS-jigJtyU6NujGMzUMd4AP-qUhjovLyarEW@mail.gmail.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<1277392528.1777.13.camel@kuzmin-desktop>
	<AANLkTin-hS-jigJtyU6NujGMzUMd4AP-qUhjovLyarEW@mail.gmail.com>
Message-ID: <201006250946.31976.laurent.pinchart@ideasonboard.com>

Hi Paulo and Andrew,

On Thursday 24 June 2010 17:58:01 Paulo Assis wrote:
> 
> You should now make this change more permanent in the driver configuration,
> create a file named uvcvideo.conf in /etc/modprobe.d
> add the following line:
> options uvcvideo quirks=2
> 
> the quirks parameter bypasses some problems originated by faulty or
> non fully compliant hardware.
> In your case the camera fails when getting the min and max values for
> the compression settings during probe,
> quirks=2 bypasses this.

Thanks for helping Andrew with the problem.

> Laurent, you should add this camera to the uvc_ids list and hard code
> the quirk there.
> (This list just keeps getting bigger and bigger)

Sure, I will. I'll need the output of

lsusb -v -d 18ec:3188

Andrew, could you please provide that ?

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Jun 25 11:15:27 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 25 Jun 2010 11:15:27 +0200
Subject: [Linux-uvc-devel]
 =?iso-8859-1?q?0402=3A5606_ALi_Corp=2E_USB_2=2E?=
 =?iso-8859-1?q?0_Camera_-_NO_FULL=09SIZED_OUTPUT?=
In-Reply-To: <loom.20100624T001430-502@post.gmane.org>
References: <loom.20100610T163437-102@post.gmane.org>
	<201006171308.59325.laurent.pinchart@ideasonboard.com>
	<loom.20100624T001430-502@post.gmane.org>
Message-ID: <201006251115.28348.laurent.pinchart@ideasonboard.com>

Hi,

On Thursday 24 June 2010 00:16:18 seno wrote:
> Laurent Pinchart <laurent.pinchart <at> ideasonboard.com> writes:
> > > show only about half of the real picture (or even less).
> > 
> > Could you post a screenshot ? Does that happen at all resolutions ?
> 
> I did some tests and it happens at all resolutions except 1280x1024; at
> least the image is centered at that resolution.
> 
> I put an object in front of the notebook and took a screenshot in linux and
> w7, without moving anything between the screenshots, resolution was set to
> 640x480 each time.
> 
> http://img10.imageshack.us/img10/1583/bisoncam640x480w7.png
> http://img706.imageshack.us/img706/7683/uvc640x480mdv20100.png

Thanks.

[snip]

> > Could you please send me the output of 'lsusb -v -d 0402:5606' ? I've got
> > a copy already, but the BIOS update might have modified it.
> 
> Uploaded here (looks same as one that has been previously posted here):
> 
> http://www.loaditup.de/files/509608.txt

Thank you. The descriptors expose pan, tilt and zoom controls. That looks a 
bit weird for an integrated webcam. Could you try to modify them and see if 
they have any influence on the picture ?

> > The "Camera requested null bandwidth" error message shouldn't be an issue,
> > at least if the camera has a single alternate setting like the model I
> > know bout has. This can be checked with the lsusb output.
> > 
> > The "Failed to query" messages definitely indicate a firmware bug. It
> > might or might not be related to the bad picture issue you have. Would you
> > be able to capture a USB trace on Windows if required ?
> 
> Today I noticed again a poor webcam performance in Linux, while I get max.
> 7 fps at full sun exposure, the video runs smooth in win 7, even at lower
> exposure (at least 15 fps). Furthermore, the image is more bright and sharp
> on Windows, but I would be happy if I can get a full sized output at all.

Do you get 15 fps in Windows in 1280x1024 ? The camera seems to capture a full 
resolution image even when you select a lower resolution, and that might have 
an influence on the frame rate.

> If required, I can capture a USB trace  on win 7 (would SysNucleus USBTrace
> be a good software for that? (Have already installed it)

As long as you can export the data in a text-based format, I think that's 
fine. You can ignore the video transfers (isochronous), but I'll need all 
control transfers from as early as possible until you start the video capture. 
As the camera is integrated in the laptop the initialization sequence 
performed at bootup won't be easy to capture, but with a little luck that 
won't be needed.

Let's first check if the pan/tilt and zoom controls have any influence on the 
image.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Jun 25 11:27:34 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 25 Jun 2010 11:27:34 +0200
Subject: [Linux-uvc-devel] Web Cam HP tx2 1275
In-Reply-To: <AANLkTileJKkkWtmvOPQiiJMKjjXopm8cDwCAnAMWXgG9@mail.gmail.com>
References: <AANLkTilTQFyzpGjIc_Fkn_Z9szLHuemQuhDUg94CjQCt@mail.gmail.com>
	<AANLkTileJKkkWtmvOPQiiJMKjjXopm8cDwCAnAMWXgG9@mail.gmail.com>
Message-ID: <201006251127.35459.laurent.pinchart@ideasonboard.com>

Hi Jos?,

On Monday 21 June 2010 18:03:02 Jos? Carlos wrote:
> Hello
> 
> I would like to request the checks of the device ID - 064e:a103 Manufactor
> by SuYin
> 
> devices ID that is not in the list.

Which list are you talking about ? The one on http://www.ideasonboard.org/uvc/ 
? The device is already listed there.

If you're talking about the list inside uvc_driver.c, that shouldn't be 
needed. Your camera should be supported out of the box without that.

-- 
Regards,

Laurent Pinchart


From laurent.pinchart at ideasonboard.com  Fri Jun 25 11:29:43 2010
From: laurent.pinchart at ideasonboard.com (Laurent Pinchart)
Date: Fri, 25 Jun 2010 11:29:43 +0200
Subject: [Linux-uvc-devel] uvcvideo detects wrong resolution on vanilla
	kernel
In-Reply-To: <AANLkTimI6bZo5HGdGV73-DdRTJ_q0_2nmvxHRy0KVRsO@mail.gmail.com>
References: <AANLkTimI6bZo5HGdGV73-DdRTJ_q0_2nmvxHRy0KVRsO@mail.gmail.com>
Message-ID: <201006251129.43653.laurent.pinchart@ideasonboard.com>

Hi Satz,

On Saturday 19 June 2010 16:22:27 Satz Klauer wrote:
> 
> I have a strange problem here with a Logitech C200 webcam.
> 
> Using a standard Fedora 13 system with a kernel 2.6.33.5-112.fc13.i686.PAE
> the uvcvideo-module detects everything correctly:
> 
> uvcvideo: Found format YUV 4:2:2 (YUYV).
> uvcvideo: - 640x480 (30.0 fps)
> uvcvideo: - 160x120 (30.0 fps)
> uvcvideo: - 176x144 (30.0 fps)
> uvcvideo: - 320x240 (30.0 fps)
> uvcvideo: - 352x288 (30.0 fps)
> uvcvideo: - 640x360 (30.0 fps)
> uvcvideo: - 640x400 (30.0 fps)
> 
> Now I have second system with a stripped down Fedora 8 and a handmade
> vanilla kernel 2.6.33.5. There uvcvideo is not able to detect the maximum
> resolution of 640x480, the trace output only gives me some resolutions:
> 
> uvcvideo: Found format YUV 4:2:2 (YUYV).
> uvcvideo: - 160x120 (15.0 fps)
> uvcvideo: - 176x144 (15.0 fps)
> 
> What's going on here, what could be the reason for these problems?

My guess is that the first system as an EHCI (USB 2.0) controller, while the 
second has an OHCI/UHCI (USB 1.1) controller. Less bandwidth, smaller frame 
sizes.

-- 
Regards,

Laurent Pinchart


From freegate at mail.ru  Sun Jun 27 08:04:03 2010
From: freegate at mail.ru (Andrew V Kuzmin)
Date: Sun, 27 Jun 2010 10:04:03 +0400
Subject: [Linux-uvc-devel] webcam MANTA MM353 Plako on chip ARK3188
In-Reply-To: <201006250946.31976.laurent.pinchart@ideasonboard.com>
References: <1277067605.2985.5.camel@kuzmin-desktop>
	<1277392528.1777.13.camel@kuzmin-desktop>
	<AANLkTin-hS-jigJtyU6NujGMzUMd4AP-qUhjovLyarEW@mail.gmail.com>
	<201006250946.31976.laurent.pinchart@ideasonboard.com>
Message-ID: <1277618643.1702.0.camel@kuzmin-desktop>

Laurent, hello!

lsusb on my webcam below


root at kuzmin-desktop:/home/kuzmin# lsusb -v -d 18ec:3188

Bus 001 Device 004: ID 18ec:3188 Arkmicro Technologies Inc. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x18ec Arkmicro Technologies Inc.
  idProduct          0x3188 
  bcdDevice            1.03
  iManufacturer           1 ARKMICRO
  iProduct                2 USB2.0 PC CAMERA
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          341
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass         14 Video
      bFunctionSubClass       3 Video Interface Collection
      bFunctionProtocol       0 
      iFunction               0 
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      1 Video Control
      bInterfaceProtocol      0 
      iInterface              0 
      VideoControl Interface Descriptor:
        bLength                13
        bDescriptorType        36
        bDescriptorSubtype      1 (HEADER)
        bcdUVC               1.00
        wTotalLength           51
        dwClockFrequency       48.000000MHz
        bInCollection           1
        baInterfaceNr( 0)       1
      VideoControl Interface Descriptor:
        bLength                18
        bDescriptorType        36
        bDescriptorSubtype      2 (INPUT_TERMINAL)
        bTerminalID             1
        wTerminalType      0x0201 Camera Sensor
        bAssocTerminal          0
        iTerminal               0 
        wObjectiveFocalLengthMin      0
        wObjectiveFocalLengthMax      0
        wOcularFocalLength            0
        bControlSize                  3
        bmControls           0x0000200a
          Auto-Exposure Mode
          Exposure Time (Absolute)
          Roll (Absolute)
      VideoControl Interface Descriptor:
        bLength                11
        bDescriptorType        36
        bDescriptorSubtype      5 (PROCESSING_UNIT)
      Warning: Descriptor too short
        bUnitID                 2
        bSourceID               1
        wMaxMultiplier      16384
        bControlSize            2
        bmControls     0x0000073f
          Brightness
          Contrast
          Hue
          Saturation
          Sharpness
          Gamma
          Backlight Compensation
          Gain
          Power Line Frequency
        iProcessing             0 
        bmVideoStandards     0x 9
          None
          SECAM - 625/50
      VideoControl Interface Descriptor:
        bLength                 9
        bDescriptorType        36
        bDescriptorSubtype      3 (OUTPUT_TERMINAL)
        bTerminalID             3
        wTerminalType      0x0101 USB Streaming
        bAssocTerminal          0
        bSourceID               2
        iTerminal               0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval              10
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           0
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      VideoStreaming Interface Descriptor:
        bLength                            15
        bDescriptorType                    36
        bDescriptorSubtype                  1 (INPUT_HEADER)
        bNumFormats                         2
        wTotalLength                      227
        bEndPointAddress                  131
        bmInfo                              0
        bTerminalLink                       3
        bStillCaptureMethod                 1
        bTriggerSupport                     1
        bTriggerUsage                       1
        bControlSize                        1
        bmaControls( 0)                    11
        bmaControls( 1)                    11
      VideoStreaming Interface Descriptor:
        bLength                            11
        bDescriptorType                    36
        bDescriptorSubtype                  6 (FORMAT_MJPEG)
        bFormatIndex                        1
        bNumFrameDescriptors                3
        bFlags                              1
          Fixed-size samples: Yes
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            42
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                  8388608
        dwMaxBitRate                  8388608
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  4
        dwFrameInterval( 0)            400000
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            42
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         2
        bmCapabilities                   0x01
          Still image supported
        wWidth                            640
        wHeight                           480
        dwMinBitRate                 12165120
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  4
        dwFrameInterval( 0)            400000
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            42
        bDescriptorType                    36
        bDescriptorSubtype                  7 (FRAME_MJPEG)
        bFrameIndex                         3
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                  8388608
        dwMaxBitRate                  8388608
        dwMaxVideoFrameBufferSize      153600
        dwDefaultFrameInterval         400000
        bFrameIntervalType                  4
        dwFrameInterval( 0)            400000
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
      VideoStreaming Interface Descriptor:
        bLength                            27
        bDescriptorType                    36
        bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
        bFormatIndex                        2
        bNumFrameDescriptors                1
        guidFormat
{59555932-0000-1000-8000-00aa00389b71}
        bBitsPerPixel                      16
        bDefaultFrameIndex                  1
        bAspectRatioX                       0
        bAspectRatioY                       0
        bmInterlaceFlags                 0x00
          Interlaced stream or variable: No
          Fields per frame: 1 fields
          Field 1 first: No
          Field pattern: Field 1 only
          bCopyProtect                      0
      VideoStreaming Interface Descriptor:
        bLength                            42
        bDescriptorType                    36
        bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
        bFrameIndex                         1
        bmCapabilities                   0x01
          Still image supported
        wWidth                            320
        wHeight                           240
        dwMinBitRate                 12165120
        dwMaxBitRate                 12165120
        dwMaxVideoFrameBufferSize      614400
        dwDefaultFrameInterval         666666
        bFrameIntervalType                  4
        dwFrameInterval( 0)            400000
        dwFrameInterval( 1)            500000
        dwFrameInterval( 2)            666666
        dwFrameInterval( 3)           1000000
      VideoStreaming Interface Descriptor:
        bLength                             6
        bDescriptorType                    36
        bDescriptorSubtype                 13 (COLORFORMAT)
        bColorPrimaries                     0 (Unspecified)
        bTransferCharacteristics            0 (Unspecified)
        bMatrixCoefficients                 0 (Unspecified)
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       1
      bNumEndpoints           1
      bInterfaceClass        14 Video
      bInterfaceSubClass      2 Video Streaming
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            5
          Transfer Type            Isochronous
          Synch Type               Asynchronous
          Usage Type               Data
        wMaxPacketSize     0x0400  1x 1024 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)




? ???, 25/06/2010 ? 09:46 +0200, Laurent Pinchart ?????:
> Hi Paulo and Andrew,
> 
> On Thursday 24 June 2010 17:58:01 Paulo Assis wrote:
> > 
> > You should now make this change more permanent in the driver configuration,
> > create a file named uvcvideo.conf in /etc/modprobe.d
> > add the following line:
> > options uvcvideo quirks=2
> > 
> > the quirks parameter bypasses some problems originated by faulty or
> > non fully compliant hardware.
> > In your case the camera fails when getting the min and max values for
> > the compression settings during probe,
> > quirks=2 bypasses this.
> 
> Thanks for helping Andrew with the problem.
> 
> > Laurent, you should add this camera to the uvc_ids list and hard code
> > the quirk there.
> > (This list just keeps getting bigger and bigger)
> 
> Sure, I will. I'll need the output of
> 
> lsusb -v -d 18ec:3188
> 
> Andrew, could you please provide that ?
> 




From senada at t-online.de  Mon Jun 28 22:17:54 2010
From: senada at t-online.de (seno)
Date: Mon, 28 Jun 2010 20:17:54 +0000 (UTC)
Subject: [Linux-uvc-devel]
	=?utf-8?q?0402=3A5606_ALi_Corp=2E_USB_2=2E0_Cam?=
	=?utf-8?q?era_-_NO_FULL=09SIZED_OUTPUT?=
References: <loom.20100610T163437-102@post.gmane.org>
	<201006171308.59325.laurent.pinchart@ideasonboard.com>
	<loom.20100624T001430-502@post.gmane.org>
	<201006251115.28348.laurent.pinchart@ideasonboard.com>
Message-ID: <loom.20100628T214429-819@post.gmane.org>

Laurent Pinchart <laurent.pinchart <at> ideasonboard.com> writes:

> Thank you. The descriptors expose pan, tilt and zoom controls. That looks a 
> bit weird for an integrated webcam. Could you try to modify them and see if 
> they have any influence on the picture ?
> Let's first check if the pan/tilt and zoom controls have any influence on the 
> image.

Hello,

it took me a while to find a way to set tilt/pan on a webcam, but finally I 
found luvcview offers that options :)

Result:
Image does not change at all.

console output:
ioctl querycontrol error: Invalid argument
Set Pan up error

ioctl querycontrol error: Invalid argument
Set Pan down error

Same output for tilt and gain.

Setting brightnes, contrast, saturation, sharpness, gamma, exposure and white 
balance works

> Do you get 15 fps in Windows in 1280x1024 ? The camera seems to capture a 
full 
> resolution image even when you select a lower resolution, and that might have 
> an influence on the frame rate.

The Windows BisonCam application doesn't show fps, so I opened the cam with VLC 
Player and that reported 15 fps at 1280x1024 what might be correct as the video 
runs smooth. Other resolutions run at 30 fps on windows. 


> You can ignore the video transfers (isochronous), but I'll need all 
> control transfers from as early as possible until you start the video 
capture. 
> As the camera is integrated in the laptop the initialization sequence 
> performed at bootup won't be easy to capture, but with a little luck that 
> won't be needed.

The cam is integrated, but can be dis-/enabled by pressing Fn+F10.
So I did
- one USB trace while 'hotplugging' the cam and
- one trace when the cam already was connected and I started the BisonCam 
application; I snipped the isochronous traces

camera hotplug trace: http://www.loaditup.de/files/511048.txt

start camera application trace: http://www.loaditup.de/511049.html

I hope that helps for further investigation, please reply if you need anything 
else...



From michel.filipe at gmail.com  Wed Jun 30 17:55:27 2010
From: michel.filipe at gmail.com (Michel Filipe)
Date: Wed, 30 Jun 2010 12:55:27 -0300
Subject: [Linux-uvc-devel] Better webcam support
Message-ID: <201006301255.28376.michel.filipe@gmail.com>

Hi everybody!

I don't found nothing about the webcams with better support in gnu/linux, only 
if webcam device support or not. What are the webcams with better support?

My webcam is the Microsoft LifeCam NX-1000 but the image is not good and the 
microphone doesn't work. :(

Sorry about my english, it is limited.

Thanks,
-- 
Michel Filipe
Belo Horizonte/MG


From night_black at inbox.ru  Wed Jun 30 11:22:49 2010
From: night_black at inbox.ru (night black)
Date: Wed, 30 Jun 2010 13:22:49 +0400
Subject: [Linux-uvc-devel] =?koi8-r?b?QWNlciBDcnlzdGFsIEV5ZSBXZWJjYW0gKDA0?=
	=?koi8-r?b?NTg6NzA2Nik=?=
Message-ID: <E1OTtVJ-0000gM-00.night_black-inbox-ru@f11.mail.ru>


Wed, 30 Jun 2010 09:18:15 +0300 ?????? ?? Night <night_black at inbox.ru>:

> Hello. 
> I have web cam Acer Crystal Eye Webcam (0458:7066) integrated into Acer H243HX. Can you help me install drivers for linux.
> 
> Some executed command:
> ~$ dmesg | egrep -i uvc 
> [? ? 23.274844] uvcvideo: Found UVC 1.00 device Acer Crystal Eye Webcam(0458:7066)
> [? ? 23.464268] usbcore: registered new interface driver uvcvideo
> 
> ~$ sudo lsusb -d 0458:7066 -v
> see "log.txt"


? ? ???? ???? - http://my.mail.ru/inbox/night_black/
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: log.txt
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100630/16dacad7/attachment.txt>

From david at watzke.cz  Wed Jun 30 18:43:39 2010
From: david at watzke.cz (David Watzke)
Date: Wed, 30 Jun 2010 18:43:39 +0200
Subject: [Linux-uvc-devel] upside down webcam: Asus K52JC
Message-ID: <201006301843.39521.david@watzke.cz>

Hi,

another laptop with a webcam mounted upside down is Asus K52JC

attaching dmidecode and lsusb -v outputs

-- David Watzke
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dmidecode.log
Type: text/x-log
Size: 21602 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100630/59e26e7b/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lsusb.log
Type: text/x-log
Size: 29806 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/linux-uvc-devel/attachments/20100630/59e26e7b/attachment-0001.bin>

