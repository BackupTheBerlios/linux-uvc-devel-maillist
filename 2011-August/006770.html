<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] 3.0 - exposure settings.
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2011-August/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%203.0%20-%20exposure%20settings.&In-Reply-To=%3CCAPueXH6jF_BZ_ibk-wgypNEyM5x1Q7%3DgA38qgfwNWEKgT190iQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006769.html">
   <LINK REL="Next"  HREF="006772.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] 3.0 - exposure settings.</H1>
    <B>Paulo Assis</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%203.0%20-%20exposure%20settings.&In-Reply-To=%3CCAPueXH6jF_BZ_ibk-wgypNEyM5x1Q7%3DgA38qgfwNWEKgT190iQ%40mail.gmail.com%3E"
       TITLE="[Linux-uvc-devel] 3.0 - exposure settings.">pj.assis at gmail.com
       </A><BR>
    <I>Wed Aug  3 17:20:03 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006769.html">[Linux-uvc-devel] 3.0 - exposure settings.
</A></li>
        <LI>Next message: <A HREF="006772.html">[Linux-uvc-devel] 3.0 - exposure settings.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6770">[ date ]</a>
              <a href="thread.html#6770">[ thread ]</a>
              <a href="subject.html#6770">[ subject ]</a>
              <a href="author.html#6770">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I've just test it under 3.0 and it seems to be working fine now.
The way menu entries were listed was causing it to misbehave, when
querying for the menu items if one happened to fail then the loop
would break, not listing the remaining entries. Now we just continue
until the last index (maximum value).

Regards,
Paulo

2011/8/3 Paulo Assis &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">pj.assis at gmail.com</A>&gt;:
&gt;<i> Hi,
</I>&gt;<i> guvcview had a little problem when handling menu control indexes, it
</I>&gt;<i> was using the combo box index instead of the real control menu index.
</I>&gt;<i> This should be fixed in svn (<A HREF="svn://svn.berlios.de/guvcview/trunk">svn://svn.berlios.de/guvcview/trunk</A>) if
</I>&gt;<i> you care to test it.
</I>&gt;<i>
</I>&gt;<i> This worked fine for sequential menu indexes, but this specific case
</I>&gt;<i> revealed the bug.
</I>&gt;<i>
</I>&gt;<i> In any case I can't see how it turned a menu combo into a check box,
</I>&gt;<i> It just hasn't that type of code.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Paulo
</I>&gt;<i>
</I>&gt;<i> 2011/8/3 Laurent Pinchart &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">laurent.pinchart at ideasonboard.com</A>&gt;:
</I>&gt;&gt;<i> Hi Carl,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wednesday 03 August 2011 08:29:56 Carl Michal wrote:
</I>&gt;&gt;&gt;<i> On Tue, 2 Aug 2011, Laurent Pinchart wrote:
</I>&gt;&gt;&gt;<i> &gt; On Tuesday 02 August 2011 07:29:47 Carl Michal wrote:
</I>&gt;&gt;&gt;<i> &gt;&gt; Hi Laurent,
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; I understand there were changes made in the exposure settings
</I>&gt;&gt;&gt;<i> &gt;&gt; in 3.0. &#160;I just installed 3.0 and have some new/different issues here.
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; I have two cameras available: a quanta integrated webcam in a dell XPS
</I>&gt;&gt;&gt;<i> &gt;&gt; 15 and a logitech C910.
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; For either camera, guvcview used to give me a drop-down menu with 4
</I>&gt;&gt;&gt;<i> &gt;&gt; exposure options in addition to an auto priority checkbox and a slider
</I>&gt;&gt;&gt;<i> &gt;&gt; to manually set the exposure. Two of the drop-down settings didn't seem
</I>&gt;&gt;&gt;<i> &gt;&gt; to work, but two of them did. With a 3.0 kernel, there is only an auto
</I>&gt;&gt;&gt;<i> &gt;&gt; exposure check-box and manual exposure slider - but the exposure slider
</I>&gt;&gt;&gt;<i> &gt;&gt; no longer works and guvcview says:
</I>&gt;&gt;&gt;<i> &gt;&gt; control id: 0x009a0902 failed to set (error -1) (for the quanta)
</I>&gt;&gt;&gt;<i> &gt;&gt; or
</I>&gt;&gt;&gt;<i> &gt;&gt; control id: 0x009a0902 failed to set (error -1) (for the logitech)
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; So pretty much the same error for both :-)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> err - somehow they looked a little less identical when I went to paste
</I>&gt;&gt;&gt;<i> the second one in. &#160;Blame that on the new baby...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt; Could you try listing the controls with v4l2-ctl or yavta ? The
</I>&gt;&gt;&gt;<i> &gt; auto-exposure control should still be a menu (I expect guvcview to
</I>&gt;&gt;&gt;<i> &gt; convert it to a boolean control automatically for some reason, maybe
</I>&gt;&gt;&gt;<i> &gt; because it has two values only), and if the values reported by the
</I>&gt;&gt;&gt;<i> &gt; driver match the two values that worked before ?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> yavta -l for either camera lists three exposure controls (with different
</I>&gt;&gt;&gt;<i> values for the min, max and default):
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> control 0x009a0901 `Exposure, Auto' min 0 max 3 step 1 default 3 current 3.
</I>&gt;&gt;&gt;<i> &#160; &#160;1: Manual Mode
</I>&gt;&gt;&gt;<i> &#160; &#160;3: Aperture Priority Mode
</I>&gt;&gt;&gt;<i> control 0x009a0902 `Exposure (Absolute)' min 3 max 2047 step 1 default 166
</I>&gt;&gt;&gt;<i> current 166. control 0x009a0903 `Exposure, Auto Priority' min 0 max 1 step
</I>&gt;&gt;&gt;<i> 1 default 0 current 0.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The two values reported for the 'Exposure, Auto' control are the two
</I>&gt;&gt;&gt;<i> values in the drop down that worked before. But that control isn't drawn
</I>&gt;&gt;&gt;<i> by guvcview at all now (tried guvcview: 1.4.2, 1.4.4 or 1.4.5).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Interesting though, luvcview (0.2.6) draws the first two of those controls
</I>&gt;&gt;&gt;<i> (but not the third). So - I turned off the auto exposure in luvcview and
</I>&gt;&gt;&gt;<i> now the manual exposure setting works. &#160;But - now I can't turn auto
</I>&gt;&gt;&gt;<i> exposure back on. luvcview says either:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Auto Exposure set to 1
</I>&gt;&gt;&gt;<i> or
</I>&gt;&gt;&gt;<i> Set Auto Exposure off error
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It looks like luvcview wants to set values of either 0 or 1, when the
</I>&gt;&gt;&gt;<i> legal values are 1 or 3.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> with v4l2-ctl, I can set the Auto Exposure control to 1 or 3 and it seems
</I>&gt;&gt;&gt;<i> to work correctly. So looks like the driver does the right thing but maybe
</I>&gt;&gt;&gt;<i> both guvcview and luvcview are confused by the available values?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That's quite likely. Do you want to have a try at fixing them ? :-)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Laurent Pinchart
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Linux-uvc-devel mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">Linux-uvc-devel at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">https://lists.berlios.de/mailman/listinfo/linux-uvc-devel</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006769.html">[Linux-uvc-devel] 3.0 - exposure settings.
</A></li>
	<LI>Next message: <A HREF="006772.html">[Linux-uvc-devel] 3.0 - exposure settings.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6770">[ date ]</a>
              <a href="thread.html#6770">[ thread ]</a>
              <a href="subject.html#6770">[ subject ]</a>
              <a href="author.html#6770">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
