<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] get fault after to run luvcview -f yuv and	luvcview -f jpg on Logitech QuickCam Pro 7500
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2008-September/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20get%20fault%20after%20to%20run%20luvcview%20-f%20yuv%20and%0A%09luvcview%20-f%20jpg%20on%20Logitech%20QuickCam%20Pro%207500&In-Reply-To=%3Cee101c360809090356y230d9b92r737f9bd8ae79fc29%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004055.html">
   <LINK REL="Next"  HREF="004025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] get fault after to run luvcview -f yuv and	luvcview -f jpg on Logitech QuickCam Pro 7500</H1>
    <B>Shuduo Sang</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20get%20fault%20after%20to%20run%20luvcview%20-f%20yuv%20and%0A%09luvcview%20-f%20jpg%20on%20Logitech%20QuickCam%20Pro%207500&In-Reply-To=%3Cee101c360809090356y230d9b92r737f9bd8ae79fc29%40mail.gmail.com%3E"
       TITLE="[Linux-uvc-devel] get fault after to run luvcview -f yuv and	luvcview -f jpg on Logitech QuickCam Pro 7500">sangshuduo at gmail.com
       </A><BR>
    <I>Tue Sep  9 12:56:12 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="004055.html">[Linux-uvc-devel] kernel 2.6.26 - webcam doesn't work,	stack-trace available
</A></li>
        <LI>Next message: <A HREF="004025.html">[Linux-uvc-devel] get fault after to run luvcview -f yuv and	luvcview -f jpg on Logitech QuickCam Pro 7500
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4024">[ date ]</a>
              <a href="thread.html#4024">[ thread ]</a>
              <a href="subject.html#4024">[ subject ]</a>
              <a href="author.html#4024">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> Hi,

kernel version: 2.6.26 vanilla.

I met a problem on Logitech QuickCam Pro 7500 with uvcvideo driver.
This model can outputs with YUYV and MJPG pixel format.
I am writing a program to do something like digital camera. I hope I can
output YUYV data as viewfinding and output mjpg as still capture.
But I can't get MJPG data after I got YUYV data. Since my code is too
huge so i can't attach here, so I can do similar job by luvcview as following.

1, luvcview -f yuv. It works good.
2, luvcview -f jpg. No data output.

After I replug the webcam, luvcview -f jpg works good. and luvcview -f
yuv also works.
 but run luvcview -f jpg again, still no output. It can be reproduced
every time.

I got uvc trace log after insert module again with parameter trace=0x1ff.

[28036.049978] uvcvideo: Probing generic UVC device 3
[28036.049978] uvcvideo: Found format MJPEG.
[28036.049978] uvcvideo: - 160x120 (30.0 fps)
[28036.049978] uvcvideo: - 176x144 (30.0 fps)
[28036.049978] uvcvideo: - 320x240 (15.0 fps)
[28036.049978] uvcvideo: - 352x288 (15.0 fps)
[28036.049978] uvcvideo: - 640x480 (15.0 fps)
[28036.049978] uvcvideo: - 960x720 (15.0 fps)
[28036.049978] uvcvideo: Found format YUV 4:2:2 (YUYV).
[28036.049978] uvcvideo: - 160x120 (30.0 fps)
[28036.049978] uvcvideo: - 176x144 (30.0 fps)
[28036.049978] uvcvideo: - 320x240 (15.0 fps)
[28036.049978] uvcvideo: - 352x288 (15.0 fps)
[28036.049978] uvcvideo: - 640x480 (15.0 fps)
[28036.049978] uvcvideo: - 960x720 (10.0 fps)
[28036.049978] uvcvideo: - 1280x960 (7.5 fps)
[28036.049978] uvcvideo: Found a Status endpoint (addr 87).
[28036.049978] uvcvideo: Found UVC 1.00 device &lt;unnamed&gt; (046d:09a2)
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/2 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/3 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/7 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/8 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/1 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/4 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/5 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000001/2 to device 3 entity 1
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000001/3 to device 3 entity 1
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000001/4 to device 3 entity 1
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/11 to device 3 entity 2
[28036.049978] uvcvideo: Added control
00000000-0000-0000-0000-000000000101/10 to device 3 entity 2
[28036.049978] uvcvideo: Scanning UVC chain: OT 5 &lt;- XU 4 (-&gt; XU 10 12
8 11) &lt;- PU 2 (-&gt; XU 13) &lt;- IT 1
[28036.049978] uvcvideo: Found a valid video chain (1 -&gt; 5).
[28036.083020] input: UVC Camera (046d:09a2) as /class/input/input24
[28036.099224] uvcvideo: UVC device initialized.
[28036.162317] uvcvideo: uvc_v4l2_open
[28036.162319] uvcvideo: uvc_v4l2_ioctl
[28036.162319] VIDIOC_QUERYCAP&lt;7&gt;uvcvideo: uvc_v4l2_ioctl
[28036.180400] VIDIOCGCAPVIDIOC_QUERYCAPVIDIOC_ENUMINPUTVIDIOC_ENUMINPUTVIDIOC_ENUM_FMTVIDIOC_TRY_FMT&lt;7&gt;uvcvideo:
Trying format 0x47504a4d (MJPG): 10000x10000.
[28036.182045] uvcvideo: Using default frame interval 66666.6 us (15.0 fps).
[28036.217822] uvcvideo: uvc_v4l2_release

We can see the &quot;Trying format 0x47504a4d (MJPG): 10000x10000.
It is output by following code lines of uvc_v4l2.c.

 115         fcc = (__u8 *)&amp;fmt-&gt;fmt.pix.pixelformat;
 116         uvc_trace(UVC_TRACE_FORMAT, &quot;Trying format 0x%08x
(%c%c%c%c): %ux%u.\n&quot;,
 117                         fmt-&gt;fmt.pix.pixelformat,
 118                         fcc[0], fcc[1], fcc[2], fcc[3],
 119                         fmt-&gt;fmt.pix.width, fmt-&gt;fmt.pix.height);

I think width and height should not be 10000x10000.
I guess the fmt must be changed somewhere.
Did anyone know this bug or already a patch exist?

Thanks,
Shuduo

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004055.html">[Linux-uvc-devel] kernel 2.6.26 - webcam doesn't work,	stack-trace available
</A></li>
	<LI>Next message: <A HREF="004025.html">[Linux-uvc-devel] get fault after to run luvcview -f yuv and	luvcview -f jpg on Logitech QuickCam Pro 7500
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4024">[ date ]</a>
              <a href="thread.html#4024">[ thread ]</a>
              <a href="subject.html#4024">[ subject ]</a>
              <a href="author.html#4024">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
