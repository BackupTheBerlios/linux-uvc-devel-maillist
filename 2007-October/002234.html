<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] driver installation in Debian
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2007-October/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20driver%20installation%20in%20Debian&In-Reply-To=%3Cf9a7555e0710042241h686aef70g4c0ed07ec5f25108%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002230.html">
   <LINK REL="Next"  HREF="002226.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] driver installation in Debian</H1>
    <B>Ben Lau</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20driver%20installation%20in%20Debian&In-Reply-To=%3Cf9a7555e0710042241h686aef70g4c0ed07ec5f25108%40mail.gmail.com%3E"
       TITLE="[Linux-uvc-devel] driver installation in Debian">xbenlau at gmail.com
       </A><BR>
    <I>Fri Oct  5 07:41:48 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002230.html">[Linux-uvc-devel] driver installation in Debian
</A></li>
        <LI>Next message: <A HREF="002226.html">[Linux-uvc-devel] driver installation in Debian
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2234">[ date ]</a>
              <a href="thread.html#2234">[ thread ]</a>
              <a href="subject.html#2234">[ subject ]</a>
              <a href="author.html#2234">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/5/07, Russell L. Harris &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">rlharris at oplink.net</A>&gt; wrote:
&gt;<i> * Ben Lau &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">xbenlau at gmail.com</A>&gt; [071004 04:21]:
</I>&gt;<i> &gt; On 10/4/07, Russell L. Harris &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">rlharris at oplink.net</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; I am confused.  I am running Debian testing (&quot;Lenny&quot;), and, if
</I>&gt;<i> &gt;&gt; possible, I would like to install the linux-uvc drivers in accordance
</I>&gt;<i> &gt;&gt; with Debian protocol.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I used aptitude to install the Debian package linux-uvc-source.  The
</I>&gt;<i> &gt;&gt; installation provided the file /usr/src/linux-uvc.tar.bz2 , which is
</I>&gt;<i> &gt;&gt; expanded with bunzip2 and tar, providing the following files:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/rules
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/control.modules.in
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/control
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/compat
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/copyright
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/changelog
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/debian/README.Debian
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/Makefile
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvcvideo.h
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvc_video.c
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvc_driver.c
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvc_queue.c
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvc_ctrl.c
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvc_v4l2.c
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/uvc_compat.h
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/extract.c
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/.uvcvideo.o.d
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     /usr/src/modules/linux-uvc/macbook-insight-firmware-loader.8
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; It appears to me that, once I discover the proper Debian approach to
</I>&gt;<i> &gt;&gt; installation of linux-uvc, I can update the drivers simply by copying
</I>&gt;<i> &gt;&gt; into /usr/src/modules/linux-uvc/ the latest source files obtained via:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # svn checkout <A HREF="svn://svn.berlios.de/linux-uvc/linux-uvc/trunk">svn://svn.berlios.de/linux-uvc/linux-uvc/trunk</A> linux-uvc
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; From the OpenFacts documents &quot;Linux UVC&quot; and &quot;HowTo compile for Ubuntu
</I>&gt;<i> &gt;&gt; 6.06 LTS&quot;, it appears that the first thing to do is to compile the
</I>&gt;<i> &gt;&gt; modules:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # make
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # make install
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; -----------------------------------
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Second, the module uvcvideo.ko is to be removed from /lib/modules/ ,
</I>&gt;<i> &gt;&gt; so that the module is not loaded automatically.  (This may be a
</I>&gt;<i> &gt;&gt; problem with Debian, because /lib/modules/ has several subdirectories,
</I>&gt;<i> &gt;&gt; and the structure of /lib/modules/ is not immediately apparent to me.)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; -----------------------------------
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Third, /etc/modprobe.conf.local is to be edited to add the line:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     install uvcvideo /sbin/modprobe snd_usb_audio;
</I>&gt;<i> &gt;&gt;     /sbin/modprobe --ignore-install uvcvideo
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; However, I find in Debian no file /etc/modprobe.conf.local .
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; -----------------------------------
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Fourth, the commands:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # modprobe -r uvcvideo
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # modprobe -r snd_usb_audio
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; are to be used after unplugging the camera, in the event that the
</I>&gt;<i> &gt;&gt; camera needs to be restarted.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; -----------------------------------
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Adding to my confusion is the instruction given in the file
</I>&gt;<i> &gt;&gt; /usr/src/modules/linux-uvc/debian/README.Debian , which states that
</I>&gt;<i> &gt;&gt; the module-assistant tool should be used to install linux-uvc, using
</I>&gt;<i> &gt;&gt; the commands:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # module-assistant prepare
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     # module-assistant auto-install linux-uvc
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; -----------------------------------
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Would someone on the list who is knowledgeable concerning Debian
</I>&gt;<i> &gt;&gt; kindly help me sort out this matter?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; module-assistant is the tool to help to compile module-source package
</I>&gt;<i> &gt; into binary kernel module , and then pack into a Debian package. So
</I>&gt;<i> &gt; that you could install/uninstall through the package management
</I>&gt;<i> &gt; system(dpkg).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The generated package is placed in /usr/src . If you build with the
</I>&gt;<i> &gt; argument &quot;auto-install&quot; , it will be installed automatically. It is
</I>&gt;<i> &gt; recommended  (and the most simplest) way to install kernel module in
</I>&gt;<i> &gt; Debian system. Moreover, the generated package works with a specific
</I>&gt;<i> &gt; kernel version only. That means the package should be rebuild after
</I>&gt;<i> &gt; kernel upgrade.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; However , Debian may not be able to provide the most updated module
</I>&gt;<i> &gt; source. Just take UVC as an example, the most updated revision
</I>&gt;<i> &gt; no. is 132 at this moment , but the module source package in SID
</I>&gt;<i> &gt; could only offer rev 120. If you need the features provided by the
</I>&gt;<i> &gt; most updated revision , then you need to install by source through
</I>&gt;<i> &gt; the svn command, and then build by the command 'make` &amp; `make
</I>&gt;<i> &gt; install`.
</I>&gt;<i>
</I>&gt;<i> Thanks for the explanation, Ben.
</I>&gt;<i>
</I>&gt;<i> I have been running Debian for about five years now, and I have been
</I>&gt;<i> reading man pages, including the man page for module-assistant.  But I
</I>&gt;<i> am still struggling with the concepts involved in this.  I intend to
</I>&gt;<i> write a mini-HOWTO once I understand the concepts.
</I>&gt;<i>
</I>&gt;<i> I would like to ask you two or three more questions, please.
</I>&gt;<i>
</I>&gt;<i> -----------------------------------
</I>&gt;<i>
</I>&gt;<i> (1) Is the file:
</I>&gt;<i>
</I>&gt;<i>     /usr/src/modules/linux-uvc/debian/rules
</I>&gt;<i>
</I>&gt;<i> executed automatically by module-assistant?
</I>&gt;<i>
</I>&gt;<i> Or is the file to be executed from the command line as a script:
</I>&gt;<i>
</I>&gt;<i>     # ./rules
</I>&gt;<i>
</I>&gt;<i> or as a makefile:
</I>&gt;<i>
</I>&gt;<i>     # make rules
</I>
debian/rules is a Makefile to describe the process to compile the
source &amp; install the binary to specific location. You could involve it
by the command &quot;make -f debian/rules&quot;. However, it can't create
package directly. The command to pack the repository should be
&quot;dpkg-buildpackage&quot;.

Example:

dpkg-buildpackage -rfakeroot -us -uc

However, I am not sure how module-assistant works. It is possible that
module-assistant by-pass dpkg-buildpackage and involve debian/rules
directly. If you just want to test whether can the build process
success, you may just run :

m-a build linux-uvc

&gt;<i> -----------------------------------
</I>&gt;<i>
</I>&gt;<i> (2) Can I enjoy benefit of both the Debian approach and the
</I>&gt;<i> most-recent driver revisions, by copying the source files obtained
</I>&gt;<i> from the svn.berlios.de svn repository into:
</I>&gt;<i>
</I>&gt;<i>     /usr/src/modules/linux-uvc/
</I>&gt;<i>
</I>&gt;<i> and thus overwriting the &quot;linux-uvc-source&quot; files obtained from the Debian
</I>&gt;<i> repository?
</I>
I think it is possible, but you need to also update the rev no. for
the generated package. Usually the version no. is controlled by the
file changlog, but seems that module package use another approach.

Within the debian/rules, you could find this line:

        dh_gencontrol -- -v$(VERSION)

Instead of getting the version no. from changelog, the version is
directly passed by the argument.

&gt;<i> -----------------------------------
</I>&gt;<i>
</I>&gt;<i> (3) To which directory must I &quot;cd&quot; before executing:
</I>&gt;<i>
</I>&gt;<i>     # module-assistant prepare
</I>&gt;<i>
</I>&gt;<i>     # module-assistant auto-install linux-uvc
</I>&gt;<i>
</I>&gt;<i> -----------------------------------
</I>
anywhere you like

&gt;<i>
</I>&gt;<i> RLH
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002230.html">[Linux-uvc-devel] driver installation in Debian
</A></li>
	<LI>Next message: <A HREF="002226.html">[Linux-uvc-devel] driver installation in Debian
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2234">[ date ]</a>
              <a href="thread.html#2234">[ thread ]</a>
              <a href="subject.html#2234">[ subject ]</a>
              <a href="author.html#2234">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
