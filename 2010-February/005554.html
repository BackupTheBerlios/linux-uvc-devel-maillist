<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Linux-uvc-devel] frame rate dropping when capturing from webcam
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/linux-uvc-devel/2010-February/index.html" >
   <LINK REL="made" HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20frame%20rate%20dropping%20when%20capturing%20from%20webcam&In-Reply-To=%3C4B8325CA.8050207%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005550.html">
   <LINK REL="Next"  HREF="005555.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Linux-uvc-devel] frame rate dropping when capturing from webcam</H1>
    <B>Cesar Maciel</B> 
    <A HREF="mailto:linux-uvc-devel%40lists.berlios.de?Subject=Re%3A%20%5BLinux-uvc-devel%5D%20frame%20rate%20dropping%20when%20capturing%20from%20webcam&In-Reply-To=%3C4B8325CA.8050207%40gmail.com%3E"
       TITLE="[Linux-uvc-devel] frame rate dropping when capturing from webcam">cmaciel.atl at gmail.com
       </A><BR>
    <I>Tue Feb 23 01:48:10 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005550.html">[Linux-uvc-devel] Techsolo TCA-4900  is supported!
</A></li>
        <LI>Next message: <A HREF="005555.html">[Linux-uvc-devel]  Looking for upside down uvc cams
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5554">[ date ]</a>
              <a href="thread.html#5554">[ thread ]</a>
              <a href="subject.html#5554">[ subject ]</a>
              <a href="author.html#5554">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am trying to capture from a webcam with a fixed frame rate. I am using 
ffmpeg (svn revision 21498) with the following options:


./ffmpeg -y -t 00:01:00 -f video4linux2  -r 30 -s 352x288   -i 
/dev/video0 -vcodec msmpeg4v2 -f avi -r 30 video.avi


I used two webcams where uvcvideo shows being capable of 352x288 at 
30fps. For some reason, ffmpeg cannot keep the input frame rate, and it 
starts to go down. There are processing resources available in the 
system (Ubuntu Karmic 9.10, and also Voyage Linux 0.62 (Debian-based). I 
have tried specifying the qscale option, but it did not make any 
difference. Also, both cameras can output raw and mjpeg, but it also did 
not make a difference.

I have updated uvc on Karmic to the version available as a gzip file on 
the official website. dmesg shows tons of

uvcvideo: Dropping payload (out of sync).

and every now and then:

[28339.492016] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[28339.492022] uvcvideo: Queuing buffer 30.
[28339.492030] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)


for both cameras. On Voyage Linux (kernel 2.6.30), it shows several msgs 
like the following ones

[26440.191029] uvcvideo: Queuing buffer 3.
[26440.191405] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[26440.201496] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[26440.211579] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[26440.221661] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[26440.230034] uvcvideo: Frame complete (EOF found).
[26440.231743] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)
[26440.231753] uvcvideo: Dequeuing buffer 4 (3, 14800 bytes).
[26440.249905] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QBUF)
[26440.249921] uvcvideo: Queuing buffer 4.
[26440.249950] uvcvideo: uvc_v4l2_ioctl(VIDIOC_DQBUF)


Cameras are Microsoft NX-3000 and Genius eFace 1325R

Does anyone have an idea, or need more info?

Thanks

Cesar




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005550.html">[Linux-uvc-devel] Techsolo TCA-4900  is supported!
</A></li>
	<LI>Next message: <A HREF="005555.html">[Linux-uvc-devel]  Looking for upside down uvc cams
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5554">[ date ]</a>
              <a href="thread.html#5554">[ thread ]</a>
              <a href="subject.html#5554">[ subject ]</a>
              <a href="author.html#5554">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/linux-uvc-devel">More information about the Linux-uvc-devel
mailing list</a><br>
</body></html>
